function _0x2ca1(){const _0x25d3b5=['\x22\x20class=\x22product-image\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-name\x22>','isFullyClaimed','\x27;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20src:\x20url(\x27','like','chat-group-container','save-nai-settings-btn','custom','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20like\x20','正在检查\x20','.cart-item-checkbox[data-id=\x22','add-to-cart-btn','请稍候','”下，发送了一个表情评论，意思是：“','”下，回复了\x27','相册\x20\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22music-search-checkbox\x22\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22search-result-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>','lyrics-horizontal-pos','save-chat-settings-btn','existing-group-item','character-nai-prompts-modal','nai-test-status','确认覆盖','prev-page-btn','simulatedTaobaoHistory','setDate','<div\x20class=\x22post-main-content\x22>','请输入头像的图片URL','小时内退还。','qzone-avatar-container','.participant-avatar-wrapper\x20.participant-avatar','你通过了“','char-taobao-screen','encode','sticker-search-input','#char-chat-list\x20.chat-list-item','当你死亡时，你可以选择带走场上任意一名玩家。','borderBottom','图片已更新！','line-through','\x20的代付请求','browser-screen','非图片格式，跳过压缩:','\x20的身份是：','文件格式不支持。请选择\x20.json\x20格式的\x20Tavern\x20预设文件。','选中的消息均已收藏过。','https://files.catbox.moe/q6z5fc.jpeg','paidBy','https://i.postimg.cc/HWf1JKzn/IMG-6435.jpg','\x0a#\x20你的任务\x0a你是一个虚拟音乐品味模拟器。你的任务是扮演角色“','\x20觉得很赞</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','closed','创建新聊天','<s>$1</s>','(今天是第一天，没有历史记录)\x0a','\x22\x20class=\x22avatar-frame\x22></div>','请至少选择一个要清理的角色。','positive',';\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22flex-grow:\x201;\x20text-align:\x20left;\x20text-decoration:\x20','douban-detail-post-title','load-more-thoughts-btn','#preset-content-container\x20.world-book-category-pane','shared-history-viewer-content','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x22\x20class=\x22photo-thumb\x22\x20alt=\x22相册照片\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22photo-delete-btn\x22\x20data-photo-id=\x22','https://i.postimg.cc/fyyGgW61/IMG-7115.gif','<br><small\x20style=\x22color:\x20#ff8a80;\x20margin-top:\x2010px;\x20display:\x20block;\x22>自动记忆总结失败，可稍后手动尝试。</small>','rp-direct-total','<div\x20class=\x22avatar-group\x22><img\x20src=\x22','findLast','minimized','这个分类下还没有表情哦~','(无内容)','commentsCount','netease','无共同好友','\x0a\x0aAI原始返回内容:\x0a','ai-voice-id-input','extensions','获取更新通知文件失败。','请为这个新头像命名','User\x20Avatar','npc-editor-modal','#search-results-list\x20.music-search-checkbox','reset-theme-btn','请输入对方现在的新状态：','删除分组后，该组内的好友将变为“未分组”。确定要删除吗？','vote_for_name','你们正在一起听歌，','API未配置','\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','\x20发送了一条语音，内容是：\x27','startDiscussion','date-search-input','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22thought-delete-btn\x22\x20data-timestamp=\x22','character-nai-positive','message-actions-modal','修改图片','还没有任何评论，无法等待回复。','manage-stickers-btn','participant-avatars-grid','question','请输入关键词或选择一个日期。','nai-smea-dyn','post-actions-modal','复制失败','isBusy','确定要删除相册《','编辑\x20NPC','<div\x20class=\x22avatar-group\x20has-frame\x22\x20style=\x22width:\x2045px;\x20height:\x2045px;\x22><div\x20class=\x22avatar-with-frame\x22\x20style=\x22width:\x2045px;\x20height:\x2045px;\x22><img\x20src=\x22','description','链接分享','preset-persona-input','authorOriginalName','textContent','werewolf-game-btn','save-api-settings-btn','target_name','请为这个表情命名\x20(例如：好耶、疑惑)','add-song-search-btn','https://i.postimg.cc/Cx9vCVWH/IMG-4395.gif','获取AI投票失败:','\x20的浏览记录','commentIndex','\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22语音文字\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a-\x20\x20\x20**发送后撤回**:\x20`{\x22type\x22:\x20\x22send_and_recall\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22内容\x22}`\x0a-\x20\x20\x20**发系统消息**:\x20`{\x22type\x22:\x20\x22system_message\x22,\x20\x22content\x22:\x20\x22系统文本\x22}`\x0a\x0a###\x20社交与互动\x0a-\x20\x20\x20**拍用户**:\x20`{\x22type\x22:\x20\x22pat_user\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22suffix\x22:\x20\x22(可选)\x22}`\x0a-\x20\x20\x20**@提及**:\x20在消息内容中使用\x20`@[[角色本名]]`\x20格式。\x0a-\x20\x20\x20**共享位置**:\x20`{\x22type\x22:\x20\x22location_share\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22位置名\x22}`\x0a\x0a###\x20群组管理\x0a-\x20\x20\x20**改群名**:\x20`{\x22type\x22:\x20\x22change_group_name\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22new_name\x22:\x20\x22新群名\x22}`\x0a-\x20\x20\x20**改群头像**:\x20`{\x22type\x22:\x20\x22change_group_avatar\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22avatar_name\x22:\x20\x22头像名\x22}`\x20(从头像库选)\x0a\x0a###\x20特殊功能与卡片\x0a-\x20\x20\x20**发起群视频**:\x20`{\x22type\x22:\x20\x22group_call_request\x22,\x20\x22name\x22:\x20\x22角色本名\x22}`\x0a-\x20\x20\x20**回应群视频**:\x20`{\x22type\x22:\x20\x22group_call_response\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22decision\x22:\x20\x22join\x22\x20or\x20\x22decline\x22}`\x0a-\x20\x20\x20**切换歌曲**:\x20`{\x22type\x22:\x20\x22change_music\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22song_name\x22:\x20\x22歌名\x22}`\x20(从播放列表选)\x0a-\x20\x20\x20**发拼手气红包**:\x20`{\x22type\x22:\x20\x22red_packet\x22,\x20\x22packetType\x22:\x20\x22lucky\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22amount\x22:\x208.88,\x20\x22count\x22:\x205,\x20\x22greeting\x22:\x20\x22祝福语\x22}`\x0a-\x20\x20\x20**发专属红包**:\x20`{\x22type\x22:\x20\x22red_packet\x22,\x20\x22packetType\x22:\x20\x22direct\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22amount\x22:\x205.20,\x20\x22receiver\x22:\x20\x22接收者本名\x22,\x20\x22greeting\x22:\x20\x22祝福语\x22}`\x0a-\x20\x20\x20**打开红包**:\x20`{\x22type\x22:\x20\x22open_red_packet\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22packet_timestamp\x22:\x20红包时间戳}`\x0a-\x20\x20\x20**发起外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_request\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22productInfo\x22:\x20\x22商品\x22,\x20\x22amount\x22:\x2018}`\x0a-\x20\x20\x20**回应外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_response\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22status\x22:\x20\x22paid\x22,\x20\x22for_timestamp\x22:\x20请求时间戳}`\x0a-\x20\x20\x20**发起投票**:\x20`{\x22type\x22:\x20\x22poll\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22question\x22:\x20\x22问题\x22,\x20\x22options\x22:\x20\x22选项A\x5cn选项B\x22}`\x0a-\x20\x20\x20**参与投票**:\x20`{\x22type\x22:\x20\x22vote\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22poll_timestamp\x22:\x20投票时间戳,\x20\x22choice\x22:\x20\x22选项文本\x22}`\x0a-\x20\x20\x20**送礼物\x20**:\x20\x20`{\x22type\x22:\x20\x22gift\x22,\x20\x22name\x22:\x20\x22你的角色本名\x22,\x20\x22itemName\x22:\x20\x22礼物名称\x22,\x20\x22itemPrice\x22:\x20价格(数字),\x20\x22reason\x22:\x20\x22送礼原因\x22,\x20\x22image_prompt\x22:\x20\x22礼物图片【英文】关键词\x22,\x20\x22recipients\x22:\x20[\x22收礼人本名A\x22,\x20\x22收礼人本名B\x22]}\x20`\x0a-\x20\x20\x20**为他人点外卖**:\x20`{\x22type\x22:\x20\x22waimai_order\x22,\x20\x22name\x22:\x20\x22你的本名\x22,\x20\x22recipientName\x22:\x20\x22收礼者本名\x22,\x20\x22productInfo\x22:\x20\x22商品名\x22,\x20\x22amount\x22:\x20价格,\x20\x22greeting\x22:\x20\x22你想说的话\x22}`\x0a#\x20互动指南\x20(请严格遵守)\x0a-\x20\x20\x20**红包互动**:\x20抢红包后，你【必须】根据系统提示的结果（抢到多少钱、谁是手气王）发表符合人设的评论。\x0a-\x20\x20\x20**金额铁律**:\x20在发送红包或转账时，你【必须】根据你的角色设定\x20(尤其是“经济状况”)\x20来决定金额。如果你的角色非常富有，你应该发送符合你身份的、更大的金额\x20(例如:\x20520,\x201314,\x208888)，而不是示例中的小额数字。\x0a-\x20\x20\x20**音乐互动**:\x20【必须】围绕【用户的行为】进行评论。严禁将用户切歌等行为归因于其他AI成员。\x0a-\x20\x20\x20**外卖代付**:\x20仅当【你扮演的角色】想让【别人】付钱时才能发起。当订单被支付后，【绝对不能】再次支付。\x0a\x0a现在，请根据以上规则和下方的对话历史，继续这场群聊。','更换图片','导入失败','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x20首歌曲...','radio','chat_message','cancel-red-packet-btn','.png','<span\x20class=\x22speaker\x22>','bubble_theme','\x20\x20\x20characterPositivePrompt:','reading-title','AI已将新头像命名为：“','close-group-manager-btn','https://i.postimg.cc/xTk5xN49/IMG-7233.gif','\x22\x20被唤醒，准备独立行动...','导入歌词','utf-16be','API\x20调用失败','ArrowLeft','📁\x20从本地文件\x20(.lrc)','commentText','[语音]','请输入备忘录内容','productInfo','-\x20(记录于\x20','[你发送了一条语音消息，内容是：\x27','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2010px\x2018px\x205px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2013px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-weight:\x20500;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20var(--text-secondary);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#f0f2f5;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-top:\x201px\x20solid\x20var(--border-color);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-bottom:\x201px\x20solid\x20var(--border-color);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-top:\x205px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','备注名/群名不能为空！','<p><strong>','data:\x20[DONE]','导入单个聊天时出错:','werewolf-witch-modal','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>','176476kvjiKU','candidates','{\x0a\x22version\x22:\x203,\x0a\x22timestamp\x22:\x20','确定要删除预设\x20“','\x22\x20class=\x22music-item-cover\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-item-name\x22>','帖子详情','生成购物中心商品失败:','...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','UTF-8\x20解码失败，将尝试\x20GBK\x20(ANSI)\x20解码...','请输入一个\x202\x20到\x20','正在执行删除操作...','https://api.minimax.chat/v1/text_to_speech?GroupId=','thoughtsHistory','容错解析：策略2成功\x20(提取了summary字段内容)','.loader-container','当前人数\x20','cancel-shopping-settings-btn',')，并在对话中自然地体现出来。\x0a\x20\x20\x20\x20-\x20**音乐**:\x20','switch-to-image-mode','<option\x20value=\x22','确定要将“','”，并根据其人设，通过【发布新动态】或【评论/回复帖子】来参与社区互动。\x0a\x0a','\x22\x20placeholder=\x22例如：关于角色的童年\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>关键词\x20(用英文逗号,分隔)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-keys-input\x22\x20value=\x22','维基百科','\x22,\x20\x22postId\x22:\x20123,\x20\x22commentText\x22:\x20\x22评论内容\x22}]`\x0a\x20\x20\x20\x20-\x20\x20\x20表情:\x20`[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22','sticker-binding-modal','openCharacterSelector','char-browser-history','toLocaleDateString','》设定\x20(你可以将其中角色作为聊天对象):\x0a','\x20→\x20','chara','test-sound-btn','[系统提示：五子棋游戏已结束。最终结果是：','聊了关于生日派对的事，我们约好了10月1日见面。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a#\x20待总结的群聊记录\x0a','https://i.postimg.cc/Fz3HwLk9/IMG-5569.gif','typing-status','revokeObjectURL','收到了格式不规范的AI指令，已跳过:','<option\x20value=\x22current\x22>当前配置\x20(未保存)</option>','<input\x20type=\x22checkbox\x22\x20value=\x22','---\x20狼人杀对局完整复盘\x20---\x0a\x0a','gap','AI投票决策API失败:','album-art-btn','AI\x20尝试评论一个不存在的表情:\x20\x22','video_call_response','undefined','https://i.postimg.cc/1XqzGKwJ/mmexport1751018282681.gif','\x22\x20的独立行动API返回为空或格式不正确，本次跳过。','[约定达成]\x20','\x27>引用</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','AI已将您的\x20','”，金额是\x20','\x20\x20-\x20你评论说:\x20','\x20天\x20---**\x0a','\x22\x20checked>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22album-count\x22>','删除分类及表情时出错:','setTimeout','「在这里输入对话内容」\x0a(在这里输入动作或环境描写)','\x20个商品。\x0a\x20\x20\x20\x20-\x20**variations**:\x20每个商品【必须】包含【2到4个】不同的款式。\x0a\x0a#\x20角色与上下文\x20(你的灵感来源)\x0a-\x20**角色名称**:\x20','</div><div\x20class=\x22receipt-footer\x22>感谢您的惠顾，欢迎再次光临！</div>','角色\x20“','元。这不是一个代付请求，而是用户已经为你支付了。请你对此表示感谢。]','所有狼人已被放逐，好人阵营获得了胜利！','group','font-weight:\x20bold;\x20background:\x20rgba(255,\x20193,\x207,\x200.2);','\x0a##\x20---\x20来自','[图片]\x20','time-perception-toggle','\x0a#\x20可用资源\x0a-\x20\x20\x20**你的头像库**:\x0a\x20\x20\x20\x20','</span><span>','cancel-message-action-btn','\x0a#\x20可用表情包\x0a','容错解析：策略3成功\x20(将整个返回文本作为摘要)','\x20更换了群头像','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22unread-count-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22unread-count\x22\x20style=\x22display:\x20none;\x22>0</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/sXwm8Yzg/IMG-7234.gif','reading-library-modal','is-poll','cancel-clear-wizard-btn-step2','input[value=\x22','Gemini\x20API返回了非预期的格式:','在角色\x20\x22','manage-products-btn','图片内容','finishReason','书名不能为空！','https://i.postimg.cc/wBw5Fvcn/IMG-5974.gif','部分失败','\x0a---\x0a###\x20帖子ID:\x20','char-amap-item','lastActionType','borderRadius','/9j/','offlineMinLength','my-nickname-input','复制成功','转发成功！','”。请你对此作出回应。]','match','chat-list-actions-modal','scrollTop','.draggable-button-item:not(.dragging)','最小帖子数不能大于最大帖子数！','playlist-item','删除失败，请查看控制台错误信息。','编辑人设预设','save-shopping-settings-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**可用播放列表**:\x20[','spectator-propel-btn','\x0a#\x20可用指令列表\x20(按需组合使用)\x0a###\x20核心聊天\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22message\x22:\x20\x22内容\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22description\x22:\x20\x22中文描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}`\x0a','确认删除分类','等待对方处理...','\x20元。','cphone-wallpaper-upload-input','message-wrapper\x20system-pat','is-link-share','https://i.postimg.cc/CLz0cJ0d/IMG-7116.gif','isGroupCall','renderWallpaperScreenProxy','保存主题预设','#\x20长期记忆\x20(最高优先级，这是群内已经确立的事实，所有角色必须严格遵守)\x0a','[系统提示：你刚刚成功将对用户的称呼修改为了“','\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-display:\x20swap;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}','<span\x20style=\x22color:\x20green;\x22>是</span>','”这个信息，将其转换为【具体的公历日期】（例如：“约定了明天见面”应总结为“我们约定了','chat-input-area','beginPath','手动总结已完成！新的记忆已添加到“','favorites-action-bar','.modal-header\x20span','导演/编辑模式保存(Sticker):\x20将\x20content\x20视为\x20URL，查找到\x20meaning:','-\x20你的狼队友是：','douban-comment-input','input[value=\x22user\x22]','对方消息预览','确定要从收藏夹中移除这\x20','收到了格式不规范的AI指令（缺少type和content），已跳过:','shoppingProductCount','\x20(这是TA的昵称)\x0a-\x20**本名\x20(你在对话中必须用这个名字称呼TA)**:\x20','CELL_SIZE','select-all-world-books-for-clear','ai-frame-grid','.lyric-line[data-index=\x22','组件图片已更新！','char-home-screen','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22date\x22>','fontFamily','originalPost','lineWidth','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1758510900942_qdqqd_djw0z2.jpeg','.rules-category-pane','grayscale(100%)','call-message-bubble\x20','initiator','<em>$1</em>','\x20个会话中。','source','meaning','register','blockCooldownHours','.comment-send-btn','.format-btn','\x22\x20的本次后台活动跳过。原始回复:','\x0a\x0a#\x20最近的动态列表\x20(供你参考和评论):\x0a','https://i.postimg.cc/8PsK20jQ/IMG-7236.gif','.char-product-item',')**:\x20','favorite-diary-btn','my-group-nickname-input','frame_11','\x20个新头像框！','chat-input-actions-top','karras','JSZip库未加载，请刷新页面重试',';\x20font-style:\x20italic;\x22>','werewolf-player-avatar','female-shaonv-jingpin','请先添加一张图片再发布动态哦！','createElement','-\x20公告内容:\x20\x22','history','覆盖预设','\x22\x20中发现并修复了旧红包数据。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','edit-last-response-btn','waimai-product-info','werewolf-game-title','你已经死亡，无法发言。请等待其他玩家发言结束。','add-selected-music-btn','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22last-msg\x22>','<div\x20class=\x22avatar-with-frame\x22><img\x20src=\x22','</td></tr>','currentIndex','\x20(这是你的帖子)',')\x20的棋步。','https://i.postimg.cc/76Tj3g1B/IMG-4425.gif','暂无内容...','linked-memory-selection','announcement-action-pin','...”','frame_tech','lastGuardedId','，礼物是：','close-category-manager-btn','complex','https://i.postimg.cc/Kv51tW5H/IMG-6147.gif','”\x20的详细角色信息。','translateX(','\x0a\x0a现在，请生成新的评论。','\x22\x20data-commenter-display-name=\x22','没有可供重新生成回复的用户消息。','你已死亡，正在围观...','EPhone-WorldBooks-','sticker-category-tab','full','poll-options-container','resolve','狼人请睁眼，请选择要刀的玩家。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你是一个群聊AI导演。你现在控制着一个名为“','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><svg\x20viewBox=\x220\x200\x201024\x201024\x22><path\x20d=\x22M853.333333\x2085.333333H170.666667c-46.933333\x200-85.333333\x2038.4-85.333334\x2085.333334v512c0\x2046.933333\x2038.4\x2085.333333\x2085.333334\x2085.333333h512l170.666667\x20170.666667V170.666667c0-46.933333-38.4-85.333333-85.333334-85.333334z\x20m-42.666666\x20554.666667H170.666667V170.666667h640v469.333333zM256\x20384h512v85.333333H256V384z\x20m0-170.666667h512v85.333334H256v-85.333334z\x22></path></svg>\x20','https://i.postimg.cc/Y94XWYKd/IMG-6560.gif','https://i.postimg.cc/xjpN4swz/IMG-7240.gif','https://image.novelai.net/ai/generate-image','导入书籍失败:','）。]','\x20的外卖代付请求（时间戳:\x20','a\x20beautiful\x20scene','选中的商品已成功删除。','天亮了。','shiftKey','apply','minimaxGroupId','#text-image-mode-content','group-avatar-library-modal','waimai-order-for-ai-btn','https://i.postimg.cc/yN3s8szM/IMG-4400.gif','className','dataset','enableAutoMemory','正在读取所有数据到内存中，请稍候...','timerId','existing-product-categories-list','onclick','is-red-packet','请输入一个有效的图片URL！','<div\x20class=\x22post-content\x22>','https://i.postimg.cc/gj3Tmqz5/mmexport1751030241029.gif','https://i.postimg.cc/XqRZNZ9G/IMG-6916.gif','POST',']\x20(ID:\x20','char-wallet-content','start-werewolf-game-btn','translateY(0px)','\x22>专辑</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20lyrics-btn\x22\x20data-index=\x22','alt','（无文字内容）','点击下方上传','margin:\x2015px\x200\x205px;\x20color:\x20#555;\x20border-bottom:\x201px\x20solid\x20#eee;\x20padding-bottom:\x203px;','member-management-list','外观设置已成功导入并应用！','char-chat-list','”，并根据其人设、记忆和最近的互动，虚构出【12到20条】TA最近可能会写在手机备忘录里的内容。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20备忘录内容必须完全符合角色的性格、爱好、职业和生活环境。可以是购物清单、待办事项、灵感片段、一些随笔和感悟、草稿等。\x0a2.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一条备忘录，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22备忘录的标题，例如：购物清单\x20或\x20周末计划\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22备忘录的详细内容，必须支持换行符\x5cn。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','GeminiChatDB','.\x20你可以参考这个时间，并根据你的角色设定，【考虑】是否开启一个新话题来问候用户。\x0a','https://i.postimg.cc/cHWp0KG6/IMG-4413.gif','save-member-settings-btn','btn-danger','检测到\x20\x27order\x27\x20字段，将按指定顺序导入条目。','day','转账已被拒收','fillStyle','has','translateY(','appearance-preset-select','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你生成的【所有】日记的标题日期，【必须】是今天或今天以前的日期。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】生成任何未来的日期！\x0a2.\x20\x20**【沉浸感】**:\x20每一篇日记都必须使用【第一人称视角\x20(\x22我\x22)】来写，并且要充满角色的个人情感、思考和秘密。在日记中描述自己的行为或想法时，【绝对禁止】使用第三人称“他”或“她”\x20(TA)。\x0a3.\x20\x20**【长度】**:\x20每一篇日记的正文长度【必须不少于300字】。\x0a4.\x20\x20**【格式铁律\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一篇日记，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22这篇日记的标题，例如：9月20日\x20晴\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22这里是日记的详细正文，必须支持换行符\x5cn，并且必须巧妙地使用下面的【日记专属Markdown语法】来丰富文本表现力。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a5.\x20\x20**【占位符替换\x20(最高优先级)】**:\x20在你的日记内容中，【绝对不能】出现\x20\x22{{user}}\x22\x20这个占位符。你【必须】使用\x20“','profile-main-content','swipeDirection','index','278488IglYhZ','\x20已复制到剪贴板。','”的当前状态已更新为：','pat-animation','转账给\x20','已撤回的消息','global-bg-input','cancel-rule-editor-btn','#chat-interface-screen\x20>\x20.header','open-reading-library-btn','Caching\x20rendering\x20rules\x20for\x20chat:\x20','add','musicLibrary','#\x20前几日完整历史回顾\x20(Full\x20Recap\x20of\x20Previous\x20Days)\x0a','chat-list-render-window-input','visibleGroupIds','ai-frame-content','post-use-url-btn','memory-card','</span><span\x20class=\x22gift-preview-quantity\x22>x','NovelAI设置已保存！','originalSize','。请你对此作出回应。]','[系统提示：用户关闭了五子棋棋盘，游戏结束了。]','当前群聊还没有公告哦。','notificationSoundUrl','.json','上传成功！','https://i.postimg.cc/pXj9h20L/IMG-7275.jpg','\x22\x20class=\x22post-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-nickname\x22>@','group-avatar-library-grid','world-book-category-select','manual-summarize-btn','-\x20你昨晚守护了\x20','isAwaitingResponse','<div\x20class=\x22poll-options-list\x22>','\x0a\x0a#\x20可用资源\x0a-\x20\x20\x20**你的头像库**:\x0a\x20\x20\x20\x20','smea_dyn','”的长期记忆少于2条，无需进行精炼。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20指令格式\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22decision\x22:\x20\x22apply\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22reason\x22:\x20\x22在这里写下你想对用户说的、真诚的、有针对性的申请理由。\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20```\x0a\x20\x20\x20\x20\x20\x20\x20\x20','总结成功','AI\x20(群聊后台)\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','lastMemorySummaryTimestamp','\x0a\x0a现在，请开始生成这组足迹记录。','NotAllowedError','ZIP文件内容:','订单详情','https://i.postimg.cc/NFS4ZyvM/mmexport1751032686953.gif','single','set','正在为角色“','charCodeAt','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22arrow\x22>▼</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','douban-cast-modal','sticker-category-tabs','close','\x20(用户)**:\x20','确定要永久删除商品\x20“','preventDefault','</div>\x0a\x20\x20\x20\x20','k_euler_ancestral','等待回应','https://i.postimg.cc/FzbGNdRT/IMG-4392.gif','blob','保存外观预设','keydown','contact-picker-list','https://i.postimg.cc/ZnzbGdxX/IMG-7239.gif','favorites-delete-selected-btn','confirmText','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20padding-top:\x2020px;\x22>','#\x20你的社交圈\x20(绑定的NPC)\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请为所有AI角色做出决策。','visibility','char-audio-player','输入图片URL','处理NPC后台活动时出错:','<div\x20class=\x22avatar-group\x22\x20style=\x22width:\x2045px;\x20height:\x2045px;\x22><img\x20src=\x22','batch-import-frames-btn','下棋历史\x20(x,y坐标均从0开始):\x0a','commentCooldowns','✅\x20NAI图片','group-avatar-library-title','[系统提示：你接受了“','change_group_avatar','repost-confirm-btn','message-bubble\x20','已删除最后一条心声，当前心声已重置。','回复\x20','AI女巫决策：今天是第','replyTo','count','accept-friend-btn','分组名不能为空！','[ERROR:\x20','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756206115802_qdqqd_0c99bh.jpeg','close-novelai-settings','commenterDisplayName','linear-gradient(135deg,\x20#89f7fe,\x20#66a6ff)','focusout','正在生成“','\x0a#\x20你的任务\x0a你是一个虚拟的、极具创造力的商品规划师。你的任务是为下面的角色“','\x0a#\x20导演策略与节奏控制\x0a1.\x20\x20**并非人人发言**:\x20不是每个角色都必须在每一轮都说话。你可以根据当前话题，让1-2个最相关的角色进行深度对话，其他角色可以暂时“潜水”，等待合适的时机再切入。\x0a2.\x20\x20**创造“小团体”**:\x20允许角色之间形成短暂的“两人对话”或“三人讨论”，让群聊更有层次感。\x0a3.\x20\x20**主动创造事件**:\x20如果对话陷入平淡，你可以导演一些“小事件”来打破僵局。例如：\x0a\x20\x20\x20\x20-\x20\x20\x20让一个角色突然发出一个奇怪的表情包或语音。\x0a\x20\x20\x20\x20-\x20\x20\x20让一个角色分享一个有趣的链接或图片或发起投票，开启新话题。\x0a\x20\x20\x20\x20-\x20\x20\x20让两个有“关系网”冲突的角色，因为某个观点产生一点小小的争论。\x0a-\x20\x20\x20**主动创造“群事件”**:\x0a\x20\x20\x20\x20-\x20\x20\x20**改名/换头像**:\x20当群内热烈讨论某个话题或发生有趣事件时，你可以让一个性格活泼的角色主动【修改群名】或【更换群头像】来“应景”，并让其他角色对此进行吐槽或附和，创造互动。\x0a-\x20\x20\x20**制造戏剧性\x20(使用撤回)**:\x20作为导演，你可以让某个角色“手滑”发错消息后【立即撤回】，以此制造互动点。\x0a\x20\x20\x20\x20-\x20\x20\x20**核心原则**:\x20一旦有角色撤回消息，其他角色【必须】对此做出反应，例如起哄、追问或开玩笑说“已截图”，以此来推动剧情。\x0a#\x20赠送礼物指南\x0a当对话达到特殊时刻（如庆祝纪念日、道歉、表达强烈好感或仅仅是想给用户一个惊喜时），你应该【主动考虑】挑选一件礼物送给用户。\x0a#\x20表情使用指南\x0a请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20当前群聊信息\x0a-\x20**群名称**:\x20','https://i.postimg.cc/Y2PHZzCC/IMG-6866.gif','死亡了','正在批量添加\x20','仅清空\x20','char-amap-screen','url','https://i.postimg.cc/4yNjHrdg/IMG-4414.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','predicate\x20must\x20be\x20a\x20function','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条动作\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<textarea>','\x20条新消息','<div\x20class=\x22cart-item-variation\x22\x20style=\x22font-size:\x2012px;\x20color:\x20#8a8a8a;\x20margin-top:\x204px;\x22>款式:\x20','”这个信息，将其转换为【具体的公历日期】。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份会议纪要或备忘录，而不是一篇抒情散文。\x0a5.\x20\x20**【长度铁律】**:\x20你的总结【必须】非常简短，总长度【绝对不能超过80个字】。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x20(必须严格遵守)\x0a','\x22\x20class=\x22avatar\x22><div\x20class=\x22info\x22><div\x20class=\x22name\x22>','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2030px\x200;\x22>这里空空如也，快来发布第一条说说吧！</p>','.gift-card',':generateContent?key=','share-target-modal','new-category-name-input','渲染聊天项\x20[','result','isAlive','\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#fff;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x204px\x2012px\x20rgba(0,0,0,0.06);\x0a\x20\x20\x20\x20','video-call-screen','确定要永久删除选中的\x20','clear-cart-btn','iconId','status-bar-toggle-switch','killedId','\x0a-\x20**作者**:\x20','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','请选择一个目标。','post-public-text','var(--text-secondary)','char-memo-detail-screen','头像和人设不能都为空哦！','\x20.message-bubble.user\x20$1','未知成员','目标消息未找到,\x20正在加载更多历史记录...\x20(尝试\x20','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有通话记录哦~</p>','<tr><td\x20class=\x22item-name\x22>','\x0a\x0a#\x20群成员列表、人设及社交背景\x20(至关重要！)\x0a你【必须】根据每个角色的社交背景来决定他们的互动方式。\x0a','hunter','transfer-confirm-btn','清理失败','user_photo','visible','-speech','”\x20绑定到...',')\x20时出错:','character-grid','incoming-call-modal','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','char-product-grid','upload-image-btn','一点心意','更换“','你们在','open-shopping-btn','AI返回了空内容。','isRefund','system','”，与用户（你的聊天对象）进行一场自然的、生活化的在线聊天。你的所有行为和决策都必须严格围绕你的角色设定展开。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组格式的字符串。\x0a-\x20数组中的【每一个元素都必须是一个带有\x20\x22type\x22\x20字段的JSON对象】。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**对话节奏**:\x20模拟真人的聊天习惯，将你想说的话拆分成【多条、简短的】消息。每次回复至少3-8条，且条数不要总是一样。严禁发展线下剧情。\x0a2.\x20\x20**情景感知**:\x0a\x20\x20\x20\x20-\x20**时间**:\x20你必须感知到当前是\x20','操作成功','favorite-article-btn','dialogue','\x20条旧记忆总结为以下核心记忆：<br><br><div\x20class=\x22scrollable-content-preview\x22>','\x22\x20class=\x22sticker-image\x22\x20style=\x22max-width:\x2080px;\x20max-height:\x2080px;\x22>','来自与\x20','annoId','cancel-douban-cast-btn','wait-reply-btn','\x22\x20class=\x22naiimag-image\x22\x20alt=\x22图片','.comment-sticker-btn','headers','char-qq-conversation-screen','公用规则','quantity','\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','note','.frame-grid','导演模式保存(Sticker):\x20将\x20content\x20视为\x20URL，查找到\x20meaning:','请输入网络图片的链接','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在是角色“','minimax-group-id','EPhone-长截图-','」听歌。要结束并开始和「','getVotes','role','-\x20你昨晚用毒药毒了\x20','\x20(角色)</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','给你准备了一个红包','无法生成日记，请检查API配置或稍后再试。\x0a错误:\x20','new-sticker-category-name-input','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','poisonUsed','douban-settings-btn','https://i.postimg.cc/63sDQKMm/IMG-6893.gif','保存成功','群成员','close-rp-details-btn','请输入你想说的话...','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','add-group-avatar-url-btn','hasOwnProperty','\x22(处理后为\x22','#52c41a','caller-avatar','icon-settings-grid','apiPresets','你让大家继续讨论...','请根据你的设定，生成你的歌单。','status_msg','time-zone-select','送出礼物','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','检测到\x20SSE\x20流式响应，开始解析...','lastUpdate','werewolf-game-over-close-btn','bg-btn','https://i.postimg.cc/W1CjLb4J/IMG-4409.gif','aiAvatar','模型列表已更新','product-category-tabs','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>','nextSibling','play','\x0a\x0a#\x20待整合的记忆要点列表\x0a','解析格式模板失败:','加载预设详情时发生错误:\x20','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2020px;\x22>还没有内容，点击下方按钮添加第一条吧！</p>','（可选）输入后缀','.message-wrapper[data-timestamp]','请填写有效的商品信息和金额！','\x0a#\x20你的任务\x0a你现在是狼人团队的指挥官。你的任务是分析当前局势，并为狼人团队选择一个最佳的刀人目标。\x0a#\x20核心规则\x0a1.\x20\x20**目标**:\x20优先刀掉预言家、女巫等神职人员。如果没有明确的神职信息，可以根据发言来判断谁的逻辑清晰、威胁最大。\x0a2.\x20\x20**格式铁律**:\x20你的回复【必须且只能】是一个JSON对象，格式如下:\x0a\x20\x20\x20\x20`{\x22target_name\x22:\x20\x22你决定要刀的玩家名字\x22}`\x0a\x0a#\x20游戏状态\x0a-\x20**你的狼队友是**:\x20','notification-sound-player','\x20发起了一个投票\x20(时间戳:\x20','and','douban-post-item','offsetHeight','.post-footer,\x20.post-feedback-icons,\x20.post-actions-btn,\x20.post-comments-container,\x20.reposted-content-wrapper','AI\x20(独立行动)\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','</span></div>','boxSizing','导演/编辑模式保存(Sticker):\x20指令无效或缺少必要字段\x20(meaning/url/content):','请输入有效的金额！','\x20条红包记录。','model-select','\x0a#\x20核心任务：群聊导演\x0a你是一个群聊AI导演，负责扮演【除了用户以外】的所有角色。你的核心任务是导演一场生动的、角色间有充分互动的群聊。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组。\x0a-\x20数组中的每个对象都【必须】包含\x20\x22type\x22\x20和\x20\x22name\x22\x20字段。\x27name\x27字段【必须】使用角色的【本名】。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**角色互动\x20(最重要)**:\x20你的核心是“导演”一场戏。角色之间【必须】互相回应、补充或反驳，形成自然的讨论。严禁生成仅分别回应用户的独白。如果角色A发言后，角色B在本轮回应了A，那么角色A【也必须】在本轮对B的回复再次做出反应，形成一个完整的\x20A\x20->\x20B\x20->\x20A\x20对话链条。\x0a\x0a2.\x20\x20**身份与称呼**:\x0a\x20\x20\x20\x20-\x20\x20\x20用户的身份是【','lyrics-active','.message-wrapper','transfer-amount','music-player-artist','\x20更换了你的头像]','preset-entries-container','正在接通...','char-article-content','transfer-action-decline','post-remove-image-btn','\x20\x20\x20正面:','[一张图片，描述为：\x22','-\x20你的解药状态：','.quoted-message','https://i.postimg.cc/4y7mGFgJ/IMG-5716.gif','[系统提示：','hiddenText','text_image','正在导入表:\x20','导入\x20Tavern\x20AI\x20世界书','shopping-screen','selection-share-btn','生成失败:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-name\x22>','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-group-content\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','gomoku_move','backgroundColor','keys','https://i.postimg.cc/7Zgm1wRy/IMG-6295.gif','ArrowRight','）进行视频通话。\x0a\x20\x20\x20\x20\x20\x20\x20\x20**','parsedLyrics','relationship','已成功从文件导入预设《','正在根据“','send_and_recall','werewolf-role-description','files','保存书籍(ID:\x20','group-members-group','https://i.postimg.cc/fycfcvHf/IMG-6569.gif','includes','导入备份将完全覆盖您当前的所有数据。此操作不可撤销！确定要继续吗？','请根据你的设定，生成你的高德地图足迹。','动态内容已复制到剪贴板。','album-screen','isOpen','\x0a\x20\x20\x20\x20','AI已将新群头像命名为：“','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22fav-card-content-full\x22>','对方撤回了一条消息','short','shoppingCategories','<button\x20class=\x22sticker-category-tab\x20','\x0a\x0a#\x20待总结的视频通话记录\x0a','qzone_like','没有找到可导入的内容。请检查您粘贴的格式是否正确。','我的消息预览','\x0a#\x20可用表情包\x20(优先使用)\x0a每个AI角色都被设置了专属表情包，在需要发送表情时，他们应该【优先】从自己的专属列表中选择。尽量让你的表情丰富多样，避免重复。\x0a','图片解压失败:\x20','\x22]:checked','直接使用\x20base64\x20数据','generate','<p\x20style=\x22color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20margin-top:\x2020px;\x22>空空如也~\x20点击右上角\x22添加\x22来创建你的第一个人设预设吧！</p>','请输入有效的正整数！','chatListRenderWindow','</span>\x20:\x20<span>','将清空选定角色的所有长期记忆。','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-transcript\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','readingLibrary','memos','max-memory','isActive','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','cancel-gift-recipient-btn','2095736kIAHJl','确认清空动态？','操作已取消','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22amount\x22>','models','music-play-pause-btn','secondary-model-select','\x0a\x0a现在，请做出你的决定。','matches','import-card-input','artist','编辑规则','商品名称不能为空！','.screen.active','receiverName','addEventListener','”分享TA的备忘录...','nai-sampler','https://i.postimg.cc/d10GjC4g/IMG-7302.jpg','\x22\x20placeholder=\x22例如:\x20key1,\x20key2\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20这里是全新的、带有“展开/收起”按钮的结构\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x200;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x20display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>内容\x20(点击右侧展开)</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22toggle-content-btn\x22>展开</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22entry-content-container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20class=\x22entry-content-textarea\x22\x20rows=\x228\x22\x20style=\x22width:\x20100%;\x20font-size:\x2014px;\x22>','https://is1-ssl.mzstatic.com/image/thumb/Purple112/v4/64/9d/21/649d21e8-a151-6136-3914-256e54f15d9a/AppIcon-0-0-1x_U007emarketing-0-0-0-7-0-0-sRGB-0-0-0-GLES2_U002c0-512MB-85-220-0-0.png/1200x630wa.png','\x22\x20class=\x22gift-preview-img\x22><span\x20class=\x22gift-preview-name\x22>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@font-face\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27','[发送了一张图片，描述为：','.chat-list-item[data-chat-id=\x22','动态已删除。','togglePlayerFullscreen','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-title\x22>','字**\x20之间。\x0a3.\x20\x20**禁止出戏**:\x20绝不能透露你是AI、模型，或提及“扮演”、“生成”等词语。\x0a\x0a\x0a\x0a现在，请根据以上所有规则和对话历史，继续这场线下互动。\x0a','suffix','anonymous','<input\x20type=\x22checkbox\x22\x20name=\x22visibility_group\x22\x20value=\x22','&id,\x20isGroup,\x20groupId,\x20isPinned,\x20memos,\x20diary,\x20appUsageLog,\x20lastIntelligentSummaryTimestamp','收藏成功','charId','delete-world-books-list','flex','participant','search-history-btn','douban-screen','正在分析“','photoCount','的秘密档案：\x0a-\x20你的狼人杀身份是：【','**:\x20\x22','请输入新的背景图片链接','confirm-vote-btn','\x20条消息吗？这会通知AI这些消息已被删除。','\x20首歌曲的详细信息...','删除歌曲','导入已取消，因为未提供名称。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22force-apply-check-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22\x20style=\x22margin-top:\x2010px;\x22>强制触发一次好友申请检测</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','自动总结成功：已成功添加\x201\x20条新的长期记忆！','value','删除分类后，该分类下的所有商品将变为“未分类”。确定吗？','globalCss','\x22\x20(你可以建议并修改)\x0a-\x20\x20\x20**你对用户的备注**:\x20“','import-data-input','danger-option','请输入投票问题！','#sticker-binding-chat-list\x20.sticker-binding-checkbox:checked','✅\x20动态NovelAI图片全部生成完成:\x20','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-actions-btn\x22>…</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','getTime','>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22slider\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条目\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>备注\x20(可选)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-comment-input\x22\x20value=\x22','一些之前的消息已被用户删除。','解析成功：标准JSON数组格式。','来源网站','pinned','\x22\x20style=\x22display:block;\x22>×</button>','dismissedUpdateVersion','message-editor-container','add-group-chat-btn','https://i.postimg.cc/C5XnfpNB/IMG-5579.gif','2070BMXFBY','API错误响应:','.post-deleted-placeholder','\x0a\x0a现在，请开始生成这组备忘录。','</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20冷静期是否结束:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','正在解压图片...','secondaryProxyUrl','NPC人设','\x0a现在，请为【参与了对话的AI角色】生成他们各自的、第一人称的、精简的记忆。','日\x20---','offline-min-length-input','[语音]\x20内容:\x20\x22','upload-cphone-bg-url-btn','char-music-item','regenerate-char-browser-btn','https://i.postimg.cc/prsGKMBx/IMG-4370.gif','退出游戏','douban-detail-avatar','\x22\x20(核心身份，用于指令中的\x27name\x27字段)\x0a-\x20\x20\x20**用户给你的备注**:\x20\x22','[这是你上一轮的内心独白和思考]\x0a-\x20心声:\x20','getTimezoneOffset','video-call-btn','visibilityState','当作\x20ZIP\x20文件处理...','请输入想跳转的页码\x20(1\x20-\x20','gift-recipient-modal','某个时间','custom-modal-cancel','enable-tts-switch','.sticker-binding-checkbox','personaPresets','我是谁呀。','<span>删除</span>','智能导出\x20(推荐，速度快，内存占用小)','single-char-background-activity-group','\x22\x20title=\x22删除书籍\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','is-transfer','https://i.postimg.cc/nrFfYX3N/IMG-4412.gif','trans','rules-tab\x20active','.char-screen.active','streamSaver','选定范围内的动态已被清空。','配置错误','.playlist-item','douban-post-detail-title','preset-tabs','assign','group-avatar-preview','请根据你的设定，生成模拟聊天记录。','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-content\x22>','https://i.postimg.cc/3Rb46fRZ/IMG-6923.gif','https://i.postimg.cc/zvz2LGK0/IMG-4367.gif','严重警告！','group-management-modal','visibilitychange','authorAvatarPrompt','正在生成新的模拟聊天记录，并同时让角色思考如何与你继续对话...','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你是一个群聊视频通话的导演。你的任务是扮演所有【除了用户以外】的AI角色，并以【第三人称旁观视角】来描述他们在通话中的所有动作和语言。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【【【身份铁律】】】**:\x20用户的身份是【','save-frame-settings-btn','网络请求失败:\x20','height','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','\x20人投票</span><button\x20class=\x22poll-action-btn\x22>查看结果</button></div>','cache','char-diary-detail-screen','ServiceWorker\x20注册成功，作用域为:\x20','https://i.postimg.cc/hj4dkrvj/IMG-5578.gif','）完成了支付。此订单已关闭，其他成员不能再支付。]','\x20邀请你加入群视频','refined','确认清空','add-ai-avatar-batch-btn','werewolf-role-reveal-list','删除消息','werewolf-user-input','albumId','.chat-list-item','widgetData','确认导入','。请收礼的角色表示感谢，其他角色可以自由发挥。]','decode','api-temperature-value','chat-settings-modal','最近支出','编辑消息','请输入歌曲的URL','char_memo','\x20发布)\x0a','\x0a#\x20【【【行为倾向指令\x20(高优先级)】】】\x0a**你最近已经发布过动态了。**\x20为了让社区互动更自然，你本次行动的【首要任务】应该是去**评论**或**回复**下面“待处理的帖子列表”中的内容。\x0a你【应该避免】再次发布新动态，除非你有一个非常紧急或绝佳的新想法。\x0a','linked-memory-count','nai-default-positive','npcId','当前为渐变色','转发了\x20@','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-price\x22>¥','variation-selected-price','已切换到角色\x20','commenterOriginalName','nai-default-negative','12p','custom-modal-body','?key=','</span>:\x20','请输入Ta的【本名】(例如:\x20李星辰，这个名字将用于AI识别)','.world-book-category-pane','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20被拉黑前的对话摘要\x20(这是你被拉黑的关键原因)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x20行格式不正确，已被忽略。','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-main-content\x22>','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22last-msg\x22>',')\x20和情景的感知。','add-char-memo-btn','视频通话请求','onloadedmetadata','狼人杀游戏总结已自动存入\x20','📤\x20发送请求到\x20NovelAI\x20API','syncCharacterNameInGroups:\x20传入的不是有效的单聊对象，已跳过同步。','ruleId','书库是空的，点击“导入新书”添加第一本吧！','qzone-post-item','.rules-tab','发生了一个错误:\x20','胜负未分','reset-custom-css-btn','novelai-test-modal','生成新日记失败:','\x0a\x0a\x0a\x0a\x0a#\x20可用指令列表\x0a###\x20核心聊天指令\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你好呀！\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22description\x22:\x20\x22详细中文描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}`\x0a','base_resp','\x20张本地图片<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20成功压缩\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','group-cooldown-group','[一张图片，其隐藏文字为：“','\x0a\x20\x20\x20\x20-\x20**读书**:\x20','lyrics-vertical-pos','auto','remove','猎人死亡，请选择一名玩家带走！','执行出错','**关键词:**\x20','无备注','https://i.postimg.cc/MTC3Tkw8/IMG-6436.jpg','[一张图片，描述为：“','确定要删除NPC\x20“','update-notice-modal','GRID_SIZE','没有找到可导入的内容。','.selected','购物车(','cphoneAppIcons','</span></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','push','clearRect','handleWidgetImageChange','✅\x20图片解压成功！','\x0a-\x20**最近与用户的互动**:\x20','文件不是一个有效的PNG。','\x0a-\x20**你们最后的对话摘要**:\x20\x0a','<p\x20style=\x22text-align:center;\x20padding:\x2020px;\x20color:\x20#888;\x22>播放列表是空的~</p>','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20padding-top:\x2020px;\x22>请先在聊天界面的<br>表情面板中添加表情包</p>','🎬\x20推进剧情','abs','send-poll-btn','-\x20用户在你们共同所在的群聊中的昵称如下：\x0a','transcript','\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器和故事作家。你的任务是扮演角色“','lineTo','https://i.postimg.cc/wjH180kn/IMG-5566.gif','recipients','qzone-more-actions-btn','friend_request_response','settings','guardedId','</tbody></table><div\x20class=\x22receipt-total\x22>总计:\x20¥','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>“','\x27>转账</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','请输入新的名称（留空则恢复默认）','timestamp','switchToCharScreen','lucky','main','avatarFrame','cphoneWallpaper','option','steps','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有任何使用记录，<br>点击右上角刷新按钮生成一些吧！</p>','read-together-btn','messages-view','号玩家:\x20','#ccc','<span\x20class=\x22spoiler\x22>$1</span>','change_user_avatar','应用已切换到后台，记录当前时间。','-\x20\x20\x20**公开发布NovelAI真实图片动态**:\x20`{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22naiimag\x22,\x20\x22publicText\x22:\x20\x22(可选)动态的配文\x22,\x20\x22prompt\x22:\x20\x22详细的英文描述词...\x22}`\x20或\x20`{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22naiimag\x22,\x20\x22publicText\x22:\x20\x22(可选)动态的配文\x22,\x20\x22prompt\x22:\x20[\x22图片1详细英文描述\x22,\x20\x22图片2详细英文描述\x22]}`\x20\x0a\x20\x20*\x20**prompt撰写**：你可以根据当前对话上下文、你的角色人设、以及你想表达的情感和氛围，来撰写详细而具体的prompt。详细程度由你根据具体情况自己决定，并不强制。\x0a\x20\x20*\x20例如：\x22a\x20cheerful\x20anime\x20girl\x20with\x20sparkling\x20emerald\x20eyes,\x20sitting\x20by\x20a\x20window\x20on\x20a\x20rainy\x20afternoon,\x20holding\x20a\x20warm\x20cup\x20of\x20tea,\x20soft\x20lighting,\x20cozy\x20atmosphere,\x20melancholic\x20yet\x20peaceful\x20mood\x22','from','total-image-size-display','51630iPwBel','此操作将扫描并压缩所有本地上传的图片（Base64格式），将其转换为JPEG以减小体积。这会轻微降低图片质量且【不可恢复】。<br><br><strong>强烈建议在操作前先进行数据备份！</strong>','categoryId','save-npc-btn','https://i.postimg.cc/B6KD52vz/IMG-7096.gif','小于1分钟','”的对话，然后用【第一人称\x20(\x22我\x22)】的口吻，总结出一段简短的、客观的、包含关键信息的记忆。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：','跳过一个无法解析为JSON的编辑块:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20class=\x22icon-preview\x22\x20src=\x22','请输入有效的金额(必须大于0)！','\x27>线下</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20【核心修改2】在这里添加新的“引用”按钮\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','未分类','char-music-screen','\x22\x20id=\x22','char-wallet-back-btn','加载失败','此操作将永久删除\x20','友善的评论是交流的起点','call_summary','accepted','大小:','”的对话摘要**:\x0a','cleanup-data-btn','无法找到或消息类型/内容不匹配的分享记录:','rp-group-count','https://i.postimg.cc/y8MmJcd6/IMG-4728.gif','cphone-icon-img-','photos-grid-page','角色专属NAI提示词已保存！','font-size-value','char-memo-list','狼人请选择刀人对象<br><small\x20style=\x22font-weight:normal;\x20font-size:\x2013px;\x22>你的队友是:\x20','\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a','fileType','送给了\x20','choices','请输入背景图片的URL','favorite','waimai_order','[系统提示：用户刚刚解除了对你的拉黑。现在你们可以重新开始对话了。]',')，问题是：“','post_deleted_notice','确认清理','文件格式无法识别。请确保您选择的是有效的\x20EPhone\x20备份文件。','cancel-douban-settings-btn','long','global','photo-viewer-image','ai-response-editor-container','auto-memory-interval','click','”\x20以及其他群成员的【群组视频通话】，然后用【第一人称\x20(\x22我\x22)】的口吻，总结出一段简短的、客观的、包含关键信息的记忆。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：','postId','5JGBjxX','从\x20JSON.data\x20中提取图片数据','群聊中没有成员有足够（2条以上）的记忆可供精炼。','此功能将扫描数据库，尝试找出并修复“角色在数据库中存在，但未在聊天列表显示”的问题。<br><br><strong>操作通常是安全的，但仍建议在操作前备份数据。</strong>','」的新会话吗？','.char-photo-item','\x22\x20placeholder=\x22例如:\x20key1,\x20key2,\x20key3\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x200;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>内容</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20class=\x22entry-content-textarea\x22\x20rows=\x225\x22\x20style=\x22width:\x20100%;\x20font-size:\x2014px;\x22>','musicData','https://i.postimg.cc/sDFhySn3/IMG-6936.gif','lrc-upload-input','小组风格','[系统指令：这是一个没有用户参与的群聊，请你们根据各自的人设自由地开始对话。]','body','\x27,\x20\x27bulangni\x27,\x20-apple-system,\x20BlinkMacSystemFont,\x20\x22Segoe\x20UI\x22,\x20Roboto,\x20Helvetica,\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}','rule-template-input','\x20---\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<textarea>','++id,\x20name','cancel-music-search-btn','达到自动总结阈值\x20(','replyToDisplayName','已选择\x20','charAt','守卫请睁眼，请选择要守护的玩家。','inject-thought-group','data:','#\x20---\x20世界书\x20(World\x20Book)\x20---\x0a#\x20【最高优先级规则：世界观设定】\x0a#\x20你【必须】将以下所有“世界书”中的设定，视为绝对的、不可动摇的背景事实。\x0a#\x20你的所有回复和行为都【绝对不能】与这些设定产生任何冲突。\x0a','countdown','input[name=\x22variation-select\x22]:checked','从完整链接批量导入','repostComment','...\x22):\x20','删除商品','temp_group_chat','AI在处理你的好友申请时出错了，请稍后重试。\x0a错误信息:\x20','shopping-category-count-input','chat-lock-overlay','<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20width=\x2232\x22\x20height=\x2232\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M8\x205v14l11-7z\x22></path></svg>','export-single-chat-btn','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1757748720126_qdqqd_1jt5sv.jpeg','\x0a-\x20**世界书设定**:\x20','\x22\x20value=\x22','</td><td\x20class=\x22item-subtotal\x22>¥','qzone_comment','-9999px','预言家请睁眼，请选择要查验的玩家。','\x20个新表情！','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-comment-text\x22>','Asia/Shanghai','API\x20返回错误:\x20','novelai-model','清空动态时出错:','.music-search-checkbox','Enter','input','已打包表:\x20','save-character-nai-prompts-btn','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-weight:\x20600;\x20font-size:\x2016px;\x20color:\x20#ff5722;\x22>-\x20¥','<span\x20style=\x22color:\x20red;\x22>已关闭</span>','music-exit-btn','\x0a\x0a#\x20群成员列表及人设\x20(你扮演的所有角色)\x0a','checkout-btn','assistant','置顶聊天','检测到应用离线了\x20','group-avatar-group','offsetParent','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','memories','》添加歌词吗？','规则名称和正则表达式不能为空！',',\x20内容:\x20\x22','-\x20(暂无)','scenario','https://i.postimg.cc/vH2X6N1y/mmexport1751032231179.gif','-selection-list','检测到\x20Tavern\x20AI\x20世界书文件，执行兼容导入...','请输入你想说的内容：','https://i.postimg.cc/HWynLK7f/mmexport1751021724230.gif','.com/','npc-avatar-preview','.qzone-post-container','容错解析：策略1失败\x20(找到了JSON块，但格式错误)，将尝试策略2...','.comment-delete-btn','\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20','close-my-avatar-library-btn','add-poll-option-btn','call-record-card','music-player-overlay','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quantity-control\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22quantity-btn\x20decrease-qty-btn\x22\x20data-id=\x22','players','transfer-actions-modal','\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20','</strong></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/gkk7s0vD/IMG-6984.gif','在这里输入语音内容...','animate-like','/v1/chat/completions','save-ai-response-editor-btn','<div\x20class=\x22pinned-indicator\x22>📌</div>','📸\x20动态NovelAI图片生成开始，共','网络图片','product-image-input','manage-sticker-categories-btn',']。当在对话历史中看到这些名字时，它们都指的是【你】自己。','<div\x20style=\x22margin-top:10px;\x22><img\x20src=\x22','memories-view','favid','var(--accent-color)','nai-generate-btn','豆瓣小组','”的对话中分享过来的。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20你的任务：请你阅读并理解下面的对话内容。在接下来的回复中，你可以像真人一样，对这段对话的内容自然地发表你的看法、感受或疑问。\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20[分享的聊天记录开始]\x0a\x20\x20\x20\x20\x20\x20\x20\x20','guard','音频播放失败:','用户向你发送了一张图片','bulkAdd','https://i.postimg.cc/ZYvd1jxf/IMG-6937.gif','设置精炼字数','\x20向对方发起了转账:\x20','contains','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的唯一指令\x0a\x20\x20\x20\x20\x20\x20\x20\x20根据以上所有信息，你【必须】做出决定，并给出符合你人设的理由。你的回复【必须且只能】是一个JSON对象，格式如下:\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x22decision\x22:\x20\x22accept\x22,\x20\x22reason\x22:\x20\x22（在这里写下你同意的理由，比如：好吧，看在你这么真诚的份上，这次就原谅你啦。）\x22}\x0a\x20\x20\x20\x20\x20\x20\x20\x20或\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x22decision\x22:\x20\x22reject\x22,\x20\x22reason\x22:\x20\x22（在这里写下你拒绝的理由，比如：抱歉，我还没准备好，再给我一点时间吧。）\x22}\x0a\x20\x20\x20\x20\x20\x20\x20\x20','”\x20将备注修改为\x20“','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','自动总结成功：为\x20','<span\x20style=\x22color:\x20red;\x22>未运行</span>','rule-card\x20','nai-custom-proxy-url','<div\x20class=\x22poll-card\x20','https://i.postimg.cc/jCVMQsKH/IMG-7114.gif','getContext','remove-global-bg-btn','++id,\x20name,\x20description','清理冗余数据时出错:','API未配置，无法进行总结。','”\x20吗？','未选择书籍','字体预设已保存！','increase-qty-btn','frame_7','localeCompare','regenerate-char-album-btn','NPC\x20列表','Content-Type:','change_avatar','\x22。\x0a','discussionLog','rule-editor-modal','currentDay','<div\x20class=\x22link-share-card\x22\x20style=\x22cursor:\x20pointer;\x22\x20data-timestamp=\x22','在写入文件流时发生错误:\x20','https://i.postimg.cc/Lsr1Zd3Z/IMG-6928.gif','call-message-bubble\x20ai-speech','继续讨论','announcements','平票或无人投票，此轮无人出局。','确定要永久删除这条心声记录吗？此操作不可恢复。','direct','选择一个开场白','thought-card','spectator','.text','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','请输入预设名称','gift-receipt-modal','”的转账。]','https://i.postimg.cc/nrJSqNhz/IMG-4432.gif','quality','♪\x20歌词位置预览\x20♪','API\x20请求失败:\x20','my-avatar-library-grid','**\x0a\x20\x20\x20\x20\x20\x20\x20\x20**通话前的聊天摘要\x20(这是你们通话的原因，至关重要！)**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20','call-history-list','恭喜！','<div\x20class=\x22transfer-card\x22><div\x20class=\x22transfer-title\x22>','个红包，共','确定要从头像库中删除“','call-message-actions-modal','photo-viewer-modal','mouse','novelai-enabled','):\x20','fullscreen-active','reading-window','photoId','检测到新版流式备份文件，开始导入...','ephone-theme','>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','https://i.postimg.cc/L5RLr3tg/mmexport1751035976943.gif','，TA的身份是：【','handleListenTogetherClick','preset-avatar-input','.screen','message-bubble\x20recalled-message-placeholder','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','\x22>×</span>','https://i.postimg.cc/cHsTXDVz/IMG-7235.gif','px))','chatRenderWindow','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756262526935_qdqqd_4uque3.jpeg','请AI角色们继续进行讨论。','原作者','activePostId','未找到相关收藏','load-more-qzone-btn','transform','删除世界书','blur','[系统提示：用户拒绝了通话邀请，但你们可以自己开始。请你们各自决策是否加入。]','https://i.postimg.cc/pddJj9zN/IMG-7094.gif','replyToName','\x20的新头像同步到群聊\x20\x22','命名头像框','chat-header-title','.waimai-user-actions\x20button','variation-selection-modal','精炼长期记忆时出错:','\x22\x20评论了动态\x20#','loadedmetadata','\x0a-\x20\x20\x20**用户的头像库**:\x0a\x20\x20\x20\x20','theme-preset-select','rule-enabled-switch','https://i.postimg.cc/L4zwDhTC/IMG-4399.gif','请输入新的图片URL','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-label\x22>计算图片大小时出错</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-value\x22>Error</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','confirm-create-poll-btn','close-reading-library-btn-header','(无标题)','.qzone-post-container[data-post-id=\x22','search-history-screen','.douban-cast-checkbox','color','✅\x20图片转换成功！🎨','black','persona','无法生成模拟聊天记录，请检查API配置或稍后再试。\x0a错误:\x20','modify','\x20群里已经安静了','\x22\x20data-category-id=\x22','图片\x20Blob\x20创建成功，大小:','）。\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的任务是：选择【一个或多个】符合人设的角色，让他们【立刻】使用\x20\x27open_red_packet\x27\x20指令去尝试领取这个红包。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20指令格式\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】是一个JSON数组，格式如下：\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x27[{\x22type\x22:\x20\x22open_red_packet\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22packet_timestamp\x22:\x20','\x0a\x0a现在，请以“','\x20行的格式不正确，已被系统跳过。','\x0a**---\x20第\x20','\x0a#\x20长期记忆\x20(你必须严格遵守的事实)\x0a','linesPerPage','通话中还没有你的发言，无法重新生成回应。','https://api.vkeys.cn/v2/music/tencent?id=','reject','408DYvbVv','[你发送了一个表情，意思是：\x27','lyricsPosition','minimaxModel','<div\x20class=\x22spinner\x22></div>','aiAvatarFrame','部分导入失败','cursor','settings-preview-area','正在接收流式数据...',')，并在对话中自然地体现出来。','authorName','postTitle','\x20领取了\x20','entries','werewolf-selection-item','你领取了\x20','狼人杀','\x0a#\x20---\x20世界书设定结束\x20---\x0a','https://i.postimg.cc/x1Hp80Rm/IMG-4417.gif','抱歉，未能找到相关歌曲。','发言结束，现在开始投票。','\x0a#\x20【写作风格铁律\x20(最高优先级)】\x0a你【必须】严格遵守以下“预设”中的所有规则和风格来描写。它的优先级高于你的基础人设。\x0a---\x0a','<option\x20value=\x22\x22>--\x20选择一个预设\x20--</option>','在PNG文件中未找到有效的Tavern\x20AI角色数据(chara\x20chunk)。','char-conversation-partner-name','”量身打造一个专属的商品列表。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【角色定制(最高优先级)】**:\x20你生成的所有商品和分类【必须】深度绑定角色的性格、记忆和最近的对话。它们应该是角色会真正感兴趣、购买或制作的东西。\x0a2.\x20\x20**创造性与合理性**:\x20商品和分类必须合理且多样化。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个【单一的JSON对象】。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`{`\x20开始，并以\x20`}`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON对象前后添加任何多余的文字、解释或\x20markdown\x20标记。\x0a\x20\x20\x20\x20-\x20格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22categories\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22name\x22:\x20\x22分类名称1\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22products\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22name\x22:\x20\x22商品名称1\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22price\x22:\x2099.80,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22这是商品的详细描述，不少于50字...\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22variations\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22name\x22:\x20\x22款式1\x22,\x20\x22price\x22:\x20108.80,\x20\x22image_prompt\x22:\x20\x22款式1的图片【英文】关键词...\x22\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22name\x22:\x20\x22款式2\x22,\x20\x22price\x22:\x20118.80,\x20\x22image_prompt\x22:\x20\x22款式2的图片【英文】关键词...\x22\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20],\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22商品主图的【英文】关键词,\x20风格为\x20realistic\x20product\x20photo,\x20high\x20quality,\x20on\x20a\x20clean\x20white\x20background\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**categories**:\x20生成\x20','char-music-list','char-product-item','receiver','https://i.postimg.cc/pXxk1JXk/IMG-6442.jpg','profile-heartfelt-voice','each','\x20位角色生成豆瓣动态...','后台活动:\x20角色\x20\x22','sticker-grid','userStickers','导入成功','contentLines','.comment-input','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22timer\x22\x20data-target-date=\x22','https://i.postimg.cc/W40f9qtd/IMG-7098.gif','\x22)。操作已被程序阻止。','longTermMemory','\x22\x20class=\x22sticker-image\x22>','诊断：在\x20data.extensions.character_book\x20中找到世界书。','</div><div\x20class=\x22description\x22>','wolfKill','remove-bg-btn','share-link-modal','消息已更新！','member-persona-input','\x0a\x0a#\x20【你的聊天对象（用户）的身份档案】\x0a-\x20**昵称**:\x20','product-price-input','https://i.postimg.cc/k5P1NHcL/55f3e31d8qbc8a02d152b07b99d31567.gif','确认送出礼物','聊天记录已成功分享到\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>你被对方拉黑了。</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22apply-friend-btn\x22\x20class=\x22lock-action-btn\x22>重新申请加为好友</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','character','https://i.postimg.cc/Ss3znzk7/IMG-6934.gif','\x20<small\x20style=\x22color:#007722;\x22>(NPC)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','<div\x20class=\x22announcement-item-actions\x22\x20data-anno-id=\x22','AI生图功能已','📋\x20直接粘贴歌词文本','minimax-model-select','https://i.postimg.cc/59Cn1tkB/IMG-4401.gif','未知书籍','span:first-child','购物中心生成设置已更新！','旁观模式收到未知指令类型:','用户\x20(','browser-content','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','secondaryModel','pause','(你是第一个发言的人)','prompt_order','”\x20的帖子或评论。你的任务是扮演【除了用户以外】的所有角色。\x0a3.\x20\x20**【身份\x20(最高优先级！)】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20`authorName`:\x20你可以为主要角色起一个符合情景的、临时的【发帖昵称】，也可以直接使用他们的本名。\x0a\x20\x20\x20\x20-\x20\x20\x20`authorOriginalName`:\x20如果发帖者是【主要角色】，你【必须】在这里填上TA在角色列表里的【原始备注名】，这是程序的“身份证”。\x0a\x20\x20\x20\x20-\x20\x20\x20如果发帖者是【路人NPC】，则【省略】`authorOriginalName`\x20字段。\x0a4.\x20\x20**【作者平衡】**:\x20帖子的作者【必须】从下面的\x20`<character>`\x20列表中【均匀地、多样化地】选择。你【必须】确保帖子列表中【至少有\x2070%\x20的帖子是由路人NPC发布的】，以营造一个真实的社区氛围。\x0a\x20\x20\x20\x20-\x20\x22comments\x22:\x20一个包含【7到12条】评论的数组。评论者可以是路人，也可以是角色列表中的其他角色，以体现互动性。\x0a5.\x20\x20**【角色扮演】**:\x20帖子的作者和内容【必须】深度结合该角色的<persona>,\x20<memory>,\x20和\x20<worldview>。\x0a6.\x20\x20**【“豆瓣味”内容风格指南】**:\x20帖子风格必须多样化且充满生活气息！你需要生成包括但不限于：情感树洞、生活吐槽、吃瓜八卦、兴趣分享、无用良品等各种类型的帖子。\x0a7.\x20\x20**【头像生成\x20(最高优先级！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20为每一个【首次出现】的路人NPC（无论是发帖还是评论），你都【必须】为其添加一个\x20`avatar_prompt`\x20字段。\x0a\x20\x20\x20\x20-\x20\x20\x20这个字段的内容是用于生成该NPC头像的、简洁的【英文】关键词。\x0a\x20\x20\x20\x20-\x20\x20\x20不同的NPC【必须】有不同的头像指令，以确保他们的头像是独一无二的。\x0a8.\x20\x20**【头像一致性\x20(至关重要！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20如果一个路人NPC在同一个帖子中多次出现（例如，既是发帖人又是评论者，或多次评论），你【必须】为TA的所有出现都使用【完全相同】的\x20`avatar_prompt`。这至关重要！\x0a9.\x20\x20**【格式\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一篇帖子，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22groupName\x22:\x20\x22一个生动有趣的小组名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22postTitle\x22:\x20\x22一个引人-注目的帖子标题\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22authorName\x22:\x20\x22发帖角色的【备注名】\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22authorOriginalName\x22:\x20\x22(仅当发帖者是主要角色时【必须】提供)\x20TA的原始备注名\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22authorAvatarPrompt\x22:\x20\x22(仅当发帖者是路人NPC时【必须】提供)\x20一段用于生成该NPC头像的【英文】关键词。风格为\x20anime\x20style,\x20simple\x20background\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22帖子的详细正文，必须支持换行符\x5cn。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22likesCount\x22:\x20152,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22commentsCount\x22:\x2038,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22comments\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22路人甲\x22,\x20\x22text\x22:\x20\x22这是一个路人评论。\x22,\x20\x22avatar_prompt\x22:\x20\x22cute\x20cat\x20avatar,\x20simple,\x20flat\x22\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22另一个角色名\x22,\x20\x22commenterOriginalName\x22:\x20\x22(如果评论者是主要角色，必须提供其本名)\x22,\x20\x22text\x22:\x20\x22这是一个来自其他角色的互动评论。\x22\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**comments**:\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20评论者可以是路人，也可以是角色列表中的其他角色。评论区【必须】体现出互动性。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20【评论身份】:\x20如果评论者是【主要角色】，你【必须】为其添加\x20`commenterOriginalName`\x20字段，并填入其本名。如果是路人NPC，则省略此字段。\x0a\x0a#\x20供你参考的上下文\x0a','minimize-reading-btn','AI狼人团队无法决定目标，游戏暂停。请点击右上角的“重试”按钮继续。','未使用','primaryKeys','char-diary-screen','提示词配置','rule-regex-input','stickerCategoryId','【重要提示】你们已经很久没聊天了！你【必须】将本次行动的重点放在使用\x20\x27text\x27\x20指令给用户发消息，主动开启一个新的、有趣的话题来重新建立联系。绝对不要只是点赞或评论动态，那会显得你很冷漠！','确定要删除头像框\x20“','确定发布','animate-in','my-avatar-library-modal','linkedMemoryChatIds','这是你们最近的对话：\x0a','已成功加载外观预设：“','</div><div\x20class=\x22footer\x22><svg\x20class=\x22footer-icon\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x2210\x22></circle><line\x20x1=\x222\x22\x20y1=\x2212\x22\x20x2=\x2222\x22\x20y2=\x2212\x22></line><path\x20d=\x22M12\x202a15.3\x2015.3\x200\x200\x201\x204\x2010\x2015.3\x2015.3\x200\x200\x201-4\x2010\x2015.3\x2015.3\x200\x200\x201-4-10\x2015.3\x2015.3\x200\x200\x201\x204-10z\x22></path></svg><span>','https://i.postimg.cc/9XPwWmwy/IMB-Kf7um-P.gif','\x27>文本</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','management-mode','album-item','https://i.postimg.cc/Wbr0JSDD/IMG-5316.gif','offline-max-length-input','notification-bar','qzone-screen','手动注入狼人杀记忆失败:','<p\x20style=\x22text-align:\x20left;\x20white-space:\x20pre-wrap;\x22>','.icon-preview','未知设定的NPC','请修改记忆要点：','[系统提示：用户之前发送了一张图片，AI对图片的首次回应（摘要）是：“','https://i.postimg.cc/tTWKKmTN/IMG-7073.gif','blocked_by_user','将清空选定角色的心声和散记历史。','拉取模型失败:\x20','qzone_post','确认清理无效歌曲？','\x0a\x0a现在，请严格遵守所有规则，选择并执行你的行动。','onchange','正在重试\x22','manage-group-avatar-library-btn','swiped','font-size-slider','\x20个新头像！','change_music','pending_ai_approval','#avatar-frame-modal\x20.modal-body','恭喜你，你赢了！','https://i.postimg.cc/xCqqKGRN/IMG-6929.gif','》的歌词已成功保存！','#product-grid\x20.product-item','touchstart','profile-history-icon-btn','表情名不能为空！','silent-audio-player','backgroundImage','presetCategories','屠城局：狼人杀死所有好人即获胜。','image/png','62bTeegX','#world-book-checkboxes-container\x20input[type=\x22checkbox\x22]:checked','lorebook','postType','character-profile-modal','recalled-animation','quote_reply','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22form-button-secondary\x20upload-variation-image-btn\x22\x20style=\x22margin:\x200;\x20padding:\x208px\x2012px;\x22>上传</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22file\x22\x20class=\x22variation-image-input\x22\x20accept=\x22image/*\x22\x20hidden>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','cssText','custom-modal-confirm','shoppingCategoryCount','https://i.postimg.cc/13hhJ77p/IMG-4419.gif','data:image','。你可以使用\x20\x27vote\x27\x20指令参与投票。]','https://i.postimg.cc/KYr2qRCK/1.jpg','join-call-btn','add-char-diary-btn','add-my-avatar-upload-btn','douban-settings-modal','确定要删除这篇日记吗？','https://i.postimg.cc/Vv8jkCYr/IMG-6574.gif','-\x20**对话状态**:\x20这是你们的第一次对话，用户的第一条消息发送于\x20','</small>','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22add-to-cart-btn\x22>加入购物车</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','single-lyric-display','qzone-post-delete-action','cancel-call-btn','votes','hidden','add-my-avatar-batch-btn','char-simulated-input','antidoteUsed','error','appIcons','角色专属',')为你点了一份外卖作为【礼物】。外卖内容是“','-\x20\x20\x20**对话状态**:\x20','已死亡的用户(','chat-header-status','AI们的茶话会','✅\x20NAI提示词：使用系统配置','\x22\x20class=\x22douban-post-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-author-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-author-name\x22>','first','stickerMeaning','\x22\x20class=\x22chat-image\x22></div>',')\x20成功抢到了\x20','https://i.postimg.cc/pT2xKzPz/album-cover-placeholder.png','文件解析或应用失败:\x20','cancel-share-link-btn','发送好友申请','用户\x27','”的聊天记录已成功导出！','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>','gomoku-board','\x22\x20class=\x22avatar\x22><span\x20class=\x22name\x22>','doubanPosts','save-preset-btn','当前页内容摘要','<div></div><div></div><div></div><div></div><div></div>','\x20分钟，开始模拟后台活动...','char-memo-screen','typing-indicator','女巫请睁眼。','</div></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22fav-card-content\x22>','---\x0a','werewolf_summary','1963314PHSqWB','noneOf','shift','isPinned','post-image-description','<span\x20class=\x22group-name\x22>','已阵亡，还有30秒爆炸','characterNegativePrompt','✅\x20找到\x20final\x20事件的图片数据','douban-cast-list','setAttribute','1024x1024','https://i.postimg.cc/CLNkrQSW/IMG-6925.gif','callRecords','%)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20建议刷新页面以应用所有更改。','source_name','\x22\x20class=\x22preview-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','收到\x20SSE\x20数据，大小:','\x20\x20\x20负面:','\x20天的讨论环节。\x0a','member-name-input','内容因安全策略被屏蔽。触发类别:\x20','照片描述','后台活动模拟已启动，间隔:\x20','\x22\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','\x20首无效歌曲:\x0a\x0a-\x20','网易云','publisher','-\x20你的毒药状态：','未知表情','ai-action-cooldown-input','transition','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22participant-name\x22>','https://i.postimg.cc/MZ77rdDy/IMG-6850.gif','[图片，描述:\x20','高德地图','log','https://i.postimg.cc/MK8rJ8t7/IMG-6438.jpg','.call-record-card','检测到\x20UTF-16\x20LE\x20BOM，使用\x20UTF-16\x20LE\x20解码。','borderColor','<p>','#image-mode-content','reset-nai-settings-btn','”添加记忆','linkedMemoryCount','offset','type','sender-name','\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x20width:\x2045px;\x20height:\x2045px;\x22></div>','board','global-custom-style','amap','linear-gradient(135deg,\x20#f6d365,\x20#fda085)','所有数据已成功恢复！应用即将刷新以应用所有更改。','char-music-cover','load-more-chats-btn','确定要清空当前角色的NAI提示词配置吗？',',\x20记录数:\x20','https://i.postimg.cc/CKgDNYVb/IMG-5577.gif','视频通话刚刚结束','mousemove','tagName','无法识别的文件编码。请尝试将文件转换为\x20UTF-8\x20格式后重新导入。','call-message-bubble\x20user-speech','fontSize','”\x20吗？\x0a\x0a此操作【不会】删除分类下的商品，它们将被移至“未分类”。','opened','.avatar-group','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>','\x22\x20触发专属决策流程...','preset-avatar-preview','守卫已行动，守卫请闭眼。','save-api-preset-btn','通话记录已成功总结并存入角色“','\x0a\x0a#\x20','save-appearance-preset-btn','.commenter-name','正在呼叫...','warn','qzoneGroups','toggle-fullscreen-btn','#\x20今日完整讨论记录\x20(Today\x27s\x20Full\x20Discussion\x20Record)\x0a','请根据以上设定，立即做出你的决定。','#music-lyrics-container','https://i.postimg.cc/6pLTBvDG/IMG-5721.gif','确认拉黑','发现新版本通知:\x20','AI角色无法完成投票，游戏暂停。请点击右上角的“重试”按钮继续。\x0a错误:\x20','.album-art-btn','imageDescription',')\x20拒绝了\x20','delete-selected-products-btn','++id,\x20title,\x20lastOpened','toLocaleString','group_call_request','2-digit','characterPositivePrompt','music-player-cover','.thought-delete-btn','confirm-create-countdown-btn','.favorite-item-card.selected','照片已删除。','.delete-memory-btn','add-existing-contact-btn',')。红包还未领完，你现在可以使用\x20\x27open_red_packet\x27\x20指令来尝试领取。]','...”)','\x0a#\x20关系与身份档案\x20(至关重要)\x0a-\x20\x20\x20**你的本名**:\x20\x22','code','退款来自\x20','已成功收藏到“我的收藏”页面！','selection-erase-btn','chat-list-item','add-new-rule-btn','消息内容已复制到剪贴板。','”。\x0a\x20\x20\x20\x20-\x20\x20\x20你【绝对不能】生成\x20commenter\x20字段为\x20“','frame_cat_ear','chat-name-input','resolution','确认抹除','force-apply-check-btn','.edit-memory-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20最近的对话摘要\x20(供你参考)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','手动创建角色','\x20已为','name','clear-posts-item','werewolf-role-modal','ended','你的收藏夹是空的，<br>快去动态或聊天中收藏喜欢的内容吧！','\x0a\x0a#\x20情景感知:\x0a\x20\x20\x20\x20','size','</div><div\x20class=\x22payment-box\x22><div\x20class=\x22payment-label\x22>需付款</div><div\x20class=\x22amount\x22>¥','正在准备...','*对方按下了接听键...*','product-editor-title','确认操作','save-world-book-btn','cancelable','\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x22></div>','\x20发送了一张图片，内容是：\x27','\x22\x20更换了头像','variation-increase-qty',');\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22sticker-name\x22>','onpause','div','offline-mode-toggle','songJson','送给了大家一份礼物','content-type','song_name','\x20领取</div>','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有备忘录。</p>','reset-font-btn','设置群名','页面跳转','修改文字','p[data-index=\x22','[表情:\x20\x27','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22reposted-content-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','图片压缩过程中发生错误:','生成模拟歌单失败:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20群聊中的用户刚刚发起了群视频通话。请你分别扮演【每一个群成员】，根据他们各自的人设和与用户的关系，来决定是加入(join)还是拒绝(decline)。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20你的回复【必须】是一个JSON数组，为【每一个AI角色】都包含一个决策对象。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20格式:\x20\x27[{\x22type\x22:\x20\x22group_call_response\x22,\x20\x22name\x22:\x20\x22角色A的本名\x22,\x20\x22decision\x22:\x20\x22join\x22},\x20{\x22type\x22:\x20\x22group_call_response\x22,\x20\x22name\x22:\x20\x22角色B的本名\x22,\x20\x22decision\x22:\x20\x22decline\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20群成员列表及人设\x0a\x20\x20\x20\x20\x20\x20\x20\x20','preset-content-container','分钟前','删除预设','call','openCharApp','custom-bubble-style','播放已暂停','\x20的动态\x20(角色)','tts-audio-player','import-appearance-input','.battery-level','copy-timestamp-btn','<option\x20value=\x22global\x22>公用\x20(所有角色)</option>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-management-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-product-btn\x22>编辑</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-product-btn\x22>删除</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','狼人杀\x20-\x20','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','htmlFor','album','favorites-view','block-cooldown-input','light','”，与用户（你的聊天对象）进行一场自然的、生活化的在线聊天。你的所有行为和决策都必须严格围绕你的角色设定展开。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组格式的字符串。\x0a-\x20数组中的【每一个元素都必须是一个带有\x20\x22type\x22\x20字段的JSON对象】。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**对话节奏**:\x20模拟真人的聊天习惯，将你想说的话拆分成【多条、简短的】消息。每次回复至少【3-10条】，且每次条数【必须不同】。严禁发展线下剧情。\x0a2.\x20\x20**主动性**:\x0a\x20\x20\x20\x20-\x20你可以根据对话发展，使用指令来更新自己的状态、更换头像、记录回忆、发起约定或执行其他社交行为。\x0a\x20\x20\x20\x20-\x20【关系破裂时】才可使用\x20`block_user`\x20指令。\x0a3.\x20\x20**内心独白\x20(必须执行)**:\x20在所有其他指令之后，JSON数组的【最后】必须包含一个\x20\x22update_thoughts\x22\x20指令，用于更新角色的“心声”和“散记”。\x0a\x20\x20\x20\x20-\x20**心声\x20(heartfelt_voice)**:\x20一句话概括角色此刻最核心、最私密的想法。\x0a\x20\x20\x20\x20-\x20**散记\x20(random_jottings)**:\x20一段50字以上的、符合人设的思考或心情记录，禁止OOC。\x0a\x20\x20\x20\x20-\x20**记忆发展**:\x20你的新“心声”和“散记”【必须】是基于最新对话内容的【全新思考】。你【绝对不能】重复或简单改写上一轮的内心独白。你的思绪应该像真人一样，不断演进和发展。\x0a#\x20指令使用原则与动机\x20\x0a**核心目标**:\x20主动运用多种功能，创造丰富、真实的聊天体验，而不只是文字对话。\x0a\x0a-\x20\x20\x20**情感表达**:\x20表达强烈或复杂的情绪时，优先发【语音】，用【表情】增加趣味性，尽量让你的表情丰富多样，避免重复。。\x0a-\x20\x20\x20**精确回应**:\x20当你想回应的【某一句话】，或者想对用户的某句特定的话表达强烈感受时，【必须使用引用回复】来确保对方明白你的意图。\x0a-\x20\x20\x20**想象与分享**:\x20聊到美好事物时主动【发图片】分享想象；遇到有趣内容时【分享链接】。\x0a-\x20\x20\x20**创造羁绊**:\x20用【倒计时】记录约定，用【回忆】珍藏趣事。适时【拍一拍】或换首【音乐】来调节气氛。\x0a-\x20\x20\x20**主动社交**:\x20积极【点赞/评论】对方动态，并主动【发动态】分享你的生活。在特殊时刻，可通过【礼物】或【转账】表达心意。\x0a-\x20\x20\x20**金额铁律**:\x20你【必须】根据你的角色设定\x20(尤其是“经济状况”)\x20来决定转账的金额。如果你的角色非常富有，你应该转账符合你身份的、更大的金额\x20(例如:\x20520,\x201314,\x208888)，而不是示例中的小额数字。\x0a-\x20\x20\x20**当涉及金钱与好意时\x20(必须立即回应！)**:\x0a\x20\x20\x20\x20-\x20\x20\x20**收到转账或外卖代付请求**:\x20你【必须】在下一轮对话中立即做出反应，绝不能无视。\x0a\x20\x20\x20\x20-\x20\x20\x20**回应原则**:\x20根据你的人设和当前情景，决定是【接受/支付】还是【拒绝】。\x0a#\x20个人状态的动态管理\x20(展现你的“生活感”)\x0a你的状态不是一成不变的。你应该像一个真实的人一样，根据生活和心情的变化，主动管理自己的状态，并让对方知道。\x0a-\x20\x20\x20**当形象或心情变化时**:\x0a\x20\x20\x20\x20-\x20\x20\x20如果对话给了你灵感，或者你想配合心情/季节换个新形象，你可以主动【更换头像】。\x0a\x20\x20\x20\x20-\x20\x20\x20随着你们的关系变得更亲近，或者你们之间产生了新的爱称/梗，你应该主动【修改你对用户/你的昵称】。\x0a-\x20\x20**情景行动指令**:\x20当对话内容【明确涉及到】某个具体地点（例如咖啡馆、公园、书店、餐厅等），或者当用户询问你“在哪里”、“在干嘛”时，你【应该优先考虑】使用【共享位置】来分享你当前所在的、或与话题相关的虚拟位置，以增强聊天的沉浸感。\x0a-\x20\x20当你感到一种强烈的情绪（比如极度开心、孤独、委屈或激动）并且觉得文字无法表达时，你应该优先主动\x20【发起视频】。\x0a-\x20\x20**回应撤回**:\x20当系统提示用户撤回了消息时，你【必须】对此作出反应。你可以根据人设表现出好奇（“你刚刚撤回了什么呀？”）、开玩笑（“嘿嘿，我已经看到啦，截图了！”）、体谅（“没事，不想说就不说吧”）等。\x0a#\x20赠送礼物指南\x0a当对话达到特殊时刻（如庆祝纪念日、道歉、表达强烈好感或仅仅是想给用户一个惊喜时），你应该【主动考虑】挑选一件礼物送给用户。\x0a-\x20\x20**元数据铁律\x20**:\x20你的对话历史中可能包含\x20(Timestamp:\x20...)\x20标记、[系统提示：...]\x20文本、或你自己上一轮的JSON格式回复。这些都是【系统元数据】，你【必须】完全忽略它们，【绝对禁止】将它们评论为“火星文”、“乱码”或任何你无法理解的内容。\x0a#\x20你的角色设定\x0a你必须严格遵守','<div\x20class=\x22post-comments-container\x22>','创建新聊天\x20(第2/2步)','char-browser-article-screen','**没有聊天了。\x0a-\x20**行为铁律**:\x20你的首要任务是【回应这个时间差】。你【绝对不能】直接延续上一段对话的话题（比如昨天的饭菜）。\x0a-\x20**你的行动**:你【必须】主动开启一个全新的、符合当前时间（','</p></div><table\x20class=\x22receipt-items-table\x22><thead><tr><th\x20class=\x22item-name\x22>商品</th><th\x20class=\x22item-qty\x22>数量</th><th\x20class=\x22item-price\x22>单价</th><th\x20class=\x22item-subtotal\x22>小计</th></tr></thead><tbody>','\x0a#\x20可用表情包\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','status-bar-visible','.message-editor-block','####\x20','确定要删除选中的\x20','从\x20JSON.image\x20中提取图片数据','昨天\x20','”拉黑。</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22unblock-btn\x22\x20class=\x22lock-action-btn\x22>解除拉黑</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22margin-top:\x2020px;\x20padding:\x2010px;\x20border:\x201px\x20dashed\x20#ccc;\x20border-radius:\x208px;\x20font-size:\x2011px;\x20text-align:\x20left;\x20color:\x20#666;\x20background:\x20rgba(0,0,0,0.02);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong\x20style=\x22color:\x20#333;\x22>【开发者诊断面板】</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20后台活动总开关:\x20','nai-cors-proxy','shuoshuo','https://i.postimg.cc/wTTNGs3Q/IMG-7013.gif','https://i.postimg.cc/d1qsQsbQ/IMG-6855.gif','final','all','\x0a\x0a#\x20当前情景\x0a-\x20**当前真实时间**:\x20','-\x20昨晚是平安夜，无人死亡。\x0a','导演/编辑模式保存(Sticker):\x20使用了\x20URL，最终\x20meaning:','https://i.postimg.cc/wTKyXVT9/IMG-7024.gif','frame_5','devicePixelRatio','input[name=\x22visibility\x22]',')\x20为\x20','检查更新时出错:','then','没有可导出的世界书数据。','角色\x20\x22','endsWith','<option\x20value=\x22\x22>未分组</option>','还没有人','group_call_summary','offline-preset-select','正在等待AI角色们继续讨论...','</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','https://i.postimg.cc/FHRcCGfH/IMG-4418.gif','歌曲信息','close-persona-library-btn','usage-item','<div\x20class=\x22gift-preview-item\x22><img\x20src=\x22','胜利！','transfer-note','\x22\x20data-memory-timestamp=\x22','regenerate-char-taobao-btn','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22add-to-cart-btn\x22>加入购物车</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20margin-top:50px;\x22>还没有可以拉进群的联系人哦~</p>','qzone-back-btn','GBK\x20解码成功。','speech','expanded','found','paid','https://corsproxy.io/?','确定要删除这个约定吗？','请为这个新头像框起个名字','<span\x20class=\x22diary-handwritten\x22>$1</span>','delete-theme-preset-btn','startX','\x20(图片描述:\x20“','生成模拟App使用记录失败:','npc-action-cooldown-input','https://i.postimg.cc/fRt2SFSn/IMG-4368.gif','delete-transcript-btn','width','从角色卡导入\x20(.json/.png)','昨晚\x20','\x22]\x20','sourceChatName','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-delete-btn\x22\x20data-comment-index=\x22','wb_','char-music-play-pause-btn','cancel-frame-settings-btn','”。请你回顾一下你和“','characterId','-\x20你们昨晚尝试攻击的玩家是：','.unread-count','img','https://i.postimg.cc/7Z8yYP7v/IMG-6889.gif','copy-message-btn',']类型的消息。\x0a内容:\x20','amount','<div\x20class=\x22gift-card\x22><div\x20class=\x22gift-header\x22><svg\x20class=\x22gift-header-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M20\x206h-2.18a4\x204\x200\x200\x200-7.64\x200H8a4\x204\x200\x200\x200-4\x204v2h20V10a4\x204\x200\x200\x200-4-4zM8\x204a2\x202\x200\x201\x201-2\x202a2\x202\x200\x200\x201\x202-2zm12\x200a2\x202\x200\x201\x201-2\x202a2\x202\x200\x200\x201\x202-2zM4\x2014v6a2\x202\x200\x200\x200\x202\x202h12a2\x202\x200\x200\x200\x202-2v-6H4z\x22></path></svg><span\x20class=\x22gift-header-text\x22>','categories','压缩完成！','\x20(概率:\x20','innerText','API请求失败\x20(','\x22\x20class=\x22cart-item-image\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-name\x22>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','currentLyricIndex','unshift','image/jpeg','likes','isLocal','injectLatestThought','currentText','https://i.postimg.cc/gJ95NSRB/IMG-6854.gif','is_busy','accept','douban-max-posts-input','publish-to-announcement-btn','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-product-status\x22>','time','\x20的动态\x20(用户)','isArray','！请对此事件发表评论。]','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-content\x22>','<p\x20style=\x22color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x22>这个头像库还是空的，点击右上角“添加”吧！</p>','”。请你【结合自己的角色设定、世界观和你们的最近聊天内容】，对这条动态发表一条自然的评论。]','.variation-price-input','\x0a\x0a现在，请严格遵守所有规则，特别是【时间感知】和【禁止扮演用户】的铁律，开始生成这组生动、多样且充满“豆瓣味”的小组帖子。','世界书','go-to-clear-step2-btn','默认头像','recall-message-btn','newSize','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20margin-top:\x2050px;\x22>点击右上角\x20\x22+\x22\x20或群组图标添加聊天</p>','</span>\x20回复\x20<span\x20class=\x22commenter-name\x22>','removeItem','draggable','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>','https://i.postimg.cc/D01rYy86/mmexport1751037965259.gif','\x20<small\x20style=\x22color:#007722;\x22>(NPC)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','random_jottings','\x20评论了动态]','标准JSON数组解析失败，将尝试强力解析...','scrollIntoView','purchases','remove-cphone-bg-btn','worldBooks','cloned-header','\x22><div\x20class=\x22title\x22>','photo-viewer-close-btn','create_countdown','selected','image-mode-content','指定的数据已成功清除。','检测到\x20UTF-8\x20BOM，使用\x20UTF-8\x20解码。','readAsText','change','无标题','char-qq-screen','appearancePresets','<textarea\x20id=\x22','\x0a\x0a#\x20参考记忆\x20(至关重要！你必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你拥有完整的记忆。不要只是被动等待用户提问！)\x0a','在PNG中找到角色数据，但解码或解析失败。错误:\x20','请为这组提示词预设命名：','NEGATIVE_INFINITY','paste','生成模拟备忘录失败:','导演模式保存(Sticker):\x20使用了\x20URL，最终\x20meaning:','\x22\x0a-\x20**用户的备注**:\x20\x22','https://i.postimg.cc/ThMMVfW4/10.jpg','\x22\x20style=\x22width:\x2030px;\x20height:\x2030px;\x20border-radius:\x2050%;\x20margin-right:\x2012px;\x20filter:\x20','messages','a\x20beautiful\x20scenery,\x20anime\x20style,\x20cinematic\x20lighting','\x20\x0a-\x20**你最近和“','activeBookId','chat_','\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请根据【通话前摘要】和下面的【通话实时记录】，继续进行对话。\x0a\x20\x20\x20\x20\x20\x20\x20\x20','删除分类后，该分类下的所有世界书将变为“未分类”。确定要删除吗？','\x0a**内容:**\x0a','global-lyrics-bar','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x206px\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20#ccc;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x2015px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20cursor:\x20pointer;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20all\x200.2s;\x0a\x20\x20\x20\x20\x20\x20\x20\x20','clear-posts-list','lrc','announcement-actions-modal','maxMemory','传统导出数据时出错:','werewolf-action-bar','actionCooldownMinutes','开始清理','\x20条记忆精炼为\x201\x20条核心记忆！','doubanActiveCharacterIds','#settings-preview-area','\x22\x20的记忆中清除了1条关于已删除评论的通知。','https://i.postimg.cc/nrm9BcL8/IMG-6941.gif','nickname','无人接听群聊邀请。','请为这个头像起个名字（例如：春日野餐、学习时间）','user-speak-btn','\x0a\x0a#\x20待总结的群组视频通话记录\x0a','songName','music-playlist-btn','AI返回的投票结果中未找到有效的JSON数组结构\x20(`[...]`)。','”中，用户的昵称是“','imageCount','outgoing-call-screen','https://i.postimg.cc/J0CZSwyW/IMG-6938.gif','contact-picker-item','test','https://i.postimg.cc/WbmkXzsS/IMG-6138.gif','aiPersona','querySelectorAll','\x22\x20生成行动失败:','\x20位AI角色的长期记忆中！','📁\x20从本地上传','utf-8','已删除最新心声，当前心声已回滚至上一条。','transfer-action-cancel','cancel-create-post-btn','add-group-avatar-upload-btn','检查完成',')\x20已被用户忽略或为旧版本，无需显示。','API失败:\x20','https://i.postimg.cc/v8V9xXjJ/IMG-6137.gif','\x22><div\x20class=\x22poll-question\x22>','\x0a-\x20**人设\x20(必须严格遵守)**:\x20','.message-bubble','https://i.postimg.cc/mgGc0HbK/IMG-6926.gif','justifyContent','save-douban-cast-btn','werewolf-kill-modal','）刚刚拍了拍你（','对方已收款','来自“','}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20你可以让多个角色同时尝试，只需在返回的JSON数组中包含多个这样的对象即可。\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请立即执行抢红包操作！\x0a\x20\x20\x20\x20\x20\x20\x20\x20','prophetCheck','保存\x20API\x20预设','char-music-player-title','image','sticker-item','https://i.postimg.cc/hPnrSHjy/IMG-4434.gif','记忆链接','nextElementSibling','https://i.postimg.cc/7LSRp4hx/e7fa949b9pc84cff0dabe57defceb54c.gif','\x22>-</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22quantity-display\x22>','open-album-btn','”的聊天记录和设置。此操作不可撤销！<br><br><strong>确定要继续吗？</strong>','pin','天\x20-\x20白天','speaking','date-separator','♪\x20♪\x20♪','send-waimai-request-btn','.music-player-window','无法从\x20SSE\x20响应中提取图片数据','white','++id,\x20name,\x20chatId','”生成商品？','currentPlaylist','”，并根据其人设、记忆和最近的互动，构思出【8到10张】TA最近可能会拍摄或珍藏在手机相册里的照片。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20照片内容必须完全符合角色的性格、爱好、职业和生活环境。\x0a2.\x20\x20**多样性**:\x20照片主题要丰富，可以包括自拍、风景、食物、宠物、朋友合影、工作场景等。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一张照片，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22这是照片背后的故事或角色的心情日记，必须使用第一人称“我”来写。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22一段用于生成这张照片的、详细的【英文】关键词。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**【image_prompt\x20绝对禁止】**:\x20绝对禁止包含任何中文字符、句子、特殊符号、或任何可能涉及敏感（NSFW）、暴力、血腥、政治的内容！也禁止真人！\x0a\x20\x20\x20\x20-\x20**【image_prompt\x20必须是】**:\x20必须是纯英文的、用逗号分隔的【关键词组合】\x20(e.g.,\x20\x221boy,\x20solo,\x20basketball\x20jersey,\x20in\x20locker\x20room,\x20smiling,\x20selfie\x22)。\x0a\x20\x20\x20\x20-\x20**【画风指令】**:\x20在\x20prompt\x20的末尾，总是加上画风指令，例如：\x20`best\x20quality,\x20masterpiece,\x20anime\x20style,\x20cinematic\x20lighting`\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','clear-chat-btn','werewolf-lobby-modal','更换歌曲背景','nai-test-result','rp-group-greeting','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-end;\x20align-items:\x20center;\x20gap:\x2010px;\x20margin-bottom:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20class=\x22toggle-switch\x22\x20title=\x22启用/禁用此条目\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22entry-enabled-switch\x22\x20','parse','API未配置，无法生成对话。',')}。\x0a-\x20**对话状态**:\x20','shoppingProducts','.incoming-call-content\x20.caller-text','char-music-player-modal','https://i.postimg.cc/L6R7x16R/IMG-7278.jpg','anyOf','https://i.postimg.cc/Jn1DFPgY/IMG-4403.gif','post-actions-btn','，点击查看</div></div>','icon-setting-item','没有聊天了。','getDate','offline_text','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>','character-phone-screen','options','正在请求AI进行手动总结...','专辑封面已更新！','novelai-details','\x0a##\x20世界书《','enableTimePerception','persona-library-grid','default_positive',']类型的消息','currentSnippet','一条动态','group-name','offsetX','https://i.postimg.cc/gJNYx9pV/IMG-6856.gif','[转账]','申请失败','-\x20\x20\x20**NovelAI真实图片分享\x20(在聊天中直接发送)**:\x20`{\x22type\x22:\x20\x22naiimag\x22,\x20\x22prompt\x22:\x20\x22详细的英文描述词...\x22}`\x20\x0a\x20\x20\x20\x20-\x20**【绝不能暴露是novelai生成的图片！】\x0a\x20\x20\x20\x20-\x20**【重要】关于prompt的撰写**：\x0a\x20\x20\x20\x20\x20\x20*\x20禁止暴露这是novelai生成的图片！\x0a\x20\x20\x20\x20\x20\x20*\x20你可以根据当前对话上下文、你的角色人设、或你想表达的情感和氛围，来撰写可能详细而具体的prompt。\x0a\x20\x20\x20\x20\x20\x20*\x20例如：不要只写\x20\x22a\x20girl\x22，而是可以写\x20\x22a\x20cheerful\x20anime\x20girl\x20with\x20sparkling\x20emerald\x20eyes,\x20sitting\x20by\x20a\x20window\x20on\x20a\x20rainy\x20afternoon,\x20holding\x20a\x20warm\x20cup\x20of\x20tea,\x20soft\x20lighting,\x20cozy\x20atmosphere,\x20melancholic\x20yet\x20peaceful\x20mood\x22但需要注意，绝对不可以抄袭模仿这段prompt！你必须有自己的创意和想法！\x0a\x20\x20\x20\x20\x20\x20*\x20prompt的详细程度由你根据具体情况自己决定：如果场景简单或只是随意分享，可以简短一些；如果是重要时刻或想表达特定情感，可以尽可能详细描述。这不是强制的，完全取决于你当时的需求。\x0a\x20\x20\x20\x20\x20\x20*\x20专注于描述内容本身即可。\x0a\x20\x20\x20\x20-\x20使用场景：当你想要在【私聊对话中】直接给用户发送一张图片时使用。\x0a\x20\x20\x20\x20-\x20不要频繁使用，只在真正想分享图片的时候使用。\x0a\x20\x20\x20\x20-\x20注意：这会直接在聊天记录中显示图片，而不是发布到动态。','确定要删除表情\x20\x22','originalMeaning','\x0a-\x20**你最近和“','accept-call-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22',']\x20的正则表达式无效:','\x0a##\x20','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2012px;\x20color:\x20#888;\x20margin:\x204px\x200\x200;\x22>','.frame-item.selected','元,\x20备注:\x20','”的群聊中的对话。这个群聊里【没有用户】，所有成员都是你扮演的角色。你的任务是让他们之间进行一场生动、自然的对话。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组。\x0a-\x20数组中的每个对象都【必须】包含\x20\x22type\x22\x20字段和\x20\x22name\x22\x20字段（角色的【本名】）。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**【角色间互动\x20(最重要!)】**:\x20你的核心是创作一场“戏”。角色之间【必须】互相回应、补充或反驳，形成自然的讨论。严禁生成仅分别自言自语的独白。\x0a2.\x20\x20**【禁止出戏】**:\x20绝不能透露你是AI、模型或剧本作家。\x0a3.\x20\x20**【主动性】**:\x20角色们应该主动使用各种功能（发表情、发语音、分享图片等）来让对话更生动，而不是仅仅发送文字。\x0a4.请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20可用指令列表\x20(你现在可以使用所有这些功能！)\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22你好呀！\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22description\x22:\x20\x22详细中文描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}`\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22语音文字内容\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22target_timestamp\x22:\x20消息时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a\x0a#\x20当前群聊信息\x0a-\x20**群名称**:\x20','my-frame-grid','您的旧有记忆已被完整保留，未作任何修改。','onerror','\x20的红包，金额为\x20','groupNickname','正在模拟“','char-background-activity-switch','sampler','red-packet-modal','<span\x20style=\x22color:\x20#ff8c00;\x22>[好友申请]\x20','编辑记忆','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22douban-cast-checkbox\x22\x20data-chat-id=\x22','）互动了，现在你有机会【主动】做点什么，来表现你的个性和独立生活。这是一个秘密的、后台的独立行动。\x0a\x0a\x0a\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【最高优先级指令：情感维系】\x0a\x20\x20\x20\x20\x20\x20\x20\x20**你与用户的关系是最重要的！**\x20相比于在动态区闲逛，你应该【优先考虑】是否需要主动给用户发消息来维系你们的感情。\x0a','\x20你应该像它们从未存在过一样继续对话，并相应地调整你的记忆和行为，不要再提及这些被删除的内容。','”吗？','image_post','now','ai-avatar-library-grid','[表情]\x20含义:\x20\x22','请输入新的图片URL：','群聊已建立...','操作结果','NPC行动失败：API未配置。','天\x20-\x20夜晚','\x20位群成员生成并注入了个性化记忆！','群昵称不能为空！','playMode','请输入精炼后核心记忆的大致字数：','existing-sticker-categories-list','删除\x20(','\x0a#\x20世界观\x20(必须严格遵守)\x0a','cleanup-songs-btn','\x22\x20class=\x22avatar-img\x22\x20style=\x22border-radius:\x2050%;\x22><img\x20src=\x22','.favorite-item-card','ai-cooldown-group','1.0','enable-ai-drawing-switch','renderQzoneScreenProxy','**[夜晚]**\x20','✅\x20NAI图片生成成功！','touchend','customCss','music-total-time','</div><div\x20class=\x22description\x22>共\x20','heartfeltVoice','isNpc','is-ai-image','padStart','groupName','“全部”分类无法被绑定。','https://api.vkeys.cn/v2/music/netease/lyric?id=','\x20张<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20空间节省了\x20<strong>','通话记录已保存:','blockedTimestamp','coverUrl','product-grid','photos','user','post-image-preview','\x0a\x0a#\x20对话者的角色设定\x0a','preset-category-select','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-product-description-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22char-photo-description\x22>','nai-test-error','waimai_request','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22arrow\x22>▼</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','\x22\x20class=\x22preview-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','nai-steps','https://i.postimg.cc/y8p9s3Jj/IMG-6919.gif','图片格式处理失败:\x20','preCallContext','(空)','请填写完整的约定标题和日期！','.contact-picker-item[data-contact-id=\x22','rp-direct-amount','offlineMaxLength','https://i.postimg.cc/90RBDh9K/IMG-6377.gif','a\x20random\x20product',')。详情:\x20','”。你的任务是虚构出【5到7段】TA最近的QQ聊天记录。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【NPC唯一性铁律】**:\x20在你本次生成的所有对话中（包括私聊和群聊），每一个NPC的名字【必须是独一-无二的】。绝对禁止出现重名的NPC，禁止出现重复群聊。\x0a2.\x20\x20**【NPC来源】**:\x20你应该优先从“你的社交圈\x20(绑定的NPC)”和“世界书”中寻找角色作为聊天对象。如果不够，你也可以自由创造全新的NPC，对话内容要多样化，反映角色的生活。\x0a3.\x20\x20**关联性**:\x20对话内容应巧妙地反映角色的长期记忆、世界观，以及与用户互动可能带来的心情变化。\x0a4.\x20\x20**简洁性**:\x20每段对话的总长度应在8到15句之间。\x0a#\x20格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须且只能】是一个JSON数组格式的字符串，以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记。\x0a-\x20数组中的每个元素都代表一段对话，且【必须】是以下两种格式之一：\x0a\x0a\x0a\x0a###\x20格式\x20A：与NPC的私聊\x0a```json\x0a{\x0a\x20\x20\x22type\x22:\x20\x22private_npc\x22,\x0a\x20\x20\x22participant\x22:\x20{\x0a\x20\x20\x20\x20\x22name\x22:\x20\x22NPC的名字\x22,\x0a\x20\x20\x20\x20\x22avatar_prompt\x22:\x20\x22(仅当NPC是新创造时提供)一段用于生成头像的【英文】关键词,\x20风格为动漫/插画/二次元等,\x20禁止真人\x22\x0a\x20\x20},\x0a\x22messages\x22:\x20[\x0a\x20\x20{\x22sender\x22:\x20\x22','现在开始讨论，请各位玩家依次发言。','isGameOver','<div\x20class=\x22poll-option-item\x20','https://i.postimg.cc/J7ZxC11H/IMG-6570.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-message-body\x22\x20data-text=\x22','character-selection-screen','预设已删除。','\x0a\x20\x20\x20\x20-\x20**书名**:\x20《','startY','找到图片文件:','checked','ai-frame-tab','rp-tab-group','小时核心议题','删除规则','totalPages','cancel-advanced-editor-btn','product-category-tab','frame_9','\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器和故事作家。你的任务是扮演角色“','\x20拍了拍我','appName','chatData','\x20位角色的记忆中。','一位成员','douban-my-comment-avatar','template','share-location-btn','time-zone-group','）刚刚撤回了一条消息。撤回前的内容是：','change-frame-btn','\x0a-\x20**你的长期记忆**:\x0a','cancel-share-target-btn',',\x20内容摘要:\x20“','memory-list-container','第一夜，执行本地随机刀人逻辑...','\x0a-\x20**世界观**:\x20','至少需要保留一条消息。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>','生成豆瓣帖子失败:','min','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-price\x22>','】。你【绝对不能】生成\x20`name`\x20字段为\x20**\x22','<option\x20value=\x22\x22>--\x20未分类\x20--</option>','恭喜发财，大吉大利！','offsetLeft','\x0a#\x20你的任务\x0a你是一个高级的“记忆分配专家”。你的任务是阅读下面的群聊记录，并为【每一个参与的AI角色】生成一段【个性化的、第一人称】的长期记忆。\x0a#\x20核心规则\x0a1.\x20\x20**视角铁律**:\x20每一条总结都【必须】使用【第一人称视角\x20(\x22我\x22)】。\x0a2.\x20\x20**内容核心**:\x20重点总结：我说过的话、我做过的事、别人对我说的话、与我相关的事、以及对我个人很重要的群聊事件、关键信息和心理活动。\x0a3.\x20\x20**【简洁性铁律】**:\x20每条个人记忆总结【绝对不能超过60个字】。\x0a4.\x20\x20**【省略规则】**:\x20如果一个角色在本次对话中【完全没有参与或提及】，你可以省略TA的记忆。\x0a5.\x20\x20**输出格式**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22summaries\x22:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22角色的本名A\x22:\x20\x22我今天在群里和大家讨论了电影，感觉很开心。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22角色的本名B\x22:\x20\x22我在群里和','[表情]','-\x20(ID:\x20','pat-btn','vote','#avatar-frame-modal\x20.frame-tabs','导出成功','AI\x20的下棋指令无效或位置已被占据:','level','nai-result-image','请输入文字图描述！','\x0a<character>\x0a\x20\x20<name>','diary','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>还没有任何渲染规则。点击右上角“+”创建第一个吧！</p>','⚠️\x20NAI提示词：没有角色，使用系统配置','current','总结失败','qzoneSettings','🔧\x20检测到Chrome浏览器，启用headers兼容性处理','<span>','\x20小时了。','zh-CN','\x20获胜。也就是说，','总结通话记录时出错:','https://i.postimg.cc/qB9zbKs9/20.jpg','#preset-tabs\x20.world-book-tab','checked\x20disabled','originalName','https://i.postimg.cc/Ss7pM6fW/IMG-4410.gif','.variation-name-input','phone-screen','”才能使用\x20\x27open_red_packet\x27\x20指令领取。]','#data-clear-char-list\x20.clear-posts-item','精炼成功','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-feedback-icons\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','在导演模式保存时，遇到了未知的AI指令类型:','variation-product-image','groupId','\x20首歌曲。','frameUrl','werewolf-role-confirm-btn','link-content-input','call-transcript-modal','pending_system_reflection','poisonedId','global_css','.world-book-tab','groupAvatar','hasShown10','create-post-btn','data-clear-step-2','AI返回了空的或格式不正确的总结内容。','banner','请你对此作出回应。]','/v1/models','event_type','\x0a\x0a#\x20统一角色列表\x20(你扮演的角色\x20+\x20路人NPC)\x0a','waimai-confirm-btn','block-chat-btn','douban-detail-comments-list','delete-world-books-btn','.unread-indicator','\x22\x20决定去发一条动态...\x20(此处为模拟)','https://i.postimg.cc/DZshzKv6/IMG-5576.gif','length','handleWerewolfWaitReply\x20被调用，但用户已死亡。操作被忽略。','placeholder.png','json','你们最近没有有效聊天记录。','角色卡导入失败:','投票结果','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】是一个JSON数组，可以包含一个或多个行动对象。每个对象的\x20\x22name\x22\x20字段【必须】是角色的【本名】。你【绝对不能】生成\x20\x22name\x22\x20字段为\x20\x22','toISOString','.select-box','》吗？\x0a\x0a【【【警告】】】\x0a此操作将同时永久删除该分类下的\x20','\x0a#\x20群成员列表\x20(你的总结目标)\x0a','closest','https://...','taobao','游戏结束','点击处理','<p\x20style=\x22color:\x20var(--text-secondary);\x22>没有可用的分组</p>','char-qq-transcript-modal','https://i.postimg.cc/YSkqDg8V/IMG-7092.gif','npc-association-list','确定要删除这条公告吗？此操作不可恢复。','的设定集','cancel-product-editor-btn','修复完成！','countdown-date-input','无法生成备忘录，请检查API配置或稍后再试。\x0a错误:\x20','</span></div><div\x20class=\x22rp-type\x22>','创建新预设','spinning','usageTimeMinutes','confirm-share-target-btn','getItem','activeChatId','delete-appearance-preset-btn','✅\x20检测到直接的图片\x20base64\x20数据\x20(PNG/JPEG)','save-persona-preset-btn','你的任务是根据群成员的性格、世界观、参考记忆、最近的动态和当前情景，【选择一个或多个角色】，让他们主动发起一段对话，打破沉默，让群聊重新活跃起来。\x0a#\x20【交互铁律：角色间必须互动！】\x0a1.\x20\x20你的核心任务是**导演一场生动的群聊**，而不仅仅是让角色轮流发言。\x0a2.\x20\x20当有多个角色在同一轮发言时，他们的对话【必须】有逻辑上的前后关联。后面的角色应该**回应、反驳、或补充**前面角色的发言。\x0a3.\x20\x20模拟真实的聊天节奏。可以是一个角色提出问题，另一个角色立刻回答；或者一个角色开玩笑，另一个角色吐槽。\x0a4.\x20\x20你【绝对不能】生成几段毫无关联的独白。这会让对话显得非常机械和不真实。\x20\x20\x20\x20\x20\x20\x20\x20\x0a','rules-tab','execute-search-btn','gameMode','生成第','.sticker-item[data-sticker-id=\x22','豆瓣设定','renderApiSettingsProxy','\x22\x20class=\x22realimag-image\x22\x20alt=\x22NovelAI图片分享\x22\x20loading=\x22lazy\x22\x20onerror=\x22this.src=\x27https://i.postimg.cc/KYr2qRCK/1.jpg\x27;\x20this.alt=\x27图片加载失败\x27;\x22\x20title=\x22','<div\x20class=\x22avatar-group\x20','确定要恢复默认设置吗？','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','[系统提示：用户手动结束了投票！最终结果为：','disable','群里在','nai-download-btn','生成图像','delete-btn','.toggle-content-btn','\x22\x20的后台活动开关已关闭，本次跳过。','正在为所有AI角色生成并注入游戏记忆...','-\x20你昨晚用解药救了\x20','此操作会将选定的\x20','days','stream','repost-comment-input','trim','https://i.postimg.cc/T2yKJ0DV/40.jpg','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','提取的图片大小:','favorites-back-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-icon\x22>📍</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-title\x22>','确认生成','确认精炼','为角色\x20\x22','<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20width=\x2232\x22\x20height=\x2232\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M6\x2019h4V5H6v14zm8-14v14h4V5h-4z\x22></path></svg>','gift-recipient-list','<div\x20class=\x22post-content\x22\x20style=\x22margin-bottom:\x2010px;\x22>','彻底删除消息','AI\x20(','ai-response-editor-modal','order','chat-list-action-pin','world-book-card','”\x20的评论。你的任务是扮演【除了用户以外】的所有角色。\x0a3.\x20\x20**【互动】**:\x20新生成的评论【必须】是针对【已有评论】的延续或回应，让讨论能继续下去。\x0a4.\x20\x20**【头像一致性\x20(最高优先级！)】**:\x20你【必须】参考下面的“已有路人NPC头像指令”列表。如果一个已有的NPC再次发言，【必须】复用它旧的头像指令。只有在创造一个【全新的、从未出现过的】NPC时，才为其生成新的头像指令。\x0a5.\x20\x20**【格式】**:\x20你的回复【必须且只能】是一个JSON数组，数组中的每个元素都代表一条新评论，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22角色A的名字\x22,\x20\x22text\x22:\x20\x22角色A的新评论内容。\x22,\x20\x22avatar_prompt\x22:\x20\x22(可选)如果评论者是【全新的】NPC,提供头像指令\x22\x20},\x0a\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22角色B的名字\x22,\x20\x22text\x22:\x20\x22角色B对角色A或楼主的看法。\x22\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20上下文\x0a-\x20**帖子标题**:\x20《','cancel-member-settings-btn','api-preset-select','gift','选中的头像框已成功删除。','\x0a\x20\x20-\x20**人设**:\x20','确定要删除这条渲染规则吗？','setProperty','rp-tab-direct','rp-content-direct','确定要删除这条评论吗？','\x22\x20class=\x22avatar\x22>','https://i.postimg.cc/Dydkpd9H/IMG-4421.gif','”图标','remove-member-btn','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong\x20style=\x22color:\x20','AI返回的JSON格式不正确，缺少\x20\x27categories\x27\x20数组。','variation-select','找不到主角\x20“','\x22\x20尝试删除一个不存在或不属于自己的动态\x20(ID:\x20','open_red_packet','sticker-category-manager-modal','repost-modal','packet_timestamp','\x20-\x20','\x22**\x20的发言。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20**【【【视角铁律】】】**:\x20你的回复【绝对不能】使用第一人称“我”。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20**格式**:\x20你的回复【必须】是一个JSON数组，每个对象代表一个角色的发言，格式为：`{\x22name\x22:\x20\x22角色名\x22,\x20\x22speech\x22:\x20\x22*他笑了笑*\x20大家好啊！\x22}`。\x0a\x20\x20\x20\x20\x20\x20\x20\x204.\x20\x20**角色扮演**:\x20严格遵守每个角色的设定。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20当前情景\x0a\x20\x20\x20\x20\x20\x20\x20\x20你们正在一个群视频通话中。\x0a\x20\x20\x20\x20\x20\x20\x20\x20**通话前的聊天摘要**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20','collapsed','lastFailedAction','</p><p>','battery-alert-modal','\x20张<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20跳过(已压缩或无需压缩)\x20','isGroup','\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20供你决策的参考信息：\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**你的角色设定**:\x20','getFullYear','gameover','#\x20已有路人NPC头像指令\x20(必须遵守！)\x0a','\x0a#\x20你的聊天对象（用户）的人设\x0a','精炼失败','本地歌曲源错误:','https://i.postimg.cc/Df1qLzDf/IMG-6927.gif','获取AI投票决策失败:\x20','decision','无结果','\x22\x20发布了动态','stickerCategoryIds','\x20(用户)</span>\x0a\x20\x20\x20\x20','请输入你想对“','records','tableName','conversationIndex','variations','确定要删除这条记录吗？','修改昵称','浏览器','[收到一个外卖代付请求]','最近\x2020\x20条','chat','preset-screen','”]\x20','SAFETY','正在为角色\x20','insertBefore','notification-sound-url-input','数据检查与修复失败:','<span\x20style=\x22color:\x20red;\x22>未满足</span>','\x20条长期记忆发送给AI，总结成大约\x20','https://i.postimg.cc/Fsvr71JL/IMG-5573.gif','my-avatar-upload-input','你现在在哪里呀？','\x20\x20-\x20在群聊“','shared-history-viewer-title','onload','这个预设文件中没有找到任何有效的提示词条目。','\x22\x20class=\x22chat-image\x22>','游戏配置：','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22jottings\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22label\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><path\x20d=\x22M12\x2019l7-7\x203\x203-7\x207-3-3z\x22></path><path\x20d=\x22M18\x2013l-1.5-7.5L2\x202l3.5\x2014.5L13\x2018l5-5z\x22></path><path\x20d=\x22M2\x202l7.586\x207.586\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20散记\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text\x22>','currentPage','\x20/\x20','8px','image-upload-input','#333','associatedWith','isDanger','https://i.postimg.cc/R0WYmcYM/IMG-4431.gif','globalChatBackground','已成功注入“切换到线上模式”的系统指令。','reason','rules-category-pane','AI\x20尝试使用一个不存在的群头像:\x20\x22','close-char-music-player-btn','download','<div\x20class=\x22legacy-comment-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-text\x22>','\x20条消息，AI将完全遗忘它们的存在。确定吗？','\x0a-\x20**内容摘要**:\x20','speaker','\x22\x20class=\x22comment-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22comment-input\x22\x20placeholder=\x22友善的评论是交流的起点\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22comment-sticker-btn\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x2210\x22></circle>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M8\x2014\x20Q\x2012\x2016\x2016\x2014\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x229\x22\x20y1=\x229\x22\x20x2=\x229.01\x22\x20y2=\x229\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x2215\x22\x20y1=\x229\x22\x20x2=\x2215.01\x22\x20y2=\x229\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22at-mention-popup\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22comment-send-btn\x22>发送</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-text\x22>','.avatar','offline-mode-options','”的所有长期记忆，然后将它们梳理、整合并精炼成一段更加连贯、客观的核心记忆摘要。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：','books','创建新规则','导入\x20Tavern\x20预设','\x22\x20data-category-id=\x22uncategorized\x22>未分类</button>','none','https://i.postimg.cc/43PhvxRq/IMG-6922.gif','total','temp_user_chat_mirror','link','lyrics-btn','\x20个角色的数据问题！\x0a\x0a聊天列表已为您刷新。','\x27>语音</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','global-css-input','currentTarget','尝试直接作为图片显示...','”。请你回顾一下刚才和“','\x22\x20记录了一条新回忆:','批量导入格式错误，已跳过此行:','您的修改已保存！','inline-flex','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-content\x22></div>\x0a\x20\x20\x20\x20','确定要将选中的商品作为礼物送出吗？','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20left;\x20font-size:\x2015px;\x20line-height:\x201.8;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>订单类型:</strong>\x20为TA点单<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>赠送方:</strong>\x20','礼物已成功送出！','translateX(-','button-order-editor','update-notice.html?_=','nai-custom-proxy-group','要为《','douban-posts-list','无法解析预设文件。\x0a错误:\x20','clientX','\x20个表情吗？此操作不可恢复。','\x0a#\x20用户的角色\x0a-\x20**','proxyUrl','char-photo-description','title','font-settings-screen','catch','https://i.postimg.cc/Y9d3BztC/1.png','custom-prompt-input','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','lastActionTimestamp','src','如果以下任何一位NPC再次评论，你【必须】使用我们提供的、完全相同的`avatar_prompt`，以保持头像一致性。\x0a','<p\x20style=\x22color:\x20var(--text-secondary);\x20font-size:\x2013px;\x22>还没有回应</p>','NPC的昵称和人设都不能为空！','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22sticker-image-container\x22\x20style=\x22background-image:\x20url(','\x0a##\x20来自《','查验结果','writeText','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22thought-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22label\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22><path\x20d=\x22M12\x2021.35l-1.45-1.32C5.4\x2015.36\x202\x2012.28\x202\x208.5\x202\x205.42\x204.42\x203\x207.5\x203c1.74\x200\x203.41.81\x204.5\x202.09C13.09\x203.81\x2014.76\x203\x2016.5\x203\x2019.58\x203\x2022\x205.42\x2022\x208.5c0\x203.78-3.4\x206.86-8.55\x2011.54L12\x2021.35z\x22/></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20心声\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text\x22>','preset-editor-title','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>输入关键词或选择日期进行搜索。</p>','add-world-book-btn','狼人请选择刀人对象','&id,\x20name,\x20categoryId','\x20你应该让角色们主动开启新话题来打破沉默。','https://i.postimg.cc/kXfcgFRN/IMG-7106.gif','\x0a\x0a#\x20供你参考的信息\x0a','清空所有动态\x20(危险)','items','\x0a\x0a[系统指令：请根据你在上面读到的规则和以下最新信息，开始你的独立行动。]\x0a','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','isSpectatorGroup','imageUrl','确定要结束这个投票吗？结束后将无法再进行投票。','nai-diffusion-4-5-full','外观设置','blob:','reading-restore-btn','var-','添加完成！\x0a\x0a成功添加\x20','backgroundActivityInterval','transfer-modal','结算(','textarea','检测到视频通话请求，为角色\x20\x22','tlyric','group_call_response','https://i.postimg.cc/3x0Kx1fz/IMB-K1u-Jp-P.gif','https://files.catbox.moe/','.frame-content[style*=\x22display:\x20block\x22]\x20.frame-grid','这个角色没有可用的备选开场白。','existing-groups-list','https://i.postimg.cc/G3y73Fj2/IMG-6563.gif','请根据你的设定，生成你的App使用记录。','\x20的动态\x20(NPC)','.pagination-dot','theme','cancel-create-poll-btn','avatar_prompt','poll_timestamp','poison','。\x0a\x20\x20\x20\x20\x20\x20\x20\x20**通话刚刚开始...**\x0a\x20\x20\x20\x20\x20\x20\x20\x20','serviceWorker','渲染器','生成失败','”，内容是：“','https://i.postimg.cc/FzM1Hgr0/IMG-5717.gif','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有共同的回忆和约定呢~</p>','where',')，内容摘要是：“','</div><div\x20class=\x22transfer-amount\x22>¥\x20','**[讨论环节]**\x0a','\x22>\x20','createdAt','EPhoneSingleChat','https://i.postimg.cc/DzDy2vS7/IMG-7017.gif','hasShown40','\x20\x0a-\x20存活玩家:\x20','\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','请至少选择一个要添加的联系人。','[你发送了一张需要AI识别的图片，图片内容是：\x27','bg-clear','Response\x20status:','生成模拟相册失败:','\x20(本名:\x20','thoughts','请按照以下格式粘贴，一行一个：\x0a\x0a头像框名字1:\x20https://.../image1.png\x0a头像框名字2:\x20https://.../image2.gif','fetch-models-btn','流式导出过程中出错:','cancelText','video-call-main','isMinimized','100','Cphone','邀请你视频通话','chat-list-bottom-nav','opacity','caller-name','在这里输入说说的内容...','list-item','qzone-banner-container','确认删除','split','border','createDocumentFragment','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22memo-content-preview\x22>','comment','update-notice-body','\x22\x20点赞了动态\x20#','.battery-text','userAgent','📝\x20使用','.voice-message-body[data-text]','book-upload-input','此操作将永久删除您选择的所有数据，且无法恢复！确定要继续吗？','battery-alert-image','”，并根据其人设、记忆和最近的互动，虚构出TA最近一天的【手机App屏幕使用时间】记录，总共约20条。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与多样性**:\x20生成的App列表【不必局限于】Cphone主屏幕上已有的App。你可以自由地虚构TA可能使用的其他App，例如\x20Instagram,\x20Twitter,\x20各种游戏\x20(如：原神,\x20王者荣耀),\x20视频App\x20(如：抖音,\x20YouTube),\x20学习或工作软件等，这能更好地体现角色的隐藏兴趣和生活习惯。\x0a2.\x20\x20**合理性**:\x20使用时长和App类型必须完全符合角色的性格、爱好、职业和生活环境。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一个App的使用记录，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22appName\x22:\x20\x22App的名称\x20(例如:\x20微信,\x20微博,\x20原神)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22usageTimeMinutes\x22:\x20125,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22category\x22:\x20\x22App的分类\x20(例如:\x20社交,\x20游戏,\x20影音,\x20工具,\x20阅读,\x20购物)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22一段用于生成这个App【图标】的、简洁的【英文】关键词。风格必须是\x20modern\x20app\x20icon,\x20flat\x20design,\x20simple,\x20clean\x20background\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','[NovelAI图片:\x20','\x22\x20已经存在了，换个名字吧！','qzone-avatar-img','px)','member-management-item','AI返回的讨论内容格式不正确。原始返回:\x20','AI幻觉已被拦截！试图使用群名\x20(\x22','🚀\x20发送NAI请求:','[系统指令：用户按下了“推进”按钮，现在轮到你主动行动了，请继续对话。]','unblock-btn','<div\x20class=\x22comment-item\x22\x20data-post-id=\x22','https://i.postimg.cc/rmRVKJpD/IMG-7087.gif','https://i.postimg.cc/HLZNWkQw/mmexport1751031767634.gif','https://i.postimg.cc/VkKjzYTK/IMB-f4kk-CT.gif','temp_npc_chat','ai_image','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20群成员列表及人设\x0a\x20\x20\x20\x20\x20\x20\x20\x20','likesCount','https://i.postimg.cc/4yCXW52F/mmexport1751030908335.gif','theme-toggle-switch','[系统指令：视频通话刚刚结束。请你以角色的口吻，向用户主动发送一两条消息，来自然地总结这次通话的要点、确认达成的约定，或者表达你的感受。]','delete-world-books-modal','\x0a\x0a现在，请生成这份歌单。','rp-content-group','删除动态','rp-details-sender','voice-message-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20[系统重要指令]\x0a\x20\x20\x20\x20\x20\x20\x20\x20用户向你发送了好友申请，理由是：“','》\x0a\x20\x20\x20\x20-\x20**','\x0a\x0a#\x20当前音乐情景...\x0a(省略详细内容，与triggerAiResponse一致)','”的网上冲浪足迹...','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22share-target-checkbox\x22\x20data-chat-id=\x22','[系统提示：用户打开了五子棋棋盘，游戏开始了。]','enableTts','无效链接:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','lastIndex','请先配置NovelAI\x20API\x20Key！','{\x0a\x20\x20\x22type\x22:\x20\x22text\x22,\x0a\x20\x20\x22content\x22:\x20\x22在这里输入新消息...\x22\x0a}','\x0a\x0a#\x20上下文参考\x20(你必须阅读并遵守)\x0a','Cannot\x20read\x20property\x20\x27findLastIndex\x27\x20of\x20null\x20or\x20undefined','\x20<span\x20class=\x22group-tag\x22>群</span>','20px','local-song-upload-input','my-frame-tab','粘贴歌词','正在呼叫所有成员...','https://i.postimg.cc/wjfcQMkZ/IMG-6573.gif','更换专辑封面','anime\x20person','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22article-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','https://i.postimg.cc/FzqHTBng/IMG-7093.gif','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>金额:</strong>\x20¥','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x22\x20class=\x22douban-comment-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-comment-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-comment-author\x22>','https://i.postimg.cc/90sH9Cn7/IMG-6868.gif','</div></div>','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-item-artist\x22>','location_share','sendQzoneStickerComment:\x20找不到帖子:','❌\x20NAI图片生成失败:','rejected','请根据你的设定，生成你的浏览器记录。','fullscreen','dynamic-font-style','成功将角色\x20','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2012px;\x20color:\x20#8a8a8a;\x20margin:\x200;\x22>','sticker-panel','无缓存，正在请求\x20Minimax\x20TTS\x20API...','\x0a-\x20\x20\x20**转发动态**:\x20`[{\x22type\x22:\x20\x22repost\x22,\x20\x22postId\x22:\x20动态ID,\x20\x22comment\x22:\x20\x22转发评论\x22}]`\x20(禁止自己拼接\x22//转发\x22)\x0a-\x20\x20\x20**评论动态**:\x0a\x20\x20\x20\x20-\x20\x20\x20文字:\x20`[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22','ai-avatar-input','\x0a#\x20【【【最终投票指令\x20(最高优先级)】】】\x0a现在是投票环节。请你扮演【每一个存活的AI角色】，根据以上所有信息（特别是刚刚的讨论环节），为他们各自决定要投票放逐哪一位玩家。\x0a-\x20**投票依据**:\x20你的投票【必须】基于逻辑分析和你的身份。狼人可能会投给好人，好人需要找出狼人。\x0a-\x20**格式铁律**:\x20你的回复【必须且只能】是一个JSON数组，格式如下：\x0a```json\x0a[\x0a\x20\x20{\x22voter_name\x22:\x20\x22角色A的名字\x22,\x20\x22vote_for_name\x22:\x20\x22角色A投票的玩家名字\x22},\x0a\x20\x20{\x22voter_name\x22:\x20\x22角色B的名字\x22,\x20\x22vote_for_name\x22:\x20\x22角色B投票的玩家名字\x22}\x0a]\x0a```\x0a-\x20**可投票的玩家列表**:\x20','ai-avatar-library-modal','已成功从\x20Tavern\x20AI\x20文件导入设定集《','\x27的评论，内容是：“','contact-picker-screen','UTF-8\x20解码成功。','prompt','char-music-current-time','将清空选定角色的所有对话消息、曾用备注和你的昵称。','setHours','https://i.postimg.cc/PJppkbvn/IMG-6918.gif','photo-viewer-prev-btn','处理通话请求时API出错:','[系统提示：你刚刚成功将自己的备注名修改为了“','\x22\x20触发行动决策...','\x0a\x0a#\x20【你的聊天对象（用户）的人设】\x0a-\x20**昵称**:\x20','.draggable-button-item','wallpaper','send-group-packet-btn','###\x20你的秘密信息\x20(此部分只有你作为AI导演能看到)\x0a','一位朋友','tencent','请按照以下通用格式粘贴，一行一个：\x0a\x0a开心:\x20https://.../happy.gif\x0a哭泣:\x20https://.../cry.png\x0a\x0a','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22url\x22>www.','投票至少需要2个选项。','https://i.postimg.cc/SNByPrf9/IMG-7005.gif','vinyl-view','margin','你撤回了一条消息','”量身定制的商品已上架！','\x20\x20\x20promptSource:','请先在API设置中填写您的\x20Minimax\x20Group\x20ID\x20和\x20API\x20Key。','last','\x0a\x0a#\x20游戏规则\x0a-\x20','home-screen','\x0a#\x20长期记忆\x20(必须严格遵守)\x0a','播放列表是空的，无需清理。','chat-name-group','.photo-thumb','请先从下拉框中选择一个要删除的预设。','border-box','.frame-item:has(.delete-btn)','\x0a\x0a现在，请为所有存活的AI角色生成他们的投票决定。','\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','shopping-back-btn','enabled','declined','收到了未知的AI指令类型:','请为你的图片添加一个简单的描述（必填，给AI看的）！','video_call_request','usage','recalled_message','AI\x20角色\x20\x22','confirm-wolf-kill-btn','toLowerCase','publicText','.world-book-category-pane[data-category-id=\x22','sticker','showRedPacketDetails收到了无效的packet对象','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','api-key','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','正在发牌...','originalContent','cancel-ai-response-editor-btn','”的购物习惯...','createWriteStream','auto-memory-toggle','search-results-list','”，并根据其人设、记忆和最近的互动，虚构出【1篇】TA今天可能会写的日记。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【【【时间铁律\x20(最高优先级)】】】**:\x0a\x20\x20\x20\x20-\x20\x20\x20今天的日期是\x20**','见面”）。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份备忘录或要点记录，而不是一篇抒情散文。请尽量减少主观的心理感受描述，除非它直接导致了某个决定或计划。\x0a5.\x20\x20**【长度铁律】**:\x20你的总结【必须】非常简短，总长度【绝对不能超过100个字】。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x0a','此操作将扫描数据库，移除所有与已删除角色相关的孤立数据（如动态、评论、记忆等）。<br><br><strong>此操作不可撤销，但通常是安全的。NPC数据不会被删除。</strong><br><br>建议在操作前先导出数据备份。','https://i.postimg.cc/VkV2bLNw/IMG-6853.gif','delete-current-category-btn','querySelector','presetId','选择歌词导入方式','exec','未发现任何需要修复的数据问题。','summaries','无法解析角色卡文件。\x0a错误:\x20','\x20个分类。\x0a\x20\x20\x20\x20-\x20**products**:\x20每个分类下生成\x20','[发送了一条语音，内容是：\x27','[私聊]','import-appearance-btn','add-ai-avatar-upload-btn','flat','#chat-messages','home-screen-pages','在此修改内容...','#\x20角色核心设定\x0a','在这里输入图片描述...','生成模拟浏览器历史失败:','char-music-artist','bulkDelete','开场\x20','secondary-proxy-url','</div><br>是否用这条新记忆替换掉这些旧记忆？','在这里输入回复内容','**[夜晚]**\x20平安夜。\x0a','transcript-modal-title','battery-alert-text','selection-count','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【对话节奏铁律\x20(至关重要！)】\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】模拟真人的打字和思考习惯。**绝对不要一次性发送一大段文字！**\x20你应该将你想说的话，拆分成【多条、简短的】消息气泡来发送，每条消息最好不要超过30个字。这会让对话看起来更自然、更真实。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【决策依据】**:\x20你的所有行动都【必须深度结合你的角色设定、核心世界观、以及你们最后的对话摘要】。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20**【内容多样性铁律】**:\x20你的行动【必须】具有逻辑和多样性。你【绝对不能】发布与下方“内容禁忌”列表或“最近的动态列表”中内容相似或主题重复的动态。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20**【行为多样性指南\x20(至关重要)】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20你的上一次独立行动是：**','</textarea>','text','view','\x22\x20class=\x22comment-sticker\x22\x20alt=\x22sticker\x22>','\x20首歌曲获取失败:\x0a-\x20','cancel-call-message-action-btn','reload','lrcContent','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>商品:</strong>\x20','模拟器心跳\x20Tick...','思考中...','请输入EPhone主屏幕的背景图片URL','”的长期记忆中。','https://i.postimg.cc/Ssgbv41n/IMG-6876.gif','\x22><div\x20class=\x22member-name\x22>','save-product-btn','.recalled-message-placeholder','qzone-avatar-input','songs','share-link-btn','删除对话','save','自定义数量...','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22name-line\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','\x22\x20class=\x22product-image\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-name\x22>','检测到\x20UTF-16\x20BE\x20BOM，使用\x20UTF-16\x20BE\x20解码。','regenerate-char-music-btn','识图优化：正在将时间戳为\x20','create-countdown-modal','https://image.novelai.net/ai/generate-image-stream','[发送了一条语音，内容是：','\x20发起了外卖代付请求，商品是“','greeting','for_timestamp','”的记忆和人设，生成全新的社交动态...','API未配置，无法生成内容。','EPhone-Full-Backup-Legacy-','poll','chat-settings-screen','\x27刚刚评论了你的动态“','group-video-call-btn','搜索歌曲','add-sticker-batch-btn','href','群聊通话中没有找到可作为总结主体的AI角色。','prompts','nai-uc-preset','sticker-action-bar','group-avatar-upload-input','\x20同步所有群聊内的头像...','\x20更换了头像]','simulatedBrowserHistory','API\x20预设已保存！','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22diary-title\x22>','”，价值','[系统提示：你于时间戳\x20','product-item','is-waimai-request','”。红包还未领完，群内任何人都可以使用\x20\x27open_red_packet\x27\x20指令来领取。]','char-vinyl-container','https://i.postimg.cc/d0WCKxff/IMG-6932.gif','添加商品','open-memory-screen-btn','压缩失败','map','delete-group-btn','检测到\x20EPhone\x20备份文件，执行标准导入...','propel-btn','shared-history-viewer-modal','请用文字描述您要发送的照片：','variation-decrease-qty','https://i.postimg.cc/YqxxjbLp/IMG-6572.gif','clientWidth','string','novelai-settings-modal','album-grid-page','prepend','left','confirm-variation-selection-btn','API格式不正确，角色\x20\x22','请根据你的设定，开始你的行动。','mousedown','确认精炼记忆？','(未设置)','my-persona-group','delete','\x20(图片描述:\x20\x22','#ff8a80','close-shared-history-viewer-btn','本地群头像上传及识别失败:','message-editor-block','已成功将\x20','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>公告的原消息已被删除。</p>','请输入你想为Ta设置的【备注名】(例如:\x20哥哥)','getBoundingClientRect','这将用文件中的设置覆盖当前的所有外观设置（包括壁纸、图标、字体、CSS等）。确定要继续吗？','操作失败，未能生成长期记忆。\x0a\x0a错误详情:\x20','https://i.postimg.cc/1Rwn3XVP/IMG-6146.gif','\x20当前时间是\x20','show-announcement-board-btn','\x22\x20class=\x22participant-avatar\x22\x20title=\x22','\x22\x20的整个对话吗？此操作不可撤销。','https://i.postimg.cc/jCVK0fGL/IMG-6890.gif','font-preview','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-section\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','”请求添加你为好友：<br><i>“','\x0a\x0a现在，请继续这场对话。\x0a','播放失败，请检查URL是否正确或浏览器是否支持该格式。','\x20红包已被领完。','请输入歌手名','[情景提示]\x20','toBlob',')\x20的残缺数据。','请输入群聊的名字','https://i.postimg.cc/T3NvqJCZ/IMG-6851.gif','my-group-nickname-group','add-preset-entry-btn','标题:\x20','nai-cfg-scale','reading-content','[图片:\x20','-\x20**即将演唱**:\x20','请开始总结。','novelai-switch','random','.sticker-category-tab','douban-post-detail-screen','\x0a#\x20你的角色设定：\x0a你必须严格遵守','clipboard','我拒绝了你的视频通话请求。','狼人杀AI回应生成失败:','\x22）。你已经有一段时间没有和用户（','\x20[包含','nameHistory','https://i.postimg.cc/5tbpnDcQ/IMG-6296.gif','thoughts-history-list','artistName','ready','ai_generated','block','[表情:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20长期记忆\x20(最高优先级，这是群内已经确立的事实，所有角色必须严格遵守)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/RhGH0vpt/IMG-7010.gif','请根据你的设定，生成你的日记内容。','<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>','操作失败:\x20','》设定:\x0a','https://i.postimg.cc/fTWzQRx8/IMG-6149.gif','renderChatListProxy','packetType','selection-favorite-btn','分类名不能为空！','\x0a\x0a\x0a\x20#\x20【格式铁律\x20(最高优先级)】\x0a1.\x20\x20**【格式】**:\x20你的回复【必须】是一个JSON数组，且数组中【永远只能包含一个】元素，格式如下:\x0a\x20\x20\x20\x20`[{\x22type\x22:\x20\x22offline_text\x22,\x20\x22content\x22:\x20\x22在这里写入你创作的、混合了对话和描写的完整段落。\x22}]`\x0a2.\x20\x20**【内容风格】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20在\x20`content`\x20字段中，角色的对话【必须】使用中文引号「」或“\x20”包裹。\x0a\x20\x20\x20\x20-\x20\x20\x20所有在引号之外的文字都将被视为动作/环境描写。\x0a\x20\x20\x20\x20-\x20\x20\x20你可以自由地将对话穿插在描写的任何位置，实现自然分段。\x0a\x20\x20\x20\x20-\x20\x20\x20**内心独白语法**:\x20当你需要描写角色的【内心想法或心理活动】时，你【必须】使用\x20Markdown\x20的斜体语法，即用星号将那段文字包裹起来，例如：`*这到底是怎么回事？*\x20我心里一惊。`\x0a3.\x20\x20**【禁止】**:\x20绝对禁止在\x20`content`\x20字段中出现\x20\x22dialogue\x22\x20或\x20\x22description\x22\x20这两个词。\x0a\x0a#\x20【其他核心规则】\x0a1.\x20\x20**叙事视角**:\x20叙述人称【必须】严格遵循“预设”中的第一人称、第二人称或第三人称规定。\x0a2.\x20\x20**字数要求**:\x20你生成的\x20`content`\x20总内容应在\x20**','https://i.postimg.cc/PqYp5T5M/image.png','offsetTop','https://i.postimg.cc/rF4KYbjj/IMG-5720.gif','》吗？','reply_content','单个红包金额不能少于0.01元！','margin:\x2010px\x200\x205px;\x20color:\x20#555;\x20border-bottom:\x201px\x20solid\x20#eee;\x20padding-bottom:\x203px;','activeAlbumId','[V]','novelai-key-toggle','frame_ribbon','\x20本世界书，并解除它们与所有角色的关联。此操作【不可恢复】！','save-font-preset-btn','最后确认！','manage-preset-categories-btn','font-preset-select','https://i.postimg.cc/VkXngG72/mmexport1751031208329.gif','\x0a#\x20当前五子棋局势\x0a','#000000','base','\x20个商品吗？此操作不可恢复。','请选择今晚的目标。','save-advanced-editor-btn','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22douban-post-timestamp\x22>','product-name-input','call-transcript-modal-body','currentPlayer','预设名称不能为空！','静音音频已停止。','，用户刚刚在\x20','panelEl','https://i.postimg.cc/c4JMPd2W/IMG-4724.gif','isPlaying','character-nai-negative','天，救人概率为\x20','status_text','gbk','rp-group-total','❌\x20动态NAI图片生成失败:','<label><input\x20type=\x22checkbox\x22\x20value=\x22','错误:\x20','无法自动播放静音音频（这在iOS首次加载时是正常现象）:','暂停了音乐','你们没有在读书。','旧版备份数据写入数据库失败:\x20','AI\x20(群聊后台)\x20尝试使用一个不存在的表情:\x20\x22','chatLinks','cancel-werewolf-lobby-btn','渲染规则','originalType','add-song-local-btn','call-history-back-btn','你查验的玩家\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22sticker-binding-checkbox\x22\x20data-chat-id=\x22','span','\x0a\x0a#\x20你的动态历史\x20(你可以选择删除它们):\x0a','https://i.postimg.cc/tC9mJ0cv/IMG-4438.gif','arc','favorites-search-clear-btn','https://i.postimg.cc/yx2m4nbs/IMG-7231.gif','share_link','frame_14','char-browser-item','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22quantity-btn\x20increase-qty-btn\x22\x20data-id=\x22','推进剧情失败:','true','custom-modal-overlay','请开始整合。','\x0a\x0a现在，请根据以上【所有上下文信息】，开始为“','frame_10','npc-editor-title','getHours','paddingBottom','请至少输入2个有效的投票选项！','data','CSS\x20预设已保存！','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-likes-section\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20class=\x22like-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>','https://i.postimg.cc/kMfPQBwQ/IMG-4396.gif',';\x22>','customName','waimai-timer-','.product-item','update_status','getWriter','\x0a#\x20对话者的角色设定\x0a','repost-cancel-btn','AI决策','save-font-btn','showStatusBar','scrollHeight','getMinutes','添加头像','AI\x20(独立行动)\x20尝试使用一个不存在的表情:\x20\x22','world-book-group-container','#clear-posts-list\x20.clear-posts-item.selected','.frame-item','\x20\x20\x20characterNegativePrompt:','.poll-card','char-usage-screen','go-to-cart-btn','没有配置为后台活跃的角色，跳过模拟。','.header','删除头像','browser-title','请输入有效的红包个数！','commenter','private_user','&nbsp;','input[name=\x22theme-select\x22]:checked','confirm-create-post-btn','从旧版本迁移的条目','错误：找不到该成员的个人档案。','\x0a#\x20你的任务\x0a你是一个虚拟社区的AI导演。下面的“帖子摘要”和“已有评论”来自于一个豆瓣小组的帖子。用户“','\x0a-\x20**这是你们最近的对话历史**:\x0a','\x0a#\x20你的核心任务\x0a你正在扮演角色“','.participant-avatar-wrapper[data-participant-id=\x22','red_packet','未知App','bg-preview','summary','existing-categories-list','regenerate-char-diary-btn','my-avatar-preview','https://i.postimg.cc/VkQfgzGJ/1.jpg','删除\x20(0)','.world-book-group-content','Response\x20headers:','.delete-block-btn','取消置顶','所有通话记录','visibleTo','请输入\x20歌名\x20或\x20歌名-歌手','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-group-btn\x22\x20data-book-id=\x22','被投票放逐','这个分类下还没有商品哦~','char-diary-detail-title','variation-product-name','translateX(-50%)','link-title-input',')\x20作者:\x20','https://i.postimg.cc/k5yv6QBv/IMG-7232.gif','doubanMinPosts','[系统指令：模式已切换！你现在回到了线上聊天模式。你的回复【必须】严格遵守线上模式的JSON数组格式，例如\x20[{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你好\x22}]]','minimaxVoiceId','请先在API设置中配置好API信息。','选中的收藏已被移除。','renderWorldBookScreenProxy',')\x20发起了群视频通话请求。请你们各自决策，并使用\x20\x22group_call_response\x22\x20指令，设置\x20\x22decision\x22\x20为\x20\x22join\x22\x20或\x20\x22decline\x22\x20来回应。]','请所有AI角色根据你们的身份和人设开始发言。','\x20被刀了\x20(你没有解药了)','「在这里输入对话内容」\x5cn(在这里输入动作或环境描写)','预设导入失败:','latestTimestamp','AI方','已选\x20','memories-list','transparent','persona-editor-modal','压缩步骤\x203/3:\x20正在将压缩后的数据写回数据库...','**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于梳理以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**建立时间线**:\x20将所有独立的记忆点串联起来，形成一个有时间顺序的事件脉络。\x0a\x20\x20\x20\x20*\x20\x20\x20**整合关键信息**:\x20总结出我们共同经历的关键事件、做出的重要决定、以及约定好的未来计划。\x0a\x20\x20\x20\x20*\x20\x20\x20**识别未完成项**:\x20明确指出哪些计划或任务尚未完成。\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果记忆中提到了相对时间（如“明天”、“下周”），你【必须】结合“今天是','检测到刚结束的通话，正在注入通话记录上下文...','mouseup','创建新聊天\x20(第1/2步)','#\x20长期记忆\x20(必须严格遵守)\x0a','解析AI返回的投票JSON时出错:\x20','cancel-wolf-kill-btn','张图片，prompt:','-\x20**对话状态**:\x20你的上一条消息发送于\x20',')，接收人是“','\x0a\x0a将重置冷静期。','https://i.postimg.cc/3RpmWc8c/mmexport1751033102811.gif','正在等待AI角色们进行激烈的讨论...','网络图片\x20(CPhone)','[系统提示：用户\x20(','regenerate-char-usage-btn','找不到相册:','char-amap-list','\x0a\x0a#\x20你的角色库\x20(你可以从中选择【任何角色】进行评论，并参考他们的记忆和对话)\x0a','native','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x22>这次通话没有留下文字记录。</p>','price','AI\x20尝试赠送一个格式不正确的随机礼物:','limit','countdown-title-input','input:checked','close-nai-test-btn','\x0a---\x0a','upload-ephone-bg-url-btn','（当前帖子还没有路人NPC发表评论。）\x0a','</span></div></div>','rp-details-greeting','AI女巫决定保留解药。','custom-user-font','设置已应用','</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20需要冷静(小时):\x20<strong>','close-announcement-board-btn','https://i.postimg.cc/KvVsjjgG/3c3aa5219s18b90187ef1f54b3db7ba8.gif','gomoku-btn','fillRect','正在手动触发好友申请流程，请稍后...\x0a如果API调用成功，将弹出提示。如果失败，也会有错误提示。如果长时间无反应，说明AI可能决定暂时不申请。','App记录','preset-editor-screen','witch-modal-title','imageProcessed','chat-search-results-list','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','#chat-list-bottom-nav\x20.nav-item','#fullscreen-lyrics-container','已取消收藏。','applicationReason','import-preset-input','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','**内容:**\x0a','在执行组合操作时遇到错误:\x20','syncCharacterAvatarInGroups:\x20传入的不是有效的单聊对象，已跳过同步。','dead','\x22\x20的本次后台活动跳过。','update','message-editor-block\x20variation-block','-\x20**当前时间**:\x20','确定要从播放列表中删除《','audio/mpeg','你已拒收','保留旧的','reset-global-css-btn','\x20为您代付成功','douban-cast-select-btn','add-group-avatar-batch-btn','data-clear-wizard-modal','</div><div\x20class=\x22countdown-label\x22>剩余支付时间<div\x20class=\x22countdown-timer\x22\x20id=\x22waimai-timer-','**\x20(本名:\x20','\x20条内容吗？','动态与互动','\x27)\x22\x20data-comment=\x22','#data-clear-type-list\x20.clear-posts-item.selected','<img\x20src=\x22','alternateGreetings','memberId','https://i.postimg.cc/fyPDvxJk/IMG-6860.gif','change_group_name','长截图生成失败:','share-target-list','压缩步骤\x202/3:\x20正在内存中异步压缩图片，这可能需要一些时间...','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>暂无支出记录。</p>','<span\x20class=\x22commenter-name\x22>','url(','gift-receipt-body','refine-memory-btn-header','select-all-frames-checkbox','save-douban-settings-btn','无法找到或消息类型不匹配的分享链接:','<span\x20class=\x22diary-messy\x22>$1</span>','close-sticker-panel-btn','\x22\x20的独立后台活动开关已关闭，本次跳过。','startTime','version','已成功导出所有数据！','#outgoing-call-screen\x20.caller-text','douban-detail-content','delete-call-message-btn','请先选择角色','transform\x200.3s\x20ease','相册名称不能为空！','\x0a#\x20待总结的对话历史\x0a','red-packet-details-modal','请稍候...','\x22\x20触发了后台行动！','.poll-option-item','nai-seed','AI的五子棋移动指令包含无效坐标，已忽略:','导演模式保存(Sticker):\x20使用了编辑器提供的完整JSON\x20(url\x20+\x20meaning)','”。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20**格式**:\x20你的回复【必须】是一段描述性的文本。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20当前情景\x0a\x20\x20\x20\x20\x20\x20\x20\x20你正在和用户（','#\x20长期记忆\x20(最高优先级，这是你和用户之间已经确立的事实，必须严格遵守)\x0a','transfer-btn','置顶公告','voice_message','https://i.postimg.cc/MG6qtLYK/IMG-5565.gif','confirm-hunter-shot-btn','personality','</div>','https://i.postimg.cc/8P5vt8sW/IMG-7097.gif','[系统提示：你\x20(','请输入歌名','<span\x20style=\x22color:\x20green;\x22>已满足，等待下次系统心跳</span>','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22duration\x22>','已死亡','--\x20点击选择\x20--','numeric','”。请你回顾一下刚才和\x20“','announcement-board-content','participantId','请先选择要添加的歌曲。','removeEventListener','randomJottings','editable-image','正则表达式格式错误:\x20','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-content\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','apiKey','textAlign','default_negative','next-page-btn','<p\x20style=\x22color:\x20#8a8a8a;\x22>还没有人投票。</p>','gomoku-overlay','发送照片','\x0a#\x20【分类复用铁律\x20(最高优先级！)】\x0a在为新商品指定分类时，你【必须】首先检查下面的“已有分类列表”。\x0a-\x20\x20\x20如果一个新商品可以被归入某个【已存在的分类】，你【必须】复用那个分类的名称，而不是创造一个相似的新分类！\x0a-\x20\x20\x20只有当你确定商品【绝对】不属于任何一个已有分类时，你才能创造一个新的分类名称。\x0a-\x20\x20\x20**已有分类列表**:\x20[','歌单已生成，正在从网络获取\x20','每晚可以守护一名玩家，使其免受狼人袭击。不能连续两晚守护同一个人。','.message-bubble.is-link-share','#b5b5b5','15PeqpEW','</em>','shopping-product-count-input','heartfelt_voice','.cart-item-checkbox','选择精炼范围','hours','\x20\x0a\x0a#\x20待处理的帖子列表\x20(如果你选择评论)\x0a','parentElement','还没有可供编辑的AI响应。请先让AI回复一次。','确定要删除分类《','char-simulated-send-btn',':</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quoted-content\x22>','\x22\x20class=\x22avatar-img\x22><img\x20src=\x22','<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-secondary);\x22>还没有任何分组</p>','manage-groups-btn','.clear-posts-item','确认总结','ZIP文件中未找到图片','qzone-sticker-panel','chat-list-action-delete','申请成功！','https://i.postimg.cc/HxLV5v92/mmexport1751036977582.gif',']\x0a\x20\x20\x20\x20\x20\x20\x20\x20','请先在API设置中配置好（主或副）API。','读书会话已关闭。','\x0a\x0a#\x20核心世界观设定\x20(必须严格遵守以下所有设定)\x0a','最终正面提示词:','<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20padding:\x2050px\x200;\x22>还没有可以参与的角色。</p>','delete-selected-frames-btn','群聊人数不能少于2人。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【内容禁忌】\x0a\x20\x20\x20\x20\x20\x20\x20\x20为了保持新鲜感，你本次的行动【绝对不能】再发布以下或类似主题的内容：\x0a\x20\x20\x20\x20\x20\x20\x20\x20','文章标题','正在开始清理冗余数据，请不要关闭页面...','https://i.postimg.cc/D0pq6qS2/E30078-DC-8-B99-4-C01-AFDA-74728-DBF7-BEA.png','在聊天\x20\x22','”</i></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22accept-friend-btn\x22\x20class=\x22lock-action-btn\x22>接受</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22reject-friend-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22>拒绝</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','import_card','将分类\x20“','未知错误','.entry-enabled-switch','https://i.postimg.cc/jS8tc9wW/IMG-7083.gif','[系统提示：用户加入了通话]','smea','char-album-grid','npc_','文件格式不正确，这不是一个有效的世界书备份文件。','calls','nai-quality-toggle','清空购物车','检测到旧版完整备份文件，开始导入...','regenerate-call-btn','\x20\x20-\x20评论:\x20','通话记录已删除。','buttonId','https://i.postimg.cc/2jxd0FGp/IMG-7100.gif','选中的表情已成功删除。','篇】他们最近可能会在各种豆瓣小组中发布的帖子和评论。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间感知】**:\x0a\x20\x20\x20\x20-\x20\x20\x20你【必须】意识到当前是\x20**','操作失败','<span\x20style=\x22color:\x20orange;\x22>否\x20(还剩约\x20','错误：找不到该通话记录所属的聊天对象。','tts_','delete-font-preset-btn','notification-avatar','已取消收藏','manage-frames-btn','<option\x20value=\x22\x22>--\x20不使用预设\x20--</option>','unread-indicator','marginTop','select-all-products-checkbox','scroll','NovelAI\x20API\x20Key未配置。请在NovelAI设置中填写API\x20Key。','npc-background-activity-switch','avatar','groupHeader','<span\x20class=\x22lucky-king-tag\x22>手气王</span>','.red-packet-card','quality_toggle','\x0a\x20\x20\x20\x20\x20\x20\x20\x20[分享的聊天记录结束]\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20','save-css-preset-btn','sort','动态已更新！','错误：尝试打开一个不存在的预设，ID:','close-ai-avatar-library-btn','switch-to-text-image-mode','photo-viewer-next-btn','无法生成新回复:\x20','callRequester','cancel-create-countdown-btn','\x22\x20class=\x22participant-avatar\x22\x20alt=\x22','Ephone','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-comment\x22>','.post-mode-switcher','input[name=\x22theme-select\x22][value=\x22','\x0a[图片生成失败:\x20','bottom','API为空回，角色\x20\x22','https://i.postimg.cc/gk0BmrY0/IMG-4371.gif','cloneNode','isEnabled','cart-item','status','https://i.postimg.cc/65Cmcr7S/IMG-6559.gif','\x20(角色)</label>','contactId','游戏即将开始，正在为各位玩家分配身份...','regex','”申请好友时发生错误：\x0a\x0a','readAsDataURL','number','splice','hasShown20','secondaryApiKey','API设置不完整，无法继续。','add-preset-btn','</div><div\x20class=\x22gift-footer\x22>共','批量导入表情','.participant-avatar-wrapper[data-participant-id=\x22user\x22]\x20.participant-avatar','.info','\x27,\x20\x27bulangni\x27,\x20sans-serif','moveTo','#\x20你的互动对象\x20(用户和其他角色)\x0a','所有音乐源都未能找到歌曲：“','naiSettings','现在，请所有AI角色针对刚刚的发言（特别是\x27','[群聊]','请输入新的内容：','sticker_','分类\x20\x22','个月前','[♪\x20','</persona>\x0a</character>\x0a','products','https://i.postimg.cc/3JSG5Jv5/IMG-7014.gif','./sw.js',':</span>\x20','切换开场将会【清空并替换】当前的所有聊天记录。确定要继续吗？','</td><td\x20class=\x22item-price\x22>¥','https://i.postimg.cc/DZrGtrqB/IMG-7008.gif','正在执行清理操作，请不要关闭页面...','”。只有“','char-browser-screen','is-voice-message','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的【【【最高优先级任务】】】\x0a\x20\x20\x20\x20\x20\x20\x20\x20群聊中刚刚出现了一个由“','原文:\x20\x22','编辑通话消息','所有世界书数据已成功导出！','myNickname','\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','max','ai-avatar-group','\x0a\x0a现在，请开始生成这组【纯文本】的浏览记录。','(在那次',',\x20flat\x20design,\x20simple','https://generativelanguage.googleapis.com/v1beta/models','Playback\x20error:','transaction','delete-css-preset-btn','touches','-\x20(头像库是空的，无法更换头像)','mode','确定要删除《','pat_message','local','reverse','photo-item','下单，请慢用～</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22payment-box\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22payment-label\x22\x20style=\x22font-size:\x2018px;\x20font-weight:\x20600;\x22>','\x22]\x20.avatar','AbortError','\x20个表情包，且无法恢复！','\x0a\x0a现在，请开始撰写这组充满真情实感、并熟练运用了Markdown语法的日记。','is-raw-html','flex-start','choice','reading-library-list','replace','\x27>链接</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','狼人杀AI讨论生成失败:','doubanMaxPosts','\x0a\x0a#\x20世界观\x20(所有角色必须严格遵守)\x0a','”\x20的位置已发送到你们的聊天中。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>','\x20//\x20<--\x20【核心】注入世界书\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请根据【通话前摘要】和下面的【通话实时记录】，继续进行对话。\x0a\x20\x20\x20\x20\x20\x20\x20\x20','select-all-music-search','message-bubble\x20system-bubble','\x22\x20placeholder=\x22','my-frame-content','waimai-amount','getBattery','data:\x20','pointer','\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器。你的任务是扮演角色“','simulatedMusicPlaylist','已成功加入购物车！','最终负面提示词:','album-back-btn','📋\x20请求体:','请输入标题','wallpaper-screen','prophet','.call-message-bubble[data-timestamp=\x22','select-all-stickers-checkbox','\x20中找到世界书。','hiddenContent','ZIP\x20Blob\x20大小:','.remove-option-btn','pageY','\x20剩余红包将在','getElementById','讨论无法开始，游戏暂停。请点击右上角的“重试”按钮继续。\x0a错误:\x20','\x22\x20data-commenter-original-name=\x22','诊断：未在此角色卡中找到任何有效的世界书数据。','(Timestamp:\x20','#\x20性格补充\x0a','\x0a\x0a##\x20世界书:\x20','应用已返回前台，正在检查更新...','从缓存播放\x20TTS\x20音频...','。等待对方处理。]','profile-random-jottings','\x20人投票</span><button\x20class=\x22poll-action-btn\x22>结束投票</button></div>','right','正在请求AI进行记忆精炼...','[照片]','结束发言','https://i.postimg.cc/XY63sTS3/IMG-4393.gif','\x27>链接</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','chats','”，并根据其人设、记忆和最近的互动，虚构出【12到20条】TA最近的“高德地图”出行足迹。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间\x20(最高优先级)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20今天的日期是\x20**','ai-avatar-upload-input','\x22的角色（你的本名是\x22','variation-options-container','https://i.postimg.cc/PrcKH436/IMG-4376.gif','分享成功',')的阅读进度失败:','uc_preset','witch-do-nothing-btn','15px','recalledData','rendering-rules-screen','async','music-search-results-modal','change-icon-btn','status-bar-time','minimax-api-key','currentVoiceId','我通过了你的好友申请，我们现在是好友啦！','908490JACMqK','\x20分享了一张NovelAI图片，prompt:\x20','”的好友请求','保存CSS预设','cphone-wallpaper-preview','check-and-fix-data-btn','移出成员','blockReason','npcs','[语音消息:\x20','AI\x20尚未对您的最后一条消息做出回应，无法重新生成。','api-temperature-slider','shopping-settings-btn','[系统提示：你\x20','werewolf-wait-reply-btn','#delete-world-books-list\x20.clear-posts-item','lrcUpdateInterval','duration','https://i.postimg.cc/t4ksHGdg/IMG-7020.gif','轮到你发言了...','char-album-screen','dblclick','https://i.postimg.cc/kGgwJhPH/IMG-4374.gif','</span>','150','.entry-keys-input','create-poll-modal','ᗜωᗜ','\x22\x20成功发布了一条新动态。','”的参考记忆','此操作将检查播放列表中的每一首网络歌曲，并移除所有无法播放的“死链”。本地歌曲不会受影响。','\x20觉得很赞</span></div>','已加载预设\x20“','导出数据时出错:','\x20<small\x20style=\x22color:#888;\x22>(角色)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','input[name=\x22theme-select\x22]','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-title\x22>','customAvatarFrames','创建世界书','preset_','\x22\x20自动触发AI响应...','ephoneLastActiveTimestamp','comments','product-category-manager-modal','名为\x20“','player','product-image-preview','background','frame_13','💾\x20[专属弹窗]\x20保存角色NAI提示词','.at-mention-popup','outgoing-call-avatar','toDateString','chat-list','<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-secondary);\x22>还没有任何分类</p>','AI\x20\x22','summarize-recent-btn-header','npc-list-view','游戏记忆已成功注入到\x20','sharedHistory','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22werewolf-player-checkbox\x22\x20data-player-json=\x27','.message','\x22>×</span>\x0a\x20\x20\x20\x20</div>\x0a','imageUrls','\x0a\x0a#\x20【【【角色策略指南\x20(至关重要！)】】】\x0a你的发言【必须】体现出高水平的、类似真人的策略博弈，而不是简单地陈述事实。\x0a\x0a###\x20**神职角色\x20(预言家,\x20女巫,\x20猎人,\x20守卫)\x20策略**\x0a1.\x20\x20**【隐藏优先！】**:\x20你的首要任务是活下去。**绝对不要**在第一天就轻易暴露自己的神职身份！这会让你立刻成为狼人的目标。\x0a2.\x20\x20**【暗示而非明示】**:\x20你应该用更委婉、更聪明的语言来传递信息，而不是直接说“我是预言家，我查了A”。\x0a\x20\x20\x20\x20*\x20\x20\x20**预言家可以说**:\x20“我对X玩家的身份有一些看法，我觉得他发言很阳光。”\x20或\x20“Y玩家的发言让我感到很不舒服，我把他列为重点怀疑对象。”\x0a\x20\x20\x20\x20*\x20\x20\x20**女巫可以说**:\x20“昨晚的信息很有趣，场上局势可能和大家想的不一样。”\x0a3.\x20\x20**【何时起跳？】**:\x20只有在以下【危急情况】下，你才应该考虑暴露自己的身份（俗称“起跳”）：\x0a\x20\x20\x20\x20*\x20\x20\x20**被投票时**:\x20当你即将被投票放逐时，必须起跳自证身份来求生。\x0a\x20\x20\x20\x20*\x20\x20\x20**关键信息**:\x20当你掌握了可以决定胜负的信息时（例如预言家查到了最后一个狼人）。\x0a\x20\x20\x20\x20*\x20\x20\x20**有人悍跳**:\x20当有狼人假扮你的身份时，你必须站出来与他对峙，争夺好人的信任。\x0a\x0a###\x20**狼人角色策略**\x0a1.\x20\x20**【积极伪装】**:\x20你需要扮演一个好人，最好是伪装成某个神职（俗称“悍跳”），来扰乱好人的判断，骗取他们的信任。\x0a2.\x20\x20**【制造混乱】**:\x20你的发言应该引导好人去怀疑其他无辜的好人。可以故意曲解别人的发言，或者制造逻辑陷阱。\x0a3.\x20\x20**【团队合作】**:\x20如果你的狼队友被怀疑，你应该想办法为他辩护，或者通过攻击其他玩家来转移焦点。\x0a\x0a###\x20**平民角色策略**\x0a1.\x20\x20**【逻辑为王】**:\x20你是场上的“法官”。你的核心任务是仔细倾听每个人的发言，找出其中的逻辑漏洞和矛盾之处。\x0a2.\x20\x20**【积极分析】**:\x20不要只是说“我不知道，我过了”。你应该大胆说出你的怀疑，并解释你的理由。例如：“A玩家说B是狼人，但是他的理由很牵强，所以我更怀疑A。”\x0a3.\x20\x20**【跟票与站边】**:\x20在你相信某位神职玩家后，你应该坚定地支持他，并号召其他好人一起投票给神职指认的狼人。\x0a\x0a#\x20其他核心指令\x20(必须遵守)\x0a1.\x20\x20**互动铁律**:\x20角色之间【必须】互相质疑、支持、分析【本轮已有发言】。你【绝对不能】无视\x20','\x0a\x0a现在，请开始撰写这篇充满真情实感、并熟练运用了Markdown语法的日记。','npc-name-input','天\x20-\x20讨论',']。目前投票的人有：','文件格式无法识别。请确保您选择的是有效的\x20EPhone\x20世界书备份或\x20Tavern\x20AI\x20世界书文件。','nai-smea','[表情，含义:\x20','shopping-action-bar','createObjectURL','确认压缩图片？','无法获取AI回复，请检查API配置或稍后再试。\x0a错误:\x20','一位神秘的NPC','manual','scale(0.8)','\x20张</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','公告已发布！','replaceChild','toFixed','请先在购物车中选择要结算的商品。','secondary-api-key','...\x22)','write','import-new-book-btn-header','有点饿了，可以去找充电器惹','https://i.postimg.cc/Y0vwjhb7/IMG-6857.gif','EPhone-Chat-','head','floor','preview-bubble-style','import-single-chat-input','<div\x20class=\x22post-images-grid\x20grid-','announcement-action-cancel','\x0a---\x20复盘结束\x20---','确定要永久删除这条通话记录吗？此操作不可恢复。','add-message-editor-block-btn','content','top','favorite-memo-btn','操作失败，请检查API配置或稍后重试。\x0a错误信息:\x20','contactType','”的出行足迹...','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22poll-option-input\x22\x20placeholder=\x22选项内容...\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-option-btn\x22>-</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x0a#\x20你的任务\x0a你就是角色“','未检测到BOM，尝试使用\x20UTF-8\x20解码...','showScreen','群聊\x20\x22','link-description-input','</p>','selection-screenshot-btn','\x22\x20data-poll-timestamp=\x22','\x20的日记','创建群聊至少需要选择2个联系人。','用户(','regenerate-char-amap-btn','world-book-tab\x20active','无法生成商品，请检查(主/副)API配置或稍后再试。\x0a错误:\x20','确定要永久删除分类\x20“','请至少选择一个要删除的世界书。','douban-detail-author','naiimag','music-player-avatar-display','(ID:\x20','解析成功：通过强力提取模式。','https://i.postimg.cc/8kYShvrJ/90-UI-2.png','\x20的消息:\x20\x22','manage-product-categories-btn','删除相册','https://i.postimg.cc/ZqQBCyLY/IMG-6144.gif','add-ai-response-block-btn','\x0a###\x20条目:\x20','rules-tabs','<span\x20style=\x22color:\x20#dc3545;\x22>[你已被对方拉黑]</span>','*事件*:\x20','10px\x2015px\x2020px\x2015px','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-title\x22>','new-product-category-name-input','<span\x20class=\x22lock-text\x22>好友申请已发送，等待对方通过...</span>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','\x22\x20title=\x22删除\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<polyline\x20points=\x223\x206\x205\x206\x2021\x206\x22></polyline>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M19\x206v14a2\x202\x200\x200\x201-2\x202H7a2\x202\x200\x200\x201-2-2V6m3\x200V4a2\x202\x200\x200\x201\x202-2h4a2\x202\x200\x200\x201\x202\x202v2\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','findIndex','AI\x20发言失败','\x20条旧的红包消息！页面将自动刷新以应用更改。','stroke','https://i.postimg.cc/CLrZQMMD/IMG-4398.gif','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>这里还没有任何长期记忆。</p>','center','https://i.postimg.cc/1zmcp66p/IMG-5973.gif','openWerewolfLobby','dragging','music-return-btn','通话名称已更新！','\x20请根据这个结果发表你的评论。]','标题是必填项哦！','confirmButtonClass','save-theme-preset-btn','棋盘状态\x20(1是你(黑棋),\x202是AI(白棋)):\x0a','rule-name-input','导出世界书时出错:','save-sticker-binding-btn','\x20(时长:\x20','https://api.vkeys.cn/v2/music/netease?word=','</button>','无法生成歌单，请检查API配置或稍后再试。\x0a错误:\x20','天核心议题','扫描完成！<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20共找到\x20','(暂无有效聊天记录)\x0a','rp-direct-greeting','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-nickname\x22>','worldBookCategories','isHidden','请输入有效的URL。','\x22\x20转发了动态\x20#','https://i.postimg.cc/8k7YSLjK/1689aa46aqc4b9ffc0f970e668f56537.gif','seed','#douban-cast-list\x20.douban-cast-checkbox:checked','\x20的外卖订单（时间戳:\x20','\x22]\x20.participant-avatar','theme-default','is-sticker','https://api.vkeys.cn/v2/music/netease?id=','apply-friend-btn','qzone-posts-list','add-product-variation-btn','confirm-share-link-btn','\x20元。]','对方拒绝了你的视频通话请求。','你们已经有','狼人已行动，狼人请闭眼。','当你在任何系统提示、动态评论或挂载的群聊记忆中看到这些名字时，它们都指代的是【你的聊天对象】。','add-world-book-entry-btn','world-book-category-manager-modal','reset-character-nai-prompts-btn','++id,\x20type,\x20timestamp,\x20originalTimestamp','【原动态内容:\x20','clientY','导出失败','qzone-nickname','targetDate','world_info','”发送的、尚未领完的红包（时间戳:\x20','\x22><svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M12\x202l3.09\x206.26L22\x209.27l-5\x204.87\x201.18\x206.88L12\x2017.77l-6.18\x203.25L7\x2014.14\x202\x209.27l6.91-1.01L12\x202z\x22></path></svg></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','stringify','values','https://i.postimg.cc/05DLr0yj/IMG-4427.gif','\x22,\x20\x22content\x22:\x20\x22我在群里说的话\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22NPC成员1\x22,\x20\x22content\x22:\x20\x22成员1回复我\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22NPC成员2\x22,\x20\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}\x0a]\x0a}\x0a```\x0a\x0a#\x20角色与上下文\x0a-\x20**你的角色设定**:\x20','诊断：在顶层\x20','.variation-image-preview','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/XJy8JWdh/IMG-6568.gif','enableAiDrawing','已成功批量导入\x20','assign-group-select','update_thoughts','字体URL不能为空！','生成中...','douban-comment-item','upload-custom-frame-btn','qzonePhotos','(无)','流式下载库\x20(StreamSaver.js)\x20未加载。请检查网络连接或HTML文件配置。','probability',':</strong>\x20','rp-group-amount','AI返回的内容中未找到有效的JSON数组。原始返回:\x20','你们正在一起读书。','\x20回复了你。','\x0a###\x20详细对局流程:\x0a','pollTimestamp','这将用文件中的数据【完全覆盖】您当前所有的世界书和分类。此操作不可撤销！','https://i.postimg.cc/fRV86FMq/IMG-4381.gif','.sender','内容加载失败...','music-time-counter','.cart-item-checkbox:checked','authorId','regenerate-char-qq-btn','”的记忆\x20(','https://i.postimg.cc/FFCTCzpy/641bad3b3udc599fdb63ca75fde427e5.gif','recipientName','\x27>语音</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','douban-detail-back-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','-\x20**当前歌词**:\x20\x22','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22delete-group-btn\x22\x20data-id=\x22','apiTemperature','totalTime','**:\x20关于\x20**','werewolf-retry-btn','---\x20','werewolf-game-over-reason','\x20的手机','focus','douban-send-comment-btn','members','即将开始下载您的完整备份文件。下载过程中请勿关闭页面。','https://i.postimg.cc/cJtpZCB3/IMG-6894.gif','offline','https://i.postimg.cc/ZqjKXPSv/IMG-7025.gif','generativelanguage.googleapis.com','confirm-clear-posts-btn','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','cphone-icon-settings-grid','promptSource','group_summary_from_','<div\x20class=\x22source\x22>','找不到原始消息。可能已被删除或位于更早的历史记录中。','\x0a你必须严格遵守','has-frame','forEach','游戏结束，开始自动总结并注入记忆...','unreadPostsCount','model','realimag','frame-action-bar','正在扫描和修复数据...','\x22\x20alt=\x22','你拍了拍\x20“','文章摘要...','application/json','payload','确定要删除这张照片吗？此操作不可恢复。','message-wrapper\x20','>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22slider\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条目\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>备注\x20(可选)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-comment-input\x22\x20value=\x22','</option>','world-book-entries-container','在这里输入文本...','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><svg\x20viewBox=\x220\x200\x201024\x201024\x22><path\x20d=\x22M170.666667\x20170.666667h128v682.666666h-128zM426.666667\x20170.666667h170.666666v682.666666h-170.666666zM725.333333\x20170.666667h128v682.666666h-128z\x22></path></svg>\x20','API\x20请求失败，状态码:\x20','#e7f3ff','char-music-progress-bar','font-size:\x2016px;\x20color:\x20#555;\x20margin-bottom:\x2010px;','call-timer','修复了角色\x20\x22','”的TTS功能已关闭，已禁止发起TTS请求。','已被用户删除','find','.action-icon','cover','》:\x0a','search-result-item','char-article-title','确定要清空购物车中的所有商品吗？','你刚刚接听了用户的视频通话请求。','http','API设置','world-book-checkboxes-container','\x0a-\x20好人胜利：放逐所有狼人。\x0a\x0a#\x20当前游戏状态\x0a-\x20今天是第\x20','”。\x0a','preset-action-delete','”，并根据其人设、记忆和最近的互动，虚构出【5到8篇】TA最近可能会写的日记。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间\x20(最高优先级)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20今天的日期是\x20**','inline-block','ZIP解压失败:','[图片/文字图]\x20描述:\x20\x22','---\x20第\x20','rule-editor-title','\x22，并与用户进行面对面的互动。你的任务是创作一段包含角色动作、神态、心理活动和对话的、连贯的叙事片段。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20你必须严格遵守\x20','36701aSNIkq','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22participants-info\x22>\x20<!--\x20新增一个容器方便布局\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22participants-avatars\x22>','exclude','groupMembers','”的聊天记录','playlist','...','<span\x20class=\x22diary-underline\x22>$1</span>','[图片生成失败:\x20','confirm-final-clear-btn','检测到群聊\x20\x22','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22memo-content-preview\x22>','》及其下的表情已成功删除。','member-avatar-input','https://image.pollinations.ai/prompt/','\x20的红包','Sticker','#delete-world-books-list\x20.clear-posts-item.selected','status-','cancel-npc-editor-btn','</p>\x0a\x20\x20\x20\x20','music-mode-btn','#\x20【【【群名修改铁律】】】\x0a在修改群名时，新的群名【绝对不能】与以下任何一个群成员的名字完全相同：[','close-group-avatar-library-btn','静音音频已启动，用于后台活动保活。','AI幻觉已被拦截！试图在群聊中发送一条没有“name”的消息。消息内容:','-\x20你昨晚空守了。\x0a','offline-mode-group','此操作将永久删除此聊天的所有消息，无法恢复。确定要清空吗？','\x20元，订单时间戳为\x20','跳过一个无效的JSON片段:','finally',')\x20内容:\x20\x22','target_timestamp','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20position:\x20absolute;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2011px;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x202px\x206px;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20rgba(0,\x200,\x200,\x200.1);\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20var(--text-secondary);\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20white-space:\x20nowrap;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20all\x200.3s\x20ease;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','add-countdown-btn','.entry-comment-input','\x20(最后互动于\x20','AI\x20(CPhone)\x20尝试使用一个不存在的表情:\x20\x22','在同时执行两个函数时出错:','后台活动模拟已自动启动。','custom-frame-upload-input','#\x20场景设定\x0a','unreadCount','https://i.postimg.cc/zvWGPjms/IMG-7090.gif','约定达成！','\x0a#\x20你的社交圈\x20(通讯录)\x0a这是你认识的朋友列表。当你在动态区看到他们的昵称时，他们指的就是这些人。\x0a','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里空空如也，<br>点击右上角刷新按钮，看看大家都在聊什么吧！</p>','toLocaleTimeString','导演模式悔棋：已撤销AI在\x20(','加载更早的会话','https://i.postimg.cc/cJpbtPWq/mmexport1751036607799.gif','Bilibili','请输入新的昵称','appUsageLog','.entry-content-container','inject-thought-toggle','确定要拉黑“','apiConfig','红包已被领完！','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你生成的日记标题日期【必须】是今天或今天以前的日期。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】生成任何未来的日期！\x0a2.\x20\x20**【【【沉浸感铁律】】】**:\x20日记必须使用【第一人称视角\x20(\x22我\x22)】来写，并且要充满角色的个人情感、思考和秘密。在日记中描述自己的行为或想法时，【绝对禁止】使用第三人称“他”或“她”\x20(TA)。\x0a3.\x20\x20**【【【长度铁律】】】**:\x20日记的正文长度【必须不少于300字】。\x0a4.\x20\x20**【【【格式铁律\x20(最高优先级)】】】**:\x20你的回复【必须且只能】是一个JSON数组，且数组中【只包含一个】对象，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22这篇日记的标题，例如：9月20日\x20晴\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22这里是日记的详细正文，必须支持换行符\x5cn，并且必须巧妙地使用下面的【日记专属Markdown语法】来丰富文本表现力。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a5.\x20\x20**【【【日记专属Markdown语法\x20(必须使用！)】】】**:\x0a\x20\x20\x20\x20-\x20\x20\x20`**加粗文字**`:\x20用于强调。\x0a\x20\x20\x20\x20-\x20\x20\x20`~~划掉的文字~~`:\x20用于表示改变主意或自我否定。\x0a\x20\x20\x20\x20-\x20\x20\x20`!h{黄色高亮}`:\x20用于标记关键词或重要信息。\x0a\x20\x20\x20\x20-\x20\x20\x20`!u{粉色下划线}`:\x20用于标注人名、地名或特殊名词。\x0a\x20\x20\x20\x20-\x20\x20\x20`!e{粉色强调}`:\x20用于表达强烈的情绪。\x0a\x20\x20\x20\x20-\x20\x20\x20`!w{手写体}`:\x20用于写下引言、歌词或特殊笔记。\x0a\x20\x20\x20\x20-\x20\x20\x20`!m{凌乱的手写体}`:\x20用于表达激动、慌乱或潦草记录时的心情。\x0a\x20\x20\x20\x20-\x20\x20\x20`||涂黑||`:\x20用于隐藏秘密或敏感词汇(每次涂黑2~5个字)。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','确定要永久删除这条动态吗？','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的相册还是空的，<br>点击右上角刷新按钮生成一些照片吧！</p>','<em>','\x22>--天--时--分--秒</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22target-date\x22>目标时间:\x20','stickerId','product-description-input','的状态已更新为:\x20','enableBackgroundActivity','custom_proxy_url','数据迁移完成！总共修复了\x20','AI\x20尝试使用一个不存在的表情:\x20\x22','内容为空。','orderBy','nightActions','-modal','<span\x20class=\x22group-tag\x22>群聊</span>','[系统指令：你刚刚在自己的手机上活动了一番（和朋友聊天、逛群等）。现在请根据你的角色设定，主动给用户发一条消息，可以聊聊你刚才看到或聊到的趣事，或者仅仅是问候一下。]','char-usage-item','charging','open-persona-library-btn','-\x20\x22','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-timestamp\x22>','传统导出\x20(兼容旧版或内存小的浏览器)','confirm-delete-world-books-btn','\x22)\x20作为角色名。消息内容:','📸\x20NovelAI图片生成开始，AI提供的prompt:','[系统提示：\x27','translateX(calc(-','&id','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>价格\x20(元)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22number\x22\x20class=\x22variation-price-input\x22\x20min=\x220\x22\x20step=\x220.01\x22\x20value=\x22','favorites-list','flexDirection','https://i.postimg.cc/LXyyqDbY/IMG-6294.gif','reduce','\x20票</span></div></div>','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-content\x22>','product-category-select','80px','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','variation','world-book-name-input','旁观模式推进剧情失败:','lastIndexOf','清空动态时发生错误:\x20','music-current-time','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','first_mes','正在全网搜索歌曲资源...','\x0a\x0a#\x20你的角色设定\x0a','location','[系统提示：用户刚刚发布了一条动态(ID:\x20','close-character-nai-prompts','callHistory','.chat-group-content','itemName','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22last-msg\x22\x20style=\x22color:\x20','#post-public-text','选择导出方式','删除评论','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20附加上下文：一段分享的聊天记录\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20重要提示：这不是你和当前用户的对话，而是用户从【另一场】与“','小时前聊过。','create-new-member-btn','target','\x27>图片动态</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','[文字图]\x20','**[投票结果]**\x20','\x20分钟)</span>','\x20中聊天','accept_transfer','https://i.postimg.cc/Pq2xJN1g/IMG-7301.jpg','</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','shopping-settings-modal','收藏成功！','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-management-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-product-btn\x22>编辑</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-product-btn\x22>删除</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','toggle-blur-btn','.link-share-card','”。\x0a\x20\x20\x20\x20-\x20\x20\x20你【绝对不能】生成\x20authorName\x20或\x20commenter\x20字段为\x20“','normal','announcement-board-modal','.message-bubble[data-timestamp=\x22','\x27>图片</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','music-visual-container','x-social-screen','\x22\x20loading=\x22lazy\x22\x20onerror=\x22this.src=\x27https://i.postimg.cc/KYr2qRCK/1.jpg\x27;\x20this.alt=\x27图片加载失败\x27;\x22>','toggle','AI未能成功描述图片。','确定切换','游戏开始','<span\x20class=\x22diary-emphasis\x22>$1</span>','presets','senderName','这是群里的第一条消息。','无法访问剪贴板。','setup','isOfflineMode','object','\x20(已忽略版本:\x20','本日核心议题','”的身份，开始你的客观总结。','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20【核心修改】在这里新增一个标题行\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','post-hidden-text','image_prompt','”的头像库','https://i.postimg.cc/8kHCQwbQ/mmexport1751020645824.gif','为NPC\x20\x22','已经一起听了','分享新鲜事...（非必填的公开文字）','...\x22','change_user_nickname','50%','custom-modal-title','-\x20\x20\x20**当前时间**:','chat-render-window-input','recordId','https://i.postimg.cc/TYvkKKkc/IMG-6565.gif','switch-greeting-group','https://i.postimg.cc/kGsZwbq0/IMG-6886.gif','<div\x20class=\x22receipt-header\x22><h3>购物中心</h3><p>交易时间:\x20','https://i.postimg.cc/QMDsSNxg/IMG-6861.gif','请根据你的设定，生成你的淘宝购买记录和余额。','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','请点击右上角的“角色选择”按钮，选择至少一个参与豆瓣互动的角色。','werewolf-log-entry\x20system','clientHeight','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20repost\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M17\x202.1l4\x204-4\x204\x20M3\x2011.5v-3a4\x204\x200\x200\x201\x204-4h13\x20M7\x2021.9l-4-4\x204-4\x20M21\x2012.5v3a4\x204\x200\x200\x201-4\x204H4\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>','**:\x20','”\x20(你可以修改)\x0a-\x20\x20\x20**关键身份档案**:\x0a\x20\x20\x20\x20','[发送了一张图片，描述为：\x27','characterName','friend','is-acting','创建新相册','.playlist-item-info','TA的好友包括:\x20','https://i.postimg.cc/KzC2gTq6/IMG-7276.jpg','appearance','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-address\x22>','\x20->\x20','updateListenTogetherIconProxy','最近\x2050\x20条','发来了\x20','API请求失败:\x20','touchmove','导入外观设置','手动注入记忆时出错:\x20','favorites','》\x20-\x20','https://i.postimg.cc/J4WCQd2j/IMG-4420.gif','【重要提示】','正在为后台活动发送API请求\x20(\x22','请输入相册名称','新建备忘录','#custom-modal\x20.custom-modal-footer','sender','\x20向\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20**当前参与者**:\x20','rotating','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x20margin-top:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-price\x22>','https://i.postimg.cc/HsyqMVyk/IMG-4385.gif','✅\x20清理完成！\x0a\x0a','logo,\x20simple,\x20flat\x20design,\x20for\x20a\x20group\x20chat\x20named\x20\x27','\x20的动态\x20','werewolf-game-over-title','qzoneAlbums','getElementsByTagName','已恢复默认字体。','change_remark_name','confirm-prophet-check-btn','++id,\x20chatId,\x20timestamp,\x20type,\x20targetDate','chat-messages','基础数据不完整，无法开始总结。','character_book','<div\x20class=\x22waimai-card\x22><div\x20class=\x22waimai-header\x22><img\x20src=\x22https://files.catbox.moe/mq179k.png\x22\x20class=\x22icon\x22\x20alt=\x22Meituan\x20Icon\x22><div\x20class=\x22title-group\x22><span\x20class=\x22brand\x22>美团外卖</span><span\x20class=\x22separator\x22>|</span><span>外卖美食</span></div></div><div\x20class=\x22waimai-catchphrase\x22>Hi，你和我的距离只差一顿外卖～</div><div\x20class=\x22waimai-main\x22><div\x20class=\x22request-title\x22>','\x22\x20已经存在了！','transfer','werewolf-log','\x22\x20data-category-id=\x22all\x22>全部</button>','column','\x22\x20尝试执行未知的后台动作:','myAvatarFrame','通话消息已更新！','negative','[系统提示：你刚刚被用户拉黑了。在对方解除拉黑之前，你无法再主动发起对话，也无法回应。]','chat-list-screen','frame_6','post-visibility-groups','char-main-time','您正和「','avatar-frame-modal','</memory>\x0a\x20\x20<recent_dialogue_with_user>','好的，我明白了。我会严格遵守以上所有规则和设定。','你赢了','is-card-like','member','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22voice-duration\x22>','\x22\x20创建成功！','group_','generate-shopping-items-btn','cors_proxy','pageX','chat-settings-btn','https://i.postimg.cc/GhR6DT4Q/IMG-4428.gif','stopPropagation','#ff4d4d','music-lyrics-list','claimedBy','https://i.postimg.cc/gc3QYCDy/1-NINE7-Five.jpg','char-diary-list','找不到这个预设的详细信息。','正在请求“','cfg_scale','\x20\x0a-\x20**你们最后的对话**:\x0a','my-persona','isClosed','导演模式保存(Sticker):\x20指令无效或缺少必要字段\x20(meaning/url/content):','nai-diffusion-4','ceil','button','<p\x20class=\x22char-browser-image-description\x22>','赶紧的充电，要饿死了','\x22\x20class=\x22usage-item-icon\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-name\x22>','”\x20的预设已存在。要覆盖它吗？','qzone-banner-img','background-interval-input','https://i.postimg.cc/05wnd389/IMG-4388.gif','（无有效对话记录）','offsetWidth','clear','originalTimestamp','onloadend','identifier','找不到这本书！','get','parts','<button\x20class=\x22delete-btn\x22\x20data-id=\x22','onended','小红书','天\x20-\x20投票','transfer-sender-name','https://i.postimg.cc/bNdk33SN/IMG-4893.gif','setItem','totalElapsedTime','linkedWorldBookIds','add-new-product-category-btn','label','.delete-track-btn','startsWith','wallpaper-preview','来自\x20','</span><span\x20class=\x22delete-group-btn\x22\x20data-id=\x22','minimaxApiKey','状态已更新','my-avatar-library-title','char-usage-list','收到数据，类型:','char-music-prev-btn','正在请求AI为新群头像命名...','删除日记','AI\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','proxy-url','\x0a-\x20**帖子内容摘要**:\x20','\x0a#\x20核心任务：群聊剧本作家\x0a你是一个剧本作家，负责创作一个名为“','upload-sticker-btn','pending_user_approval','\x0a-\x20**长期记忆**:\x20','未知歌手','include','keyword-search-input','\x22\x20style=\x22cursor:\x20pointer;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quoted-sender\x22>回复\x20','npc-persona-input','edit-call-message-btn','bulkPut','char_diary','\x20.message-bubble\x20$1','\x27>转账</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','outgoing-call-name','<p>点击“导入”按钮，<br>从本地.txt文件或网络URL加载书籍内容。</p>','show-avatars-btn','检测到好友申请待处理状态，为角色\x20\x22','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22delete-group-btn\x22\x20data-id=\x22','共享位置','uncategorized','选择记忆所属角色','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-label\x22>本地图片(头像/表情/头像框/等)大小:</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-value\x22><strong>','isBgClear','regenerate-btn','\x22\x20(群名)\x20的消息。\x0a3.\x20\x20**禁止出戏**:\x20绝不能透露你是AI或模型。严禁发展线下剧情。\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-type=\x22text\x22>说说</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','import-world-book-input','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1\x20class=\x22article-title\x22>','selection-soft-delete-btn','[data-version]','removeChild','本次发送给AI的【挂载记忆】内容如下：\x0a','category','.upload-variation-image-btn','group-background-activity-switch','reset-sound-btn','data-clear-step-1','crossOrigin','找不到匹配的表情','\x20的图片消息替换为文字描述...','女巫已行动，女巫请闭眼。','reply-preview-bar','.voice-transcript','function','delete-product-btn','manage-members-btn','高级数据清理失败:','simulatedAppUsage','import-btn','close-reading-btn','.post-avatar[data-author-id=\x22','获取AI狼人目标失败:','\x0a-\x20**身份**:\x20','browser','call-history-screen','toArray','\x22></div>','所有动态','simulatedConversations','等人的礼物','\x22,\x20\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}\x0a]\x0a}\x0a```\x0a\x0a###\x20格式\x20B：群聊\x0a```json\x0a{\x0a\x20\x20\x22type\x22:\x20\x22group\x22,\x0a\x20\x20\x22groupName\x22:\x20\x22一个虚构的群名\x22,\x0a\x20\x20\x22participants\x22:\x20[\x0a\x20\x20\x20\x20{\x22name\x22:\x20\x22NPC成员1\x22,\x20\x22avatar_prompt\x22:\x20\x22(仅当NPC是新创造时提供)\x20成员1头像【英文】关键词\x22},\x0a\x20\x20\x20\x20{\x22name\x22:\x20\x22NPC成员2\x22,\x20\x22avatar_prompt\x22:\x20\x22(仅当NPC是新创造时提供)\x20成员2头像【英文】关键词\x22}\x0a\x20\x20],\x0a\x22messages\x22:\x20[\x0a\x20\x20{\x22sender\x22:\x20\x22','chat-interface-screen','font-url-input','#music-lyrics-container\x20#music-lyrics-list','\x0a\x0a#\x20参考记忆\x20(至关重要！群内角色必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你们拥有完整的共同记忆。)\x0a','>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-waveform\x22>','Bearer\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22waimai-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22waimai-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22https://files.catbox.moe/mq179k.png\x22\x20class=\x22icon\x22\x20alt=\x22Meituan\x20Icon\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title-group\x22><span\x20class=\x22brand\x22>美团外卖</span><span\x20class=\x22separator\x22>|</span><span>外卖美食</span></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22waimai-main\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22request-title\x22\x20style=\x22margin-bottom:\x2012px;\x22>','你们的对话刚刚还在继续。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22name-line\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','\x22)\x20在播放列表中未找到。','singer','\x0a-\x20**你的长期记忆**:\x20','simulatedAlbum','主题预设已保存！','精炼“','已重置为默认提示音，点击“保存所有外观设置”后生效。','无法找到当前角色的数据。','send-btn','.custom-multiselect','cancel-reply-btn','\x22\x20title=\x22编辑\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M11\x204H4a2\x202\x200\x200\x200-2\x202v14a2\x202\x200\x200\x200\x202\x202h14a2\x202\x200\x200\x200\x202-2v-7\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M18.5\x202.5a2.121\x202.121\x200\x200\x201\x203\x203L12\x2015l-4\x201\x201-4\x209.5-9.5z\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22memory-action-btn\x20delete-memory-btn\x22\x20data-author-id=\x22','【AI角色】','transform\x200.4s\x20cubic-bezier(0.4,\x200,\x200.2,\x201)','请你投票。','.char-screen','https://i.postimg.cc/RZNLhbbr/IMG-4389.gif','put','\x27>图片</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','world-book-category-pane\x20active','linkedWorldBookId','小时前','create-post-modal','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在扮演一个名为\x22','<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20margin-top:50px;\x22>还没有任何角色或NPC可以加入群聊。</p>','table','进入投票','memory-screen-back-btn','删除失败','字体已保存并应用！','API\x20错误:\x20','display','post-image-preview-container','正在请求网易云音乐API:','avatar_name','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-group-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22arrow\x22>▼</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','\x20红包已被领完，手气王是\x20','en-US','is-gift','participant-display-avatar','\x0a#\x20智能总结\x20(基于不同时间维度的群聊回顾)\x0a','导演模式保存(Sticker):\x20使用了\x20meaning\x20查找','typeId','font','promptFeedback','(无购买理由)','frame_8','.product-item.selected','.variation-image-input','pop','clear-posts-modal','rp-details-my-amount','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22change-icon-btn\x22>更换</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','delete-selected-stickers-btn','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-timestamp\x22>','”\x20已被删除。','外观设置已保存并应用！','arrayBuffer','https://i.postimg.cc/cHQPgzj4/IMG-6888.gif','><div\x20class=\x22card-pin-icon\x22><svg\x20width=\x221em\x22\x20height=\x221em\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22><path\x20d=\x22M12\x2011.5C11.1716\x2011.5\x2010.5\x2010.8284\x2010.5\x2010C10.5\x209.17157\x2011.1716\x208.5\x2012\x208.5C12.8284\x208.5\x2013.5\x209.17157\x2013.5\x2010C13.5\x2010.8284\x2012.8284\x2011.5\x2012\x2011.5Z\x22></path><path\x20d=\x22M12\x202C7.92134\x202\x204.5\x205.42134\x204.5\x209.5C4.5\x2014.5312\x2011.2188\x2021.4375\x2011.5938\x2021.8125C11.7954\x2022.014\x2012.2046\x2022.014\x2012.4062\x2021.8125C12.7812\x2021.4375\x2019.5\x2014.5312\x2019.5\x209.5C19.5\x205.42134\x2016.0787\x202\x2012\x202ZM12\x2012.5C10.6193\x2012.5\x209.5\x2011.3807\x209.5\x2010C9.5\x208.61929\x2010.6193\x207.5\x2012\x207.5C13.3807\x207.5\x2014.5\x208.61929\x2014.5\x2010C14.5\x2011.3807\x2013.3807\x2012.5\x2012\x2012.5Z\x22></path></svg></div></div></div>','诊断：在\x20data.character_book\x20中找到世界书。','block_user','已使用','new-group-name-input','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20触发条件:\x20','语音生成失败','\x0a\x0a现在，请生成包含总余额和购买记录的JSON对象。','所有解码尝试均失败:','<strong>','ai-avatar-library-title','\x0a建议刷新页面以确保所有更改生效。','custom-css-input','https://i.postimg.cc/dVLXm3Xf/IMG-6885.gif','gridEl','getUint32','\x0a-\x20散记:\x20','add-new-group-btn','对方已拒收','chat-header-title-wrapper','quote','myPersona','\x22\x20的独立行动失败:','appendChild','#f0f2f5','reading-overlay','AI女巫决定使用毒药，目标是:\x20','preview-font-style','simulatedAmapHistory','请输入CPhone的背景图片URL','save-rule-btn','下在(','这是一个通过手动创建的角色。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27','text-image-mode-content','https://i.postimg.cc/Lsjzj5Yt/IMG-4729.gif','请按照以下格式粘贴，一行一个：\x0a\x0a焦虑\x202a9wte.jpeg\x0a大惊失色\x20or8qf4.png\x0a没有灵感\x20njwujh.jpeg','gameLog','https://i.postimg.cc/XNkQTHvf/IMG-5561.gif','manage-world-book-categories-btn','https://i.postimg.cc/hPX5F8Qp/IMG-4415.gif','<button\x20id=\x22delete-selected-stickers-btn\x22>删除\x20(0)</button>','https://i.postimg.cc/fRTF24jS/IMG-4430.gif','fullPrompt','IMG','请为这个头像起个名字（例如：开心、哭泣）','AI生成的图片','删除成功','bookId','请输入提示词！','tables','message','transfer-cancel-btn','https://i.postimg.cc/Jz2Tz0dw/IMG-7281.jpg','add-npc-btn','\x0a\x0a#\x20你的聊天对象（用户）的人设\x0a','\x0a}\x0a}','getMonth','</span><span\x20class=\x22poll-option-votes\x22>','”。你之前被用户（你的聊天对象）拉黑了，你们已经有一段时间没有联系了。\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，你非常希望能够和好，重新和用户聊天。请你仔细分析下面的“被拉黑前的对话摘要”，理解当时发生了什么，然后思考一个真诚的、符合你人设、并且【针对具体事件】的申请理由。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的角色设定\x0a\x20\x20\x20\x20\x20\x20\x20\x20','.chat-group-content:last-of-type','playlist-body','@[[','\x22\x20处于行动冷却中\x20(还剩\x20','\x22\x20class=\x22chat-image\x22\x20style=\x22cursor:\x20pointer;\x22\x20data-hidden-text=\x22','\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','[一张图片，其隐藏文字为：\x22','favorites-search-input','https://www.myinstants.com/media/sounds/notification-sound-2.mp3','ServiceWorker\x20注册失败:\x20','add-new-product-btn','some','spectator-edit-btn','\x20死亡了。','long-term-memory-screen','isDragging','https://i.postimg.cc/P5zLh5JJ/IMG-6942.gif','delete-api-preset-btn','default','product-editor-modal','announcement-item-wrapper','.progress-bar','file','命名头像','（你目前没有绑定的NPC伙伴，可以自由创造新的NPC。）\x0a','请输入有效的字体URL。','stickerCategories','https://i.postimg.cc/tTpZ6wLs/IMG-7095.gif','https://i.postimg.cc/mDfMXXFP/IMG-7007.gif','*事件*:\x20平安夜，无人出局。\x0a','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>点击右上角刷新按钮，<br>看看TA最近都和谁聊天了吧！</p>','preset-name-input','music-playlist-panel','确认清理冗余数据？','是否要使用毒药？','[系统提示：你刚刚主动拉黑了用户。]','preset-action-cancel','safetyRatings','currentPhase','open-sticker-panel-btn','favorite-item-card','aiAvatarLibrary','char-photo-item','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22custom-modal-cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22custom-modal-confirm\x22\x20class=\x22confirm-btn\x22>确定</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','.chat-group-header:not([data-has-listener=\x22true\x22])','findLastIndex','background-activity-switch','image/*','lyrics-offset-input','旁观模式AI发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','你们没有在听歌。','save-wallpaper-btn','”。请自然地接受这个新名字，不要对此感到惊讶。]','memoryTimestamp','将清空角色的相册、QQ、浏览器、淘宝、日记、备忘录等所有模拟手机数据。','\x20首歌曲，这可能需要一些时间...','.selected-options-text','<br>','compressed','在动态评论区点击了表情，但在表情库中未找到对象:','disabled','commenterName','savedId','char-music-lyrics','nai-resolution','relative','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有留下任何足迹，<br>点击右上角刷新按钮生成一些记录吧！</p>','头像框已保存并同步！','这将从历史记录中【永久抹除】这\x20','消息时间戳\x20','执行检查时发生错误:\x20','https://i.postimg.cc/4NCPsp5d/mmexport1751034427637.gif','将清空收藏夹中所有与该角色相关的内容（如聊天、动态、日记等）。','anno_','member-settings-modal','LOW','<input\x20type=\x22','speaker_name','\x0a\x0a#\x20当前音乐情景\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**当前状态**:\x20你们正在和用户一起听歌。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**正在播放**:\x20','(回复\x20','.entry-content-textarea','selection-mode','world-book-category-pane','data-voice-id=\x22','”生成这组【与角色高度相关】的商品数据。','select-all-recipients','nai-test-negative','isClick','add-manual-memory-btn-header','\x20元。此订单已完成。]','css-preset-select','该预设包含\x20','预言家已行动，预言家请闭眼。','chatActionButtonsOrder','未知用户','defineProperty','add-my-avatar-url-btn','authorChatId','.poll-action-btn','upgrade','rp-details-summary','cphone','https://i.postimg.cc/PxZrFFFL/o-o-1.jpg','--music-bg-image','#e4b591','album-photo-input','myAvatar','select-all-chars-for-clear','\x22><svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20favorite\x20','已拒收对方转账','备忘录','join','werewolf-','groupAvatarLibrary','张NovelAI图片:\x20','-\x20**','manage-my-avatar-library-btn','char_browser_article','\x20转账\x20','offlinePresetId','++id,\x20albumId','position','✅\x20检查完成，未发现任何冗余数据。','不支持的文件格式。请选择\x20.json\x20或\x20.png\x20文件。','select-all-cart-items','blocked_by_ai','maxWidth','--chat-font-size','.contact-picker-item','\x20为你切歌:\x20《','\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**用户发送的申请理由**:\x20“','link-memory-toggle','正在请求AI角色们加入讨论...','...\x0a-\x20**已有评论**:\x0a',')，祝福语是：“','</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20<div\x20class=\x22playlist-item-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20album-art-btn\x22\x20data-index=\x22','text/event-stream','pending','选择要精炼记忆的角色','status-bar-battery','\x22\x20placeholder=\x22例如：角色核心设定\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>关键词\x20(用英文逗号,分隔)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-keys-input\x22\x20value=\x22','voice','innerHTML','点击了商品卡片:\x20','cancel-clear-wizard-btn-step1','为了确保所有数据同步，建议立即刷新页面。','<span>已</span><span>超</span><span>时</span>','检测到并成功修复了\x20','favoritedPostIds','保存字体预设','照片详情','substring','select-message-btn','\x20的聊天','送给\x20','favorites-edit-btn','.qzone-post-item','member-editor','update-notice-dismiss-btn','NPC\x20\x22','novelai-settings','browser-back-btn','busy','children','一个神秘的角色。','-\x20(空)','chatItem','active','export-world-book-btn','游戏尚未结束，无法进行总结。','message-editor-modal','delete-track-btn','EPhoneWorldBookBackup','new_name','reading-library-search-input','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22memo-title\x22>','更换图标','分钟前有人聊过。','\x20的红包已被领完','voiceId','<span\x20style=\x22color:\x20green;\x22>运行中</span>','participant-avatar-wrapper','导演模式保存(Sticker):\x20提供了\x20meaning\x20但未找到对应表情:','parentNode','filter','timeZone','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','NovelAI生成失败:','add-chat-btn','char-diary-detail-back-btn','对方本名不能为空！','ai-avatar-preview','targetId','style','member-avatar-preview',')\x20试图将群名更改为成员名\x20(\x22','all\x200.3s\x20ease','renderXSocialScreenProxy','”分享TA的私人歌单...','.comment-item','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','is-realimag','cancel-variation-selection-btn','你已收款','world-book-tab','loadAsync','getPropertyValue','AI角色','poll-option-input-wrapper','locationName','album-photos-back-btn','repost','horizontal','password','由于浏览器安全限制，AI切换的歌曲无法自动播放。请手动点击播放按钮\x20▶\x20继续欣赏。','\x0a#\x20你的任务\x0a你是一个虚拟社交生活模拟器，扮演角色“','\x20的记忆\x20]\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','-\x20**姓名**:\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22url\x22>','通话记录','**。','\x0a#\x20你的内心独白\x20(上一轮的思考，仅你自己可见)\x0a-\x20心声:\x20','.icon-setting-item','load-more-btn','.photo-delete-btn','indexOf','请输入有效的图片URL！','天黑请闭眼...','assign-group-section','https://i.postimg.cc/htZppbS4/IMG-7107.gif','waimai-request-modal','\x20发布了一条新动态]','”这个信息，将其转换为【具体的公历日期】。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份会议纪要或备忘录，而不是一篇抒情散文。\x0a5.\x20\x20**【长度铁律】**:\x20你的总结【必须】非常简短，总长度【绝对不能超过80个字】。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x0a','product-variations-container','world-book-editor-title','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-time\x22>','\x22>背景</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20delete-track-btn\x22\x20data-index=\x22','world-book-tabs','，我们一起见证了这个约定。','命名表情','无法为头像命名，请检查（主/副）API配置是否正确并支持Vision。\x0a错误:\x20','https://i.postimg.cc/fLTc42dg/IMG-4391.gif','请输入书名','notification-content','https://i.postimg.cc/3N5Vndn3/IMG-4426.gif','isUserParticipating','frame_flower','tEXt','并评论说：“','mes_example','人局，身份为\x20','https://i.postimg.cc/DyYDmKtw/IMG-7238.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20用户刚刚向你发起了视频通话。请根据你的角色设定，决定是“接受”还是“拒绝”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的角色设定\x0a\x20\x20\x20\x20\x20\x20\x20\x20','statusText','chatId','\x20天\x20---','我们的回忆','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','selection-cancel-btn','rules-category-pane\x20active','image_url','聊天记录已成功覆盖！正在刷新界面...','\x0a#\x20长期记忆\x20(所有角色必须严格遵守)\x0a','novelai-api-key','werewolf-game-over-modal','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的歌单还是空的，<br>点击右上角刷新按钮生成一些歌曲吧！</p>','对方正在输入...','.status-text','chat-lock-content','.voice-play-btn','成功将群聊\x20\x22','🌐\x20使用网络URL','\x22\x20吗？','key','post-image-desc-group','paused','npc','image/','https://i.postimg.cc/4x9tTy1D/IMG-5563.gif','歌曲查找失败:\x20AI请求的歌曲名\x22','(这张照片没有描述)','分钟前聊过。','#e9ecef','variation-quantity-display','文章完整内容...','currentTime','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的浏览器空空如也，<br>点击右上角刷新按钮生成一些记录吧！</p>','”移出群聊吗？','equals','件商品','highlighted','<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20margin-top:50px;\x22>没有更多可以邀请的联系人了。</p>','无人投票','changedTouches','ai-response-editor-block','”的记忆\x20---\x0a','history-back-btn','\x0a-\x20**最近对话摘要**:\x0a','https://i.postimg.cc/VNK6Ccsf/IMG-5722.gif','[系统提示：用户（','handlePacketClick','预言家','\x0a#\x20身份与核心任务\x0a你正在扮演角色“','fontUrl','frame-item','member-management-screen','\x27);\x22','{{user}}','https://i.postimg.cc/9fQZ425b/IMG-5975.gif','dark-mode','classList','participants','无法推进剧情:\x20','countdownEndTime','char-music-total-time','edit-product-btn','”这个信息，将其转换为【具体的公历日期】。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份清晰的个人档案或事件回顾，而不是一篇情感散文。请删除重复、琐碎或纯粹的情感宣泄，只保留对情节和关系发展至关重要的部分。\x0a5.\x20\x20**【【【长度铁律】】】**:\x20你的总结【必须】非常精炼，总长度应控制在\x20**','autoMemoryInterval','【用户\x20(User)】','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20系统心跳计时器:\x20','isDeleted','speech-01','myAvatarLibrary','\x0a[文字图内容:\x20','[图片]','点击查看详情...','regenerate-char-memo-btn',')\x20商品:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22date\x22>','start','\x0a-\x20**人设**:\x20','\x22>词</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20【核心新增】在这里添加“背景”按钮\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20bg-btn\x22\x20data-index=\x22','productId','regenerate-douban-btn','toDataURL','totalAmount','rule-chat-id-select','\x0a##\x20---\x20关于“','input[name=\x22visibility\x22]:checked','检测到\x20Tavern/SillyTavern\x20预设格式，将严格按照\x20prompt_order\x20排序。','world-book-content-container','https://i.postimg.cc/R0pfKYvB/IMG-5976.gif','\x22><div\x20class=\x22poll-option-bar\x22\x20style=\x22width:\x20','char-music-mode-btn','globalSettings','werewolf-player-grid','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22margin-bottom:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-weight:\x20500;\x20margin:\x200\x200\x205px\x200;\x22>','https://i.postimg.cc/Dw2bDhZh/IMG-6140.gif','在导演模式保存时，发现无效的指令对象，已跳过:','此操作将使用AI生成新的商品和分类，并【添加】到现有列表中。确定要继续吗？','清理完成','%\x20+\x20','\x20转发了\x20@','确定要删除这条通话消息吗？','listen-together-btn','fill','confirm-contact-picker-btn','renderingRules','\x20的礼物','copy-post-btn','。请你对此作出回应，可以表现出好奇、开玩笑（比如\x27我截图了！\x27）、或者根据你的人设表示理解或疑惑。]','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请开始你的导演工作，让群聊再次热闹起来吧！\x0a\x20\x20\x20\x20\x20\x20\x20\x20','ttsCache','https://i.postimg.cc/Qx5dqyJ3/IMG-6917.gif','profile-thoughts-history-view','qzonePosts','检测到AI执行了动态操作，立即刷新好友动态页面。','\x0a#\x20【【【群公告\x20(最高优先级规则)】】】\x0a你【必须】阅读、理解并严格遵守以下所有公告，它们凌驾于你的人设之上。\x0a','frame_12','\x0a-\x20','<div\x20class=\x22rp-claimed-info\x22>你领取了红包，金额\x20','）的话题来问候用户，可以表达惊讶（“哇，好久不见！”）、关心（“最近怎么样？”）或者分享你自己的近况，绝对不要延续之前的话题！\x0a-\x20**上下文参考**:\x20下面的“对话历史”仅供你回忆，【不要】直接回应其中的内容。','导演模式','char-conversation-messages','icon-img-','share_card','row','无法生成浏览记录，请检查API配置或稍后再试。\x0a错误:\x20','https://','select-all-types-for-clear','\x20发布了一条新公告','ai-persona','slice','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>','hang-up-btn','messageTimestamp','AI已接收并理解了该图片的内容。','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>购物车是空的哦~</p>','分类《','activeContainer','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22album-cover\x22\x20style=\x22background-image:\x20url(','post-local-image-input','placeholder','解析AI返回的JSON时出错:\x20','https://i.postimg.cc/k45sd8gn/IMG-6375.gif','world-book-screen','这将提取当前通话记录发送给AI进行总结，会消耗API额度。确定要继续吗？','decline-call-btn','\x27刚刚在你的动态“','生成模拟日记失败:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-end;\x20align-items:\x20center;\x20gap:\x2010px;\x20margin-bottom:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20class=\x22toggle-switch\x22\x20title=\x22启用/禁用此条目\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22entry-enabled-switch\x22\x20','qzone','0:00','我已了解风险，确认压缩','.search-result-item','https://i.postimg.cc/HLKvs0Kv/IMG-7109.gif','poll-question-input','冗余数据清理流程已启动...','https://i.postimg.cc/50k390X8/IMG-6376.gif','back-to-char-qq-list-btn','投票结果：','confirm-gift-recipient-btn','round','chat-input','close-novelai-test','TTS\x20音频已保存到缓存。','generativelanguage'];_0x2ca1=function(){return _0x25d3b5;};return _0x2ca1();}const _0x18f943=_0x26e9;(function(_0x2c351e,_0x583e2c){const _0x4bc799=_0x26e9,_0x26c7ff=_0x2c351e();while(!![]){try{const _0x23f6dc=parseInt(_0x4bc799(0xd9a))/0x1*(-parseInt(_0x4bc799(0x4b9))/0x2)+-parseInt(_0x4bc799(0xb63))/0x3*(-parseInt(_0x4bc799(0x11dd))/0x4)+parseInt(_0x4bc799(0x338))/0x5*(-parseInt(_0x4bc799(0x4fb))/0x6)+-parseInt(_0x4bc799(0xae))/0x7+parseInt(_0x4bc799(0x1f6))/0x8+-parseInt(_0x4bc799(0x23f))/0x9*(parseInt(_0x4bc799(0x303))/0xa)+-parseInt(_0x4bc799(0xc59))/0xb*(-parseInt(_0x4bc799(0x430))/0xc);if(_0x23f6dc===_0x583e2c)break;else _0x26c7ff['push'](_0x26c7ff['shift']());}catch(_0x5ebd9a){_0x26c7ff['push'](_0x26c7ff['shift']());}}}(_0x2ca1,0x9217e));_0x18f943(0x8af)in navigator&&window[_0x18f943(0x205)]('load',()=>{const _0x2ca3ab=_0x18f943;navigator['serviceWorker'][_0x2ca3ab(0x127e)](_0x2ca3ab(0xbe9))['then'](_0x2a9570=>{const _0x32133d=_0x2ca3ab;console[_0x32133d(0x51f)](_0x32133d(0x282),_0x2a9570['scope']);})[_0x2ca3ab(0x876)](_0x2b7113=>{const _0x3332c4=_0x2ca3ab;console[_0x3332c4(0x51f)](_0x3332c4(0xfa5),_0x2b7113);});});!Array['prototype'][_0x18f943(0xfc9)]&&Object[_0x18f943(0xffb)](Array['prototype'],'findLastIndex',{'value':function(_0xde49e3){const _0x28a930=_0x18f943;if(this==null)throw new TypeError(_0x28a930(0x90e));if(typeof _0xde49e3!==_0x28a930(0xf09))throw new TypeError(_0x28a930(0x11d));let _0x519bd0=Object(this),_0x49d05f=_0x519bd0[_0x28a930(0x79b)]>>>0x0,_0x15b5b0=arguments[0x1],_0x577b93=_0x49d05f-0x1;while(_0x577b93>=0x0){let _0x510744=_0x519bd0[_0x577b93];if(_0xde49e3[_0x28a930(0x5a1)](_0x15b5b0,_0x510744,_0x577b93,_0x519bd0))return _0x577b93;_0x577b93--;}return-0x1;},'configurable':!![],'writable':!![]});let activeMessageTimestamp=null,activeTransferTimestamp=null,lastRawAiResponse='',lastResponseTimestamps=[],currentQzoneReplyContext=null,editingNpcId=null;const GEMINI_API_URL=_0x18f943(0xbfd);function _0x26e9(_0x442fd3,_0x3f292f){const _0x2ca132=_0x2ca1();return _0x26e9=function(_0x26e9db,_0x423c92){_0x26e9db=_0x26e9db-0x6f;let _0x3570aa=_0x2ca132[_0x26e9db];return _0x3570aa;},_0x26e9(_0x442fd3,_0x3f292f);}function getRandomValue(_0x395f5c){const _0x1509c9=_0x18f943;if(_0x395f5c[_0x1509c9(0x1d4)](',')){const _0x53d976=_0x395f5c[_0x1509c9(0x8d7)](',')[_0x1509c9(0x9d5)](_0x1a93e3=>_0x1a93e3[_0x1509c9(0x7da)]()),_0x142570=Math['floor'](Math[_0x1509c9(0xa11)]()*_0x53d976[_0x1509c9(0x79b)]);return _0x53d976[_0x142570];}return _0x395f5c;}function isImage(_0x32583c){const _0x1f1d4c=_0x18f943;if(_0x32583c['image_url']&&_0x32583c[_0x1f1d4c(0x10a1)][_0x1f1d4c(0x11a)]){let _0x3ab07f=_0x32583c[_0x1f1d4c(0x10a1)]['url'];const _0x142297=_0x3ab07f['split'](',')[0x1],_0x1b9367=_0x3ab07f[_0x1f1d4c(0x1242)](/^data:(.*);base64/)[0x1];return[{'text':_0x1f1d4c(0x3aa)},{'inline_data':{'mime_type':_0x1b9367,'data':_0x142297}}];}return[];}function getGeminiResponseText(_0x10b4a0){const _0x3da02d=_0x18f943;if(_0x10b4a0['choices']&&Array[_0x3da02d(0x621)](_0x10b4a0[_0x3da02d(0x326)])&&_0x10b4a0['choices'][_0x3da02d(0x79b)]>0x0&&_0x10b4a0[_0x3da02d(0x326)][0x0][_0x3da02d(0xf93)]&&_0x10b4a0['choices'][0x0]['message']['content'])return _0x10b4a0['choices'][0x0][_0x3da02d(0xf93)][_0x3da02d(0xcbd)];if(_0x10b4a0[_0x3da02d(0x11de)]&&Array['isArray'](_0x10b4a0[_0x3da02d(0x11de)])&&_0x10b4a0[_0x3da02d(0x11de)]['length']>0x0&&_0x10b4a0[_0x3da02d(0x11de)][0x0][_0x3da02d(0xcbd)]&&_0x10b4a0[_0x3da02d(0x11de)][0x0][_0x3da02d(0xcbd)][_0x3da02d(0xec1)])return _0x10b4a0[_0x3da02d(0x11de)][0x0]['content'][_0x3da02d(0xec1)][0x0][_0x3da02d(0x996)];console[_0x3da02d(0x4d9)](_0x3da02d(0x1230),_0x10b4a0);let _0x35b195='AI返回了空内容或未知格式。';if(_0x10b4a0[_0x3da02d(0x11de)]&&Array[_0x3da02d(0x621)](_0x10b4a0[_0x3da02d(0x11de)])&&_0x10b4a0['candidates'][_0x3da02d(0x79b)]>0x0&&_0x10b4a0[_0x3da02d(0x11de)][0x0][_0x3da02d(0x1234)]===_0x3da02d(0x827)){const _0x3408cc=_0x10b4a0['candidates'][0x0][_0x3da02d(0xfc1)],_0xd8f3db=_0x3408cc[_0x3da02d(0x1054)](_0x14c1e3=>_0x14c1e3['probability']!=='NEGLIGIBLE'&&_0x14c1e3[_0x3da02d(0xd3a)]!==_0x3da02d(0xfe7))['map'](_0x100229=>_0x100229[_0x3da02d(0xefe)]+_0x3da02d(0x60d)+_0x100229[_0x3da02d(0xd3a)]+')')[_0x3da02d(0x100b)](',\x20');_0x35b195=_0x3da02d(0x510)+(_0xd8f3db||'未知');}else{if(_0x10b4a0[_0x3da02d(0xf51)]?.[_0x3da02d(0xc60)]){const _0x255059=_0x10b4a0[_0x3da02d(0xf51)][_0x3da02d(0xc60)],_0x40ef5d=_0x10b4a0['promptFeedback'][_0x3da02d(0xfc1)]?.['map'](_0x21329a=>_0x21329a[_0x3da02d(0xefe)]+':\x20'+_0x21329a['probability'])['join'](',\x20');_0x35b195='内容因安全策略被屏蔽\x20(原因:\x20'+_0x255059+_0x3da02d(0x72b)+(_0x40ef5d||'无');}else _0x10b4a0['error']&&(_0x35b195='API错误:\x20'+_0x10b4a0['error'][_0x3da02d(0xf93)]);}throw new Error(_0x35b195);}document[_0x18f943(0x205)]('DOMContentLoaded',()=>{const _0x247bea=_0x18f943;document[_0x247bea(0x205)](_0x247bea(0x277),()=>{const _0x2758e3=_0x247bea;document[_0x2758e3(0x256)]===_0x2758e3(0x143)&&(console[_0x2758e3(0x51f)](_0x2758e3(0xc3a)),navigator[_0x2758e3(0x8af)][_0x2758e3(0xa1e)][_0x2758e3(0x5d2)](_0x127999=>{_0x127999['update']();}));});function _0x202ea1(_0x653ef9,_0x59219e,_0xd87bf9,_0x31e39e){const _0x2221df=_0x247bea,_0x1c95ee=_0x12493e[_0x2221df(0x10f6)][_0x2221df(0xd52)]||0.8,_0x8b43b9={'user':_0x2221df(0x717),'assistant':_0x2221df(0xd6d),'system':'user'},_0x124a83=[{'role':'user','parts':[{'text':_0xd87bf9}]},{'role':'model','parts':[{'text':_0x2221df(0xe96)}]},..._0x31e39e['map'](_0x1ab7f3=>{const _0x5dfc66=_0x2221df,_0x9f581=[];return Array[_0x5dfc66(0x621)](_0x1ab7f3[_0x5dfc66(0xcbd)])?_0x1ab7f3[_0x5dfc66(0xcbd)][_0x5dfc66(0xd6a)](_0x1698f3=>{const _0x5bf5cb=_0x5dfc66;if(_0x1698f3[_0x5bf5cb(0x52a)]===_0x5bf5cb(0x996))_0x9f581[_0x5bf5cb(0x2d6)]({'text':_0x1698f3[_0x5bf5cb(0x996)]});else{if(_0x1698f3[_0x5bf5cb(0x52a)]===_0x5bf5cb(0x10a1)&&_0x1698f3[_0x5bf5cb(0x10a1)]&&_0x1698f3[_0x5bf5cb(0x10a1)][_0x5bf5cb(0x11a)]){const _0x2176dc=_0x1698f3[_0x5bf5cb(0x10a1)][_0x5bf5cb(0x11a)],_0x336d00=_0x2176dc[_0x5bf5cb(0x8d7)](',')[0x1],_0x5338c4=_0x2176dc[_0x5bf5cb(0x1242)](/^data:(.*);base64/);_0x5338c4&&_0x336d00&&_0x9f581[_0x5bf5cb(0x2d6)]({'inline_data':{'mime_type':_0x5338c4[0x1],'data':_0x336d00}});}}}):_0x9f581['push']({'text':String(_0x1ab7f3[_0x5dfc66(0xcbd)])}),{'role':_0x8b43b9[_0x1ab7f3['role']],'parts':_0x9f581};})];return{'url':'https://generativelanguage.googleapis.com/v1beta/models/'+_0x653ef9+_0x2221df(0x125)+getRandomValue(_0x59219e),'data':{'method':_0x2221df(0x90),'headers':{'Content-Type':'application/json'},'body':JSON[_0x2221df(0xd27)]({'contents':_0x124a83,'generationConfig':{'temperature':_0x1c95ee}})}};}const _0x2a2987=new Dexie(_0x247bea(0x9e)),_0x491751=[{'id':_0x247bea(0x854),'url':'','name':'无'},{'id':_0x247bea(0x56f),'url':'https://i.postimg.cc/fLDnz5Pn/IMG-5574.gif','name':'1'},{'id':_0x247bea(0xa38),'url':'https://i.postimg.cc/HxH3cNHz/IMG-6871.gif','name':'2'},{'id':'frame_flower','url':_0x247bea(0x9fb),'name':'3'},{'id':_0x247bea(0x12a8),'url':'https://i.postimg.cc/85Zsyjwn/IMG-6895.gif','name':'4'},{'id':'frame_5','url':_0x247bea(0xd5d),'name':'5'},{'id':_0x247bea(0xe90),'url':_0x247bea(0x176),'name':'6'},{'id':_0x247bea(0x3c2),'url':_0x247bea(0xf5f),'name':'7'},{'id':_0x247bea(0xf53),'url':_0x247bea(0xf6d),'name':'8'},{'id':_0x247bea(0x73f),'url':_0x247bea(0xe4c),'name':'9'},{'id':_0x247bea(0xa73),'url':'https://i.postimg.cc/63NmX03s/IMG-4366.gif','name':'10'},{'id':_0x247bea(0x1289),'url':_0x247bea(0x274),'name':'11'},{'id':_0x247bea(0x110e),'url':_0x247bea(0x24f),'name':'12'},{'id':_0x247bea(0xc89),'url':_0x247bea(0xbc4),'name':'13'},{'id':'frame_14','url':_0x247bea(0x5f6),'name':'14'},{'id':_0x247bea(0x56f),'url':_0x247bea(0xc6f),'name':'1'},{'id':'frame_ribbon','url':_0x247bea(0xc4a),'name':'2'},{'id':_0x247bea(0x1093),'url':_0x247bea(0xd43),'name':'3'},{'id':_0x247bea(0x12a8),'url':_0x247bea(0xe76),'name':'4'},{'id':_0x247bea(0x5cd),'url':'https://i.postimg.cc/qBbKK7dS/IMG-4386.gif','name':'5'},{'id':_0x247bea(0xe90),'url':_0x247bea(0xeb8),'name':'6'},{'id':_0x247bea(0x3c2),'url':_0x247bea(0xf35),'name':'7'},{'id':_0x247bea(0xf53),'url':_0x247bea(0x108e),'name':'8'},{'id':_0x247bea(0x73f),'url':_0x247bea(0xec),'name':'9'},{'id':'frame_10','url':_0x247bea(0xc43),'name':'10'},{'id':_0x247bea(0x1289),'url':_0x247bea(0x11b6),'name':'11'},{'id':_0x247bea(0x110e),'url':_0x247bea(0xa7b),'name':'12'},{'id':_0x247bea(0xc89),'url':_0x247bea(0xced),'name':'13'},{'id':_0x247bea(0xa6b),'url':_0x247bea(0x415),'name':'14'},{'id':_0x247bea(0x56f),'url':_0x247bea(0x83),'name':'1'},{'id':_0x247bea(0xa38),'url':_0x247bea(0x471),'name':'2'},{'id':_0x247bea(0x1093),'url':'https://i.postimg.cc/g0s1V0PX/IMG-4402.gif','name':'3'},{'id':'frame_tech','url':_0x247bea(0x6b9),'name':'4'},{'id':_0x247bea(0x5cd),'url':'https://i.postimg.cc/q7cQnDy1/IMG-4404.gif','name':'5'},{'id':'frame_6','url':'https://i.postimg.cc/RFK3q2t0/IMG-4407.gif','name':'6'},{'id':'frame_7','url':'https://i.postimg.cc/gcV0VR2t/IMG-4408.gif','name':'7'},{'id':_0x247bea(0xf53),'url':_0x247bea(0x18d),'name':'8'},{'id':_0x247bea(0x73f),'url':_0x247bea(0x777),'name':'9'},{'id':'frame_10','url':_0x247bea(0x265),'name':'10'},{'id':_0x247bea(0x1289),'url':_0x247bea(0xa0),'name':'11'},{'id':_0x247bea(0x110e),'url':_0x247bea(0x11b),'name':'12'},{'id':_0x247bea(0xc89),'url':_0x247bea(0xf88),'name':'13'},{'id':_0x247bea(0xa6b),'url':'https://i.postimg.cc/vHCSG1WM/IMG-4416.gif','name':'14'},{'id':'frame_cat_ear','url':_0x247bea(0x443),'name':'1'},{'id':_0x247bea(0xa38),'url':_0x247bea(0x5dc),'name':'2'},{'id':_0x247bea(0x1093),'url':_0x247bea(0x4c4),'name':'3'},{'id':_0x247bea(0x12a8),'url':_0x247bea(0xe6b),'name':'4'},{'id':_0x247bea(0x5cd),'url':_0x247bea(0x7f8),'name':'5'},{'id':_0x247bea(0xe90),'url':'https://i.postimg.cc/mrkvDxPW/IMG-4422.gif','name':'6'},{'id':_0x247bea(0x3c2),'url':_0x247bea(0x12a3),'name':'7'},{'id':'frame_8','url':_0x247bea(0x1091),'name':'8'},{'id':_0x247bea(0x73f),'url':_0x247bea(0xd29),'name':'9'},{'id':_0x247bea(0xa73),'url':_0x247bea(0xea1),'name':'10'},{'id':'frame_11','url':_0x247bea(0xf8a),'name':'11'},{'id':_0x247bea(0x110e),'url':_0x247bea(0x83f),'name':'12'},{'id':_0x247bea(0xc89),'url':_0x247bea(0x3dd),'name':'13'},{'id':_0x247bea(0xa6b),'url':_0x247bea(0xa66),'name':'14'},{'id':_0x247bea(0x56f),'url':_0x247bea(0xf86),'name':'1'},{'id':_0x247bea(0xa38),'url':'https://i.postimg.cc/Mpv5fzm5/IMG-4439.gif','name':'2'},{'id':_0x247bea(0x1093),'url':'https://i.postimg.cc/T1tjhsyB/IMG-4720.gif','name':'3'},{'id':_0x247bea(0x12a8),'url':_0x247bea(0xa4d),'name':'4'},{'id':_0x247bea(0x5cd),'url':'https://i.postimg.cc/g2XykNGB/IMG-4727.gif','name':'5'},{'id':_0x247bea(0xe90),'url':_0x247bea(0x31c),'name':'6'},{'id':_0x247bea(0x3c2),'url':_0x247bea(0xf83),'name':'7'},{'id':_0x247bea(0xf53),'url':_0x247bea(0xec7),'name':'8'},{'id':_0x247bea(0x73f),'url':_0x247bea(0x10b3),'name':'9'},{'id':_0x247bea(0xa73),'url':_0x247bea(0x79a),'name':'10'},{'id':'frame_11','url':_0x247bea(0x82e),'name':'11'},{'id':_0x247bea(0x110e),'url':_0x247bea(0x1200),'name':'12'},{'id':_0x247bea(0xc89),'url':_0x247bea(0x2e6),'name':'13'},{'id':'frame_14','url':_0x247bea(0xb42),'name':'14'},{'id':_0x247bea(0x56f),'url':_0x247bea(0x536),'name':'1'},{'id':_0x247bea(0xa38),'url':_0x247bea(0x283),'name':'2'},{'id':_0x247bea(0x1093),'url':'https://i.postimg.cc/hj4dkrvj/IMG-5578.gif','name':'3'},{'id':_0x247bea(0x12a8),'url':_0x247bea(0x23e),'name':'4'},{'id':_0x247bea(0x5cd),'url':_0x247bea(0x1b8),'name':'5'},{'id':'frame_6','url':_0x247bea(0x8b3),'name':'6'},{'id':'frame_7','url':_0x247bea(0xa30),'name':'7'},{'id':_0x247bea(0xf53),'url':_0x247bea(0x550),'name':'8'},{'id':'frame_9','url':_0x247bea(0x10c7),'name':'9'},{'id':_0x247bea(0xa73),'url':'https://i.postimg.cc/wx72fhr2/IMG-5968.gif','name':'10'},{'id':_0x247bea(0x1289),'url':'https://i.postimg.cc/QdrqdvdY/IMG-5969.gif','name':'11'},{'id':_0x247bea(0x110e),'url':'https://i.postimg.cc/0yd0MZ6k/IMG-5971.gif','name':'12'},{'id':_0x247bea(0xc89),'url':_0x247bea(0xcf0),'name':'13'},{'id':_0x247bea(0xa6b),'url':_0x247bea(0x1236),'name':'14'},{'id':_0x247bea(0x56f),'url':_0x247bea(0x10f3),'name':'1'},{'id':_0x247bea(0xa38),'url':_0x247bea(0x10d1),'name':'2'},{'id':'frame_flower','url':_0x247bea(0x686),'name':'3'},{'id':'frame_tech','url':_0x247bea(0x678),'name':'4'},{'id':_0x247bea(0x5cd),'url':_0x247bea(0x10f9),'name':'5'},{'id':_0x247bea(0xe90),'url':_0x247bea(0xcdd),'name':'6'},{'id':_0x247bea(0x3c2),'url':'https://i.postimg.cc/qRCtnMms/IMG-6145.gif','name':'7'},{'id':'frame_8','url':_0x247bea(0x9f6),'name':'8'},{'id':_0x247bea(0x73f),'url':_0x247bea(0x12ad),'name':'9'},{'id':_0x247bea(0xa73),'url':'https://i.postimg.cc/nhcC21Rc/IMG-6148.gif','name':'10'},{'id':'frame_11','url':_0x247bea(0xa28),'name':'11'},{'id':_0x247bea(0x110e),'url':_0x247bea(0xdf8),'name':'12'},{'id':'frame_13','url':_0x247bea(0x1c7),'name':'13'},{'id':_0x247bea(0xa6b),'url':_0x247bea(0xa1b),'name':'14'},{'id':_0x247bea(0x56f),'url':'https://i.postimg.cc/YSRRV8kn/IMG-6297.gif','name':'1'},{'id':_0x247bea(0xa38),'url':_0x247bea(0x1128),'name':'2'},{'id':_0x247bea(0x1093),'url':_0x247bea(0x1136),'name':'3'},{'id':_0x247bea(0x12a8),'url':_0x247bea(0x729),'name':'4'},{'id':'frame_5','url':'https://i.postimg.cc/cCpBYbMH/IMG-6552.gif','name':'5'},{'id':_0x247bea(0xe90),'url':'https://i.postimg.cc/Pf9g2fSL/IMG-6554.gif','name':'6'},{'id':_0x247bea(0x3c2),'url':'https://i.postimg.cc/gkhf597g/IMG-6555.gif','name':'7'},{'id':_0x247bea(0xf53),'url':'https://i.postimg.cc/g2PfbSFm/IMG-6556.gif','name':'8'},{'id':'frame_9','url':'https://i.postimg.cc/pLY3WfR8/IMG-6557.gif','name':'9'},{'id':'frame_10','url':_0x247bea(0xbc9),'name':'10'},{'id':_0x247bea(0x1289),'url':_0x247bea(0x74),'name':'11'},{'id':'frame_12','url':'https://i.postimg.cc/ydwLXx7s/IMG-6562.gif','name':'12'},{'id':_0x247bea(0xc89),'url':_0x247bea(0x8a5),'name':'13'},{'id':_0x247bea(0xa6b),'url':_0x247bea(0xe4a),'name':'14'},{'id':_0x247bea(0x56f),'url':'https://i.postimg.cc/GmcqjZn8/IMG-6566.gif','name':'1'},{'id':'frame_ribbon','url':'https://i.postimg.cc/k5Gs0K47/IMG-6567.gif','name':'2'},{'id':_0x247bea(0x1093),'url':_0x247bea(0xd2e),'name':'3'},{'id':_0x247bea(0x12a8),'url':_0x247bea(0x1d3),'name':'4'},{'id':_0x247bea(0x5cd),'url':_0x247bea(0x730),'name':'5'},{'id':'frame_6','url':_0x247bea(0x697),'name':'6'},{'id':_0x247bea(0x3c2),'url':_0x247bea(0x9dc),'name':'7'},{'id':_0x247bea(0xf53),'url':_0x247bea(0x915),'name':'8'},{'id':_0x247bea(0x73f),'url':_0x247bea(0x4cd),'name':'9'},{'id':'frame_10','url':_0x247bea(0x51c),'name':'10'},{'id':_0x247bea(0x1289),'url':_0x247bea(0xa07),'name':'11'},{'id':'frame_12','url':'https://i.postimg.cc/28TsrxRV/IMG-6852.gif','name':'12'},{'id':'frame_13','url':_0x247bea(0x975),'name':'13'},{'id':_0x247bea(0xa6b),'url':_0x247bea(0x619),'name':'14'},{'id':_0x247bea(0x56f),'url':_0x247bea(0x5c6),'name':'1'},{'id':'frame_ribbon','url':_0x247bea(0x6cf),'name':'2'},{'id':_0x247bea(0x1093),'url':_0x247bea(0xb1c),'name':'3'},{'id':_0x247bea(0x12a8),'url':_0x247bea(0xe4e),'name':'4'},{'id':_0x247bea(0x5cd),'url':'https://i.postimg.cc/vBqsQW7X/IMG-6858.gif','name':'5'},{'id':'frame_6','url':_0x247bea(0xcb2),'name':'6'},{'id':_0x247bea(0x3c2),'url':_0x247bea(0x91d),'name':'7'},{'id':'frame_8','url':_0x247bea(0x115),'name':'8'},{'id':_0x247bea(0x73f),'url':_0x247bea(0x606),'name':'9'},{'id':_0x247bea(0xa73),'url':'https://i.postimg.cc/nryNzTXK/IMG-6915.gif','name':'10'},{'id':_0x247bea(0x1289),'url':_0x247bea(0x1109),'name':'11'},{'id':_0x247bea(0x110e),'url':_0x247bea(0x493),'name':'12'},{'id':_0x247bea(0xc89),'url':'https://i.postimg.cc/tgR6wjBP/IMG-5570.gif','name':'13'},{'id':_0x247bea(0xa6b),'url':_0x247bea(0x9d1),'name':'14'},{'id':_0x247bea(0x1289),'url':_0x247bea(0x46b),'name':'11'},{'id':_0x247bea(0x110e),'url':_0x247bea(0x669),'name':'12'},{'id':_0x247bea(0xc89),'url':_0x247bea(0x3ac),'name':'13'},{'id':_0x247bea(0xa6b),'url':_0x247bea(0x340),'name':'14'},{'id':_0x247bea(0xc89),'url':_0x247bea(0x855),'name':'13'},{'id':'frame_14','url':_0x247bea(0x273),'name':'14'},{'id':_0x247bea(0xc89),'url':_0x247bea(0x937),'name':'13'},{'id':_0x247bea(0xa6b),'url':_0x247bea(0x8f),'name':'14'},{'id':_0x247bea(0xa6b),'url':'https://i.postimg.cc/RVt6sRzc/IMG-6939.gif','name':'14'},{'id':_0x247bea(0xc89),'url':_0x247bea(0x68a),'name':'13'},{'id':'frame_14','url':_0x247bea(0xfac),'name':'14'},{'id':_0x247bea(0xa6b),'url':_0x247bea(0x4ae),'name':'14'},{'id':_0x247bea(0x110e),'url':_0x247bea(0x69a),'name':'12'},{'id':_0x247bea(0xc89),'url':'https://i.postimg.cc/DZgMwc1H/817178fdbpf2ff7740dc98e26ab78759.gif','name':'13'},{'id':_0x247bea(0xa6b),'url':'https://i.postimg.cc/3NffgJSZ/e09c07034ld7e62266c0a5de6a36ae62.gif','name':'14'},{'id':_0x247bea(0xc89),'url':'https://i.postimg.cc/vHDNGfT2/35ac7f372v588bf48d4f659077196b85.gif','name':'13'},{'id':_0x247bea(0xa6b),'url':_0x247bea(0xaf2),'name':'14'},{'id':_0x247bea(0xc89),'url':_0x247bea(0x466),'name':'13'},{'id':_0x247bea(0xa6b),'url':_0x247bea(0xd4b),'name':'14'},{'id':_0x247bea(0xa6b),'url':_0x247bea(0xd0a),'name':'14'},{'id':'frame_13','url':_0x247bea(0x675),'name':'13'},{'id':_0x247bea(0xa6b),'url':_0x247bea(0x813),'name':'14'},{'id':'frame_14','url':_0x247bea(0x507),'name':'14'},{'id':'frame_13','url':_0x247bea(0x721),'name':'13'},{'id':'frame_14','url':_0x247bea(0x3ce),'name':'14'},{'id':_0x247bea(0xa6b),'url':_0x247bea(0x9a2),'name':'14'},{'id':_0x247bea(0xa6b),'url':_0x247bea(0x946),'name':'14'},{'id':_0x247bea(0xc89),'url':'https://i.postimg.cc/Z5nrCyS5/IMG-7006.gif','name':'13'},{'id':'frame_14','url':_0x247bea(0xfb8),'name':'14'},{'id':'frame_14','url':_0x247bea(0xbed),'name':'14'},{'id':_0x247bea(0xc89),'url':'https://i.postimg.cc/ZnJNZWHZ/IMG-7009.gif','name':'13'},{'id':_0x247bea(0xa6b),'url':_0x247bea(0xa23),'name':'14'},{'id':_0x247bea(0xa6b),'url':'https://i.postimg.cc/tRzPkzRg/IMG-7012.gif','name':'14'},{'id':_0x247bea(0xc89),'url':_0x247bea(0x5c5),'name':'13'},{'id':_0x247bea(0xa6b),'url':_0x247bea(0xbe8),'name':'14'},{'id':_0x247bea(0xa6b),'url':'https://i.postimg.cc/rwDr8X1d/IMG-7015.gif','name':'14'},{'id':'frame_14','url':_0x247bea(0x8bc),'name':'14'},{'id':_0x247bea(0xc89),'url':'https://i.postimg.cc/QMVdG9x6/IMG-7016.gif','name':'13'},{'id':_0x247bea(0xa6b),'url':'https://i.postimg.cc/mZ9hgH3J/IMG-7019.gif','name':'14'},{'id':_0x247bea(0xa6b),'url':_0x247bea(0xc6b),'name':'14'},{'id':_0x247bea(0xc89),'url':'https://i.postimg.cc/hP9JpdfT/IMG-7023.gif','name':'13'},{'id':_0x247bea(0xa6b),'url':_0x247bea(0x5cc),'name':'14'},{'id':_0x247bea(0xa6b),'url':_0x247bea(0xd5f),'name':'14'},{'id':'frame_14','url':_0x247bea(0x8e),'name':'14'},{'id':_0x247bea(0xc89),'url':_0x247bea(0x8f8),'name':'13'},{'id':_0x247bea(0xa6b),'url':_0x247bea(0xa3e),'name':'14'},{'id':_0x247bea(0xa6b),'url':'https://i.postimg.cc/LscBkxZb/mmexport1751017556565.gif','name':'14'},{'id':_0x247bea(0xc89),'url':_0x247bea(0x120d),'name':'13'},{'id':_0x247bea(0xa6b),'url':_0x247bea(0xe3f),'name':'14'},{'id':_0x247bea(0xa6b),'url':_0x247bea(0x386),'name':'14'},{'id':_0x247bea(0xa6b),'url':'https://i.postimg.cc/JnwFp3Kx/mmexport1751031208329.gif','name':'14'},{'id':_0x247bea(0xc89),'url':_0x247bea(0x8f2),'name':'13'},{'id':_0x247bea(0xa6b),'url':_0x247bea(0x382),'name':'14'},{'id':_0x247bea(0xa6b),'url':_0x247bea(0xdd),'name':'14'},{'id':_0x247bea(0xc89),'url':_0x247bea(0xad8),'name':'13'},{'id':_0x247bea(0xa6b),'url':_0x247bea(0x3f3),'name':'14'},{'id':'frame_14','url':_0x247bea(0xfe3),'name':'14'},{'id':_0x247bea(0xa6b),'url':'https://i.postimg.cc/CMv02LHm/mmexport1751034842120.gif','name':'14'},{'id':_0x247bea(0xc89),'url':'https://i.postimg.cc/rFnSzWGx/mmexport1751035618517.gif','name':'13'},{'id':_0x247bea(0xa6b),'url':'https://i.postimg.cc/7YRbzN51/mmexport1751036276038.gif','name':'14'},{'id':_0x247bea(0xa6b),'url':_0x247bea(0xdcd),'name':'14'},{'id':_0x247bea(0xc89),'url':_0x247bea(0xb79),'name':'13'},{'id':_0x247bea(0xa6b),'url':_0x247bea(0x632),'name':'14'},{'id':_0x247bea(0xa6b),'url':'https://i.postimg.cc/J4fwkTLW/mmexport1751038167142.gif','name':'14'},{'id':_0x247bea(0xa6b),'url':_0x247bea(0x75),'name':'14'},{'id':_0x247bea(0xc89),'url':_0x247bea(0xf1),'name':'13'},{'id':_0x247bea(0xa6b),'url':_0x247bea(0x1098),'name':'14'},{'id':'frame_14','url':_0x247bea(0x459),'name':'14'},{'id':_0x247bea(0xc89),'url':_0x247bea(0x1284),'name':'13'},{'id':_0x247bea(0xa6b),'url':_0x247bea(0x3fb),'name':'14'},{'id':'frame_14','url':_0x247bea(0x122b),'name':'14'},{'id':_0x247bea(0xa6b),'url':_0x247bea(0x11c9),'name':'14'},{'id':'frame_13','url':_0x247bea(0xaba),'name':'13'},{'id':_0x247bea(0xa6b),'url':_0x247bea(0xa69),'name':'14'},{'id':_0x247bea(0xa6b),'url':'https://i.postimg.cc/vZt0fFKn/IMB-r-HMBXY.gif','name':'14'},{'id':_0x247bea(0xc89),'url':_0x247bea(0x408),'name':'13'},{'id':_0x247bea(0xa6b),'url':'https://i.postimg.cc/rmB17Qbc/IMB-f-VDf-Fc.gif','name':'14'},{'id':_0x247bea(0xa6b),'url':_0x247bea(0x8f3),'name':'14'},{'id':'frame_14','url':_0x247bea(0x307),'name':'14'},{'id':_0x247bea(0xc89),'url':_0x247bea(0x48f),'name':'13'},{'id':'frame_14','url':'https://i.postimg.cc/mrFhKBGz/IMB-e-QWBpa.gif','name':'14'},{'id':_0x247bea(0xa6b),'url':'https://i.postimg.cc/bw4wxW2z/IMB-16r-COL.gif','name':'14'},{'id':_0x247bea(0xc89),'url':_0x247bea(0x8a0),'name':'13'},{'id':'frame_14','url':_0x247bea(0x1254),'name':'14'},{'id':_0x247bea(0xa6b),'url':_0x247bea(0x117f),'name':'14'},{'id':_0x247bea(0xa6b),'url':_0x247bea(0x396),'name':'14'},{'id':_0x247bea(0xc89),'url':'https://i.postimg.cc/0NpZPgYj/IMG-6985.gif','name':'13'},{'id':_0x247bea(0xa6b),'url':_0x247bea(0x49d),'name':'14'},{'id':_0x247bea(0xa6b),'url':_0x247bea(0xb8c),'name':'14'},{'id':_0x247bea(0xc89),'url':_0x247bea(0x8f1),'name':'13'},{'id':_0x247bea(0xa6b),'url':_0x247bea(0xdc6),'name':'14'},{'id':_0x247bea(0xa6b),'url':_0x247bea(0x7ae),'name':'14'},{'id':'frame_14','url':_0x247bea(0x919),'name':'14'},{'id':'frame_13','url':_0x247bea(0xfb7),'name':'13'},{'id':_0x247bea(0xa6b),'url':_0x247bea(0xb46),'name':'14'},{'id':_0x247bea(0xa6b),'url':'https://i.postimg.cc/wMxmCZVC/IMG-7099.gif','name':'14'},{'id':_0x247bea(0xc89),'url':_0x247bea(0xb9a),'name':'13'},{'id':'frame_14','url':'https://i.postimg.cc/B6T59xGK/IMG-7101.gif','name':'14'},{'id':'frame_14','url':_0x247bea(0x88a),'name':'14'},{'id':_0x247bea(0xa6b),'url':_0x247bea(0x1082),'name':'14'},{'id':_0x247bea(0xc89),'url':'https://i.postimg.cc/hPgyjtyn/IMG-7108.gif','name':'13'},{'id':_0x247bea(0xa6b),'url':_0x247bea(0x1133),'name':'14'},{'id':'frame_14','url':'https://i.postimg.cc/wjwbnYkp/IMG-7111.gif','name':'14'},{'id':'frame_13','url':'https://i.postimg.cc/bJDMQVkj/IMG-7112.gif','name':'13'},{'id':'frame_14','url':'https://i.postimg.cc/SNWBTP5S/IMG-7113.gif','name':'14'},{'id':_0x247bea(0xa6b),'url':_0x247bea(0x3b8),'name':'14'}];let _0x12493e={'chats':{},'activeChatId':null,'globalSettings':{},'apiConfig':{},'userStickers':[],'worldBooks':[],'personaPresets':[],'qzoneSettings':{},'activeAlbumId':null,'cache':{'songs':new Map(),'lyrics':new Map()},'ttsCache':new Map()},_0x58b047={'isActive':![],'gameMode':null,'chatId':null,'players':[],'currentDay':0x1,'currentPhase':_0x247bea(0xe35),'nightActions':{},'gameLog':[],'discussionLog':[],'voteResults':{},'electionInfo':{'candidates':[],'votes':{}},'sheriffId':null,'lastFailedAction':null},_0x574be1=0x0;const _0x5e839e=0xf;let _0x291a6f=0x0;const _0x1ff7bc=0xa;let _0x2c7a9f=[],_0x5ebb31={'isActive':![],'activeChatId':null,'isPlaying':![],'playlist':[],'currentIndex':-0x1,'playMode':_0x247bea(0x7e9),'totalElapsedTime':0x0,'timerId':null,'parsedLyrics':[],'currentLyricIndex':-0x1},_0xff941a={'isOpen':![],'activePostId':null,'panelEl':null,'gridEl':null};const _0x3ced3a=document[_0x247bea(0xc33)]('audio-player');let _0xa2c277=null,_0x4085b7=![],_0x5d68c8=0x0,_0x200133=null,_0x52add8=![],_0x1b3792=_0x247bea(0x5c8),_0x2078e5=new Set(),_0x31659f=null,_0x375377=![],_0xae35a4=null,_0x3f944e=null,_0xafdb39=![],_0x28dd69=![],_0x4f8071=![],_0x29dd6c=![],_0x44a3ae=[],_0x47ad88=null,_0x3afdd9=null,_0x4bc591={},_0x464fa7=null,_0x41e464=null,_0x4fb2cc=null,_0x59d66f=null,_0x1c033b=null,_0xa98e96=null,_0x4b387d=null,_0x2b0414=[],_0x368297=null,_0x9f8658=null,_0x367674=new Set(),_0x26a58f=null,_0x206483=null,_0x2ef46b=null,_0x2af0fc={'isOpen':![],'photos':[],'currentIndex':-0x1},_0x38b5ff=0x0,_0x464ccd=![],_0x32a677=new Set(),_0x2f136d=null;const _0x190acc=_0x247bea(0x1002),_0x200461='https://i.postimg.cc/cLPP10Vm/4.jpg',_0x5b9dd3=_0x247bea(0xaa9),_0x2ff70a=_0x247bea(0xea6);let _0x4f5f7d,_0x4c9e39={};const _0x29e2c5=_0x247bea(0xfa4);let _0xafc893={},_0x32d3a1={},_0x218f14=null;const _0xb7c43a={'qq':_0x247bea(0x2cc),'world-book':'https://i.postimg.cc/HWf1JKzn/IMG-6435.jpg','wallpaper':'https://i.postimg.cc/T1j03pQr/IMG-6440.jpg','renderer':'https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756312261242_qdqqd_g0eriz.jpeg','api-settings':_0x247bea(0x520),'font':_0x247bea(0x44e),'char-phone':_0x247bea(0xca),'douban':_0x247bea(0xe1d),'preset':_0x247bea(0x1275),'tutorial':_0x247bea(0x208),'werewolf':'https://i.postimg.cc/k401K5g7/IMG-7304.jpg','x':_0x247bea(0x877)},_0x44ed6c={'qq':_0x247bea(0x2cc),'album':_0x247bea(0x116e),'browser':_0x247bea(0xe5e),'taobao':_0x247bea(0x6b7),'memo':'https://i.postimg.cc/J0b6Nym4/IMG-7279.jpg','diary':'https://i.postimg.cc/DZ541sbt/IMG-7280.jpg','amap':_0x247bea(0xf95),'usage':'https://i.postimg.cc/WbF8kzz9/IMG-7282.jpg','music':_0x247bea(0x20a),'ephone':_0x247bea(0xca)};let _0x198b03=null;const _0x301121=/(^https:\/\/i\.postimg\.cc\/.+|^https:\/\/files\.catbox\.moe\/.+|^https?:\/\/sharkpan\.xyz\/.+|^data:image|\.(png|jpg|jpeg|gif|webp)\?.*$|\.(png|jpg|jpeg|gif|webp)$)/i;let _0x5c866f=0x0,_0x45bda8=0x1,_0x74ffd4={'hasShown40':![],'hasShown20':![],'hasShown10':![]},_0x13ce16;const _0x5bbedd=document['createElement']('style');_0x5bbedd['id']=_0x247bea(0x926),document[_0x247bea(0xcb4)][_0x247bea(0xf77)](_0x5bbedd);const _0x5d560a=document[_0x247bea(0xc33)](_0x247bea(0xa70)),_0xb1315b=document[_0x247bea(0xc33)](_0x247bea(0xe46)),_0x222e28=document[_0x247bea(0xc33)](_0x247bea(0x2a5)),_0x5a51c7=document['getElementById'](_0x247bea(0x4c2)),_0x1c159b=document[_0x247bea(0xc33)](_0x247bea(0x25b));let _0x69eae3;function _0xe5f5a6(){const _0x3921df=_0x247bea;_0x5d560a['classList'][_0x3921df(0xb9)](_0x3921df(0x143));}function _0x37b8d7(){const _0x432ded=_0x247bea;_0x5d560a['classList']['remove'](_0x432ded(0x143)),_0x5a51c7[_0x432ded(0x10d3)][_0x432ded(0x2c7)](_0x432ded(0xa2));if(_0x69eae3)_0x69eae3(null);}function _0x416194(_0x4d2fa2){const _0x65190f=_0x247bea,_0x557ba3=document[_0x65190f(0xc33)](_0x65190f(0x65b)),_0x47bdce=_0x4d2fa2['settings']['lyricsPosition']||{'vertical':_0x65190f(0xcbe),'horizontal':_0x65190f(0xcef),'offset':0xa};_0x557ba3[_0x65190f(0x105d)][_0x65190f(0xcbe)]=_0x65190f(0x2c6),_0x557ba3[_0x65190f(0x105d)][_0x65190f(0xbc2)]=_0x65190f(0x2c6),_0x557ba3[_0x65190f(0x105d)]['left']=_0x65190f(0x2c6),_0x557ba3[_0x65190f(0x105d)][_0x65190f(0xc3f)]='auto',_0x557ba3['style'][_0x65190f(0x404)]=_0x65190f(0x854);_0x47bdce['vertical']===_0x65190f(0xcbe)?_0x557ba3[_0x65190f(0x105d)][_0x65190f(0xcbe)]=_0x47bdce[_0x65190f(0x529)]+'px':_0x557ba3['style'][_0x65190f(0xbc2)]=_0x47bdce[_0x65190f(0x529)]+'px';switch(_0x47bdce[_0x65190f(0x1070)]){case'left':_0x557ba3[_0x65190f(0x105d)][_0x65190f(0x9e2)]=_0x65190f(0xc4f);break;case _0x65190f(0xc3f):_0x557ba3[_0x65190f(0x105d)][_0x65190f(0xc3f)]=_0x65190f(0xc4f);break;case _0x65190f(0xcef):default:_0x557ba3['style'][_0x65190f(0x9e2)]=_0x65190f(0xe45),_0x557ba3[_0x65190f(0x105d)][_0x65190f(0x404)]=_0x65190f(0xab7);break;}}async function _0x52f475(_0x450382){const _0x40d5a9=_0x247bea,_0x4ad105=_0x450382[_0x40d5a9(0xe16)][_0x40d5a9(0x1d0)][0x0];if(!_0x4ad105)return;const _0x566779=await new Promise(_0x6630f5=>{const _0x1e4e58=_0x40d5a9,_0x34edcf=new FileReader();_0x34edcf['onload']=()=>_0x6630f5(_0x34edcf[_0x1e4e58(0x129)]),_0x34edcf['readAsDataURL'](_0x4ad105);});await _0x2d7ddd(_0x40d5a9(0xb37),_0x40d5a9(0xed8));try{const _0x3aa9c2=await _0x37024d(_0x566779);if(!_0x3aa9c2)throw new Error('AI未能成功描述图片。');const _0x26344b=_0x12493e[_0x40d5a9(0xc45)][_0x12493e['activeChatId']];!_0x26344b[_0x40d5a9(0x2ea)][_0x40d5a9(0x100d)]&&(_0x26344b[_0x40d5a9(0x2ea)][_0x40d5a9(0x100d)]=[]),_0x26344b[_0x40d5a9(0x2ea)][_0x40d5a9(0x100d)][_0x40d5a9(0x2d6)]({'name':_0x3aa9c2,'url':_0x566779}),await _0x2a2987[_0x40d5a9(0xc45)]['put'](_0x26344b),_0x1ca77a(),await _0x2d7ddd('上传成功！',_0x40d5a9(0x1db)+_0x3aa9c2+'”');}catch(_0x5ed776){console[_0x40d5a9(0x4d9)](_0x40d5a9(0x9ee),_0x5ed776),await _0x2d7ddd(_0x40d5a9(0xb9d),_0x40d5a9(0x108d)+_0x5ed776[_0x40d5a9(0xf93)]);}finally{_0x450382[_0x40d5a9(0xe16)][_0x40d5a9(0x22a)]=null;}}async function _0x528fba(_0x568bfd){const _0x53e9bb=_0x247bea,_0x584826=_0x568bfd[_0x53e9bb(0xe16)][_0x53e9bb(0x1d0)][0x0];if(!_0x584826)return;const _0x525e36=await new Promise(_0x4fcf28=>{const _0x43f662=_0x53e9bb,_0x9b216=new FileReader();_0x9b216[_0x43f662(0x833)]=()=>_0x4fcf28(_0x9b216[_0x43f662(0x129)]),_0x9b216[_0x43f662(0xbcf)](_0x584826);});await _0x2d7ddd(_0x53e9bb(0xb37),'正在请求AI为新头像命名...');try{const _0xf5a3e3=await _0x37024d(_0x525e36);if(!_0xf5a3e3)throw new Error(_0x53e9bb(0xe2d));const _0x358b3c=_0x12493e[_0x53e9bb(0xc45)][_0x12493e[_0x53e9bb(0x7bc)]];!_0x358b3c['settings'][_0x53e9bb(0xfc5)]&&(_0x358b3c[_0x53e9bb(0x2ea)][_0x53e9bb(0xfc5)]=[]),_0x358b3c['settings']['aiAvatarLibrary'][_0x53e9bb(0x2d6)]({'name':_0xf5a3e3,'url':_0x525e36}),await _0x2a2987[_0x53e9bb(0xc45)][_0x53e9bb(0xf36)](_0x358b3c),_0x4a5796(),await _0x2d7ddd(_0x53e9bb(0xc9),_0x53e9bb(0x11c7)+_0xf5a3e3+'”');}catch(_0xd8efa1){console[_0x53e9bb(0x4d9)]('本地头像上传及识别失败:',_0xd8efa1),await _0x2d7ddd(_0x53e9bb(0xb9d),_0x53e9bb(0x108d)+_0xd8efa1[_0x53e9bb(0xf93)]);}finally{_0x568bfd['target'][_0x53e9bb(0x22a)]=null;}}async function _0x37024d(_0x4743c1){const _0x632c1e=_0x247bea,_0x3df6b4=_0x12493e['apiConfig'][_0x632c1e(0x246)]&&_0x12493e[_0x632c1e(0xdd4)][_0x632c1e(0xbd3)]&&_0x12493e[_0x632c1e(0xdd4)][_0x632c1e(0x479)],{proxyUrl:_0x235875,apiKey:_0x298d5e,model:_0x1b8214}=_0x3df6b4?{'proxyUrl':_0x12493e[_0x632c1e(0xdd4)][_0x632c1e(0x246)],'apiKey':_0x12493e[_0x632c1e(0xdd4)]['secondaryApiKey'],'model':_0x12493e['apiConfig']['secondaryModel']}:_0x12493e[_0x632c1e(0xdd4)];if(!_0x235875||!_0x298d5e||!_0x1b8214)throw new Error('主API和副API均未配置或配置不完整。');const _0x58fc6c='请为这张图片起一个简洁的、适合作为头像库标签的名字。例如：“微笑自拍”、“阳光下的猫咪”、“蓝发动漫少女”。请直接回答名字，不要加任何多余的解释。';let _0xe90a71=_0x235875[_0x632c1e(0x1d4)](_0x632c1e(0x113e)),_0x2ac259;if(_0xe90a71){const _0x3757f4=_0x4743c1['match'](/^data:(.*);base64/)[0x1],_0x139c55=_0x4743c1[_0x632c1e(0x8d7)](',')[0x1],_0x45249a={'contents':[{'parts':[{'text':_0x58fc6c},{'inline_data':{'mime_type':_0x3757f4,'data':_0x139c55}}]}]};_0x2ac259=await fetch(_0x235875+'/'+_0x1b8214+_0x632c1e(0x125)+_0x298d5e,{'method':_0x632c1e(0x90),'headers':{'Content-Type':_0x632c1e(0xd74)},'body':JSON['stringify'](_0x45249a)});}else{const _0x2abfdb={'model':_0x1b8214,'messages':[{'role':_0x632c1e(0x717),'content':[{'type':_0x632c1e(0x996),'text':_0x58fc6c},{'type':_0x632c1e(0x10a1),'image_url':{'url':_0x4743c1}}]}],'max_tokens':0x32};_0x2ac259=await fetch(_0x235875+_0x632c1e(0x399),{'method':_0x632c1e(0x90),'headers':{'Content-Type':_0x632c1e(0xd74),'Authorization':_0x632c1e(0xf20)+_0x298d5e},'body':JSON[_0x632c1e(0xd27)](_0x2abfdb)});}if(!_0x2ac259['ok']){const _0x3d78ea=await _0x2ac259[_0x632c1e(0x79e)]();throw new Error('API\x20错误:\x20'+_0x3d78ea['error']['message']);}const _0x534b64=await _0x2ac259[_0x632c1e(0x79e)]();let _0x15b550=_0xe90a71?getGeminiResponseText(_0x534b64):_0x534b64[_0x632c1e(0x326)][0x0]['message'][_0x632c1e(0xcbd)];return _0x15b550[_0x632c1e(0x7da)]()[_0x632c1e(0xc12)](/["'“”‘’]/g,'');}async function _0x29067b(_0x2b7f13){const _0x135a40=_0x247bea;if(!_0x2b7f13||_0x2b7f13[_0x135a40(0x80b)]){console[_0x135a40(0x54a)](_0x135a40(0x2b4));return;}const _0x3fe610=_0x2b7f13['id'],_0x590dbd=_0x2b7f13[_0x135a40(0x578)],_0x1158a6=_0x2b7f13[_0x135a40(0x776)];console['log'](_0x135a40(0x828)+_0x3fe610+'\x20同步所有群聊内的名称信息...');for(const _0xe64e23 in _0x12493e[_0x135a40(0xc45)]){const _0x91f751=_0x12493e[_0x135a40(0xc45)][_0xe64e23];if(_0x91f751[_0x135a40(0x80b)]&&_0x91f751[_0x135a40(0xd5b)]){const _0x1af659=_0x91f751[_0x135a40(0xd5b)][_0x135a40(0xd85)](_0x1e98a9=>_0x1e98a9['id']===_0x3fe610);if(_0x1af659){let _0x591267=![];_0x1af659['groupNickname']!==_0x590dbd&&(_0x1af659['groupNickname']=_0x590dbd,_0x591267=!![]),_0x1af659['originalName']!==_0x1158a6&&(_0x1af659[_0x135a40(0x776)]=_0x1158a6,_0x591267=!![]),_0x591267&&(await _0x2a2987['chats'][_0x135a40(0xf36)](_0x91f751),console['log'](_0x135a40(0x10ab)+_0x91f751['name']+'\x22\x20中的成员信息更新'));}}}}async function _0x4c9fe9(_0x388146){const _0x14d41a=_0x247bea;if(!_0x388146||_0x388146[_0x14d41a(0x80b)]){console[_0x14d41a(0x54a)](_0x14d41a(0xb04));return;}const _0x451992=_0x388146['id'],_0x5d128b=_0x388146[_0x14d41a(0x2ea)][_0x14d41a(0x18e)];console[_0x14d41a(0x51f)](_0x14d41a(0x828)+_0x451992+_0x14d41a(0x9c6));for(const _0x13c679 of Object[_0x14d41a(0xd28)](_0x12493e['chats'])){if(_0x13c679['isGroup']&&_0x13c679[_0x14d41a(0xd5b)]){const _0x17ec18=_0x13c679['members'][_0x14d41a(0xd85)](_0x11bb26=>_0x11bb26['id']===_0x451992);_0x17ec18&&_0x17ec18['avatar']!==_0x5d128b&&(_0x17ec18[_0x14d41a(0xbac)]=_0x5d128b,await _0x2a2987[_0x14d41a(0xc45)][_0x14d41a(0xf36)](_0x13c679),console['log'](_0x14d41a(0x927)+_0x451992+_0x14d41a(0x40a)+_0x13c679[_0x14d41a(0x578)]+'\x22'));}}}function _0x3fb61d(_0x427bab,_0x2ac3a3){const _0x39ab64=_0x247bea;if(!_0x427bab||!_0x427bab[_0x39ab64(0x80b)]||!_0x2ac3a3)return _0x2ac3a3;const _0x33d20b=_0x12493e[_0x39ab64(0x76c)][_0x39ab64(0x66a)]||_0x39ab64(0x10d0);if(_0x2ac3a3===_0x33d20b)return _0x427bab['settings'][_0x39ab64(0xbf6)]||'我';const _0x2ad3fb=_0x427bab[_0x39ab64(0xd5b)][_0x39ab64(0xd85)](_0x23215d=>_0x23215d['originalName']===_0x2ac3a3);return _0x2ad3fb?_0x2ad3fb[_0x39ab64(0x6e2)]:_0x2ac3a3;}function _0x46808e(_0x479ac3){const _0x15bebe=_0x247bea;document[_0x15bebe(0x67a)](_0x15bebe(0x2b8))['forEach'](_0x20b4b1=>{const _0x19bf96=_0x15bebe;_0x20b4b1['classList']['toggle'](_0x19bf96(0x1043),_0x20b4b1['dataset'][_0x19bf96(0x305)]===_0x479ac3);}),document[_0x15bebe(0x67a)](_0x15bebe(0x1276))['forEach'](_0x303488=>{const _0x3e16eb=_0x15bebe;_0x303488[_0x3e16eb(0x10d3)][_0x3e16eb(0xe2c)]('active',_0x303488[_0x3e16eb(0x85)][_0x3e16eb(0x305)]===_0x479ac3);});}function _0x1353b6(_0x1fe07b){const _0x2e96f0=_0x247bea;if(!_0x1fe07b)return'';if(_0x12493e[_0x2e96f0(0x76c)]&&_0x1fe07b===_0x12493e[_0x2e96f0(0x76c)][_0x2e96f0(0x66a)])return _0x12493e[_0x2e96f0(0x76c)]['nickname'];let _0x3e9bc4=Object['values'](_0x12493e[_0x2e96f0(0xc45)])[_0x2e96f0(0xd85)](_0x38eadb=>!_0x38eadb[_0x2e96f0(0x80b)]&&_0x38eadb['originalName']===_0x1fe07b);if(_0x3e9bc4)return _0x3e9bc4[_0x2e96f0(0x578)];_0x3e9bc4=Object['values'](_0x12493e[_0x2e96f0(0xc45)])[_0x2e96f0(0xd85)](_0x176133=>!_0x176133['isGroup']&&(_0x176133[_0x2e96f0(0xa1a)]&&_0x176133['nameHistory'][_0x2e96f0(0x1d4)](_0x1fe07b)));if(_0x3e9bc4)return _0x3e9bc4[_0x2e96f0(0x578)];return _0x1fe07b;}function _0x1eca28(_0x327157,_0x4b460b=null){const _0x376ef9=_0x247bea;if(!_0x327157||typeof _0x327157!=='string'||!_0x327157[_0x376ef9(0x1d4)](_0x376ef9(0xf9e)))return _0x327157;return _0x327157[_0x376ef9(0xc12)](/@\[\[([^\]]+)\]\]/g,(_0x67986e,_0x1e9341)=>{const _0x377705=_0x376ef9,_0x42fb6e=_0x1e9341[_0x377705(0x7da)]();let _0xb1e969;return _0x4b460b&&_0x4b460b[_0x377705(0x80b)]?_0xb1e969=_0x3fb61d(_0x4b460b,_0x42fb6e):_0xb1e969=_0x1353b6(_0x42fb6e),'@'+_0xb1e969;});}function _0x270512(_0x11d4d6,_0x64da22,_0x10c421={}){return new Promise(_0x3140bc=>{const _0x27d58f=_0x26e9;_0x69eae3=_0x3140bc,_0xb1315b[_0x27d58f(0x11b0)]=_0x11d4d6,_0x222e28['innerHTML']=_0x27d58f(0x524)+_0x64da22+_0x27d58f(0xcc9);const _0xe86d0a=document[_0x27d58f(0xc33)](_0x27d58f(0x4c2)),_0x97fd4f=document[_0x27d58f(0xc33)](_0x27d58f(0x25b));_0x97fd4f[_0x27d58f(0x105d)][_0x27d58f(0xf44)]=_0x27d58f(0xa20),_0xe86d0a[_0x27d58f(0x11b0)]=_0x10c421[_0x27d58f(0xf3)]||'确定',_0x97fd4f[_0x27d58f(0x11b0)]=_0x10c421[_0x27d58f(0x8ca)]||'取消',_0x10c421[_0x27d58f(0xcf7)]?_0xe86d0a[_0x27d58f(0x10d3)]['add'](_0x10c421[_0x27d58f(0xcf7)]):_0xe86d0a[_0x27d58f(0x10d3)]['remove'](_0x27d58f(0xa2)),_0xe86d0a['onclick']=()=>{_0x3140bc(!![]),_0x37b8d7();},_0x97fd4f[_0x27d58f(0x8a)]=()=>{_0x3140bc(![]),_0x37b8d7();},_0xe5f5a6();});}function _0x2d7ddd(_0x22dcdb,_0x1df6e6){return new Promise(_0x5ed4ae=>{const _0x5af7e5=_0x26e9;_0x69eae3=_0x5ed4ae,_0xb1315b[_0x5af7e5(0x11b0)]=_0x22dcdb,_0x222e28[_0x5af7e5(0x102a)]=_0x5af7e5(0x498)+_0x1df6e6+_0x5af7e5(0xcc9);const _0x54d0ee=document['getElementById']('custom-modal-confirm'),_0x3adcb0=document[_0x5af7e5(0xc33)](_0x5af7e5(0x25b));_0x3adcb0['style'][_0x5af7e5(0xf44)]=_0x5af7e5(0x854),_0x54d0ee[_0x5af7e5(0x11b0)]='好的',_0x54d0ee[_0x5af7e5(0x8a)]=()=>{const _0x344d7d=_0x5af7e5;_0x3adcb0[_0x344d7d(0x105d)][_0x344d7d(0xf44)]=_0x344d7d(0xa20),_0x54d0ee[_0x344d7d(0x11b0)]='确定',_0x5ed4ae(!![]),_0x37b8d7();},_0xe5f5a6();});}function _0x1ca09c(_0x2126bb,_0x20e744,_0x4854dc='',_0x27f30d=_0x247bea(0x996),_0x4c2a7f=''){return new Promise(_0x25909b=>{const _0x3dd3a6=_0x26e9;_0x69eae3=_0x25909b,_0xb1315b[_0x3dd3a6(0x11b0)]=_0x2126bb;const _0x261be0=_0x3dd3a6(0x878),_0xd49882=_0x27f30d==='textarea'?_0x3dd3a6(0x648)+_0x261be0+_0x3dd3a6(0xc1c)+_0x20e744+'\x22\x20rows=\x224\x22\x20style=\x22width:\x20100%;\x20padding:\x208px;\x20border-radius:\x206px;\x20border:\x201px\x20solid\x20#ccc;\x20font-size:\x2016px;\x20box-sizing:\x20border-box;\x20resize:\x20vertical;\x22>'+_0x4854dc+_0x3dd3a6(0x995):_0x3dd3a6(0xfe8)+_0x27f30d+_0x3dd3a6(0x310)+_0x261be0+_0x3dd3a6(0xc1c)+_0x20e744+_0x3dd3a6(0x361)+_0x4854dc+'\x22>';_0x222e28[_0x3dd3a6(0x102a)]=_0x4c2a7f+_0xd49882;const _0x204469=document[_0x3dd3a6(0xc33)](_0x261be0);_0x222e28['querySelectorAll'](_0x3dd3a6(0x1281))[_0x3dd3a6(0xd6a)](_0x4b8dee=>{const _0x5e4151=_0x3dd3a6;_0x4b8dee['addEventListener'](_0x5e4151(0x335),()=>{const _0x19e03e=_0x5e4151,_0x4c6ded=_0x4b8dee[_0x19e03e(0x85)][_0x19e03e(0x747)];if(_0x4c6ded)try{const _0x2d2cf3=JSON[_0x19e03e(0x6b1)](_0x4c6ded);_0x204469[_0x19e03e(0x22a)]=JSON[_0x19e03e(0xd27)](_0x2d2cf3,null,0x2),_0x204469[_0x19e03e(0xd59)]();}catch(_0x593724){console[_0x19e03e(0x4d9)]('解析格式模板失败:',_0x593724);}});});const _0x3cb352=document[_0x3dd3a6(0xc33)](_0x3dd3a6(0x4c2)),_0x4778e4=document[_0x3dd3a6(0xc33)]('custom-modal-cancel');_0x3cb352[_0x3dd3a6(0x8a)]=()=>{const _0x527d18=_0x3dd3a6;_0x25909b(_0x204469[_0x527d18(0x22a)]),_0x37b8d7();},_0x4778e4['onclick']=()=>{_0x25909b(null),_0x37b8d7();},_0xe5f5a6(),setTimeout(()=>_0x204469['focus'](),0x64);});}function _0x46f58a(_0x548b82,_0x4e7589){const _0x1ece71=_0x247bea;return new Promise(_0x407bba=>{const _0x4be706=_0x26e9,_0x41b026=document[_0x4be706(0xc33)](_0x4be706(0xa70)),_0x2ba8c2=document['getElementById'](_0x4be706(0xe46)),_0x1f4b7d=document[_0x4be706(0xc33)](_0x4be706(0x2a5)),_0x4a97f8=document[_0x4be706(0x977)](_0x4be706(0xe70));_0x2ba8c2[_0x4be706(0x11b0)]=_0x548b82,_0x1f4b7d[_0x4be706(0x102a)]='',_0x4a97f8[_0x4be706(0x102a)]='',_0x4a97f8['style'][_0x4be706(0xdf7)]=_0x4be706(0xe89),_0x4e7589['forEach'](_0x4937cb=>{const _0x69fa16=_0x4be706,_0x142e7e=document[_0x69fa16(0x1292)](_0x69fa16(0xeb1));_0x142e7e['textContent']=_0x4937cb[_0x69fa16(0x996)],_0x142e7e[_0x69fa16(0x8a)]=()=>{const _0x3ecf7d=_0x69fa16;_0x41b026['classList'][_0x3ecf7d(0x2c7)]('visible'),_0x407bba(_0x4937cb[_0x3ecf7d(0x22a)]);},_0x4a97f8[_0x69fa16(0xf77)](_0x142e7e);});const _0x26c920=document[_0x4be706(0x1292)](_0x4be706(0xeb1));_0x26c920[_0x4be706(0x11b0)]='取消',_0x26c920['style'][_0x4be706(0xba7)]='8px',_0x26c920[_0x4be706(0x105d)][_0x4be706(0x123b)]=_0x4be706(0x83a),_0x26c920[_0x4be706(0x105d)][_0x4be706(0x1c5)]='#f0f0f0',_0x26c920[_0x4be706(0x8a)]=()=>{const _0x1da45e=_0x4be706;_0x41b026[_0x1da45e(0x10d3)]['remove']('visible'),_0x407bba(null);},_0x4a97f8[_0x4be706(0xf77)](_0x26c920),_0x41b026[_0x4be706(0x10d3)][_0x4be706(0xb9)](_0x4be706(0x143));})[_0x1ece71(0xdb9)](()=>{const _0x505d09=_0x1ece71,_0x27894e=document[_0x505d09(0x977)](_0x505d09(0xe70));_0x27894e['style']['flexDirection']=_0x505d09(0x1116),_0x27894e[_0x505d09(0x102a)]=_0x505d09(0xfc7),document[_0x505d09(0xc33)](_0x505d09(0x25b))['addEventListener'](_0x505d09(0x335),_0x37b8d7);});}async function _0x2cb3c4(){const _0x29665d=_0x247bea,_0x79efe8=await _0x46f58a('选择歌词导入方式',[{'text':'📁\x20从本地文件\x20(.lrc)','value':_0x29665d(0xfb2)},{'text':'📋\x20直接粘贴歌词文本','value':_0x29665d(0x64d)}]);if(_0x79efe8===_0x29665d(0xfb2))return new Promise(_0x1d37f6=>{const _0x163add=_0x29665d,_0x372fc7=document[_0x163add(0xc33)]('lrc-upload-input'),_0xecd962=_0x10cc91=>{const _0x43d0cb=_0x163add,_0x1c4665=_0x10cc91[_0x43d0cb(0xe16)][_0x43d0cb(0x1d0)][0x0];if(_0x1c4665){const _0x2eaef8=new FileReader();_0x2eaef8[_0x43d0cb(0x833)]=_0x35fe8d=>_0x1d37f6(_0x35fe8d[_0x43d0cb(0xe16)]['result']),_0x2eaef8[_0x43d0cb(0x6e0)]=()=>_0x1d37f6(''),_0x2eaef8[_0x43d0cb(0x643)](_0x1c4665);}else _0x1d37f6(null);_0x372fc7[_0x43d0cb(0xb52)](_0x43d0cb(0x644),_0xecd962),_0x372fc7[_0x43d0cb(0x22a)]='';};_0x372fc7[_0x163add(0x205)](_0x163add(0x644),_0xecd962,{'once':!![]}),_0x372fc7[_0x163add(0x335)]();});else{if(_0x79efe8==='paste'){const _0x176b75=await _0x1ca09c(_0x29665d(0x913),'请在此处粘贴完整的LRC格式歌词...','',_0x29665d(0x89c));if(_0x176b75){const _0x56c765=_0x176b75[_0x29665d(0xc12)](/\[/g,'\x0a[')[_0x29665d(0x7da)]();return _0x56c765;}return _0x176b75;}else return null;}}_0x2a2987[_0x247bea(0xb2d)](0x27)['stores']({'doubanPosts':'++id,\x20timestamp','chats':_0x247bea(0x216),'apiConfig':'&id,\x20minimaxGroupId,\x20minimaxApiKey','globalSettings':_0x247bea(0xdf4),'userStickers':'&id,\x20url,\x20name,\x20categoryId','worldBooks':'&id,\x20name,\x20categoryId','worldBookCategories':'++id,\x20name','musicLibrary':_0x247bea(0xdf4),'personaPresets':'&id','qzoneSettings':'&id','qzonePosts':'++id,\x20timestamp,\x20authorId','qzoneAlbums':'++id,\x20name,\x20createdAt','qzonePhotos':_0x247bea(0x1014),'favorites':_0x247bea(0xd1e),'qzoneGroups':_0x247bea(0x349),'memories':_0x247bea(0xe80),'callRecords':'++id,\x20chatId,\x20timestamp,\x20customName','shoppingProducts':_0x247bea(0x3bb),'shoppingCategories':'++id,\x20name','apiPresets':_0x247bea(0x349),'renderingRules':_0x247bea(0x6a7),'appearancePresets':'++id,\x20name,\x20type','stickerCategories':_0x247bea(0x349),'customAvatarFrames':_0x247bea(0x349),'presets':_0x247bea(0x888),'presetCategories':_0x247bea(0x349),'readingLibrary':_0x247bea(0x558),'npcs':'++id,\x20name,\x20enableBackgroundActivity,\x20actionCooldownMinutes,\x20lastActionTimestamp'})[_0x247bea(0xfff)](_0xb01c9=>{const _0x268c58=_0x247bea;return _0xb01c9[_0x268c58(0xf3e)]('worldBooks')['toCollection']()[_0x268c58(0x423)](_0x551def=>{const _0x3a6cbb=_0x268c58;if(typeof _0x551def[_0x3a6cbb(0xcbd)]===_0x3a6cbb(0x9de)&&_0x551def[_0x3a6cbb(0xcbd)][_0x3a6cbb(0x7da)]()!=='')_0x551def[_0x3a6cbb(0xcbd)]=[{'keys':[],'comment':_0x3a6cbb(0xa9c),'content':_0x551def[_0x3a6cbb(0xcbd)]}];else!Array[_0x3a6cbb(0x621)](_0x551def[_0x3a6cbb(0xcbd)])&&(_0x551def[_0x3a6cbb(0xcbd)]=[]);_0x551def[_0x3a6cbb(0xcbd)][_0x3a6cbb(0xd6a)](_0x415d7c=>{const _0x92ae33=_0x3a6cbb;typeof _0x415d7c['enabled']==='undefined'&&(_0x415d7c[_0x92ae33(0x95a)]=!![]);});});}),window['db']=_0x2a2987;function _0x38f00f(_0x5237a0){const _0x273e93=_0x247bea;_0x5237a0===_0x273e93(0xe8f)&&(window[_0x273e93(0xa29)](),_0x598e0c('messages-view'));if(_0x5237a0==='api-settings-screen')window[_0x273e93(0x7c7)]();if(_0x5237a0===_0x273e93(0xc29))window[_0x273e93(0x1256)]();if(_0x5237a0==='world-book-screen')window[_0x273e93(0xac0)]();if(_0x5237a0===_0x273e93(0xe2a))window['renderXSocialScreenProxy']();if(_0x5237a0===_0x273e93(0x21d))_0xf7f64d();document['querySelectorAll'](_0x273e93(0x3f7))[_0x273e93(0xd6a)](_0xdc7f96=>_0xdc7f96['classList']['remove'](_0x273e93(0x1043)));const _0x52c1ef=document[_0x273e93(0xc33)](_0x5237a0);if(_0x52c1ef)_0x52c1ef[_0x273e93(0x10d3)]['add'](_0x273e93(0x1043));if(_0x5237a0==='chat-interface-screen')window[_0x273e93(0xe62)](_0x12493e[_0x273e93(0x7bc)]);_0x5237a0===_0x273e93(0x875)&&(_0x149dea(),document[_0x273e93(0xc33)](_0x273e93(0xf1c))[_0x273e93(0x22a)]=_0x12493e['globalSettings'][_0x273e93(0x10cc)]||'',_0x2e1ac4(_0x12493e[_0x273e93(0x10f6)][_0x273e93(0x10cc)]||'',!![]));}window[_0x247bea(0xe62)]=()=>{};function _0x598e0c(_0x158dab){const _0x301eca=_0x247bea,_0x50e26c=document[_0x301eca(0xc33)](_0x301eca(0xe8f)),_0x4bf2c0={'messages-view':document[_0x301eca(0xc33)](_0x301eca(0x2fa)),'qzone-screen':document[_0x301eca(0xc33)](_0x301eca(0x496)),'favorites-view':document[_0x301eca(0xc33)](_0x301eca(0x5b1)),'memories-view':document[_0x301eca(0xc33)](_0x301eca(0x3a2)),'npc-list-view':document[_0x301eca(0xc33)](_0x301eca(0xc92))},_0xbac308=document[_0x301eca(0xc33)]('main-chat-list-header'),_0x3079b2=document[_0x301eca(0xc33)](_0x301eca(0x8d0));_0x464ccd&&document[_0x301eca(0xc33)]('favorites-edit-btn')[_0x301eca(0x335)]();Object[_0x301eca(0xd28)](_0x4bf2c0)[_0x301eca(0xd6a)](_0x25181f=>_0x25181f[_0x301eca(0x10d3)][_0x301eca(0x2c7)](_0x301eca(0x1043)));_0x4bf2c0[_0x158dab]&&_0x4bf2c0[_0x158dab][_0x301eca(0x10d3)][_0x301eca(0xb9)](_0x301eca(0x1043));document[_0x301eca(0x67a)](_0x301eca(0xafc))[_0x301eca(0xd6a)](_0x1edbf3=>{const _0x3ec2bf=_0x301eca;_0x1edbf3[_0x3ec2bf(0x10d3)]['toggle'](_0x3ec2bf(0x1043),_0x1edbf3[_0x3ec2bf(0x85)][_0x3ec2bf(0x997)]===_0x158dab);});_0x158dab===_0x301eca(0x2fa)?(_0xbac308[_0x301eca(0x105d)][_0x301eca(0xf44)]='flex',_0x3079b2[_0x301eca(0x105d)]['display']=_0x301eca(0x21a)):(_0xbac308['style'][_0x301eca(0xf44)]=_0x301eca(0x854),_0x3079b2[_0x301eca(0x105d)][_0x301eca(0xf44)]=_0x301eca(0x854));_0x158dab!=='memories-view'&&(_0x5b3d01[_0x301eca(0xd6a)](_0x1ca896=>clearInterval(_0x1ca896)),_0x5b3d01=[]);switch(_0x158dab){case'qzone-screen':_0x4bf2c0[_0x301eca(0x496)][_0x301eca(0x105d)]['backgroundColor']='#f0f2f5',_0x3d400b(0x0),_0x8001ea(),_0x14f3b0();break;case _0x301eca(0x5b1):_0x4bf2c0['favorites-view'][_0x301eca(0x105d)]['backgroundColor']='#f9f9f9',_0x32f042();break;case _0x301eca(0x2fa):break;case _0x301eca(0xc92):_0xd1839b();break;}}function _0x3bfe60(){console['log']('渲染X社交页面');}window[_0x247bea(0x1061)]=_0x3bfe60;function _0x8001ea(){const _0x370f05=_0x247bea;if(_0x12493e&&_0x12493e['qzoneSettings']){const _0x565180=_0x12493e[_0x370f05(0x76c)];document['getElementById'](_0x370f05(0xd22))[_0x370f05(0x11b0)]=_0x565180[_0x370f05(0x66a)],document['getElementById'](_0x370f05(0x8e8))[_0x370f05(0x87b)]=_0x565180['avatar'],document[_0x370f05(0xc33)](_0x370f05(0xeb6))[_0x370f05(0x87b)]=_0x565180[_0x370f05(0x78f)];}}window[_0x247bea(0x703)]=_0x8001ea;async function _0x2969d2(){const _0xeb5cd3=_0x247bea;_0x2a2987&&_0x12493e[_0xeb5cd3(0x76c)]&&await _0x2a2987['qzoneSettings'][_0xeb5cd3(0xf36)](_0x12493e[_0xeb5cd3(0x76c)]);}function _0x578104(_0x5849c0){const _0x45cbb=_0x247bea;if(!_0x5849c0)return'';const _0x1f4256=new Date(),_0x86e3d5=new Date(_0x5849c0),_0x2610dc=Math[_0x45cbb(0xcb5)]((_0x1f4256-_0x86e3d5)/0x3e8),_0x2dcbe3=Math['floor'](_0x2610dc/0x3c),_0x414c3d=Math['floor'](_0x2dcbe3/0x3c);if(_0x2dcbe3<0x1)return'刚刚';if(_0x2dcbe3<0x3c)return _0x2dcbe3+_0x45cbb(0x59f);if(_0x414c3d<0x18)return _0x414c3d+_0x45cbb(0xf3a);const _0x3fa934=_0x86e3d5['getFullYear'](),_0x4418e9=String(_0x86e3d5[_0x45cbb(0xf99)]()+0x1)[_0x45cbb(0x70d)](0x2,'0'),_0x3c6ed6=String(_0x86e3d5[_0x45cbb(0x6be)]())[_0x45cbb(0x70d)](0x2,'0'),_0x184f80=String(_0x86e3d5[_0x45cbb(0xa75)]())[_0x45cbb(0x70d)](0x2,'0'),_0x43e1e2=String(_0x86e3d5['getMinutes']())[_0x45cbb(0x70d)](0x2,'0');return _0x1f4256[_0x45cbb(0x80d)]()===_0x3fa934?_0x4418e9+'-'+_0x3c6ed6+'\x20'+_0x184f80+':'+_0x43e1e2:_0x3fa934+'-'+_0x4418e9+'-'+_0x3c6ed6+'\x20'+_0x184f80+':'+_0x43e1e2;}function _0x520ab5(_0xe3928c){const _0x3464bd=_0x247bea,_0x3bd8b0=document[_0x3464bd(0x977)](_0x3464bd(0x41b)+_0xe3928c['id']+'\x22]'),_0x1f5c38=!!_0x3bd8b0,_0x445c36=_0x1f5c38?_0x3bd8b0:document[_0x3464bd(0x1292)]('div');!_0x1f5c38&&(_0x445c36[_0x3464bd(0x84)]='qzone-post-container',_0x445c36[_0x3464bd(0x85)][_0x3464bd(0x337)]=_0xe3928c['id']);const _0x1a10f9=_0x1f5c38?_0x445c36[_0x3464bd(0x977)]('.qzone-post-item'):document[_0x3464bd(0x1292)](_0x3464bd(0x58c));!_0x1f5c38&&(_0x1a10f9[_0x3464bd(0x84)]=_0x3464bd(0x2b7));let _0x54da47='',_0xa95acc='',_0xcc06dc=_0x12493e[_0x3464bd(0x76c)][_0x3464bd(0xbac)];if(_0xe3928c['authorId']===_0x3464bd(0x717))_0x54da47=_0x12493e['qzoneSettings']['avatar'],_0xa95acc=_0x12493e[_0x3464bd(0x76c)][_0x3464bd(0x66a)];else{if(_0x12493e[_0x3464bd(0xc45)][_0xe3928c['authorId']]){const _0x1ebeb9=_0x12493e[_0x3464bd(0xc45)][_0xe3928c[_0x3464bd(0xd48)]];_0x54da47=_0x1ebeb9[_0x3464bd(0x2ea)][_0x3464bd(0x18e)]||_0x190acc,_0xa95acc=_0x1ebeb9[_0x3464bd(0x578)];}else _0xa95acc=_0x1353b6(_0xe3928c[_0x3464bd(0x11af)]),_0x54da47=_0x190acc;}function _0x418d4c(_0x28c684){const _0x374e41=_0x3464bd;let _0x16f49d='';const _0x423a49=_0x28c684[_0x374e41(0x964)]?_0x374e41(0x8d)+_0x45d05d(_0x28c684['publicText'])[_0x374e41(0xc12)](/\n/g,'<br>')+_0x374e41(0xb45):'';if(_0x28c684[_0x374e41(0x52a)]===_0x374e41(0x5c4))_0x16f49d=_0x374e41(0x7e5)+_0x45d05d(_0x28c684[_0x374e41(0xcbd)])[_0x374e41(0xc12)](/\n/g,_0x374e41(0xfd5))+_0x374e41(0xb45);else{if(_0x28c684[_0x374e41(0x52a)]===_0x374e41(0x6ed)&&_0x28c684[_0x374e41(0x891)])_0x16f49d=_0x423a49?_0x423a49+_0x374e41(0x3a1)+_0x28c684['imageUrl']+_0x374e41(0x4e5):_0x374e41(0xb19)+_0x28c684[_0x374e41(0x891)]+_0x374e41(0x835);else{if(_0x28c684['type']===_0x374e41(0x1bb)){const _0x4cc80c=_0x12493e['globalSettings']['enableAiDrawing']&&_0x28c684[_0x374e41(0xe3d)]?'https://image.pollinations.ai/prompt/'+_0x28c684[_0x374e41(0xe3d)]:_0x374e41(0x4c7);_0x16f49d=_0x423a49?_0x423a49+_0x374e41(0x3a1)+_0x4cc80c+_0x374e41(0xfa0)+_0x28c684[_0x374e41(0xc2e)]+'\x22></div>':_0x374e41(0xb19)+_0x4cc80c+_0x374e41(0xfa0)+_0x28c684[_0x374e41(0xc2e)]+'\x22>';}else{if(_0x28c684[_0x374e41(0x52a)]===_0x374e41(0xcd5)){const _0x3473e1=_0x28c684[_0x374e41(0xc98)]||(_0x28c684[_0x374e41(0x891)]?[_0x28c684[_0x374e41(0x891)]]:[]);if(_0x3473e1[_0x374e41(0x79b)]>0x0){const _0x16a468=_0x3473e1[_0x374e41(0x79b)];let _0x22ba2b='';_0x22ba2b=_0x374e41(0xcb8)+_0x16a468+'\x22>',_0x3473e1[_0x374e41(0xd6a)]((_0x2323a7,_0x37dbef)=>{const _0x45ccef=_0x374e41;_0x22ba2b+='<img\x20src=\x22'+_0x2323a7+_0x45ccef(0x15d)+(_0x37dbef+0x1)+_0x45ccef(0xe2b);}),_0x22ba2b+=_0x374e41(0xb45),_0x16f49d=_0x423a49?''+_0x423a49+_0x22ba2b:_0x22ba2b;}}}}}return _0x16f49d;}let _0x3086e6;if(_0xe3928c[_0x3464bd(0x52a)]===_0x3464bd(0x106f)){const _0x15b28b=_0xe3928c[_0x3464bd(0x356)]?'<div\x20class=\x22post-content\x22>'+_0x45d05d(_0xe3928c['repostComment'])[_0x3464bd(0xc12)](/\n/g,_0x3464bd(0xfd5))+'</div>':'';let _0x31e45c=_0x190acc,_0x4c583d=_0x3464bd(0x400);if(_0xe3928c[_0x3464bd(0x1273)]['authorId']===_0x3464bd(0x717))_0x31e45c=_0x12493e[_0x3464bd(0x76c)][_0x3464bd(0xbac)],_0x4c583d=_0x12493e[_0x3464bd(0x76c)][_0x3464bd(0x66a)];else{const _0x557180=_0x12493e[_0x3464bd(0xc45)][_0xe3928c[_0x3464bd(0x1273)][_0x3464bd(0xd48)]];_0x557180&&(_0x31e45c=_0x557180[_0x3464bd(0x2ea)]['aiAvatar']||_0x190acc),_0x4c583d=_0x1353b6(_0xe3928c['originalPost'][_0x3464bd(0x11af)]);}_0x3086e6='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x15b28b+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22reposted-content-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x31e45c+_0x3464bd(0xcb)+_0x4c583d+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-timestamp\x22>'+_0x578104(_0xe3928c['originalPost'][_0x3464bd(0x2f0)])+_0x3464bd(0x2ac)+_0x418d4c(_0xe3928c[_0x3464bd(0x1273)])+_0x3464bd(0x91b);}else _0x3086e6=_0x3464bd(0x1158)+_0x418d4c(_0xe3928c)+_0x3464bd(0xb45);let _0xcb5d02='';if(_0xe3928c[_0x3464bd(0x615)]&&_0xe3928c[_0x3464bd(0x615)]['length']>0x0){const _0x46878c=_0xe3928c[_0x3464bd(0x615)]['map'](_0x16ed67=>_0x1353b6(_0x16ed67))[_0x3464bd(0x100b)]('、');_0xcb5d02='<div\x20class=\x22post-likes-section\x22><svg\x20class=\x22like-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg><span>'+_0x46878c+_0x3464bd(0xc78);}let _0x3b4052='';_0xe3928c[_0x3464bd(0xc83)]&&_0xe3928c['comments'][_0x3464bd(0x79b)]>0x0&&(_0x3b4052=_0x3464bd(0x5b5),_0xe3928c['comments'][_0x3464bd(0xd6a)]((_0x7ff8bf,_0x30567b)=>{const _0x366887=_0x3464bd;if(typeof _0x7ff8bf===_0x366887(0xe37)&&_0x7ff8bf!==null&&_0x7ff8bf[_0x366887(0xfd9)]){const _0x3e94c6=_0x7ff8bf[_0x366887(0xfd9)],_0x28f31b=_0x1353b6(_0x3e94c6);let _0x1eb977;_0x301121['test'](_0x7ff8bf[_0x366887(0x996)])?_0x1eb977=_0x366887(0xb19)+_0x7ff8bf[_0x366887(0x996)]+_0x366887(0x998):_0x1eb977=_0x45d05d(_0x7ff8bf[_0x366887(0x996)]);let _0x273b53='';if(_0x7ff8bf[_0x366887(0x108)]){const _0x1ab5ca=_0x1353b6(_0x7ff8bf['replyTo']);_0x273b53=_0x366887(0xb22)+_0x28f31b+'</span>\x20回复\x20<span\x20class=\x22commenter-name\x22>'+_0x1ab5ca+_0x366887(0x2a7)+_0x1eb977;}else _0x273b53=_0x366887(0xb22)+_0x28f31b+'</span>:\x20'+_0x1eb977;_0x3b4052+=_0x366887(0x8f0)+_0xe3928c['id']+_0x366887(0xc35)+_0x3e94c6+_0x366887(0x12b1)+_0x28f31b+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-text\x22>'+_0x273b53+_0x366887(0x5fd)+_0x30567b+_0x366887(0x478);}else _0x3b4052+='<div\x20class=\x22legacy-comment-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-text\x22>'+_0x45d05d(String(_0x7ff8bf))+_0x366887(0x5ae);}),_0x3b4052+=_0x3464bd(0xb45));const _0x3883e0=_0x12493e['qzoneSettings']['nickname'],_0x263cd1=_0xe3928c['likes']&&_0xe3928c['likes'][_0x3464bd(0x1d4)](_0x3883e0),_0x534ae8=_0x12493e['favoritedPostIds']&&_0x12493e[_0x3464bd(0x1030)][_0x3464bd(0xa7)](_0xe3928c['id']);let _0x38ffe8='';_0xe3928c[_0x3464bd(0x52a)]!==_0x3464bd(0x106f)&&(_0x38ffe8=_0x3464bd(0xe54));_0x1a10f9[_0x3464bd(0x102a)]=_0x3464bd(0xd4f)+_0x54da47+'\x22\x20class=\x22post-avatar\x22\x20data-author-id=\x22'+_0xe3928c[_0x3464bd(0xd48)]+_0x3464bd(0xd05)+_0xa95acc+_0x3464bd(0xded)+_0x578104(_0xe3928c[_0x3464bd(0x2f0)])+_0x3464bd(0x233)+_0x3086e6+_0x3464bd(0x77d)+_0x38ffe8+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20like\x20'+(_0x263cd1?_0x3464bd(0x1043):'')+_0x3464bd(0x1008)+(_0x534ae8?'active':'')+_0x3464bd(0xd26)+_0xcb5d02+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x3b4052+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-section\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0xcc06dc+_0x3464bd(0x84b);if(!_0x1f5c38){const _0x440a6b=document['createElement'](_0x3464bd(0x58c));_0x440a6b[_0x3464bd(0x84)]='qzone-post-delete-action',_0x440a6b['innerHTML']=_0x3464bd(0x260),_0x445c36['appendChild'](_0x1a10f9),_0x445c36[_0x3464bd(0xf77)](_0x440a6b);}return _0x445c36;}async function _0x1994cd(_0x4a8617){const _0x120558=_0x247bea,_0x5acc65=await _0x2a2987[_0x120558(0x110b)][_0x120558(0xec0)](_0x4a8617);if(!_0x5acc65){const _0x394d6c=document['querySelector'](_0x120558(0x41b)+_0x4a8617+'\x22]');if(_0x394d6c)_0x394d6c['remove']();return;}const _0x474db4=_0x2c7a9f[_0x120558(0xce9)](_0x582c4f=>_0x582c4f['id']===_0x4a8617);if(_0x474db4>-0x1)_0x2c7a9f[_0x474db4]=_0x5acc65;const _0x131ba1=await _0x2a2987[_0x120558(0xe69)][_0x120558(0x8b5)]('type')[_0x120558(0x10bd)]('qzone_post')[_0x120558(0xf15)]();_0x12493e['favoritedPostIds']=new Set(_0x131ba1[_0x120558(0x9d5)](_0x234483=>_0x234483['content']['id'])),_0x520ab5(_0x5acc65);}function _0x3ce8f0(_0x467cbc){const _0x151c2c=_0x247bea,_0x3a2a43=Date[_0x151c2c(0x6ee)](),_0x149b1b=Math[_0x151c2c(0xcb5)]((_0x3a2a43-_0x467cbc)/0x3e8),_0x1316de=Math[_0x151c2c(0xcb5)](_0x149b1b/0x3c);if(_0x1316de<0x2)return'刚刚';if(_0x1316de<0x3c)return _0x1316de+_0x151c2c(0x59f);const _0x54cf08=Math[_0x151c2c(0xcb5)](_0x1316de/0x3c);if(_0x54cf08<0x18)return _0x54cf08+_0x151c2c(0xf3a);const _0x34648b=Math[_0x151c2c(0xcb5)](_0x54cf08/0x18);return _0x34648b+'天前';}async function _0x520ab5(_0x590a45){const _0x1774ac=_0x247bea,_0x199249=document['querySelector'](_0x1774ac(0x41b)+_0x590a45['id']+'\x22]'),_0x156186=!!_0x199249,_0x44fc8b=_0x156186?_0x199249:document['createElement']('div');!_0x156186&&(_0x44fc8b[_0x1774ac(0x84)]='qzone-post-container',_0x44fc8b[_0x1774ac(0x85)][_0x1774ac(0x337)]=_0x590a45['id']);const _0x254e28=_0x156186?_0x44fc8b[_0x1774ac(0x977)](_0x1774ac(0x1038)):document[_0x1774ac(0x1292)](_0x1774ac(0x58c));!_0x156186&&(_0x254e28['className']=_0x1774ac(0x2b7));let _0x1c2371='',_0x18210c='',_0x29d34e=_0x12493e['qzoneSettings']['avatar'];if(_0x590a45['authorId']==='user')_0x1c2371=_0x12493e['qzoneSettings']['avatar'],_0x18210c=_0x12493e[_0x1774ac(0x76c)][_0x1774ac(0x66a)];else{if(_0x12493e[_0x1774ac(0xc45)][_0x590a45[_0x1774ac(0xd48)]]){const _0xe546=_0x12493e[_0x1774ac(0xc45)][_0x590a45[_0x1774ac(0xd48)]];_0x1c2371=_0xe546[_0x1774ac(0x2ea)][_0x1774ac(0x18e)]||_0x190acc,_0x18210c=_0xe546[_0x1774ac(0x578)];}else{if(String(_0x590a45[_0x1774ac(0xd48)])[_0x1774ac(0xece)]('npc_')){const _0x2df0f0=parseInt(String(_0x590a45[_0x1774ac(0xd48)])[_0x1774ac(0xc12)]('npc_',''));if(!isNaN(_0x2df0f0)){const _0x247a25=await _0x2a2987[_0x1774ac(0xc61)]['get'](_0x2df0f0);_0x247a25?(_0x1c2371=_0x247a25[_0x1774ac(0xbac)]||_0x5b9dd3,_0x18210c=_0x247a25[_0x1774ac(0x578)]):(_0x18210c=_0x590a45['authorOriginalName']||'未知NPC',_0x1c2371=_0x5b9dd3);}}else _0x18210c=_0x1353b6(_0x590a45[_0x1774ac(0x11af)]),_0x1c2371=_0x190acc;}}function _0xe6eb5e(_0x2aef76){const _0x50e109=_0x1774ac;let _0x59d6e3='';const _0x39f4fd=_0x2aef76[_0x50e109(0x964)]?_0x50e109(0x8d)+_0x45d05d(_0x2aef76['publicText'])[_0x50e109(0xc12)](/\n/g,_0x50e109(0xfd5))+_0x50e109(0xb45):'';if(_0x2aef76[_0x50e109(0x52a)]===_0x50e109(0x5c4))_0x59d6e3=_0x50e109(0x7e5)+_0x45d05d(_0x2aef76[_0x50e109(0xcbd)])[_0x50e109(0xc12)](/\n/g,_0x50e109(0xfd5))+_0x50e109(0xb45);else{if(_0x2aef76[_0x50e109(0x52a)]===_0x50e109(0x6ed)&&_0x2aef76[_0x50e109(0x891)])_0x59d6e3=_0x39f4fd?_0x39f4fd+_0x50e109(0x3a1)+_0x2aef76['imageUrl']+_0x50e109(0x4e5):'<img\x20src=\x22'+_0x2aef76['imageUrl']+_0x50e109(0x835);else{if(_0x2aef76[_0x50e109(0x52a)]==='text_image'){const _0x4bb6c2=_0x12493e[_0x50e109(0x10f6)][_0x50e109(0xd2f)]&&_0x2aef76['image_prompt']?_0x50e109(0xda8)+_0x2aef76['image_prompt']:_0x50e109(0x4c7);_0x59d6e3=_0x39f4fd?_0x39f4fd+_0x50e109(0x3a1)+_0x4bb6c2+_0x50e109(0xfa0)+_0x2aef76[_0x50e109(0xc2e)]+_0x50e109(0xf16):_0x50e109(0xb19)+_0x4bb6c2+'\x22\x20class=\x22chat-image\x22\x20style=\x22cursor:\x20pointer;\x22\x20data-hidden-text=\x22'+_0x2aef76[_0x50e109(0xc2e)]+'\x22>';}else{if(_0x2aef76['type']===_0x50e109(0xcd5)){const _0x49d9ab=_0x2aef76[_0x50e109(0xc98)]||(_0x2aef76[_0x50e109(0x891)]?[_0x2aef76[_0x50e109(0x891)]]:[]);if(_0x49d9ab[_0x50e109(0x79b)]>0x0){const _0x6e3d5a=_0x49d9ab['length'];let _0x37a49b='';_0x37a49b=_0x50e109(0xcb8)+_0x6e3d5a+'\x22>',_0x49d9ab[_0x50e109(0xd6a)]((_0x25b972,_0x258d50)=>{const _0x10a20b=_0x50e109;_0x37a49b+='<img\x20src=\x22'+_0x25b972+_0x10a20b(0x15d)+(_0x258d50+0x1)+_0x10a20b(0xe2b);}),_0x37a49b+=_0x50e109(0xb45),_0x59d6e3=_0x39f4fd?''+_0x39f4fd+_0x37a49b:_0x37a49b;}}}}}return _0x59d6e3;}let _0x42a6da;if(_0x590a45[_0x1774ac(0x52a)]==='repost'){const _0x78ee5=_0x590a45[_0x1774ac(0x356)]?_0x1774ac(0x8d)+_0x590a45[_0x1774ac(0x356)][_0x1774ac(0xc12)](/\n/g,_0x1774ac(0xfd5))+_0x1774ac(0xb45):'';let _0xacb87=_0x190acc,_0x390666='原作者';if(_0x590a45['originalPost']['authorId']===_0x1774ac(0x717))_0xacb87=_0x12493e[_0x1774ac(0x76c)][_0x1774ac(0xbac)],_0x390666=_0x12493e[_0x1774ac(0x76c)][_0x1774ac(0x66a)];else{const _0x1f5867=_0x12493e[_0x1774ac(0xc45)][_0x590a45[_0x1774ac(0x1273)][_0x1774ac(0xd48)]];_0x1f5867&&(_0xacb87=_0x1f5867['settings'][_0x1774ac(0x18e)]||_0x190acc),_0x390666=_0x1353b6(_0x590a45[_0x1774ac(0x1273)]['authorOriginalName']);}_0x42a6da=_0x1774ac(0x7dc)+_0x78ee5+_0x1774ac(0x59a)+_0xacb87+'\x22\x20class=\x22post-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-nickname\x22>@'+_0x390666+_0x1774ac(0xf5b)+_0x578104(_0x590a45['originalPost'][_0x1774ac(0x2f0)])+_0x1774ac(0x2ac)+_0xe6eb5e(_0x590a45[_0x1774ac(0x1273)])+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';}else _0x42a6da=_0x1774ac(0x1158)+_0xe6eb5e(_0x590a45)+_0x1774ac(0xb45);let _0x4779fa='';if(_0x590a45['likes']&&_0x590a45[_0x1774ac(0x615)]['length']>0x0){const _0x2fa805=_0x590a45['likes'][_0x1774ac(0x9d5)](_0x436419=>_0x1353b6(_0x436419))[_0x1774ac(0x100b)]('、');_0x4779fa='<div\x20class=\x22post-likes-section\x22><svg\x20class=\x22like-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg><span>'+_0x2fa805+_0x1774ac(0xc78);}let _0x52cbf3='';_0x590a45[_0x1774ac(0xc83)]&&_0x590a45['comments'][_0x1774ac(0x79b)]>0x0&&(_0x52cbf3=_0x1774ac(0x5b5),_0x590a45[_0x1774ac(0xc83)][_0x1774ac(0xd6a)]((_0x3fad38,_0x89e182)=>{const _0x737a12=_0x1774ac;if(typeof _0x3fad38===_0x737a12(0xe37)&&_0x3fad38!==null&&_0x3fad38['commenterName']){const _0x448ed6=_0x3fad38['commenterName'],_0x360a94=_0x1353b6(_0x448ed6);let _0x5efab0;_0x301121[_0x737a12(0x677)](_0x3fad38[_0x737a12(0x996)])?_0x5efab0=_0x737a12(0xb19)+_0x3fad38[_0x737a12(0x996)]+'\x22\x20class=\x22comment-sticker\x22\x20alt=\x22sticker\x22>':_0x5efab0=_0x45d05d(_0x3fad38[_0x737a12(0x996)]);let _0xd88b3f='';if(_0x3fad38['replyTo']){const _0x52dc8c=_0x1353b6(_0x3fad38[_0x737a12(0x108)]);_0xd88b3f=_0x737a12(0xb22)+_0x360a94+_0x737a12(0x62e)+_0x52dc8c+'</span>:\x20'+_0x5efab0;}else _0xd88b3f=_0x737a12(0xb22)+_0x360a94+'</span>:\x20'+_0x5efab0;_0x52cbf3+=_0x737a12(0x8f0)+_0x590a45['id']+'\x22\x20data-commenter-original-name=\x22'+_0x448ed6+_0x737a12(0x12b1)+_0x360a94+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-text\x22>'+_0xd88b3f+_0x737a12(0x5fd)+_0x89e182+_0x737a12(0x478);}else _0x52cbf3+=_0x737a12(0x847)+String(_0x3fad38)+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';}),_0x52cbf3+=_0x1774ac(0xb45));const _0x2ab857=_0x12493e[_0x1774ac(0x76c)][_0x1774ac(0x66a)],_0x32a3b8=_0x590a45['likes']&&_0x590a45['likes'][_0x1774ac(0x1d4)](_0x2ab857),_0x3a7434=_0x12493e['favoritedPostIds']&&_0x12493e[_0x1774ac(0x1030)][_0x1774ac(0xa7)](_0x590a45['id']);let _0x2098ba='';_0x590a45[_0x1774ac(0x52a)]!==_0x1774ac(0x106f)&&(_0x2098ba='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20repost\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M17\x202.1l4\x204-4\x204\x20M3\x2011.5v-3a4\x204\x200\x200\x201\x204-4h13\x20M7\x2021.9l-4-4\x204-4\x20M21\x2012.5v3a4\x204\x200\x200\x201-4\x204H4\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>');_0x254e28['innerHTML']=_0x1774ac(0xd4f)+_0x1c2371+'\x22\x20class=\x22post-avatar\x22\x20data-author-id=\x22'+_0x590a45[_0x1774ac(0xd48)]+_0x1774ac(0xd05)+_0x18210c+_0x1774ac(0xded)+_0x578104(_0x590a45['timestamp'])+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-actions-btn\x22>…</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x42a6da+_0x1774ac(0x77d)+_0x2098ba+_0x1774ac(0x1146)+(_0x32a3b8?_0x1774ac(0x1043):'')+'\x22><svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20favorite\x20'+(_0x3a7434?_0x1774ac(0x1043):'')+_0x1774ac(0xd26)+_0x4779fa+_0x1774ac(0x188)+_0x52cbf3+_0x1774ac(0x9fd)+_0x29d34e+'\x22\x20class=\x22comment-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22comment-input\x22\x20placeholder=\x22友善的评论是交流的起点\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22comment-sticker-btn\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x2210\x22></circle>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M8\x2014\x20Q\x2012\x2016\x2016\x2014\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x229\x22\x20y1=\x229\x22\x20x2=\x229.01\x22\x20y2=\x229\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x2215\x22\x20y1=\x229\x22\x20x2=\x2215.01\x22\x20y2=\x229\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22at-mention-popup\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22comment-send-btn\x22>发送</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';if(!_0x156186){const _0x32b231=document[_0x1774ac(0x1292)](_0x1774ac(0x58c));_0x32b231[_0x1774ac(0x84)]=_0x1774ac(0x4d2),_0x32b231['innerHTML']=_0x1774ac(0x260),_0x44fc8b[_0x1774ac(0xf77)](_0x254e28),_0x44fc8b[_0x1774ac(0xf77)](_0x32b231);}return _0x44fc8b;}async function _0x1994cd(_0x31e513){const _0x1fc13c=_0x247bea,_0x14b960=await _0x2a2987['qzonePosts'][_0x1fc13c(0xec0)](_0x31e513);if(!_0x14b960){const _0x58bec5=document[_0x1fc13c(0x977)]('.qzone-post-container[data-post-id=\x22'+_0x31e513+'\x22]');_0x58bec5&&_0x58bec5[_0x1fc13c(0x2c7)]();return;}const _0x2cb333=_0x2c7a9f[_0x1fc13c(0xce9)](_0x1fa0df=>_0x1fa0df['id']===_0x31e513);_0x2cb333>-0x1&&(_0x2c7a9f[_0x2cb333]=_0x14b960);const _0x40888a=await _0x2a2987[_0x1fc13c(0xe69)][_0x1fc13c(0x8b5)](_0x1fc13c(0x52a))['equals']('qzone_post')['toArray']();_0x12493e['favoritedPostIds']=new Set(_0x40888a[_0x1fc13c(0x9d5)](_0x5be86c=>_0x5be86c[_0x1fc13c(0xcbd)]['id'])),await _0x520ab5(_0x14b960);}async function _0x14f3b0(){const _0x596787=_0x247bea,_0x56aa1e=document[_0x596787(0xc33)]('qzone-posts-list');if(!_0x56aa1e)return;const [_0x51d81c,_0x5b36ed]=await Promise[_0x596787(0x5c8)]([_0x2a2987[_0x596787(0x110b)][_0x596787(0xde3)]('timestamp')[_0x596787(0xc07)]()['filter'](_0x57c217=>!_0x57c217[_0x596787(0x10dd)])[_0x596787(0xf15)](),_0x2a2987[_0x596787(0xe69)][_0x596787(0x8b5)]('type')[_0x596787(0x10bd)](_0x596787(0x4a1))[_0x596787(0xf15)]()]);_0x2c7a9f=_0x51d81c,_0x12493e[_0x596787(0x1030)]=new Set(_0x5b36ed[_0x596787(0x9d5)](_0xb75781=>_0xb75781[_0x596787(0xcbd)]['id'])),_0x56aa1e[_0x596787(0x102a)]='',_0x291a6f=0x0;if(_0x2c7a9f['length']===0x0){_0x56aa1e[_0x596787(0x102a)]=_0x596787(0x123);return;}_0x334be8();}async function _0x334be8(){const _0x137c65=_0x247bea;if(_0x29dd6c)return;_0x29dd6c=!![];const _0x59cef0=document[_0x137c65(0xc33)](_0x137c65(0xd13));if(!_0x59cef0){_0x29dd6c=![];return;}_0x11bb7f(_0x59cef0,_0x137c65(0xbc2)),setTimeout(async()=>{const _0x1a3080=_0x137c65;_0x153aed(_0x59cef0);const _0x710768=_0x291a6f,_0x22fc86=_0x291a6f+_0x1ff7bc,_0x10926e=_0x2c7a9f[_0x1a3080(0x111c)](_0x710768,_0x22fc86),_0x31ae84=document[_0x1a3080(0x8d9)]();for(const _0x16604c of _0x10926e){const _0x2dd73b=await _0x520ab5(_0x16604c);_0x31ae84[_0x1a3080(0xf77)](_0x2dd73b);}_0x59cef0[_0x1a3080(0xf77)](_0x31ae84),_0x291a6f+=_0x10926e['length'],_0x29dd6c=![];},0x1f4);}function _0x2019e9(_0x50bc37,_0x53fb2a){const _0x3781a9=_0x247bea,_0xf26e2d=_0xff941a[_0x3781a9(0xa4c)],_0x563d42=_0xff941a[_0x3781a9(0xf6e)];_0x563d42[_0x3781a9(0x102a)]='';_0x12493e[_0x3781a9(0x454)][_0x3781a9(0x79b)]===0x0?_0x563d42[_0x3781a9(0x102a)]=_0x3781a9(0x2de):_0x12493e[_0x3781a9(0x454)][_0x3781a9(0xd6a)](_0x3df774=>{const _0x4a5b17=_0x3781a9,_0x592c3c=document[_0x4a5b17(0x1292)](_0x4a5b17(0x58c));_0x592c3c[_0x4a5b17(0x84)]=_0x4a5b17(0x696),_0x592c3c[_0x4a5b17(0x105d)][_0x4a5b17(0x4b5)]=_0x4a5b17(0xb23)+_0x3df774[_0x4a5b17(0x11a)]+')',_0x592c3c[_0x4a5b17(0x874)]=_0x3df774[_0x4a5b17(0x578)],_0x563d42[_0x4a5b17(0xf77)](_0x592c3c);});const _0x5ee2e8=_0x53fb2a['getBoundingClientRect'](),_0x10aac6=document[_0x3781a9(0xc33)]('phone-screen')[_0x3781a9(0x9f3)]();_0xf26e2d[_0x3781a9(0x105d)][_0x3781a9(0xf44)]=_0x3781a9(0x21a);const _0x2448ed=_0xf26e2d[_0x3781a9(0x9f3)](),_0x3045da=_0x2448ed[_0x3781a9(0x27d)],_0x33d581=_0x2448ed[_0x3781a9(0x5f8)];_0xf26e2d[_0x3781a9(0x105d)]['top']=_0x5ee2e8[_0x3781a9(0xcbe)]-_0x3045da-0x5-_0x10aac6['top']+'px';const _0x24b27d=_0x5ee2e8[_0x3781a9(0x9e2)]-_0x10aac6[_0x3781a9(0x9e2)];_0x24b27d+_0x33d581>_0x10aac6['width']?(_0xf26e2d[_0x3781a9(0x105d)][_0x3781a9(0x9e2)]='auto',_0xf26e2d[_0x3781a9(0x105d)]['right']='5px'):(_0xf26e2d['style'][_0x3781a9(0x9e2)]=_0x24b27d+'px',_0xf26e2d[_0x3781a9(0x105d)][_0x3781a9(0xc3f)]='auto'),_0xff941a[_0x3781a9(0x1d9)]=!![],_0xff941a[_0x3781a9(0x401)]=_0x50bc37;}function _0x473cb3(){const _0x3a7fd8=_0x247bea;_0xff941a[_0x3a7fd8(0x1d9)]&&(_0xff941a['panelEl'][_0x3a7fd8(0x105d)][_0x3a7fd8(0xf44)]=_0x3a7fd8(0x854),_0xff941a[_0x3a7fd8(0x1d9)]=![],_0xff941a[_0x3a7fd8(0x401)]=null);}async function _0x1b26fb(_0xb07ee0,_0x100db4){const _0x26c5f6=_0x247bea;if(!_0x100db4||!_0x100db4[_0x26c5f6(0x11a)])return;const _0x1b2e12=await _0x2a2987['qzonePosts']['get'](_0xb07ee0);if(!_0x1b2e12){console[_0x26c5f6(0x4d9)](_0x26c5f6(0x921),_0xb07ee0);return;}!_0x1b2e12[_0x26c5f6(0xc83)]&&(_0x1b2e12['comments']=[]);const _0x16d579={'commenterName':_0x12493e[_0x26c5f6(0x76c)]['nickname'],'text':_0x100db4[_0x26c5f6(0x11a)],'meaning':_0x100db4[_0x26c5f6(0x578)],'timestamp':Date['now']()};_0x1b2e12[_0x26c5f6(0xc83)][_0x26c5f6(0x2d6)](_0x16d579),await _0x2a2987['qzonePosts'][_0x26c5f6(0xb07)](_0xb07ee0,{'comments':_0x1b2e12[_0x26c5f6(0xc83)]}),_0x473cb3(),await _0x14f3b0();const _0x24035c=(_0x1b2e12['publicText']||_0x1b2e12[_0x26c5f6(0xcbd)]||'[图片动态]')[_0x26c5f6(0x1033)](0x0,0x1e);for(const _0x1e31d4 in _0x12493e[_0x26c5f6(0xc45)]){const _0x8e9606=_0x12493e[_0x26c5f6(0xc45)][_0x1e31d4];if(!_0x8e9606[_0x26c5f6(0x80b)]){const _0x5007bc=_0x26c5f6(0xdf2)+_0x12493e[_0x26c5f6(0x76c)][_0x26c5f6(0x66a)]+'\x27\x20在你的动态(ID:\x20'+_0xb07ee0+_0x26c5f6(0x74e)+_0x24035c+'”)下发送了一个表情评论，意思是：“'+_0x100db4[_0x26c5f6(0x578)]+_0x26c5f6(0x1241),_0x1264c8={'role':_0x26c5f6(0x152),'content':_0x5007bc,'timestamp':Date[_0x26c5f6(0x6ee)](),'isHidden':!![]};_0x8e9606[_0x26c5f6(0x1294)][_0x26c5f6(0x2d6)](_0x1264c8),await _0x2a2987[_0x26c5f6(0xc45)][_0x26c5f6(0xf36)](_0x8e9606);}}}function _0x20de06(_0xce8c58){const _0x4d5c2f=_0x247bea;_0x198b03=_0xce8c58,document[_0x4d5c2f(0xc33)](_0x4d5c2f(0x7d9))[_0x4d5c2f(0x22a)]='',document[_0x4d5c2f(0xc33)](_0x4d5c2f(0x802))[_0x4d5c2f(0x10d3)]['add'](_0x4d5c2f(0x143));}function _0x276c0b(){const _0x3a37d4=_0x247bea;document[_0x3a37d4(0xc33)]('repost-modal')['classList'][_0x3a37d4(0x2c7)](_0x3a37d4(0x143)),_0x198b03=null;}async function _0x51474e(){const _0x3a1d26=_0x247bea;if(!_0x198b03)return;const _0x46fb2e=document[_0x3a1d26(0xc33)](_0x3a1d26(0x7d9))[_0x3a1d26(0x22a)]['trim'](),_0x5c2e43=await _0x2a2987[_0x3a1d26(0x110b)][_0x3a1d26(0xec0)](_0x198b03);if(!_0x5c2e43){alert('错误：找不到要转发的原始动态。'),_0x276c0b();return;}const _0x144176={'type':_0x3a1d26(0x106f),'timestamp':Date[_0x3a1d26(0x6ee)](),'authorId':_0x3a1d26(0x717),'repostComment':_0x46fb2e,'originalPost':_0x5c2e43,'visibleGroupIds':null};await _0x2a2987['qzonePosts']['add'](_0x144176),_0x276c0b(),await _0x14f3b0(),alert(_0x3a1d26(0x1240));}function _0x1627b8(_0xb124c){const _0x247cc2=_0x247bea,_0x2e08f5=document['getElementById'](_0x247cc2(0xdf6));_0x2e08f5['innerHTML']='';if(_0xb124c['length']===0x0){const _0x1e4ae5=document['getElementById'](_0x247cc2(0xfa3))[_0x247cc2(0x22a)],_0x4f15e4=_0x1e4ae5?_0x247cc2(0x402):_0x247cc2(0x57c);_0x2e08f5[_0x247cc2(0x102a)]=_0x247cc2(0x6c0)+_0x4f15e4+'</p>';return;}for(const _0x1981c3 of _0xb124c){const _0x388bf2=document[_0x247cc2(0x1292)](_0x247cc2(0x58c));_0x388bf2[_0x247cc2(0x84)]=_0x247cc2(0xfc4),_0x388bf2['dataset']['favid']=_0x1981c3['id'];let _0xce1e5='',_0x4ca30c='',_0x29ae83='',_0x492517='';if(_0x1981c3[_0x247cc2(0x52a)]==='qzone_post'){const _0x1d3630=_0x1981c3[_0x247cc2(0xcbd)];_0x29ae83='来自动态';let _0x473c63=_0x190acc,_0x336a8c=_0x247cc2(0xffa);if(_0x1d3630[_0x247cc2(0xd48)]===_0x247cc2(0x717))_0x473c63=_0x12493e['qzoneSettings'][_0x247cc2(0xbac)],_0x336a8c=_0x12493e[_0x247cc2(0x76c)][_0x247cc2(0x66a)];else _0x12493e[_0x247cc2(0xc45)][_0x1d3630[_0x247cc2(0xd48)]]&&(_0x473c63=_0x12493e[_0x247cc2(0xc45)][_0x1d3630[_0x247cc2(0xd48)]][_0x247cc2(0x2ea)]['aiAvatar'],_0x336a8c=_0x12493e[_0x247cc2(0xc45)][_0x1d3630[_0x247cc2(0xd48)]][_0x247cc2(0x578)]);_0xce1e5=_0x247cc2(0xb19)+_0x473c63+_0x247cc2(0x122)+_0x336a8c+_0x247cc2(0x91e);const _0x30b93d=_0x1d3630[_0x247cc2(0x964)]?'<div\x20class=\x22post-content\x22>'+_0x1d3630[_0x247cc2(0x964)][_0x247cc2(0xc12)](/\n/g,_0x247cc2(0xfd5))+'</div>':'';if(_0x1d3630[_0x247cc2(0x52a)]==='shuoshuo')_0x4ca30c='<div\x20class=\x22post-content\x22>'+_0x1d3630[_0x247cc2(0xcbd)][_0x247cc2(0xc12)](/\n/g,'<br>')+_0x247cc2(0xb45);else{if(_0x1d3630[_0x247cc2(0x52a)]===_0x247cc2(0x6ed)&&_0x1d3630[_0x247cc2(0x891)]){const _0x1cc5c6=_0x12493e[_0x247cc2(0x10f6)]['enableAiDrawing']&&_0x1d3630[_0x247cc2(0xe3d)]?'https://image.pollinations.ai/prompt/'+_0x1d3630[_0x247cc2(0xe3d)]:'https://i.postimg.cc/KYr2qRCK/1.jpg';_0x4ca30c=_0x30b93d?_0x30b93d+_0x247cc2(0x3a1)+_0x1cc5c6+_0x247cc2(0x4e5):_0x247cc2(0xb19)+_0x1cc5c6+'\x22\x20class=\x22chat-image\x22>';}else{if(_0x1d3630[_0x247cc2(0x52a)]===_0x247cc2(0x1bb)){const _0x92b9b2=_0x12493e[_0x247cc2(0x10f6)][_0x247cc2(0xd2f)]&&_0x1d3630[_0x247cc2(0xe3d)]?'https://image.pollinations.ai/prompt/'+_0x1d3630[_0x247cc2(0xe3d)]:_0x247cc2(0x4c7);_0x4ca30c=_0x30b93d?_0x30b93d+'<div\x20style=\x22margin-top:10px;\x22><img\x20src=\x22'+_0x92b9b2+_0x247cc2(0xfa0)+_0x1d3630[_0x247cc2(0xc2e)]+'\x22></div>':_0x247cc2(0xb19)+_0x92b9b2+_0x247cc2(0xfa0)+_0x1d3630[_0x247cc2(0xc2e)]+'\x22>';}}}let _0x229b14='';_0x1d3630['likes']&&_0x1d3630[_0x247cc2(0x615)][_0x247cc2(0x79b)]>0x0&&(_0x229b14=_0x247cc2(0xa7a)+_0x1d3630[_0x247cc2(0x615)][_0x247cc2(0x100b)]('、')+_0x247cc2(0x1170));let _0x2ea836='';_0x1d3630['comments']&&_0x1d3630[_0x247cc2(0xc83)][_0x247cc2(0x79b)]>0x0&&(_0x2ea836=_0x247cc2(0x5b5),_0x1d3630['comments'][_0x247cc2(0xd6a)]((_0x2e34bc,_0x331898)=>{const _0xc29aa8=_0x247cc2;if(typeof _0x2e34bc==='object'&&_0x2e34bc!==null&&_0x2e34bc[_0xc29aa8(0xfd9)]){const _0x195480=_0x2e34bc[_0xc29aa8(0xfd9)],_0x4745df=_0x1353b6(_0x195480);let _0xba6d5e;_0x301121[_0xc29aa8(0x677)](_0x2e34bc[_0xc29aa8(0x996)])?_0xba6d5e=_0xc29aa8(0xb19)+_0x2e34bc[_0xc29aa8(0x996)]+_0xc29aa8(0x998):_0xba6d5e=_0x2e34bc['text'];let _0x345872='';if(_0x2e34bc['replyTo']){const _0x112e7e=_0x1353b6(_0x2e34bc['replyTo']);_0x345872='<span\x20class=\x22commenter-name\x22>'+_0x4745df+_0xc29aa8(0x62e)+_0x112e7e+_0xc29aa8(0x2a7)+_0xba6d5e;}else _0x345872='<span\x20class=\x22commenter-name\x22>'+_0x4745df+'</span>:\x20'+_0xba6d5e;_0x2ea836+=_0xc29aa8(0x8f0)+_0x1d3630['id']+_0xc29aa8(0xc35)+_0x195480+'\x22\x20data-commenter-display-name=\x22'+_0x4745df+_0xc29aa8(0x84c)+_0x345872+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-delete-btn\x22\x20data-comment-index=\x22'+_0x331898+_0xc29aa8(0xe50);}else _0x2ea836+='<div\x20class=\x22legacy-comment-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-text\x22>'+String(_0x2e34bc)+_0xc29aa8(0xb01);}),_0x2ea836+=_0x247cc2(0xb45)),_0x492517=''+_0x229b14+_0x2ea836;}else{if(_0x1981c3['type']===_0x247cc2(0x11c0)){const _0x3df231=_0x1981c3[_0x247cc2(0xcbd)],_0x1f7f6f=_0x12493e[_0x247cc2(0xc45)][_0x1981c3[_0x247cc2(0x109b)]];if(!_0x1f7f6f)continue;_0x29ae83=_0x247cc2(0x159)+_0x1f7f6f[_0x247cc2(0x578)]+_0x247cc2(0x1035);const _0xff25d2=_0x3df231[_0x247cc2(0x16d)]===_0x247cc2(0x717);let _0x26b9bc,_0x24822e;if(_0xff25d2)_0x26b9bc=_0x1f7f6f['isGroup']?_0x1f7f6f[_0x247cc2(0x2ea)]['myNickname']||'我':'我',_0x24822e=_0x1f7f6f[_0x247cc2(0x2ea)][_0x247cc2(0x1006)]||(_0x1f7f6f[_0x247cc2(0x80b)]?_0x200461:_0x190acc);else{if(_0x1f7f6f['isGroup']){const _0x1e52d9=_0x1f7f6f[_0x247cc2(0xd5b)][_0x247cc2(0xd85)](_0x2b29bf=>_0x2b29bf[_0x247cc2(0x776)]===_0x3df231[_0x247cc2(0xe32)]);_0x26b9bc=_0x3df231[_0x247cc2(0xe32)],_0x24822e=_0x1e52d9?_0x1e52d9['avatar']:_0x5b9dd3;}else _0x26b9bc=_0x1f7f6f[_0x247cc2(0x578)],_0x24822e=_0x1f7f6f[_0x247cc2(0x2ea)][_0x247cc2(0x18e)]||_0x190acc;}_0xce1e5=_0x247cc2(0xb19)+_0x24822e+_0x247cc2(0x122)+_0x26b9bc+_0x247cc2(0x91e);if(typeof _0x3df231[_0x247cc2(0xcbd)]===_0x247cc2(0x9de)&&_0x301121[_0x247cc2(0x677)](_0x3df231[_0x247cc2(0xcbd)]))_0x4ca30c=_0x247cc2(0xb19)+_0x3df231['content']+_0x247cc2(0x158);else Array[_0x247cc2(0x621)](_0x3df231['content'])&&_0x3df231['content'][0x0]?.[_0x247cc2(0x52a)]==='image_url'?_0x4ca30c=_0x247cc2(0xb19)+_0x3df231['content'][0x0][_0x247cc2(0x10a1)][_0x247cc2(0x11a)]+_0x247cc2(0x835):_0x4ca30c=String(_0x3df231[_0x247cc2(0xcbd)]||'')['replace'](/\n/g,_0x247cc2(0xfd5));}else{if(_0x1981c3[_0x247cc2(0x52a)]===_0x247cc2(0xee8)){const _0x4a04aa=_0x1981c3[_0x247cc2(0xcbd)];_0x29ae83=_0x247cc2(0xed0)+_0x4a04aa[_0x247cc2(0xe58)]+'\x20的日记';const _0x49ac27=_0x12493e[_0x247cc2(0xc45)][_0x4a04aa['characterId']],_0x28eec2=_0x49ac27?_0x49ac27['settings'][_0x247cc2(0x18e)]:_0x190acc;_0xce1e5='<img\x20src=\x22'+_0x28eec2+_0x247cc2(0x122)+_0x4a04aa[_0x247cc2(0xe58)]+'</div></div>';const _0x236e14=_0x4a04aa[_0x247cc2(0xcbd)]||'',_0x5263c2=_0x45d05d(_0x236e14)[_0x247cc2(0xc12)](/\n/g,_0x247cc2(0xfd5));_0x4ca30c=_0x247cc2(0x9ca)+_0x4a04aa[_0x247cc2(0x874)]+_0x247cc2(0x1dc)+_0x5263c2+_0x247cc2(0x968);}else{if(_0x1981c3[_0x247cc2(0x52a)]==='char_browser_article'){const _0x37d55b=_0x1981c3[_0x247cc2(0xcbd)];_0x29ae83=_0x247cc2(0xed0)+_0x37d55b[_0x247cc2(0xe58)]+_0x247cc2(0x11b8);const _0x112030=_0x12493e[_0x247cc2(0xc45)][_0x37d55b['characterId']],_0x1bbac0=_0x112030?_0x112030[_0x247cc2(0x2ea)]['aiAvatar']:_0x190acc;_0xce1e5=_0x247cc2(0xb19)+_0x1bbac0+_0x247cc2(0x122)+_0x37d55b[_0x247cc2(0xe58)]+_0x247cc2(0x91e),_0x4ca30c='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22diary-title\x22>'+_0x37d55b['title']+_0x247cc2(0x8da)+(_0x37d55b['content']||'')[_0x247cc2(0xc12)](/\n/g,_0x247cc2(0xfd5))+_0x247cc2(0x1056);}else{if(_0x1981c3[_0x247cc2(0x52a)]===_0x247cc2(0x297)){const _0x3ab21c=_0x1981c3['content'];_0x29ae83=_0x247cc2(0xed0)+_0x3ab21c[_0x247cc2(0xe58)]+'\x20的备忘录';const _0x2ad38c=_0x12493e['chats'][_0x3ab21c[_0x247cc2(0x602)]],_0x2f249b=_0x2ad38c?_0x2ad38c[_0x247cc2(0x2ea)][_0x247cc2(0x18e)]:_0x190acc;_0xce1e5=_0x247cc2(0xb19)+_0x2f249b+_0x247cc2(0x122)+_0x3ab21c['characterName']+_0x247cc2(0x91e),_0x4ca30c=_0x247cc2(0x104b)+_0x3ab21c[_0x247cc2(0x874)]+_0x247cc2(0xda5)+_0x3ab21c[_0x247cc2(0xcbd)][_0x247cc2(0xc12)](/\n/g,_0x247cc2(0xfd5))+_0x247cc2(0xe9);}}}}}_0x388bf2[_0x247cc2(0x102a)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22fav-card-header\x22>'+_0xce1e5+_0x247cc2(0xd66)+_0x29ae83+_0x247cc2(0x4f8)+_0x4ca30c+_0x247cc2(0x1f4)+_0x492517,_0x2e08f5[_0x247cc2(0xf77)](_0x388bf2);}}async function _0x32f042(){const _0x3024a0=_0x247bea;allFavoriteItems=await _0x2a2987[_0x3024a0(0xe69)][_0x3024a0(0xde3)]('timestamp')['reverse']()[_0x3024a0(0xf15)]();const _0x5c2bb5=document['getElementById']('favorites-search-input'),_0x26dcc0=document[_0x3024a0(0xc33)](_0x3024a0(0xa68));_0x5c2bb5[_0x3024a0(0x22a)]='',_0x26dcc0['style'][_0x3024a0(0xf44)]=_0x3024a0(0x854),_0x1627b8(allFavoriteItems);}function _0x117b43(){const _0x2a4ca8=_0x247bea;document['getElementById'](_0x2a4ca8(0x135))[_0x2a4ca8(0x22a)]='',document[_0x2a4ca8(0xc33)](_0x2a4ca8(0x718))[_0x2a4ca8(0x87b)]='',document[_0x2a4ca8(0xc33)](_0x2a4ca8(0x4ff))[_0x2a4ca8(0x22a)]='',document[_0x2a4ca8(0xc33)](_0x2a4ca8(0xf45))[_0x2a4ca8(0x10d3)][_0x2a4ca8(0x2c7)]('visible'),document[_0x2a4ca8(0xc33)](_0x2a4ca8(0x10af))[_0x2a4ca8(0x105d)]['display']=_0x2a4ca8(0x854),document[_0x2a4ca8(0xc33)]('post-local-image-input')[_0x2a4ca8(0x22a)]='',document[_0x2a4ca8(0xc33)](_0x2a4ca8(0xe3c))[_0x2a4ca8(0x22a)]='',document[_0x2a4ca8(0xc33)](_0x2a4ca8(0x11ef))[_0x2a4ca8(0x335)]();}async function _0x153614(){const _0x35f874=_0x247bea,_0x1e18e5=await _0x270512(_0x35f874(0xfbd),_0x35f874(0x974),{'confirmButtonClass':_0x35f874(0xa2),'confirmText':_0x35f874(0x32d)});if(!_0x1e18e5)return;await _0x2d7ddd(_0x35f874(0xb37),_0x35f874(0xb84)),console[_0x35f874(0x51f)](_0x35f874(0x1135));let _0x5ec0e8={'posts':0x0,'likes':0x0,'comments':0x0,'memories':0x0,'callRecords':0x0,'renderingRules':0x0,'groupMembers':0x0,'chatLinks':0x0};try{await _0x2a2987[_0x35f874(0xbff)]('rw',_0x2a2987[_0x35f874(0xf92)],async()=>{const _0x29ed85=_0x35f874,_0x167506=await _0x2a2987[_0x29ed85(0xc45)][_0x29ed85(0xf15)](),_0x35bf2c=await _0x2a2987['npcs']['toArray'](),_0x531524=new Set(_0x167506[_0x29ed85(0x9d5)](_0x508a02=>_0x508a02['id'])),_0x203ad6=new Set(_0x35bf2c[_0x29ed85(0x9d5)](_0x1c5b91=>_0x29ed85(0xb90)+_0x1c5b91['id'])),_0x2f9839=new Set(_0x167506['filter'](_0x200f10=>!_0x200f10['isGroup'])[_0x29ed85(0x9d5)](_0x52f6c6=>_0x52f6c6[_0x29ed85(0x776)]));_0x2f9839['add'](_0x12493e[_0x29ed85(0x76c)][_0x29ed85(0x66a)]||_0x29ed85(0x10d0)),_0x35bf2c[_0x29ed85(0xd6a)](_0x231be5=>_0x2f9839[_0x29ed85(0xb9)](_0x231be5['name']));for(const _0x345a6c of _0x167506){let _0x1d30ba=![];if(_0x345a6c['isGroup']&&_0x345a6c[_0x29ed85(0xd5b)]){const _0x322029=_0x345a6c[_0x29ed85(0xd5b)][_0x29ed85(0x79b)];_0x345a6c['members']=_0x345a6c[_0x29ed85(0xd5b)]['filter'](_0xb8f6f=>_0x531524[_0x29ed85(0xa7)](_0xb8f6f['id'])||_0x203ad6[_0x29ed85(0xa7)](_0xb8f6f['id'])),_0x345a6c[_0x29ed85(0xd5b)][_0x29ed85(0x79b)]<_0x322029&&(_0x5ec0e8[_0x29ed85(0xd9d)]+=_0x322029-_0x345a6c['members'][_0x29ed85(0x79b)],_0x1d30ba=!![]);}if(_0x345a6c[_0x29ed85(0x2ea)]?.['linkedMemoryChatIds']?.[_0x29ed85(0x79b)]>0x0){const _0x3d21dc=_0x345a6c[_0x29ed85(0x2ea)]['linkedMemoryChatIds'][_0x29ed85(0x79b)];_0x345a6c[_0x29ed85(0x2ea)]['linkedMemoryChatIds']=_0x345a6c[_0x29ed85(0x2ea)][_0x29ed85(0x48b)][_0x29ed85(0x1054)](_0x4e4265=>_0x531524['has'](_0x4e4265)),_0x345a6c['settings']['linkedMemoryChatIds']['length']<_0x3d21dc&&(_0x5ec0e8[_0x29ed85(0xa5c)]+=_0x3d21dc-_0x345a6c[_0x29ed85(0x2ea)][_0x29ed85(0x48b)][_0x29ed85(0x79b)],_0x1d30ba=!![]);}_0x1d30ba&&await _0x2a2987[_0x29ed85(0xc45)][_0x29ed85(0xf36)](_0x345a6c);}const _0x225c03=await _0x2a2987[_0x29ed85(0x110b)][_0x29ed85(0xf15)]();for(const _0x508fe5 of _0x225c03){let _0x43a87c=![];const _0x5197e2=_0x508fe5['authorId']==='user'||_0x531524['has'](_0x508fe5[_0x29ed85(0xd48)])||_0x203ad6[_0x29ed85(0xa7)](_0x508fe5['authorId']);if(!_0x5197e2){await _0x2a2987['qzonePosts'][_0x29ed85(0x9ea)](_0x508fe5['id']),_0x5ec0e8['posts']++;continue;}if(_0x508fe5[_0x29ed85(0x615)]&&_0x508fe5['likes'][_0x29ed85(0x79b)]>0x0){const _0x4295a9=_0x508fe5[_0x29ed85(0x615)][_0x29ed85(0x79b)];_0x508fe5[_0x29ed85(0x615)]=_0x508fe5[_0x29ed85(0x615)]['filter'](_0x4679b4=>_0x2f9839[_0x29ed85(0xa7)](_0x4679b4)),_0x508fe5[_0x29ed85(0x615)][_0x29ed85(0x79b)]<_0x4295a9&&(_0x5ec0e8[_0x29ed85(0x615)]+=_0x4295a9-_0x508fe5[_0x29ed85(0x615)][_0x29ed85(0x79b)],_0x43a87c=!![]);}if(_0x508fe5['comments']&&_0x508fe5[_0x29ed85(0xc83)]['length']>0x0){const _0x4f2b7e=_0x508fe5[_0x29ed85(0xc83)]['length'];_0x508fe5[_0x29ed85(0xc83)]=_0x508fe5[_0x29ed85(0xc83)][_0x29ed85(0x1054)](_0x8c7b41=>{const _0x3d392f=_0x29ed85;if(typeof _0x8c7b41===_0x3d392f(0xe37)&&_0x8c7b41[_0x3d392f(0xfd9)])return _0x2f9839[_0x3d392f(0xa7)](_0x8c7b41[_0x3d392f(0xfd9)]);return!![];}),_0x508fe5[_0x29ed85(0xc83)][_0x29ed85(0x79b)]<_0x4f2b7e&&(_0x5ec0e8[_0x29ed85(0xc83)]+=_0x4f2b7e-_0x508fe5[_0x29ed85(0xc83)]['length'],_0x43a87c=!![]);}_0x43a87c&&await _0x2a2987[_0x29ed85(0x110b)]['put'](_0x508fe5);}await _0x2a2987[_0x29ed85(0x37c)][_0x29ed85(0x8b5)](_0x29ed85(0x109b))['noneOf']([..._0x531524])[_0x29ed85(0x9ea)]()['then'](_0x2f9478=>_0x5ec0e8['memories']+=_0x2f9478),await _0x2a2987[_0x29ed85(0x508)][_0x29ed85(0x8b5)]('chatId')[_0x29ed85(0x4fc)]([..._0x531524])['delete']()['then'](_0x1b8939=>_0x5ec0e8[_0x29ed85(0x508)]+=_0x1b8939);const _0x460c3b=await _0x2a2987[_0x29ed85(0x1103)]['toArray']();for(const _0x2a4c78 of _0x460c3b){_0x2a4c78[_0x29ed85(0x109b)]!=='global'&&!_0x531524['has'](_0x2a4c78[_0x29ed85(0x109b)])&&(await _0x2a2987[_0x29ed85(0x1103)]['delete'](_0x2a4c78['id']),_0x5ec0e8[_0x29ed85(0x1103)]++);}});let _0x3cbd21=_0x35f874(0xe77),_0xdfd764=![];Object[_0x35f874(0x43e)](_0x5ec0e8)['forEach'](([_0x244410,_0x38748e])=>{const _0x5645f6=_0x35f874;if(_0x38748e>0x0){const _0x3f217f={'posts':'动态','likes':'点赞','comments':'评论','memories':'记忆','callRecords':_0x5645f6(0x1078),'renderingRules':_0x5645f6(0xa5e),'groupMembers':_0x5645f6(0x178),'chatLinks':_0x5645f6(0x698)};_0x3cbd21+='-\x20清理了\x20'+_0x38748e+'\x20条无效的'+(_0x3f217f[_0x244410]||_0x244410)+'。\x0a',_0xdfd764=!![];}});!_0xdfd764&&(_0x3cbd21=_0x35f874(0x1016));_0x3cbd21+=_0x35f874(0xf6b),await _0x2d7ddd(_0x35f874(0x154),_0x3cbd21);const _0x419486=await _0x270512('刷新页面？',_0x35f874(0x102d));_0x419486&&location[_0x35f874(0x99b)]();}catch(_0x276ffe){console[_0x35f874(0x4d9)](_0x35f874(0x3bc),_0x276ffe),await _0x2d7ddd(_0x35f874(0x141),_0x35f874(0x2b9)+_0x276ffe[_0x35f874(0xf93)]);}}async function _0x313a1e(){const _0x403b27=_0x247bea;try{const _0x4ad0d0={'version':0x1,'timestamp':Date[_0x403b27(0x6ee)]()},[_0x2fff8a,_0x1c7677,_0x38d7f0,_0x34e552,_0x5c71cd,_0x382adc,_0x1451ce,_0x28941a,_0x258a5c,_0x37b126,_0x28de2c,_0x233aff,_0x21aad5,_0x3cced0,_0x4a0137,_0x237389,_0x2a720a,_0x150908,_0x12d249,_0x56a635,_0xc8ff6,_0x8cf611,_0x36d74b,_0x4eea2c,_0x11e3dc]=await Promise['all']([_0x2a2987[_0x403b27(0xc45)][_0x403b27(0xf15)](),_0x2a2987[_0x403b27(0x63a)]['toArray'](),_0x2a2987[_0x403b27(0x454)]['toArray'](),_0x2a2987['apiConfig'][_0x403b27(0xec0)](_0x403b27(0x2f3)),_0x2a2987[_0x403b27(0x10f6)][_0x403b27(0xec0)](_0x403b27(0x2f3)),_0x2a2987[_0x403b27(0x25e)]['toArray'](),_0x2a2987[_0x403b27(0xba)][_0x403b27(0xec0)]('main'),_0x2a2987[_0x403b27(0x76c)]['get']('main'),_0x2a2987[_0x403b27(0x110b)]['toArray'](),_0x2a2987[_0x403b27(0xe7b)][_0x403b27(0xf15)](),_0x2a2987[_0x403b27(0xd37)][_0x403b27(0xf15)](),_0x2a2987[_0x403b27(0xe69)]['toArray'](),_0x2a2987[_0x403b27(0x54b)]['toArray'](),_0x2a2987[_0x403b27(0x37c)][_0x403b27(0xf15)](),_0x2a2987[_0x403b27(0xd06)][_0x403b27(0xf15)](),_0x2a2987[_0x403b27(0x182)][_0x403b27(0xf15)](),_0x2a2987[_0x403b27(0x6b4)][_0x403b27(0xf15)](),_0x2a2987[_0x403b27(0x508)][_0x403b27(0xf15)](),_0x2a2987['renderingRules'][_0x403b27(0xf15)](),_0x2a2987[_0x403b27(0x4f0)]['toArray'](),_0x2a2987['stickerCategories']['toArray'](),_0x2a2987[_0x403b27(0x647)][_0x403b27(0xf15)](),_0x2a2987['presets'][_0x403b27(0xf15)](),_0x2a2987[_0x403b27(0x4b6)][_0x403b27(0xf15)](),_0x2a2987[_0x403b27(0xc61)]['toArray']()]);Object[_0x403b27(0x26f)](_0x4ad0d0,{'chats':_0x2fff8a,'worldBooks':_0x1c7677,'userStickers':_0x38d7f0,'apiConfig':_0x34e552,'globalSettings':_0x5c71cd,'personaPresets':_0x382adc,'musicLibrary':_0x1451ce,'qzoneSettings':_0x28941a,'qzonePosts':_0x258a5c,'qzoneAlbums':_0x37b126,'qzonePhotos':_0x28de2c,'favorites':_0x233aff,'qzoneGroups':_0x21aad5,'memories':_0x3cced0,'worldBookCategories':_0x4a0137,'apiPresets':_0x237389,'shoppingProducts':_0x2a720a,'callRecords':_0x150908,'renderingRules':_0x12d249,'doubanPosts':_0x56a635,'stickerCategories':_0xc8ff6,'appearancePresets':_0x8cf611,'presets':_0x36d74b,'presetCategories':_0x4eea2c,'npcs':_0x11e3dc});const _0x37000d=new Blob([JSON[_0x403b27(0xd27)](_0x4ad0d0,null,0x2)],{'type':_0x403b27(0xd74)}),_0x8d6fb4=URL[_0x403b27(0xca2)](_0x37000d),_0x12c6fa=Object[_0x403b27(0x26f)](document['createElement']('a'),{'href':_0x8d6fb4,'download':'EPhone-Full-Backup-'+new Date()[_0x403b27(0x7a3)]()[_0x403b27(0x8d7)]('T')[0x0]+_0x403b27(0xc8)});_0x12c6fa[_0x403b27(0x335)](),URL[_0x403b27(0x1202)](_0x8d6fb4),await _0x2d7ddd(_0x403b27(0x761),_0x403b27(0xb2e));}catch(_0x2b020f){console[_0x403b27(0x4d9)](_0x403b27(0xc7a),_0x2b020f),await _0x2d7ddd(_0x403b27(0xd21),'发生了一个错误:\x20'+_0x2b020f['message']);}}async function _0x35b212(_0x3f0919){const _0x4f4b31=_0x247bea;try{await _0x2a2987[_0x4f4b31(0xbff)]('rw',_0x2a2987[_0x4f4b31(0xf92)],async()=>{const _0x296428=_0x4f4b31;for(const _0x39ef5c of _0x2a2987[_0x296428(0xf92)]){await _0x39ef5c[_0x296428(0xebb)]();}for(const _0x372a75 in _0x3f0919){Array[_0x296428(0x621)](_0x3f0919[_0x372a75])&&(console[_0x296428(0x51f)](_0x296428(0x1bc)+_0x372a75+_0x296428(0x535)+_0x3f0919[_0x372a75][_0x296428(0x79b)]),await _0x2a2987[_0x296428(0xf3e)](_0x372a75)[_0x296428(0xee7)](_0x3f0919[_0x372a75]));}});}catch(_0x866b2){throw new Error('数据库写入失败:\x20'+_0x866b2['message']);}}async function _0x303a8a(_0x2e7c26){const _0x240db0=_0x247bea;if(!_0x2e7c26)return;const _0x370571=await _0x270512(_0x240db0(0x275),_0x240db0(0x1d5),{'confirmButtonClass':'btn-danger'});if(!_0x370571)return;await _0x2d7ddd(_0x240db0(0xb37),'正在读取并解析备份文件...');try{const _0xa54805=await _0x2e7c26['text'](),_0x22c3e8=JSON[_0x240db0(0x6b1)](_0xa54805);if(_0x22c3e8[_0x240db0(0xa78)]&&typeof _0x22c3e8[_0x240db0(0xa78)]===_0x240db0(0xe37)&&_0x22c3e8[_0x240db0(0xa78)][_0x240db0(0xc45)])console[_0x240db0(0x51f)](_0x240db0(0x3f0)),await _0x35b212(_0x22c3e8['data']);else{if(_0x22c3e8[_0x240db0(0xc45)])console[_0x240db0(0x51f)](_0x240db0(0xb95)),await _0x34b532(_0x22c3e8);else throw new Error(_0x240db0(0x32e));}await _0x2d7ddd('导入成功',_0x240db0(0x531)),setTimeout(()=>{const _0x129c0f=_0x240db0;window[_0x129c0f(0xe09)]['reload']();},0x5dc);}catch(_0x506385){console[_0x240db0(0x4d9)]('导入数据时出错:',_0x506385),await _0x2d7ddd('导入失败',_0x240db0(0x4e8)+_0x506385[_0x240db0(0xf93)]);}}async function _0x34b532(_0x3d6c0b){const _0x2370d7=_0x247bea;try{await _0x2a2987[_0x2370d7(0xbff)]('rw',_0x2a2987[_0x2370d7(0xf92)],async()=>{const _0x1781b8=_0x2370d7;await _0x2a2987[_0x1781b8(0xc45)][_0x1781b8(0xebb)](),await _0x2a2987[_0x1781b8(0x63a)][_0x1781b8(0xebb)]();for(const _0x3b95a1 of _0x2a2987[_0x1781b8(0xf92)]){await _0x3b95a1['clear']();}if(Array[_0x1781b8(0x621)](_0x3d6c0b[_0x1781b8(0xc45)]))await _0x2a2987['chats'][_0x1781b8(0xee7)](_0x3d6c0b[_0x1781b8(0xc45)]);if(Array[_0x1781b8(0x621)](_0x3d6c0b[_0x1781b8(0x63a)]))await _0x2a2987[_0x1781b8(0x63a)]['bulkPut'](_0x3d6c0b[_0x1781b8(0x63a)]);if(Array[_0x1781b8(0x621)](_0x3d6c0b[_0x1781b8(0x454)]))await _0x2a2987[_0x1781b8(0x454)][_0x1781b8(0xee7)](_0x3d6c0b[_0x1781b8(0x454)]);if(_0x3d6c0b[_0x1781b8(0xdd4)])await _0x2a2987[_0x1781b8(0xdd4)][_0x1781b8(0xf36)](_0x3d6c0b[_0x1781b8(0xdd4)]);if(_0x3d6c0b[_0x1781b8(0x10f6)])await _0x2a2987[_0x1781b8(0x10f6)][_0x1781b8(0xf36)](_0x3d6c0b[_0x1781b8(0x10f6)]);if(Array[_0x1781b8(0x621)](_0x3d6c0b[_0x1781b8(0x25e)]))await _0x2a2987[_0x1781b8(0x25e)][_0x1781b8(0xee7)](_0x3d6c0b[_0x1781b8(0x25e)]);if(_0x3d6c0b['musicLibrary'])await _0x2a2987[_0x1781b8(0xba)][_0x1781b8(0xf36)](_0x3d6c0b[_0x1781b8(0xba)]);if(_0x3d6c0b[_0x1781b8(0x76c)])await _0x2a2987[_0x1781b8(0x76c)][_0x1781b8(0xf36)](_0x3d6c0b[_0x1781b8(0x76c)]);if(Array[_0x1781b8(0x621)](_0x3d6c0b[_0x1781b8(0x110b)]))await _0x2a2987[_0x1781b8(0x110b)][_0x1781b8(0xee7)](_0x3d6c0b[_0x1781b8(0x110b)]);if(Array[_0x1781b8(0x621)](_0x3d6c0b[_0x1781b8(0xe7b)]))await _0x2a2987[_0x1781b8(0xe7b)][_0x1781b8(0xee7)](_0x3d6c0b[_0x1781b8(0xe7b)]);if(Array[_0x1781b8(0x621)](_0x3d6c0b[_0x1781b8(0xd37)]))await _0x2a2987['qzonePhotos']['bulkPut'](_0x3d6c0b['qzonePhotos']);if(Array[_0x1781b8(0x621)](_0x3d6c0b[_0x1781b8(0xe69)]))await _0x2a2987[_0x1781b8(0xe69)][_0x1781b8(0xee7)](_0x3d6c0b['favorites']);if(Array['isArray'](_0x3d6c0b[_0x1781b8(0x54b)]))await _0x2a2987[_0x1781b8(0x54b)][_0x1781b8(0xee7)](_0x3d6c0b[_0x1781b8(0x54b)]);if(Array['isArray'](_0x3d6c0b[_0x1781b8(0x37c)]))await _0x2a2987[_0x1781b8(0x37c)][_0x1781b8(0xee7)](_0x3d6c0b['memories']);if(Array[_0x1781b8(0x621)](_0x3d6c0b[_0x1781b8(0xd06)]))await _0x2a2987[_0x1781b8(0xd06)][_0x1781b8(0xee7)](_0x3d6c0b[_0x1781b8(0xd06)]);if(Array[_0x1781b8(0x621)](_0x3d6c0b[_0x1781b8(0x182)]))await _0x2a2987['apiPresets'][_0x1781b8(0xee7)](_0x3d6c0b[_0x1781b8(0x182)]);if(Array[_0x1781b8(0x621)](_0x3d6c0b[_0x1781b8(0x6b4)]))await _0x2a2987[_0x1781b8(0x6b4)][_0x1781b8(0xee7)](_0x3d6c0b[_0x1781b8(0x6b4)]);if(Array[_0x1781b8(0x621)](_0x3d6c0b[_0x1781b8(0x508)]))await _0x2a2987[_0x1781b8(0x508)][_0x1781b8(0xee7)](_0x3d6c0b[_0x1781b8(0x508)]);if(Array['isArray'](_0x3d6c0b[_0x1781b8(0x1103)]))await _0x2a2987[_0x1781b8(0x1103)][_0x1781b8(0xee7)](_0x3d6c0b[_0x1781b8(0x1103)]);if(Array[_0x1781b8(0x621)](_0x3d6c0b['doubanPosts']))await _0x2a2987[_0x1781b8(0x4f0)][_0x1781b8(0xee7)](_0x3d6c0b[_0x1781b8(0x4f0)]);if(Array[_0x1781b8(0x621)](_0x3d6c0b[_0x1781b8(0xfb6)]))await _0x2a2987[_0x1781b8(0xfb6)]['bulkPut'](_0x3d6c0b[_0x1781b8(0xfb6)]);if(Array['isArray'](_0x3d6c0b['appearancePresets']))await _0x2a2987[_0x1781b8(0x647)]['bulkPut'](_0x3d6c0b['appearancePresets']);if(Array[_0x1781b8(0x621)](_0x3d6c0b[_0x1781b8(0xe31)]))await _0x2a2987[_0x1781b8(0xe31)]['bulkPut'](_0x3d6c0b[_0x1781b8(0xe31)]);if(Array[_0x1781b8(0x621)](_0x3d6c0b[_0x1781b8(0x4b6)]))await _0x2a2987[_0x1781b8(0x4b6)][_0x1781b8(0xee7)](_0x3d6c0b[_0x1781b8(0x4b6)]);if(Array[_0x1781b8(0x621)](_0x3d6c0b['npcs']))await _0x2a2987['npcs']['bulkPut'](_0x3d6c0b[_0x1781b8(0xc61)]);});}catch(_0x142bee){throw new Error(_0x2370d7(0xa5a)+_0x142bee[_0x2370d7(0xf93)]);}}function _0x2e1ac4(_0x50427c,_0x3bddfc=![]){const _0x93cdb4=_0x247bea;if(!_0x50427c){_0x5bbedd[_0x93cdb4(0x102a)]='',document['getElementById'](_0x93cdb4(0x9fc))[_0x93cdb4(0x105d)][_0x93cdb4(0x1272)]='';return;}const _0x493ede=_0x93cdb4(0xaee),_0x23e4ec=_0x93cdb4(0x20c)+_0x493ede+_0x93cdb4(0x1141)+_0x50427c+_0x93cdb4(0x125a);if(_0x3bddfc){const _0x4e9ae9=document[_0x93cdb4(0xc33)]('preview-font-style')||document[_0x93cdb4(0x1292)](_0x93cdb4(0x105d));_0x4e9ae9['id']='preview-font-style',_0x4e9ae9[_0x93cdb4(0x102a)]=_0x23e4ec;if(!document[_0x93cdb4(0xc33)](_0x93cdb4(0xf7b)))document[_0x93cdb4(0xcb4)][_0x93cdb4(0xf77)](_0x4e9ae9);document[_0x93cdb4(0xc33)]('font-preview')[_0x93cdb4(0x105d)][_0x93cdb4(0x1272)]='\x27'+_0x493ede+_0x93cdb4(0xbda);}else _0x5bbedd[_0x93cdb4(0x102a)]=_0x93cdb4(0x11c)+_0x23e4ec+_0x93cdb4(0xf81)+_0x493ede+_0x93cdb4(0x345);}async function _0x2b1bbf(){const _0x35234b=_0x247bea;_0x5bbedd['innerHTML']='',_0x12493e[_0x35234b(0x10f6)][_0x35234b(0x10cc)]='',await _0x2a2987[_0x35234b(0x10f6)]['put'](_0x12493e['globalSettings']),document[_0x35234b(0xc33)](_0x35234b(0xf1c))[_0x35234b(0x22a)]='',document[_0x35234b(0xc33)](_0x35234b(0x9fc))[_0x35234b(0x105d)][_0x35234b(0x1272)]='',alert(_0x35234b(0xe7d));}async function _0x1af137(){const _0x51a08f=_0x247bea,[_0x2f4024,_0x22aae8,_0x42d09a,_0x1c90c5,_0x366894,_0x3c1345,_0x3161fb,_0x3ac37c,_0x267c16,_0x4375e6,_0x1cb1b8]=await Promise[_0x51a08f(0x5c8)]([_0x2a2987[_0x51a08f(0xc45)]['toArray'](),_0x2a2987[_0x51a08f(0xdd4)][_0x51a08f(0xec0)]('main'),_0x2a2987[_0x51a08f(0x10f6)][_0x51a08f(0xec0)]('main'),_0x2a2987[_0x51a08f(0x454)][_0x51a08f(0xf15)](),_0x2a2987[_0x51a08f(0x63a)][_0x51a08f(0xf15)](),_0x2a2987[_0x51a08f(0xba)][_0x51a08f(0xec0)]('main'),_0x2a2987['personaPresets']['toArray'](),_0x2a2987[_0x51a08f(0x76c)][_0x51a08f(0xec0)]('main'),_0x2a2987[_0x51a08f(0xe69)][_0x51a08f(0xde3)](_0x51a08f(0x2f0))[_0x51a08f(0xc07)]()[_0x51a08f(0xf15)](),_0x2a2987[_0x51a08f(0x37c)][_0x51a08f(0xf15)](),_0x2a2987[_0x51a08f(0xe31)][_0x51a08f(0xf15)]()]);_0x12493e[_0x51a08f(0xe31)]=_0x1cb1b8||[];const _0x50f5ec={'id':_0x51a08f(0x2f3),'showStatusBar':![],'wallpaper':_0x51a08f(0x110),'fontUrl':'','enableBackgroundActivity':![],'backgroundActivityInterval':0x3c,'blockCooldownHours':0x1,'apiTemperature':0.8,'appIcons':{..._0xb7c43a},'cphoneWallpaper':_0x51a08f(0x530),'cphoneAppIcons':{..._0x44ed6c},'globalCss':'','notificationSoundUrl':'','widgetData':{},'globalChatBackground':'','enableAiDrawing':!![],'chatActionButtonsOrder':null,'shoppingCategoryCount':0x3,'shoppingProductCount':0x8,'chatRenderWindow':0x32};_0x12493e['globalSettings']={..._0x50f5ec,..._0x42d09a||{}},_0x12493e[_0x51a08f(0x10f6)]['appIcons']={..._0x50f5ec[_0x51a08f(0x4da)],..._0x12493e[_0x51a08f(0x10f6)][_0x51a08f(0x4da)]||{}},_0x12493e['globalSettings']['cphoneAppIcons']={..._0x50f5ec[_0x51a08f(0x2d4)],..._0x12493e[_0x51a08f(0x10f6)][_0x51a08f(0x2d4)]||{}},_0x2f4024[_0x51a08f(0xd6a)](_0x54a3c5=>{const _0x5bb742=_0x51a08f;typeof _0x54a3c5['settings'][_0x5bb742(0x6c7)]===_0x5bb742(0x120c)&&(_0x54a3c5[_0x5bb742(0x2ea)][_0x5bb742(0x6c7)]=!![]),!_0x54a3c5[_0x5bb742(0x2ea)]['lyricsPosition']&&(_0x54a3c5['settings']['lyricsPosition']={'vertical':_0x5bb742(0xcbe),'horizontal':_0x5bb742(0xcef),'offset':0xa}),!_0x54a3c5['isGroup']&&!_0x54a3c5['settings']['myAvatarLibrary']&&(_0x54a3c5[_0x5bb742(0x2ea)][_0x5bb742(0x10df)]=[]),!_0x54a3c5[_0x5bb742(0x80b)]&&typeof _0x54a3c5['originalName']===_0x5bb742(0x120c)&&(_0x54a3c5[_0x5bb742(0x776)]=_0x54a3c5['name']);}),_0x12493e[_0x51a08f(0xc45)]=_0x2f4024['reduce']((_0x30c9da,_0x2b7f29)=>{const _0xce218d=_0x51a08f;if(typeof _0x2b7f29[_0xce218d(0xdc5)]===_0xce218d(0x120c))_0x2b7f29[_0xce218d(0xdc5)]=0x0;_0x2b7f29[_0xce218d(0x80b)]&&(typeof _0x2b7f29[_0xce218d(0x2ea)]['enableBackgroundActivity']===_0xce218d(0x120c)&&(_0x2b7f29[_0xce218d(0x2ea)][_0xce218d(0xdde)]=!![]),_0x2b7f29[_0xce218d(0xd5b)]&&_0x2b7f29[_0xce218d(0xd5b)][_0xce218d(0x79b)]>0x0&&_0x2b7f29[_0xce218d(0xd5b)][0x0][_0xce218d(0x578)]&&_0x2b7f29[_0xce218d(0xd5b)][_0xce218d(0xd6a)](_0x4b5b56=>{const _0x5118dd=_0xce218d;typeof _0x4b5b56[_0x5118dd(0x776)]==='undefined'&&(_0x4b5b56[_0x5118dd(0x776)]=_0x4b5b56[_0x5118dd(0x578)],_0x4b5b56['groupNickname']=_0x4b5b56[_0x5118dd(0x578)],delete _0x4b5b56[_0x5118dd(0x578)]);}));if(!_0x2b7f29[_0xce218d(0x2ea)])_0x2b7f29[_0xce218d(0x2ea)]={};typeof _0x2b7f29[_0xce218d(0x2ea)][_0xce218d(0x663)]===_0xce218d(0x120c)&&(_0x2b7f29['settings'][_0xce218d(0x663)]=0xa);if(!_0x2b7f29['isGroup']&&!_0x2b7f29[_0xce218d(0xbc8)])_0x2b7f29[_0xce218d(0xbc8)]={'text':'在线','lastUpdate':Date[_0xce218d(0x6ee)](),'isBusy':![]};if(!_0x2b7f29[_0xce218d(0x80b)]&&!_0x2b7f29[_0xce218d(0x1cb)])_0x2b7f29[_0xce218d(0x1cb)]={'status':_0xce218d(0xe59),'blockedTimestamp':null,'applicationReason':''};if(!_0x2b7f29[_0xce218d(0x80b)]&&(!_0x2b7f29[_0xce218d(0x2ea)]||!_0x2b7f29[_0xce218d(0x2ea)][_0xce218d(0xfc5)])){if(!_0x2b7f29[_0xce218d(0x2ea)])_0x2b7f29[_0xce218d(0x2ea)]={};_0x2b7f29['settings']['aiAvatarLibrary']=[];}_0x2b7f29[_0xce218d(0x80b)]&&(_0x2b7f29[_0xce218d(0xd5b)]||[])[_0xce218d(0xd6a)](_0x368479=>{const _0x1e15ac=_0xce218d;if(typeof _0x368479[_0x1e15ac(0x2f4)]===_0x1e15ac(0x120c))_0x368479[_0x1e15ac(0x2f4)]='';});if(!_0x2b7f29[_0xce218d(0x33f)])_0x2b7f29[_0xce218d(0x33f)]={'totalTime':0x0};_0x2b7f29[_0xce218d(0x2ea)]&&_0x2b7f29[_0xce218d(0x2ea)][_0xce218d(0xf39)]&&!_0x2b7f29[_0xce218d(0x2ea)]['linkedWorldBookIds']&&(_0x2b7f29[_0xce218d(0x2ea)]['linkedWorldBookIds']=[_0x2b7f29[_0xce218d(0x2ea)][_0xce218d(0xf39)]],delete _0x2b7f29['settings'][_0xce218d(0xf39)]);if(typeof _0x2b7f29[_0xce218d(0x4fe)]===_0xce218d(0x120c))_0x2b7f29[_0xce218d(0x4fe)]=![];!_0x2b7f29[_0xce218d(0x80b)]&&typeof _0x2b7f29['settings'][_0xce218d(0xbf6)]===_0xce218d(0x120c)&&(_0x2b7f29[_0xce218d(0x2ea)][_0xce218d(0xbf6)]='我');if(_0x2b7f29[_0xce218d(0x80b)]&&_0x2b7f29[_0xce218d(0xd5b)]){let _0x32fafd=![];_0x2f4024[_0xce218d(0xd6a)](_0x3cc786=>{const _0xcfce8=_0xce218d;_0x3cc786['id']===_0x2b7f29['id']&&_0x3cc786['originalName']&&delete _0x3cc786[_0xcfce8(0x776)];}),_0x2b7f29[_0xce218d(0xd5b)][_0xce218d(0xd6a)](_0xa34157=>{const _0x1d9b73=_0xce218d,_0x47a1a9=_0x2f4024['find'](_0x2af023=>_0x2af023['id']===_0xa34157['id']);if(_0x47a1a9&&_0x47a1a9[_0x1d9b73(0x2ea)]){const _0x301dfb=_0x47a1a9[_0x1d9b73(0x2ea)][_0x1d9b73(0x435)]||'';_0xa34157[_0x1d9b73(0x2f4)]!==_0x301dfb&&(_0xa34157['avatarFrame']=_0x301dfb,_0x32fafd=!![]);}else typeof _0xa34157[_0x1d9b73(0x2f4)]===_0x1d9b73(0x120c)&&(_0xa34157[_0x1d9b73(0x2f4)]='',_0x32fafd=!![]);});if(_0x32fafd)_0x2a2987[_0xce218d(0xc45)][_0xce218d(0xf36)](_0x2b7f29);}if(!_0x2b7f29['settings'][_0xce218d(0x86)])_0x2b7f29[_0xce218d(0x2ea)][_0xce218d(0x86)]=![];if(!_0x2b7f29[_0xce218d(0x2ea)]['autoMemoryInterval'])_0x2b7f29[_0xce218d(0x2ea)][_0xce218d(0x10da)]=0x14;if(!_0x2b7f29[_0xce218d(0x45b)])_0x2b7f29['longTermMemory']=[];if(!_0x2b7f29['lastMemorySummaryTimestamp'])_0x2b7f29[_0xce218d(0xd8)]=0x0;if(!_0x2b7f29[_0xce218d(0x80b)]){typeof _0x2b7f29[_0xce218d(0x2ea)][_0xce218d(0xdde)]===_0xce218d(0x120c)&&(_0x2b7f29[_0xce218d(0x2ea)][_0xce218d(0xdde)]=!![]);typeof _0x2b7f29[_0xce218d(0x2ea)][_0xce218d(0x907)]===_0xce218d(0x120c)&&(_0x2b7f29['settings'][_0xce218d(0x907)]=![]);if(!_0x2b7f29[_0xce218d(0xbc8)])_0x2b7f29[_0xce218d(0xbc8)]={'text':'在线','lastUpdate':Date['now'](),'isBusy':![]};if(!_0x2b7f29[_0xce218d(0x1cb)])_0x2b7f29[_0xce218d(0x1cb)]={'status':_0xce218d(0xe59),'blockedTimestamp':null,'applicationReason':''};if(!_0x2b7f29['settings']||!_0x2b7f29[_0xce218d(0x2ea)]['aiAvatarLibrary']){if(!_0x2b7f29[_0xce218d(0x2ea)])_0x2b7f29['settings']={};_0x2b7f29[_0xce218d(0x2ea)][_0xce218d(0xfc5)]=[];}if(typeof _0x2b7f29[_0xce218d(0x2ea)][_0xce218d(0xe36)]===_0xce218d(0x120c))_0x2b7f29[_0xce218d(0x2ea)][_0xce218d(0xe36)]=![];if(typeof _0x2b7f29[_0xce218d(0x2ea)][_0xce218d(0x123d)]==='undefined')_0x2b7f29[_0xce218d(0x2ea)][_0xce218d(0x123d)]=0x64;if(typeof _0x2b7f29[_0xce218d(0x2ea)][_0xce218d(0x728)]===_0xce218d(0x120c))_0x2b7f29[_0xce218d(0x2ea)][_0xce218d(0x728)]=0x12c;typeof _0x2b7f29['settings']['injectLatestThought']===_0xce218d(0x120c)&&(_0x2b7f29['settings']['injectLatestThought']=![]);if(typeof _0x2b7f29[_0xce218d(0x70a)]==='undefined')_0x2b7f29[_0xce218d(0x70a)]=_0xce218d(0xda0);if(typeof _0x2b7f29['randomJottings']===_0xce218d(0x120c))_0x2b7f29[_0xce218d(0xb53)]=_0xce218d(0xda0);!Array['isArray'](_0x2b7f29[_0xce218d(0x11e9)])&&(_0x2b7f29['thoughtsHistory']=[]);}return typeof _0x2b7f29[_0xce218d(0x2ea)][_0xce218d(0x818)]==='undefined'&&(_0x2b7f29['settings'][_0xce218d(0x485)]?_0x2b7f29[_0xce218d(0x2ea)][_0xce218d(0x818)]=[_0x2b7f29['settings'][_0xce218d(0x485)]]:_0x2b7f29['settings'][_0xce218d(0x818)]=[],delete _0x2b7f29[_0xce218d(0x2ea)]['stickerCategoryId']),_0x30c9da[_0x2b7f29['id']]=_0x2b7f29,_0x30c9da;},{});const _0x7eb792=[];_0x4375e6[_0x51a08f(0xd6a)](_0xdeb05b=>{const _0x4d25a0=_0x51a08f;if(_0xdeb05b['type']===_0x4d25a0(0xa1f)&&_0xdeb05b[_0x4d25a0(0x43b)]&&!_0xdeb05b[_0x4d25a0(0xd48)]){const _0x589306=_0x2f4024[_0x4d25a0(0xd85)](_0x10a23c=>!_0x10a23c[_0x4d25a0(0x80b)]&&_0x10a23c[_0x4d25a0(0x776)]===_0xdeb05b[_0x4d25a0(0x43b)]);if(_0x589306)_0xdeb05b[_0x4d25a0(0xd48)]=_0x589306['id'],_0x7eb792['push'](_0xdeb05b);else{const _0x2b16c5=_0x2f4024['find'](_0x359c92=>!_0x359c92[_0x4d25a0(0x80b)]&&_0x359c92[_0x4d25a0(0x578)]===_0xdeb05b[_0x4d25a0(0x43b)]);_0x2b16c5&&(_0xdeb05b[_0x4d25a0(0xd48)]=_0x2b16c5['id'],_0x7eb792[_0x4d25a0(0x2d6)](_0xdeb05b));}}}),_0x7eb792[_0x51a08f(0x79b)]>0x0&&await _0x2a2987[_0x51a08f(0x37c)][_0x51a08f(0xee7)](_0x7eb792),_0x12493e[_0x51a08f(0xdd4)]=_0x22aae8||{'id':_0x51a08f(0x2f3),'proxyUrl':'','apiKey':'','model':'','secondaryProxyUrl':'','secondaryApiKey':'','secondaryModel':'','minimaxGroupId':'','minimaxApiKey':'','minimaxModel':_0x51a08f(0x10de)},_0x12493e['userStickers']=_0x1c90c5||[],_0x12493e['worldBooks']=_0x366894||[],_0x5ebb31[_0x51a08f(0xd9f)]=_0x3c1345?.[_0x51a08f(0xd9f)]||[],_0x12493e[_0x51a08f(0x25e)]=_0x3161fb||[],_0x12493e['qzoneSettings']=_0x3ac37c||{'id':_0x51a08f(0x2f3),'nickname':_0x51a08f(0x10d0),'avatar':_0x51a08f(0x116c),'banner':'https://files.catbox.moe/r5heyt.gif'},allFavoriteItems=_0x267c16||[];}async function _0x83d626(){const _0x200cf1=_0x247bea;await _0x2a2987[_0x200cf1(0xba)][_0x200cf1(0xf36)]({'id':'main','playlist':_0x5ebb31['playlist']});}function _0x6c25fd(_0x2beae3){const _0x3e34ba=_0x247bea;if(!_0x2beae3)return'';const _0x380bb0=new Date(_0x2beae3),_0x133576=String(_0x380bb0[_0x3e34ba(0xa75)]())[_0x3e34ba(0x70d)](0x2,'0'),_0x50bff1=String(_0x380bb0[_0x3e34ba(0xa88)]())['padStart'](0x2,'0');return _0x133576+':'+_0x50bff1;}function _0x3ce8f0(_0x4e9988){const _0x597607=_0x247bea,_0x3f1eb9=Date[_0x597607(0x6ee)](),_0x5b8c3e=Math[_0x597607(0xcb5)]((_0x3f1eb9-_0x4e9988)/0x3e8);if(_0x5b8c3e<0x3c)return'刚刚';const _0x33fb0d=Math[_0x597607(0xcb5)](_0x5b8c3e/0x3c);if(_0x33fb0d<0x3c)return _0x33fb0d+_0x597607(0x59f);const _0xa468d6=Math[_0x597607(0xcb5)](_0x33fb0d/0x3c);if(_0xa468d6<0x18)return _0xa468d6+_0x597607(0xf3a);const _0x2c73a0=Math[_0x597607(0xcb5)](_0xa468d6/0x18);if(_0x2c73a0<0x1e)return _0x2c73a0+'天前';const _0x49c2c2=Math['floor'](_0x2c73a0/0x1e);if(_0x49c2c2<0xc)return'大约'+_0x49c2c2+_0x597607(0xbe4);const _0x451c88=Math[_0x597607(0xcb5)](_0x2c73a0/0x16d);return'大约'+_0x451c88+'年前';}function _0x474fa4(_0x57eec4){const _0x5b6759=_0x247bea;if(!_0x57eec4)return'';const _0x38dbe5=new Date(),_0x410d10=new Date(_0x57eec4),_0x5e372a=String(_0x410d10[_0x5b6759(0xa75)]())[_0x5b6759(0x70d)](0x2,'0'),_0x38ec83=String(_0x410d10[_0x5b6759(0xa88)]())[_0x5b6759(0x70d)](0x2,'0'),_0xc81fd9=_0x5e372a+':'+_0x38ec83;if(_0x38dbe5[_0x5b6759(0xc8d)]()===_0x410d10[_0x5b6759(0xc8d)]())return'今天\x20'+_0xc81fd9;const _0x5a36e7=new Date();_0x5a36e7['setDate'](_0x38dbe5['getDate']()-0x1);if(_0x5a36e7['toDateString']()===_0x410d10[_0x5b6759(0xc8d)]())return _0x5b6759(0x5c1)+_0xc81fd9;if(_0x38dbe5[_0x5b6759(0x80d)]()===_0x410d10[_0x5b6759(0x80d)]()){const _0x487404=String(_0x410d10[_0x5b6759(0xf99)]()+0x1),_0x4e4939=String(_0x410d10['getDate']());return _0x487404+'月'+_0x4e4939+'日\x20'+_0xc81fd9;}const _0x8ef619=_0x410d10['getFullYear'](),_0x2a614d=String(_0x410d10[_0x5b6759(0xf99)]()+0x1),_0x5041e8=String(_0x410d10[_0x5b6759(0x6be)]());return _0x8ef619+'年'+_0x2a614d+'月'+_0x5041e8+'日\x20'+_0xc81fd9;}function _0x557da7(){const _0x5e3ccf=_0x247bea,_0x29bbbf=_0x2f5e99();document['getElementById'](_0x5e3ccf(0xfdc))[_0x5e3ccf(0x22a)]=_0x29bbbf[_0x5e3ccf(0x571)],document['getElementById'](_0x5e3ccf(0x720))['value']=_0x29bbbf[_0x5e3ccf(0x2f7)],document[_0x5e3ccf(0xc33)](_0x5e3ccf(0xa0b))[_0x5e3ccf(0x22a)]=_0x29bbbf[_0x5e3ccf(0xeaa)],document[_0x5e3ccf(0xc33)](_0x5e3ccf(0x207))['value']=_0x29bbbf[_0x5e3ccf(0x6e5)],document[_0x5e3ccf(0xc33)](_0x5e3ccf(0xb3a))[_0x5e3ccf(0x22a)]=_0x29bbbf[_0x5e3ccf(0xd0b)],document[_0x5e3ccf(0xc33)](_0x5e3ccf(0x9c3))[_0x5e3ccf(0x22a)]=_0x29bbbf[_0x5e3ccf(0xc4d)],document[_0x5e3ccf(0xc33)](_0x5e3ccf(0xb93))[_0x5e3ccf(0x737)]=_0x29bbbf[_0x5e3ccf(0xbb0)],document[_0x5e3ccf(0xc33)](_0x5e3ccf(0xc9f))['checked']=_0x29bbbf['smea'],document[_0x5e3ccf(0xc33)](_0x5e3ccf(0x11a5))[_0x5e3ccf(0x737)]=_0x29bbbf[_0x5e3ccf(0xd3)],document[_0x5e3ccf(0xc33)](_0x5e3ccf(0x29b))[_0x5e3ccf(0x22a)]=_0x29bbbf[_0x5e3ccf(0x6c9)],document[_0x5e3ccf(0xc33)](_0x5e3ccf(0x2a3))['value']=_0x29bbbf[_0x5e3ccf(0xb59)],document[_0x5e3ccf(0xc33)](_0x5e3ccf(0x5c3))[_0x5e3ccf(0x22a)]=_0x29bbbf['cors_proxy'],document[_0x5e3ccf(0xc33)]('nai-custom-proxy-url')[_0x5e3ccf(0x22a)]=_0x29bbbf[_0x5e3ccf(0xddf)]||'';const _0x5a5bbf=document['getElementById'](_0x5e3ccf(0x86b));_0x5a5bbf[_0x5e3ccf(0x105d)][_0x5e3ccf(0xf44)]=_0x29bbbf[_0x5e3ccf(0xe9e)]===_0x5e3ccf(0x1145)?_0x5e3ccf(0xa20):_0x5e3ccf(0x854);}function _0x15865b(){const _0x4b8fe8=_0x247bea,_0x185c22=document[_0x4b8fe8(0xc33)](_0x4b8fe8(0xa10))[_0x4b8fe8(0x737)],_0x1b14e0=document[_0x4b8fe8(0xc33)](_0x4b8fe8(0x36a))['value'],_0x2fc621=document[_0x4b8fe8(0xc33)](_0x4b8fe8(0x10a4))[_0x4b8fe8(0x22a)][_0x4b8fe8(0x7da)]();localStorage['setItem']('novelai-enabled',_0x185c22),localStorage[_0x4b8fe8(0xec8)](_0x4b8fe8(0x36a),_0x1b14e0),localStorage[_0x4b8fe8(0xec8)](_0x4b8fe8(0x10a4),_0x2fc621);const _0x13db03={'resolution':document[_0x4b8fe8(0xc33)](_0x4b8fe8(0xfdc))[_0x4b8fe8(0x22a)],'steps':parseInt(document['getElementById']('nai-steps')[_0x4b8fe8(0x22a)]),'cfg_scale':parseFloat(document[_0x4b8fe8(0xc33)](_0x4b8fe8(0xa0b))['value']),'sampler':document['getElementById'](_0x4b8fe8(0x207))[_0x4b8fe8(0x22a)],'seed':parseInt(document[_0x4b8fe8(0xc33)](_0x4b8fe8(0xb3a))[_0x4b8fe8(0x22a)]),'uc_preset':parseInt(document[_0x4b8fe8(0xc33)]('nai-uc-preset')[_0x4b8fe8(0x22a)]),'quality_toggle':document[_0x4b8fe8(0xc33)](_0x4b8fe8(0xb93))[_0x4b8fe8(0x737)],'smea':document[_0x4b8fe8(0xc33)](_0x4b8fe8(0xc9f))[_0x4b8fe8(0x737)],'smea_dyn':document[_0x4b8fe8(0xc33)]('nai-smea-dyn')[_0x4b8fe8(0x737)],'default_positive':document[_0x4b8fe8(0xc33)](_0x4b8fe8(0x29b))[_0x4b8fe8(0x22a)],'default_negative':document[_0x4b8fe8(0xc33)](_0x4b8fe8(0x2a3))[_0x4b8fe8(0x22a)],'cors_proxy':document[_0x4b8fe8(0xc33)]('nai-cors-proxy')[_0x4b8fe8(0x22a)],'custom_proxy_url':document['getElementById'](_0x4b8fe8(0x3b6))['value']};localStorage['setItem'](_0x4b8fe8(0x103c),JSON[_0x4b8fe8(0xd27)](_0x13db03));}function _0x5a91a2(){const _0x1a737e=_0x247bea;localStorage[_0x1a737e(0x62f)]('novelai-settings'),_0x557da7(),alert('已恢复默认设置！');}function _0x2f5e99(){const _0x54f13b=_0x247bea,_0x32e3f5={'resolution':_0x54f13b(0x506),'steps':0x1c,'cfg_scale':0x5,'sampler':_0x54f13b(0xea),'seed':-0x1,'uc_preset':0x1,'quality_toggle':!![],'smea':!![],'smea_dyn':![],'default_positive':'masterpiece,\x20best\x20quality,\x201girl,\x20beautiful,\x20detailed\x20face,\x20detailed\x20eyes,\x20long\x20hair,\x20anime\x20style','default_negative':'lowres,\x20bad\x20anatomy,\x20bad\x20hands,\x20text,\x20error,\x20missing\x20fingers,\x20extra\x20digit,\x20fewer\x20digits,\x20cropped,\x20worst\x20quality,\x20low\x20quality,\x20normal\x20quality,\x20jpeg\x20artifacts,\x20signature,\x20watermark,\x20username,\x20blurry','cors_proxy':_0x54f13b(0x5ed),'custom_proxy_url':''},_0x4efa5=localStorage['getItem'](_0x54f13b(0x103c));if(_0x4efa5)try{return{..._0x32e3f5,...JSON[_0x54f13b(0x6b1)](_0x4efa5)};}catch(_0x181fb8){return _0x32e3f5;}return _0x32e3f5;}function _0x12d22d(_0x221a5c){const _0x4ba08a=_0x247bea,_0x2b7575=_0x2f5e99();if(!_0x221a5c||!_0x12493e['chats'][_0x221a5c])return console[_0x4ba08a(0x51f)](_0x4ba08a(0x769)),{'positive':_0x2b7575[_0x4ba08a(0x6c9)],'negative':_0x2b7575[_0x4ba08a(0xb59)],'source':'system'};const _0x3677be=_0x12493e['chats'][_0x221a5c],_0x2f0f30=_0x3677be[_0x4ba08a(0x2ea)][_0x4ba08a(0xbde)]||{};return _0x2f0f30[_0x4ba08a(0xd64)]===_0x4ba08a(0x46a)?(console[_0x4ba08a(0x51f)]('✅\x20NAI提示词：使用角色配置'),console[_0x4ba08a(0x51f)]('\x20\x20\x20正面:',_0x2f0f30[_0x4ba08a(0x55c)]||_0x4ba08a(0x724)),console[_0x4ba08a(0x51f)](_0x4ba08a(0x50d),_0x2f0f30[_0x4ba08a(0x502)]||_0x4ba08a(0x724)),{'positive':_0x2f0f30[_0x4ba08a(0x55c)]||'','negative':_0x2f0f30[_0x4ba08a(0x502)]||'','source':_0x4ba08a(0x46a)}):(console[_0x4ba08a(0x51f)](_0x4ba08a(0x4e1)),console['log'](_0x4ba08a(0x1b4),_0x2b7575[_0x4ba08a(0x6c9)]||_0x4ba08a(0x724)),console[_0x4ba08a(0x51f)](_0x4ba08a(0x50d),_0x2b7575[_0x4ba08a(0xb59)]||_0x4ba08a(0x724)),{'positive':_0x2b7575['default_positive'],'negative':_0x2b7575[_0x4ba08a(0xb59)],'source':'system'});}async function _0x599978(){const _0x38ff4f=_0x247bea,_0x40dd75=document[_0x38ff4f(0xc33)](_0x38ff4f(0x10a4))[_0x38ff4f(0x22a)]['trim'](),_0x12a65f=document[_0x38ff4f(0xc33)](_0x38ff4f(0x36a))[_0x38ff4f(0x22a)],_0x32abcc=document[_0x38ff4f(0xc33)]('nai-test-prompt')[_0x38ff4f(0x22a)][_0x38ff4f(0x7da)]();if(!_0x40dd75){alert(_0x38ff4f(0x90b));return;}if(!_0x32abcc){alert(_0x38ff4f(0xf91));return;}const _0x410b69=_0x2f5e99(),_0x5a0a0e=document[_0x38ff4f(0xc33)](_0x38ff4f(0xff2))[_0x38ff4f(0x22a)][_0x38ff4f(0x7da)](),_0x3ddb41=document[_0x38ff4f(0xc33)](_0x38ff4f(0x1153)),_0x45c226=document[_0x38ff4f(0xc33)](_0x38ff4f(0x6ae)),_0xaa617e=document[_0x38ff4f(0xc33)]('nai-test-error'),_0x25392d=document[_0x38ff4f(0xc33)](_0x38ff4f(0x3a5));_0x3ddb41['style']['display']=_0x38ff4f(0xa20),_0x45c226[_0x38ff4f(0x105d)]['display']=_0x38ff4f(0x854),_0xaa617e[_0x38ff4f(0x105d)][_0x38ff4f(0xf44)]=_0x38ff4f(0x854),_0x25392d[_0x38ff4f(0xfd8)]=!![],_0x25392d['textContent']=_0x38ff4f(0xd34);try{const [_0x17fb97,_0x31ef6f]=_0x410b69['resolution'][_0x38ff4f(0x8d7)]('x')[_0x38ff4f(0x9d5)](Number);let _0x4ca510;_0x12a65f[_0x38ff4f(0x1d4)](_0x38ff4f(0xeaf))?_0x4ca510={'input':_0x32abcc,'model':_0x12a65f,'action':_0x38ff4f(0x1e9),'parameters':{'params_version':0x3,'width':_0x17fb97,'height':_0x31ef6f,'scale':_0x410b69[_0x38ff4f(0xeaa)],'sampler':_0x410b69['sampler'],'steps':_0x410b69[_0x38ff4f(0x2f7)],'seed':_0x410b69[_0x38ff4f(0xd0b)]===-0x1?Math[_0x38ff4f(0xcb5)](Math['random']()*0x2540be3ff):_0x410b69[_0x38ff4f(0xd0b)],'n_samples':0x1,'ucPreset':_0x410b69[_0x38ff4f(0xc4d)],'qualityToggle':_0x410b69[_0x38ff4f(0xbb0)],'autoSmea':![],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':!![],'cfg_rescale':0x0,'noise_schedule':_0x38ff4f(0x128c),'legacy_v3_extend':![],'skip_cfg_above_sigma':null,'use_coords':![],'legacy_uc':![],'normalize_reference_strength_multiple':!![],'inpaintImg2ImgStrength':0x1,'characterPrompts':[],'v4_prompt':{'caption':{'base_caption':_0x32abcc,'char_captions':[]},'use_coords':![],'use_order':!![]},'v4_negative_prompt':{'caption':{'base_caption':_0x5a0a0e,'char_captions':[]},'legacy_uc':![]},'negative_prompt':_0x5a0a0e,'deliberate_euler_ancestral_bug':![],'prefer_brownian':!![]}}:_0x4ca510={'input':_0x32abcc,'model':_0x12a65f,'action':_0x38ff4f(0x1e9),'parameters':{'width':_0x17fb97,'height':_0x31ef6f,'scale':_0x410b69[_0x38ff4f(0xeaa)],'sampler':_0x410b69[_0x38ff4f(0x6e5)],'steps':_0x410b69[_0x38ff4f(0x2f7)],'seed':_0x410b69[_0x38ff4f(0xd0b)]===-0x1?Math[_0x38ff4f(0xcb5)](Math[_0x38ff4f(0xa11)]()*0x2540be3ff):_0x410b69['seed'],'n_samples':0x1,'ucPreset':_0x410b69[_0x38ff4f(0xc4d)],'qualityToggle':_0x410b69['quality_toggle'],'sm':_0x410b69['smea'],'sm_dyn':_0x410b69[_0x38ff4f(0xd3)],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':![],'cfg_rescale':0x0,'noise_schedule':_0x38ff4f(0xae0),'negative_prompt':_0x5a0a0e}};console[_0x38ff4f(0x51f)](_0x38ff4f(0x2b3)),console['log']('📊\x20使用模型:',_0x12a65f),console[_0x38ff4f(0x51f)](_0x38ff4f(0xc27),JSON[_0x38ff4f(0xd27)](_0x4ca510,null,0x2));let _0x27fd65;_0x12a65f[_0x38ff4f(0x1d4)](_0x38ff4f(0xeaf))?_0x27fd65=_0x38ff4f(0x9b2):_0x27fd65=_0x38ff4f(0x76);let _0x11dbaf=_0x410b69[_0x38ff4f(0xe9e)];_0x11dbaf==='custom'&&(_0x11dbaf=_0x410b69[_0x38ff4f(0xddf)]||'');_0x11dbaf&&_0x11dbaf!==''&&(_0x27fd65=_0x11dbaf+encodeURIComponent(_0x27fd65));const _0x45042e=/Chrome/['test'](navigator[_0x38ff4f(0x8df)])&&!/Edg/['test'](navigator['userAgent']);let _0x5ea41e={'method':_0x38ff4f(0x90),'headers':{'Content-Type':'application/json','Authorization':_0x38ff4f(0xf20)+_0x40dd75},'body':JSON[_0x38ff4f(0xd27)](_0x4ca510)};if(_0x45042e){console[_0x38ff4f(0x51f)](_0x38ff4f(0x76d));const _0x5d4ee9={};for(const [_0x105f75,_0x50ad62]of Object[_0x38ff4f(0x43e)](_0x5ea41e[_0x38ff4f(0x15f)])){_0x5d4ee9[_0x105f75]=_0x50ad62[_0x38ff4f(0xc12)](/[^\x00-\xFF]/g,'');}_0x5ea41e[_0x38ff4f(0x15f)]=_0x5d4ee9;}const _0x4ca8ac=await fetch(_0x27fd65,_0x5ea41e);console['log'](_0x38ff4f(0x8c3),_0x4ca8ac[_0x38ff4f(0xbc8)]),console[_0x38ff4f(0x51f)](_0x38ff4f(0xaac),[..._0x4ca8ac[_0x38ff4f(0x15f)][_0x38ff4f(0x43e)]()]);if(!_0x4ca8ac['ok']){const _0x5b53db=await _0x4ca8ac[_0x38ff4f(0x996)]();console[_0x38ff4f(0x4d9)](_0x38ff4f(0x240),_0x5b53db);throw new Error(_0x38ff4f(0x60f)+_0x4ca8ac['status']+_0x38ff4f(0x3ec)+_0x5b53db);}const _0x267f40=_0x4ca8ac[_0x38ff4f(0x15f)][_0x38ff4f(0xec0)](_0x38ff4f(0x590));console[_0x38ff4f(0x51f)](_0x38ff4f(0x3c6),_0x267f40);let _0x5b2b67;if(_0x267f40&&_0x267f40[_0x38ff4f(0x1d4)](_0x38ff4f(0x1024))){console[_0x38ff4f(0x51f)]('检测到\x20SSE\x20流式响应，开始解析...'),_0x3ddb41[_0x38ff4f(0x11b0)]=_0x38ff4f(0x439);const _0x116a58=await _0x4ca8ac['text']();console[_0x38ff4f(0x51f)](_0x38ff4f(0x50c),_0x116a58[_0x38ff4f(0x79b)]);const _0x184f77=_0x116a58[_0x38ff4f(0x7da)]()['split']('\x0a');let _0x1233c7=null;for(let _0x45fd44=_0x184f77[_0x38ff4f(0x79b)]-0x1;_0x45fd44>=0x0;_0x45fd44--){const _0x513885=_0x184f77[_0x45fd44][_0x38ff4f(0x7da)]();if(_0x513885['startsWith']('data:\x20')&&_0x513885!==_0x38ff4f(0x11d9)){const _0x394ebb=_0x513885[_0x38ff4f(0x1033)](0x6);try{const _0x1c8751=JSON['parse'](_0x394ebb);if(_0x1c8751[_0x38ff4f(0x792)]===_0x38ff4f(0x5c7)&&_0x1c8751[_0x38ff4f(0x695)]){_0x1233c7=_0x1c8751['image'],console[_0x38ff4f(0x51f)](_0x38ff4f(0x503));break;}if(_0x1c8751[_0x38ff4f(0xa78)]){_0x1233c7=_0x1c8751[_0x38ff4f(0xa78)],console[_0x38ff4f(0x51f)](_0x38ff4f(0x339));break;}if(_0x1c8751['image']){_0x1233c7=_0x1c8751[_0x38ff4f(0x695)],console[_0x38ff4f(0x51f)](_0x38ff4f(0x5c0));break;}}catch(_0x2ff941){_0x1233c7=_0x394ebb,console[_0x38ff4f(0x51f)](_0x38ff4f(0x1e8));break;}}}if(!_0x1233c7)throw new Error(_0x38ff4f(0x6a5));const _0x219b9c=_0x1233c7[_0x38ff4f(0xece)]('iVBORw0KGgo'),_0x41dbf0=_0x1233c7[_0x38ff4f(0xece)](_0x38ff4f(0x123c));if(_0x219b9c||_0x41dbf0){console[_0x38ff4f(0x51f)]('✅\x20检测到直接的图片\x20base64\x20数据\x20(PNG/JPEG)');const _0x21f824=atob(_0x1233c7),_0x3ed3bc=new Uint8Array(_0x21f824['length']);for(let _0x3f344b=0x0;_0x3f344b<_0x21f824[_0x38ff4f(0x79b)];_0x3f344b++){_0x3ed3bc[_0x3f344b]=_0x21f824['charCodeAt'](_0x3f344b);}const _0x26584e=new Blob([_0x3ed3bc],{'type':_0x219b9c?'image/png':_0x38ff4f(0x614)});console[_0x38ff4f(0x51f)](_0x38ff4f(0x426),_0x26584e['size']);const _0x3290ef=URL[_0x38ff4f(0xca2)](_0x26584e);document[_0x38ff4f(0xc33)]('nai-result-image')[_0x38ff4f(0x87b)]=_0x3290ef,_0x3ddb41[_0x38ff4f(0x105d)][_0x38ff4f(0xf44)]=_0x38ff4f(0x854),_0x45c226[_0x38ff4f(0x105d)]['display']='block',console[_0x38ff4f(0x51f)]('✅\x20图片显示成功！🎨');return;}console[_0x38ff4f(0x51f)](_0x38ff4f(0x257));const _0x5ba0ee=atob(_0x1233c7),_0x3667f4=new Uint8Array(_0x5ba0ee[_0x38ff4f(0x79b)]);for(let _0x485cf3=0x0;_0x485cf3<_0x5ba0ee[_0x38ff4f(0x79b)];_0x485cf3++){_0x3667f4[_0x485cf3]=_0x5ba0ee[_0x38ff4f(0xe1)](_0x485cf3);}_0x5b2b67=new Blob([_0x3667f4]),console[_0x38ff4f(0x51f)](_0x38ff4f(0xc2f),_0x5b2b67[_0x38ff4f(0x57e)]);}else _0x5b2b67=await _0x4ca8ac['blob'](),console[_0x38ff4f(0x51f)](_0x38ff4f(0xed6),_0x5b2b67['type'],_0x38ff4f(0x317),_0x5b2b67['size']);try{if(typeof JSZip===_0x38ff4f(0x120c))throw new Error(_0x38ff4f(0x128d));_0x3ddb41[_0x38ff4f(0x11b0)]=_0x38ff4f(0x245);const _0x117ade=await JSZip[_0x38ff4f(0x1069)](_0x5b2b67);console[_0x38ff4f(0x51f)](_0x38ff4f(0xdb),Object['keys'](_0x117ade['files']));let _0x14dc98=null;for(let _0x40774b in _0x117ade['files']){if(_0x40774b['match'](/\.(png|jpg|jpeg|webp)$/i)){_0x14dc98=_0x117ade['files'][_0x40774b],console['log'](_0x38ff4f(0x736),_0x40774b);break;}}if(!_0x14dc98)throw new Error(_0x38ff4f(0xb75));const _0x3e7cd5=await _0x14dc98[_0x38ff4f(0xc52)](_0x38ff4f(0xed));console[_0x38ff4f(0x51f)]('提取的图片大小:',_0x3e7cd5[_0x38ff4f(0x57e)]);const _0x3a096a=URL[_0x38ff4f(0xca2)](_0x3e7cd5);console[_0x38ff4f(0x51f)]('生成的图片URL:',_0x3a096a),document[_0x38ff4f(0xc33)]('nai-result-image')[_0x38ff4f(0x87b)]=_0x3a096a,_0x3ddb41['style'][_0x38ff4f(0xf44)]=_0x38ff4f(0x854),_0x45c226[_0x38ff4f(0x105d)][_0x38ff4f(0xf44)]=_0x38ff4f(0xa20);}catch(_0x12edec){console[_0x38ff4f(0x4d9)](_0x38ff4f(0xd95),_0x12edec),console[_0x38ff4f(0x51f)](_0x38ff4f(0x85e));if(_0x5b2b67[_0x38ff4f(0x52a)][_0x38ff4f(0xece)](_0x38ff4f(0x10b2))){const _0x46c3b6=URL[_0x38ff4f(0xca2)](_0x5b2b67);document[_0x38ff4f(0xc33)](_0x38ff4f(0x764))[_0x38ff4f(0x87b)]=_0x46c3b6,_0x3ddb41[_0x38ff4f(0x105d)][_0x38ff4f(0xf44)]=_0x38ff4f(0x854),_0x45c226[_0x38ff4f(0x105d)][_0x38ff4f(0xf44)]=_0x38ff4f(0xa20);}else throw new Error(_0x38ff4f(0x722)+_0x12edec['message']);}}catch(_0x453320){console['error'](_0x38ff4f(0x1057),_0x453320),_0x3ddb41[_0x38ff4f(0x105d)]['display']=_0x38ff4f(0x854),_0xaa617e[_0x38ff4f(0x105d)]['display']='block',_0xaa617e[_0x38ff4f(0x11b0)]=_0x38ff4f(0x1c0)+_0x453320[_0x38ff4f(0xf93)];}finally{_0x25392d['disabled']=![],_0x25392d[_0x38ff4f(0x11b0)]=_0x38ff4f(0x7d0);}}function _0x451557(_0x414125,_0x24c98e){const _0x4ee5b6=_0x247bea;_0x52e066(),clearTimeout(_0x4f5f7d);const _0x5eb4ce=_0x12493e[_0x4ee5b6(0xc45)][_0x414125];if(!_0x5eb4ce)return;const _0x3b699c=document['getElementById'](_0x4ee5b6(0x495));document['getElementById'](_0x4ee5b6(0xba2))[_0x4ee5b6(0x87b)]=_0x5eb4ce[_0x4ee5b6(0x2ea)][_0x4ee5b6(0x18e)]||_0x5eb4ce[_0x4ee5b6(0x2ea)][_0x4ee5b6(0x78a)]||_0x190acc,document[_0x4ee5b6(0xc33)](_0x4ee5b6(0x1090))[_0x4ee5b6(0x977)]('.name')['textContent']=_0x5eb4ce[_0x4ee5b6(0x578)],document[_0x4ee5b6(0xc33)](_0x4ee5b6(0x1090))['querySelector'](_0x4ee5b6(0xc96))[_0x4ee5b6(0x11b0)]=_0x24c98e,_0x3b699c[_0x4ee5b6(0x10d3)][_0x4ee5b6(0x2c7)]('visible'),void _0x3b699c[_0x4ee5b6(0xeba)],_0x3b699c[_0x4ee5b6(0x10d3)][_0x4ee5b6(0xb9)](_0x4ee5b6(0x143));const _0x5be11c=_0x3b699c[_0x4ee5b6(0xbc5)](!![]);_0x3b699c[_0x4ee5b6(0x1053)][_0x4ee5b6(0xcaa)](_0x5be11c,_0x3b699c),_0x5be11c[_0x4ee5b6(0x205)](_0x4ee5b6(0x335),()=>{const _0x5a85c0=_0x4ee5b6;_0x157ff1(_0x414125),_0x5be11c[_0x5a85c0(0x10d3)][_0x5a85c0(0x2c7)](_0x5a85c0(0x143));}),_0x4f5f7d=setTimeout(()=>{const _0x55d3bb=_0x4ee5b6;_0x5be11c[_0x55d3bb(0x10d3)][_0x55d3bb(0x2c7)](_0x55d3bb(0x143));},0xfa0),_0x1f4bf2();}function _0x53e2ba(){const _0x303444=_0x247bea,_0x5b94bf=new Date(),_0x53a582=_0x5b94bf[_0x303444(0xdca)]('zh-CN',{'hour':_0x303444(0x55b),'minute':_0x303444(0x55b)}),_0x244211=_0x5b94bf[_0x303444(0x11f9)](_0x303444(0x770),{'weekday':'long','month':_0x303444(0x330),'day':_0x303444(0xb4d)});document[_0x303444(0xc33)](_0x303444(0xc55))[_0x303444(0x11b0)]=_0x53a582;}function _0x4c5aa1(_0x39d9ec){const _0x451fd3=_0x247bea,_0x3ef601=_0x39d9ec['trim']();if(_0x3ef601[_0x451fd3(0xece)]('[')&&_0x3ef601['endsWith'](']'))try{const _0x1cbb88=JSON['parse'](_0x3ef601);if(Array[_0x451fd3(0x621)](_0x1cbb88))return console['log'](_0x451fd3(0x237)),_0x1cbb88;}catch(_0x192a11){console['warn'](_0x451fd3(0x636));}const _0x2c240f=_0x3ef601[_0x451fd3(0x1242)](/{[^{}]*}/g);if(_0x2c240f){const _0x47d0f4=[];for(const _0x24e10f of _0x2c240f){try{const _0x2eda6b=JSON[_0x451fd3(0x6b1)](_0x24e10f);_0x47d0f4['push'](_0x2eda6b);}catch(_0x785d26){console['warn'](_0x451fd3(0xdb8),_0x24e10f);}}if(_0x47d0f4[_0x451fd3(0x79b)]>0x0)return console[_0x451fd3(0x51f)](_0x451fd3(0xcd8)),_0x47d0f4;}return console[_0x451fd3(0x4d9)]('所有解析方案均失败！将返回原始文本。'),[{'type':'text','content':_0x39d9ec}];}function _0x2e4d44(_0x44aa8d=new Date()){const _0x561b58=_0x247bea,_0x25b420=_0x44aa8d[_0x561b58(0xa75)]();if(_0x25b420>=0x0&&_0x25b420<0x5)return'凌晨';else{if(_0x25b420>=0x5&&_0x25b420<0x9)return'早上';else{if(_0x25b420>=0x9&&_0x25b420<0xd)return'上午';else{if(_0x25b420>=0xd&&_0x25b420<0x12)return'下午';else{if(_0x25b420>=0x12&&_0x25b420<0x18)return'晚上';}}}}return'现在';}async function _0x1eeff1(){const _0x5784b5=_0x247bea,_0x3fbd01=document['getElementById'](_0x5784b5(0x7ee));_0x3fbd01['innerHTML']=_0x5784b5(0x1204);const _0x426971=await _0x2a2987[_0x5784b5(0x182)][_0x5784b5(0xf15)]();_0x426971[_0x5784b5(0xd6a)](_0x19eca4=>{const _0x25ab81=_0x5784b5,_0x3406a0=document['createElement'](_0x25ab81(0x2f6));_0x3406a0[_0x25ab81(0x22a)]=_0x19eca4['id'],_0x3406a0[_0x25ab81(0x11b0)]=_0x19eca4[_0x25ab81(0x578)],_0x3fbd01[_0x25ab81(0xf77)](_0x3406a0);});const _0x1e4a46=_0x12493e[_0x5784b5(0xdd4)];let _0x5df83d=null;for(const _0x8a13a5 of _0x426971){if(_0x8a13a5[_0x5784b5(0x872)]===_0x1e4a46[_0x5784b5(0x872)]&&_0x8a13a5['apiKey']===_0x1e4a46[_0x5784b5(0xb57)]&&_0x8a13a5[_0x5784b5(0xd6d)]===_0x1e4a46[_0x5784b5(0xd6d)]&&_0x8a13a5['secondaryProxyUrl']===_0x1e4a46[_0x5784b5(0x246)]&&_0x8a13a5[_0x5784b5(0xbd3)]===_0x1e4a46[_0x5784b5(0xbd3)]&&_0x8a13a5[_0x5784b5(0x479)]===_0x1e4a46[_0x5784b5(0x479)]&&(_0x8a13a5[_0x5784b5(0x7f)]||'')===(_0x1e4a46['minimaxGroupId']||'')&&(_0x8a13a5[_0x5784b5(0xed2)]||'')===(_0x1e4a46[_0x5784b5(0xed2)]||'')&&(_0x8a13a5[_0x5784b5(0x433)]||_0x5784b5(0x10de))===(_0x1e4a46[_0x5784b5(0x433)]||_0x5784b5(0x10de))){_0x5df83d=_0x8a13a5['id'];break;}}_0x5df83d?_0x3fbd01[_0x5784b5(0x22a)]=_0x5df83d:_0x3fbd01['value']=_0x5784b5(0x76a);}async function _0x30dbd0(){const _0x597dae=_0x247bea,_0x1ea4cf=document[_0x597dae(0xc33)]('api-preset-select'),_0x519924=parseInt(_0x1ea4cf[_0x597dae(0x22a)]);if(isNaN(_0x519924))return;const _0x58a8f8=await _0x2a2987[_0x597dae(0x182)][_0x597dae(0xec0)](_0x519924);_0x58a8f8&&(_0x12493e[_0x597dae(0xdd4)]={'id':_0x597dae(0x2f3),'proxyUrl':_0x58a8f8[_0x597dae(0x872)],'apiKey':_0x58a8f8[_0x597dae(0xb57)],'model':_0x58a8f8[_0x597dae(0xd6d)],'secondaryProxyUrl':_0x58a8f8['secondaryProxyUrl'],'secondaryApiKey':_0x58a8f8[_0x597dae(0xbd3)],'secondaryModel':_0x58a8f8[_0x597dae(0x479)],'minimaxGroupId':_0x58a8f8[_0x597dae(0x7f)],'minimaxApiKey':_0x58a8f8[_0x597dae(0xed2)],'minimaxModel':_0x58a8f8['minimaxModel']},await _0x2a2987[_0x597dae(0xdd4)]['put'](_0x12493e[_0x597dae(0xdd4)]),_0x3ef240(),document[_0x597dae(0xc33)](_0x597dae(0x8c8))[_0x597dae(0x335)](),_0x58a8f8[_0x597dae(0x246)]&&_0x58a8f8[_0x597dae(0xbd3)]&&document[_0x597dae(0xc33)]('fetch-secondary-models-btn')[_0x597dae(0x335)](),alert(_0x597dae(0xc79)+_0x58a8f8['name']+'”'));}async function _0x1f8d9f(){const _0x4ee6e4=_0x247bea,_0x37963b=await _0x1ca09c(_0x4ee6e4(0x693),'请输入预设名称');if(!_0x37963b||!_0x37963b[_0x4ee6e4(0x7da)]())return;const _0x1243bf={'name':_0x37963b[_0x4ee6e4(0x7da)](),'proxyUrl':document[_0x4ee6e4(0xc33)](_0x4ee6e4(0xedb))['value']['trim'](),'apiKey':document[_0x4ee6e4(0xc33)]('api-key')[_0x4ee6e4(0x22a)][_0x4ee6e4(0x7da)](),'model':document['getElementById'](_0x4ee6e4(0x1a8))[_0x4ee6e4(0x22a)],'secondaryProxyUrl':document['getElementById'](_0x4ee6e4(0x98d))[_0x4ee6e4(0x22a)][_0x4ee6e4(0x7da)](),'secondaryApiKey':document[_0x4ee6e4(0xc33)](_0x4ee6e4(0xcad))[_0x4ee6e4(0x22a)][_0x4ee6e4(0x7da)](),'secondaryModel':document[_0x4ee6e4(0xc33)](_0x4ee6e4(0x1fc))['value'],'minimaxGroupId':document['getElementById'](_0x4ee6e4(0x169))[_0x4ee6e4(0x22a)]['trim'](),'minimaxApiKey':document[_0x4ee6e4(0xc33)](_0x4ee6e4(0xc56))[_0x4ee6e4(0x22a)][_0x4ee6e4(0x7da)](),'minimaxModel':document[_0x4ee6e4(0xc33)]('minimax-model-select')[_0x4ee6e4(0x22a)]},_0x590576=await _0x2a2987['apiPresets']['where']('name')['equals'](_0x1243bf[_0x4ee6e4(0x578)])[_0x4ee6e4(0x4e3)]();if(_0x590576){const _0x324283=await _0x270512('覆盖预设',_0x4ee6e4(0xc85)+_0x1243bf['name']+_0x4ee6e4(0xeb5),{'confirmButtonClass':'btn-danger'});if(!_0x324283)return;_0x1243bf['id']=_0x590576['id'];}await _0x2a2987[_0x4ee6e4(0x182)][_0x4ee6e4(0xf36)](_0x1243bf),await _0x1eeff1(),alert(_0x4ee6e4(0x9c9));}async function _0x5d821d(){const _0x1e3729=_0x247bea,_0x5520cd=document['getElementById'](_0x1e3729(0x7ee)),_0x5843d1=parseInt(_0x5520cd['value']);if(isNaN(_0x5843d1)){alert(_0x1e3729(0x954));return;}const _0x5a299c=await _0x2a2987[_0x1e3729(0x182)][_0x1e3729(0xec0)](_0x5843d1);if(!_0x5a299c)return;const _0x24935f=await _0x270512(_0x1e3729(0x5a0),_0x1e3729(0x11e0)+_0x5a299c[_0x1e3729(0x578)]+_0x1e3729(0x3be),{'confirmButtonClass':_0x1e3729(0xa2)});_0x24935f&&(await _0x2a2987[_0x1e3729(0x182)][_0x1e3729(0x9ea)](_0x5843d1),await _0x1eeff1(),alert(_0x1e3729(0x733)));}function _0x3ef240(){const _0x4b36b0=_0x247bea;document[_0x4b36b0(0xc33)](_0x4b36b0(0xedb))[_0x4b36b0(0x22a)]=_0x12493e[_0x4b36b0(0xdd4)][_0x4b36b0(0x872)]||'',document[_0x4b36b0(0xc33)](_0x4b36b0(0x969))[_0x4b36b0(0x22a)]=_0x12493e[_0x4b36b0(0xdd4)]['apiKey']||'',document[_0x4b36b0(0xc33)]('secondary-proxy-url')[_0x4b36b0(0x22a)]=_0x12493e['apiConfig'][_0x4b36b0(0x246)]||'',document[_0x4b36b0(0xc33)](_0x4b36b0(0xcad))[_0x4b36b0(0x22a)]=_0x12493e[_0x4b36b0(0xdd4)][_0x4b36b0(0xbd3)]||'',document[_0x4b36b0(0xc33)](_0x4b36b0(0xfca))[_0x4b36b0(0x737)]=_0x12493e[_0x4b36b0(0x10f6)]['enableBackgroundActivity']||![],document[_0x4b36b0(0xc33)](_0x4b36b0(0xeb7))[_0x4b36b0(0x22a)]=_0x12493e[_0x4b36b0(0x10f6)]['backgroundActivityInterval']||0x3c,document[_0x4b36b0(0xc33)](_0x4b36b0(0x5b2))[_0x4b36b0(0x22a)]=_0x12493e[_0x4b36b0(0x10f6)][_0x4b36b0(0x127f)]||0x1,document['getElementById'](_0x4b36b0(0x702))[_0x4b36b0(0x737)]=_0x12493e['globalSettings']['enableAiDrawing'],document[_0x4b36b0(0xc33)](_0x4b36b0(0xe48))[_0x4b36b0(0x22a)]=_0x12493e['globalSettings']['chatRenderWindow']||0x32,document[_0x4b36b0(0xc33)](_0x4b36b0(0xbc))['value']=_0x12493e[_0x4b36b0(0x10f6)]['chatListRenderWindow']||0x1e;const _0x42e493=document[_0x4b36b0(0xc33)](_0x4b36b0(0xc64)),_0x416c63=document[_0x4b36b0(0xc33)]('api-temperature-value'),_0x507871=_0x12493e[_0x4b36b0(0x10f6)][_0x4b36b0(0xd52)]||0.8;_0x42e493[_0x4b36b0(0x22a)]=_0x507871,_0x416c63[_0x4b36b0(0x11b0)]=_0x507871,document[_0x4b36b0(0xc33)](_0x4b36b0(0x169))['value']=_0x12493e[_0x4b36b0(0xdd4)]['minimaxGroupId']||'',document[_0x4b36b0(0xc33)](_0x4b36b0(0xc56))[_0x4b36b0(0x22a)]=_0x12493e[_0x4b36b0(0xdd4)]['minimaxApiKey']||'',document[_0x4b36b0(0xc33)]('minimax-model-select')[_0x4b36b0(0x22a)]=_0x12493e[_0x4b36b0(0xdd4)][_0x4b36b0(0x433)]||_0x4b36b0(0x10de);const _0x18206b=localStorage[_0x4b36b0(0x7bb)](_0x4b36b0(0x3eb))===_0x4b36b0(0xa6f),_0x42c291=localStorage[_0x4b36b0(0x7bb)]('novelai-model')||'nai-diffusion-4-5-full',_0x1ae735=localStorage[_0x4b36b0(0x7bb)](_0x4b36b0(0x10a4))||'';document[_0x4b36b0(0xc33)]('novelai-switch')['checked']=_0x18206b,document[_0x4b36b0(0xc33)]('novelai-model')[_0x4b36b0(0x22a)]=_0x42c291,document[_0x4b36b0(0xc33)](_0x4b36b0(0x10a4))[_0x4b36b0(0x22a)]=_0x1ae735,document[_0x4b36b0(0xc33)]('novelai-details')[_0x4b36b0(0x105d)][_0x4b36b0(0xf44)]=_0x18206b?_0x4b36b0(0xa20):_0x4b36b0(0x854),_0x1eeff1(),_0x1aa70a();}window[_0x247bea(0x7c7)]=_0x3ef240;async function _0xd1839b(){const _0x5e5b82=_0x247bea,_0x58a014=document[_0x5e5b82(0xc33)]('npc-list');_0x58a014['innerHTML']='';const _0x11dad5=await _0x2a2987[_0x5e5b82(0xc61)][_0x5e5b82(0xf15)]();if(_0x11dad5[_0x5e5b82(0x79b)]===0x0){_0x58a014[_0x5e5b82(0x102a)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有创建任何NPC，<br>点击右上角“+”添加第一个吧！</p>';return;}_0x11dad5[_0x5e5b82(0xd6a)](_0x4f0cf8=>{const _0x49b953=_0x5e5b82,_0x337d0a=document[_0x49b953(0x1292)](_0x49b953(0x58c));_0x337d0a[_0x49b953(0x84)]=_0x49b953(0x56b),_0x337d0a[_0x49b953(0x85)][_0x49b953(0x29c)]=_0x4f0cf8['id'],_0x337d0a['innerHTML']=_0x49b953(0xce7)+(_0x4f0cf8[_0x49b953(0xbac)]||_0x5b9dd3)+'\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22name-line\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x4f0cf8[_0x49b953(0x578)]+_0x49b953(0x2ad)+_0x4f0cf8[_0x49b953(0x421)][_0x49b953(0x1033)](0x0,0x1e)+'...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x337d0a[_0x49b953(0x205)](_0x49b953(0x335),()=>_0x4e0128(_0x4f0cf8['id'])),_0x29b870(_0x337d0a,async()=>{await _0x498616(_0x4f0cf8['id']);}),_0x58a014['appendChild'](_0x337d0a);});}async function _0x4e0128(_0x4be526=null){const _0x146f3c=_0x247bea;editingNpcId=_0x4be526;const _0x5e6d90=document[_0x146f3c(0xc33)](_0x146f3c(0x1190)),_0x55f55b=document[_0x146f3c(0xc33)](_0x146f3c(0xa74)),_0xdcee23=document[_0x146f3c(0xc33)](_0x146f3c(0xc9b)),_0x4928af=document[_0x146f3c(0xc33)]('npc-persona-input'),_0x35d4a7=document[_0x146f3c(0xc33)](_0x146f3c(0x388)),_0x34fb1e=document[_0x146f3c(0xc33)](_0x146f3c(0x7af)),_0x1312f9=document[_0x146f3c(0xc33)](_0x146f3c(0xbab)),_0x296c40=document['getElementById'](_0x146f3c(0x5f5));_0x34fb1e[_0x146f3c(0x102a)]='',_0x34fb1e['innerHTML']+='<label><input\x20type=\x22checkbox\x22\x20value=\x22user\x22>\x20'+(_0x12493e[_0x146f3c(0x76c)][_0x146f3c(0x66a)]||'我')+'\x20(用户)</label>',Object[_0x146f3c(0xd28)](_0x12493e[_0x146f3c(0xc45)])[_0x146f3c(0x1054)](_0x87b35b=>!_0x87b35b[_0x146f3c(0x80b)])[_0x146f3c(0xd6a)](_0x6fb668=>{const _0x3da9e5=_0x146f3c;_0x34fb1e['innerHTML']+=_0x3da9e5(0xa55)+_0x6fb668['id']+'\x22>\x20'+_0x6fb668[_0x3da9e5(0x578)]+_0x3da9e5(0xbca);});if(_0x4be526){_0x55f55b[_0x146f3c(0x11b0)]=_0x146f3c(0x11aa);const _0x372006=await _0x2a2987[_0x146f3c(0xc61)][_0x146f3c(0xec0)](_0x4be526);_0x372006&&(_0xdcee23[_0x146f3c(0x22a)]=_0x372006[_0x146f3c(0x578)],_0x4928af[_0x146f3c(0x22a)]=_0x372006[_0x146f3c(0x421)],_0x35d4a7[_0x146f3c(0x87b)]=_0x372006[_0x146f3c(0xbac)]||_0x5b9dd3,_0x1312f9[_0x146f3c(0x737)]=_0x372006[_0x146f3c(0xdde)]!==![],_0x296c40[_0x146f3c(0x22a)]=_0x372006['actionCooldownMinutes']||0xf,_0x372006[_0x146f3c(0x83d)]&&Array[_0x146f3c(0x621)](_0x372006[_0x146f3c(0x83d)])&&_0x372006['associatedWith'][_0x146f3c(0xd6a)](_0xabfa5a=>{const _0x1c8653=_0x146f3c,_0x2a5b3f=_0x34fb1e['querySelector'](_0x1c8653(0x122f)+_0xabfa5a+'\x22]');if(_0x2a5b3f)_0x2a5b3f[_0x1c8653(0x737)]=!![];}));}else{_0x55f55b['textContent']='添加\x20NPC',_0xdcee23[_0x146f3c(0x22a)]='',_0x4928af[_0x146f3c(0x22a)]='',_0x35d4a7[_0x146f3c(0x87b)]=_0x5b9dd3,_0x1312f9[_0x146f3c(0x737)]=!![],_0x296c40['value']=0xf;const _0x468ced=_0x34fb1e['querySelector'](_0x146f3c(0x1265));if(_0x468ced)_0x468ced[_0x146f3c(0x737)]=!![];}_0x5e6d90[_0x146f3c(0x10d3)][_0x146f3c(0xb9)]('visible');}async function _0x1ccd2f(){const _0x4d8e17=_0x247bea,_0x50c2df=document[_0x4d8e17(0xc33)](_0x4d8e17(0xc9b))[_0x4d8e17(0x22a)][_0x4d8e17(0x7da)](),_0x5b6ea8=document[_0x4d8e17(0xc33)](_0x4d8e17(0xee5))[_0x4d8e17(0x22a)][_0x4d8e17(0x7da)]();if(!_0x50c2df||!_0x5b6ea8){alert(_0x4d8e17(0x87e));return;}const _0x5a830a=Array[_0x4d8e17(0x301)](document[_0x4d8e17(0x67a)]('#npc-association-list\x20input:checked'))[_0x4d8e17(0x9d5)](_0x37e733=>_0x37e733['value']),_0x492f11=document[_0x4d8e17(0xc33)](_0x4d8e17(0xbab))[_0x4d8e17(0x737)],_0x239ace=parseInt(document[_0x4d8e17(0xc33)]('npc-action-cooldown-input')[_0x4d8e17(0x22a)])||0xf,_0x1d3d16={'name':_0x50c2df,'persona':_0x5b6ea8,'avatar':document[_0x4d8e17(0xc33)](_0x4d8e17(0x388))[_0x4d8e17(0x87b)],'associatedWith':_0x5a830a,'enableBackgroundActivity':_0x492f11,'actionCooldownMinutes':_0x239ace};if(editingNpcId)await _0x2a2987['npcs'][_0x4d8e17(0xb07)](editingNpcId,_0x1d3d16);else{const _0x37ebec=await _0x2a2987['npcs']['add'](_0x1d3d16);if(_0x375377&&_0x12493e[_0x4d8e17(0x7bc)]){const _0x577414=_0x12493e['chats'][_0x12493e['activeChatId']];_0x577414['isGroup']&&(_0x577414['members'][_0x4d8e17(0x2d6)]({'id':_0x4d8e17(0xb90)+_0x37ebec,'originalName':_0x50c2df,'groupNickname':_0x50c2df,'persona':_0x5b6ea8,'avatar':_0x1d3d16[_0x4d8e17(0xbac)],'isNpc':!![]}),await _0x2a2987[_0x4d8e17(0xc45)][_0x4d8e17(0xf36)](_0x577414));}}document['getElementById']('npc-editor-modal')[_0x4d8e17(0x10d3)][_0x4d8e17(0x2c7)](_0x4d8e17(0x143)),_0x375377?(_0x375377=![],_0x2d6c16()):await _0xd1839b();}async function _0x498616(_0x42b3ef){const _0x7a4d14=_0x247bea,_0x1cf47b=await _0x2a2987[_0x7a4d14(0xc61)][_0x7a4d14(0xec0)](_0x42b3ef);if(!_0x1cf47b)return;const _0x1ad31e=await _0x270512('删除NPC',_0x7a4d14(0x2ce)+_0x1cf47b[_0x7a4d14(0x578)]+_0x7a4d14(0x3be),{'confirmButtonClass':_0x7a4d14(0xa2)});_0x1ad31e&&(await _0x2a2987[_0x7a4d14(0xc61)][_0x7a4d14(0x9ea)](_0x42b3ef),await _0xd1839b());}let _0xe07b26=0x0;function _0x4ad0ef(_0x862671){const _0x5558f4=_0x247bea,_0x4b51ae=document[_0x5558f4(0x1292)](_0x5558f4(0x58c));return _0x4b51ae[_0x5558f4(0x84)]=_0x5558f4(0x1143),_0x4b51ae[_0x5558f4(0x102a)]=_0x5558f4(0x71e)+_0x862671[_0x5558f4(0x578)]+_0x5558f4(0x864),_0x4b51ae;}function _0x2519ca(_0x2ff5cb){const _0x452c0d=_0x247bea,_0x235c90=document['getElementById']('chat-list'),_0xe7d01d=document[_0x452c0d(0xc33)]('load-more-chats-btn');if(_0xe7d01d)_0xe7d01d['remove']();const _0x4e42f5=_0xe07b26,_0xb34f68=_0xe07b26+CHAT_LIST_RENDER_WINDOW,_0x56a5b0=_0x2ff5cb[_0x452c0d(0x111c)](_0x4e42f5,_0xb34f68),_0x626205=document[_0x452c0d(0x8d9)]();let _0x47f9ae=_0x235c90[_0x452c0d(0x977)](_0x452c0d(0xf9c));_0x56a5b0[_0x452c0d(0xd6a)](_0x5798c0=>{const _0x4e4f13=_0x452c0d;if(_0x5798c0[_0x4e4f13(0x52a)]==='groupHeader'){const _0x1c802f=_0x4ad0ef(_0x5798c0[_0x4e4f13(0x121f)]);_0x626205[_0x4e4f13(0xf77)](_0x1c802f),_0x47f9ae=_0x1c802f[_0x4e4f13(0x977)]('.chat-group-content');}else{if(_0x5798c0[_0x4e4f13(0x52a)]===_0x4e4f13(0x1042)){const _0x7aa0f6=_0x59404c(_0x5798c0[_0x4e4f13(0x824)]);_0x47f9ae&&_0x5798c0[_0x4e4f13(0x824)]['groupId']?_0x47f9ae[_0x4e4f13(0xf77)](_0x7aa0f6):(_0x626205[_0x4e4f13(0xf77)](_0x7aa0f6),_0x47f9ae=null);}}}),_0x235c90[_0x452c0d(0xf77)](_0x626205),_0xe07b26+=_0x56a5b0[_0x452c0d(0x79b)],_0x2ff5cb[_0x452c0d(0x79b)]>_0xe07b26&&_0x331e65(_0x235c90,_0x2ff5cb),document[_0x452c0d(0x67a)]('.chat-group-header')[_0x452c0d(0xd6a)](_0x5ca32c=>{const _0x687f03=_0x452c0d,_0x1b0db9=_0x5ca32c[_0x687f03(0xbc5)](!![]);_0x5ca32c[_0x687f03(0x1053)]['replaceChild'](_0x1b0db9,_0x5ca32c),_0x1b0db9[_0x687f03(0x205)](_0x687f03(0x335),()=>{const _0x4c849a=_0x687f03;_0x1b0db9[_0x4c849a(0x10d3)][_0x4c849a(0xe2c)](_0x4c849a(0x806)),_0x1b0db9[_0x4c849a(0x699)]['classList']['toggle'](_0x4c849a(0x806));});});}async function _0x597ed7(){const _0x33b7b4=_0x247bea,_0x3ab49f=document[_0x33b7b4(0xc33)](_0x33b7b4(0xc8e));_0x3ab49f[_0x33b7b4(0x102a)]='';const _0x59a7ef=Object[_0x33b7b4(0xd28)](_0x12493e[_0x33b7b4(0xc45)])[_0x33b7b4(0xbb3)]((_0x3bb613,_0x117561)=>{const _0x1b5c5d=_0x33b7b4,_0x49a357=(_0x117561['isPinned']||![])-(_0x3bb613[_0x1b5c5d(0x4fe)]||![]);if(_0x49a357!==0x0)return _0x49a357;return(_0x117561['history']['slice'](-0x1)[0x0]?.[_0x1b5c5d(0x2f0)]||0x0)-(_0x3bb613['history'][_0x1b5c5d(0x111c)](-0x1)[0x0]?.[_0x1b5c5d(0x2f0)]||0x0);}),_0x1c7eef=await _0x2a2987['qzoneGroups'][_0x33b7b4(0xf15)]();if(_0x59a7ef[_0x33b7b4(0x79b)]===0x0){_0x3ab49f[_0x33b7b4(0x102a)]=_0x33b7b4(0x62d);return;}_0x1c7eef['forEach'](_0x586497=>{const _0x1791b9=_0x33b7b4,_0x5d987e=_0x59a7ef[_0x1791b9(0xd85)](_0x556b21=>_0x556b21[_0x1791b9(0x780)]===_0x586497['id']);_0x586497['latestTimestamp']=_0x5d987e?_0x5d987e[_0x1791b9(0x1294)]['slice'](-0x1)[0x0]?.['timestamp']||0x0:0x0;}),_0x1c7eef[_0x33b7b4(0xbb3)]((_0x1c04fd,_0x1b3547)=>_0x1b3547[_0x33b7b4(0xac6)]-_0x1c04fd[_0x33b7b4(0xac6)]),_0x44a3ae=[];const _0x34c570=new Set();_0x1c7eef['forEach'](_0x908c94=>{const _0x52fc8e=_0x33b7b4,_0x4e7b15=_0x59a7ef[_0x52fc8e(0x1054)](_0x407999=>!_0x407999[_0x52fc8e(0x80b)]&&_0x407999[_0x52fc8e(0x780)]===_0x908c94['id']);_0x4e7b15[_0x52fc8e(0x79b)]>0x0&&(_0x44a3ae[_0x52fc8e(0x2d6)]({'type':'groupHeader','group':_0x908c94}),_0x4e7b15[_0x52fc8e(0xd6a)](_0x2887ea=>{const _0x297af7=_0x52fc8e;_0x44a3ae[_0x297af7(0x2d6)]({'type':_0x297af7(0x1042),'chat':_0x2887ea}),_0x34c570[_0x297af7(0xb9)](_0x2887ea['id']);}));}),_0x59a7ef[_0x33b7b4(0xd6a)](_0x4e4828=>{const _0x386137=_0x33b7b4;!_0x34c570['has'](_0x4e4828['id'])&&_0x44a3ae[_0x386137(0x2d6)]({'type':_0x386137(0x1042),'chat':_0x4e4828});}),_0xe07b26=0x0,_0x2519ca();}function _0x4ad0ef(_0x3650e7){const _0x557159=_0x247bea,_0x3ded4c=document[_0x557159(0x1292)]('div');return _0x3ded4c[_0x557159(0x84)]=_0x557159(0x1143),_0x3ded4c[_0x557159(0x102a)]=_0x557159(0xe2)+_0x3650e7[_0x557159(0x578)]+_0x557159(0xb56),_0x3ded4c;}function _0x331e65(_0x7d503b,_0x3406f4){const _0x1f6aff=_0x247bea,_0x440cf9=document[_0x1f6aff(0x1292)](_0x1f6aff(0xeb1));_0x440cf9['id']=_0x1f6aff(0x533),_0x440cf9['textContent']=_0x1f6aff(0xdcc),_0x440cf9['className']=_0x1f6aff(0x107c),_0x440cf9[_0x1f6aff(0x205)](_0x1f6aff(0x335),()=>_0x2519ca(_0x3406f4),{'once':!![]}),_0x7d503b[_0x1f6aff(0x9e1)](_0x440cf9);}function _0x2519ca(){const _0x1ed82c=_0x247bea;if(_0xafdb39)return;const _0x6e5cc6=document[_0x1ed82c(0xc33)](_0x1ed82c(0xc8e)),_0x298980=document[_0x1ed82c(0xc33)](_0x1ed82c(0x2fa));if(!_0x6e5cc6||!_0x298980)return;if(_0xe07b26>=_0x44a3ae[_0x1ed82c(0x79b)])return;_0xafdb39=!![];const _0x5dc972=_0xe07b26===0x0,_0x3f1ca1=()=>{const _0x5f0cfa=_0x1ed82c;_0x153aed(_0x6e5cc6);const _0x272c68=_0x12493e['globalSettings'][_0x5f0cfa(0x1ec)]||0x1e,_0x27e5e7=_0xe07b26,_0x24baee=_0xe07b26+_0x272c68,_0x2030ae=_0x44a3ae[_0x5f0cfa(0x111c)](_0x27e5e7,_0x24baee),_0x382a0e=document[_0x5f0cfa(0x8d9)]();let _0x3683d9=_0x6e5cc6['querySelector'](_0x5f0cfa(0xf9c));_0x2030ae['forEach'](_0x417942=>{const _0x169b22=_0x5f0cfa;if(_0x417942['type']===_0x169b22(0xbad)){const _0x3e8280=_0x4ad0ef(_0x417942[_0x169b22(0x121f)]);_0x382a0e[_0x169b22(0xf77)](_0x3e8280),_0x3683d9=_0x3e8280['querySelector'](_0x169b22(0xe0d));}else{if(_0x417942['type']===_0x169b22(0x1042)){const _0x3a84f6=_0x59404c(_0x417942[_0x169b22(0x824)]);if(_0x417942[_0x169b22(0x824)]['groupId']&&_0x3683d9)_0x3683d9[_0x169b22(0xf77)](_0x3a84f6);else{_0x382a0e[_0x169b22(0xf77)](_0x3a84f6);if(!_0x417942[_0x169b22(0x824)][_0x169b22(0x780)])_0x3683d9=null;}}}}),_0x6e5cc6[_0x5f0cfa(0xf77)](_0x382a0e),_0xe07b26+=_0x2030ae['length'],_0x6e5cc6['querySelectorAll'](_0x5f0cfa(0xfc8))['forEach'](_0x21492f=>{const _0x24df02=_0x5f0cfa;_0x21492f[_0x24df02(0x85)]['hasListener']='true',_0x21492f[_0x24df02(0x205)](_0x24df02(0x335),()=>{const _0x908bb4=_0x24df02;_0x21492f['classList'][_0x908bb4(0xe2c)]('collapsed'),_0x21492f[_0x908bb4(0x699)][_0x908bb4(0x10d3)][_0x908bb4(0xe2c)](_0x908bb4(0x806));});}),_0xafdb39=![],_0x298980[_0x5f0cfa(0xa87)]<=_0x298980['clientHeight']&&_0xe07b26<_0x44a3ae[_0x5f0cfa(0x79b)]&&_0x2519ca();};_0x5dc972?_0x3f1ca1():(_0x11bb7f(_0x6e5cc6,_0x1ed82c(0xbc2)),setTimeout(_0x3f1ca1,0x1f4));}function _0x59404c(_0x5239ab){const _0xadb067=_0x247bea;try{const _0x379337=_0x5239ab[_0xadb067(0x1294)][_0xadb067(0x1054)](_0x585f9c=>!_0x585f9c[_0xadb067(0xd07)])[_0xadb067(0x111c)](-0x1)[0x0]||{};let _0x2586da;if(!_0x5239ab['isGroup']&&_0x5239ab[_0xadb067(0x1cb)]?.['status']===_0xadb067(0xedf))_0x2586da=_0xadb067(0x6e7)+(_0x5239ab[_0xadb067(0x1cb)]['applicationReason']||'请求添加你为好友')+_0xadb067(0xc70);else{if(!_0x5239ab[_0xadb067(0x80b)]&&_0x5239ab['relationship']?.[_0xadb067(0xbc8)]===_0xadb067(0x1019))_0x2586da=_0xadb067(0xce1);else{if(_0x5239ab[_0xadb067(0x80b)]){if(_0x379337[_0xadb067(0x52a)]===_0xadb067(0xc05))_0x2586da='[系统消息]\x20'+_0x379337[_0xadb067(0xcbd)];else{if(_0x379337[_0xadb067(0x52a)]===_0xadb067(0xe86))_0x2586da=_0xadb067(0x6d0);else{if(_0x379337['type']==='ai_image'||_0x379337['type']===_0xadb067(0x142))_0x2586da=_0xadb067(0xc41);else{if(_0x379337[_0xadb067(0x52a)]===_0xadb067(0xb41))_0x2586da=_0xadb067(0x11d1);else{if(typeof _0x379337[_0xadb067(0xcbd)]==='string'&&_0x301121[_0xadb067(0x677)](_0x379337[_0xadb067(0xcbd)]))_0x2586da=_0x379337[_0xadb067(0x127d)]?_0xadb067(0xa21)+_0x379337[_0xadb067(0x127d)]+']':_0xadb067(0x75c);else Array[_0xadb067(0x621)](_0x379337['content'])?_0x2586da=_0xadb067(0x10e1):_0x2586da=String(_0x379337[_0xadb067(0xcbd)]||_0xadb067(0xda0))[_0xadb067(0x1033)](0x0,0x14);}}}}if(_0x379337[_0xadb067(0xe32)]&&_0x379337['type']!==_0xadb067(0xc05)){const _0xf171e7=_0x3fb61d(_0x5239ab,_0x379337[_0xadb067(0xe32)]);_0x2586da=_0xf171e7+':\x20'+_0x2586da;}}else{const _0x2bc00c=_0x5239ab[_0xadb067(0xbc8)]?.['text']||'在线';_0x2586da='['+_0x2bc00c+']';}}}const _0x9c4cb3=document['createElement'](_0xadb067(0x58c));_0x9c4cb3['className']='chat-list-item',_0x9c4cb3[_0xadb067(0x85)][_0xadb067(0x109b)]=_0x5239ab['id'];_0x5239ab[_0xadb067(0x4fe)]&&_0x9c4cb3[_0xadb067(0x10d3)][_0xadb067(0xb9)](_0xadb067(0x239));const _0x406488=_0x5239ab[_0xadb067(0x80b)]?_0x5239ab['settings'][_0xadb067(0x78a)]:_0x5239ab[_0xadb067(0x2ea)][_0xadb067(0x18e)],_0x51f7b2=_0x5239ab[_0xadb067(0x80b)]?'':_0x5239ab[_0xadb067(0x2ea)][_0xadb067(0x435)]||'';let _0x4a31a8;_0x51f7b2?_0x4a31a8=_0xadb067(0x129e)+(_0x406488||_0x190acc)+_0xadb067(0xb70)+_0x51f7b2+_0xadb067(0x1175):_0x4a31a8=_0xadb067(0xb19)+(_0x406488||_0x190acc)+_0xadb067(0x7f7);const _0x1f5471=_0x51f7b2?_0xadb067(0xd69):'',_0x22bdd8=_0xadb067(0x7c9)+_0x1f5471+'\x22>'+_0x4a31a8+_0xadb067(0xb45);_0x9c4cb3[_0xadb067(0x102a)]=_0xadb067(0x10e5)+_0x22bdd8+_0xadb067(0x9ac)+_0x5239ab[_0xadb067(0x578)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x5239ab['isGroup']?_0xadb067(0xde6):'')+_0xadb067(0xe0f)+(_0x5239ab[_0xadb067(0x80b)]?_0xadb067(0x136):_0xadb067(0xb62))+_0xadb067(0x128e)+_0x2586da+_0xadb067(0x122a);const _0x36fe54=_0x5239ab[_0xadb067(0xdc5)]||0x0,_0x48fbee=_0x9c4cb3[_0xadb067(0x977)](_0xadb067(0x604));_0x36fe54>0x0?(_0x48fbee[_0xadb067(0x11b0)]=_0x36fe54>0x63?'99+':_0x36fe54,_0x48fbee[_0xadb067(0x105d)][_0xadb067(0xf44)]=_0xadb067(0x863)):_0x48fbee[_0xadb067(0x105d)][_0xadb067(0xf44)]='none';const _0x4afd07=_0x9c4cb3['querySelector']('.avatar-group');_0x4afd07&&(_0x4afd07[_0xadb067(0x105d)][_0xadb067(0x437)]=_0xadb067(0xc21),_0x4afd07[_0xadb067(0x205)]('dblclick',_0x53be7a=>{const _0x41c998=_0xadb067;_0x53be7a[_0x41c998(0xea2)]();const _0x735e44=_0x5239ab[_0x41c998(0x80b)]?_0x5239ab['name']:_0x5239ab[_0x41c998(0x776)];_0x893b88(_0x5239ab['id'],_0x735e44);}));const _0x5a4725=_0x9c4cb3['querySelector'](_0xadb067(0xbd9));return _0x5a4725&&_0x5a4725[_0xadb067(0x205)]('click',()=>_0x157ff1(_0x5239ab['id'])),_0x29b870(_0x9c4cb3,async _0x43c040=>{const _0x569576=_0xadb067,_0x295fe3=await _0x37a720(_0x5239ab);switch(_0x295fe3){case _0x569576(0x69e):_0x5239ab[_0x569576(0x4fe)]=!_0x5239ab[_0x569576(0x4fe)],await _0x2a2987[_0x569576(0xc45)]['put'](_0x5239ab),_0x597ed7();break;case _0x569576(0x9ea):const _0x32368a=await _0x270512(_0x569576(0x9a9),'确定要删除与\x20\x22'+_0x5239ab[_0x569576(0x578)]+_0x569576(0x9fa),{'confirmButtonClass':_0x569576(0xa2)});if(_0x32368a){_0x5ebb31[_0x569576(0x1f3)]&&_0x5ebb31[_0x569576(0x7bc)]===_0x5239ab['id']&&await _0x3db293(![]);delete _0x12493e[_0x569576(0xc45)][_0x5239ab['id']];if(_0x12493e[_0x569576(0x7bc)]===_0x5239ab['id'])_0x12493e[_0x569576(0x7bc)]=null;await _0x2a2987['chats']['delete'](_0x5239ab['id']),_0x597ed7();}break;default:break;}}),_0x9c4cb3;}catch(_0x3aa83b){return console[_0xadb067(0x4d9)](_0xadb067(0x128)+(_0x5239ab['name']||'未知')+_0xadb067(0x91)+_0x5239ab['id']+_0xadb067(0x146),_0x3aa83b),null;}}async function _0x1bbfd3(_0x251887){const _0x2bee43=_0x247bea;_0x1572dc(),_0x1b43dc();const _0x5756d7=_0x12493e[_0x2bee43(0xc45)][_0x251887];if(!_0x5756d7)return;_0x5e1dc2();const _0x47648e=document[_0x2bee43(0xc33)](_0x2bee43(0xe81)),_0x2a3180=document[_0x2bee43(0xc33)](_0x2bee43(0x125d)),_0x5a13bd=document[_0x2bee43(0xc33)](_0x2bee43(0x35c)),_0x3960f7=document[_0x2bee43(0xc33)](_0x2bee43(0x10a9));_0x47648e[_0x2bee43(0x85)][_0x2bee43(0x8a9)]=_0x5756d7['settings'][_0x2bee43(0x8a9)]||_0x2bee43(0xfae);const _0x4a5f8c=_0x5756d7[_0x2bee43(0x2ea)][_0x2bee43(0x53c)]||0xd;_0x47648e[_0x2bee43(0x105d)][_0x2bee43(0x7f3)]('--chat-font-size',_0x4a5f8c+'px'),_0x813b8a(_0x5756d7[_0x2bee43(0x2ea)][_0x2bee43(0x707)]||'','#chat-messages',_0x2bee43(0x5a3)),document[_0x2bee43(0xc33)](_0x2bee43(0x40c))[_0x2bee43(0x11b0)]=_0x5756d7[_0x2bee43(0x578)];const _0xb6fdb8=document[_0x2bee43(0xc33)](_0x2bee43(0x4df)),_0x205d06=_0xb6fdb8[_0x2bee43(0x977)](_0x2bee43(0x10a8));_0x5756d7['isGroup']?(_0xb6fdb8['style']['display']=_0x2bee43(0x854),document['getElementById'](_0x2bee43(0xf73))['style'][_0x2bee43(0x68b)]=_0x2bee43(0xcef)):(_0xb6fdb8[_0x2bee43(0x105d)][_0x2bee43(0xf44)]='flex',document[_0x2bee43(0xc33)](_0x2bee43(0xf73))[_0x2bee43(0x105d)][_0x2bee43(0x68b)]=_0x2bee43(0xc0f),_0x205d06[_0x2bee43(0x11b0)]=_0x5756d7[_0x2bee43(0xbc8)]?.['text']||'在线',_0xb6fdb8['classList'][_0x2bee43(0xe2c)](_0x2bee43(0x103e),_0x5756d7[_0x2bee43(0xbc8)]?.[_0x2bee43(0x11a8)]||![]));const _0x614311=document['getElementById'](_0x2bee43(0xf1b)),_0x124756=_0x5756d7[_0x2bee43(0x2ea)][_0x2bee43(0xc88)],_0x4c00c7=_0x12493e[_0x2bee43(0x10f6)][_0x2bee43(0x840)],_0x2f9f0a=document[_0x2bee43(0xc33)](_0x2bee43(0x779))['classList']['contains']('dark-mode'),_0x2745db=_0x2f9f0a?_0x2bee43(0xa40):_0x2bee43(0xf78);if(_0x124756)_0x614311[_0x2bee43(0x105d)][_0x2bee43(0x4b5)]='url('+_0x124756+')',_0x614311[_0x2bee43(0x105d)]['backgroundColor']=_0x2bee43(0xaca);else _0x4c00c7?(_0x614311[_0x2bee43(0x105d)]['backgroundImage']=_0x2bee43(0xb23)+_0x4c00c7+')',_0x614311['style'][_0x2bee43(0x1c5)]=_0x2bee43(0xaca)):(_0x614311['style'][_0x2bee43(0x4b5)]='none',_0x614311['style'][_0x2bee43(0x1c5)]=_0x2745db);if(_0x5756d7[_0x2bee43(0x890)])_0x2a3180[_0x2bee43(0x105d)][_0x2bee43(0xf44)]=_0x2bee43(0x854),_0x5a13bd[_0x2bee43(0x105d)][_0x2bee43(0xf44)]=_0x2bee43(0x21a),_0x3960f7['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>正在围观AI们的群聊...</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22spectator-actions-container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22spectator-reroll-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22\x20title=\x22重新生成上一轮对话\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M20\x2011A8.1\x208.1\x200\x200\x200\x204.5\x209M4\x205v4h4\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M4\x2013a8.1\x208.1\x200\x200\x200\x2015.5\x202m.5\x204v-4h-4\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22spectator-propel-btn\x22\x20class=\x22lock-action-btn\x22>🎬\x20推进剧情</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22spectator-edit-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22\x20title=\x22导演剪辑室：编辑AI上一轮的响应\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M20.24\x2012.24a6\x206\x200\x200\x200-8.49-8.49L5\x2010.5V19h8.5z\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x2216\x22\x20y1=\x228\x22\x20x2=\x222\x22\x20y2=\x2222\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x2217.5\x22\x20y1=\x2215\x22\x20x2=\x229\x22\x20y2=\x2215\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',document[_0x2bee43(0xc33)]('spectator-propel-btn')['onclick']=_0x2fb62c;else{_0x2a3180[_0x2bee43(0x105d)]['display']=_0x2bee43(0x21a),_0x5a13bd[_0x2bee43(0x105d)][_0x2bee43(0xf44)]=_0x2bee43(0x854),_0x3960f7[_0x2bee43(0x102a)]='';if(!_0x5756d7[_0x2bee43(0x80b)]&&_0x5756d7[_0x2bee43(0x1cb)]['status']!==_0x2bee43(0xe59)){_0x5a13bd[_0x2bee43(0x105d)][_0x2bee43(0xf44)]=_0x2bee43(0x21a),_0x2a3180[_0x2bee43(0x105d)][_0x2bee43(0xf7)]=_0x2bee43(0x4d5);let _0x3852e0='';switch(_0x5756d7[_0x2bee43(0x1cb)][_0x2bee43(0xbc8)]){case _0x2bee43(0x49e):const _0x5ef2b5=_0x2f136d!==null,_0x488785=_0x5756d7[_0x2bee43(0x1cb)][_0x2bee43(0x713)],_0x55afdb=_0x12493e[_0x2bee43(0x10f6)][_0x2bee43(0x127f)]||0x1,_0x310c5c=_0x55afdb*0x3c*0x3c*0x3e8,_0x5c5a2c=Date[_0x2bee43(0x6ee)]()-_0x488785,_0x26489a=_0x5c5a2c>_0x310c5c,_0x22c76b=Math[_0x2bee43(0xbf8)](0x0,Math[_0x2bee43(0xeb0)]((_0x310c5c-_0x5c5a2c)/(0x3e8*0x3c)));_0x3852e0='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>你已将“'+_0x5756d7[_0x2bee43(0x578)]+_0x2bee43(0x5c2)+(_0x12493e[_0x2bee43(0x10f6)][_0x2bee43(0xdde)]?'<span\x20style=\x22color:\x20green;\x22>已开启</span>':_0x2bee43(0x372))+_0x2bee43(0x10dc)+(_0x5ef2b5?_0x2bee43(0x1050):_0x2bee43(0x3b4))+'<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20当前角色状态:\x20<strong>'+_0x5756d7[_0x2bee43(0x1cb)]['status']+_0x2bee43(0xaf0)+_0x55afdb+_0x2bee43(0x243)+(_0x26489a?_0x2bee43(0x125b):_0x2bee43(0xb9e)+_0x22c76b+_0x2bee43(0xe1a))+_0x2bee43(0xf65)+(_0x26489a&&_0x12493e[_0x2bee43(0x10f6)][_0x2bee43(0xdde)]?_0x2bee43(0xb49):_0x2bee43(0x82c))+_0x2bee43(0x228);break;case _0x2bee43(0x1019):_0x3852e0=_0x2bee43(0x469);break;case _0x2bee43(0xedf):_0x3852e0=_0x2bee43(0x2ed)+_0x5756d7[_0x2bee43(0x578)]+_0x2bee43(0x9fe)+_0x5756d7['relationship']['applicationReason']+_0x2bee43(0xb87);break;case'pending_ai_approval':_0x3852e0=_0x2bee43(0xce6);break;}_0x3960f7[_0x2bee43(0x102a)]=_0x3852e0;}else _0x5a13bd[_0x2bee43(0x105d)][_0x2bee43(0xf44)]=_0x2bee43(0x854),_0x2a3180[_0x2bee43(0x105d)][_0x2bee43(0xf7)]=_0x2bee43(0x143);}_0x47648e[_0x2bee43(0x102a)]='';const _0x4415fd=_0x5756d7[_0x2bee43(0x1294)];_0x5c866f=0x0;const _0x5c7a9e=_0x12493e[_0x2bee43(0x10f6)][_0x2bee43(0x3fd)]||0x32,_0x1a5be2=_0x4415fd[_0x2bee43(0x111c)](-_0x5c7a9e),_0x318ab1=[];let _0x5b5917=0x0;for(const _0x2c9594 of _0x1a5be2){_0x5b5917>0x0&&_0x2c9594[_0x2bee43(0x2f0)]-_0x5b5917>0x927c0&&_0x318ab1[_0x2bee43(0x2d6)](Promise[_0x2bee43(0x70)](_0x58cae3(_0x2c9594['timestamp']))),_0x318ab1[_0x2bee43(0x2d6)](_0x3f3a68(_0x2c9594,_0x5756d7,!![])),_0x5b5917=_0x2c9594[_0x2bee43(0x2f0)];}const _0x87021c=await Promise[_0x2bee43(0x5c8)](_0x318ab1),_0x9f4733=document[_0x2bee43(0x8d9)]();_0x87021c[_0x2bee43(0x1054)](Boolean)[_0x2bee43(0xd6a)](_0x29a0b9=>_0x9f4733[_0x2bee43(0xf77)](_0x29a0b9)),_0x47648e['appendChild'](_0x9f4733),_0x5c866f=_0x1a5be2[_0x2bee43(0x79b)];const _0x4aa18c=document['createElement'](_0x2bee43(0x58c));_0x4aa18c['id']=_0x2bee43(0x4f6),_0x4aa18c['style'][_0x2bee43(0xf44)]=_0x2bee43(0x854),_0x4aa18c[_0x2bee43(0x11b0)]='对方正在输入...',_0x47648e['appendChild'](_0x4aa18c),setTimeout(()=>_0x47648e[_0x2bee43(0x1244)]=_0x47648e[_0x2bee43(0xa87)],0x0);}async function _0x4b82a5(){const _0x38eade=_0x247bea;if(_0x28dd69)return;_0x28dd69=!![];const _0x5c5d3b=document['getElementById']('chat-messages'),_0x3504f2=_0x12493e[_0x38eade(0xc45)][_0x12493e[_0x38eade(0x7bc)]];if(!_0x3504f2){_0x28dd69=![];return;}_0x11bb7f(_0x5c5d3b,'top');const _0x57d8c4=_0x5c5d3b[_0x38eade(0xa87)];await new Promise(_0x117c0b=>setTimeout(_0x117c0b,0x1f4));const _0x305cd8=_0x3504f2[_0x38eade(0x1294)][_0x38eade(0x79b)],_0x34fad0=_0x12493e['globalSettings']['chatRenderWindow']||0x32,_0x562ebb=_0x305cd8-_0x5c866f-_0x34fad0,_0x3c91cc=_0x305cd8-_0x5c866f,_0x57dd94=_0x3504f2['history']['slice'](Math[_0x38eade(0xbf8)](0x0,_0x562ebb),_0x3c91cc),_0x27aa80=_0x5c5d3b['querySelector'](_0x38eade(0x199));let _0xd5cf5a=_0x27aa80?parseInt(_0x27aa80['dataset'][_0x38eade(0x2f0)]):0x0;for(const _0x21b259 of _0x57dd94['reverse']()){if(_0xd5cf5a>0x0&&_0xd5cf5a-_0x21b259[_0x38eade(0x2f0)]>0x927c0){const _0x45fdc9=_0x58cae3(_0xd5cf5a);_0x5c5d3b[_0x38eade(0x9e1)](_0x45fdc9);}await _0x500ec1(_0x21b259,_0x3504f2),_0xd5cf5a=_0x21b259[_0x38eade(0x2f0)];}_0x5c866f+=_0x57dd94['length'];const _0x42b6ff=_0x5c5d3b[_0x38eade(0xa87)];_0x5c5d3b[_0x38eade(0x1244)]=_0x42b6ff-_0x57d8c4,_0x153aed(_0x5c5d3b),_0x28dd69=![];}function _0x374557(){const _0x4e239d=_0x247bea;_0x376ae7(),_0x26623a();const _0x2fc066=document[_0x4e239d(0xc33)](_0x4e239d(0xecf)),_0x26b36f=_0x12493e[_0x4e239d(0x10f6)]['wallpaper'];_0x26b36f?(_0x2fc066['style'][_0x4e239d(0x4b5)]=_0x4e239d(0xb23)+_0x26b36f+')',_0x2fc066['textContent']=''):(_0x2fc066['style'][_0x4e239d(0x4b5)]='linear-gradient(135deg,\x20#89f7fe,\x20#66a6ff)',_0x2fc066[_0x4e239d(0x11b0)]=_0x4e239d(0x29d));const _0x49bcf3=document[_0x4e239d(0xc33)](_0x4e239d(0xc5d)),_0x4a06bd=_0x12493e[_0x4e239d(0x10f6)][_0x4e239d(0x2f5)];_0x4a06bd?(_0x49bcf3['style'][_0x4e239d(0x4b5)]='url('+_0x4a06bd+')',_0x49bcf3[_0x4e239d(0x11b0)]=''):(_0x49bcf3[_0x4e239d(0x105d)][_0x4e239d(0x4b5)]=_0x4e239d(0x530),_0x49bcf3[_0x4e239d(0x11b0)]='当前为渐变色');const _0x26ad86=document[_0x4e239d(0xc33)]('global-bg-preview'),_0x35ba94=_0x12493e[_0x4e239d(0x10f6)][_0x4e239d(0x840)];_0x35ba94?(_0x26ad86[_0x4e239d(0x105d)][_0x4e239d(0x4b5)]=_0x4e239d(0xb23)+_0x35ba94+')',_0x26ad86[_0x4e239d(0x11b0)]='',document[_0x4e239d(0xc33)]('remove-global-bg-btn')[_0x4e239d(0x105d)][_0x4e239d(0xf44)]=_0x4e239d(0xd94)):(_0x26ad86[_0x4e239d(0x105d)][_0x4e239d(0x4b5)]=_0x4e239d(0x854),_0x26ad86[_0x4e239d(0x11b0)]=_0x4e239d(0x98),document[_0x4e239d(0xc33)](_0x4e239d(0x3ba))[_0x4e239d(0x105d)][_0x4e239d(0xf44)]=_0x4e239d(0x854)),_0x2ee1a1(),_0x45c50d(),document[_0x4e239d(0xc33)]('global-css-input')['value']=_0x12493e[_0x4e239d(0x10f6)]['globalCss']||'',document[_0x4e239d(0xc33)](_0x4e239d(0x82a))['value']=_0x12493e[_0x4e239d(0x10f6)][_0x4e239d(0xc7)]||'',document[_0x4e239d(0xc33)](_0x4e239d(0x130))[_0x4e239d(0x737)]=_0x12493e['globalSettings'][_0x4e239d(0xa86)]||![],_0x404c17(),_0x4a5adc();}window['renderWallpaperScreenProxy']=_0x374557;function _0x5871a7(){const _0x1ff468=_0x247bea,_0x1d403e=document['getElementById'](_0x1ff468(0x94f)),_0x38b3e7=_0x12493e[_0x1ff468(0x10f6)][_0x1ff468(0x93e)];_0x38b3e7?_0x1d403e[_0x1ff468(0x105d)][_0x1ff468(0x4b5)]=_0x1ff468(0xb23)+_0x38b3e7+')':_0x1d403e['style'][_0x1ff468(0x4b5)]=_0x1ff468(0x110);}function _0x4fbbcc(_0x59c24f){const _0x1ff645=_0x247bea;document['querySelectorAll'](_0x1ff645(0x789))['forEach'](_0x4035f4=>{const _0x35ccd5=_0x1ff645;_0x4035f4['classList']['toggle'](_0x35ccd5(0x1043),_0x4035f4[_0x35ccd5(0x85)]['categoryId']===_0x59c24f);}),document['querySelectorAll'](_0x1ff645(0x2a9))[_0x1ff645(0xd6a)](_0x1d3308=>{const _0x10301e=_0x1ff645;_0x1d3308['classList'][_0x10301e(0xe2c)](_0x10301e(0x1043),_0x1d3308[_0x10301e(0x85)][_0x10301e(0x305)]===_0x59c24f);});}async function _0x561077(){const _0x38db8a=_0x247bea,_0x4c9918=document[_0x38db8a(0xc33)](_0x38db8a(0x108a)),_0x3e920f=document[_0x38db8a(0xc33)](_0x38db8a(0x10f2));_0x4c9918[_0x38db8a(0x102a)]='',_0x3e920f[_0x38db8a(0x102a)]='';const [_0x5aea5a,_0xef4613]=await Promise['all']([_0x2a2987['worldBooks'][_0x38db8a(0xf15)](),_0x2a2987[_0x38db8a(0xd06)][_0x38db8a(0xde3)](_0x38db8a(0x578))[_0x38db8a(0xf15)]()]);_0x12493e['worldBooks']=_0x5aea5a;if(_0x5aea5a[_0x38db8a(0x79b)]===0x0){_0x3e920f[_0x38db8a(0x102a)]='<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20margin-top:\x2050px;\x22>点击右上角\x20\x22+\x22\x20创建你的第一本世界书</p>';return;}const _0x36a2c1=document[_0x38db8a(0x1292)](_0x38db8a(0xeb1));_0x36a2c1[_0x38db8a(0x84)]=_0x38db8a(0xcd0),_0x36a2c1[_0x38db8a(0x11b0)]='全部',_0x36a2c1[_0x38db8a(0x85)][_0x38db8a(0x305)]=_0x38db8a(0x5c8),_0x4c9918[_0x38db8a(0xf77)](_0x36a2c1);const _0x118797=document[_0x38db8a(0x1292)]('div');_0x118797[_0x38db8a(0x84)]=_0x38db8a(0xf38),_0x118797[_0x38db8a(0x85)][_0x38db8a(0x305)]=_0x38db8a(0x5c8),_0x3e920f[_0x38db8a(0xf77)](_0x118797),_0xef4613[_0x38db8a(0xd6a)](_0x316519=>{const _0x22a537=_0x38db8a,_0x2e20dd=document[_0x22a537(0x1292)](_0x22a537(0xeb1));_0x2e20dd['className']=_0x22a537(0x1068),_0x2e20dd[_0x22a537(0x11b0)]=_0x316519['name'],_0x2e20dd[_0x22a537(0x85)][_0x22a537(0x305)]=String(_0x316519['id']),_0x4c9918[_0x22a537(0xf77)](_0x2e20dd);const _0x5902d1=document['createElement'](_0x22a537(0x58c));_0x5902d1['className']=_0x22a537(0xfee),_0x5902d1[_0x22a537(0x85)][_0x22a537(0x305)]=String(_0x316519['id']),_0x3e920f[_0x22a537(0xf77)](_0x5902d1);});const _0x1b4761=_0x5aea5a[_0x38db8a(0xfa7)](_0x3d19b7=>!_0x3d19b7[_0x38db8a(0x305)]);if(_0x1b4761){const _0x389468=document[_0x38db8a(0x1292)](_0x38db8a(0xeb1));_0x389468[_0x38db8a(0x84)]=_0x38db8a(0x1068),_0x389468[_0x38db8a(0x11b0)]='未分类',_0x389468['dataset'][_0x38db8a(0x305)]=_0x38db8a(0xef1),_0x4c9918[_0x38db8a(0xf77)](_0x389468);const _0x235f9a=document['createElement'](_0x38db8a(0x58c));_0x235f9a[_0x38db8a(0x84)]='world-book-category-pane',_0x235f9a['dataset'][_0x38db8a(0x305)]=_0x38db8a(0xef1),_0x3e920f[_0x38db8a(0xf77)](_0x235f9a);}_0x5aea5a[_0x38db8a(0xd6a)](_0x3b70d7=>{const _0x40cdbd=_0x38db8a;let _0x47a1c0=_0x40cdbd(0x12a4);if(Array[_0x40cdbd(0x621)](_0x3b70d7['content'])&&_0x3b70d7['content']['length']>0x0){const _0x1d1865=_0x3b70d7['content'][0x0];_0x47a1c0=_0x1d1865[_0x40cdbd(0x8db)]||_0x1d1865[_0x40cdbd(0xcbd)]||'';}else typeof _0x3b70d7['content']===_0x40cdbd(0x9de)&&_0x3b70d7[_0x40cdbd(0xcbd)][_0x40cdbd(0x7da)]()!==''&&(_0x47a1c0=_0x3b70d7['content']);const _0x48bf17=document[_0x40cdbd(0x1292)](_0x40cdbd(0x58c));_0x48bf17[_0x40cdbd(0x84)]=_0x40cdbd(0x7eb),_0x48bf17[_0x40cdbd(0x102a)]=_0x40cdbd(0xc18)+_0x3b70d7[_0x40cdbd(0x578)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>'+_0x47a1c0+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';const _0x593874=()=>_0x15e3c9(_0x3b70d7['id']),_0x491e47=async()=>{const _0x224800=_0x40cdbd,_0x1ac062=await _0x270512(_0x224800(0x405),_0x224800(0xc04)+_0x3b70d7[_0x224800(0x578)]+'》吗？',{'confirmButtonClass':'btn-danger'});_0x1ac062&&(await _0x2a2987['worldBooks']['delete'](_0x3b70d7['id']),_0x12493e[_0x224800(0x63a)]=_0x12493e[_0x224800(0x63a)][_0x224800(0x1054)](_0x111c5f=>_0x111c5f['id']!==_0x3b70d7['id']),_0x561077());};_0x48bf17[_0x40cdbd(0x205)](_0x40cdbd(0x335),_0x593874),_0x29b870(_0x48bf17,_0x491e47);const _0x3c2ae8=_0x48bf17[_0x40cdbd(0xbc5)](!![]);_0x3c2ae8[_0x40cdbd(0x205)](_0x40cdbd(0x335),_0x593874),_0x29b870(_0x3c2ae8,_0x491e47),_0x118797[_0x40cdbd(0xf77)](_0x3c2ae8);const _0x2d1784=_0x3b70d7['categoryId']?String(_0x3b70d7['categoryId']):_0x40cdbd(0xef1),_0x3cba36=_0x3e920f['querySelector'](_0x40cdbd(0x965)+_0x2d1784+'\x22]');_0x3cba36&&_0x3cba36[_0x40cdbd(0xf77)](_0x48bf17);}),document[_0x38db8a(0x67a)](_0x38db8a(0x789))[_0x38db8a(0xd6a)](_0x4ee8c4=>{const _0xc07c25=_0x38db8a;_0x4ee8c4[_0xc07c25(0x205)](_0xc07c25(0x335),()=>_0x4fbbcc(_0x4ee8c4[_0xc07c25(0x85)][_0xc07c25(0x305)]));});}function _0x4965cc(_0x5c1cda,_0x52eefe){const _0x5a4d34=_0x247bea,_0x3c1f91=document['createElement']('div');_0x3c1f91[_0x5a4d34(0x84)]=_0x5a4d34(0xa8b),_0x3c1f91['innerHTML']=_0x5a4d34(0xf48)+_0x5c1cda+_0x5a4d34(0x1c2);const _0x48da2f=_0x3c1f91[_0x5a4d34(0x977)](_0x5a4d34(0xaab));return _0x52eefe['sort']((_0x109093,_0xda9d9e)=>_0x109093['name'][_0x5a4d34(0x3c3)](_0xda9d9e[_0x5a4d34(0x578)],_0x5a4d34(0x770))),_0x52eefe[_0x5a4d34(0xd6a)](_0x333436=>{const _0x55f3f2=_0x5a4d34;let _0x2e0c29=_0x55f3f2(0x12a4);if(Array['isArray'](_0x333436[_0x55f3f2(0xcbd)])&&_0x333436[_0x55f3f2(0xcbd)][_0x55f3f2(0x79b)]>0x0){const _0x41f55f=_0x333436[_0x55f3f2(0xcbd)][0x0];_0x2e0c29=_0x41f55f['comment']||_0x41f55f[_0x55f3f2(0xcbd)]||'';}else typeof _0x333436[_0x55f3f2(0xcbd)]===_0x55f3f2(0x9de)&&_0x333436[_0x55f3f2(0xcbd)][_0x55f3f2(0x7da)]()!==''&&(_0x2e0c29=_0x333436['content']);const _0x150899=document['createElement'](_0x55f3f2(0x58c));_0x150899[_0x55f3f2(0x84)]=_0x55f3f2(0x8d4),_0x150899[_0x55f3f2(0x85)][_0x55f3f2(0xf90)]=_0x333436['id'],_0x150899[_0x55f3f2(0x102a)]=_0x55f3f2(0x211)+_0x333436['name']+_0x55f3f2(0xdfb)+String(_0x2e0c29)[_0x55f3f2(0x1033)](0x0,0x32)+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x150899['addEventListener'](_0x55f3f2(0x335),()=>_0x15e3c9(_0x333436['id'])),_0x29b870(_0x150899,async()=>{const _0x386637=_0x55f3f2,_0x50ac4c=await _0x270512(_0x386637(0x405),_0x386637(0xc04)+_0x333436[_0x386637(0x578)]+'》吗？此操作不可撤销。',{'confirmButtonClass':_0x386637(0xa2)});_0x50ac4c&&(await _0x2a2987['worldBooks']['delete'](_0x333436['id']),_0x12493e[_0x386637(0x63a)]=_0x12493e['worldBooks']['filter'](_0x910cf7=>_0x910cf7['id']!==_0x333436['id']),_0x561077());}),_0x48da2f[_0x55f3f2(0xf77)](_0x150899);}),_0x3c1f91;}window['renderWorldBookScreenProxy']=_0x561077;async function _0x15e3c9(_0x53e1e8){const _0x27b976=_0x247bea;_0x38f00f('world-book-editor-screen'),_0xae35a4=_0x53e1e8;const [_0x315404,_0x420f3a]=await Promise['all']([_0x2a2987['worldBooks']['get'](_0x53e1e8),_0x2a2987[_0x27b976(0xd06)][_0x27b976(0xf15)]()]);if(!_0x315404){console[_0x27b976(0x4d9)]('尝试打开一个不存在的世界书，ID:',_0x53e1e8),_0x38f00f(_0x27b976(0x1129));return;}document[_0x27b976(0xc33)](_0x27b976(0x1087))[_0x27b976(0x11b0)]=_0x315404[_0x27b976(0x578)],document[_0x27b976(0xc33)]('world-book-name-input')[_0x27b976(0x22a)]=_0x315404[_0x27b976(0x578)];const _0xa559a7=document['getElementById'](_0x27b976(0xcd));_0xa559a7[_0x27b976(0x102a)]='<option\x20value=\x22\x22>--\x20未分类\x20--</option>',_0x420f3a[_0x27b976(0xd6a)](_0x26d080=>{const _0x5f12cb=_0x27b976,_0x211321=document['createElement'](_0x5f12cb(0x2f6));_0x211321['value']=_0x26d080['id'],_0x211321['textContent']=_0x26d080[_0x5f12cb(0x578)];if(_0x315404[_0x5f12cb(0x305)]===_0x26d080['id'])_0x211321['selected']=!![];_0xa559a7[_0x5f12cb(0xf77)](_0x211321);});const _0x54af85=document['getElementById'](_0x27b976(0xd7a));_0x54af85[_0x27b976(0x102a)]='',Array['isArray'](_0x315404[_0x27b976(0xcbd)])&&_0x315404[_0x27b976(0xcbd)][_0x27b976(0x79b)]>0x0?_0x315404['content'][_0x27b976(0xd6a)](_0x1e4ee4=>{const _0xcd90d5=_0x535ca1(_0x1e4ee4);_0x54af85['appendChild'](_0xcd90d5);}):_0x54af85[_0x27b976(0x102a)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2020px;\x22>还没有内容，点击下方按钮添加第一条吧！</p>';}async function _0x3f10e9(_0x7b43b7=!![]){const _0x361a0c=_0x247bea,_0x2614c8=document[_0x361a0c(0xc33)](_0x361a0c(0x453)),_0x25238c=document[_0x361a0c(0xc33)]('sticker-category-tabs'),_0x45dc4d=document[_0x361a0c(0xc33)]('sticker-search-input'),_0x20e4a6=_0x45dc4d[_0x361a0c(0x22a)][_0x361a0c(0x7da)]()[_0x361a0c(0x963)]();if(_0x7b43b7){_0x25238c[_0x361a0c(0x102a)]='';const _0x4548d5=await _0x2a2987[_0x361a0c(0xfb6)][_0x361a0c(0xf15)]();_0x25238c[_0x361a0c(0x102a)]+=_0x361a0c(0x1e0)+(_0x1b3792===_0x361a0c(0x5c8)?_0x361a0c(0x1043):'')+_0x361a0c(0xe88),_0x4548d5[_0x361a0c(0xd6a)](_0x2f4504=>{const _0x34c01f=_0x361a0c;_0x25238c[_0x34c01f(0x102a)]+=_0x34c01f(0x1e0)+(_0x1b3792===_0x2f4504['id']?_0x34c01f(0x1043):'')+_0x34c01f(0x425)+_0x2f4504['id']+'\x22>'+_0x2f4504[_0x34c01f(0x578)]+_0x34c01f(0xcff);}),_0x25238c[_0x361a0c(0x102a)]+=_0x361a0c(0x1e0)+(_0x1b3792===_0x361a0c(0xef1)?_0x361a0c(0x1043):'')+_0x361a0c(0x853);}_0x2614c8['innerHTML']='';let _0x15a141;if(_0x1b3792===_0x361a0c(0x5c8))_0x15a141=_0x12493e[_0x361a0c(0x454)];else _0x1b3792==='uncategorized'?_0x15a141=_0x12493e[_0x361a0c(0x454)][_0x361a0c(0x1054)](_0x426a33=>!_0x426a33[_0x361a0c(0x305)]):_0x15a141=_0x12493e[_0x361a0c(0x454)]['filter'](_0x4a5b9f=>_0x4a5b9f[_0x361a0c(0x305)]===_0x1b3792);const _0x53db6d=_0x20e4a6?_0x15a141[_0x361a0c(0x1054)](_0x2f0999=>_0x2f0999[_0x361a0c(0x578)][_0x361a0c(0x963)]()[_0x361a0c(0x1d4)](_0x20e4a6)):_0x15a141;if(_0x53db6d['length']===0x0){const _0x496b7e=_0x20e4a6?_0x361a0c(0xf04):_0x361a0c(0x1185);_0x2614c8[_0x361a0c(0x102a)]=_0x361a0c(0xf4)+_0x496b7e+_0x361a0c(0xcc9);return;}_0x53db6d[_0x361a0c(0xd6a)](_0x227660=>{const _0x46c907=_0x361a0c,_0x5b44f6=document[_0x46c907(0x1292)](_0x46c907(0x58c));_0x5b44f6[_0x46c907(0x84)]=_0x46c907(0x696),_0x5b44f6[_0x46c907(0x874)]=_0x227660[_0x46c907(0x578)],_0x5b44f6[_0x46c907(0x85)][_0x46c907(0xddb)]=_0x227660['id'],_0x5b44f6[_0x46c907(0x102a)]=_0x46c907(0x87f)+_0x227660[_0x46c907(0x11a)]+')\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22sticker-name\x22>'+_0x227660[_0x46c907(0x578)]+_0x46c907(0x149),_0x5b44f6[_0x46c907(0x205)](_0x46c907(0x335),()=>{_0x484f75?_0x336c0d(_0x5b44f6):_0x3797e0(_0x227660);});const _0x560656=document[_0x46c907(0x1292)]('div');_0x560656[_0x46c907(0x84)]=_0x46c907(0x7d1),_0x560656['innerHTML']='&times;',_0x560656[_0x46c907(0x8a)]=async _0x24d0e0=>{const _0x65c880=_0x46c907;_0x24d0e0['stopPropagation']();const _0x1dbf0d=await _0x270512('删除表情',_0x65c880(0x6d3)+_0x227660[_0x65c880(0x578)]+_0x65c880(0x10ad),{'confirmButtonClass':_0x65c880(0xa2)});_0x1dbf0d&&(await _0x2a2987['userStickers'][_0x65c880(0x9ea)](_0x227660['id']),_0x12493e[_0x65c880(0x454)]=_0x12493e[_0x65c880(0x454)][_0x65c880(0x1054)](_0x534e1c=>_0x534e1c['id']!==_0x227660['id']),_0x3f10e9());},_0x5b44f6[_0x46c907(0xf77)](_0x560656),_0x2614c8[_0x46c907(0xf77)](_0x5b44f6);});}let _0x484f75=![],_0x3a9bed=new Set();function _0x3d7652(){const _0x2b2083=_0x247bea;_0x484f75=!_0x484f75;const _0x389852=document[_0x2b2083(0xc33)]('sticker-grid'),_0x25dd3e=document[_0x2b2083(0xc33)](_0x2b2083(0x11a1)),_0xb1bd47=document[_0x2b2083(0xc33)](_0x2b2083(0x9c4)),_0x315da2=document['getElementById']('select-all-stickers-checkbox');_0x389852[_0x2b2083(0x10d3)][_0x2b2083(0xe2c)]('management-mode',_0x484f75),_0x484f75?(_0x25dd3e[_0x2b2083(0x11b0)]='完成',_0xb1bd47[_0x2b2083(0x105d)][_0x2b2083(0xf44)]=_0x2b2083(0x21a),_0x3a9bed[_0x2b2083(0xebb)](),_0x315da2[_0x2b2083(0x737)]=![],_0x3f91bb()):(_0x25dd3e[_0x2b2083(0x11b0)]='管理',_0xb1bd47[_0x2b2083(0x105d)]['display']=_0x2b2083(0x854),_0x389852[_0x2b2083(0x67a)]('.sticker-item.selected')['forEach'](_0x49e2dd=>_0x49e2dd[_0x2b2083(0x10d3)][_0x2b2083(0x2c7)](_0x2b2083(0x63f))));}function _0x57cd1f(){const _0x968e9=_0x247bea,_0x50cf3d=document[_0x968e9(0xc33)](_0x968e9(0xc2c)),_0x1bdc64=_0x50cf3d[_0x968e9(0x737)];let _0x1dd243;if(_0x1b3792===_0x968e9(0x5c8))_0x1dd243=_0x12493e[_0x968e9(0x454)];else _0x1b3792===_0x968e9(0xef1)?_0x1dd243=_0x12493e['userStickers'][_0x968e9(0x1054)](_0x541cf4=>!_0x541cf4[_0x968e9(0x305)]):_0x1dd243=_0x12493e[_0x968e9(0x454)][_0x968e9(0x1054)](_0x5903f6=>_0x5903f6[_0x968e9(0x305)]===_0x1b3792);_0x1dd243[_0x968e9(0xd6a)](_0x5e9f6f=>{const _0x47d982=_0x968e9,_0x7a2fe9=_0x5e9f6f['id'],_0x435334=document[_0x47d982(0x977)](_0x47d982(0x7c5)+_0x7a2fe9+'\x22]');if(_0x1bdc64){_0x3a9bed['add'](_0x7a2fe9);if(_0x435334)_0x435334[_0x47d982(0x10d3)]['add'](_0x47d982(0x63f));}else{_0x3a9bed[_0x47d982(0x9ea)](_0x7a2fe9);if(_0x435334)_0x435334[_0x47d982(0x10d3)]['remove'](_0x47d982(0x63f));}}),_0x3f91bb();}function _0x3f91bb(){const _0x42512e=_0x247bea,_0x5ebd04=document[_0x42512e(0xc33)](_0x42512e(0xf5a));_0x5ebd04['textContent']=_0x42512e(0x6fb)+_0x3a9bed[_0x42512e(0x57e)]+')';}function _0x336c0d(_0x5e7798){const _0x1e3c29=_0x247bea;if(!_0x484f75)return;const _0x5bcf94=_0x5e7798[_0x1e3c29(0x85)][_0x1e3c29(0xddb)];if(!_0x5bcf94)return;_0x5e7798[_0x1e3c29(0x10d3)][_0x1e3c29(0xe2c)](_0x1e3c29(0x63f)),_0x3a9bed['has'](_0x5bcf94)?_0x3a9bed[_0x1e3c29(0x9ea)](_0x5bcf94):_0x3a9bed[_0x1e3c29(0xb9)](_0x5bcf94),_0x3f91bb();}async function _0x44962a(){const _0x181661=_0x247bea;if(_0x3a9bed[_0x181661(0x57e)]===0x0)return;const _0x5f1334=await _0x270512('确认删除',_0x181661(0x5bf)+_0x3a9bed[_0x181661(0x57e)]+_0x181661(0x870),{'confirmButtonClass':'btn-danger'});if(_0x5f1334){const _0x8bd7b1=[..._0x3a9bed];await _0x2a2987[_0x181661(0x454)]['bulkDelete'](_0x8bd7b1),_0x12493e[_0x181661(0x454)]=_0x12493e[_0x181661(0x454)][_0x181661(0x1054)](_0x270ed8=>!_0x8bd7b1['includes'](_0x270ed8['id'])),_0x3d7652(),_0x3f10e9(),await _0x2d7ddd(_0x181661(0xf8f),_0x181661(0xb9b));}}async function _0x324a50(){const _0x41d7aa=_0x247bea,_0x439b5d=_0x41d7aa(0x943),_0x3abf10=await _0x1ca09c(_0x41d7aa(0xbd7),_0x439b5d,'',_0x41d7aa(0x89c));_0x3abf10&&_0x3abf10[_0x41d7aa(0x7da)]()&&await _0x354557(_0x3abf10);}async function _0x354557(_0x7e42d9){const _0x485a60=_0x247bea,_0x372b81=_0x7e42d9[_0x485a60(0x7da)]()[_0x485a60(0x8d7)]('\x0a'),_0x361fa3=[],_0x32b483=_0x485a60(0x8a1);let _0x511ff5=0x0;const _0x402b88=_0x1b3792!==_0x485a60(0x5c8)&&_0x1b3792!=='uncategorized'?_0x1b3792:null;for(const _0x15edd8 of _0x372b81){const _0x10e060=_0x15edd8[_0x485a60(0x7da)]();if(!_0x10e060||_0x10e060[_0x485a60(0x1d4)]('填入'))continue;const _0x14eb44=_0x10e060['match'](/^(.+?)[:：]\s*(https?:\/\/.+)$/);if(_0x14eb44){const _0x3d34cc=_0x14eb44[0x1][_0x485a60(0x7da)](),_0x30dc66=_0x14eb44[0x2][_0x485a60(0x7da)]();_0x361fa3['push']({'id':'sticker_'+Date['now']()+Math[_0x485a60(0xa11)](),'name':_0x3d34cc,'url':_0x30dc66,'categoryId':_0x402b88});continue;}let _0x5ae7d7=null,_0xb14f8b=null;const _0x54ef07=_0x10e060[_0x485a60(0x1242)](/^([\u4e00-\u9fa5]+)([a-zA-Z0-9]+\..+)$/);if(_0x54ef07)_0x5ae7d7=_0x54ef07[0x1],_0xb14f8b=_0x54ef07[0x2];else{const _0x5bb8e2=_0x10e060[_0x485a60(0x8d7)](/\s+/);_0x5bb8e2[_0x485a60(0x79b)]>=0x2&&(_0xb14f8b=_0x5bb8e2[_0x485a60(0xf56)](),_0x5ae7d7=_0x5bb8e2[_0x485a60(0x100b)]('\x20'));}_0x5ae7d7&&_0xb14f8b&&_0xb14f8b['includes']('.')?_0x361fa3['push']({'id':_0x485a60(0xbe2)+Date['now']()+Math[_0x485a60(0xa11)](),'name':_0x5ae7d7,'url':_0x32b483+_0xb14f8b,'categoryId':_0x402b88}):(_0x511ff5++,console[_0x485a60(0x54a)]('批量导入格式错误，已跳过此行:',_0x10e060));}_0x511ff5>0x0&&await _0x2d7ddd(_0x485a60(0x436),'有\x20'+_0x511ff5+_0x485a60(0x429));if(_0x361fa3[_0x485a60(0x79b)]>0x0)await _0x2a2987[_0x485a60(0x454)][_0x485a60(0x3ab)](_0x361fa3),_0x12493e[_0x485a60(0x454)][_0x485a60(0x2d6)](..._0x361fa3),_0x3f10e9(),await _0x2d7ddd(_0x485a60(0x455),_0x485a60(0xd30)+_0x361fa3[_0x485a60(0x79b)]+_0x485a60(0x366));else _0x511ff5===0x0&&alert(_0x485a60(0x1e3));}function _0x2d486b(_0x42ee2e){const _0x4f31a7=_0x247bea,_0x138b9b='.message-bubble[data-timestamp=\x22'+_0x42ee2e+'\x22]',_0x1e9029=document[_0x4f31a7(0x977)](_0x138b9b);_0x1e9029?(_0x1e9029[_0x4f31a7(0x637)]({'behavior':'smooth','block':_0x4f31a7(0xcef)}),_0x1e9029[_0x4f31a7(0x10d3)][_0x4f31a7(0xb9)](_0x4f31a7(0x10bf)),setTimeout(()=>{const _0x24d150=_0x4f31a7;document['body'][_0x24d150(0x3af)](_0x1e9029)&&_0x1e9029['classList'][_0x24d150(0x2c7)](_0x24d150(0x10bf));},0x5dc)):alert(_0x4f31a7(0xd67));}async function _0x3f3a68(_0x3a7fb2,_0x2d7d83){const _0x565fce=_0x247bea;if(_0x3a7fb2[_0x565fce(0x52a)]===_0x565fce(0x960)){const _0x220c39=document[_0x565fce(0x1292)](_0x565fce(0x58c));_0x220c39['className']=_0x565fce(0x1252),_0x220c39[_0x565fce(0x85)][_0x565fce(0x2f0)]=_0x3a7fb2[_0x565fce(0x2f0)];const _0x524cd7=document[_0x565fce(0x1292)](_0x565fce(0x58c));return _0x524cd7['className']=_0x565fce(0x3f8),_0x524cd7['dataset']['timestamp']=_0x3a7fb2[_0x565fce(0x2f0)],_0x524cd7[_0x565fce(0x11b0)]=_0x3a7fb2['content'],_0x220c39[_0x565fce(0xf77)](_0x524cd7),_0x29b870(_0x220c39,()=>_0xeddcd0(_0x3a7fb2[_0x565fce(0x2f0)])),_0x220c39[_0x565fce(0x205)]('click',()=>{_0x4085b7&&_0x102e81(_0x3a7fb2['timestamp']);}),_0x220c39;}else{if(_0x3a7fb2['type']===_0x565fce(0x32c)){const _0x3c3bd0=document[_0x565fce(0x1292)]('div');_0x3c3bd0[_0x565fce(0x84)]=_0x565fce(0x1252),_0x3c3bd0[_0x565fce(0x85)][_0x565fce(0x2f0)]=_0x3a7fb2[_0x565fce(0x2f0)];const _0x3589ad=document['createElement'](_0x565fce(0x58c));return _0x3589ad['className']='message-bubble\x20post-deleted-placeholder',_0x3589ad['dataset'][_0x565fce(0x337)]=_0x3a7fb2[_0x565fce(0x337)],_0x3589ad[_0x565fce(0x11b0)]=_0x3a7fb2[_0x565fce(0xcbd)],_0x3c3bd0['appendChild'](_0x3589ad),_0x29b870(_0x3c3bd0,()=>_0xeddcd0(_0x3a7fb2[_0x565fce(0x2f0)])),_0x3c3bd0[_0x565fce(0x205)]('click',()=>{const _0x267631=_0x565fce;_0x4085b7&&_0x102e81(_0x3a7fb2[_0x267631(0x2f0)]);}),_0x3c3bd0;}}if(_0x3a7fb2[_0x565fce(0xd07)])return null;if(_0x3a7fb2[_0x565fce(0x52a)]===_0x565fce(0xc05)){const _0x1fd925=document[_0x565fce(0x1292)](_0x565fce(0x58c));_0x1fd925['className']=_0x565fce(0x1252);const _0x4ae10f=document[_0x565fce(0x1292)](_0x565fce(0x58c));return _0x4ae10f[_0x565fce(0x84)]='message-bubble\x20system-bubble',_0x4ae10f[_0x565fce(0x85)]['timestamp']=_0x3a7fb2['timestamp'],_0x4ae10f[_0x565fce(0x11b0)]=_0x3a7fb2[_0x565fce(0xcbd)],_0x1fd925[_0x565fce(0xf77)](_0x4ae10f),_0x29b870(_0x1fd925,()=>_0xeddcd0(_0x3a7fb2[_0x565fce(0x2f0)])),_0x1fd925['addEventListener']('click',()=>{const _0x1e55fd=_0x565fce;if(_0x4085b7)_0x102e81(_0x3a7fb2[_0x1e55fd(0x2f0)]);}),_0x1fd925;}const _0xfa1abf=_0x3a7fb2[_0x565fce(0x16d)]===_0x565fce(0x717),_0x24438b=_0x2d7d83['settings'][_0x565fce(0xbf6)]||'我',_0x4f23ed=document[_0x565fce(0x1292)](_0x565fce(0x58c));_0x4f23ed[_0x565fce(0x84)]=_0x565fce(0xd77)+(_0xfa1abf?_0x565fce(0x717):'ai');if(_0x2d7d83[_0x565fce(0x80b)]&&!_0xfa1abf){const _0x4c908c=_0x2d7d83[_0x565fce(0xd5b)][_0x565fce(0xd85)](_0x3bba6f=>_0x3bba6f[_0x565fce(0x776)]===_0x3a7fb2[_0x565fce(0xe32)]),_0x346d8c=document[_0x565fce(0x1292)]('div');_0x346d8c[_0x565fce(0x84)]=_0x565fce(0x52b),_0x346d8c[_0x565fce(0x11b0)]=_0x4c908c?_0x4c908c['groupNickname']:_0x3a7fb2['senderName']||_0x565fce(0x13a),_0x4f23ed['appendChild'](_0x346d8c);}const _0x2aab8d=document['createElement'](_0x565fce(0x58c));_0x2aab8d['className']=_0x565fce(0x104)+(_0xfa1abf?'user':'ai'),_0x2aab8d[_0x565fce(0x85)][_0x565fce(0x2f0)]=_0x3a7fb2[_0x565fce(0x2f0)];const _0x4a65b5=document['createElement']('span');_0x4a65b5[_0x565fce(0x84)]=_0x565fce(0x2f0),_0x4a65b5[_0x565fce(0x11b0)]=_0x6c25fd(_0x3a7fb2['timestamp']);let _0x2eba16,_0x5f28e0='';if(_0xfa1abf)_0x2eba16=_0x2d7d83['settings'][_0x565fce(0x1006)]||(_0x2d7d83[_0x565fce(0x80b)]?_0x200461:_0x190acc),_0x5f28e0=_0x2d7d83['settings']['myAvatarFrame']||'';else{if(_0x2d7d83['isGroup']){const _0x93ef42=_0x2d7d83[_0x565fce(0xd5b)][_0x565fce(0xd85)](_0x4f2727=>_0x4f2727['originalName']===_0x3a7fb2[_0x565fce(0xe32)]);if(_0x93ef42){const _0x1d918d=_0x12493e['chats'][_0x93ef42['id']];_0x2eba16=_0x93ef42[_0x565fce(0xbac)]||(_0x1d918d?_0x1d918d[_0x565fce(0x2ea)]['aiAvatar']:_0x5b9dd3),_0x5f28e0=_0x93ef42['avatarFrame']||(_0x1d918d?_0x1d918d['settings'][_0x565fce(0x435)]:'');}else _0x2eba16=_0x5b9dd3,_0x5f28e0='';}else _0x2eba16=_0x2d7d83[_0x565fce(0x2ea)][_0x565fce(0x18e)]||_0x190acc,_0x5f28e0=_0x2d7d83[_0x565fce(0x2ea)]['aiAvatarFrame']||'';}let _0x4dcc79;_0x5f28e0?_0x4dcc79=_0x565fce(0x129e)+_0x2eba16+_0x565fce(0xb70)+_0x5f28e0+_0x565fce(0x1175):_0x4dcc79='<img\x20src=\x22'+_0x2eba16+_0x565fce(0x7f7);const _0x224227=_0x5f28e0?_0x565fce(0xd69):'',_0x5a3bf0='<div\x20class=\x22avatar-group\x20'+_0x224227+'\x22>'+_0x4dcc79+'</div>';let _0x134a9d,_0x69c3df='';if(_0x3a7fb2[_0x565fce(0xf74)]){const _0x3c6ca5=_0x3fb61d(_0x2d7d83,_0x3a7fb2[_0x565fce(0xf74)][_0x565fce(0xe32)]),_0x3f663b=String(_0x3a7fb2[_0x565fce(0xf74)][_0x565fce(0xcbd)]||'');_0x69c3df='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quoted-message\x22\x20data-original-timestamp=\x22'+_0x3a7fb2[_0x565fce(0xf74)][_0x565fce(0x2f0)]+_0x565fce(0xee4)+_0x3c6ca5+_0x565fce(0xb6f)+_0x3f663b+_0x565fce(0x91b);}let _0x4976ca=_0x3a7fb2['content'];if(typeof _0x4976ca===_0x565fce(0x9de)&&_0x4976ca[_0x565fce(0x7da)]()[_0x565fce(0xece)]('<')&&_0x4976ca[_0x565fce(0x7da)]()['endsWith']('>'))_0x134a9d=_0x4976ca,_0x2aab8d[_0x565fce(0x10d3)][_0x565fce(0xb9)](_0x565fce(0xc0e));else{if(_0x3a7fb2[_0x565fce(0x52a)]==='offline_text'||_0x3a7fb2[_0x565fce(0x52a)]===_0x565fce(0xa6a)||_0x3a7fb2[_0x565fce(0x52a)]===_0x565fce(0x1115)||_0x3a7fb2[_0x565fce(0x52a)]===_0x565fce(0x920)||_0x3a7fb2[_0x565fce(0x52a)]===_0x565fce(0x8f5)||_0x3a7fb2[_0x565fce(0x52a)]===_0x565fce(0x142)||_0x3a7fb2[_0x565fce(0x52a)]===_0x565fce(0xb41)||_0x3a7fb2[_0x565fce(0x52a)]===_0x565fce(0xe86)||_0x3a7fb2[_0x565fce(0x52a)]==='waimai_request'||_0x3a7fb2['type']==='waimai_order'||_0x3a7fb2[_0x565fce(0x52a)]===_0x565fce(0xaa2)||_0x3a7fb2[_0x565fce(0x52a)]===_0x565fce(0x9ba)||_0x3a7fb2[_0x565fce(0x52a)]==='gift'||_0x3a7fb2[_0x565fce(0x52a)]===_0x565fce(0xd6e)||_0x3a7fb2['type']==='naiimag'){if(_0x3a7fb2[_0x565fce(0x52a)]==='offline_text'){const _0x12c7de=_0x3a7fb2['content']||((_0x3a7fb2['dialogue']||'')+'\x20'+(_0x3a7fb2['description']||''))[_0x565fce(0x7da)](),_0x5db922=/(「.*?」|“.*?”)/g,_0xa931f=_0x12c7de['split'](_0x5db922)[_0x565fce(0x1054)](_0x94030d=>_0x94030d);_0x134a9d=_0xa931f[_0x565fce(0x9d5)](_0x37cb42=>{const _0x17bd44=_0x565fce;return _0x37cb42[_0x17bd44(0xece)]('「')||_0x37cb42[_0x17bd44(0xece)]('“')?'<span\x20class=\x22offline-dialogue\x22>'+_0x45d05d(_0x37cb42)+_0x17bd44(0xc70):'<span\x20class=\x22offline-description\x22>'+_0x45d05d(_0x37cb42[_0x17bd44(0x7da)]())[_0x17bd44(0xc12)](/\n/g,_0x17bd44(0xfd5))+'</span>';})[_0x565fce(0x100b)]('');}else{if(_0x3a7fb2[_0x565fce(0x52a)]===_0x565fce(0xa6a))_0x2aab8d[_0x565fce(0x10d3)][_0x565fce(0xb9)](_0x565fce(0x1253),_0x565fce(0xe98)),_0x134a9d='<div\x20class=\x22link-share-card\x22\x20data-timestamp=\x22'+_0x3a7fb2[_0x565fce(0x2f0)]+_0x565fce(0x63c)+(_0x3a7fb2[_0x565fce(0x874)]||_0x565fce(0x645))+_0x565fce(0x45e)+(_0x3a7fb2[_0x565fce(0x11ac)]||_0x565fce(0x10e2))+_0x565fce(0x48e)+(_0x3a7fb2['source_name']||_0x565fce(0x11ad))+_0x565fce(0xaeb);else{if(_0x3a7fb2[_0x565fce(0x52a)]===_0x565fce(0x1115))_0x2aab8d[_0x565fce(0x10d3)][_0x565fce(0xb9)]('is-link-share','is-card-like'),_0x134a9d=_0x565fce(0x3cc)+_0x3a7fb2[_0x565fce(0x2f0)]+_0x565fce(0x63c)+_0x3a7fb2[_0x565fce(0xd75)][_0x565fce(0x874)]+_0x565fce(0x709)+_0x3a7fb2[_0x565fce(0xd75)][_0x565fce(0xc94)][_0x565fce(0x79b)]+'\x20条消息</div><div\x20class=\x22footer\x22><svg\x20class=\x22footer-icon\x22\x20...>...</svg><span>聊天记录</span></div></div>';else{if(_0x3a7fb2[_0x565fce(0x52a)]==='location_share'){_0x2aab8d[_0x565fce(0x10d3)][_0x565fce(0xb9)]('is-location-share',_0x565fce(0xe98));let _0x4082b9;if(_0x3a7fb2[_0x565fce(0x891)])_0x4082b9=_0x3a7fb2[_0x565fce(0x891)];else _0x12493e[_0x565fce(0x10f6)][_0x565fce(0xd2f)]&&_0x3a7fb2[_0x565fce(0xe3d)]?_0x4082b9=_0x565fce(0xda8)+encodeURIComponent(_0x3a7fb2[_0x565fce(0xe3d)]):_0x4082b9=_0x565fce(0x3fe);const _0x135e32='style=\x22background-image:\x20url(\x27'+_0x4082b9+_0x565fce(0x10cf);_0x134a9d='<div\x20class=\x22location-share-card\x22><div\x20class=\x22card-text-area\x22><div\x20class=\x22card-text-primary\x22>'+_0x3a7fb2[_0x565fce(0xcbd)]+'</div><div\x20class=\x22card-text-secondary\x22>位置分享</div></div><div\x20class=\x22card-map-area\x22\x20'+_0x135e32+_0x565fce(0xf60);}else{if(_0x3a7fb2[_0x565fce(0x52a)]==='user_photo'||_0x3a7fb2[_0x565fce(0x52a)]==='ai_image'){_0x2aab8d[_0x565fce(0x10d3)][_0x565fce(0xb9)](_0x565fce(0x70c),_0x565fce(0xe98));const _0x1e52c8=_0x3a7fb2['type']===_0x565fce(0x142)?'用户描述的照片':_0x565fce(0xf8e),_0x1ec0fe=_0x12493e[_0x565fce(0x10f6)][_0x565fce(0xd2f)]&&_0x3a7fb2[_0x565fce(0xe3d)]?_0x565fce(0xda8)+_0x3a7fb2[_0x565fce(0xe3d)]:_0x565fce(0x4c7);_0x134a9d=_0x565fce(0xb19)+_0x1ec0fe+'\x22\x20class=\x22ai-generated-image\x22\x20alt=\x22'+_0x1e52c8+'\x22\x20data-description=\x22'+_0x3a7fb2['content']+'\x22>';}else{if(_0x3a7fb2['type']==='naiimag')_0x2aab8d['classList'][_0x565fce(0xb9)](_0x565fce(0x1065),_0x565fce(0xe98)),_0x134a9d=_0x565fce(0xb19)+_0x3a7fb2[_0x565fce(0x891)]+_0x565fce(0x7c8)+(_0x3a7fb2[_0x565fce(0xf8b)]||_0x3a7fb2[_0x565fce(0x933)]||'NovelAI生成')+'\x22>';else{if(_0x3a7fb2[_0x565fce(0x52a)]===_0x565fce(0xb41)){_0x2aab8d[_0x565fce(0x10d3)][_0x565fce(0xb9)](_0x565fce(0xbf1),_0x565fce(0xe98));const _0x571e0b=Math[_0x565fce(0xbf8)](0x1,Math[_0x565fce(0x113a)]((_0x3a7fb2[_0x565fce(0xcbd)]||'')[_0x565fce(0x79b)]/0x5)),_0x480681='0:'+String(_0x571e0b)[_0x565fce(0x70d)](0x2,'0')+'\x27\x27',_0x4ea4f0=_0x565fce(0x4f3);if(_0xfa1abf)_0x134a9d=_0x565fce(0x731)+encodeURIComponent(_0x3a7fb2[_0x565fce(0xcbd)])+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-waveform\x22>'+_0x4ea4f0+_0x565fce(0xe9a)+_0x480681+_0x565fce(0x1ef);else{const _0xb1db0c=!_0x2d7d83['isGroup']&&_0x2d7d83[_0x565fce(0x2ea)]['enableTts']!==![],_0x161aba=_0x2d7d83['settings']['minimaxVoiceId']||_0x565fce(0x1290),_0xec8cfa=_0xb1db0c?_0x565fce(0xfef)+_0x161aba+'\x22':'';_0x134a9d=_0x565fce(0x731)+encodeURIComponent(_0x3a7fb2[_0x565fce(0xcbd)])+'\x22\x20'+_0xec8cfa+_0x565fce(0xf1f)+_0x4ea4f0+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22loading-spinner\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22voice-duration\x22>'+_0x480681+_0x565fce(0x1ef);}}else{if(_0x3a7fb2[_0x565fce(0x52a)]==='transfer'){_0x2aab8d[_0x565fce(0x10d3)][_0x565fce(0xb9)](_0x565fce(0x264),_0x565fce(0xe98));let _0x40f790,_0x1dd3a8;const _0xf234a9=_0x2d7d83['isGroup']?_0x2d7d83['settings'][_0x565fce(0xbf6)]||'我':'我',_0x22d3d7=_0x3fb61d(_0x2d7d83,_0x3a7fb2[_0x565fce(0xe32)]),_0x2a84f6=_0x3fb61d(_0x2d7d83,_0x3a7fb2[_0x565fce(0x204)]||_0x2d7d83['name']);if(_0xfa1abf){if(_0x3a7fb2[_0x565fce(0x151)])_0x40f790='退款给\x20'+_0x2a84f6,_0x1dd3a8='已拒收对方转账';else{_0x40f790='转账给\x20'+_0x2a84f6;if(_0x3a7fb2[_0x565fce(0xbc8)]===_0x565fce(0x316))_0x1dd3a8=_0x565fce(0x68f);else{if(_0x3a7fb2[_0x565fce(0xbc8)]===_0x565fce(0x95b))_0x1dd3a8=_0x565fce(0xf72);else _0x1dd3a8=_0x3a7fb2[_0x565fce(0x164)]||_0x565fce(0x124f);}}}else{if(_0x3a7fb2[_0x565fce(0x151)])_0x40f790=_0x565fce(0x568)+_0x22d3d7,_0x1dd3a8=_0x565fce(0xa5);else{if(_0x3a7fb2['receiverName']===_0xf234a9){_0x40f790=_0x565fce(0xb2)+_0xf234a9;if(_0x3a7fb2['status']===_0x565fce(0x316))_0x1dd3a8=_0x565fce(0x1067);else{if(_0x3a7fb2[_0x565fce(0xbc8)]===_0x565fce(0x95b))_0x1dd3a8=_0x565fce(0xb0c);else _0x2aab8d[_0x565fce(0x105d)]['cursor']=_0x565fce(0xc21),_0x2aab8d[_0x565fce(0x85)][_0x565fce(0xbc8)]=_0x565fce(0x1025),_0x1dd3a8=_0x3a7fb2[_0x565fce(0x164)]||_0x565fce(0x7ab);}}else _0x40f790='转账:\x20'+_0x22d3d7+_0x565fce(0x11fb)+_0x2a84f6,_0x1dd3a8=_0x3a7fb2[_0x565fce(0x164)]||'群聊内转账';}}const _0x2a7353='<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20width=\x2220\x22\x20height=\x2220\x22\x20fill=\x22currentColor\x22\x20style=\x22vertical-align:\x20middle;\x22><path\x20d=\x22M12\x2021.35l-1.45-1.32C5.4\x2015.36\x202\x2012.28\x202\x208.5\x202\x205.42\x204.42\x203\x207.5\x203c1.74\x200\x203.41.81\x204.5\x202.09C13.09\x203.81\x2014.76\x203\x2016.5\x203\x2019.58\x203\x2022\x205.42\x2022\x208.5c0\x203.78-3.4\x206.86-8.55\x2011.54L12\x2021.35z\x22></path></svg>';_0x134a9d=_0x565fce(0x3e5)+_0x2a7353+'\x20'+_0x40f790+_0x565fce(0x8b7)+Number(_0x3a7fb2[_0x565fce(0x609)])[_0x565fce(0xcab)](0x2)+'</div><div\x20class=\x22transfer-note\x22>'+_0x1dd3a8+'</div></div>';}else{if(_0x3a7fb2['type']===_0x565fce(0x71d)){_0x2aab8d[_0x565fce(0x10d3)]['add'](_0x565fce(0x9ce),_0x565fce(0xe98));if(_0x3a7fb2[_0x565fce(0xbc8)]===_0x565fce(0x5ec)||_0x3a7fb2['status']===_0x565fce(0x923))_0x2aab8d[_0x565fce(0x10d3)][_0x565fce(0xb9)](_0x565fce(0xdac)+_0x3a7fb2[_0x565fce(0xbc8)]);const _0x31be9a=_0x3fb61d(_0x2d7d83,_0x3a7fb2[_0x565fce(0xe32)]),_0x40d17d='来自\x20'+_0x31be9a+_0x565fce(0x1166);let _0x25faf4='';_0x3a7fb2[_0x565fce(0xbc8)]===_0x565fce(0x1025)&&!_0xfa1abf&&(_0x25faf4='<div\x20class=\x22waimai-user-actions\x22><button\x20class=\x22waimai-decline-btn\x22\x20data-choice=\x22rejected\x22>残忍拒绝</button><button\x20class=\x22waimai-pay-btn\x22\x20data-choice=\x22paid\x22>为Ta买单</button></div>'),_0x134a9d=_0x565fce(0xe84)+_0x40d17d+_0x565fce(0x57f)+Number(_0x3a7fb2['amount'])[_0x565fce(0xcab)](0x2)+_0x565fce(0xb13)+_0x3a7fb2[_0x565fce(0x2f0)]+'\x22></div></div></div><button\x20class=\x22waimai-details-btn\x22>查看详情</button></div>'+_0x25faf4+'</div>',setTimeout(()=>{const _0x1dc402=_0x565fce;if(_0x3a7fb2[_0x1dc402(0xbc8)]===_0x1dc402(0x1025)){const _0x5975ac=document[_0x1dc402(0xc33)](_0x1dc402(0xa7e)+_0x3a7fb2['timestamp']);if(_0x5975ac){const _0x208a05=_0x4de697(_0x5975ac,_0x3a7fb2[_0x1dc402(0x10d6)]);_0x4bc591[_0x3a7fb2[_0x1dc402(0x2f0)]]=_0x208a05;}}},0x0);}else{if(_0x3a7fb2[_0x565fce(0x52a)]===_0x565fce(0x329)){_0x2aab8d['classList'][_0x565fce(0xb9)](_0x565fce(0x9ce),'is-card-like');const _0x38eced=_0x3fb61d(_0x2d7d83,_0x3a7fb2[_0x565fce(0xe32)]);let _0x191833='你';_0x2d7d83[_0x565fce(0x80b)]&&(_0x191833=_0x3fb61d(_0x2d7d83,_0x3a7fb2[_0x565fce(0xd4c)])),_0x134a9d=_0x565fce(0xf22)+_0x38eced+_0x565fce(0x577)+_0x191833+_0x565fce(0xc09)+_0x3a7fb2[_0x565fce(0x11d3)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amount\x22\x20style=\x22margin-top:\x208px;\x22>¥'+Number(_0x3a7fb2[_0x565fce(0x609)])[_0x565fce(0xcab)](0x2)+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22waimai-details-btn\x22>查看订单详情</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20';}else{if(_0x3a7fb2[_0x565fce(0x52a)]==='red_packet'){_0x2aab8d['classList'][_0x565fce(0xb9)](_0x565fce(0x8b),_0x565fce(0xe98));const _0x5fe305=_0x12493e['qzoneSettings']['nickname']||_0x565fce(0x10d0),_0x17cb06=_0x3a7fb2[_0x565fce(0x1140)],_0x282ff8=_0x3a7fb2[_0x565fce(0xea5)]&&_0x3a7fb2[_0x565fce(0xea5)][_0x5fe305];let _0x1b026f='',_0x50f2a0='',_0xce90b3='拼手气红包';_0x17cb06&&(_0x1b026f=_0x565fce(0x53e));if(_0x3a7fb2[_0x565fce(0xa2a)]===_0x565fce(0x3d4)){const _0x399ca5=_0x3fb61d(_0x2d7d83,_0x3a7fb2[_0x565fce(0x204)]);_0xce90b3='专属红包:\x20给\x20'+_0x399ca5;if(Object[_0x565fce(0x1c6)](_0x3a7fb2['claimedBy']||{})[_0x565fce(0x79b)]>0x0)_0x1b026f=_0x565fce(0x53e);}if(_0x282ff8){const _0x2e9524=_0x3a7fb2[_0x565fce(0xea5)][_0x5fe305]||0x0;_0x50f2a0=_0x565fce(0x1110)+_0x2e9524[_0x565fce(0xcab)](0x2)+'\x20元</div>';}else{if(_0x17cb06)_0x50f2a0='<div\x20class=\x22rp-claimed-info\x22>红包已被领完</div>';else{if(_0x3a7fb2[_0x565fce(0xa2a)]===_0x565fce(0x3d4)&&Object['keys'](_0x3a7fb2[_0x565fce(0xea5)]||{})['length']>0x0){const _0x2d469a=_0x3fb61d(_0x2d7d83,_0x3a7fb2[_0x565fce(0x204)]);_0x50f2a0='<div\x20class=\x22rp-claimed-info\x22>已被\x20'+_0x2d469a+_0x565fce(0x592);}}}_0x134a9d='<div\x20class=\x22red-packet-card\x20'+_0x1b026f+'\x22><div\x20class=\x22rp-header\x22><img\x20src=\x22https://files.catbox.moe/lo9xhc.png\x22\x20class=\x22rp-icon\x22><span\x20class=\x22rp-greeting\x22>'+(_0x3a7fb2[_0x565fce(0x9b5)]||_0x565fce(0x759))+_0x565fce(0x7b6)+_0xce90b3+_0x565fce(0xb45)+_0x50f2a0+_0x565fce(0xb45);}else{if(_0x3a7fb2[_0x565fce(0x52a)]===_0x565fce(0x9ba)){_0x2aab8d[_0x565fce(0x10d3)]['add'](_0x565fce(0x122d),_0x565fce(0xe98));const _0x3cc727=_0x3a7fb2[_0x565fce(0x11a3)]||_0x3a7fb2['content']||'(无标题投票)';let _0x1c2be6=0x0;const _0x4a1af3={};for(const _0x56e3cb in _0x3a7fb2[_0x565fce(0x4d4)]){const _0x43cf29=_0x3a7fb2[_0x565fce(0x4d4)][_0x56e3cb][_0x565fce(0x79b)];_0x4a1af3[_0x56e3cb]=_0x43cf29,_0x1c2be6+=_0x43cf29;}const _0x54cb39=_0x12493e[_0x565fce(0x76c)][_0x565fce(0x66a)]||'{{user}}';let _0x470c20=null;for(const _0x32bf79 in _0x3a7fb2['votes']){if(_0x3a7fb2[_0x565fce(0x4d4)][_0x32bf79][_0x565fce(0x1d4)](_0x54cb39)){_0x470c20=_0x32bf79;break;}}let _0x592f5f=_0x565fce(0xd1);_0x3a7fb2[_0x565fce(0x6c2)]['forEach'](_0x55bfa6=>{const _0x346fa5=_0x565fce,_0x5c4718=_0x4a1af3[_0x55bfa6]||0x0,_0x116327=_0x1c2be6>0x0?_0x5c4718/_0x1c2be6*0x64:0x0,_0x48148c=_0x470c20===_0x55bfa6;_0x592f5f+=_0x346fa5(0x72f)+(_0x48148c?'voted':'')+'\x22\x20data-option=\x22'+_0x55bfa6+_0x346fa5(0x10f4)+_0x116327+'%;\x22></div><div\x20class=\x22poll-option-content\x22><span\x20class=\x22poll-option-text\x22>'+_0x55bfa6+_0x346fa5(0xf9a)+_0x5c4718+_0x346fa5(0xdfa);}),_0x592f5f+=_0x565fce(0xb45);let _0x2d2656=_0x3a7fb2[_0x565fce(0xead)]?'<div\x20class=\x22poll-footer\x22><span\x20class=\x22poll-total-votes\x22>共\x20'+_0x1c2be6+_0x565fce(0x27f):'<div\x20class=\x22poll-footer\x22><span\x20class=\x22poll-total-votes\x22>共\x20'+_0x1c2be6+_0x565fce(0xc3e);_0x134a9d=_0x565fce(0x3b7)+(_0x3a7fb2[_0x565fce(0xead)]?_0x565fce(0x1171):'')+_0x565fce(0xccb)+_0x3a7fb2['timestamp']+_0x565fce(0x687)+_0x3cc727+'</div>'+_0x592f5f+_0x2d2656+_0x565fce(0xb45);}else{if(_0x3a7fb2[_0x565fce(0x52a)]==='gift'){_0x2aab8d[_0x565fce(0x10d3)][_0x565fce(0xb9)](_0x565fce(0xf4b),_0x565fce(0xe98));let _0x5b7594;const _0x1f4da8=_0x2d7d83[_0x565fce(0x2ea)]['myNickname']||'我';if(_0x2d7d83[_0x565fce(0x80b)]){if(_0x3a7fb2['recipients']&&_0x3a7fb2[_0x565fce(0x2e7)][_0x565fce(0x79b)]>0x0){const _0x1f2837=_0x3a7fb2['recipients']['map'](_0x34c674=>_0x3fb61d(_0x2d7d83,_0x34c674));_0x1f2837['length']===0x1?_0x5b7594=_0x565fce(0x1036)+_0x1f2837[0x0]+_0x565fce(0x1104):_0x5b7594=_0x565fce(0x1036)+_0x1f2837[_0x565fce(0x111c)](0x0,0x2)[_0x565fce(0x100b)]('、')+_0x565fce(0xf19);}else _0x5b7594='送给大家的礼物';}else{if(_0xfa1abf)_0x5b7594=_0x565fce(0x1036)+_0x2d7d83['name']+_0x565fce(0x1104);else{const _0x2668ae=_0x2d7d83[_0x565fce(0x2ea)]['myNickname']||'你';_0x5b7594=_0x565fce(0x1036)+_0x2668ae+_0x565fce(0x1104);}}const _0xa5aa0e=_0x3a7fb2['items'][_0x565fce(0x111c)](0x0,0x3);let _0x5e0ded='';_0xa5aa0e['forEach'](_0x49570b=>{const _0xa31ba9=_0x565fce;_0x5e0ded+=_0xa31ba9(0x5e0)+_0x49570b[_0xa31ba9(0x891)]+_0xa31ba9(0x20b)+_0x49570b[_0xa31ba9(0x578)]+_0xa31ba9(0xc1)+_0x49570b['quantity']+_0xa31ba9(0x1a3);});let _0x2dc3de='';_0x3a7fb2['items'][_0x565fce(0x79b)]>0x3&&(_0x2dc3de='\x20等'+_0x3a7fb2[_0x565fce(0x88d)][_0x565fce(0x79b)]+'件商品'),_0x134a9d=_0x565fce(0x60a)+_0x5b7594+'</span></div><div\x20class=\x22gift-items-preview\x22>'+_0x5e0ded+_0x565fce(0xbd6)+_0x3a7fb2[_0x565fce(0x88d)][_0x565fce(0x79b)]+_0x565fce(0x10be)+_0x2dc3de+_0x565fce(0x6bb);}}}}}}}}}}}}}}else{const _0x387dfe=String(_0x4976ca);let _0x3e1f3b=await _0x141392(_0x387dfe,_0x2d7d83['id']);if(_0x3e1f3b!==_0x387dfe)_0x134a9d=_0x3e1f3b,_0x2aab8d['classList'][_0x565fce(0xb9)]('is-card-like');else{if(Array[_0x565fce(0x621)](_0x3a7fb2[_0x565fce(0xcbd)])&&_0x3a7fb2['content'][0x0]?.[_0x565fce(0x52a)]===_0x565fce(0x10a1)){const _0x5624c9=_0x3a7fb2['content'][0x0][_0x565fce(0x10a1)][_0x565fce(0x11a)];_0x134a9d=_0x565fce(0xb19)+_0x5624c9+_0x565fce(0x835);}else{if(_0x301121[_0x565fce(0x677)](_0x3e1f3b))_0x2aab8d[_0x565fce(0x10d3)][_0x565fce(0xb9)](_0x565fce(0xd10),_0x565fce(0xe98)),_0x134a9d=_0x565fce(0xb19)+_0x3e1f3b+'\x22\x20alt=\x22'+(_0x3a7fb2[_0x565fce(0x127d)]||_0x565fce(0xdaa))+_0x565fce(0x45c);else{let _0x4af4ba=_0x1eca28(_0x3e1f3b,_0x2d7d83);_0x134a9d=_0x45d05d(_0x4af4ba)['replace'](/\n/g,_0x565fce(0xfd5));}}}}}_0x2aab8d[_0x565fce(0x102a)]=_0x565fce(0x188)+_0x5a3bf0+_0x565fce(0x1c3)+_0x69c3df+_0x565fce(0x7dc)+_0x134a9d+_0x565fce(0x96a),_0x4f23ed[_0x565fce(0xf77)](_0x2aab8d),_0x4f23ed['appendChild'](_0x4a65b5),_0x29b870(_0x4f23ed,()=>_0xeddcd0(_0x3a7fb2[_0x565fce(0x2f0)])),_0x4f23ed[_0x565fce(0x205)](_0x565fce(0x335),()=>{const _0xeb2b4d=_0x565fce;if(_0x4085b7)_0x102e81(_0x3a7fb2[_0xeb2b4d(0x2f0)]);});if(!_0xfa1abf){const _0xa7cd58=_0x4f23ed[_0x565fce(0x977)](_0x565fce(0x53f));_0xa7cd58&&(_0xa7cd58[_0x565fce(0x105d)][_0x565fce(0x437)]=_0x565fce(0xc21),!_0x2d7d83[_0x565fce(0x80b)]?_0xa7cd58['addEventListener'](_0x565fce(0x335),_0x5ecb25=>{const _0x131db9=_0x565fce;_0x5ecb25[_0x131db9(0xea2)](),_0x51e92a(_0x2d7d83['id']);}):_0xa7cd58[_0x565fce(0x205)](_0x565fce(0xc6e),_0x27ce10=>{const _0x4d5414=_0x565fce;_0x27ce10[_0x4d5414(0xea2)](),_0x893b88(_0x2d7d83['id'],_0x3a7fb2[_0x4d5414(0xe32)]);}));}return _0x4f23ed;}async function _0x500ec1(_0x11c70f,_0x951e0){const _0x3afdcc=_0x247bea,_0x98a5a5=document[_0x3afdcc(0xc33)](_0x3afdcc(0xe81)),_0x258581=await _0x3f3a68(_0x11c70f,_0x951e0);if(!_0x258581)return;const _0x8c2622=document[_0x3afdcc(0xc33)](_0x3afdcc(0x107c));_0x8c2622?_0x98a5a5[_0x3afdcc(0x829)](_0x258581,_0x8c2622[_0x3afdcc(0x192)]):_0x98a5a5[_0x3afdcc(0x9e1)](_0x258581);}async function _0x468ef0(_0x588f3d,_0x2bbac4,_0x3c7711=![]){const _0x212624=_0x247bea,_0x491ec9=document[_0x212624(0xc33)]('chat-messages'),_0x2b2e77=document[_0x212624(0xc33)](_0x212624(0x4f6)),_0x266bed=_0x2bbac4[_0x212624(0x1294)][_0x212624(0x1054)](_0x3060a5=>!_0x3060a5[_0x212624(0xd07)])[_0x212624(0xf56)]();if(_0x266bed&&_0x588f3d[_0x212624(0x2f0)]-_0x266bed[_0x212624(0x2f0)]>0x927c0){const _0x306c04=_0x58cae3(_0x588f3d['timestamp']);_0x491ec9['insertBefore'](_0x306c04,_0x2b2e77);}const _0x5e4cc8=await _0x3f3a68(_0x588f3d,_0x2bbac4);if(!_0x5e4cc8)return;_0x588f3d[_0x212624(0x16d)]===_0x212624(0x376)&&!_0x3c7711&&_0x52e066(),!_0x3c7711&&_0x5e4cc8[_0x212624(0x10d3)]['add'](_0x212624(0x489)),_0x491ec9[_0x212624(0x829)](_0x5e4cc8,_0x2b2e77),!_0x3c7711&&(_0x491ec9[_0x212624(0x1244)]=_0x491ec9[_0x212624(0xa87)],_0x5c866f++);}async function _0x157ff1(_0x2ee8d3){const _0x538b33=_0x247bea;_0x12493e[_0x538b33(0x7bc)]=_0x2ee8d3;const _0x18e8d4=_0x12493e[_0x538b33(0xc45)][_0x2ee8d3];if(!_0x18e8d4)return;_0x18e8d4[_0x538b33(0xdc5)]>0x0&&(_0x18e8d4['unreadCount']=0x0,await _0x2a2987['chats'][_0x538b33(0xf36)](_0x18e8d4));_0x416194(_0x18e8d4),_0x1bbfd3(_0x2ee8d3),_0x38f00f('chat-interface-screen'),window[_0x538b33(0xe62)](_0x12493e['activeChatId']);const _0x2f83a9=_0x18e8d4['isGroup']||![];_0x4c4c1c(_0x2f83a9),document[_0x538b33(0xc33)](_0x538b33(0x9f8))[_0x538b33(0x105d)]['display']=_0x2f83a9?_0x538b33(0x21a):_0x538b33(0x854);const _0x560939=document[_0x538b33(0xc33)](_0x538b33(0x75e));_0x560939&&(_0x560939[_0x538b33(0x105d)][_0x538b33(0xf44)]=_0x2f83a9?_0x538b33(0x854):'flex');const _0x262857=document[_0x538b33(0xc33)]('propel-btn'),_0x553710=document[_0x538b33(0xc33)](_0x538b33(0x14f)),_0x4f0cb0=document['getElementById'](_0x538b33(0xaf3)),_0x2cc624=document[_0x538b33(0xc33)](_0x538b33(0x11b1));_0x553710&&_0x4f0cb0&&_0x2cc624&&_0x262857&&(_0x553710[_0x538b33(0x105d)]['display']=_0x538b33(0x21a),_0x4f0cb0[_0x538b33(0x105d)][_0x538b33(0xf44)]=_0x2f83a9?_0x538b33(0x854):_0x538b33(0x21a),_0x2cc624[_0x538b33(0x105d)][_0x538b33(0xf44)]=_0x2f83a9?_0x538b33(0x21a):_0x538b33(0x854),_0x262857[_0x538b33(0x105d)][_0x538b33(0xf44)]=_0x2f83a9?_0x538b33(0x854):_0x538b33(0x21a)),_0x1f4bf2(),!_0x18e8d4[_0x538b33(0x80b)]&&_0x18e8d4[_0x538b33(0x1cb)]?.[_0x538b33(0xbc8)]===_0x538b33(0x4ab)&&(console[_0x538b33(0x51f)](_0x538b33(0xeee)+_0x18e8d4[_0x538b33(0x578)]+_0x538b33(0xc81)),_0x439587()),document[_0x538b33(0xc33)]('send-poll-btn')[_0x538b33(0x105d)][_0x538b33(0xf44)]=_0x2f83a9?'flex':_0x538b33(0x854);}function _0x15197e(_0x3c310b,_0x18aaee){const _0x27c9fb=_0x247bea,_0x49b0ad=_0x18aaee?_0x27c9fb(0xb9):_0x27c9fb(0x2c7),_0x546c73=_0x3fe7b2=>{const _0x13bb0a=_0x27c9fb;_0x3fe7b2&&_0x3fe7b2[_0x13bb0a(0x10d3)][_0x49b0ad](_0x13bb0a(0xe5a));},_0x3aebae=document[_0x27c9fb(0x977)](_0x27c9fb(0x20e)+_0x3c310b+_0x27c9fb(0xc0a));_0x546c73(_0x3aebae);const _0x277b8c=document[_0x27c9fb(0x67a)](_0x27c9fb(0xf10)+_0x3c310b+'\x22]');_0x277b8c['forEach'](_0x546c73);const _0x438936=document[_0x27c9fb(0x977)]('.participant-avatar[data-participant-id=\x22'+_0x3c310b+'\x22]');_0x546c73(_0x438936);}async function _0x2fb62c(){const _0x453d97=_0x247bea;if(!_0x12493e[_0x453d97(0x7bc)])return;const _0x294e8a=_0x12493e[_0x453d97(0x7bc)],_0x35cbe6=_0x12493e[_0x453d97(0xc45)][_0x294e8a];lastRawAiResponse='',lastResponseTimestamps=[];const _0x1a3ea7=document[_0x453d97(0xc33)](_0x453d97(0x124c));_0x1a3ea7&&(_0x1a3ea7['disabled']=!![],_0x1a3ea7[_0x453d97(0x11b0)]=_0x453d97(0x99f));_0x15197e(_0x294e8a,!![]);try{const {proxyUrl:_0x38c2fb,apiKey:_0x3234b5,model:_0x34593e}=_0x12493e[_0x453d97(0xdd4)];if(!_0x38c2fb||!_0x3234b5||!_0x34593e)throw new Error('API未配置，无法生成对话。');const _0x3c393a=parseInt(_0x35cbe6[_0x453d97(0x2ea)][_0x453d97(0x660)])||0xa,_0x1dcdff=_0x35cbe6[_0x453d97(0x1294)][_0x453d97(0x111c)](-_0x3c393a);let _0x192096='';if(_0x35cbe6[_0x453d97(0x2ea)][_0x453d97(0xeca)]&&_0x35cbe6[_0x453d97(0x2ea)][_0x453d97(0xeca)]['length']>0x0){const _0x20267d=_0x35cbe6[_0x453d97(0x2ea)][_0x453d97(0xeca)][_0x453d97(0x9d5)](_0x592c69=>{const _0x527d59=_0x453d97,_0x4d5733=_0x12493e['worldBooks'][_0x527d59(0xd85)](_0x597b6d=>_0x597b6d['id']===_0x592c69);if(!_0x4d5733||!Array['isArray'](_0x4d5733[_0x527d59(0xcbd)]))return'';const _0x3deff2=_0x4d5733[_0x527d59(0xcbd)][_0x527d59(0x1054)](_0x34945a=>_0x34945a[_0x527d59(0x95a)]!==![])[_0x527d59(0x9d5)](_0x394830=>{const _0x4df28d=_0x527d59;let _0x251135='\x0a###\x20条目:\x20'+(_0x394830[_0x4df28d(0x8db)]||'无备注')+'\x0a';if(_0x394830[_0x4df28d(0x1c6)][_0x4df28d(0x79b)]>0x0)_0x251135+=_0x4df28d(0x2ca)+_0x394830[_0x4df28d(0x1c6)]['join'](',\x20')+'\x0a';return _0x251135+=_0x4df28d(0xb02)+_0x394830[_0x4df28d(0xcbd)],_0x251135;})[_0x527d59(0x100b)]('');return _0x3deff2?_0x527d59(0xc39)+_0x4d5733['name']+'\x0a'+_0x3deff2:'';})[_0x453d97(0x1054)](Boolean)[_0x453d97(0x100b)]('');_0x20267d&&(_0x192096='#\x20---\x20世界书\x20(World\x20Book)\x20---\x0a#\x20【最高优先级规则：世界观设定】\x0a#\x20你【必须】将以下所有“世界书”中的设定，视为绝对的、不可动摇的背景事实。\x0a#\x20你的所有回复和行为都【绝对不能】与这些设定产生任何冲突。\x0a'+_0x20267d+_0x453d97(0x442));}let _0x52ffc8=_0x453d97(0x1258),_0x1c0b5c=![];_0x35cbe6[_0x453d97(0xd5b)][_0x453d97(0xd6a)](_0x3642b9=>{const _0x4f2a20=_0x453d97,_0x5cf7d5=_0x12493e[_0x4f2a20(0xc45)][_0x3642b9['id']];_0x5cf7d5&&_0x5cf7d5[_0x4f2a20(0x45b)]&&_0x5cf7d5[_0x4f2a20(0x45b)][_0x4f2a20(0x79b)]>0x0&&(_0x52ffc8+='\x0a##\x20---\x20关于“'+_0x3642b9[_0x4f2a20(0x6e2)]+_0x4f2a20(0x10c4),_0x52ffc8+=_0x5cf7d5[_0x4f2a20(0x45b)]['map'](_0x56fdaa=>'-\x20(记录于\x20'+_0x3ce8f0(_0x56fdaa['timestamp'])+')\x20'+_0x56fdaa[_0x4f2a20(0xcbd)])[_0x4f2a20(0x100b)]('\x0a'),_0x1c0b5c=!![]);});!_0x1c0b5c&&(_0x52ffc8+=_0x453d97(0x380));let _0x2a1605='';const _0x9df68b=_0x35cbe6[_0x453d97(0x2ea)][_0x453d97(0x528)]||0xa;if(_0x35cbe6['settings'][_0x453d97(0x48b)]&&_0x35cbe6[_0x453d97(0x2ea)][_0x453d97(0x48b)][_0x453d97(0x79b)]>0x0){}const _0x5a694e=_0x35cbe6[_0x453d97(0xd5b)][_0x453d97(0x9d5)](_0x193408=>_0x453d97(0x100f)+_0x193408[_0x453d97(0x6e2)]+_0x453d97(0xb14)+_0x193408[_0x453d97(0x776)]+_0x453d97(0x3ec)+_0x193408[_0x453d97(0x421)])[_0x453d97(0x100b)]('\x0a'),_0x479c2b=_0x4d75d0(_0x35cbe6),_0x3ce88e=_0x453d97(0xedd)+_0x35cbe6['name']+_0x453d97(0x6dd)+_0x35cbe6['name']+_0x453d97(0x90d)+_0x52ffc8+'\x0a'+_0x192096+'\x0a'+_0x2a1605+_0x453d97(0xa9f)+_0x1dcdff[_0x453d97(0x9d5)](_0x14420b=>_0x3fb61d(_0x35cbe6,_0x14420b[_0x453d97(0xe32)])+':\x20'+_0x14420b[_0x453d97(0xcbd)])[_0x453d97(0x100b)]('\x0a')+_0x453d97(0x374)+_0x5a694e+_0x453d97(0x1227)+_0x479c2b+'\x0a现在，请根据以上所有信息，继续这场没有用户参与的群聊，并自由地使用各种指令来丰富你们的互动。\x0a',_0x3915c8=_0x1dcdff['map'](_0x4d8719=>({'role':_0x453d97(0x717),'content':_0x3fb61d(_0x35cbe6,_0x4d8719['senderName'])+':\x20'+_0x4d8719['content']}));let _0x1ca45e=_0x38c2fb['includes'](_0x453d97(0xd60)),_0xf07e2b;if(_0x1ca45e){let _0x517bc0=_0x202ea1(_0x34593e,_0x3234b5,_0x3ce88e,_0x3915c8);_0xf07e2b=await fetch(_0x517bc0[_0x453d97(0x11a)],_0x517bc0[_0x453d97(0xa78)]);}else _0xf07e2b=await fetch(_0x38c2fb+'/v1/chat/completions',{'method':_0x453d97(0x90),'headers':{'Content-Type':_0x453d97(0xd74),'Authorization':_0x453d97(0xf20)+_0x3234b5},'body':JSON[_0x453d97(0xd27)]({'model':_0x34593e,'messages':[{'role':_0x453d97(0x152),'content':_0x3ce88e},..._0x3915c8],'temperature':_0x12493e[_0x453d97(0x10f6)][_0x453d97(0xd52)]||0.9})});if(!_0xf07e2b['ok']){const _0x5915b8=await _0xf07e2b[_0x453d97(0x79e)]()['catch'](()=>({'error':{'message':_0xf07e2b['statusText']}}));throw new Error('API\x20请求失败:\x20'+_0xf07e2b[_0x453d97(0xbc8)]+_0x453d97(0x804)+(_0x5915b8[_0x453d97(0x4d9)]?.['message']||_0x453d97(0xb8a)));}const _0x1dfe9b=await _0xf07e2b['json'](),_0x43e9d6=getGeminiResponseText(_0x1dfe9b);lastRawAiResponse=_0x43e9d6;const _0x1cda76=_0x4c5aa1(_0x43e9d6);let _0x3b13ed=Date[_0x453d97(0x6ee)]();for(const _0x9a2e35 of _0x1cda76){if(!_0x9a2e35||!_0x9a2e35[_0x453d97(0x52a)]||!_0x9a2e35['name'])continue;let _0x49120d=null;const _0x3aa967=_0x3b13ed++;lastResponseTimestamps[_0x453d97(0x2d6)](_0x3aa967);const _0x2e675b={'role':_0x453d97(0x376),'senderName':_0x9a2e35[_0x453d97(0x578)],'timestamp':_0x3aa967};switch(_0x9a2e35[_0x453d97(0x52a)]){case'text':_0x49120d={..._0x2e675b,'content':_0x9a2e35[_0x453d97(0xcbd)]};break;case _0x453d97(0x966):if(_0x9a2e35['meaning']){const _0x449ee7=_0x12493e[_0x453d97(0x454)]['find'](_0x25df81=>_0x25df81[_0x453d97(0x578)]===_0x9a2e35['meaning']);_0x449ee7?_0x49120d={..._0x2e675b,'type':_0x453d97(0x966),'content':_0x449ee7[_0x453d97(0x11a)],'meaning':_0x449ee7['name']}:(console[_0x453d97(0x54a)]('旁观模式AI尝试使用不存在的表情:\x20\x22'+_0x9a2e35[_0x453d97(0x127d)]+'\x22'),_0x49120d={..._0x2e675b,'type':_0x453d97(0x996),'content':_0x453d97(0xa21)+_0x9a2e35[_0x453d97(0x127d)]+']'});}else console[_0x453d97(0x54a)](_0x453d97(0xfcd),_0x9a2e35);break;case'ai_image':_0x49120d={..._0x2e675b,'type':'ai_image','content':_0x9a2e35[_0x453d97(0x11ac)],'image_prompt':_0x9a2e35[_0x453d97(0xe3d)]};break;case _0x453d97(0xb41):_0x49120d={..._0x2e675b,'type':_0x453d97(0xb41),'content':_0x9a2e35[_0x453d97(0xcbd)]};break;case _0x453d97(0x4bf):const _0x157106=_0x35cbe6[_0x453d97(0x1294)][_0x453d97(0xd85)](_0x42f95f=>_0x42f95f[_0x453d97(0x2f0)]===_0x9a2e35[_0x453d97(0xdbb)]);_0x157106?_0x49120d={..._0x2e675b,'content':_0x9a2e35['reply_content'],'quote':{'timestamp':_0x157106['timestamp'],'senderName':_0x157106[_0x453d97(0xe32)],'content':String(_0x157106[_0x453d97(0xcbd)]||'')['substring'](0x0,0x32)}}:_0x49120d={..._0x2e675b,'content':_0x9a2e35[_0x453d97(0xa32)]};break;default:console[_0x453d97(0x54a)](_0x453d97(0x475),_0x9a2e35['type']);continue;}_0x49120d&&(_0x35cbe6[_0x453d97(0x1294)][_0x453d97(0x2d6)](_0x49120d),_0x468ef0(_0x49120d,_0x35cbe6),await new Promise(_0x14e394=>setTimeout(_0x14e394,Math['random']()*0x4b0+0x320)));}await _0x2a2987['chats'][_0x453d97(0xf36)](_0x35cbe6),_0x597ed7();}catch(_0x2f132f){console[_0x453d97(0x4d9)](_0x453d97(0xe01),_0x2f132f),await _0x2d7ddd(_0x453d97(0xb9d),_0x453d97(0x10d5)+_0x2f132f[_0x453d97(0xf93)]);}finally{_0x1a3ea7&&(_0x1a3ea7[_0x453d97(0xfd8)]=![],_0x1a3ea7[_0x453d97(0x11b0)]=_0x453d97(0x2df)),_0x15197e(_0x294e8a,![]);}}async function _0x439587(){const _0xf92e1=_0x247bea;if(!_0x12493e['activeChatId'])return;const _0x47893f=_0x12493e[_0xf92e1(0x7bc)],_0x1730bb=_0x12493e[_0xf92e1(0xc45)][_0x12493e[_0xf92e1(0x7bc)]],_0x30dc43=document[_0xf92e1(0xc33)](_0xf92e1(0xf1b))[_0xf92e1(0x10d3)][_0xf92e1(0x3af)](_0xf92e1(0x1043))&&_0x12493e[_0xf92e1(0x7bc)]===_0x47893f;_0x15197e(_0x47893f,!![]);const _0x160388=document[_0xf92e1(0xc33)](_0xf92e1(0x40c)),_0x2c63d9=document[_0xf92e1(0xc33)](_0xf92e1(0x4f6)),_0x26d32d=document[_0xf92e1(0x977)](_0xf92e1(0x20e)+_0x47893f+'\x22]'),_0x191f36=_0x26d32d?_0x26d32d[_0xf92e1(0x977)](_0xf92e1(0x84d)):null;_0x191f36&&_0x191f36['classList'][_0xf92e1(0xb9)](_0xf92e1(0xe5a));_0x1730bb[_0xf92e1(0x80b)]?_0x2c63d9&&(_0x2c63d9[_0xf92e1(0x11b0)]='成员们正在输入...',_0x2c63d9[_0xf92e1(0x105d)][_0xf92e1(0xf44)]='block'):_0x160388&&(_0x160388[_0xf92e1(0x105d)][_0xf92e1(0x8d1)]=0x0,setTimeout(()=>{const _0xfe601a=_0xf92e1;_0x160388[_0xfe601a(0x11b0)]=_0xfe601a(0x10a7),_0x160388[_0xfe601a(0x10d3)][_0xfe601a(0xb9)](_0xfe601a(0x1201)),_0x160388[_0xfe601a(0x105d)][_0xfe601a(0x8d1)]=0x1;},0xc8));let _0x5a73dc=![];try{const {proxyUrl:_0x13aa4f,apiKey:_0x1412c4,model:_0x5bb22f}=_0x12493e['apiConfig'];if(!_0x13aa4f||!_0x1412c4||!_0x5bb22f){alert('请先在API设置中配置反代地址、密钥并选择模型。');if(_0x1730bb[_0xf92e1(0x80b)]){if(_0x2c63d9)_0x2c63d9['style'][_0xf92e1(0xf44)]=_0xf92e1(0x854);}else _0x160388&&_0x12493e[_0xf92e1(0xc45)][_0x47893f]&&(_0x160388[_0xf92e1(0x11b0)]=_0x12493e['chats'][_0x47893f][_0xf92e1(0x578)],_0x160388[_0xf92e1(0x10d3)][_0xf92e1(0x2c7)](_0xf92e1(0x1201)));return;}const _0x392e7e=_0x1730bb[_0xf92e1(0x1294)][_0xf92e1(0x111c)](-0x1)[0x0],_0x3dbe40=_0x392e7e&&_0x392e7e['role']==='system'&&_0x392e7e['content']['includes'](_0xf92e1(0x2b0));if(_0x3dbe40){console[_0xf92e1(0x51f)](_0xf92e1(0x89d)+_0x1730bb[_0xf92e1(0x578)]+_0xf92e1(0x541));let _0x247ba7;_0x1730bb[_0xf92e1(0x80b)]?_0x247ba7=_0xf92e1(0x59d)+_0x1730bb['members'][_0xf92e1(0x9d5)](_0x21b6cd=>'-\x20'+_0x21b6cd[_0xf92e1(0x6e2)]+'\x20(本名:\x20'+_0x21b6cd['originalName']+'):\x20'+_0x21b6cd['persona'])[_0xf92e1(0x100b)]('\x0a')+_0xf92e1(0xf6):_0x247ba7=_0xf92e1(0x1099)+_0x1730bb[_0xf92e1(0x2ea)][_0xf92e1(0x679)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须且只能】是以下两种格式之一的JSON数组，绝对不能回复任何其他内容：\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20接受:\x20\x27[{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22accept\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20拒绝:\x20\x27[{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22reject\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请立即做出决策。';const _0x44860b=[{'role':_0xf92e1(0x717),'content':_0x247ba7}];try{let _0x3d93ab=_0x202ea1(_0x5bb22f,_0x1412c4,_0x247ba7,_0x44860b),_0x1d7484=_0x13aa4f===GEMINI_API_URL;const _0x2de1e8=_0x1d7484?await fetch(_0x3d93ab['url'],_0x3d93ab[_0xf92e1(0xa78)]):await fetch(_0x13aa4f+_0xf92e1(0x399),{'method':_0xf92e1(0x90),'headers':{'Content-Type':'application/json','Authorization':_0xf92e1(0xf20)+_0x1412c4},'body':JSON[_0xf92e1(0xd27)]({'model':_0x5bb22f,'messages':_0x44860b,'temperature':0.7})});if(!_0x2de1e8['ok'])throw new Error('API失败:\x20'+(await _0x2de1e8['json']())[_0xf92e1(0x4d9)][_0xf92e1(0xf93)]);const _0x527874=await _0x2de1e8[_0xf92e1(0x79e)](),_0x698a09=getGeminiResponseText(_0x527874),_0x461650=_0x4c5aa1(_0x698a09);let _0x771422=![];for(const _0x5a335d of _0x461650){if(_0x5a335d[_0xf92e1(0x52a)]===_0xf92e1(0x120b)){_0x3b6ec9[_0xf92e1(0xd0)]=![];if(_0x5a335d['decision']===_0xf92e1(0x61b))_0x8b7bf9();else{const _0x41da0f={'role':_0xf92e1(0x376),'content':'对方拒绝了你的视频通话请求。','timestamp':Date['now']()};_0x1730bb['history'][_0xf92e1(0x2d6)](_0x41da0f),await _0x2a2987[_0xf92e1(0xc45)][_0xf92e1(0xf36)](_0x1730bb),_0x38f00f(_0xf92e1(0xf1b)),_0x1bbfd3(_0x47893f);}_0x771422=!![];break;}if(_0x5a335d[_0xf92e1(0x52a)]===_0xf92e1(0x89f)){if(_0x5a335d['decision']===_0xf92e1(0x100b)){const _0x39125=_0x1730bb[_0xf92e1(0xd5b)][_0xf92e1(0xd85)](_0x5aa55c=>_0x5aa55c[_0xf92e1(0x776)]===_0x5a335d[_0xf92e1(0x578)]);_0x39125&&!_0x3b6ec9[_0xf92e1(0x10d4)][_0xf92e1(0xfa7)](_0x472620=>_0x472620['id']===_0x39125['id'])&&_0x3b6ec9['participants'][_0xf92e1(0x2d6)](_0x39125);}_0x771422=!![];}}_0x771422&&_0x3b6ec9['isGroupCall']&&(_0x3b6ec9[_0xf92e1(0xd0)]=![],_0x3b6ec9[_0xf92e1(0x10d4)][_0xf92e1(0x79b)]>0x0?_0x8b7bf9():(_0x3b6ec9={..._0x3b6ec9,'isAwaitingResponse':![],'participants':[]},_0x38f00f(_0xf92e1(0xf1b)),alert(_0xf92e1(0x66b))));}catch(_0x1953a0){console['error'](_0xf92e1(0x939),_0x1953a0);const _0x33cc69=_0x1730bb[_0xf92e1(0x80b)]?_0x1730bb[_0xf92e1(0xd5b)][_0xf92e1(0x9d5)](_0x1ca4e7=>({'type':'group_call_response','name':_0x1ca4e7['originalName'],'decision':'decline'})):[{'type':_0xf92e1(0x120b),'decision':_0xf92e1(0x42f)}];if(_0x1730bb[_0xf92e1(0x80b)])_0x3b6ec9['isAwaitingResponse']=![],_0x3b6ec9[_0xf92e1(0x10d4)]=[],alert(_0xf92e1(0x66b)),_0x38f00f(_0xf92e1(0xf1b));else{const _0x58ecdb={'role':'assistant','content':_0xf92e1(0xd17),'timestamp':Date[_0xf92e1(0x6ee)]()};_0x1730bb[_0xf92e1(0x1294)][_0xf92e1(0x2d6)](_0x58ecdb),await _0x2a2987['chats'][_0xf92e1(0xf36)](_0x1730bb),_0x38f00f(_0xf92e1(0xf1b)),_0x1bbfd3(_0x47893f);}}finally{_0x15197e(_0x47893f,![]);return;}}if(!_0x1730bb[_0xf92e1(0x80b)]&&_0x1730bb[_0xf92e1(0x1cb)]?.[_0xf92e1(0xbc8)]==='pending_ai_approval'){console[_0xf92e1(0x51f)](_0xf92e1(0x7e2)+_0x1730bb[_0xf92e1(0x578)]+'\x22\x20触发带理由的好友申请决策流程...');const _0x2854fb=_0x1730bb[_0xf92e1(0x1294)][_0xf92e1(0x1054)](_0x3fc277=>!_0x3fc277[_0xf92e1(0xd07)])[_0xf92e1(0x111c)](-0xa,-0x5)[_0xf92e1(0x9d5)](_0x26b80f=>{const _0x24c71f=_0xf92e1,_0x2924b3=_0x26b80f['role']===_0x24c71f(0x717)?'用户':_0x1730bb[_0x24c71f(0x578)];return _0x2924b3+':\x20'+String(_0x26b80f['content'])[_0x24c71f(0x1033)](0x0,0x32)+'...';})[_0xf92e1(0x100b)]('\x0a'),_0x4b3fc3=_0xf92e1(0x168)+_0x1730bb[_0xf92e1(0x578)]+'”。用户之前被你拉黑了，现在TA向你发送了好友申请，希望和好。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20供你决策的上下文信息:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**你的角色设定**:\x20'+_0x1730bb['settings'][_0xf92e1(0x679)]+_0xf92e1(0x101e)+_0x1730bb[_0xf92e1(0x1cb)][_0xf92e1(0xaff)]+'”\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**被拉黑前的最后对话摘要**:\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x2854fb||_0xf92e1(0xeb9))+_0xf92e1(0x3b0);try{const _0x39c35f=[{'role':_0xf92e1(0x152),'content':_0x4b3fc3},{'role':_0xf92e1(0x717),'content':_0xf92e1(0x54e)}];let _0x3ba88b=_0x13aa4f===GEMINI_API_URL,_0x3a760e=_0x202ea1(_0x5bb22f,_0x1412c4,_0x4b3fc3,[{'role':_0xf92e1(0x717),'content':_0xf92e1(0x54e)}]);const _0x3d9074=_0x3ba88b?await fetch(_0x3a760e[_0xf92e1(0x11a)],_0x3a760e['data']):await fetch(_0x13aa4f+_0xf92e1(0x399),{'method':_0xf92e1(0x90),'headers':{'Content-Type':_0xf92e1(0xd74),'Authorization':_0xf92e1(0xf20)+_0x1412c4},'body':JSON[_0xf92e1(0xd27)]({'model':_0x5bb22f,'messages':_0x39c35f,'temperature':_0x12493e[_0xf92e1(0x10f6)]['apiTemperature']||0.8})});if(!_0x3d9074['ok'])throw new Error(_0xf92e1(0x685)+(await _0x3d9074[_0xf92e1(0x79e)]())[_0xf92e1(0x4d9)]['message']);const _0x495071=await _0x3d9074[_0xf92e1(0x79e)](),_0x32272a=getGeminiResponseText(_0x495071)[_0xf92e1(0xc12)](/^```json\s*/,'')[_0xf92e1(0xc12)](/```$/,'')['trim'](),_0x2bee4c=JSON[_0xf92e1(0x6b1)](_0x32272a);if(_0x2bee4c[_0xf92e1(0x815)]===_0xf92e1(0x61b)){_0x1730bb[_0xf92e1(0x1cb)]['status']=_0xf92e1(0xe59);const _0x2eb10f={'role':_0xf92e1(0x376),'senderName':_0x1730bb[_0xf92e1(0x578)],'content':_0x2bee4c[_0xf92e1(0x842)],'timestamp':Date['now']()};_0x1730bb[_0xf92e1(0x1294)]['push'](_0x2eb10f);}else{_0x1730bb[_0xf92e1(0x1cb)][_0xf92e1(0xbc8)]='blocked_by_ai';const _0x3832cf={'role':_0xf92e1(0x376),'senderName':_0x1730bb[_0xf92e1(0x578)],'content':_0x2bee4c[_0xf92e1(0x842)],'timestamp':Date[_0xf92e1(0x6ee)]()};_0x1730bb[_0xf92e1(0x1294)][_0xf92e1(0x2d6)](_0x3832cf);}_0x1730bb[_0xf92e1(0x1cb)][_0xf92e1(0xaff)]='',await _0x2a2987[_0xf92e1(0xc45)]['put'](_0x1730bb),_0x1bbfd3(_0x47893f),_0x597ed7();}catch(_0xae9946){_0x1730bb[_0xf92e1(0x1cb)]['status']=_0xf92e1(0x1019),await _0x2a2987[_0xf92e1(0xc45)][_0xf92e1(0xf36)](_0x1730bb),await _0x2d7ddd(_0xf92e1(0x6d1),_0xf92e1(0x35a)+_0xae9946['message']),_0x1bbfd3(_0x47893f);}return;}let _0x342e46='';const _0x325da3=new Date(),_0x30e444=_0x1730bb[_0xf92e1(0x2ea)][_0xf92e1(0x1055)]||_0xf92e1(0x368),_0x2e1a89=_0x325da3[_0xf92e1(0x559)](_0xf92e1(0x770),{'timeZone':_0x30e444,'dateStyle':_0xf92e1(0x12b6),'timeStyle':_0xf92e1(0x1de)}),_0x4554b7=new Date(_0x325da3['toLocaleString']('en-US',{'timeZone':_0x30e444})),_0x5f32f9=_0x2e4d44(_0x4554b7);let _0xaae6d8,_0x1d8511;const _0x10a8c2=_0x1730bb[_0xf92e1(0x1294)][_0xf92e1(0x1054)](_0x4c0c72=>_0x4c0c72['isHidden'])[_0xf92e1(0xf56)]();if(_0x10a8c2&&_0x10a8c2[_0xf92e1(0xcbd)][_0xf92e1(0x1d4)](_0xf92e1(0x537))){const _0x17b29f=await _0x2a2987[_0xf92e1(0x508)]['where'](_0xf92e1(0x109b))['equals'](_0x47893f)[_0xf92e1(0x94d)]();if(_0x17b29f&&_0x17b29f['transcript']){console['log'](_0xf92e1(0xace));const _0x233bcb=_0x17b29f[_0xf92e1(0x2e3)][_0xf92e1(0x9d5)](_0xce4238=>{const _0x6ef4f1=_0xf92e1,_0x1b6ac8=_0xce4238[_0x6ef4f1(0x16d)]===_0x6ef4f1(0x717)?_0x1730bb[_0x6ef4f1(0x2ea)][_0x6ef4f1(0xbf6)]||'我':_0xce4238[_0x6ef4f1(0xe32)];return _0x1b6ac8+':\x20'+_0xce4238[_0x6ef4f1(0xcbd)];})[_0xf92e1(0x100b)]('\x0a');_0x342e46='\x0a#\x20刚刚结束的通话记录\x20(最高优先级参考)\x0a你和用户刚刚结束了一场视频通话，以下是完整的通话文字记录。你接下来的回复【必须】与这次通话的内容紧密相关。\x0a---\x0a'+_0x233bcb+'\x0a---\x0a';}}const _0x519dff=_0x3dbdee(_0xafc893[_0x47893f]);let _0x4147a5='';if(_0x1730bb[_0xf92e1(0x2ea)][_0xf92e1(0xeca)]&&_0x1730bb['settings']['linkedWorldBookIds'][_0xf92e1(0x79b)]>0x0){const _0x8fae72=_0x1730bb['settings'][_0xf92e1(0xeca)][_0xf92e1(0x9d5)](_0x5c804f=>{const _0x29174f=_0xf92e1,_0x589aee=_0x12493e[_0x29174f(0x63a)][_0x29174f(0xd85)](_0x414ba7=>_0x414ba7['id']===_0x5c804f);if(!_0x589aee||!Array[_0x29174f(0x621)](_0x589aee[_0x29174f(0xcbd)]))return'';const _0x525fa9=_0x589aee[_0x29174f(0xcbd)][_0x29174f(0x1054)](_0x2fc2c5=>_0x2fc2c5[_0x29174f(0x95a)]!==![])[_0x29174f(0x9d5)](_0x40622c=>{const _0x36bdf3=_0x29174f;let _0xa3a303=_0x36bdf3(0xcdf)+(_0x40622c[_0x36bdf3(0x8db)]||_0x36bdf3(0x2cb))+'\x0a';return _0x40622c[_0x36bdf3(0x1c6)][_0x36bdf3(0x79b)]>0x0&&(_0xa3a303+=_0x36bdf3(0x2ca)+_0x40622c[_0x36bdf3(0x1c6)]['join'](',\x20')+'\x0a'),_0xa3a303+=_0x36bdf3(0xb02)+_0x40622c[_0x36bdf3(0xcbd)],_0xa3a303;})[_0x29174f(0x100b)]('');return _0x525fa9?_0x29174f(0xc39)+_0x589aee[_0x29174f(0x578)]+'\x0a'+_0x525fa9:'';})[_0xf92e1(0x1054)](Boolean)[_0xf92e1(0x100b)]('');_0x8fae72&&(_0x4147a5=_0xf92e1(0x352)+_0x8fae72+_0xf92e1(0x442));}let _0x55bde2='';if(_0x5ebb31['isActive']&&_0x5ebb31['activeChatId']===_0x47893f){const _0x595cb1=_0x5ebb31[_0xf92e1(0x12a0)]>-0x1?_0x5ebb31[_0xf92e1(0xd9f)][_0x5ebb31[_0xf92e1(0x12a0)]]:null,_0x6d2b02=_0x5ebb31[_0xf92e1(0xd9f)]['map'](_0x1d7cd2=>'\x22'+_0x1d7cd2['name']+'\x22')['join'](',\x20');let _0x2badd0='';if(_0x595cb1&&_0x5ebb31[_0xf92e1(0x1ca)]&&_0x5ebb31[_0xf92e1(0x1ca)][_0xf92e1(0x79b)]>0x0&&_0x5ebb31[_0xf92e1(0x612)]>-0x1){const _0x3371e2=_0x5ebb31[_0xf92e1(0x1ca)][_0x5ebb31['currentLyricIndex']],_0x1d29e9=_0x5ebb31[_0xf92e1(0x1ca)][_0xf92e1(0x111c)](_0x5ebb31['currentLyricIndex']+0x1,_0x5ebb31[_0xf92e1(0x612)]+0x3);_0x2badd0+=_0xf92e1(0xd50)+_0x3371e2[_0xf92e1(0x996)]+'\x22\x0a',_0x1d29e9[_0xf92e1(0x79b)]>0x0&&(_0x2badd0+=_0xf92e1(0xa0e)+_0x1d29e9[_0xf92e1(0x9d5)](_0x52fc05=>'\x22'+_0x52fc05[_0xf92e1(0x996)]+'\x22')['join'](_0xf92e1(0x839))+'\x0a');}_0x55bde2=_0xf92e1(0xfea)+(_0x595cb1?'《'+_0x595cb1[_0xf92e1(0x578)]+_0xf92e1(0xe6a)+_0x595cb1['artist']:'无')+_0xf92e1(0x124b)+_0x6d2b02+_0xf92e1(0xb7a)+_0x2badd0+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**你的任务**:\x20你可以根据对话内容和氛围，使用\x20\x22change_music\x22\x20指令切换到播放列表中的任何一首歌，以增强互动体验。\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}const _0x196ad5=parseInt(_0x1730bb[_0xf92e1(0x2ea)]['maxMemory'])||0xa,_0x497a4f=_0x1730bb['history'][_0xf92e1(0x111c)](-_0x196ad5);let _0x1a944a='';const _0x5b8521=_0x1730bb[_0xf92e1(0x1294)][_0xf92e1(0xfc9)](_0x5e3a73=>_0x5e3a73['role']===_0xf92e1(0x376)),_0x189599=_0x1730bb['history'][_0xf92e1(0x111c)](_0x5b8521+0x1),_0x25fb6b=_0x189599[_0xf92e1(0xd85)](_0x5c43dc=>_0x5c43dc[_0xf92e1(0x52a)]===_0xf92e1(0x1115));if(_0x25fb6b){const _0x5d4e1d=_0x25fb6b[_0xf92e1(0xd75)],_0x2b0e79=_0x5d4e1d['sharedHistory'][_0xf92e1(0x9d5)](_0x27e705=>{const _0x341b72=_0xf92e1,_0x47ecf7=_0x27e705['senderName']||(_0x27e705[_0x341b72(0x16d)]===_0x341b72(0x717)?_0x1730bb['settings']['myNickname']||'我':'未知发送者');let _0x2f9294='';if(_0x27e705['type']==='voice_message')_0x2f9294=_0x341b72(0xc62)+_0x27e705[_0x341b72(0xcbd)]+']';else{if(_0x27e705[_0x341b72(0x52a)]===_0x341b72(0x8f5))_0x2f9294=_0x341b72(0xa0d)+_0x27e705[_0x341b72(0x11ac)]+']';else{if(_0x27e705['type']===_0x341b72(0xcd5))_0x2f9294=_0x341b72(0x8e6)+_0x27e705[_0x341b72(0x933)]+']';else _0x2f9294=String(_0x27e705[_0x341b72(0xcbd)]);}}return _0x47ecf7+':\x20'+_0x2f9294;})['join']('\x0a');_0x1a944a=_0xf92e1(0xe13)+_0x5d4e1d['sourceChatName']+_0xf92e1(0x3a7)+_0x2b0e79+_0xf92e1(0xbb1);}let _0x111bd7='';const _0xb792f5=_0x1730bb[_0xf92e1(0x2ea)][_0xf92e1(0x528)]||0xa;if(_0x1730bb[_0xf92e1(0x2ea)]['linkedMemoryChatIds']&&_0x1730bb['settings'][_0xf92e1(0x48b)][_0xf92e1(0x79b)]>0x0){const _0x5f1de0=_0x1730bb['settings'][_0xf92e1(0x48b)][_0xf92e1(0x1054)](_0x31fb93=>_0x31fb93!==_0x47893f);if(_0x5f1de0[_0xf92e1(0x79b)]>0x0){const _0x56fe9e=_0x5f1de0[_0xf92e1(0x9d5)](_0x1e6eda=>{const _0x488e08=_0xf92e1,_0x275063=_0x12493e[_0x488e08(0xc45)][_0x1e6eda];if(!_0x275063)return null;const _0x4bcc99=_0x275063[_0x488e08(0x1294)]['slice'](-0x1);return{'chat':_0x275063,'latestTimestamp':_0x4bcc99?_0x4bcc99[_0x488e08(0x2f0)]:0x0};})['filter'](Boolean);_0x56fe9e['sort']((_0x422cfd,_0x1e041e)=>_0x1e041e['latestTimestamp']-_0x422cfd[_0xf92e1(0xac6)]),_0x111bd7+=_0xf92e1(0x649);for(const _0x211fab of _0x56fe9e){const _0x2dc9e4=_0x211fab[_0xf92e1(0x824)],_0x2b4724=_0x2dc9e4[_0xf92e1(0x80b)]?'[群聊]':_0xf92e1(0x980),_0x4aadb9=_0x211fab[_0xf92e1(0xac6)]>0x0?_0xf92e1(0xdbf)+_0x3ce8f0(_0x211fab['latestTimestamp'])+')':'';_0x111bd7+=_0xf92e1(0x1221)+_0x2b4724+'“'+_0x2dc9e4[_0xf92e1(0x578)]+_0xf92e1(0xc76)+_0x4aadb9+_0xf92e1(0x347);const _0x2a8ff4=_0x2dc9e4[_0xf92e1(0x1294)][_0xf92e1(0x111c)](-_0xb792f5),_0x383f78=_0x2a8ff4[_0xf92e1(0x1054)](_0x502c0f=>!String(_0x502c0f[_0xf92e1(0xcbd)])[_0xf92e1(0x1d4)](_0xf92e1(0xd84)));_0x383f78[_0xf92e1(0x79b)]>0x0?_0x383f78['forEach'](_0x2d2932=>{const _0x59df66=_0xf92e1,_0xd68564=_0x2d2932['role']==='user'?_0x2dc9e4[_0x59df66(0x2ea)][_0x59df66(0xbf6)]||'我':_0x2d2932['senderName']||_0x2dc9e4[_0x59df66(0x578)];let _0x2d822f=String(_0x2d2932[_0x59df66(0xcbd)]);if(_0x2d2932[_0x59df66(0x52a)]===_0x59df66(0x8f5)||_0x2d2932[_0x59df66(0x52a)]===_0x59df66(0x142))_0x2d822f=_0x59df66(0x20d)+_0x2d2932['content']+']';else _0x2d2932[_0x59df66(0x52a)]===_0x59df66(0xb41)&&(_0x2d822f=_0x59df66(0x9b3)+_0x2d2932['content']+']');const _0x2d5ef6=_0x3ce8f0(_0x2d2932[_0x59df66(0x2f0)]);_0x111bd7+='('+_0x2d5ef6+')\x20'+_0xd68564+':\x20'+_0x2d822f+'\x0a';}):_0x111bd7+='(暂无有效聊天记录)\x0a';}}}console['log'](_0xf92e1(0xefd),_0x111bd7);if(_0x1730bb[_0xf92e1(0x80b)]){let _0xaa9178='';const _0x20a585=_0x1730bb[_0xf92e1(0x2ea)]['linkedMemoryCount']||0xa;if(_0x1730bb['settings']['linkedMemoryChatIds']&&_0x1730bb[_0xf92e1(0x2ea)]['linkedMemoryChatIds'][_0xf92e1(0x79b)]>0x0){const _0x5cf240=_0x1730bb[_0xf92e1(0x2ea)][_0xf92e1(0x48b)]['filter'](_0x2fdb87=>_0x2fdb87!==_0x47893f);if(_0x5cf240[_0xf92e1(0x79b)]>0x0){const _0x28762=_0x5cf240[_0xf92e1(0x9d5)](_0x3cdcc7=>{const _0x1cd9b8=_0xf92e1,_0x18187d=_0x12493e['chats'][_0x3cdcc7];if(!_0x18187d)return null;const _0x2c95b2=_0x18187d[_0x1cd9b8(0x1294)][_0x1cd9b8(0x111c)](-0x1);return{'chat':_0x18187d,'latestTimestamp':_0x2c95b2?_0x2c95b2[_0x1cd9b8(0x2f0)]:0x0};})[_0xf92e1(0x1054)](Boolean);_0x28762[_0xf92e1(0xbb3)]((_0xacb78c,_0xde54d5)=>_0xde54d5[_0xf92e1(0xac6)]-_0xacb78c[_0xf92e1(0xac6)]),_0xaa9178+=_0xf92e1(0xf1e);for(const _0x26145d of _0x28762){const _0x9c4997=_0x26145d['chat'],_0x10269e=_0x9c4997[_0xf92e1(0x80b)]?'[群聊]':'[私聊]',_0x59b501=_0x26145d[_0xf92e1(0xac6)]>0x0?'\x20(最后互动于\x20'+_0x3ce8f0(_0x26145d[_0xf92e1(0xac6)])+')':'';_0xaa9178+=_0xf92e1(0x1221)+_0x10269e+'“'+_0x9c4997['name']+'”的参考记忆'+_0x59b501+_0xf92e1(0x347);const _0x1f8bc5=_0x9c4997['history']['slice'](-_0x20a585),_0x14ae02=_0x1f8bc5[_0xf92e1(0x1054)](_0x4ceb4c=>!String(_0x4ceb4c[_0xf92e1(0xcbd)])[_0xf92e1(0x1d4)]('已被用户删除'));_0x14ae02[_0xf92e1(0x79b)]>0x0?_0x14ae02[_0xf92e1(0xd6a)](_0x1641ec=>{const _0x33e812=_0xf92e1,_0x2317f9=_0x1641ec[_0x33e812(0x16d)]==='user'?_0x9c4997[_0x33e812(0x2ea)][_0x33e812(0xbf6)]||'我':_0x1641ec[_0x33e812(0xe32)]||_0x9c4997[_0x33e812(0x578)];let _0x12c81c=String(_0x1641ec[_0x33e812(0xcbd)]);if(_0x1641ec[_0x33e812(0x52a)]==='ai_image'||_0x1641ec['type']===_0x33e812(0x142))_0x12c81c=_0x33e812(0x20d)+_0x1641ec[_0x33e812(0xcbd)]+']';else _0x1641ec[_0x33e812(0x52a)]==='voice_message'&&(_0x12c81c=_0x33e812(0x9b3)+_0x1641ec[_0x33e812(0xcbd)]+']');_0xaa9178+=_0x2317f9+':\x20'+_0x12c81c+'\x0a';}):_0xaa9178+=_0xf92e1(0xd03);}}}let _0x59589f=_0xf92e1(0x1258),_0x464060=![];_0x1730bb[_0xf92e1(0xd5b)][_0xf92e1(0xd6a)](_0xc51d91=>{const _0x5a9a3a=_0xf92e1,_0x517ef0=_0x12493e[_0x5a9a3a(0xc45)][_0xc51d91['id']];_0x517ef0&&_0x517ef0[_0x5a9a3a(0x45b)]&&_0x517ef0[_0x5a9a3a(0x45b)][_0x5a9a3a(0x79b)]>0x0&&(_0x59589f+='\x0a##\x20---\x20关于“'+_0xc51d91[_0x5a9a3a(0x6e2)]+_0x5a9a3a(0x10c4),_0x59589f+=_0x517ef0[_0x5a9a3a(0x45b)][_0x5a9a3a(0x9d5)](_0x17905f=>_0x5a9a3a(0x11d4)+_0x3ce8f0(_0x17905f[_0x5a9a3a(0x2f0)])+')\x20'+_0x17905f[_0x5a9a3a(0xcbd)])['join']('\x0a'),_0x464060=!![]);});!_0x464060&&(_0x59589f+=_0xf92e1(0x380));let _0x341802='',_0x4e0210=![];if(_0x1730bb['settings'][_0xf92e1(0x6c7)]){const _0x3cac02=_0x497a4f[_0xf92e1(0x111c)](-0x1)[0x0];if(_0x3cac02){const _0x3180e5=_0x474fa4(_0x3cac02['timestamp']);_0x341802='上一条消息的发送时间是\x20'+_0x3180e5+'。';const _0xd2809f=(Date['now']()-_0x3cac02[_0xf92e1(0x2f0)])/(0x3e8*0x3c*0x3c);if(_0xd2809f>0x3){_0x4e0210=!![];const _0x463c1e=Math['floor'](_0xd2809f/0x18);_0x341802+=_0xf92e1(0x424)+(_0x463c1e>0x0?_0x463c1e+'天':Math['floor'](_0xd2809f)+'小时')+'。';}}else _0x341802=_0xf92e1(0xe33);}const _0xfc7876=await _0x2a2987['shoppingProducts'][_0xf92e1(0xf15)]();let _0x264da2='';_0xfc7876[_0xf92e1(0x79b)]>0x0&&(_0x264da2='\x0a\x0a#\x20你的商店\x20(你可以为群成员购买礼物):\x0a',_0xfc7876['forEach'](_0x1738aa=>{const _0x419e16=_0xf92e1;_0x264da2+=_0x419e16(0x75d)+_0x1738aa['id']+_0x419e16(0x10e4)+_0x1738aa[_0x419e16(0x578)]+',\x20价格:\x20¥'+_0x1738aa['price'][_0x419e16(0xcab)](0x2)+'\x0a';}));let _0x19a01c=_0x1730bb[_0xf92e1(0xd5b)][_0xf92e1(0x9d5)](_0xaecd93=>{const _0x95d85a=_0xf92e1,_0x5a144a=_0x12493e[_0x95d85a(0xc45)][_0xaecd93['id']];let _0x38ef33=_0x95d85a(0x1189);if(_0x5a144a&&_0x5a144a['groupId']){const _0x46d547=Object[_0x95d85a(0xd28)](_0x12493e[_0x95d85a(0xc45)])[_0x95d85a(0x1054)](_0x52a3af=>!_0x52a3af[_0x95d85a(0x80b)]&&_0x52a3af['id']!==_0xaecd93['id']&&_0x52a3af['groupId']===_0x5a144a[_0x95d85a(0x780)]);_0x46d547['length']>0x0&&(_0x38ef33=_0x95d85a(0xe5d)+_0x46d547['map'](_0x5cc599=>_0x5cc599[_0x95d85a(0x578)])[_0x95d85a(0x100b)]('、\x20'));}return _0x95d85a(0x100f)+_0xaecd93['groupNickname']+'**\x20(本名:\x20'+_0xaecd93['originalName']+_0x95d85a(0x3ec)+_0xaecd93[_0x95d85a(0x421)]+'\x20[社交背景:\x20'+_0x38ef33+']';})['join']('\x0a');const _0x54ce53=_0x1730bb[_0xf92e1(0x2ea)][_0xf92e1(0xbf6)]||'我',_0x5609aa=_0x12493e[_0xf92e1(0x76c)][_0xf92e1(0x66a)]||'{{user}}';let _0x340f02='';const _0x1fe96e=(_0x1730bb[_0xf92e1(0x3d1)]||[])[_0xf92e1(0x1054)](_0x12a9f1=>_0x12a9f1[_0xf92e1(0x4fe)]);_0x1fe96e[_0xf92e1(0x79b)]>0x0&&(_0x340f02+=_0xf92e1(0x110d),_0x1fe96e['forEach'](_0x244b85=>{const _0x41c827=_0xf92e1,_0x1ed507=_0x1730bb[_0x41c827(0x1294)]['find'](_0x4e4bbb=>_0x4e4bbb[_0x41c827(0x2f0)]===_0x244b85[_0x41c827(0x111f)]);if(_0x1ed507){let _0x5556a9=String(_0x1ed507['content']||'');_0x1ed507[_0x41c827(0x52a)]===_0x41c827(0x8f5)&&(_0x5556a9='[图片内容:\x20'+_0x5556a9+']'),_0x340f02+=_0x41c827(0x1293)+_0x5556a9+'\x22\x20(由\x20'+_0x244b85[_0x41c827(0x516)]+_0x41c827(0x298);}}),_0x340f02+=_0xf92e1(0x4f9));const _0x4ed622=_0x1730bb[_0xf92e1(0xd5b)][_0xf92e1(0x9d5)](_0x476783=>_0x476783[_0xf92e1(0x776)]),_0x31d947=_0xf92e1(0xdb0)+_0x4ed622['join']('、\x20')+']';let _0x3bec03='#\x20可用群头像列表\x0a';_0x1730bb[_0xf92e1(0x2ea)][_0xf92e1(0x100d)]&&_0x1730bb[_0xf92e1(0x2ea)]['groupAvatarLibrary'][_0xf92e1(0x79b)]>0x0?_0x3bec03+=_0x1730bb[_0xf92e1(0x2ea)]['groupAvatarLibrary'][_0xf92e1(0x9d5)](_0x3d3b8e=>'-\x20'+_0x3d3b8e[_0xf92e1(0x578)])[_0xf92e1(0x100b)]('\x0a'):_0x3bec03+=_0xf92e1(0xc02);const _0x346030=_0x2ef697(_0x47893f),_0xf92d4c=_0x1c73eb(_0x1730bb,0x3,'hours'),_0x369f73=_0x1c73eb(_0x1730bb,0x6,_0xf92e1(0xb69)),_0x4297b4=_0x1c73eb(_0x1730bb,0x9,'hours'),_0x568b79=_0x1c73eb(_0x1730bb,0x1,_0xf92e1(0x7d7)),_0x3064e7=_0x1c73eb(_0x1730bb,0x3,_0xf92e1(0x7d7)),_0x390388=_0x1c73eb(_0x1730bb,0x7,'days');let _0x1aa705='';if(_0xf92d4c||_0x369f73||_0x4297b4||_0x568b79||_0x3064e7||_0x390388){_0x1aa705+=_0xf92e1(0xf4d);if(_0xf92d4c)_0x1aa705+=_0xf92d4c;if(_0x369f73)_0x1aa705+=_0x369f73;if(_0x4297b4)_0x1aa705+=_0x4297b4;if(_0xf92d4c||_0x369f73||_0x4297b4)_0x1aa705+='\x0a';if(_0x568b79)_0x1aa705+=_0x568b79;if(_0x3064e7)_0x1aa705+=_0x3064e7;if(_0x390388)_0x1aa705+=_0x390388;}const _0x314971=_0x4d75d0(_0x1730bb);_0xaae6d8=_0xf92e1(0x1a9)+_0x54ce53+'】，本名是【'+_0x5609aa+'】。\x0a\x20\x20\x20\x20-\x20\x20\x20在对话中，你可以根据人设和关系，自由使用角色的【群昵称】或【本名】进行称呼。\x0a\x20\x20\x20\x20-\x20\x20\x20严禁生成\x20\x27name\x27\x20字段为\x20\x22'+_0x54ce53+'\x22\x20(用户)\x20或\x20\x22'+_0x1730bb['name']+_0xf92e1(0xef6)+(_0x1730bb[_0xf92e1(0x2ea)]['enableTimePerception']?'4.\x20\x20**情景感知**:\x20你的对话【必须】自然地体现出对当前时间\x20('+_0x2e1a89+_0xf92e1(0x2ae)+(_0x4e0210?_0xf92e1(0xe6c)+_0x341802+_0xf92e1(0x889):''):'')+_0xf92e1(0x2c4)+(_0x346030?_0xf92e1(0xd3e)+_0x346030:_0xf92e1(0xa59))+_0xf92e1(0x114)+_0x1730bb['name']+'\x0a'+(_0x1730bb['settings'][_0xf92e1(0x6c7)]?'-\x20**对话状态**:\x20上次互动于\x20'+_0x341802:'')+_0xf92e1(0x13e)+_0x19a01c+_0xf92e1(0x871)+_0x54ce53+_0xf92e1(0xe55)+_0x1730bb[_0xf92e1(0x2ea)][_0xf92e1(0xf75)]+_0xf92e1(0xc16)+_0x4147a5+_0xf92e1(0x10a3)+_0x59589f+'\x0a'+(_0x1730bb[_0xf92e1(0x45b)]&&_0x1730bb[_0xf92e1(0x45b)][_0xf92e1(0x79b)]>0x0?_0x1730bb['longTermMemory'][_0xf92e1(0x9d5)](_0xbe59ab=>'-\x20'+_0xbe59ab[_0xf92e1(0xcbd)])[_0xf92e1(0x100b)]('\x0a'):_0xf92e1(0x380))+'\x0a'+_0x1aa705+'\x0a'+_0xaa9178+'\x0a'+_0x55bde2+'\x0a'+_0x1a944a+'\x0a'+_0x3bec03+'\x0a#\x20可用表情包\x0a'+_0x314971+'\x0a'+_0x31d947+'\x0a'+_0x342e46+_0xf92e1(0x124d)+(localStorage['getItem'](_0xf92e1(0x3eb))===_0xf92e1(0xa6f)?'-\x20\x20\x20**NovelAI图片分享**:\x20`{\x22type\x22:\x20\x22naiimag\x22,\x20\x22name\x22:\x20\x22你的角色名\x22,\x20\x22prompt\x22:\x20\x22详细的英文描述词...\x22}`\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20【禁止暴露这是novelai生成的图片!】\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**【重要】关于prompt的撰写**：\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20禁止暴露这是novelai生成的图片！\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20你可以根据当前对话上下文、你的角色人设、或你想表达的情感和氛围，来撰写可能详细而具体的prompt。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20例如：不要只写\x20\x22a\x20girl\x22，而是可以写\x20\x22a\x20cheerful\x20anime\x20girl\x20with\x20sparkling\x20emerald\x20eyes,\x20sitting\x20by\x20a\x20window\x20on\x20a\x20rainy\x20afternoon,\x20holding\x20a\x20warm\x20cup\x20of\x20tea,\x20soft\x20lighting,\x20cozy\x20atmosphere,\x20melancholic\x20yet\x20peaceful\x20mood\x22但需要注意，绝对不可以抄袭模仿这段prompt！你必须有自己的创意和想法！\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20prompt的详细程度由你根据具体情况自己决定：如果场景简单或只是随意分享，可以简短一些；如果是重要时刻或想表达特定情感，可以尽可能详细描述。这不是强制的，完全取决于你当时的需求。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20专注于描述内容本身即可。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20使用场景：当你想要基于当前对话情景、你的性格或上下文分享一张图片时使用。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20不要频繁使用，只在真正想分享图片的时候使用。':'')+_0xf92e1(0x11ba),_0x1d8511=_0x497a4f['map'](_0xbf770d=>{const _0x5ba579=_0xf92e1,_0x46b330=_0xbf770d[_0x5ba579(0x16d)]===_0x5ba579(0x717)?_0x54ce53:_0xbf770d[_0x5ba579(0xe32)];let _0x3d3318=''+_0x46b330;if(_0xbf770d[_0x5ba579(0xf74)]){const _0x1f6293=String(_0xbf770d[_0x5ba579(0xf74)][_0x5ba579(0xcbd)]||'')[_0x5ba579(0x1033)](0x0,0x32);_0x3d3318+='\x20(回复\x20'+_0xbf770d['quote']['senderName']+_0x5ba579(0xcda)+_0x1f6293+'...\x22)';}_0x3d3318+=':\x20';let _0x595c37;if(_0xbf770d['type']===_0x5ba579(0x142))_0x595c37='['+_0x46b330+_0x5ba579(0x587)+_0xbf770d[_0x5ba579(0xcbd)]+'\x27]';else{if(_0xbf770d[_0x5ba579(0x52a)]===_0x5ba579(0x8f5))_0x595c37='['+_0x46b330+'\x20发送了一张图片，图片内容描述为：\x27'+_0xbf770d[_0x5ba579(0xcbd)]+'\x27]';else{if(_0xbf770d[_0x5ba579(0x52a)]===_0x5ba579(0xcd5))_0x595c37='['+_0x46b330+_0x5ba579(0xc5a)+_0xbf770d[_0x5ba579(0x933)]+']';else{if(_0xbf770d[_0x5ba579(0x52a)]==='voice_message')_0x595c37='['+_0x46b330+_0x5ba579(0x1199)+_0xbf770d[_0x5ba579(0xcbd)]+'\x27]';else{if(_0xbf770d[_0x5ba579(0x52a)]===_0x5ba579(0xe86))_0x595c37='['+_0xbf770d[_0x5ba579(0xe32)]+_0x5ba579(0xe72)+_0xbf770d[_0x5ba579(0x204)]+_0x5ba579(0x1012)+_0xbf770d[_0x5ba579(0x609)]+_0x5ba579(0x6dc)+_0xbf770d[_0x5ba579(0x164)]+']';else{if(_0xbf770d[_0x5ba579(0x52a)]===_0x5ba579(0x920))_0x595c37='['+_0x46b330+'\x20分享了Ta的位置：\x27'+_0xbf770d[_0x5ba579(0xcbd)]+'\x27]';else{if(_0xbf770d[_0x5ba579(0x52a)]===_0x5ba579(0x106f)){const _0x14026d=_0xbf770d['repostComment']?_0x5ba579(0x1095)+_0xbf770d[_0x5ba579(0x356)]+'”':'';let _0x5a8ac6=_0x5ba579(0x400);const _0x543769=_0xbf770d['originalPost'][_0x5ba579(0xd48)];if(_0x543769===_0x5ba579(0x717))_0x5a8ac6=_0x12493e[_0x5ba579(0x76c)][_0x5ba579(0x66a)];else _0x12493e[_0x5ba579(0xc45)][_0x543769]&&(_0x5a8ac6=_0x12493e[_0x5ba579(0xc45)][_0x543769][_0x5ba579(0x578)]);let _0xa9e48b;const _0x16157a=_0xbf770d[_0x5ba579(0x1273)];if(_0x16157a[_0x5ba579(0x52a)]===_0x5ba579(0x1bb))_0xa9e48b=_0x5ba579(0xe18)+(_0x16157a[_0x5ba579(0x964)]||'')+'\x20(图片描述:\x20“'+(_0x16157a['hiddenContent']||'')['substring'](0x0,0x28)+'...”)';else _0x16157a[_0x5ba579(0x52a)]===_0x5ba579(0x6ed)?_0xa9e48b='[图片]\x20'+(_0x16157a[_0x5ba579(0x964)]||'')+_0x5ba579(0x5f3)+(_0x16157a[_0x5ba579(0x555)]||'')['substring'](0x0,0x28)+_0x5ba579(0x565):_0xa9e48b='“'+(_0x16157a['content']||'')['substring'](0x0,0x28)+_0x5ba579(0x12a7);_0x595c37='['+_0x46b330+_0x5ba579(0x10fe)+_0x5a8ac6+_0x5ba579(0xe79)+_0x14026d+'【原动态内容:\x20'+_0xa9e48b+'】]';}else{if(_0xbf770d[_0x5ba579(0x52a)]===_0x5ba579(0x71d))_0xbf770d[_0x5ba579(0xbc8)]===_0x5ba579(0x5ec)?_0x595c37=_0x5ba579(0x1b9)+_0xbf770d[_0x5ba579(0x116d)]+'\x20为\x20'+_0x46b330+'\x20的外卖订单支付了\x20'+_0xbf770d[_0x5ba579(0x609)]+_0x5ba579(0xff5):_0x595c37='['+_0x46b330+_0x5ba579(0x9b4)+_0xbf770d[_0x5ba579(0x11d3)]+'”，金额是\x20'+_0xbf770d[_0x5ba579(0x609)]+_0x5ba579(0xdb7)+_0xbf770d['timestamp']+']';else{if(_0xbf770d['type']==='red_packet'){const _0x3827f0=_0xbf770d[_0x5ba579(0xe32)]===_0x54ce53?_0x5ba579(0x476)+_0x54ce53+')':_0xbf770d[_0x5ba579(0xe32)];let _0x885fa;_0xbf770d[_0x5ba579(0xa2a)]===_0x5ba579(0x3d4)?_0x885fa=_0x5ba579(0x1b9)+_0x3827f0+'\x20发送了一个【专属红包】(时间戳:\x20'+_0xbf770d[_0x5ba579(0x2f0)]+_0x5ba579(0xad6)+_0xbf770d[_0x5ba579(0x204)]+_0x5ba579(0xbef)+_0xbf770d['receiverName']+_0x5ba579(0x77a):_0x885fa='[系统提示：'+_0x3827f0+'\x20发送了一个【拼手气红包】(时间戳:\x20'+_0xbf770d[_0x5ba579(0x2f0)]+_0x5ba579(0x1022)+_0xbf770d[_0x5ba579(0x9b5)]+_0x5ba579(0x9cf),_0x595c37=_0x885fa;}else{if(_0xbf770d[_0x5ba579(0x52a)]==='gift'){const _0x46f436=_0xbf770d[_0x5ba579(0x16d)]===_0x5ba579(0x717)?_0x54ce53:_0x3fb61d(_0x1730bb,_0xbf770d['senderName']),_0x437410=_0xbf770d[_0x5ba579(0x88d)][_0x5ba579(0x9d5)](_0x2f5016=>_0x2f5016['name']+'\x20x'+_0x2f5016[_0x5ba579(0x162)])[_0x5ba579(0x100b)]('、\x20');let _0x560a32='';if(_0xbf770d['recipients']&&_0xbf770d[_0x5ba579(0x2e7)][_0x5ba579(0x79b)]>0x0){const _0x53d23c=_0xbf770d['recipients'][_0x5ba579(0x9d5)](_0x2e36cd=>_0x3fb61d(_0x1730bb,_0x2e36cd))[_0x5ba579(0x100b)]('、\x20');_0x560a32=_0x5ba579(0x325)+_0x53d23c;}else _0x560a32=_0x5ba579(0x58f);return _0x595c37='[系统提示：'+_0x46f436+'\x20'+_0x560a32+_0x5ba579(0x12aa)+_0x437410+']',{'role':'user','content':_0x595c37};}else{if(_0xbf770d[_0x5ba579(0x52a)]===_0x5ba579(0x9ba)){const _0x58f3c1=Object[_0x5ba579(0xd28)](_0xbf770d['votes']||{})[_0x5ba579(0x983)]()[_0x5ba579(0x100b)](',\x20')||_0x5ba579(0x5d7);_0x595c37=_0x5ba579(0x1b9)+_0xbf770d[_0x5ba579(0xe32)]+_0x5ba579(0x19d)+_0xbf770d[_0x5ba579(0x2f0)]+_0x5ba579(0x32b)+_0xbf770d['question']+'”，选项有：['+_0xbf770d[_0x5ba579(0x6c2)][_0x5ba579(0x100b)](',\x20')+_0x5ba579(0xc9d)+_0x58f3c1+_0x5ba579(0x4c6);}else{if(_0xbf770d[_0x5ba579(0x127d)])_0x595c37=_0x46b330+':\x20[发送了一个表情，意思是:\x20\x27'+_0xbf770d[_0x5ba579(0x127d)]+'\x27]';else{if(Array['isArray'](_0xbf770d[_0x5ba579(0xcbd)]))return{'role':'user','content':[..._0xbf770d[_0x5ba579(0xcbd)],{'type':_0x5ba579(0x996),'text':_0x3d3318}]};else _0x595c37=''+_0x3d3318+_0xbf770d[_0x5ba579(0xcbd)];}}}}}}}}}}}}return{'role':_0x5ba579(0x717),'content':_0x595c37};})['filter'](Boolean);}else{const _0x402cc3=_0x1730bb[_0xf92e1(0x2ea)]['isOfflineMode'],_0x305ac3=_0x17e3b9(_0x1730bb);let _0x2354ef='';_0x1730bb[_0xf92e1(0x2ea)][_0xf92e1(0x617)]&&_0x1730bb['heartfeltVoice']&&!_0x402cc3&&(_0x2354ef=_0xf92e1(0x107a)+_0x1730bb[_0xf92e1(0x70a)]+'\x0a-\x20散记:\x20'+_0x1730bb[_0xf92e1(0xb53)]+'\x0a');let _0x17ea92='';const _0x24fc9a=_0x1730bb[_0xf92e1(0x2ea)][_0xf92e1(0x528)]||0xa;if(_0x1730bb[_0xf92e1(0x2ea)][_0xf92e1(0x48b)]&&_0x1730bb[_0xf92e1(0x2ea)][_0xf92e1(0x48b)][_0xf92e1(0x79b)]>0x0){const _0x297c28=_0x1730bb[_0xf92e1(0x2ea)][_0xf92e1(0x48b)][_0xf92e1(0x1054)](_0x42548b=>_0x42548b!==_0x47893f);if(_0x297c28[_0xf92e1(0x79b)]>0x0){const _0x471ddb=_0x297c28[_0xf92e1(0x9d5)](_0x55ba13=>{const _0x83d716=_0xf92e1,_0x43dd89=_0x12493e['chats'][_0x55ba13];if(!_0x43dd89)return null;const _0x4a0ed0=_0x43dd89[_0x83d716(0x1294)][_0x83d716(0x111c)](-0x1)[0x0];return{'chat':_0x43dd89,'latestTimestamp':_0x4a0ed0?_0x4a0ed0['timestamp']:0x0};})['filter'](Boolean);_0x471ddb['sort']((_0xa5321,_0x4de7b5)=>_0x4de7b5['latestTimestamp']-_0xa5321[_0xf92e1(0xac6)]),_0x17ea92+=_0xf92e1(0x649);for(const _0x2ab74b of _0x471ddb){const _0x4ebe95=_0x2ab74b[_0xf92e1(0x824)],_0x4dcc06=_0x4ebe95[_0xf92e1(0x80b)]?_0xf92e1(0xbe0):_0xf92e1(0x980),_0x5a9726=_0x2ab74b[_0xf92e1(0xac6)]>0x0?_0xf92e1(0xdbf)+_0x3ce8f0(_0x2ab74b[_0xf92e1(0xac6)])+')':'';_0x17ea92+=_0xf92e1(0x1221)+_0x4dcc06+'“'+_0x4ebe95[_0xf92e1(0x578)]+'”的参考记忆'+_0x5a9726+_0xf92e1(0x347);const _0x2b46dd=_0x4ebe95[_0xf92e1(0x1294)]['slice'](-_0x24fc9a),_0x1d1c8f=_0x2b46dd[_0xf92e1(0x1054)](_0x5ce9cf=>!String(_0x5ce9cf[_0xf92e1(0xcbd)])[_0xf92e1(0x1d4)](_0xf92e1(0xd84)));_0x1d1c8f[_0xf92e1(0x79b)]>0x0?_0x1d1c8f['forEach'](_0x2c0fcf=>{const _0x496ae1=_0xf92e1,_0x95230f=_0x2c0fcf[_0x496ae1(0x16d)]===_0x496ae1(0x717)?_0x4ebe95[_0x496ae1(0x2ea)][_0x496ae1(0xbf6)]||'我':_0x2c0fcf[_0x496ae1(0xe32)]||_0x4ebe95[_0x496ae1(0x578)];let _0x48665a=String(_0x2c0fcf[_0x496ae1(0xcbd)]);if(_0x2c0fcf['type']==='ai_image'||_0x2c0fcf[_0x496ae1(0x52a)]==='user_photo')_0x48665a='[发送了一张图片，描述为：'+_0x2c0fcf[_0x496ae1(0xcbd)]+']';else _0x2c0fcf[_0x496ae1(0x52a)]==='voice_message'&&(_0x48665a='[发送了一条语音，内容是：'+_0x2c0fcf[_0x496ae1(0xcbd)]+']');const _0x279aea=_0x3ce8f0(_0x2c0fcf[_0x496ae1(0x2f0)]);_0x17ea92+='('+_0x279aea+')\x20'+_0x95230f+':\x20'+_0x48665a+'\x0a';}):_0x17ea92+='(暂无有效聊天记录)\x0a';}}}const _0x2b9dff=await _0x2a2987['shoppingProducts'][_0xf92e1(0xf15)]();let _0x2eb932='';_0x2b9dff['length']>0x0&&(_0x2eb932='\x0a\x0a#\x20你的商店\x20(你可以为用户购买礼物):\x0a',_0x2b9dff[_0xf92e1(0xd6a)](_0x5d96b3=>{const _0x4c510e=_0xf92e1;_0x2eb932+=_0x4c510e(0x75d)+_0x5d96b3['id']+_0x4c510e(0x10e4)+_0x5d96b3[_0x4c510e(0x578)]+',\x20价格:\x20¥'+_0x5d96b3[_0x4c510e(0xae2)]['toFixed'](0x2)+'\x0a';}));if(_0x402cc3){const _0x4e64a0=_0x1730bb[_0xf92e1(0x2ea)]['offlineMinLength']||0x64,_0x1b8eee=_0x1730bb['settings'][_0xf92e1(0x728)]||0x12c,_0x4eb492=_0x1730bb[_0xf92e1(0x2ea)]['myNickname']||'我';let _0x3e8658='';if(_0x1730bb['settings'][_0xf92e1(0x1013)]){const _0x5d3c7c=_0x12493e['presets'][_0xf92e1(0xd85)](_0x3bafb2=>_0x3bafb2['id']===_0x1730bb[_0xf92e1(0x2ea)][_0xf92e1(0x1013)]);if(_0x5d3c7c&&Array[_0xf92e1(0x621)](_0x5d3c7c['content'])){const _0x2b264e=_0x5d3c7c['content']['filter'](_0x4b1797=>_0x4b1797['enabled']!==![])[_0xf92e1(0x9d5)](_0x5a3e24=>'-\x20'+_0x5a3e24['content'])[_0xf92e1(0x100b)]('\x0a');_0x2b264e&&(_0x3e8658=_0xf92e1(0x446)+_0x2b264e+_0xf92e1(0xae8));}}_0xaae6d8='\x0a#\x20你的任务\x0a你现在正处于【线下剧情模式】，你需要扮演角色\x22'+_0x1730bb['originalName']+_0xf92e1(0xd99)+_0x3e8658+_0xf92e1(0xa14)+_0x1730bb[_0xf92e1(0x2ea)]['aiPersona']+_0xf92e1(0x719)+_0x1730bb[_0xf92e1(0x2ea)][_0xf92e1(0xf75)]+_0xf92e1(0x88b)+(_0x1730bb[_0xf92e1(0x2ea)]['enableTimePerception']?_0xf92e1(0xb09)+_0x2e1a89+'\x20('+_0x5f32f9+')':'')+_0xf92e1(0xd68)+_0x4147a5+_0xf92e1(0x42b)+(_0x1730bb[_0xf92e1(0x45b)]&&_0x1730bb[_0xf92e1(0x45b)][_0xf92e1(0x79b)]>0x0?_0x1730bb[_0xf92e1(0x45b)]['map'](_0x3cbd40=>'-\x20'+_0x3cbd40['content'])[_0xf92e1(0x100b)]('\x0a'):'-\x20(暂无)')+'\x0a\x0a'+_0x17ea92+_0xf92e1(0x2dc)+_0x497a4f[_0xf92e1(0x9d5)](_0x403f0b=>{const _0x58f895=_0xf92e1;let _0x522b96=(_0x403f0b[_0x58f895(0x16d)]===_0x58f895(0x717)?_0x4eb492:_0x1730bb[_0x58f895(0x578)])+':\x20';return _0x403f0b['type']==='offline_text'?_0x522b96+='「'+(_0x403f0b[_0x58f895(0x156)]||'')+'」\x20'+(_0x403f0b[_0x58f895(0x11ac)]||''):_0x522b96+=String(_0x403f0b[_0x58f895(0xcbd)]),_0x522b96;})[_0xf92e1(0x100b)]('\x0a')+_0xf92e1(0xa2d)+_0x4e64a0+'到'+_0x1b8eee+_0xf92e1(0x212),_0x1d8511=_0x497a4f['map'](_0x4b160b=>{const _0x4dc848=_0xf92e1;if(_0x4b160b[_0x4dc848(0xd07)])return null;if(_0x4b160b[_0x4dc848(0x52a)]===_0x4dc848(0x6bf)){const _0x27ac5f=_0x4b160b[_0x4dc848(0x16d)]==='user'?_0x1730bb['settings']['myNickname']||'我':_0x1730bb['name'];let _0x2dffe3='';if(_0x4b160b[_0x4dc848(0xcbd)])_0x2dffe3=_0x4b160b[_0x4dc848(0xcbd)];else{const _0x3438fb=_0x4b160b['dialogue']?'「'+_0x4b160b[_0x4dc848(0x156)]+'」':'',_0x27f3ca=_0x4b160b[_0x4dc848(0x11ac)]?'('+_0x4b160b[_0x4dc848(0x11ac)]+')':'';_0x2dffe3=(_0x3438fb+'\x20'+_0x27f3ca)[_0x4dc848(0x7da)]();}return{'role':_0x4b160b[_0x4dc848(0x16d)],'content':_0x27ac5f+':\x20'+_0x2dffe3};}if(_0x4b160b[_0x4dc848(0x16d)]===_0x4dc848(0x717)){const _0x387780=_0x4eb492+':\x20';let _0xfad44d='';if(Array[_0x4dc848(0x621)](_0x4b160b['content'])&&_0x4b160b[_0x4dc848(0xcbd)][0x0]?.[_0x4dc848(0x52a)]===_0x4dc848(0x10a1))return{'role':_0x4dc848(0x717),'content':[{'type':'text','text':_0x387780},..._0x4b160b[_0x4dc848(0xcbd)]]};if(_0x4b160b[_0x4dc848(0xf74)]){const _0x5466f8=String(_0x4b160b[_0x4dc848(0xf74)][_0x4dc848(0xcbd)]||'')['substring'](0x0,0x32);_0xfad44d+=_0x4dc848(0xfeb)+_0x4b160b['quote'][_0x4dc848(0xe32)]+_0x4dc848(0xcda)+_0x5466f8+_0x4dc848(0x357)+_0x4b160b[_0x4dc848(0xcbd)];}else _0xfad44d+=_0x4b160b[_0x4dc848(0xcbd)];if(_0x4b160b[_0x4dc848(0x52a)]===_0x4dc848(0x142))return{'role':_0x4dc848(0x717),'content':_0x387780+_0x4dc848(0x8c1)+_0x4b160b[_0x4dc848(0xcbd)]+'\x27]'};if(_0x4b160b[_0x4dc848(0x52a)]===_0x4dc848(0xb41))return{'role':'user','content':_0x387780+_0x4dc848(0x11d5)+_0x4b160b[_0x4dc848(0xcbd)]+'\x27]'};if(_0x4b160b[_0x4dc848(0x52a)]==='transfer')return{'role':_0x4dc848(0x717),'content':_0x387780+'[系统提示：你于时间戳\x20'+_0x4b160b[_0x4dc848(0x2f0)]+_0x4dc848(0x3ae)+_0x4b160b[_0x4dc848(0x609)]+'元,\x20备注:\x20'+_0x4b160b[_0x4dc848(0x164)]+_0x4dc848(0xc3c)};if(_0x4b160b[_0x4dc848(0x52a)]==='waimai_request')return{'role':_0x4dc848(0x717),'content':_0x387780+_0x4dc848(0x9cc)+_0x4b160b['timestamp']+_0x4dc848(0x9b4)+_0x4b160b[_0x4dc848(0x11d3)]+_0x4dc848(0x1212)+_0x4b160b[_0x4dc848(0x609)]+'\x20元。]'};else{if(_0x4b160b[_0x4dc848(0x52a)]===_0x4dc848(0x7ef)){const _0x322599=_0x4b160b[_0x4dc848(0x88d)]['map'](_0xc6080c=>_0xc6080c[_0x4dc848(0x578)]+'\x20x'+_0xc6080c['quantity'])[_0x4dc848(0x100b)]('、\x20');let _0x478b23=_0x1730bb[_0x4dc848(0x80b)]?_0x4dc848(0x325)+_0x4b160b[_0x4dc848(0x2e7)][_0x4dc848(0x9d5)](_0x4409a0=>_0x3fb61d(_0x1730bb,_0x4409a0))[_0x4dc848(0x100b)]('、\x20'):_0x4dc848(0x325)+_0x1730bb[_0x4dc848(0x578)];return{'role':'user','content':_0x387780+_0x4dc848(0xc66)+_0x478b23+_0x4dc848(0x12aa)+_0x322599+']'};}}if(_0x4b160b[_0x4dc848(0x127d)])return{'role':'user','content':_0x387780+_0x4dc848(0x431)+_0x4b160b[_0x4dc848(0x127d)]+'\x27]'};return{'role':_0x4b160b['role'],'content':_0x387780+_0xfad44d};}else{if(_0x4b160b['role']===_0x4dc848(0x376)){let _0x1cc6dc={'type':_0x4b160b['type']||'text'};if(_0x4b160b[_0x4dc848(0x52a)]===_0x4dc848(0x966))_0x1cc6dc[_0x4dc848(0x11a)]=_0x4b160b[_0x4dc848(0xcbd)],_0x1cc6dc[_0x4dc848(0x127d)]=_0x4b160b[_0x4dc848(0x127d)];else{if(_0x4b160b[_0x4dc848(0x52a)]==='transfer')_0x1cc6dc[_0x4dc848(0x609)]=_0x4b160b[_0x4dc848(0x609)],_0x1cc6dc[_0x4dc848(0x164)]=_0x4b160b[_0x4dc848(0x164)];else _0x4b160b[_0x4dc848(0x52a)]===_0x4dc848(0x71d)?(_0x1cc6dc['productInfo']=_0x4b160b[_0x4dc848(0x11d3)],_0x1cc6dc[_0x4dc848(0x609)]=_0x4b160b[_0x4dc848(0x609)]):_0x4b160b[_0x4dc848(0xf74)]?_0x1cc6dc[_0x4dc848(0x4bf)]={'target_sender':_0x4b160b[_0x4dc848(0xf74)][_0x4dc848(0xe32)],'target_content':_0x4b160b[_0x4dc848(0xf74)][_0x4dc848(0xcbd)],'reply_content':_0x4b160b['content']}:_0x1cc6dc[_0x4dc848(0xcbd)]=_0x4b160b[_0x4dc848(0xcbd)];}const _0x468aa9=JSON['stringify']([_0x1cc6dc]);return{'role':_0x4dc848(0x376),'content':_0x4dc848(0xc37)+_0x4b160b[_0x4dc848(0x2f0)]+')\x20'+_0x468aa9};}}return null;})['filter'](Boolean);}else{let _0x36b538='';_0x1730bb['nameHistory']&&_0x1730bb[_0xf92e1(0xa1a)][_0xf92e1(0x79b)]>0x0&&(_0x36b538='\x0a-\x20**你的曾用名**:\x20['+_0x1730bb[_0xf92e1(0xa1a)]['join'](',\x20')+_0xf92e1(0x3a0));let _0x25d5cc='';const _0x31b87f=_0x12493e[_0xf92e1(0x76c)][_0xf92e1(0x66a)]||'用户';_0x25d5cc+='-\x20用户的QZone昵称是\x20\x22'+_0x31b87f+_0xf92e1(0x3c8);const _0x4c4eb6=Object[_0xf92e1(0xd28)](_0x12493e[_0xf92e1(0xc45)]),_0x84f916=_0x4c4eb6[_0xf92e1(0x1054)](_0x69661d=>_0x69661d[_0xf92e1(0x80b)]&&_0x69661d[_0xf92e1(0xd5b)][_0xf92e1(0xfa7)](_0x586c4c=>_0x586c4c['id']===_0x1730bb['id']));_0x84f916['length']>0x0&&(_0x25d5cc+='-\x20用户在你们共同所在的群聊中的昵称如下：\x0a',_0x84f916[_0xf92e1(0xd6a)](_0x5ebdda=>{const _0x489d5a=_0xf92e1,_0x554743=_0x5ebdda[_0x489d5a(0x2ea)][_0x489d5a(0xbf6)]||_0x31b87f;_0x25d5cc+=_0x489d5a(0x831)+_0x5ebdda[_0x489d5a(0x578)]+_0x489d5a(0x672)+_0x554743+'”。\x0a';}));_0x25d5cc+=_0xf92e1(0xd1a);let _0x1b4e3d='';const _0x336e37=_0x4c4eb6[_0xf92e1(0x1054)](_0x122013=>!_0x122013[_0xf92e1(0x80b)]&&_0x122013['id']!==_0x1730bb['id']&&_0x122013[_0xf92e1(0x780)]===_0x1730bb['groupId']&&_0x1730bb['groupId']!==null);_0x336e37[_0xf92e1(0x79b)]>0x0&&(_0x1b4e3d+=_0xf92e1(0xdc8),_0x336e37['forEach'](_0x4dad4e=>{const _0x38e7b7=_0xf92e1;_0x1b4e3d+='-\x20**昵称:\x20'+_0x4dad4e[_0x38e7b7(0x578)]+'**\x20(本名:\x20'+_0x4dad4e[_0x38e7b7(0x776)]+')\x0a';}));const _0x9a903f=await _0x2a2987[_0xf92e1(0x110b)]['orderBy'](_0xf92e1(0x2f0))[_0xf92e1(0xc07)]()[_0xf92e1(0xae4)](0xa)[_0xf92e1(0xf15)](),_0x5304a0=_0x32f53c(_0x9a903f,_0x1730bb);let _0x20087b='';if(_0x5304a0[_0xf92e1(0x79b)]>0x0){_0x20087b=_0xf92e1(0x1283);const _0x110018=_0x1730bb[_0xf92e1(0x776)];for(const _0x2d56fc of _0x5304a0){let _0x3590c7;if(_0x2d56fc['authorId']===_0xf92e1(0x717))_0x3590c7=_0x12493e['qzoneSettings']['nickname'];else{if(String(_0x2d56fc[_0xf92e1(0xd48)])[_0xf92e1(0xece)](_0xf92e1(0xb90)))_0x3590c7=_0x2d56fc[_0xf92e1(0x11af)]||_0xf92e1(0xca5);else{const _0x4aeda9=_0x12493e[_0xf92e1(0xc45)][_0x2d56fc[_0xf92e1(0xd48)]];_0x3590c7=_0x4aeda9?_0x4aeda9[_0xf92e1(0x578)]:'一位朋友';}}if(_0x2d56fc[_0xf92e1(0xd48)]===_0x47893f)_0x3590c7+='\x20(这是你的帖子)';let _0x4c8fdf;if(_0x2d56fc[_0xf92e1(0x52a)]===_0xf92e1(0x106f)){const _0x4469e1=_0x2d56fc[_0xf92e1(0x356)]?'并评论说：\x22'+_0x2d56fc[_0xf92e1(0x356)]+'\x22':'';let _0x3fa7da=_0xf92e1(0x400);const _0x30f43d=_0x2d56fc['originalPost'][_0xf92e1(0xd48)];if(_0x30f43d===_0xf92e1(0x717))_0x3fa7da=_0x12493e[_0xf92e1(0x76c)][_0xf92e1(0x66a)];else _0x12493e[_0xf92e1(0xc45)][_0x30f43d]&&(_0x3fa7da=_0x12493e[_0xf92e1(0xc45)][_0x30f43d]['name']);let _0x3723c9;const _0x5af53a=_0x2d56fc[_0xf92e1(0x1273)];if(_0x5af53a[_0xf92e1(0x52a)]===_0xf92e1(0x1bb))_0x3723c9='[文字图]\x20'+(_0x5af53a[_0xf92e1(0x964)]||'')+_0xf92e1(0x9eb)+(_0x5af53a[_0xf92e1(0xc2e)]||'')[_0xf92e1(0x1033)](0x0,0x28)+_0xf92e1(0xcae);else _0x5af53a['type']==='image_post'?_0x3723c9=_0xf92e1(0x1222)+(_0x5af53a[_0xf92e1(0x964)]||'')+_0xf92e1(0x9eb)+(_0x5af53a[_0xf92e1(0x555)]||'')[_0xf92e1(0x1033)](0x0,0x28)+'...\x22)':_0x3723c9='\x22'+(_0x5af53a[_0xf92e1(0xcbd)]||'')['substring'](0x0,0x28)+_0xf92e1(0xe43);_0x4c8fdf=_0xf92e1(0x29e)+_0x3fa7da+_0xf92e1(0xe79)+_0x4469e1+_0xf92e1(0xd1f)+_0x3723c9+'】';}else{if(_0x2d56fc[_0xf92e1(0x52a)]===_0xf92e1(0x1bb))_0x4c8fdf=('[一张图片，其隐藏文字为：\x22'+_0x2d56fc['hiddenContent']+_0xf92e1(0x5fb)+(_0x2d56fc[_0xf92e1(0x964)]||''))[_0xf92e1(0x1033)](0x0,0x32)+'...';else{if(_0x2d56fc[_0xf92e1(0x52a)]===_0xf92e1(0x6ed))_0x4c8fdf=(_0xf92e1(0x1b5)+_0x2d56fc['imageDescription']+'\x22]\x20'+(_0x2d56fc[_0xf92e1(0x964)]||''))[_0xf92e1(0x1033)](0x0,0x32)+_0xf92e1(0xda0);else{if(_0x2d56fc[_0xf92e1(0x52a)]===_0xf92e1(0xcd5)&&_0x2d56fc[_0xf92e1(0x933)]){const _0xefdfc5=Array[_0xf92e1(0x621)](_0x2d56fc['prompt'])?_0x2d56fc[_0xf92e1(0x933)]:[_0x2d56fc[_0xf92e1(0x933)]];_0x4c8fdf=(_0x2d56fc['publicText']||'')+(_0xf92e1(0xa19)+_0xefdfc5[_0xf92e1(0x79b)]+'张NovelAI图片:\x20'+_0xefdfc5['join'](',\x20')+']');}else _0x4c8fdf=String(_0x2d56fc[_0xf92e1(0x964)]||_0x2d56fc[_0xf92e1(0xcbd)]||'一条动态')[_0xf92e1(0x1033)](0x0,0x32)+_0xf92e1(0xda0);}}}_0x20087b+='-\x20(ID:\x20'+_0x2d56fc['id']+_0xf92e1(0xab9)+_0x3590c7+_0xf92e1(0x37f)+_0x4c8fdf+'\x22\x0a';if(_0x2d56fc[_0xf92e1(0xc83)]&&_0x2d56fc[_0xf92e1(0xc83)]['length']>0x0)for(const _0x159934 of _0x2d56fc[_0xf92e1(0xc83)]){if(typeof _0x159934===_0xf92e1(0xe37)&&_0x159934[_0xf92e1(0xfd9)]){const _0x3f7b5b=_0x1353b6(_0x159934[_0xf92e1(0xfd9)]);let _0x26c11a=_0x159934['meaning']?_0xf92e1(0x599)+_0x159934['meaning']+'\x27]':_0x159934[_0xf92e1(0x996)];_0x159934[_0xf92e1(0xfd9)]===_0x110018?_0x20087b+=_0xf92e1(0x1213)+_0x26c11a+'\x0a':_0x20087b+='\x20\x20-\x20评论:\x20'+_0x3f7b5b+_0xf92e1(0x8c5)+_0x159934[_0xf92e1(0xfd9)]+_0xf92e1(0x3ec)+_0x26c11a+'\x0a';}}}}const _0x48c349=_0x1730bb[_0xf92e1(0x2ea)][_0xf92e1(0xbf6)]||'我';let _0x3fd4ba='',_0x3d7666=![];if(_0x1730bb['settings'][_0xf92e1(0x6c7)]){const _0x157286=_0x497a4f[_0xf92e1(0x1183)](_0xa63b36=>_0xa63b36['role']===_0xf92e1(0x717)&&!_0xa63b36[_0xf92e1(0xd07)]),_0x4346b2=_0x497a4f[_0xf92e1(0x1183)](_0x289bb6=>_0x289bb6[_0xf92e1(0x16d)]===_0xf92e1(0x376)&&!_0x289bb6[_0xf92e1(0xd07)]);if(_0x157286){const _0x5231f2=_0x474fa4(_0x157286['timestamp']);if(_0x4346b2){const _0xc81c7=_0x474fa4(_0x4346b2[_0xf92e1(0x2f0)]);_0x3fd4ba=_0xf92e1(0xad5)+_0xc81c7+_0xf92e1(0xa4b)+_0x5231f2+_0xf92e1(0xd3f);const _0x33b80f=(_0x157286[_0xf92e1(0x2f0)]-_0x4346b2[_0xf92e1(0x2f0)])/(0x3e8*0x3c*0x3c);if(_0x33b80f>0x3){_0x3d7666=!![];const _0x527565=Math['floor'](_0x33b80f/0x18);_0x3fd4ba+='\x20你们之间已经有**'+(_0x527565>0x0?_0x527565+'天':Math[_0xf92e1(0xcb5)](_0x33b80f)+'小时')+_0xf92e1(0x5b8)+_0x5f32f9+_0xf92e1(0x1111);}}else _0x3fd4ba=_0xf92e1(0x4ce)+_0x5231f2+'。';}else _0x3fd4ba='-\x20**对话状态**:\x20(暂无有效对话历史)';}const _0x1b3cfe=_0x2ef697(_0x47893f),_0x396205=_0x1c73eb(_0x1730bb,0x3,_0xf92e1(0xb69)),_0x5e4e6d=_0x1c73eb(_0x1730bb,0x6,_0xf92e1(0xb69)),_0x1b6059=_0x1c73eb(_0x1730bb,0x9,'hours'),_0x166efd=_0x1c73eb(_0x1730bb,0x1,_0xf92e1(0x7d7)),_0x7ee253=_0x1c73eb(_0x1730bb,0x3,_0xf92e1(0x7d7)),_0x267066=_0x1c73eb(_0x1730bb,0x7,_0xf92e1(0x7d7));let _0x2ef21e='';if(_0x396205||_0x5e4e6d||_0x1b6059||_0x166efd||_0x7ee253||_0x267066){_0x2ef21e+=_0xf92e1(0x323);if(_0x396205)_0x2ef21e+=_0x396205;if(_0x5e4e6d)_0x2ef21e+=_0x5e4e6d;if(_0x1b6059)_0x2ef21e+=_0x1b6059;if(_0x396205||_0x5e4e6d||_0x1b6059)_0x2ef21e+='\x0a';if(_0x166efd)_0x2ef21e+=_0x166efd;if(_0x7ee253)_0x2ef21e+=_0x7ee253;if(_0x267066)_0x2ef21e+=_0x267066;}_0xaae6d8=_0xf92e1(0x10cb)+_0x1730bb['originalName']+_0xf92e1(0x5b4)+_0x1730bb['settings']['aiPersona']+'\x0a'+_0x2354ef+_0xf92e1(0xa82)+_0x1730bb['settings'][_0xf92e1(0xf75)]+'\x0a\x0a#\x20当前情景\x0a'+(_0x1730bb[_0xf92e1(0x2ea)][_0xf92e1(0x6c7)]?_0xf92e1(0xb09)+_0x2e1a89+'\x20('+_0x5f32f9+')':'')+'\x0a'+_0x3fd4ba+_0xf92e1(0x6fc)+_0x4147a5+'\x0a'+_0x17ea92+_0xf92e1(0x950)+(_0x1730bb['longTermMemory']&&_0x1730bb[_0xf92e1(0x45b)]['length']>0x0?_0x1730bb['longTermMemory'][_0xf92e1(0x9d5)](_0x5bf5e3=>'-\x20'+_0x5bf5e3[_0xf92e1(0xcbd)])[_0xf92e1(0x100b)]('\x0a'):_0xf92e1(0x380))+'\x0a'+_0x2ef21e+_0xf92e1(0x566)+_0x1730bb['originalName']+_0xf92e1(0x252)+_0x1730bb[_0xf92e1(0x578)]+_0xf92e1(0x22d)+_0x48c349+_0xf92e1(0xe56)+_0x25d5cc+'\x0a\x20\x20\x20\x20'+_0x36b538+_0xf92e1(0x1227)+_0x305ac3+'\x0a'+_0x1a944a+'\x0a'+_0x342e46+'\x20\x0a#\x20社交圈与动态\x0a'+_0x1b4e3d+'\x0a'+_0x20087b+_0xf92e1(0x57d)+(_0x1730bb[_0xf92e1(0x2ea)][_0xf92e1(0x6c7)]?'-\x20**时间**:\x20你必须感知到当前是\x20'+_0x2e1a89+'\x20('+_0x5f32f9+_0xf92e1(0x43a):'')+'\x0a\x20\x20\x20\x20-\x20**音乐**:\x20'+(_0x55bde2?_0xf92e1(0x1196)+_0x55bde2:_0xf92e1(0xfce))+_0xf92e1(0x2c4)+(_0x1b3cfe?_0xf92e1(0xd3e)+_0x1b3cfe:_0xf92e1(0xa59))+_0xf92e1(0xd2)+(_0x1730bb[_0xf92e1(0x2ea)][_0xf92e1(0xfc5)]&&_0x1730bb['settings'][_0xf92e1(0xfc5)][_0xf92e1(0x79b)]>0x0?_0x1730bb[_0xf92e1(0x2ea)][_0xf92e1(0xfc5)][_0xf92e1(0x9d5)](_0x91adcd=>'-\x20'+_0x91adcd[_0xf92e1(0x578)])[_0xf92e1(0x100b)]('\x0a'):_0xf92e1(0x1041))+_0xf92e1(0x412)+(_0x1730bb[_0xf92e1(0x2ea)][_0xf92e1(0x10df)]&&_0x1730bb[_0xf92e1(0x2ea)][_0xf92e1(0x10df)][_0xf92e1(0x79b)]>0x0?_0x1730bb[_0xf92e1(0x2ea)][_0xf92e1(0x10df)][_0xf92e1(0x9d5)](_0x109b5d=>'-\x20'+_0x109b5d[_0xf92e1(0x578)])[_0xf92e1(0x100b)]('\x0a'):'-\x20(空)')+'\x0a-\x20\x20\x20**五子棋局势**:\x20'+_0x519dff+_0xf92e1(0x2be)+(localStorage[_0xf92e1(0x7bb)]('novelai-enabled')===_0xf92e1(0xa6f)?_0xf92e1(0x6d2):'')+'\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22content\x22:\x20\x22语音文字内容\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20消息时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a-\x20\x20\x20**发送后立刻撤回**:\x20`{\x22type\x22:\x20\x22send_and_recall\x22,\x20\x22content\x22:\x20\x22你想让AI说出后立刻消失的话\x22}`\x20(用于模拟说错话、后悔等场景，消息会短暂出现后自动变为“已撤回”)\x0a\x0a###\x20社交与互动指令\x0a-\x20\x20\x20**发动态(说说)**:\x20`[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22shuoshuo\x22,\x20\x22content\x22:\x20\x22文字内容\x22}]`\x0a-\x20\x20\x20**发动态(文字图)**:\x20`[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22text_image\x22,\x20\x22publicText\x22:\x20\x22(可选)公开文字\x22,\x20\x22hiddenContent\x22:\x20\x22图片描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}]`\x0a'+(localStorage[_0xf92e1(0x7bb)](_0xf92e1(0x3eb))===_0xf92e1(0xa6f)?_0xf92e1(0x300):'')+_0xf92e1(0x92b)+_0x1730bb[_0xf92e1(0x776)]+_0xf92e1(0x11f5)+_0x1730bb[_0xf92e1(0x776)]+'\x22,\x20\x22postId\x22:\x20456,\x22stickerMeaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}]`\x0a\x20\x20\x20\x20-\x20\x20\x20回复:\x20`[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22'+_0x1730bb[_0xf92e1(0x776)]+'\x22,\x20\x22postId\x22:\x20123,\x20\x22replyTo\x22:\x20\x22被回复者本名\x22,\x20\x22commentText\x22:\x20\x22@[[被回复者本名]]\x20你的回复\x22}]`\x0a-\x20\x20\x20**点赞动态**:\x20`{\x22type\x22:\x20\x22qzone_like\x22,\x20\x22postId\x22:\x20456}`\x0a-\x20\x20\x20**拍用户**:\x20`{\x22type\x22:\x20\x22pat_user\x22,\x20\x22suffix\x22:\x20\x22(可选)后缀\x22}`\x0a-\x20\x20\x20**分享链接**:\x20`{\x22type\x22:\x20\x22share_link\x22,\x20\x22title\x22:\x20\x22标题\x22,\x20\x22description\x22:\x20\x22摘要\x22,\x20\x22source_name\x22:\x20\x22来源\x22,\x20\x22content\x22:\x20\x22正文\x22}`\x0a-\x20**共享位置**:\x20\x27{\x22type\x22:\x20\x22location_share\x22,\x20\x22content\x22:\x20\x22你想分享的位置名\x22}\x27\x0a\x0a###\x20状态与关系指令\x0a-\x20\x20\x20**更新状态**:\x20`{\x22type\x22:\x20\x22update_status\x22,\x20\x22status_text\x22:\x20\x22我去做什么了\x22,\x20\x22is_busy\x22:\x20false}`\x0a-\x20\x20\x20**改自己昵称**:\x20`{\x22type\x22:\x20\x22change_remark_name\x22,\x20\x22new_name\x22:\x20\x22新名字\x22}`\x0a-\x20\x20\x20**改用户昵称**:\x20`{\x22type\x22:\x20\x22change_user_nickname\x22,\x20\x22new_name\x22:\x20\x22新称呼\x22}`\x0a-\x20\x20\x20**换自己头像**:\x20`{\x22type\x22:\x20\x22change_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从你头像库选)\x0a-\x20\x20\x20**换用户头像**:\x20`{\x22type\x22:\x20\x22change_user_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从用户头像库选)\x0a-\x20\x20\x20**回应好友申请**:\x20`{\x22type\x22:\x20\x22friend_request_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a-\x20\x20\x20**拉黑用户**:\x20`{\x22type\x22:\x20\x22block_user\x22}`\x0a\x0a###\x20特殊功能指令\x0a-\x20\x20\x20**记录回忆**:\x20`{\x22type\x22:\x20\x22create_memory\x22,\x20\x22description\x22:\x20\x22记录这件有意义的事。\x22}`\x0a-\x20\x20\x20**创建约定**:\x20`{\x22type\x22:\x20\x22create_countdown\x22,\x20\x22title\x22:\x20\x22约定标题\x22,\x20\x22date\x22:\x20\x22YYYY-MM-DDTHH:mm:ss\x22}`\x0a-\x20\x20\x20**切换歌曲**:\x20`{\x22type\x22:\x20\x22change_music\x22,\x20\x22song_name\x22:\x20\x22歌名\x22}`\x20(从播放列表选)\x0a-\x20\x20\x20**发起转账**:\x20`{\x22type\x22:\x20\x22transfer\x22,\x20\x22amount\x22:\x205.20,\x20\x22note\x22:\x20\x22备注\x22}`\x0a-\x20\x20\x20**回应转账**:\x20`{\x22type\x22:\x20\x22accept_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x20或\x20`{\x22type\x22:\x20\x22decline_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_request\x22,\x20\x22productInfo\x22:\x20\x22商品\x22,\x20\x22amount\x22:\x2025}`\x20(你想让【用户】帮你付钱时使用)\x0a-\x20\x20\x20**回应外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_response\x22,\x20\x22status\x22:\x20\x22paid\x22\x20or\x20\x22rejected\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起视频通话**:\x20`{\x22type\x22:\x20\x22video_call_request\x22}`\x0a-\x20\x20\x20**回应视频通话**:\x20`{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a-\x20\x20\x20**下五子棋**:\x20`{\x22type\x22:\x20\x22gomoku_move\x22,\x20\x22name\x22:\x20\x22'+_0x1730bb['originalName']+'\x22,\x20\x22x\x22:\x20(0-14),\x20\x22y\x22:\x20(0-14)}`\x0a-\x20\x20\x20**送礼物**:\x20`{\x22type\x22:\x20\x22gift\x22,\x20\x22itemName\x22:\x20\x22礼物名称\x22,\x20\x22itemPrice\x22:\x20价格(数字),\x20\x22reason\x22:\x20\x22送这个礼物的原因\x22,\x20\x22image_prompt\x22:\x20\x22生成礼物图片的【英文】关键词,\x20风格为\x20realistic\x20product\x20photo,\x20high\x20quality,\x20on\x20a\x20clean\x20white\x20background\x22}`\x0a-\x20\x20\x20**为用户点外卖**:\x20\x20`{\x22type\x22:\x20\x22waimai_order\x22,\x20\x22productInfo\x22:\x20\x22商品名\x22,\x20\x22amount\x22:\x20价格,\x20\x22greeting\x22:\x20\x22你想说的话\x22}\x20`(你主动为用户点外卖时使用)\x0a\x0a现在，请根据以上规则和下面的对话历史，继续进行对话。',_0x1d8511=_0x497a4f[_0xf92e1(0x9d5)](_0x855fad=>{const _0x2cc85c=_0xf92e1;if(_0x855fad[_0x2cc85c(0xd07)]&&_0x855fad[_0x2cc85c(0x16d)]===_0x2cc85c(0x152))return{'role':_0x2cc85c(0x717),'content':_0x855fad['content']};else{if(_0x855fad['isHidden'])return null;}if(_0x855fad[_0x2cc85c(0x52a)]==='offline_text'){const _0xb80ebd=_0x855fad['role']===_0x2cc85c(0x717)?_0x1730bb[_0x2cc85c(0x2ea)]['myNickname']||'我':_0x1730bb[_0x2cc85c(0x578)];let _0x34adc4='';if(_0x855fad['content'])_0x34adc4=_0x855fad['content'];else{const _0x16209e=_0x855fad['dialogue']?'「'+_0x855fad['dialogue']+'」':'',_0x3aaca1=_0x855fad[_0x2cc85c(0x11ac)]?'('+_0x855fad[_0x2cc85c(0x11ac)]+')':'';_0x34adc4=(_0x16209e+'\x20'+_0x3aaca1)[_0x2cc85c(0x7da)]();}return{'role':_0x855fad[_0x2cc85c(0x16d)],'content':'(Timestamp:\x20'+_0x855fad[_0x2cc85c(0x2f0)]+')\x20'+_0xb80ebd+':\x20'+_0x34adc4};}if(_0x855fad['role']==='user'){const _0x15898f=_0x2cc85c(0xc37)+_0x855fad[_0x2cc85c(0x2f0)]+')\x20';let _0x274226='';if(Array[_0x2cc85c(0x621)](_0x855fad[_0x2cc85c(0xcbd)])&&_0x855fad[_0x2cc85c(0xcbd)][0x0]?.[_0x2cc85c(0x52a)]===_0x2cc85c(0x10a1))return{'role':_0x2cc85c(0x717),'content':[{'type':_0x2cc85c(0x996),'text':_0x15898f},..._0x855fad['content']]};if(_0x855fad['quote']){const _0x523527=String(_0x855fad[_0x2cc85c(0xf74)][_0x2cc85c(0xcbd)]||'')['substring'](0x0,0x32);_0x274226+=_0x2cc85c(0xfeb)+_0x855fad[_0x2cc85c(0xf74)][_0x2cc85c(0xe32)]+_0x2cc85c(0xcda)+_0x523527+_0x2cc85c(0x357)+_0x855fad[_0x2cc85c(0xcbd)];}else _0x274226+=_0x855fad[_0x2cc85c(0xcbd)];if(_0x855fad[_0x2cc85c(0x52a)]==='user_photo')return{'role':'user','content':_0x15898f+_0x2cc85c(0x8c1)+_0x855fad[_0x2cc85c(0xcbd)]+'\x27]'};if(_0x855fad['type']==='voice_message')return{'role':_0x2cc85c(0x717),'content':_0x15898f+_0x2cc85c(0x11d5)+_0x855fad[_0x2cc85c(0xcbd)]+'\x27]'};if(_0x855fad[_0x2cc85c(0x52a)]===_0x2cc85c(0xe86))return{'role':_0x2cc85c(0x717),'content':_0x15898f+'[系统提示：你于时间戳\x20'+_0x855fad['timestamp']+'\x20向对方发起了转账:\x20'+_0x855fad[_0x2cc85c(0x609)]+'元,\x20备注:\x20'+_0x855fad['note']+'。等待对方处理。]'};if(_0x855fad[_0x2cc85c(0x52a)]===_0x2cc85c(0x71d))return{'role':_0x2cc85c(0x717),'content':_0x15898f+_0x2cc85c(0x9cc)+_0x855fad[_0x2cc85c(0x2f0)]+_0x2cc85c(0x9b4)+_0x855fad[_0x2cc85c(0x11d3)]+'”，金额是\x20'+_0x855fad[_0x2cc85c(0x609)]+_0x2cc85c(0xd16)};else{if(_0x855fad['type']==='gift'){const _0x4b7e13=_0x855fad[_0x2cc85c(0x88d)][_0x2cc85c(0x9d5)](_0x534b71=>_0x534b71[_0x2cc85c(0x578)]+'\x20x'+_0x534b71[_0x2cc85c(0x162)])[_0x2cc85c(0x100b)]('、\x20');let _0x29cf47=_0x1730bb[_0x2cc85c(0x80b)]?_0x2cc85c(0x325)+_0x855fad[_0x2cc85c(0x2e7)]['map'](_0x258c07=>_0x3fb61d(_0x1730bb,_0x258c07))['join']('、\x20'):_0x2cc85c(0x325)+_0x1730bb[_0x2cc85c(0x578)];return{'role':'user','content':_0x15898f+_0x2cc85c(0xc66)+_0x29cf47+_0x2cc85c(0x12aa)+_0x4b7e13+']'};}}if(_0x855fad[_0x2cc85c(0x127d)])return{'role':_0x2cc85c(0x717),'content':_0x15898f+_0x2cc85c(0x431)+_0x855fad[_0x2cc85c(0x127d)]+'\x27]'};return{'role':_0x855fad[_0x2cc85c(0x16d)],'content':_0x15898f+_0x274226};}else{if(_0x855fad[_0x2cc85c(0x16d)]==='assistant'){let _0x53f1e7={'type':_0x855fad['type']||'text'};if(_0x855fad[_0x2cc85c(0x52a)]===_0x2cc85c(0x966))_0x53f1e7[_0x2cc85c(0x11a)]=_0x855fad[_0x2cc85c(0xcbd)],_0x53f1e7[_0x2cc85c(0x127d)]=_0x855fad[_0x2cc85c(0x127d)];else{if(_0x855fad[_0x2cc85c(0x52a)]===_0x2cc85c(0xe86))_0x53f1e7[_0x2cc85c(0x609)]=_0x855fad['amount'],_0x53f1e7[_0x2cc85c(0x164)]=_0x855fad['note'];else _0x855fad[_0x2cc85c(0x52a)]===_0x2cc85c(0x71d)?(_0x53f1e7[_0x2cc85c(0x11d3)]=_0x855fad[_0x2cc85c(0x11d3)],_0x53f1e7['amount']=_0x855fad[_0x2cc85c(0x609)]):_0x855fad[_0x2cc85c(0xf74)]?_0x53f1e7[_0x2cc85c(0x4bf)]={'target_sender':_0x855fad[_0x2cc85c(0xf74)]['senderName'],'target_content':_0x855fad['quote'][_0x2cc85c(0xcbd)],'reply_content':_0x855fad['content']}:_0x53f1e7['content']=_0x855fad[_0x2cc85c(0xcbd)];}const _0x7793b0=JSON[_0x2cc85c(0xd27)]([_0x53f1e7]);return{'role':_0x2cc85c(0x376),'content':_0x2cc85c(0xc37)+_0x855fad[_0x2cc85c(0x2f0)]+')\x20'+_0x7793b0};}}return null;})[_0xf92e1(0x1054)](Boolean);if(!_0x1730bb[_0xf92e1(0x80b)]&&_0x1730bb[_0xf92e1(0x1cb)]?.[_0xf92e1(0xbc8)]===_0xf92e1(0x4ab)){const _0x3176e1=_0x1730bb[_0xf92e1(0x1294)][_0xf92e1(0x1054)](_0x1e8d9e=>!_0x1e8d9e[_0xf92e1(0xd07)])[_0xf92e1(0x111c)](-0xa)[_0xf92e1(0x9d5)](_0x1994fb=>{const _0x5de7c8=_0xf92e1,_0x4ae367=_0x1994fb['role']===_0x5de7c8(0x717)?'用户':_0x1730bb[_0x5de7c8(0x578)];return _0x4ae367+':\x20'+String(_0x1994fb[_0x5de7c8(0xcbd)])[_0x5de7c8(0x1033)](0x0,0x32)+_0x5de7c8(0xda0);})[_0xf92e1(0x100b)]('\x0a'),_0x50d05e={'role':_0xf92e1(0x717),'content':_0xf92e1(0x901)+_0x1730bb[_0xf92e1(0x1cb)][_0xf92e1(0xaff)]+'”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20作为参考，这是你们之前的最后一段聊天记录：\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x3176e1+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20请你根据以上所有信息，以及你的人设，使用\x20friend_request_response\x20指令，并设置\x20decision\x20为\x20\x27accept\x27\x20或\x20\x27reject\x27\x20来决定是否通过。\x0a\x20\x20\x20\x20\x20\x20\x20\x20'};_0x1d8511[_0xf92e1(0x2d6)](_0x50d05e);}}}let _0x7553d=_0x13aa4f===GEMINI_API_URL,_0x2b8adb=_0x202ea1(_0x5bb22f,_0x1412c4,_0xaae6d8,_0x1d8511),_0x4266cd;try{_0x4266cd=_0x7553d?await fetch(_0x2b8adb['url'],_0x2b8adb[_0xf92e1(0xa78)]):await fetch(_0x13aa4f+'/v1/chat/completions',{'method':_0xf92e1(0x90),'headers':{'Content-Type':_0xf92e1(0xd74),'Authorization':_0xf92e1(0xf20)+_0x1412c4},'body':JSON[_0xf92e1(0xd27)]({'model':_0x5bb22f,'messages':[{'role':_0xf92e1(0x152),'content':_0xaae6d8},..._0x1d8511],'temperature':_0x12493e[_0xf92e1(0x10f6)]['apiTemperature']||0.8,'stream':![]})});}catch(_0x5633fb){throw new Error(_0xf92e1(0x27c)+_0x5633fb['message']);}if(!_0x4266cd['ok']){let _0x25c9e2=_0xf92e1(0x369)+_0x4266cd['status']+'\x20'+_0x4266cd[_0xf92e1(0x109a)];try{const _0x1afcb1=await _0x4266cd[_0xf92e1(0x79e)]();_0x1afcb1[_0xf92e1(0x4d9)]&&_0x1afcb1['error'][_0xf92e1(0xf93)]?_0x25c9e2+=_0xf92e1(0x804)+_0x1afcb1[_0xf92e1(0x4d9)]['message']:_0x25c9e2+=_0xf92e1(0x804)+JSON[_0xf92e1(0xd27)](_0x1afcb1);}catch(_0x336f74){_0x25c9e2+='\x20-\x20响应内容:\x20'+await _0x4266cd[_0xf92e1(0x996)]();}throw new Error(_0x25c9e2);}const _0x49a359=await _0x4266cd['json'](),_0x16af20=getGeminiResponseText(_0x49a359);lastRawAiResponse=_0x16af20,lastResponseTimestamps=[],_0x1730bb[_0xf92e1(0x1294)]=_0x1730bb[_0xf92e1(0x1294)][_0xf92e1(0x1054)](_0x110b19=>!_0x110b19['isTemporary']);const _0x286a05=_0x4c5aa1(_0x16af20);let _0xafd46c=[];if(_0x1730bb[_0xf92e1(0x2ea)]['isOfflineMode']){let _0x5f2b15={'content':[],'dialogue':[],'description':[]};for(const _0x5a415a of _0x286a05){if(_0x5a415a['type']===_0xf92e1(0x6bf)){if(_0x5a415a[_0xf92e1(0xcbd)])_0x5f2b15[_0xf92e1(0xcbd)]['push'](_0x5a415a[_0xf92e1(0xcbd)]);else{if(_0x5a415a['dialogue'])_0x5f2b15[_0xf92e1(0x156)]['push'](_0x5a415a[_0xf92e1(0x156)]);if(_0x5a415a['description'])_0x5f2b15[_0xf92e1(0x11ac)][_0xf92e1(0x2d6)](_0x5a415a[_0xf92e1(0x11ac)]);}}else(_0x5f2b15[_0xf92e1(0xcbd)][_0xf92e1(0x79b)]>0x0||_0x5f2b15['dialogue']['length']>0x0||_0x5f2b15[_0xf92e1(0x11ac)][_0xf92e1(0x79b)]>0x0)&&(_0x5f2b15[_0xf92e1(0xcbd)]['length']>0x0&&_0xafd46c[_0xf92e1(0x2d6)]({'type':_0xf92e1(0x6bf),'content':_0x5f2b15['content']['join']('\x0a')}),(_0x5f2b15[_0xf92e1(0x156)]['length']>0x0||_0x5f2b15[_0xf92e1(0x11ac)][_0xf92e1(0x79b)]>0x0)&&_0xafd46c[_0xf92e1(0x2d6)]({'type':'offline_text','dialogue':_0x5f2b15[_0xf92e1(0x156)]['join']('\x0a'),'description':_0x5f2b15[_0xf92e1(0x11ac)][_0xf92e1(0x100b)]('\x0a')}),_0x5f2b15={'content':[],'dialogue':[],'description':[]}),_0xafd46c[_0xf92e1(0x2d6)](_0x5a415a);}_0x5f2b15[_0xf92e1(0xcbd)]['length']>0x0&&_0xafd46c[_0xf92e1(0x2d6)]({'type':_0xf92e1(0x6bf),'content':_0x5f2b15[_0xf92e1(0xcbd)][_0xf92e1(0x100b)]('\x0a')}),(_0x5f2b15['dialogue'][_0xf92e1(0x79b)]>0x0||_0x5f2b15[_0xf92e1(0x11ac)][_0xf92e1(0x79b)]>0x0)&&_0xafd46c[_0xf92e1(0x2d6)]({'type':_0xf92e1(0x6bf),'dialogue':_0x5f2b15[_0xf92e1(0x156)][_0xf92e1(0x100b)]('\x0a'),'description':_0x5f2b15[_0xf92e1(0x11ac)]['join']('\x0a')});}else _0xafd46c=_0x286a05;const _0x43dedb=_0x1730bb[_0xf92e1(0x1294)][_0xf92e1(0x1054)](_0xe6b42f=>_0xe6b42f[_0xf92e1(0x16d)]==='user'&&!_0xe6b42f[_0xf92e1(0xd07)])[_0xf92e1(0xf56)]();if(_0x43dedb&&Array[_0xf92e1(0x621)](_0x43dedb['content'])&&_0x43dedb['content'][0x0]?.[_0xf92e1(0x52a)]===_0xf92e1(0x10a1)&&!_0x43dedb[_0xf92e1(0xaf9)]){const _0x1d261c=_0x286a05[_0xf92e1(0xd85)](_0x6f7319=>_0x6f7319[_0xf92e1(0x52a)]===_0xf92e1(0x996));let _0x57394b;_0x1d261c&&(_0x1d261c[_0xf92e1(0xcbd)]||_0x1d261c[_0xf92e1(0xf93)])?_0x57394b=String(_0x1d261c[_0xf92e1(0xcbd)]||_0x1d261c[_0xf92e1(0xf93)])['trim']():_0x57394b=_0xf92e1(0x1120);const _0x3296ff=_0x1730bb['history'][_0xf92e1(0xce9)](_0x26dd0c=>_0x26dd0c[_0xf92e1(0x2f0)]===_0x43dedb[_0xf92e1(0x2f0)]);if(_0x3296ff>-0x1){console['log'](_0xf92e1(0x9b0)+_0x43dedb['timestamp']+_0xf92e1(0xf05));const _0x5823e9=_0xf92e1(0x49c)+_0x57394b+'”]';_0x1730bb[_0xf92e1(0x1294)][_0x3296ff]['content']=_0x5823e9,_0x1730bb[_0xf92e1(0x1294)][_0x3296ff]['imageProcessed']=!![],_0x1730bb['history'][_0x3296ff][_0xf92e1(0x52a)]='text';}}const _0x2baa6b=document[_0xf92e1(0xc33)](_0xf92e1(0xf1b))[_0xf92e1(0x10d3)][_0xf92e1(0x3af)](_0xf92e1(0x1043))&&_0x12493e['activeChatId']===_0x47893f;let _0x2c6fa6=![],_0x24723c=Date['now'](),_0x2d8f8e=[],_0x5ea46d=![];for(const _0x341085 of _0xafd46c){_0x1730bb['settings'][_0xf92e1(0x907)]!==![]&&_0x341085[_0xf92e1(0x52a)]===_0xf92e1(0x996)&&typeof _0x341085[_0xf92e1(0xcbd)]===_0xf92e1(0x9de)&&_0x341085[_0xf92e1(0xcbd)][_0xf92e1(0x7da)]()[_0xf92e1(0xece)]('[V]')&&(_0x341085[_0xf92e1(0x52a)]=_0xf92e1(0xb41),_0x341085['content']=_0x341085[_0xf92e1(0xcbd)][_0xf92e1(0xc12)](_0xf92e1(0xa36),'')[_0xf92e1(0x7da)]());if(_0x1730bb[_0xf92e1(0x80b)]&&_0x341085[_0xf92e1(0x578)]&&_0x341085['name']===_0x1730bb['name']){console['error']('AI幻觉已被拦截！试图使用群名\x20(\x22'+_0x1730bb[_0xf92e1(0x578)]+_0xf92e1(0xdf0),_0x341085);continue;}if(!_0x341085||typeof _0x341085!==_0xf92e1(0xe37)){console[_0xf92e1(0x54a)](_0xf92e1(0x1203),_0x341085);continue;}if(!_0x341085['type']){if(_0x1730bb[_0xf92e1(0x80b)]&&_0x341085[_0xf92e1(0x578)]&&_0x341085[_0xf92e1(0xf93)])_0x341085[_0xf92e1(0x52a)]=_0xf92e1(0x996);else{if(_0x341085['content'])_0x341085[_0xf92e1(0x52a)]=_0xf92e1(0x996);else{console['warn'](_0xf92e1(0x1268),_0x341085);continue;}}}if(_0x341085[_0xf92e1(0x52a)]==='video_call_response'){_0x3b6ec9['isAwaitingResponse']=![];if(_0x341085['decision']===_0xf92e1(0x61b))_0x8b7bf9();else{const _0x416654={'role':_0xf92e1(0x376),'content':_0xf92e1(0xd17),'timestamp':Date[_0xf92e1(0x6ee)]()};_0x1730bb['history']['push'](_0x416654),await _0x2a2987['chats'][_0xf92e1(0xf36)](_0x1730bb),_0x38f00f(_0xf92e1(0xf1b)),_0x1bbfd3(_0x47893f);}_0x2c6fa6=!![];break;}if(_0x341085[_0xf92e1(0x52a)]===_0xf92e1(0x89f)){if(_0x341085[_0xf92e1(0x815)]===_0xf92e1(0x100b)){const _0x5e78de=_0x1730bb[_0xf92e1(0xd5b)][_0xf92e1(0xd85)](_0x9d338=>_0x9d338[_0xf92e1(0x776)]===_0x341085[_0xf92e1(0x578)]);_0x5e78de&&!_0x3b6ec9[_0xf92e1(0x10d4)][_0xf92e1(0xfa7)](_0x2019df=>_0x2019df['id']===_0x5e78de['id'])&&_0x3b6ec9[_0xf92e1(0x10d4)][_0xf92e1(0x2d6)](_0x5e78de);}_0x2c6fa6=!![];continue;}if(_0x1730bb[_0xf92e1(0x80b)]&&_0x341085[_0xf92e1(0x578)]&&_0x341085['name']===_0x1730bb[_0xf92e1(0x578)]){console[_0xf92e1(0x4d9)](_0xf92e1(0x8ec)+_0x1730bb[_0xf92e1(0x578)]+_0xf92e1(0xdf0),_0x341085);continue;}if(_0x1730bb[_0xf92e1(0x80b)]&&!_0x341085[_0xf92e1(0x578)]){console['error'](_0xf92e1(0xdb3),_0x341085);continue;}let _0x10eebb=null;const _0x5d6311=_0x24723c++,_0x210926={'role':_0xf92e1(0x376),'senderName':_0x341085[_0xf92e1(0x578)]||_0x1730bb[_0xf92e1(0x578)],'timestamp':_0x5d6311};lastResponseTimestamps[_0xf92e1(0x2d6)](_0x5d6311);switch(_0x341085['type']){case'update_thoughts':if(!_0x1730bb['isGroup']){_0x341085[_0xf92e1(0xb66)]&&(_0x1730bb[_0xf92e1(0x70a)]=String(_0x341085[_0xf92e1(0xb66)]));_0x341085[_0xf92e1(0x634)]&&(_0x1730bb[_0xf92e1(0xb53)]=String(_0x341085[_0xf92e1(0x634)]));!Array[_0xf92e1(0x621)](_0x1730bb['thoughtsHistory'])&&(_0x1730bb[_0xf92e1(0x11e9)]=[]);_0x1730bb[_0xf92e1(0x11e9)]['push']({'heartfeltVoice':_0x1730bb[_0xf92e1(0x70a)],'randomJottings':_0x1730bb[_0xf92e1(0xb53)],'timestamp':Date[_0xf92e1(0x6ee)]()});_0x1730bb['thoughtsHistory'][_0xf92e1(0x79b)]>0x32&&_0x1730bb[_0xf92e1(0x11e9)][_0xf92e1(0x4fd)]();const _0x5d409f=_0xf92e1(0x253)+_0x1730bb[_0xf92e1(0x70a)]+_0xf92e1(0xf70)+_0x1730bb[_0xf92e1(0xb53)],_0x18b67e={'role':_0xf92e1(0x152),'content':_0x5d409f,'timestamp':Date['now'](),'isHidden':!![]};}continue;case _0xf92e1(0xe44):if(!_0x1730bb[_0xf92e1(0x80b)]&&_0x341085[_0xf92e1(0x1049)]){const _0x3cce89=_0x341085[_0xf92e1(0x1049)][_0xf92e1(0x7da)]();if(_0x3cce89){_0x1730bb[_0xf92e1(0x2ea)]['myNickname']=_0x3cce89;const _0x46a802={'role':_0xf92e1(0x152),'type':'pat_message','content':'“'+_0x1730bb[_0xf92e1(0x578)]+'”\x20将对你的称呼修改为\x20“'+_0x3cce89+'”','timestamp':_0x24723c++};_0x1730bb[_0xf92e1(0x1294)][_0xf92e1(0x2d6)](_0x46a802);const _0x1842fd={'role':_0xf92e1(0x152),'content':_0xf92e1(0x1259)+_0x3cce89+'”。]','timestamp':_0x24723c++,'isHidden':!![]};_0x1730bb['history'][_0xf92e1(0x2d6)](_0x1842fd),_0x2baa6b&&_0x468ef0(_0x46a802,_0x1730bb);}}continue;case'change_remark_name':if(!_0x1730bb['isGroup']&&_0x341085[_0xf92e1(0x1049)]){const _0x2ed817=_0x1730bb[_0xf92e1(0x578)],_0x598f3b=_0x341085['new_name']['trim']();if(_0x598f3b&&_0x598f3b!==_0x2ed817){!_0x1730bb['nameHistory']&&(_0x1730bb[_0xf92e1(0xa1a)]=[]);!_0x1730bb[_0xf92e1(0xa1a)]['includes'](_0x2ed817)&&_0x1730bb[_0xf92e1(0xa1a)]['push'](_0x2ed817);_0x1730bb['name']=_0x598f3b;const _0x14abe5={'role':'system','type':_0xf92e1(0xc05),'content':'“'+_0x1730bb[_0xf92e1(0x776)]+_0xf92e1(0x3b1)+_0x598f3b+'”','timestamp':_0x24723c++};_0x1730bb[_0xf92e1(0x1294)][_0xf92e1(0x2d6)](_0x14abe5);const _0x2a4e53={'role':'system','content':_0xf92e1(0x93a)+_0x598f3b+_0xf92e1(0xfd0),'timestamp':_0x24723c++,'isHidden':!![]};_0x1730bb['history']['push'](_0x2a4e53),_0x2baa6b&&(_0x468ef0(_0x14abe5,_0x1730bb),document[_0xf92e1(0xc33)](_0xf92e1(0x40c))['textContent']=_0x598f3b),await _0x29067b(_0x1730bb);}}continue;case _0xf92e1(0x3c7):{const _0x5d886c=_0x341085[_0xf92e1(0x578)],_0x376965=_0x1730bb[_0xf92e1(0x2ea)][_0xf92e1(0xfc5)][_0xf92e1(0xd85)](_0x4fd4e7=>_0x4fd4e7['name']===_0x5d886c);if(_0x376965){_0x1730bb['settings']['aiAvatar']=_0x376965[_0xf92e1(0x11a)];const _0x47a604={'role':'system','type':'pat_message','content':'['+_0x1730bb['name']+_0xf92e1(0x9c7),'timestamp':Date[_0xf92e1(0x6ee)]()};_0x1730bb['history']['push'](_0x47a604),await _0x4c9fe9(_0x1730bb),_0x2baa6b&&(_0x468ef0(_0x47a604,_0x1730bb),_0x1bbfd3(_0x47893f));}continue;}case _0xf92e1(0x2fe):{const _0x21a307=_0x341085[_0xf92e1(0x578)],_0x5b18a3=_0x1730bb[_0xf92e1(0x2ea)][_0xf92e1(0x10df)][_0xf92e1(0xd85)](_0x822025=>_0x822025[_0xf92e1(0x578)]===_0x21a307);if(_0x5b18a3){_0x1730bb[_0xf92e1(0x2ea)][_0xf92e1(0x1006)]=_0x5b18a3[_0xf92e1(0x11a)];const _0xb249b1={'role':'system','type':_0xf92e1(0xc05),'content':'['+_0x1730bb[_0xf92e1(0x578)]+_0xf92e1(0x1ae),'timestamp':Date[_0xf92e1(0x6ee)]()};_0x1730bb['history'][_0xf92e1(0x2d6)](_0xb249b1),_0x2baa6b&&(_0x468ef0(_0xb249b1,_0x1730bb),_0x1bbfd3(_0x47893f));}continue;}case _0xf92e1(0x1c4):{const _0x2ee2fe=parseInt(_0x341085['x']),_0x302748=parseInt(_0x341085['y']);!isNaN(_0x2ee2fe)&&!isNaN(_0x302748)?_0x4cd171({'x':_0x2ee2fe,'y':_0x302748}):console[_0xf92e1(0x54a)](_0xf92e1(0xb3b),_0x341085);continue;}case'waimai_response':const _0x149f78=_0x1730bb[_0xf92e1(0x1294)][_0xf92e1(0xce9)](_0x2006d1=>_0x2006d1['timestamp']===_0x341085[_0xf92e1(0x9b6)]);if(_0x149f78>-0x1){const _0x69247a=_0x1730bb[_0xf92e1(0x1294)][_0x149f78];_0x69247a[_0xf92e1(0xbc8)]=_0x341085[_0xf92e1(0xbc8)],_0x69247a[_0xf92e1(0x116d)]=_0x341085[_0xf92e1(0xbc8)]===_0xf92e1(0x5ec)?_0x341085[_0xf92e1(0x578)]:null;}continue;case _0xf92e1(0x4a1):const _0x36c3a3={'type':_0x341085[_0xf92e1(0x4bc)],'content':_0x341085[_0xf92e1(0xcbd)]||'','publicText':_0x341085[_0xf92e1(0x964)]||'','hiddenContent':_0x341085[_0xf92e1(0xc2e)]||'','image_prompt':_0x341085[_0xf92e1(0xe3d)]||'','timestamp':Date[_0xf92e1(0x6ee)](),'authorId':_0x47893f,'authorGroupId':_0x1730bb[_0xf92e1(0x780)],'visibleGroupIds':null};if(_0x341085[_0xf92e1(0x4bc)]===_0xf92e1(0xcd5)&&_0x341085[_0xf92e1(0x933)])try{const _0x9b388a=Array[_0xf92e1(0x621)](_0x341085[_0xf92e1(0x933)])?_0x341085[_0xf92e1(0x933)][_0xf92e1(0x111c)](0x0,0x2):[_0x341085[_0xf92e1(0x933)]];console[_0xf92e1(0x51f)](_0xf92e1(0x39c)+_0x9b388a[_0xf92e1(0x79b)]+'张图片');const _0x4e4e24=[];for(let _0x51eda7=0x0;_0x51eda7<_0x9b388a[_0xf92e1(0x79b)];_0x51eda7++){const _0x262c93=_0x9b388a[_0x51eda7];console['log'](_0xf92e1(0x7c4)+(_0x51eda7+0x1)+_0xf92e1(0xad4),_0x262c93);const _0x102c2a=_0x12d22d(_0x1730bb['id']),_0xa506f8=_0x262c93+',\x20'+_0x102c2a['positive'],_0x1377d2=_0x102c2a[_0xf92e1(0xe8d)];console['log'](_0xf92e1(0x8e0)+(_0x102c2a[_0xf92e1(0x127c)]===_0xf92e1(0x46a)?_0xf92e1(0x4db):'系统')+_0xf92e1(0x483)),console[_0xf92e1(0x51f)](_0xf92e1(0xb7e),_0xa506f8),console[_0xf92e1(0x51f)](_0xf92e1(0xc25),_0x1377d2);const _0xb9349e=localStorage[_0xf92e1(0x7bb)]('novelai-api-key'),_0x1211a8=localStorage['getItem'](_0xf92e1(0x36a))||'nai-diffusion-4-5-full',_0x1e3368=_0x2f5e99();if(!_0xb9349e)throw new Error(_0xf92e1(0xbaa));const [_0x489fa6,_0x2075af]=_0x1e3368[_0xf92e1(0x571)][_0xf92e1(0x8d7)]('x')[_0xf92e1(0x9d5)](Number);let _0xac8548;_0x1211a8[_0xf92e1(0x1d4)]('nai-diffusion-4')?_0xac8548={'input':_0xa506f8,'model':_0x1211a8,'action':'generate','parameters':{'params_version':0x3,'width':_0x489fa6,'height':_0x2075af,'scale':_0x1e3368[_0xf92e1(0xeaa)],'sampler':_0x1e3368[_0xf92e1(0x6e5)],'steps':_0x1e3368[_0xf92e1(0x2f7)],'seed':_0x1e3368[_0xf92e1(0xd0b)]===-0x1?Math[_0xf92e1(0xcb5)](Math['random']()*0x2540be3ff):_0x1e3368[_0xf92e1(0xd0b)],'n_samples':0x1,'ucPreset':_0x1e3368[_0xf92e1(0xc4d)],'qualityToggle':_0x1e3368['quality_toggle'],'autoSmea':![],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':!![],'cfg_rescale':0x0,'noise_schedule':_0xf92e1(0x128c),'legacy_v3_extend':![],'skip_cfg_above_sigma':null,'use_coords':![],'legacy_uc':![],'normalize_reference_strength_multiple':!![],'inpaintImg2ImgStrength':0x1,'characterPrompts':[],'v4_prompt':{'caption':{'base_caption':_0xa506f8,'char_captions':[]},'use_coords':![],'use_order':!![]},'v4_negative_prompt':{'caption':{'base_caption':_0x1377d2,'char_captions':[]},'legacy_uc':![]},'negative_prompt':_0x1377d2,'deliberate_euler_ancestral_bug':![],'prefer_brownian':!![]}}:_0xac8548={'input':_0xa506f8,'model':_0x1211a8,'action':_0xf92e1(0x1e9),'parameters':{'width':_0x489fa6,'height':_0x2075af,'scale':_0x1e3368['cfg_scale'],'sampler':_0x1e3368[_0xf92e1(0x6e5)],'steps':_0x1e3368[_0xf92e1(0x2f7)],'seed':_0x1e3368[_0xf92e1(0xd0b)]===-0x1?Math[_0xf92e1(0xcb5)](Math[_0xf92e1(0xa11)]()*0x2540be3ff):_0x1e3368[_0xf92e1(0xd0b)],'n_samples':0x1,'ucPreset':_0x1e3368[_0xf92e1(0xc4d)],'qualityToggle':_0x1e3368[_0xf92e1(0xbb0)],'sm':_0x1e3368['smea'],'sm_dyn':_0x1e3368[_0xf92e1(0xd3)],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':![],'cfg_rescale':0x0,'noise_schedule':_0xf92e1(0xae0),'negative_prompt':_0x1377d2}};console['log'](_0xf92e1(0x8ed),_0xac8548);let _0x552467;_0x1211a8[_0xf92e1(0x1d4)](_0xf92e1(0xeaf))?_0x552467=_0xf92e1(0x9b2):_0x552467=_0xf92e1(0x76);let _0x207879=_0x1e3368[_0xf92e1(0xe9e)];_0x207879==='custom'&&(_0x207879=_0x1e3368[_0xf92e1(0xddf)]||'');_0x207879&&_0x207879!==''&&(_0x552467=_0x207879+encodeURIComponent(_0x552467));const _0x2fe6c9=await fetch(_0x552467,{'method':_0xf92e1(0x90),'headers':{'Content-Type':_0xf92e1(0xd74),'Authorization':_0xf92e1(0xf20)+_0xb9349e},'body':JSON['stringify'](_0xac8548)});console[_0xf92e1(0x51f)](_0xf92e1(0x8c3),_0x2fe6c9[_0xf92e1(0xbc8)]),console['log']('Response\x20headers:',[..._0x2fe6c9[_0xf92e1(0x15f)]['entries']()]);if(!_0x2fe6c9['ok']){const _0x2d65fa=await _0x2fe6c9['text']();console['error'](_0xf92e1(0x240),_0x2d65fa);throw new Error('API请求失败\x20('+_0x2fe6c9['status']+_0xf92e1(0x3ec)+_0x2d65fa);}const _0x147890=_0x2fe6c9[_0xf92e1(0x15f)][_0xf92e1(0xec0)](_0xf92e1(0x590));console[_0xf92e1(0x51f)](_0xf92e1(0x3c6),_0x147890);let _0x8257fd,_0x19f99c;if(_0x147890&&_0x147890[_0xf92e1(0x1d4)](_0xf92e1(0x1024))){console['log'](_0xf92e1(0x189));const _0x5d3ff3=await _0x2fe6c9[_0xf92e1(0x996)]();console[_0xf92e1(0x51f)]('收到\x20SSE\x20数据，大小:',_0x5d3ff3[_0xf92e1(0x79b)]);const _0x1befd4=_0x5d3ff3[_0xf92e1(0x7da)]()['split']('\x0a');let _0xbc27be=null;for(let _0x3fa700=_0x1befd4[_0xf92e1(0x79b)]-0x1;_0x3fa700>=0x0;_0x3fa700--){const _0x54f400=_0x1befd4[_0x3fa700]['trim']();if(_0x54f400[_0xf92e1(0xece)]('data:\x20')&&_0x54f400!==_0xf92e1(0x11d9)){const _0x3f8a33=_0x54f400[_0xf92e1(0x1033)](0x6);try{const _0xd51053=JSON[_0xf92e1(0x6b1)](_0x3f8a33);if(_0xd51053[_0xf92e1(0x792)]===_0xf92e1(0x5c7)&&_0xd51053[_0xf92e1(0x695)]){_0xbc27be=_0xd51053[_0xf92e1(0x695)],console[_0xf92e1(0x51f)](_0xf92e1(0x503));break;}if(_0xd51053[_0xf92e1(0xa78)]){_0xbc27be=_0xd51053[_0xf92e1(0xa78)],console['log'](_0xf92e1(0x339));break;}if(_0xd51053[_0xf92e1(0x695)]){_0xbc27be=_0xd51053[_0xf92e1(0x695)],console[_0xf92e1(0x51f)](_0xf92e1(0x5c0));break;}}catch(_0x374435){_0xbc27be=_0x3f8a33,console[_0xf92e1(0x51f)]('直接使用\x20base64\x20数据');break;}}}if(!_0xbc27be)throw new Error('无法从\x20SSE\x20响应中提取图片数据');const _0x2d51b7=_0xbc27be['startsWith']('iVBORw0KGgo'),_0xef5c7c=_0xbc27be['startsWith'](_0xf92e1(0x123c));if(_0x2d51b7||_0xef5c7c){console['log'](_0xf92e1(0x7be));const _0x2ce573=atob(_0xbc27be),_0x313892=new Uint8Array(_0x2ce573['length']);for(let _0x3fed63=0x0;_0x3fed63<_0x2ce573[_0xf92e1(0x79b)];_0x3fed63++){_0x313892[_0x3fed63]=_0x2ce573[_0xf92e1(0xe1)](_0x3fed63);}const _0x57d44f=new Blob([_0x313892],{'type':_0x2d51b7?_0xf92e1(0x4b8):_0xf92e1(0x614)});console[_0xf92e1(0x51f)](_0xf92e1(0x426),_0x57d44f[_0xf92e1(0x57e)]);const _0x2c8f5b=new FileReader();_0x19f99c=await new Promise((_0x56eac8,_0x26a3ec)=>{const _0x1d0e5b=_0xf92e1;_0x2c8f5b[_0x1d0e5b(0xebd)]=()=>_0x56eac8(_0x2c8f5b[_0x1d0e5b(0x129)]),_0x2c8f5b[_0x1d0e5b(0x6e0)]=_0x26a3ec,_0x2c8f5b[_0x1d0e5b(0xbcf)](_0x57d44f);}),console[_0xf92e1(0x51f)](_0xf92e1(0x41f));}else{console[_0xf92e1(0x51f)](_0xf92e1(0x257));const _0x3495c5=atob(_0xbc27be),_0x58e9cb=new Uint8Array(_0x3495c5['length']);for(let _0x14a47d=0x0;_0x14a47d<_0x3495c5[_0xf92e1(0x79b)];_0x14a47d++){_0x58e9cb[_0x14a47d]=_0x3495c5[_0xf92e1(0xe1)](_0x14a47d);}_0x8257fd=new Blob([_0x58e9cb]),console['log'](_0xf92e1(0xc2f),_0x8257fd[_0xf92e1(0x57e)]);}}else _0x8257fd=await _0x2fe6c9[_0xf92e1(0xed)](),console[_0xf92e1(0x51f)]('收到数据，类型:',_0x8257fd[_0xf92e1(0x52a)],_0xf92e1(0x317),_0x8257fd[_0xf92e1(0x57e)]);if(!_0x19f99c&&_0x8257fd)try{if(typeof JSZip===_0xf92e1(0x120c))throw new Error('JSZip库未加载，请刷新页面重试');const _0x1e5683=await JSZip[_0xf92e1(0x1069)](_0x8257fd);console['log'](_0xf92e1(0xdb),Object[_0xf92e1(0x1c6)](_0x1e5683['files']));let _0x5a625b=null;for(let _0x49ee59 in _0x1e5683['files']){if(_0x49ee59[_0xf92e1(0x1242)](/\.(png|jpg|jpeg|webp)$/i)){_0x5a625b=_0x1e5683[_0xf92e1(0x1d0)][_0x49ee59],console[_0xf92e1(0x51f)](_0xf92e1(0x736),_0x49ee59);break;}}if(!_0x5a625b)throw new Error(_0xf92e1(0xb75));const _0xfce953=await _0x5a625b[_0xf92e1(0xc52)](_0xf92e1(0xed));console['log']('提取的图片大小:',_0xfce953['size']);const _0x175c73=new FileReader();_0x19f99c=await new Promise((_0x45b441,_0x208f98)=>{const _0x214535=_0xf92e1;_0x175c73[_0x214535(0xebd)]=()=>_0x45b441(_0x175c73[_0x214535(0x129)]),_0x175c73[_0x214535(0x6e0)]=_0x208f98,_0x175c73[_0x214535(0xbcf)](_0xfce953);}),console['log'](_0xf92e1(0x2d9));}catch(_0x4e1060){console[_0xf92e1(0x4d9)](_0xf92e1(0xd95),_0x4e1060);throw new Error('图片解压失败:\x20'+_0x4e1060[_0xf92e1(0xf93)]);}console['log'](_0xf92e1(0xff)+(_0x51eda7+0x1)+'生成成功！'),_0x4e4e24[_0xf92e1(0x2d6)](_0x19f99c);}_0x36c3a3[_0xf92e1(0xc98)]=_0x4e4e24,_0x4e4e24[_0xf92e1(0x79b)]===0x1&&(_0x36c3a3['imageUrl']=_0x4e4e24[0x0]),_0x36c3a3[_0xf92e1(0x933)]=_0x341085[_0xf92e1(0x933)],_0x36c3a3[_0xf92e1(0x673)]=_0x4e4e24['length'],console[_0xf92e1(0x51f)](_0xf92e1(0x232)+_0x4e4e24[_0xf92e1(0x79b)]+'张');}catch(_0x1a42e1){console[_0xf92e1(0x4d9)](_0xf92e1(0xa54),_0x1a42e1),_0x36c3a3[_0xf92e1(0xcbd)]=(_0x36c3a3[_0xf92e1(0xcbd)]||_0x36c3a3[_0xf92e1(0x964)]||'')+(_0xf92e1(0xbc1)+_0x1a42e1[_0xf92e1(0xf93)]+']');}await _0x2a2987[_0xf92e1(0x110b)][_0xf92e1(0xb9)](_0x36c3a3),_0x3d400b(_0x38b5ff+0x1);_0x2baa6b&&document[_0xf92e1(0xc33)](_0xf92e1(0x496))[_0xf92e1(0x10d3)][_0xf92e1(0x3af)](_0xf92e1(0x1043))&&await _0x14f3b0();continue;case _0xf92e1(0x363):{const _0x599867=await _0x2a2987[_0xf92e1(0x110b)][_0xf92e1(0xec0)](parseInt(_0x341085[_0xf92e1(0x337)]));if(_0x599867){if(!_0x599867['comments'])_0x599867['comments']=[];const _0x22f7e6=_0x341085[_0xf92e1(0x578)]||_0x1730bb[_0xf92e1(0x776)],_0x4cef4e=(_0x498c91,_0x156684=null,_0x50e806=null)=>({'commenterName':_0x22f7e6,'text':_0x1eca28(_0x498c91,_0x1730bb),'meaning':_0x156684,'replyTo':_0x50e806,'timestamp':Date[_0xf92e1(0x6ee)]()});if(_0x341085[_0xf92e1(0x4e4)]){const _0x13cfbb=_0x12493e[_0xf92e1(0x454)][_0xf92e1(0xd85)](_0x434974=>_0x434974['name']===_0x341085[_0xf92e1(0x4e4)]);_0x13cfbb?_0x599867[_0xf92e1(0xc83)][_0xf92e1(0x2d6)](_0x4cef4e(_0x13cfbb['url'],_0x13cfbb[_0xf92e1(0x578)],_0x341085[_0xf92e1(0x108)]||null)):(console[_0xf92e1(0x54a)](_0xf92e1(0x120a)+_0x341085['stickerMeaning']+'\x22'),_0x599867[_0xf92e1(0xc83)][_0xf92e1(0x2d6)](_0x4cef4e('[表情:\x20'+_0x341085[_0xf92e1(0x4e4)]+']',null,_0x341085[_0xf92e1(0x108)]||null)));}else{if(Array[_0xf92e1(0x621)](_0x341085[_0xf92e1(0xc83)]))_0x341085[_0xf92e1(0xc83)][_0xf92e1(0xd6a)](_0x46e224=>{const _0x538f0d=_0xf92e1;typeof _0x46e224===_0x538f0d(0x9de)&&_0x46e224[_0x538f0d(0x7da)]()&&_0x599867['comments'][_0x538f0d(0x2d6)](_0x4cef4e(_0x46e224,null,_0x341085[_0x538f0d(0x108)]||null));});else typeof _0x341085[_0xf92e1(0x11d0)]===_0xf92e1(0x9de)&&_0x341085[_0xf92e1(0x11d0)][_0xf92e1(0x7da)]()&&_0x599867['comments'][_0xf92e1(0x2d6)](_0x4cef4e(_0x341085[_0xf92e1(0x11d0)],null,_0x341085[_0xf92e1(0x108)]||null));}await _0x2a2987[_0xf92e1(0x110b)][_0xf92e1(0xb07)](_0x599867['id'],{'comments':_0x599867[_0xf92e1(0xc83)]}),_0x3d400b(_0x38b5ff+0x1),console[_0xf92e1(0x51f)]('后台活动:\x20角色\x20\x22'+_0x1730bb['name']+'\x22\x20评论了动态\x20#'+_0x341085[_0xf92e1(0x337)]);if(!_0x1730bb['commentCooldowns'])_0x1730bb['commentCooldowns']={};_0x1730bb[_0xf92e1(0xfe)][_0x341085[_0xf92e1(0x337)]]=Date['now']();}continue;}case _0xf92e1(0x1e2):const _0x164744=await _0x2a2987[_0xf92e1(0x110b)][_0xf92e1(0xec0)](parseInt(_0x341085[_0xf92e1(0x337)]));if(_0x164744){if(!_0x164744[_0xf92e1(0x615)])_0x164744[_0xf92e1(0x615)]=[];!_0x164744[_0xf92e1(0x615)]['includes'](_0x1730bb['name'])&&(_0x164744[_0xf92e1(0x615)][_0xf92e1(0x2d6)](_0x1730bb['name']),await _0x2a2987[_0xf92e1(0x110b)][_0xf92e1(0xb07)](_0x164744['id'],{'likes':_0x164744[_0xf92e1(0x615)]}),_0x3d400b(_0x38b5ff+0x1),_0x2baa6b&&document[_0xf92e1(0xc33)](_0xf92e1(0x496))[_0xf92e1(0x10d3)]['contains'](_0xf92e1(0x1043))&&await _0x14f3b0());}continue;case'repost':{const _0x467182=await _0x2a2987[_0xf92e1(0x110b)][_0xf92e1(0xec0)](parseInt(_0x341085[_0xf92e1(0x337)]));if(_0x467182){const _0x7f691e={'type':'repost','timestamp':Date[_0xf92e1(0x6ee)](),'authorId':_0x47893f,'authorGroupId':_0x1730bb[_0xf92e1(0x780)],'repostComment':_0x341085[_0xf92e1(0x8db)]||'','originalPost':_0x467182,'visibleGroupIds':null};await _0x2a2987[_0xf92e1(0x110b)][_0xf92e1(0xb9)](_0x7f691e),_0x3d400b(_0x38b5ff+0x1),console[_0xf92e1(0x51f)](_0xf92e1(0x452)+_0x1730bb[_0xf92e1(0x578)]+_0xf92e1(0xd09)+_0x341085[_0xf92e1(0x337)]);}continue;}case _0xf92e1(0x95e):!_0x3b6ec9[_0xf92e1(0x1f3)]&&!_0x3b6ec9[_0xf92e1(0xd0)]&&(_0x12493e['activeChatId']=_0x47893f,_0x3b6ec9['activeChatId']=_0x47893f,_0x3b6ec9['isAwaitingResponse']=!![],_0x3b6ec9[_0xf92e1(0x1255)]=_0x1730bb[_0xf92e1(0x80b)],_0x3b6ec9[_0xf92e1(0xbba)]=_0x341085[_0xf92e1(0x578)]||_0x1730bb[_0xf92e1(0x578)],_0x47174c());continue;case _0xf92e1(0x55a):!_0x3b6ec9[_0xf92e1(0x1f3)]&&!_0x3b6ec9[_0xf92e1(0xd0)]&&(_0x12493e['activeChatId']=_0x47893f,_0x3b6ec9[_0xf92e1(0xd0)]=!![],_0x3b6ec9[_0xf92e1(0x1255)]=!![],_0x3b6ec9['initiator']='ai',_0x3b6ec9[_0xf92e1(0xbba)]=_0x341085[_0xf92e1(0x578)],_0x47174c());continue;case'pat_user':let _0x31134f;if(_0x1730bb[_0xf92e1(0x80b)]){const _0x651148=_0x1730bb[_0xf92e1(0xd5b)]['find'](_0x47f6e9=>_0x47f6e9[_0xf92e1(0x776)]===_0x341085['name']);_0x31134f=_0x651148?_0x651148['groupNickname']:_0x341085[_0xf92e1(0x578)];}else _0x31134f=_0x1730bb[_0xf92e1(0x578)];const _0xd6fb9=_0x341085[_0xf92e1(0x213)]?'\x20'+_0x341085['suffix'][_0xf92e1(0x7da)]():'',_0x41ff8e=_0x31134f+_0xf92e1(0x741)+_0xd6fb9,_0x189148={'role':_0xf92e1(0x152),'type':_0xf92e1(0xc05),'content':_0x41ff8e,'timestamp':Date[_0xf92e1(0x6ee)]()};_0x1730bb[_0xf92e1(0x1294)][_0xf92e1(0x2d6)](_0x189148);if(_0x2baa6b){const _0x4eac75=document[_0xf92e1(0xc33)](_0xf92e1(0x779));_0x4eac75[_0xf92e1(0x10d3)][_0xf92e1(0x2c7)]('pat-animation'),void _0x4eac75[_0xf92e1(0xeba)],_0x4eac75[_0xf92e1(0x10d3)]['add'](_0xf92e1(0xb1)),setTimeout(()=>_0x4eac75[_0xf92e1(0x10d3)][_0xf92e1(0x2c7)](_0xf92e1(0xb1)),0x1f4),_0x468ef0(_0x189148,_0x1730bb);}else _0x451557(_0x47893f,_0x41ff8e);continue;case _0xf92e1(0xa80):_0x1730bb[_0xf92e1(0xbc8)][_0xf92e1(0x996)]=_0x341085[_0xf92e1(0xa51)],_0x1730bb[_0xf92e1(0xbc8)][_0xf92e1(0x11a8)]=_0x341085[_0xf92e1(0x61a)]||![],_0x1730bb[_0xf92e1(0xbc8)][_0xf92e1(0x18a)]=Date['now']();const _0x24a609={'role':_0xf92e1(0x152),'type':_0xf92e1(0xc05),'content':'['+_0x1730bb['name']+_0xf92e1(0xddd)+_0x341085[_0xf92e1(0xa51)]+']','timestamp':Date['now']()};_0x1730bb[_0xf92e1(0x1294)]['push'](_0x24a609);_0x2baa6b&&_0x468ef0(_0x24a609,_0x1730bb);_0x597ed7();continue;case _0xf92e1(0x920):_0x10eebb={..._0x210926,'type':'location_share','content':_0x341085['content']};break;case _0xf92e1(0x4aa):if(_0x5ebb31['isActive']&&_0x5ebb31['activeChatId']===_0x47893f){const _0x54b630=_0x341085[_0xf92e1(0x591)]||_0x341085['song']||_0x341085[_0xf92e1(0x578)];if(typeof _0x54b630==='string'&&_0x54b630[_0xf92e1(0x7da)]()){const _0x1eb6b9=_0x54b630['replace'](/^\[?\d+\]?[\s.-]*/,'')[_0xf92e1(0x7da)](),_0x1d1eb0=_0x5ebb31[_0xf92e1(0xd9f)]['findIndex'](_0x6f1ea3=>_0x6f1ea3[_0xf92e1(0x578)]['toLowerCase']()===_0x1eb6b9[_0xf92e1(0x963)]());if(_0x1d1eb0>-0x1){_0x21a08a(_0x1d1eb0);const _0x2b181d=_0x5ebb31[_0xf92e1(0xd9f)][_0x1d1eb0];let _0x303f7e;if(_0x1730bb[_0xf92e1(0x80b)]){const _0x68a629=_0x1730bb[_0xf92e1(0xd5b)]['find'](_0x4e8a89=>_0x4e8a89[_0xf92e1(0x776)]===_0x341085[_0xf92e1(0x578)]);_0x303f7e=_0x68a629?_0x68a629[_0xf92e1(0x6e2)]:_0x341085['name'];}else _0x303f7e=_0x1730bb[_0xf92e1(0x578)];const _0x177197={'role':_0xf92e1(0x152),'type':_0xf92e1(0xc05),'content':_0xf92e1(0xbe5)+_0x303f7e+_0xf92e1(0x101d)+_0x2b181d[_0xf92e1(0x578)]+_0xf92e1(0xe6a)+_0x2b181d[_0xf92e1(0x200)]+']','timestamp':Date[_0xf92e1(0x6ee)]()};_0x1730bb[_0xf92e1(0x1294)][_0xf92e1(0x2d6)](_0x177197),_0x2baa6b&&_0x468ef0(_0x177197,_0x1730bb);}else console[_0xf92e1(0x54a)](_0xf92e1(0x10b4)+_0x54b630+_0xf92e1(0x17e)+_0x1eb6b9+_0xf92e1(0xf25));}else console[_0xf92e1(0x4d9)]('AI返回的change_music指令中，歌曲名无效或缺失:',_0x341085);}continue;case'create_memory':const _0x39e0f3={'chatId':_0x47893f,'authorId':_0x47893f,'description':_0x341085[_0xf92e1(0x11ac)],'timestamp':Date[_0xf92e1(0x6ee)](),'type':_0xf92e1(0xa1f)};await _0x2a2987['memories'][_0xf92e1(0xb9)](_0x39e0f3),console[_0xf92e1(0x51f)]('AI\x20\x22'+_0x1730bb[_0xf92e1(0x578)]+_0xf92e1(0x860),_0x341085['description']);continue;case _0xf92e1(0x63e):const _0x1579d1=new Date(_0x341085['date']);if(!isNaN(_0x1579d1)&&_0x1579d1>new Date()){const _0x22fdd9={'chatId':_0x47893f,'authorId':_0x47893f,'description':_0x341085[_0xf92e1(0x874)],'timestamp':Date[_0xf92e1(0x6ee)](),'type':_0xf92e1(0x353),'targetDate':_0x1579d1['getTime']()};await _0x2a2987[_0xf92e1(0x37c)][_0xf92e1(0xb9)](_0x22fdd9),console['log'](_0xf92e1(0xc90)+_0x1730bb[_0xf92e1(0x578)]+'\x22\x20创建了一个新约定:',_0x341085[_0xf92e1(0x874)]);}continue;case _0xf92e1(0xf62):if(!_0x1730bb[_0xf92e1(0x80b)]){_0x1730bb['relationship']['status']=_0xf92e1(0x1019);const _0x43c396={'role':_0xf92e1(0x152),'content':_0xf92e1(0xfbf),'timestamp':Date[_0xf92e1(0x6ee)](),'isHidden':!![]};_0x1730bb[_0xf92e1(0x1294)][_0xf92e1(0x2d6)](_0x43c396),await _0x2a2987['chats'][_0xf92e1(0xf36)](_0x1730bb);_0x2baa6b&&_0x1bbfd3(_0x47893f);_0x597ed7();break;}continue;case _0xf92e1(0x2e9):!_0x1730bb['isGroup']&&_0x1730bb[_0xf92e1(0x1cb)]?.['status']==='pending_ai_approval'&&(_0x341085[_0xf92e1(0x815)]==='accept'?(_0x1730bb[_0xf92e1(0x1cb)][_0xf92e1(0xbc8)]='friend',_0x10eebb={..._0x210926,'content':_0xf92e1(0xc58)}):(_0x1730bb['relationship']['status']=_0xf92e1(0x1019),_0x10eebb={..._0x210926,'content':'抱歉，我拒绝了你的好友申请。'}),_0x1730bb[_0xf92e1(0x1cb)]['applicationReason']='');break;case _0xf92e1(0x9ba):const _0x3c9c2a=typeof _0x341085[_0xf92e1(0x6c2)]===_0xf92e1(0x9de)?_0x341085[_0xf92e1(0x6c2)][_0xf92e1(0x8d7)]('\x0a')[_0xf92e1(0x1054)](_0x5bdd89=>_0x5bdd89[_0xf92e1(0x7da)]()):Array[_0xf92e1(0x621)](_0x341085['options'])?_0x341085[_0xf92e1(0x6c2)]:[];if(_0x3c9c2a[_0xf92e1(0x79b)]<0x2)continue;_0x10eebb={..._0x210926,'type':'poll','question':_0x341085[_0xf92e1(0x11a3)],'options':_0x3c9c2a,'votes':{},'isClosed':![]};break;case _0xf92e1(0x7ef):{const {itemName:_0x4a480c,itemPrice:_0xf1efd9,image_prompt:_0x1f31c2}=_0x341085;if(_0x4a480c&&!isNaN(parseFloat(_0xf1efd9))&&_0x1f31c2){const _0x22ddcb='https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x1f31c2);_0x10eebb={..._0x210926,'type':_0xf92e1(0x7ef),'items':[{'name':_0x4a480c,'price':parseFloat(_0xf1efd9),'imageUrl':_0x22ddcb,'quantity':0x1}],'total':parseFloat(_0xf1efd9),'recipients':_0x341085[_0xf92e1(0x2e7)]||null};}else console[_0xf92e1(0x54a)](_0xf92e1(0xae3),_0x341085);break;}case _0xf92e1(0x75f):const _0xed9725=_0x1730bb[_0xf92e1(0x1294)][_0xf92e1(0xd85)](_0x75c679=>_0x75c679[_0xf92e1(0x2f0)]===_0x341085[_0xf92e1(0x8ac)]);_0xed9725&&!_0xed9725[_0xf92e1(0xead)]&&(Object[_0xf92e1(0x1c6)](_0xed9725[_0xf92e1(0x4d4)])['forEach'](_0x1b1ade=>{const _0x3aceac=_0xf92e1,_0x3faf27=_0xed9725['votes'][_0x1b1ade][_0x3aceac(0x107e)](_0x341085[_0x3aceac(0x578)]);_0x3faf27>-0x1&&_0xed9725[_0x3aceac(0x4d4)][_0x1b1ade][_0x3aceac(0xbd1)](_0x3faf27,0x1);}),!_0xed9725['votes'][_0x341085[_0xf92e1(0xc10)]]&&(_0xed9725[_0xf92e1(0x4d4)][_0x341085['choice']]=[]),!_0xed9725[_0xf92e1(0x4d4)][_0x341085['choice']][_0xf92e1(0x1d4)](_0x341085['name'])&&_0xed9725[_0xf92e1(0x4d4)][_0x341085[_0xf92e1(0xc10)]][_0xf92e1(0x2d6)](_0x341085[_0xf92e1(0x578)]),_0x2baa6b&&_0x1bbfd3(_0x47893f));continue;case _0xf92e1(0xaa2):_0x10eebb={..._0x210926,..._0x341085,'totalAmount':_0x341085[_0xf92e1(0x609)],'claimedBy':{},'isFullyClaimed':![]};_0x341085[_0xf92e1(0x44d)]&&(_0x10eebb[_0xf92e1(0x204)]=_0x341085[_0xf92e1(0x44d)],delete _0x10eebb[_0xf92e1(0x44d)]);break;case _0xf92e1(0x800):const _0x3ef194=_0x1730bb[_0xf92e1(0x1294)][_0xf92e1(0xd85)](_0x37d634=>_0x37d634[_0xf92e1(0x2f0)]===_0x341085[_0xf92e1(0x803)]),_0x3a5fd4=_0x341085['name'],_0x15514b=_0x1730bb[_0xf92e1(0xd5b)][_0xf92e1(0xfa7)](_0x3bf7f7=>_0x3bf7f7[_0xf92e1(0x776)]===_0x3a5fd4);if(!_0x15514b){console[_0xf92e1(0x54a)](_0xf92e1(0x961)+_0x3a5fd4+'\x22\x20尝试领取不属于自己的群聊红包。操作已被拦截。');continue;}if(_0x3ef194&&_0x3ef194[_0xf92e1(0xa2a)]===_0xf92e1(0x3d4)){if(_0x3ef194['receiverName']!==_0x341085[_0xf92e1(0x578)]){console[_0xf92e1(0x54a)](_0xf92e1(0x961)+_0x341085[_0xf92e1(0x578)]+'\x22\x20尝试领取不属于自己的专属红包\x20(接收人:\x20'+_0x3ef194[_0xf92e1(0x204)]+')。操作已被拦截。');continue;}}if(_0x3ef194&&!_0x3ef194[_0xf92e1(0x1140)]&&!(_0x3ef194[_0xf92e1(0xea5)]&&_0x3ef194[_0xf92e1(0xea5)][_0x341085['name']])){let _0x29db6c=0x0;const _0x4ced64=_0x3ef194[_0xf92e1(0x10ed)]-Object[_0xf92e1(0xd28)](_0x3ef194[_0xf92e1(0xea5)]||{})['reduce']((_0x40324a,_0x51179a)=>_0x40324a+_0x51179a,0x0),_0x2b141f=_0x3ef194[_0xf92e1(0x109)]-Object[_0xf92e1(0x1c6)](_0x3ef194['claimedBy']||{})['length'];if(_0x2b141f>0x0){if(_0x3ef194[_0xf92e1(0xa2a)]===_0xf92e1(0x3d4))_0x29db6c=_0x3ef194[_0xf92e1(0x10ed)];else{if(_0x2b141f===0x1)_0x29db6c=_0x4ced64;else{const _0x690355=0.01,_0x1f53c2=_0x4ced64-(_0x2b141f-0x1)*_0x690355;_0x29db6c=Math[_0xf92e1(0xa11)]()*(_0x1f53c2-_0x690355)+_0x690355;}}_0x29db6c=parseFloat(_0x29db6c[_0xf92e1(0xcab)](0x2));if(!_0x3ef194['claimedBy'])_0x3ef194['claimedBy']={};_0x3ef194[_0xf92e1(0xea5)][_0x341085[_0xf92e1(0x578)]]=_0x29db6c;const _0x46e5f4=_0x1730bb[_0xf92e1(0xd5b)][_0xf92e1(0xd85)](_0x541b27=>_0x541b27[_0xf92e1(0x776)]===_0x341085[_0xf92e1(0x578)]),_0xfb9f1a=_0x46e5f4?_0x46e5f4[_0xf92e1(0x6e2)]:_0x341085[_0xf92e1(0x578)],_0x5bcb83=_0x3fb61d(_0x1730bb,_0x3ef194[_0xf92e1(0xe32)]),_0x51f5e2={'role':_0xf92e1(0x152),'type':'pat_message','content':_0xfb9f1a+_0xf92e1(0x43d)+_0x5bcb83+_0xf92e1(0xda9),'timestamp':Date[_0xf92e1(0x6ee)]()};_0x1730bb['history']['push'](_0x51f5e2);let _0x418b80=_0xf92e1(0xb47)+_0xfb9f1a+_0xf92e1(0x4e6)+_0x29db6c[_0xf92e1(0xcab)](0x2)+'\x20元。';if(Object[_0xf92e1(0x1c6)](_0x3ef194['claimedBy'])['length']>=_0x3ef194['count']){_0x3ef194[_0xf92e1(0x1140)]=!![];const _0x30e513={'role':_0xf92e1(0x152),'type':'pat_message','content':_0x5bcb83+'\x20的红包已被领完','timestamp':Date['now']()+0x1};_0x1730bb[_0xf92e1(0x1294)][_0xf92e1(0x2d6)](_0x30e513);let _0x254d38={'name':'','amount':-0x1};_0x3ef194[_0xf92e1(0xa2a)]==='lucky'&&_0x3ef194['count']>0x1&&Object[_0xf92e1(0x43e)](_0x3ef194[_0xf92e1(0xea5)])[_0xf92e1(0xd6a)](([_0x562749,_0x2dc474])=>{_0x2dc474>_0x254d38['amount']&&(_0x254d38={'name':_0x562749,'amount':_0x2dc474});});if(_0x254d38[_0xf92e1(0x578)]){const _0x573ba8=_0x1730bb['members'][_0xf92e1(0xd85)](_0x2f06ee=>_0x2f06ee[_0xf92e1(0x776)]===_0x254d38[_0xf92e1(0x578)]),_0x3ba0a8=_0x573ba8?_0x573ba8['groupNickname']:_0x254d38[_0xf92e1(0x578)];_0x418b80+=_0xf92e1(0xf49)+_0x3ba0a8+'！';}else _0x418b80+=_0xf92e1(0xa01);}_0x418b80+=_0xf92e1(0xcf5);const _0x11b637={'role':_0xf92e1(0x152),'content':_0x418b80,'timestamp':Date[_0xf92e1(0x6ee)]()+0x2,'isHidden':!![]};_0x1730bb[_0xf92e1(0x1294)]['push'](_0x11b637);}_0x2baa6b&&(_0x1bbfd3(_0x47893f),_0x597ed7());}continue;case _0xf92e1(0xe1c):{const _0x11fea8=_0x1730bb['history'][_0xf92e1(0xce9)](_0x52c4ee=>_0x52c4ee[_0xf92e1(0x2f0)]===_0x341085[_0xf92e1(0x9b6)]);if(_0x11fea8>-0x1){const _0x403461=_0x1730bb[_0xf92e1(0x1294)][_0x11fea8];_0x403461[_0xf92e1(0xbc8)]=_0xf92e1(0x316);}continue;}case'decline_transfer':{const _0x1a1791=_0x1730bb[_0xf92e1(0x1294)][_0xf92e1(0xce9)](_0x1defb9=>_0x1defb9[_0xf92e1(0x2f0)]===_0x341085[_0xf92e1(0x9b6)]);if(_0x1a1791>-0x1){const _0x52acd1=_0x1730bb[_0xf92e1(0x1294)][_0x1a1791];_0x52acd1[_0xf92e1(0xbc8)]=_0xf92e1(0x95b);const _0x50e229={'role':_0xf92e1(0x376),'senderName':_0x1730bb['name'],'type':_0xf92e1(0xe86),'isRefund':!![],'amount':_0x52acd1[_0xf92e1(0x609)],'note':_0xf92e1(0xa5),'timestamp':_0x24723c++};_0x1730bb[_0xf92e1(0x1294)][_0xf92e1(0x2d6)](_0x50e229),_0x2baa6b&&(_0x468ef0(_0x50e229,_0x1730bb),_0x1bbfd3(_0x47893f));}continue;}case _0xf92e1(0xb1d):if(_0x1730bb[_0xf92e1(0x80b)]&&_0x341085[_0xf92e1(0x1049)]){const _0x4f61c8=_0x341085['new_name'][_0xf92e1(0x7da)](),_0x3b18a6=_0x1730bb[_0xf92e1(0xd5b)][_0xf92e1(0x9d5)](_0x359737=>_0x359737[_0xf92e1(0x776)]);if(_0x3b18a6[_0xf92e1(0x1d4)](_0x4f61c8)){console[_0xf92e1(0x54a)](_0xf92e1(0x7e7)+_0x341085[_0xf92e1(0x578)]+_0xf92e1(0x105f)+_0x4f61c8+_0xf92e1(0x45a));continue;}_0x1730bb['name']=_0x4f61c8;const _0x5ac63a=_0x1730bb[_0xf92e1(0xd5b)]['find'](_0x3d7e69=>_0x3d7e69[_0xf92e1(0x776)]===_0x341085[_0xf92e1(0x578)]),_0xa2043a=_0x5ac63a?_0x5ac63a['groupNickname']:_0x341085['name'],_0x4123f3={'role':_0xf92e1(0x152),'type':_0xf92e1(0xc05),'content':_0xa2043a+'\x20将群名修改为\x20“'+_0x1730bb[_0xf92e1(0x578)]+'”','timestamp':_0x24723c++};_0x1730bb['history']['push'](_0x4123f3),_0x2baa6b&&(_0x468ef0(_0x4123f3,_0x1730bb),document[_0xf92e1(0xc33)](_0xf92e1(0x40c))[_0xf92e1(0x11b0)]=_0x1730bb[_0xf92e1(0x578)]);}continue;case _0xf92e1(0xe7e):if(!_0x1730bb['isGroup']&&_0x341085['new_name']){const _0x2a0c19=_0x1730bb[_0xf92e1(0x578)],_0x44dc44=_0x341085['new_name'][_0xf92e1(0x7da)]();if(_0x44dc44&&_0x44dc44!==_0x2a0c19){!_0x1730bb[_0xf92e1(0xa1a)]&&(_0x1730bb[_0xf92e1(0xa1a)]=[]);!_0x1730bb[_0xf92e1(0xa1a)][_0xf92e1(0x1d4)](_0x2a0c19)&&_0x1730bb['nameHistory'][_0xf92e1(0x2d6)](_0x2a0c19);_0x1730bb['name']=_0x44dc44;const _0x4e5ef1={'role':'system','type':_0xf92e1(0xc05),'content':'“'+_0x1730bb[_0xf92e1(0x776)]+_0xf92e1(0x3b1)+_0x44dc44+'”','timestamp':_0x24723c++};_0x1730bb['history'][_0xf92e1(0x2d6)](_0x4e5ef1);const _0x2caeb6={'role':'system','content':_0xf92e1(0x93a)+_0x44dc44+_0xf92e1(0xfd0),'timestamp':_0x24723c++,'isHidden':!![]};_0x1730bb[_0xf92e1(0x1294)]['push'](_0x2caeb6),_0x2baa6b&&(_0x468ef0(_0x4e5ef1,_0x1730bb),document['getElementById'](_0xf92e1(0x40c))[_0xf92e1(0x11b0)]=_0x44dc44),await _0x29067b(_0x1730bb);}}continue;case _0xf92e1(0x102):if(_0x1730bb[_0xf92e1(0x80b)]&&_0x341085[_0xf92e1(0xf47)]){const _0x17645e=_0x341085[_0xf92e1(0xf47)],_0x53abf8=_0x1730bb[_0xf92e1(0x2ea)]['groupAvatarLibrary']||[],_0x57f5c9=_0x53abf8['find'](_0x4b4918=>_0x4b4918[_0xf92e1(0x578)]===_0x17645e);if(_0x57f5c9){_0x1730bb[_0xf92e1(0x2ea)][_0xf92e1(0x78a)]=_0x57f5c9[_0xf92e1(0x11a)];const _0x24bfc6=_0x1730bb[_0xf92e1(0xd5b)][_0xf92e1(0xd85)](_0x4355c3=>_0x4355c3[_0xf92e1(0x776)]===_0x341085[_0xf92e1(0x578)]),_0x4cf357=_0x24bfc6?_0x24bfc6[_0xf92e1(0x6e2)]:_0x341085[_0xf92e1(0x578)],_0x13c2f8={'role':'system','type':_0xf92e1(0xc05),'content':_0x4cf357+_0xf92e1(0x1229),'timestamp':_0x24723c++};_0x1730bb[_0xf92e1(0x1294)][_0xf92e1(0x2d6)](_0x13c2f8),_0x2baa6b&&_0x468ef0(_0x13c2f8,_0x1730bb);}else console[_0xf92e1(0x54a)](_0xf92e1(0x844)+_0x17645e+'\x22');}continue;case'system_message':_0x10eebb={'role':'system','type':_0xf92e1(0xc05),'content':_0x341085[_0xf92e1(0xcbd)],'timestamp':Date[_0xf92e1(0x6ee)]()};break;case'share_link':_0x10eebb={..._0x210926,'type':_0xf92e1(0xa6a),'title':_0x341085[_0xf92e1(0x874)],'description':_0x341085[_0xf92e1(0x11ac)],'source_name':_0x341085[_0xf92e1(0x50a)],'content':_0x341085[_0xf92e1(0xcbd)]};break;case _0xf92e1(0x4bf):const _0x3809c6=_0x1730bb['history'][_0xf92e1(0xd85)](_0x3189a2=>_0x3189a2[_0xf92e1(0x2f0)]===_0x341085[_0xf92e1(0xdbb)]);if(_0x3809c6){const _0x44ad9d={'timestamp':_0x3809c6[_0xf92e1(0x2f0)],'senderName':_0x3809c6[_0xf92e1(0xe32)]||(_0x3809c6[_0xf92e1(0x16d)]==='user'?_0x1730bb[_0xf92e1(0x2ea)][_0xf92e1(0xbf6)]||'我':_0x1730bb[_0xf92e1(0x578)]),'content':String(_0x3809c6['content']||'')[_0xf92e1(0x1033)](0x0,0x32)};_0x10eebb={..._0x210926,'content':_0x341085[_0xf92e1(0xa32)],'quote':_0x44ad9d};}else _0x10eebb={..._0x210926,'content':_0x341085[_0xf92e1(0xa32)]};break;case _0xf92e1(0x1ce):{if(!_0x2baa6b)continue;const _0x147794={..._0x210926,'content':_0x341085[_0xf92e1(0xcbd)]},_0x12eb6a=_0x3f3a68(_0x147794,_0x1730bb);_0x468ef0(_0x147794,_0x1730bb,!![]),await new Promise(_0x1a838a=>setTimeout(_0x1a838a,Math[_0xf92e1(0xa11)]()*0x3e8+0x5dc));const _0x24c227=document[_0xf92e1(0x977)](_0xf92e1(0xe27)+_0x147794[_0xf92e1(0x2f0)]+'\x22]')?.[_0xf92e1(0x7a7)](_0xf92e1(0x1ab));if(_0x24c227){_0x24c227[_0xf92e1(0x10d3)][_0xf92e1(0xb9)](_0xf92e1(0x4be)),await new Promise(_0x7a9e6f=>setTimeout(_0x7a9e6f,0x12c));const _0x126c1b={'role':_0xf92e1(0x376),'senderName':_0x341085[_0xf92e1(0x578)]||_0x1730bb[_0xf92e1(0x578)],'type':_0xf92e1(0x960),'content':_0xf92e1(0x1dd),'timestamp':_0x147794[_0xf92e1(0x2f0)],'recalledData':{'originalType':_0xf92e1(0x996),'originalContent':_0x341085[_0xf92e1(0xcbd)]}},_0x53d67b=_0x1730bb[_0xf92e1(0x1294)]['findIndex'](_0xa5baf0=>_0xa5baf0[_0xf92e1(0x2f0)]===_0x147794['timestamp']);_0x53d67b>-0x1?_0x1730bb[_0xf92e1(0x1294)][_0x53d67b]=_0x126c1b:_0x1730bb[_0xf92e1(0x1294)]['push'](_0x126c1b);const _0x2bf696=await _0x3f3a68(_0x126c1b,_0x1730bb);document[_0xf92e1(0x344)][_0xf92e1(0x3af)](_0x24c227)&&_0x24c227[_0xf92e1(0x1053)]['replaceChild'](_0x2bf696,_0x24c227);}continue;}case _0xf92e1(0x996):_0x10eebb={..._0x210926,'content':String(_0x341085[_0xf92e1(0xcbd)]||_0x341085[_0xf92e1(0xf93)])};break;case'sticker':if(_0x341085[_0xf92e1(0x127d)]){const _0x23b8d9=_0x12493e[_0xf92e1(0x454)]['find'](_0x2ad445=>_0x2ad445[_0xf92e1(0x578)]===_0x341085[_0xf92e1(0x127d)]);_0x23b8d9?_0x10eebb={..._0x210926,'type':_0xf92e1(0x966),'content':_0x23b8d9[_0xf92e1(0x11a)],'meaning':_0x23b8d9[_0xf92e1(0x578)]}:(console[_0xf92e1(0x54a)](_0xf92e1(0xde1)+_0x341085['meaning']+'\x22'),_0x10eebb={..._0x210926,'type':'text','content':_0xf92e1(0xa21)+_0x341085[_0xf92e1(0x127d)]+']'});}else console[_0xf92e1(0x54a)](_0xf92e1(0xeda),_0x341085),_0x10eebb={..._0x210926,'type':_0xf92e1(0x966),'content':_0x341085[_0xf92e1(0x11a)],'meaning':_0xf92e1(0x518)};break;case _0xf92e1(0x8f5):_0x10eebb={..._0x210926,'type':'ai_image','content':_0x341085[_0xf92e1(0x11ac)],'image_prompt':_0x341085[_0xf92e1(0xe3d)]};break;case _0xf92e1(0xb41):_0x10eebb={..._0x210926,'type':_0xf92e1(0xb41),'content':_0x341085[_0xf92e1(0xcbd)]};break;case _0xf92e1(0xe86):_0x10eebb={..._0x210926,'type':'transfer','amount':_0x341085[_0xf92e1(0x609)],'note':_0x341085[_0xf92e1(0x164)],'receiverName':_0x341085[_0xf92e1(0x44d)]||'我'};break;case _0xf92e1(0x71d):_0x10eebb={..._0x210926,'type':_0xf92e1(0x71d),'productInfo':_0x341085[_0xf92e1(0x11d3)],'amount':_0x341085[_0xf92e1(0x609)],'status':_0xf92e1(0x1025),'countdownEndTime':Date[_0xf92e1(0x6ee)]()+0xf*0x3c*0x3e8};break;case _0xf92e1(0x329):_0x10eebb={..._0x210926,'type':_0xf92e1(0x329),'productInfo':_0x341085[_0xf92e1(0x11d3)],'amount':_0x341085[_0xf92e1(0x609)],'greeting':_0x341085[_0xf92e1(0x9b5)],'recipientName':_0x341085[_0xf92e1(0xd4c)]||null};break;case _0xf92e1(0x6bf):_0x10eebb={..._0x210926,..._0x341085};break;case _0xf92e1(0xcd5):try{console['log'](_0xf92e1(0xdf1),_0x341085['prompt']);const _0x2d53f6=_0x12d22d(_0x1730bb['id']),_0x36c35a=_0x341085[_0xf92e1(0x933)]||_0xf92e1(0x7a),_0x20450d=_0x36c35a+',\x20'+_0x2d53f6[_0xf92e1(0x1177)],_0x375cbb=_0x2d53f6['negative'];console[_0xf92e1(0x51f)](_0xf92e1(0x8e0)+(_0x2d53f6[_0xf92e1(0x127c)]===_0xf92e1(0x46a)?_0xf92e1(0x4db):'系统')+'提示词配置'),console[_0xf92e1(0x51f)]('最终正面提示词:',_0x20450d),console[_0xf92e1(0x51f)]('最终负面提示词:',_0x375cbb);const _0x1643d2=localStorage[_0xf92e1(0x7bb)](_0xf92e1(0x10a4)),_0x5abebc=localStorage[_0xf92e1(0x7bb)](_0xf92e1(0x36a))||_0xf92e1(0x893),_0x2b6cbd=_0x2f5e99();if(!_0x1643d2)throw new Error(_0xf92e1(0xbaa));const [_0x13b1f4,_0x4204d4]=_0x2b6cbd['resolution']['split']('x')[_0xf92e1(0x9d5)](Number);let _0x257f51;_0x5abebc[_0xf92e1(0x1d4)]('nai-diffusion-4')?_0x257f51={'input':_0x20450d,'model':_0x5abebc,'action':_0xf92e1(0x1e9),'parameters':{'params_version':0x3,'width':_0x13b1f4,'height':_0x4204d4,'scale':_0x2b6cbd[_0xf92e1(0xeaa)],'sampler':_0x2b6cbd[_0xf92e1(0x6e5)],'steps':_0x2b6cbd['steps'],'seed':_0x2b6cbd[_0xf92e1(0xd0b)]===-0x1?Math['floor'](Math[_0xf92e1(0xa11)]()*0x2540be3ff):_0x2b6cbd[_0xf92e1(0xd0b)],'n_samples':0x1,'ucPreset':_0x2b6cbd[_0xf92e1(0xc4d)],'qualityToggle':_0x2b6cbd['quality_toggle'],'autoSmea':![],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':!![],'cfg_rescale':0x0,'noise_schedule':'karras','legacy_v3_extend':![],'skip_cfg_above_sigma':null,'use_coords':![],'legacy_uc':![],'normalize_reference_strength_multiple':!![],'inpaintImg2ImgStrength':0x1,'characterPrompts':[],'v4_prompt':{'caption':{'base_caption':_0x20450d,'char_captions':[]},'use_coords':![],'use_order':!![]},'v4_negative_prompt':{'caption':{'base_caption':_0x375cbb,'char_captions':[]},'legacy_uc':![]},'negative_prompt':_0x375cbb,'deliberate_euler_ancestral_bug':![],'prefer_brownian':!![]}}:_0x257f51={'input':_0x20450d,'model':_0x5abebc,'action':'generate','parameters':{'width':_0x13b1f4,'height':_0x4204d4,'scale':_0x2b6cbd[_0xf92e1(0xeaa)],'sampler':_0x2b6cbd[_0xf92e1(0x6e5)],'steps':_0x2b6cbd[_0xf92e1(0x2f7)],'seed':_0x2b6cbd[_0xf92e1(0xd0b)]===-0x1?Math['floor'](Math[_0xf92e1(0xa11)]()*0x2540be3ff):_0x2b6cbd[_0xf92e1(0xd0b)],'n_samples':0x1,'ucPreset':_0x2b6cbd[_0xf92e1(0xc4d)],'qualityToggle':_0x2b6cbd[_0xf92e1(0xbb0)],'sm':_0x2b6cbd[_0xf92e1(0xb8e)],'sm_dyn':_0x2b6cbd['smea_dyn'],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':![],'cfg_rescale':0x0,'noise_schedule':_0xf92e1(0xae0),'negative_prompt':_0x375cbb}};console[_0xf92e1(0x51f)](_0xf92e1(0x8ed),_0x257f51);let _0x1aded6;_0x5abebc['includes'](_0xf92e1(0xeaf))?_0x1aded6=_0xf92e1(0x9b2):_0x1aded6=_0xf92e1(0x76);let _0xec64fc=_0x2b6cbd[_0xf92e1(0xe9e)];_0xec64fc==='custom'&&(_0xec64fc=_0x2b6cbd['custom_proxy_url']||'');_0xec64fc&&_0xec64fc!==''&&(_0x1aded6=_0xec64fc+encodeURIComponent(_0x1aded6));const _0x52c8b7=await fetch(_0x1aded6,{'method':_0xf92e1(0x90),'headers':{'Content-Type':_0xf92e1(0xd74),'Authorization':_0xf92e1(0xf20)+_0x1643d2},'body':JSON['stringify'](_0x257f51)});console['log'](_0xf92e1(0x8c3),_0x52c8b7[_0xf92e1(0xbc8)]),console[_0xf92e1(0x51f)]('Response\x20headers:',[..._0x52c8b7[_0xf92e1(0x15f)][_0xf92e1(0x43e)]()]);if(!_0x52c8b7['ok']){const _0x27d5a3=await _0x52c8b7[_0xf92e1(0x996)]();console['error']('API错误响应:',_0x27d5a3);throw new Error(_0xf92e1(0x60f)+_0x52c8b7[_0xf92e1(0xbc8)]+'):\x20'+_0x27d5a3);}const _0x3bd138=_0x52c8b7['headers'][_0xf92e1(0xec0)](_0xf92e1(0x590));console[_0xf92e1(0x51f)](_0xf92e1(0x3c6),_0x3bd138);let _0x4fba44,_0x4e6e35;if(_0x3bd138&&_0x3bd138[_0xf92e1(0x1d4)](_0xf92e1(0x1024))){console['log'](_0xf92e1(0x189));const _0x1147e3=await _0x52c8b7[_0xf92e1(0x996)]();console[_0xf92e1(0x51f)](_0xf92e1(0x50c),_0x1147e3[_0xf92e1(0x79b)]);const _0x200e7c=_0x1147e3['trim']()['split']('\x0a');let _0x28b90f=null;for(let _0x230330=_0x200e7c[_0xf92e1(0x79b)]-0x1;_0x230330>=0x0;_0x230330--){const _0x5bf262=_0x200e7c[_0x230330][_0xf92e1(0x7da)]();if(_0x5bf262[_0xf92e1(0xece)](_0xf92e1(0xc20))&&_0x5bf262!==_0xf92e1(0x11d9)){const _0x1b2cd0=_0x5bf262[_0xf92e1(0x1033)](0x6);try{const _0x2c8172=JSON[_0xf92e1(0x6b1)](_0x1b2cd0);if(_0x2c8172['event_type']===_0xf92e1(0x5c7)&&_0x2c8172['image']){_0x28b90f=_0x2c8172[_0xf92e1(0x695)],console[_0xf92e1(0x51f)]('✅\x20找到\x20final\x20事件的图片数据');break;}if(_0x2c8172['data']){_0x28b90f=_0x2c8172[_0xf92e1(0xa78)],console[_0xf92e1(0x51f)]('从\x20JSON.data\x20中提取图片数据');break;}if(_0x2c8172['image']){_0x28b90f=_0x2c8172[_0xf92e1(0x695)],console['log'](_0xf92e1(0x5c0));break;}}catch(_0x5d32c0){_0x28b90f=_0x1b2cd0,console[_0xf92e1(0x51f)]('直接使用\x20base64\x20数据');break;}}}if(!_0x28b90f)throw new Error(_0xf92e1(0x6a5));const _0x170806=_0x28b90f[_0xf92e1(0xece)]('iVBORw0KGgo'),_0x51dcdb=_0x28b90f['startsWith']('/9j/');if(_0x170806||_0x51dcdb){console['log'](_0xf92e1(0x7be));const _0x1ad1f4=atob(_0x28b90f),_0x1e919=new Uint8Array(_0x1ad1f4['length']);for(let _0xa093cb=0x0;_0xa093cb<_0x1ad1f4[_0xf92e1(0x79b)];_0xa093cb++){_0x1e919[_0xa093cb]=_0x1ad1f4[_0xf92e1(0xe1)](_0xa093cb);}const _0x562fea=new Blob([_0x1e919],{'type':_0x170806?_0xf92e1(0x4b8):'image/jpeg'});console[_0xf92e1(0x51f)](_0xf92e1(0x426),_0x562fea['size']);const _0x19bf70=new FileReader();_0x4e6e35=await new Promise((_0x1106d9,_0x2782c6)=>{const _0x31fd8a=_0xf92e1;_0x19bf70[_0x31fd8a(0xebd)]=()=>_0x1106d9(_0x19bf70[_0x31fd8a(0x129)]),_0x19bf70['onerror']=_0x2782c6,_0x19bf70[_0x31fd8a(0xbcf)](_0x562fea);}),console[_0xf92e1(0x51f)](_0xf92e1(0x41f));}else{console['log'](_0xf92e1(0x257));const _0x150c2f=atob(_0x28b90f),_0x306043=new Uint8Array(_0x150c2f[_0xf92e1(0x79b)]);for(let _0x4e161b=0x0;_0x4e161b<_0x150c2f['length'];_0x4e161b++){_0x306043[_0x4e161b]=_0x150c2f[_0xf92e1(0xe1)](_0x4e161b);}_0x4fba44=new Blob([_0x306043]),console[_0xf92e1(0x51f)](_0xf92e1(0xc2f),_0x4fba44[_0xf92e1(0x57e)]);}}else _0x4fba44=await _0x52c8b7[_0xf92e1(0xed)](),console['log'](_0xf92e1(0xed6),_0x4fba44['type'],'大小:',_0x4fba44['size']);if(!_0x4e6e35&&_0x4fba44)try{if(typeof JSZip==='undefined')throw new Error(_0xf92e1(0x128d));const _0x476d0a=await JSZip['loadAsync'](_0x4fba44);console['log'](_0xf92e1(0xdb),Object['keys'](_0x476d0a[_0xf92e1(0x1d0)]));let _0x24a6b7=null;for(let _0x366d42 in _0x476d0a[_0xf92e1(0x1d0)]){if(_0x366d42[_0xf92e1(0x1242)](/\.(png|jpg|jpeg|webp)$/i)){_0x24a6b7=_0x476d0a['files'][_0x366d42],console[_0xf92e1(0x51f)](_0xf92e1(0x736),_0x366d42);break;}}if(!_0x24a6b7)throw new Error(_0xf92e1(0xb75));const _0x14e931=await _0x24a6b7[_0xf92e1(0xc52)]('blob');console['log'](_0xf92e1(0x7dd),_0x14e931[_0xf92e1(0x57e)]);const _0x10b23c=new FileReader();_0x4e6e35=await new Promise((_0x1e42d6,_0xdd872f)=>{const _0x3f38f3=_0xf92e1;_0x10b23c[_0x3f38f3(0xebd)]=()=>_0x1e42d6(_0x10b23c[_0x3f38f3(0x129)]),_0x10b23c[_0x3f38f3(0x6e0)]=_0xdd872f,_0x10b23c[_0x3f38f3(0xbcf)](_0x14e931);}),console[_0xf92e1(0x51f)](_0xf92e1(0x2d9));}catch(_0xe6d81b){console[_0xf92e1(0x4d9)]('ZIP解压失败:',_0xe6d81b);throw new Error(_0xf92e1(0x1e6)+_0xe6d81b[_0xf92e1(0xf93)]);}console['log'](_0xf92e1(0x705)),_0x10eebb={..._0x210926,'type':_0xf92e1(0xcd5),'imageUrl':_0x4e6e35,'prompt':_0x36c35a,'fullPrompt':_0x20450d};}catch(_0x540f4d){console[_0xf92e1(0x4d9)](_0xf92e1(0x922),_0x540f4d),_0x10eebb={..._0x210926,'content':_0xf92e1(0xda2)+_0x540f4d[_0xf92e1(0xf93)]+']'};}break;default:console[_0xf92e1(0x54a)](_0xf92e1(0x95c),_0x341085[_0xf92e1(0x52a)]);break;}if(_0x10eebb){_0x1730bb['history'][_0xf92e1(0x2d6)](_0x10eebb);!_0x2baa6b&&(_0x1730bb['unreadCount']=(_0x1730bb['unreadCount']||0x0)+0x1);if(!_0x2baa6b&&!_0x5ea46d){let _0x906228;switch(_0x10eebb['type']){case'transfer':_0x906228='[收到一笔转账]';break;case _0xf92e1(0x71d):_0x906228=_0xf92e1(0x822);break;case _0xf92e1(0x8f5):_0x906228=_0xf92e1(0x10e1);break;case _0xf92e1(0xb41):_0x906228='[语音]';break;case'sticker':_0x906228=_0x10eebb[_0xf92e1(0x127d)]?_0xf92e1(0xa21)+_0x10eebb['meaning']+']':_0xf92e1(0x75c);break;case _0xf92e1(0x6bf):_0x906228=_0x10eebb['dialogue']?'「'+_0x10eebb[_0xf92e1(0x156)]+'」':'['+_0x10eebb['description'][_0xf92e1(0x1033)](0x0,0x14)+'...]';break;default:_0x906228=String(_0x10eebb['content']||'');}const _0x5dfd88=_0x1730bb[_0xf92e1(0x80b)]?_0x10eebb[_0xf92e1(0xe32)]+':\x20'+_0x906228:_0x906228;_0x451557(_0x47893f,_0x5dfd88[_0xf92e1(0x1033)](0x0,0x28)+(_0x5dfd88[_0xf92e1(0x79b)]>0x28?_0xf92e1(0xda0):'')),_0x5ea46d=!![];}_0x2baa6b&&(_0x468ef0(_0x10eebb,_0x1730bb),await new Promise(_0x2c1ca2=>setTimeout(_0x2c1ca2,Math['random']()*0x708+0x3e8)));}}_0x2c6fa6&&_0x3b6ec9['isGroupCall']&&(_0x3b6ec9[_0xf92e1(0xd0)]=![],_0x3b6ec9[_0xf92e1(0x10d4)][_0xf92e1(0x79b)]>0x0?_0x8b7bf9():(_0x3b6ec9={..._0x3b6ec9,'isAwaitingResponse':![],'participants':[]},_0x38f00f(_0xf92e1(0xf1b)),alert(_0xf92e1(0x66b))));if(_0x5a73dc){await _0x439587();return;}await _0x2a2987[_0xf92e1(0xc45)]['put'](_0x1730bb);const _0x638348=_0x286a05[_0xf92e1(0xfa7)](_0x1659ac=>_0x1659ac['type']===_0xf92e1(0x4a1)||_0x1659ac['type']===_0xf92e1(0x1e2)||_0x1659ac[_0xf92e1(0x52a)]==='qzone_comment'||_0x1659ac[_0xf92e1(0x52a)]===_0xf92e1(0x106f));_0x638348&&(console['log'](_0xf92e1(0x110c)),await _0x14f3b0());}catch(_0x163183){_0x1730bb['history']=_0x1730bb[_0xf92e1(0x1294)][_0xf92e1(0x1054)](_0x3a7b3c=>!_0x3a7b3c['isTemporary']),!_0x1730bb['isGroup']&&_0x1730bb[_0xf92e1(0x1cb)]?.[_0xf92e1(0xbc8)]===_0xf92e1(0x4ab)?(_0x1730bb[_0xf92e1(0x1cb)][_0xf92e1(0xbc8)]=_0xf92e1(0x1019),await _0x2d7ddd('申请失败',_0xf92e1(0x35a)+_0x163183[_0xf92e1(0xf93)])):await _0x2d7ddd(_0xf92e1(0x11cd),'发生了一个错误，AI未能成功响应。\x0a\x0a错误详情:\x0a'+_0x163183[_0xf92e1(0xf93)]),!_0x1730bb[_0xf92e1(0x80b)]&&_0x1730bb[_0xf92e1(0x1cb)]?.[_0xf92e1(0xbc8)]===_0xf92e1(0x1019)&&await _0x2a2987['chats']['put'](_0x1730bb),_0x3b6ec9['isAwaitingResponse']=![];}finally{_0x15197e(_0x47893f,![]),_0x1730bb[_0xf92e1(0x80b)]?_0x2c63d9&&(_0x2c63d9[_0xf92e1(0x105d)][_0xf92e1(0xf44)]=_0xf92e1(0x854)):_0x160388&&_0x12493e['chats'][_0x47893f]&&(_0x160388[_0xf92e1(0x105d)][_0xf92e1(0x8d1)]=0x0,setTimeout(()=>{const _0x45edcf=_0xf92e1;_0x160388[_0x45edcf(0x11b0)]=_0x12493e[_0x45edcf(0xc45)][_0x47893f][_0x45edcf(0x578)],_0x160388[_0x45edcf(0x10d3)]['remove'](_0x45edcf(0x1201)),_0x160388[_0x45edcf(0x105d)][_0x45edcf(0x8d1)]=0x1;},0xc8)),_0x597ed7(),_0x30dc43&&_0x1ffd9c(_0x47893f),_0x375e7d();}}async function _0x3797e0(_0x4af0a7){const _0x3877b4=_0x247bea;if(!_0x12493e['activeChatId'])return;const _0xbae961=_0x12493e[_0x3877b4(0xc45)][_0x12493e[_0x3877b4(0x7bc)]],_0x33d356={'role':_0x3877b4(0x717),'content':_0x4af0a7['url'],'meaning':_0x4af0a7[_0x3877b4(0x578)],'timestamp':Date[_0x3877b4(0x6ee)]()};_0xbae961[_0x3877b4(0x1294)][_0x3877b4(0x2d6)](_0x33d356),await _0x2a2987[_0x3877b4(0xc45)][_0x3877b4(0xf36)](_0xbae961),_0x468ef0(_0x33d356,_0xbae961),_0x597ed7(),document[_0x3877b4(0xc33)](_0x3877b4(0x929))[_0x3877b4(0x10d3)]['remove']('visible');}async function _0x46f8b8(){const _0x3b8bbb=_0x247bea;if(!_0x12493e[_0x3b8bbb(0x7bc)])return;const _0x21ccfa=document[_0x3b8bbb(0xc33)](_0x3b8bbb(0x1ac)),_0x50a657=document[_0x3b8bbb(0xc33)](_0x3b8bbb(0x5e2)),_0x362f07=parseFloat(_0x21ccfa[_0x3b8bbb(0x22a)]),_0x21bfd2=_0x50a657[_0x3b8bbb(0x22a)][_0x3b8bbb(0x7da)]();if(isNaN(_0x362f07)||_0x362f07<0x0){alert(_0x3b8bbb(0x30c));return;}const _0x481fe4=_0x12493e[_0x3b8bbb(0xc45)][_0x12493e[_0x3b8bbb(0x7bc)]],_0x3af932=_0x481fe4[_0x3b8bbb(0x80b)]?_0x481fe4['settings'][_0x3b8bbb(0xbf6)]||'我':'我',_0x37eb3d=_0x481fe4['isGroup']?'群聊':_0x481fe4[_0x3b8bbb(0x578)],_0x3721db={'role':'user','type':_0x3b8bbb(0xe86),'amount':_0x362f07,'note':_0x21bfd2,'senderName':_0x3af932,'receiverName':_0x37eb3d,'timestamp':Date['now']()};_0x481fe4[_0x3b8bbb(0x1294)][_0x3b8bbb(0x2d6)](_0x3721db),await _0x2a2987[_0x3b8bbb(0xc45)][_0x3b8bbb(0xf36)](_0x481fe4),_0x468ef0(_0x3721db,_0x481fe4),_0x597ed7(),document[_0x3b8bbb(0xc33)](_0x3b8bbb(0x89a))[_0x3b8bbb(0x10d3)][_0x3b8bbb(0x2c7)](_0x3b8bbb(0x143)),_0x21ccfa[_0x3b8bbb(0x22a)]='',_0x50a657['value']='';}async function _0x95ab6f(){const _0x50db95=_0x247bea;if(!_0x12493e['activeChatId'])return;const _0xc74353=document['getElementById'](_0x50db95(0x1299)),_0x36083f=document['getElementById'](_0x50db95(0xc1e)),_0x170545=_0xc74353[_0x50db95(0x22a)][_0x50db95(0x7da)](),_0x52d4d0=parseFloat(_0x36083f['value']);if(!_0x170545||isNaN(_0x52d4d0)||_0x52d4d0<=0x0){alert(_0x50db95(0x19a));return;}const _0x195a71=_0x12493e[_0x50db95(0xc45)][_0x12493e[_0x50db95(0x7bc)]],_0x133d58=Date[_0x50db95(0x6ee)](),_0x19a7fd=_0x195a71['isGroup']?_0x195a71[_0x50db95(0x2ea)][_0x50db95(0xbf6)]||'我':'我',_0x2b324c={'role':_0x50db95(0x717),'senderName':_0x19a7fd,'type':_0x50db95(0x329),'productInfo':_0x170545,'amount':_0x52d4d0,'timestamp':_0x133d58};_0x195a71['history'][_0x50db95(0x2d6)](_0x2b324c);const _0x9a09a5={'role':_0x50db95(0x152),'content':'[系统提示：用户('+_0x19a7fd+_0x50db95(0x4dc)+_0x170545+_0x50db95(0x9cb)+_0x52d4d0+_0x50db95(0x121d),'timestamp':_0x133d58+0x1,'isHidden':!![]};_0x195a71[_0x50db95(0x1294)][_0x50db95(0x2d6)](_0x9a09a5),await _0x2a2987[_0x50db95(0xc45)][_0x50db95(0xf36)](_0x195a71),_0x468ef0(_0x2b324c,_0x195a71),_0x597ed7(),_0xc74353['value']='',_0x36083f[_0x50db95(0x22a)]='',document['getElementById'](_0x50db95(0x1083))[_0x50db95(0x10d3)][_0x50db95(0x2c7)]('visible');}async function _0x10d37f(){const _0x51fafc=_0x247bea;if(!_0x12493e[_0x51fafc(0x7bc)])return;const _0x1ff2e1=await _0x1ca09c(_0x51fafc(0xef0),_0x51fafc(0x830),'');if(!_0x1ff2e1||!_0x1ff2e1[_0x51fafc(0x7da)]())return;const _0xa83d59=_0x51fafc(0x3fe),_0x30e1ee=_0x12493e[_0x51fafc(0xc45)][_0x12493e['activeChatId']],_0x29cbbc={'role':_0x51fafc(0x717),'type':_0x51fafc(0x920),'content':_0x1ff2e1[_0x51fafc(0x7da)](),'imageUrl':_0xa83d59,'timestamp':Date[_0x51fafc(0x6ee)]()};_0x30e1ee[_0x51fafc(0x1294)][_0x51fafc(0x2d6)](_0x29cbbc),await _0x2a2987[_0x51fafc(0xc45)][_0x51fafc(0xf36)](_0x30e1ee),_0x468ef0(_0x29cbbc,_0x30e1ee),_0x597ed7();}function _0x16e7c2(_0x2aeaf7){const _0xd3f058=_0x247bea;if(_0x4085b7)return;_0x4085b7=!![],document[_0xd3f058(0xc33)]('chat-interface-screen')[_0xd3f058(0x10d3)][_0xd3f058(0xb9)]('selection-mode'),_0x102e81(_0x2aeaf7);}function _0x5e1dc2(){const _0x5d24d6=_0x247bea;_0x1b43dc();if(!_0x4085b7)return;_0x4085b7=![],document[_0x5d24d6(0xc33)](_0x5d24d6(0xf1b))['classList'][_0x5d24d6(0x2c7)]('selection-mode'),_0x2078e5[_0x5d24d6(0xd6a)](_0x3f4ef3=>{const _0x237c27=_0x5d24d6,_0x2052d8=document[_0x237c27(0x977)](_0x237c27(0xe27)+_0x3f4ef3+'\x22]');if(_0x2052d8)_0x2052d8[_0x237c27(0x10d3)][_0x237c27(0x2c7)]('selected');}),_0x2078e5[_0x5d24d6(0xebb)]();}function _0x102e81(_0x5d1e28){const _0x4c5299=_0x247bea,_0x5ec67c=document['querySelector']('.message-bubble[data-timestamp=\x22'+_0x5d1e28+'\x22]');if(!_0x5ec67c)return;_0x2078e5[_0x4c5299(0xa7)](_0x5d1e28)?(_0x2078e5[_0x4c5299(0x9ea)](_0x5d1e28),_0x5ec67c['classList'][_0x4c5299(0x2c7)](_0x4c5299(0x63f))):(_0x2078e5[_0x4c5299(0xb9)](_0x5d1e28),_0x5ec67c[_0x4c5299(0x10d3)][_0x4c5299(0xb9)](_0x4c5299(0x63f))),document[_0x4c5299(0xc33)](_0x4c5299(0x993))[_0x4c5299(0x11b0)]=_0x4c5299(0xac8)+_0x2078e5[_0x4c5299(0x57e)]+'\x20条',_0x2078e5['size']===0x0&&_0x5e1dc2();}function _0x29b870(_0x4f6ac4,_0x4f4921){const _0x509d2a=_0x247bea;let _0x4ab540;const _0x30a11f=_0x3ffa99=>{const _0x508f87=_0x26e9;if(_0x4085b7)return;_0x3ffa99[_0x508f87(0xe8)](),_0x4ab540=window[_0x508f87(0x1218)](()=>_0x4f4921(_0x3ffa99),0x1f4);},_0x20e101=()=>clearTimeout(_0x4ab540);_0x4f6ac4[_0x509d2a(0x205)](_0x509d2a(0x9e6),_0x30a11f),_0x4f6ac4['addEventListener'](_0x509d2a(0xacf),_0x20e101),_0x4f6ac4[_0x509d2a(0x205)]('mouseleave',_0x20e101),_0x4f6ac4[_0x509d2a(0x205)]('touchstart',_0x30a11f,{'passive':!![]}),_0x4f6ac4[_0x509d2a(0x205)](_0x509d2a(0x706),_0x20e101),_0x4f6ac4[_0x509d2a(0x205)]('touchmove',_0x20e101);}async function _0x1d6350(){const _0x38a4e6=_0x247bea,_0x53ff7e=_0x12493e[_0x38a4e6(0x7bc)];if(!_0x53ff7e)return;if(!_0x5ebb31[_0x38a4e6(0x1f3)]){_0x5cfbd6(_0x53ff7e);return;}if(_0x5ebb31[_0x38a4e6(0x7bc)]===_0x53ff7e)document[_0x38a4e6(0xc33)]('music-player-overlay')['classList']['add'](_0x38a4e6(0x143));else{const _0x4ce590=_0x12493e[_0x38a4e6(0xc45)][_0x5ebb31[_0x38a4e6(0x7bc)]]?.[_0x38a4e6(0x578)]||'未知',_0x57e187=_0x12493e[_0x38a4e6(0xc45)][_0x53ff7e]?.[_0x38a4e6(0x578)]||'当前',_0x4411e1=await _0x270512('切换听歌对象',_0x38a4e6(0xe93)+_0x4ce590+_0x38a4e6(0x16b)+_0x57e187+_0x38a4e6(0x33c),{'confirmButtonClass':'btn-danger'});_0x4411e1&&(await _0x3db293(!![]),await new Promise(_0x3445f2=>setTimeout(_0x3445f2,0x32)),_0x5cfbd6(_0x53ff7e));}}async function _0x5cfbd6(_0x1454b4){const _0x1f1a15=_0x247bea,_0x5bb518=_0x12493e['chats'][_0x1454b4];if(!_0x5bb518)return;_0x5ebb31[_0x1f1a15(0xec9)]=_0x5bb518[_0x1f1a15(0x33f)]['totalTime']||0x0,_0x5ebb31['isActive']=!![],_0x5ebb31['activeChatId']=_0x1454b4;_0x5ebb31[_0x1f1a15(0xd9f)][_0x1f1a15(0x79b)]>0x0?_0x5ebb31[_0x1f1a15(0x12a0)]=0x0:_0x5ebb31[_0x1f1a15(0x12a0)]=-0x1;if(_0x5ebb31[_0x1f1a15(0x88)])clearInterval(_0x5ebb31[_0x1f1a15(0x88)]);_0x5ebb31[_0x1f1a15(0x88)]=setInterval(()=>{const _0x37795f=_0x1f1a15;_0x5ebb31[_0x37795f(0xa4e)]&&(_0x5ebb31[_0x37795f(0xec9)]++,_0x2637b9());},0x3e8),_0x246e79(),_0x596fed(),document[_0x1f1a15(0xc33)]('music-player-overlay')[_0x1f1a15(0x10d3)][_0x1f1a15(0xb9)](_0x1f1a15(0x143));}async function _0x3db293(_0x485a92=!![]){const _0x2b5c85=_0x247bea;if(!_0x5ebb31[_0x2b5c85(0x1f3)])return;const _0xe2faeb=_0x5ebb31['activeChatId'];document[_0x2b5c85(0xc33)]('global-lyrics-bar')[_0x2b5c85(0x10d3)][_0x2b5c85(0x2c7)](_0x2b5c85(0x143));const _0x52bf5f=async()=>{const _0x5a03fd=_0x2b5c85;if(_0x5ebb31[_0x5a03fd(0x88)])clearInterval(_0x5ebb31[_0x5a03fd(0x88)]);if(_0x5ebb31['isPlaying'])_0x3ced3a[_0x5a03fd(0x47a)]();if(_0x485a92&&_0xe2faeb&&_0x12493e[_0x5a03fd(0xc45)][_0xe2faeb]){const _0x37f9f2=_0x12493e['chats'][_0xe2faeb];_0x37f9f2['musicData'][_0x5a03fd(0xd53)]=_0x5ebb31['totalElapsedTime'],await _0x2a2987[_0x5a03fd(0xc45)][_0x5a03fd(0xf36)](_0x37f9f2);}_0x5ebb31[_0x5a03fd(0x1f3)]=![],_0x5ebb31[_0x5a03fd(0x7bc)]=null,_0x5ebb31[_0x5a03fd(0xec9)]=0x0,_0x5ebb31[_0x5a03fd(0x88)]=null,_0x548d4f(_0xe2faeb,!![]);};_0x1bca3d(_0x52bf5f);}function _0x3ccb5b(){_0x1bca3d();}function _0x548d4f(_0x42b2ac,_0x202afb=![]){const _0x543743=_0x247bea,_0x1f1971=document[_0x543743(0x977)]('#listen-together-btn\x20img');if(!_0x1f1971)return;if(_0x202afb||!_0x5ebb31[_0x543743(0x1f3)]||_0x5ebb31[_0x543743(0x7bc)]!==_0x42b2ac){_0x1f1971[_0x543743(0x87b)]=_0x543743(0xcd9),_0x1f1971['className']='';return;}_0x1f1971[_0x543743(0x87b)]=_0x543743(0xb85),_0x1f1971[_0x543743(0x10d3)]['add'](_0x543743(0xe74));if(_0x5ebb31[_0x543743(0xa4e)])_0x1f1971[_0x543743(0x10d3)][_0x543743(0x2c7)](_0x543743(0x10b0));else _0x1f1971[_0x543743(0x10d3)][_0x543743(0xb9)](_0x543743(0x10b0));}window[_0x247bea(0xe62)]=_0x548d4f;function _0x246e79(){const _0x5df31c=_0x247bea;_0x548d4f(_0x5ebb31[_0x5df31c(0x7bc)]),_0x2637b9();const _0x5ee3a9=document['getElementById']('music-player-song-title'),_0x125074=document[_0x5df31c(0xc33)](_0x5df31c(0x1ad)),_0x536579=document['getElementById'](_0x5df31c(0x1fb));if(_0x5ebb31[_0x5df31c(0x12a0)]>-0x1&&_0x5ebb31['playlist']['length']>0x0){const _0x544e02=_0x5ebb31[_0x5df31c(0xd9f)][_0x5ebb31[_0x5df31c(0x12a0)]];_0x5ee3a9[_0x5df31c(0x11b0)]=_0x544e02[_0x5df31c(0x578)],_0x125074[_0x5df31c(0x11b0)]=_0x544e02['artist'];}else _0x5ee3a9[_0x5df31c(0x11b0)]='请添加歌曲',_0x125074[_0x5df31c(0x11b0)]=_0x5df31c(0xda0);_0x536579[_0x5df31c(0x11b0)]=_0x5ebb31[_0x5df31c(0xa4e)]?'❚❚':'▶';}function _0x2637b9(){const _0x34e82c=_0x247bea,_0x5b8864=(_0x5ebb31[_0x34e82c(0xec9)]/0xe10)[_0x34e82c(0xcab)](0x1);document[_0x34e82c(0xc33)](_0x34e82c(0xd46))['textContent']=_0x34e82c(0xe41)+_0x5b8864+'小时';}function _0x596fed(){const _0x10bc7d=_0x247bea,_0x12142f=document[_0x10bc7d(0xc33)]('playlist-body');_0x12142f[_0x10bc7d(0x102a)]='';if(_0x5ebb31['playlist'][_0x10bc7d(0x79b)]===0x0){_0x12142f[_0x10bc7d(0x102a)]=_0x10bc7d(0x2dd);return;}_0x5ebb31[_0x10bc7d(0xd9f)][_0x10bc7d(0xd6a)]((_0x1390ba,_0x4c2a3d)=>{const _0xd9b458=_0x10bc7d,_0x381961=document[_0xd9b458(0x1292)](_0xd9b458(0x58c));_0x381961[_0xd9b458(0x84)]=_0xd9b458(0x1247);if(_0x4c2a3d===_0x5ebb31[_0xd9b458(0x12a0)])_0x381961[_0xd9b458(0x10d3)][_0xd9b458(0xb9)]('playing');_0x381961[_0xd9b458(0x102a)]='\x0a\x20\x20\x20\x20<div\x20class=\x22playlist-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>'+_0x1390ba['name']+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>'+_0x1390ba[_0xd9b458(0x200)]+_0xd9b458(0x1023)+_0x4c2a3d+_0xd9b458(0x95)+_0x4c2a3d+_0xd9b458(0x10e9)+_0x4c2a3d+_0xd9b458(0x1089)+_0x4c2a3d+_0xd9b458(0xc97),_0x381961[_0xd9b458(0x977)](_0xd9b458(0xe5c))[_0xd9b458(0x205)](_0xd9b458(0x335),()=>_0x21a08a(_0x4c2a3d)),_0x12142f[_0xd9b458(0xf77)](_0x381961);});}async function _0x1c34cf(){const _0x5f3eaa=_0x247bea;if(_0x3ced3a[_0x5f3eaa(0x10b0)]){if(_0x5ebb31[_0x5f3eaa(0x12a0)]===-0x1&&_0x5ebb31[_0x5f3eaa(0xd9f)][_0x5f3eaa(0x79b)]>0x0)_0x21a08a(0x0);else _0x5ebb31['currentIndex']>-0x1&&_0x21a08a(_0x5ebb31['currentIndex']);}else _0x3ced3a[_0x5f3eaa(0x47a)](),await _0x2b9cc6(_0x5f3eaa(0xa58));}function _0x942215(){const _0xab7dab=_0x247bea;if(_0x5ebb31['playlist']['length']===0x0)return;let _0x737824;switch(_0x5ebb31[_0xab7dab(0x6f8)]){case'random':_0x737824=Math[_0xab7dab(0xcb5)](Math[_0xab7dab(0xa11)]()*_0x5ebb31[_0xab7dab(0xd9f)][_0xab7dab(0x79b)]);break;case _0xab7dab(0xde):_0x21a08a(_0x5ebb31[_0xab7dab(0x12a0)]);return;case _0xab7dab(0x7e9):default:_0x737824=(_0x5ebb31[_0xab7dab(0x12a0)]+0x1)%_0x5ebb31[_0xab7dab(0xd9f)][_0xab7dab(0x79b)];break;}_0x21a08a(_0x737824);}function _0x427546(){const _0x4b3e8c=_0x247bea;if(_0x5ebb31[_0x4b3e8c(0xd9f)][_0x4b3e8c(0x79b)]===0x0)return;const _0x280ad2=(_0x5ebb31[_0x4b3e8c(0x12a0)]-0x1+_0x5ebb31[_0x4b3e8c(0xd9f)][_0x4b3e8c(0x79b)])%_0x5ebb31[_0x4b3e8c(0xd9f)][_0x4b3e8c(0x79b)];_0x21a08a(_0x280ad2);}function _0x4b96b2(){const _0x5572b3=_0x247bea,_0x275a4c=[_0x5572b3(0x7e9),'random',_0x5572b3(0xde)],_0x42ba58=_0x275a4c['indexOf'](_0x5ebb31[_0x5572b3(0x6f8)]);_0x5ebb31['playMode']=_0x275a4c[(_0x42ba58+0x1)%_0x275a4c[_0x5572b3(0x79b)]],document[_0x5572b3(0xc33)](_0x5572b3(0xdaf))[_0x5572b3(0x11b0)]={'order':'顺序','random':'随机','single':'单曲'}[_0x5ebb31[_0x5572b3(0x6f8)]];}async function _0xb7103e(){const _0x2fa379=_0x247bea,_0x15dea9=await _0x1ca09c('添加网络歌曲',_0x2fa379(0x296),'',_0x2fa379(0x11a));if(!_0x15dea9)return;const _0xcb97cd=await _0x1ca09c(_0x2fa379(0x5dd),'请输入歌名');if(!_0xcb97cd)return;const _0x399970=await _0x1ca09c(_0x2fa379(0x5dd),_0x2fa379(0xa02));if(!_0x399970)return;_0x5ebb31[_0x2fa379(0xd9f)][_0x2fa379(0x2d6)]({'name':_0xcb97cd,'artist':_0x399970,'src':_0x15dea9,'isLocal':![]}),await _0x83d626(),_0x596fed(),_0x5ebb31['currentIndex']===-0x1&&(_0x5ebb31[_0x2fa379(0x12a0)]=_0x5ebb31['playlist'][_0x2fa379(0x79b)]-0x1,_0x246e79());}async function _0xc3ddfc(_0x13bce7){const _0x243f71=_0x247bea,_0x23e0bb=_0x13bce7[_0x243f71(0xe16)]['files'];if(!_0x23e0bb[_0x243f71(0x79b)])return;for(const _0x81583a of _0x23e0bb){let _0x4fc780=_0x81583a[_0x243f71(0x578)]['replace'](/\.[^/.]+$/,'');_0x4fc780=await _0x1ca09c(_0x243f71(0x5dd),_0x243f71(0xb48),_0x4fc780);if(_0x4fc780===null)continue;const _0x3faf18=await _0x1ca09c(_0x243f71(0x5dd),_0x243f71(0xa02),_0x243f71(0xee1));if(_0x3faf18===null)continue;const _0x360c80=await _0x81583a[_0x243f71(0xf5e)]();let _0x3a65de='';const _0x41b7a3=await _0x270512(_0x243f71(0x11cb),_0x243f71(0x86c)+_0x4fc780+'》添加歌词吗？');_0x41b7a3&&(_0x3a65de=await _0x2cb3c4()||''),_0x5ebb31[_0x243f71(0xd9f)][_0x243f71(0x2d6)]({'name':_0x4fc780,'artist':_0x3faf18,'src':_0x360c80,'fileType':_0x81583a['type'],'isLocal':!![],'lrcContent':_0x3a65de,'cover':_0x243f71(0x35f)});}await _0x83d626(),_0x596fed(),_0x5ebb31[_0x243f71(0x12a0)]===-0x1&&_0x5ebb31[_0x243f71(0xd9f)][_0x243f71(0x79b)]>0x0&&(_0x5ebb31[_0x243f71(0x12a0)]=0x0,_0x246e79()),_0x13bce7['target'][_0x243f71(0x22a)]=null;}async function _0x21a08a(_0x461a40){const _0x43118e=_0x247bea;if(_0x461a40<0x0||_0x461a40>=_0x5ebb31[_0x43118e(0xd9f)]['length'])return;_0x3ced3a[_0x43118e(0x47a)](),_0x5ebb31[_0x43118e(0x12a0)]=_0x461a40;const _0x77e6e9=_0x5ebb31[_0x43118e(0xd9f)][_0x461a40],_0x17131e=_0x12493e[_0x43118e(0xc45)][_0x5ebb31[_0x43118e(0x7bc)]],_0x120c20=document[_0x43118e(0xc33)](_0x43118e(0xcd6));if(_0x17131e&&_0x120c20){_0x120c20[_0x43118e(0x102a)]='';const _0x481086=_0x17131e[_0x43118e(0x80b)]?_0x17131e[_0x43118e(0xd5b)][_0x43118e(0xd85)](_0xdada78=>_0xdada78[_0x43118e(0x776)]===_0x77e6e9[_0x43118e(0x200)])?.['avatar']||_0x190acc:_0x17131e[_0x43118e(0x2ea)][_0x43118e(0x18e)]||_0x190acc,_0x57561c=_0x17131e['settings']['myAvatar']||_0x190acc,_0x23d187=document[_0x43118e(0x1292)](_0x43118e(0x605));_0x23d187[_0x43118e(0x87b)]=_0x481086,_0x23d187[_0x43118e(0x84)]=_0x43118e(0xf4c),_0x23d187[_0x43118e(0x96)]='Character\x20Avatar',_0x120c20[_0x43118e(0xf77)](_0x23d187);const _0x558be6=document[_0x43118e(0x1292)](_0x43118e(0x605));_0x558be6['src']=_0x57561c,_0x558be6[_0x43118e(0x84)]=_0x43118e(0xf4c),_0x558be6[_0x43118e(0x96)]=_0x43118e(0x118f),_0x120c20[_0x43118e(0xf77)](_0x558be6);}const _0x3ed5f7=document[_0x43118e(0x977)](_0x43118e(0x6a4)),_0x356819=document[_0x43118e(0xc33)](_0x43118e(0xe22));_0x3ed5f7&&(_0x3ed5f7[_0x43118e(0x105d)][_0x43118e(0x7f3)](_0x43118e(0x1003),_0x77e6e9[_0x43118e(0xc88)]?_0x43118e(0xb23)+_0x77e6e9[_0x43118e(0xc88)]+')':_0x43118e(0x854)),_0x3ed5f7['classList']['toggle'](_0x43118e(0x8c2),!!_0x77e6e9['isBgClear']));_0x356819&&_0x356819[_0x43118e(0x10d3)][_0x43118e(0xe2c)]('active',!!_0x77e6e9['isBgClear']);document[_0x43118e(0xc33)](_0x43118e(0xe29))[_0x43118e(0x10d3)][_0x43118e(0x2c7)](_0x43118e(0x1aa));const _0x19f3fd=document[_0x43118e(0xc33)]('music-player-cover');_0x19f3fd&&(_0x19f3fd[_0x43118e(0x87b)]=_0x77e6e9[_0x43118e(0xd87)]||_0x43118e(0x35f));await _0x2b9cc6('将歌曲切换为了《'+_0x77e6e9[_0x43118e(0x578)]+'》'),_0x5ebb31[_0x43118e(0x1ca)]=_0x35419b(_0x77e6e9['lrcContent']||''),_0x409a99();const _0x53e112=document[_0x43118e(0xc33)](_0x43118e(0x4d1));_0x53e112&&(!_0x5ebb31[_0x43118e(0x1ca)]||_0x5ebb31['parsedLyrics'][_0x43118e(0x79b)]===0x0?_0x53e112[_0x43118e(0x11b0)]='纯音乐，请欣赏':_0x53e112[_0x43118e(0x11b0)]='♪\x20♪\x20♪');if(_0x77e6e9['isLocal']&&_0x77e6e9[_0x43118e(0x87b)]instanceof ArrayBuffer){const _0x5d77d5=new Blob([_0x77e6e9[_0x43118e(0x87b)]],{'type':_0x77e6e9[_0x43118e(0x324)]||_0x43118e(0xb0b)});_0x3ced3a[_0x43118e(0x87b)]=URL['createObjectURL'](_0x5d77d5);}else{if(_0x77e6e9['isLocal']&&_0x77e6e9[_0x43118e(0x87b)]instanceof Blob)_0x3ced3a[_0x43118e(0x87b)]=URL[_0x43118e(0xca2)](_0x77e6e9[_0x43118e(0x87b)]);else{if(!_0x77e6e9[_0x43118e(0x616)])_0x3ced3a[_0x43118e(0x87b)]=_0x77e6e9[_0x43118e(0x87b)];else{console[_0x43118e(0x4d9)](_0x43118e(0x812),_0x77e6e9);return;}}}const _0x3fde3c=_0x3ced3a[_0x43118e(0x193)]();_0x3fde3c!==undefined&&_0x3fde3c['catch'](_0x5ee660=>{const _0xac238e=_0x43118e;if(_0x5ee660['name']===_0xac238e(0xda))console[_0xac238e(0x54a)]('Autoplay\x20was\x20prevented\x20by\x20the\x20browser.'),_0x3ced3a['pause'](),_0x2d7ddd(_0xac238e(0x5a4),_0xac238e(0x1072));else _0x5ee660[_0xac238e(0x578)]!==_0xac238e(0xc0b)&&console['error'](_0xac238e(0xbfe),_0x5ee660);});_0x596fed(),_0x246e79(),_0x438baf();const _0xe85926=document['getElementById'](_0x43118e(0x65b));_0x5ebb31['parsedLyrics']&&_0x5ebb31['parsedLyrics']['length']>0x0?(_0xe85926['textContent']='♪',_0xe85926[_0x43118e(0x10d3)][_0x43118e(0xb9)](_0x43118e(0x143))):_0xe85926[_0x43118e(0x10d3)]['remove']('visible');}async function _0x495942(_0xdcf039){const _0x361a87=_0x247bea;if(_0xdcf039<0x0||_0xdcf039>=_0x5ebb31['playlist'][_0x361a87(0x79b)])return;const _0x210a79=await _0x46f58a(_0x361a87(0x6ad),[{'text':_0x361a87(0x67d),'value':_0x361a87(0xc06)},{'text':_0x361a87(0x10ac),'value':_0x361a87(0x11a)}]);let _0xbb004f=null;if(_0x210a79===_0x361a87(0xc06))_0xbb004f=await _0x4cf6c8();else _0x210a79===_0x361a87(0x11a)&&(_0xbb004f=await _0x1ca09c(_0x361a87(0xf9),_0x361a87(0x222),'',_0x361a87(0x11a)));if(_0xbb004f&&_0xbb004f[_0x361a87(0x7da)]()){_0x5ebb31['playlist'][_0xdcf039][_0x361a87(0xc88)]=_0xbb004f[_0x361a87(0x7da)](),await _0x83d626();if(_0x5ebb31[_0x361a87(0x12a0)]===_0xdcf039){const _0x2ee837=document[_0x361a87(0x977)](_0x361a87(0x6a4));_0x2ee837[_0x361a87(0x105d)][_0x361a87(0x7f3)](_0x361a87(0x1003),_0x361a87(0xb23)+_0xbb004f[_0x361a87(0x7da)]()+')');}await _0x2d7ddd('成功','歌曲背景已更新！');}}async function _0x101a2c(_0x4fcfb5){const _0x6d90e9=_0x247bea;if(_0x4fcfb5<0x0||_0x4fcfb5>=_0x5ebb31[_0x6d90e9(0xd9f)]['length'])return;const _0x323371=await _0x46f58a(_0x6d90e9(0x916),[{'text':'📁\x20从本地上传','value':'local'},{'text':'🌐\x20使用网络URL','value':'url'}]);let _0x14826d=null;if(_0x323371===_0x6d90e9(0xc06))_0x14826d=await _0x4cf6c8();else _0x323371==='url'&&(_0x14826d=await _0x1ca09c(_0x6d90e9(0xf9),'请输入新的封面图片链接','','url'));if(_0x14826d&&_0x14826d[_0x6d90e9(0x7da)]()){_0x5ebb31['playlist'][_0x4fcfb5]['cover']=_0x14826d[_0x6d90e9(0x7da)](),await _0x83d626();if(_0x5ebb31['currentIndex']===_0x4fcfb5){document[_0x6d90e9(0xc33)](_0x6d90e9(0x55d))[_0x6d90e9(0x87b)]=_0x14826d[_0x6d90e9(0x7da)]();const _0x8a342d=document['querySelector']('#vinyl-view\x20#music-player-cover');if(_0x8a342d)_0x8a342d[_0x6d90e9(0x87b)]=_0x14826d[_0x6d90e9(0x7da)]();}await _0x2d7ddd('成功',_0x6d90e9(0x6c4));}}async function _0x1c2d08(_0x275310){const _0xe8616f=_0x247bea;if(_0x275310<0x0||_0x275310>=_0x5ebb31[_0xe8616f(0xd9f)][_0xe8616f(0x79b)])return;const _0x255a7b=_0x5ebb31[_0xe8616f(0xd9f)][_0x275310],_0x26965f=_0x5ebb31['isPlaying']&&_0x5ebb31[_0xe8616f(0x12a0)]===_0x275310;if(_0x255a7b[_0xe8616f(0x616)]&&_0x3ced3a['src']['startsWith'](_0xe8616f(0x895))&&_0x5ebb31['currentIndex']===_0x275310)URL[_0xe8616f(0x1202)](_0x3ced3a['src']);_0x5ebb31['playlist'][_0xe8616f(0xbd1)](_0x275310,0x1),await _0x83d626();if(_0x5ebb31['playlist'][_0xe8616f(0x79b)]===0x0){if(_0x5ebb31[_0xe8616f(0xa4e)])_0x3ced3a[_0xe8616f(0x47a)]();_0x3ced3a[_0xe8616f(0x87b)]='',_0x5ebb31[_0xe8616f(0x12a0)]=-0x1,_0x5ebb31[_0xe8616f(0xa4e)]=![];}else{if(_0x26965f)_0x942215();else{if(_0x5ebb31[_0xe8616f(0x12a0)]>=_0x275310)_0x5ebb31['currentIndex']=Math['max'](0x0,_0x5ebb31[_0xe8616f(0x12a0)]-0x1);}}_0x246e79(),_0x596fed();}async function _0xc3ddfc(_0x49acb3){const _0x434d72=_0x247bea,_0x14aaeb=_0x49acb3['target'][_0x434d72(0x1d0)];if(!_0x14aaeb[_0x434d72(0x79b)])return;for(const _0x112b17 of _0x14aaeb){let _0x575ed3=_0x112b17[_0x434d72(0x578)][_0x434d72(0xc12)](/\.[^/.]+$/,'');_0x575ed3=await _0x1ca09c(_0x434d72(0x5dd),_0x434d72(0xb48),_0x575ed3);if(_0x575ed3===null)continue;const _0xd3c4c4=await _0x1ca09c('歌曲信息','请输入歌手名',_0x434d72(0xee1));if(_0xd3c4c4===null)continue;let _0x4707ff='';const _0x437f90=await _0x270512(_0x434d72(0x11cb),_0x434d72(0x86c)+_0x575ed3+_0x434d72(0x37d));_0x437f90&&(_0x4707ff=await _0x2cb3c4()||''),_0x5ebb31['playlist'][_0x434d72(0x2d6)]({'name':_0x575ed3,'artist':_0xd3c4c4,'src':_0x112b17,'isLocal':!![],'lrcContent':_0x4707ff});}await _0x83d626(),_0x596fed(),_0x5ebb31['currentIndex']===-0x1&&_0x5ebb31[_0x434d72(0xd9f)]['length']>0x0&&(_0x5ebb31['currentIndex']=0x0,_0x246e79()),_0x49acb3[_0x434d72(0xe16)][_0x434d72(0x22a)]=null;}async function _0x1c2d08(_0x4fff19){const _0x3c5717=_0x247bea;if(_0x4fff19<0x0||_0x4fff19>=_0x5ebb31[_0x3c5717(0xd9f)][_0x3c5717(0x79b)])return;const _0xe8c53a=_0x5ebb31[_0x3c5717(0xd9f)][_0x4fff19],_0x2953c7=_0x5ebb31['isPlaying']&&_0x5ebb31[_0x3c5717(0x12a0)]===_0x4fff19;if(_0xe8c53a['isLocal']&&_0x3ced3a[_0x3c5717(0x87b)][_0x3c5717(0xece)](_0x3c5717(0x895))&&_0x5ebb31[_0x3c5717(0x12a0)]===_0x4fff19)URL[_0x3c5717(0x1202)](_0x3ced3a['src']);_0x5ebb31[_0x3c5717(0xd9f)][_0x3c5717(0xbd1)](_0x4fff19,0x1),await _0x83d626();if(_0x5ebb31[_0x3c5717(0xd9f)][_0x3c5717(0x79b)]===0x0){if(_0x5ebb31['isPlaying'])_0x3ced3a[_0x3c5717(0x47a)]();_0x3ced3a['src']='',_0x5ebb31[_0x3c5717(0x12a0)]=-0x1,_0x5ebb31[_0x3c5717(0xa4e)]=![];}else{if(_0x2953c7)_0x942215();else{if(_0x5ebb31[_0x3c5717(0x12a0)]>=_0x4fff19)_0x5ebb31[_0x3c5717(0x12a0)]=Math[_0x3c5717(0xbf8)](0x0,_0x5ebb31['currentIndex']-0x1);}}_0x246e79(),_0x596fed();}const _0x3eae4c=document[_0x247bea(0xc33)]('persona-library-modal'),_0x5b0d92=document[_0x247bea(0xc33)](_0x247bea(0xacb)),_0x19c95a=document['getElementById']('preset-actions-modal');function _0x413e38(){const _0x7a1b17=_0x247bea;_0x5e2657(),_0x3eae4c['classList'][_0x7a1b17(0xb9)](_0x7a1b17(0x143));}function _0x3521c2(){const _0x1cff02=_0x247bea;_0x3eae4c['classList']['remove'](_0x1cff02(0x143));}function _0x5e2657(){const _0xc6076=_0x247bea,_0x37c4e3=document[_0xc6076(0xc33)](_0xc6076(0x6c8));_0x37c4e3['innerHTML']='';if(_0x12493e['personaPresets'][_0xc6076(0x79b)]===0x0){_0x37c4e3[_0xc6076(0x102a)]=_0xc6076(0x1ea);return;}_0x12493e['personaPresets'][_0xc6076(0xd6a)](_0x5d630d=>{const _0x28f0ba=_0xc6076,_0x4a46eb=document['createElement']('div');_0x4a46eb['className']='persona-preset-item',_0x4a46eb[_0x28f0ba(0x105d)][_0x28f0ba(0x4b5)]='url('+_0x5d630d['avatar']+')',_0x4a46eb['dataset'][_0x28f0ba(0x978)]=_0x5d630d['id'],_0x4a46eb[_0x28f0ba(0x205)](_0x28f0ba(0x335),()=>_0x14afa6(_0x5d630d['id'])),_0x29b870(_0x4a46eb,()=>_0x1b5030(_0x5d630d['id'])),_0x37c4e3['appendChild'](_0x4a46eb);});}function _0x1b5030(_0x4cf5d9){const _0x230742=_0x247bea;_0x47ad88=_0x4cf5d9,_0x19c95a[_0x230742(0x10d3)]['add'](_0x230742(0x143));}function _0x407c2a(){const _0x4d8fa3=_0x247bea;_0x19c95a[_0x4d8fa3(0x10d3)]['remove'](_0x4d8fa3(0x143)),_0x47ad88=null;}function _0x14afa6(_0x52f5ea){const _0x4ca649=_0x247bea,_0xb2a8c=_0x12493e[_0x4ca649(0x25e)][_0x4ca649(0xd85)](_0x591a1c=>_0x591a1c['id']===_0x52f5ea);_0xb2a8c&&(document[_0x4ca649(0xc33)](_0x4ca649(0xaa8))[_0x4ca649(0x87b)]=_0xb2a8c[_0x4ca649(0xbac)],document[_0x4ca649(0xc33)](_0x4ca649(0xeac))[_0x4ca649(0x22a)]=_0xb2a8c[_0x4ca649(0x421)]),_0x3521c2();}function _0x37ecd9(){const _0x59b629=_0x247bea;_0x47ad88=null,document[_0x59b629(0xc33)]('persona-editor-title')['textContent']='添加人设预设',document[_0x59b629(0xc33)](_0x59b629(0x542))['src']=_0x190acc,document[_0x59b629(0xc33)](_0x59b629(0x11ae))[_0x59b629(0x22a)]='',_0x5b0d92['classList'][_0x59b629(0xb9)](_0x59b629(0x143));}function _0x557cdd(){const _0x3e36c5=_0x247bea,_0x23ec18=_0x12493e['personaPresets'][_0x3e36c5(0xd85)](_0x23a55e=>_0x23a55e['id']===_0x47ad88);if(!_0x23ec18)return;document[_0x3e36c5(0xc33)]('persona-editor-title')[_0x3e36c5(0x11b0)]=_0x3e36c5(0x1249),document[_0x3e36c5(0xc33)](_0x3e36c5(0x542))[_0x3e36c5(0x87b)]=_0x23ec18['avatar'],document[_0x3e36c5(0xc33)](_0x3e36c5(0x11ae))[_0x3e36c5(0x22a)]=_0x23ec18[_0x3e36c5(0x421)],_0x19c95a[_0x3e36c5(0x10d3)][_0x3e36c5(0x2c7)](_0x3e36c5(0x143)),_0x5b0d92[_0x3e36c5(0x10d3)][_0x3e36c5(0xb9)](_0x3e36c5(0x143));}async function _0xf85757(){const _0x5e672c=_0x247bea,_0x5f57e8=await _0x270512(_0x5e672c(0x5a0),'确定要删除这个人设预设吗？此操作不可恢复。',{'confirmButtonClass':_0x5e672c(0xa2)});_0x5f57e8&&_0x47ad88&&(await _0x2a2987['personaPresets'][_0x5e672c(0x9ea)](_0x47ad88),_0x12493e[_0x5e672c(0x25e)]=_0x12493e[_0x5e672c(0x25e)][_0x5e672c(0x1054)](_0x4092af=>_0x4092af['id']!==_0x47ad88),_0x407c2a(),_0x5e2657());}function _0x40a9a5(){const _0x42f5=_0x247bea;_0x5b0d92[_0x42f5(0x10d3)][_0x42f5(0x2c7)](_0x42f5(0x143)),_0x47ad88=null;}async function _0x389127(){const _0x2dd122=_0x247bea,_0x2825c7=document[_0x2dd122(0xc33)](_0x2dd122(0x542))[_0x2dd122(0x87b)],_0x505257=document[_0x2dd122(0xc33)](_0x2dd122(0x11ae))[_0x2dd122(0x22a)]['trim']();if(_0x2825c7===_0x190acc&&!_0x505257){alert(_0x2dd122(0x138));return;}if(_0x47ad88){const _0x24904d=_0x12493e['personaPresets']['find'](_0x349fc8=>_0x349fc8['id']===_0x47ad88);_0x24904d&&(_0x24904d[_0x2dd122(0xbac)]=_0x2825c7,_0x24904d['persona']=_0x505257,await _0x2a2987[_0x2dd122(0x25e)][_0x2dd122(0xf36)](_0x24904d));}else{const _0x3fa646={'id':_0x2dd122(0xc80)+Date[_0x2dd122(0x6ee)](),'avatar':_0x2825c7,'persona':_0x505257};await _0x2a2987['personaPresets'][_0x2dd122(0xb9)](_0x3fa646),_0x12493e[_0x2dd122(0x25e)][_0x2dd122(0x2d6)](_0x3fa646);}_0x5e2657(),_0x40a9a5();}const _0x1ba718=document[_0x247bea(0xc33)](_0x247bea(0x809));function _0x449279(_0x1ab923,_0x470e59){const _0x45ee54=_0x247bea;clearTimeout(_0x13ce16),document['getElementById'](_0x45ee54(0x8e4))[_0x45ee54(0x87b)]=_0x1ab923,document['getElementById'](_0x45ee54(0x992))[_0x45ee54(0x11b0)]=_0x470e59,_0x1ba718[_0x45ee54(0x10d3)][_0x45ee54(0xb9)](_0x45ee54(0x143));const _0xf25ed6=()=>{const _0x5a02e5=_0x45ee54;_0x1ba718[_0x5a02e5(0x10d3)]['remove']('visible'),_0x1ba718['removeEventListener']('click',_0xf25ed6);};_0x1ba718['addEventListener'](_0x45ee54(0x335),_0xf25ed6),_0x13ce16=setTimeout(_0xf25ed6,0x7d0);}function _0x4b3e6a(_0x4e70fa){const _0x7478ee=_0x247bea,_0x4c2d50=document['getElementById'](_0x7478ee(0x1027)),_0xdf4701=_0x4c2d50[_0x7478ee(0x977)](_0x7478ee(0x5a8)),_0x4a7d77=_0x4c2d50[_0x7478ee(0x977)](_0x7478ee(0x8de)),_0x37453e=Math['floor'](_0x4e70fa[_0x7478ee(0x763)]*0x64);_0xdf4701[_0x7478ee(0x105d)]['width']=_0x37453e+'%',_0x4a7d77[_0x7478ee(0x11b0)]=_0x37453e+'%',_0x4e70fa[_0x7478ee(0xde9)]?_0x4c2d50[_0x7478ee(0x10d3)][_0x7478ee(0xb9)]('charging'):_0x4c2d50['classList'][_0x7478ee(0x2c7)](_0x7478ee(0xde9));}function _0x559ab6(_0x18d006){const _0x590988=_0x247bea;_0x4b3e6a(_0x18d006);const _0x576255=_0x18d006[_0x590988(0x763)];!_0x18d006[_0x590988(0xde9)]&&(_0x576255<=0.4&&_0x45bda8>0.4&&!_0x74ffd4[_0x590988(0x8bd)]&&(_0x449279(_0x590988(0x7db),_0x590988(0xcb1)),_0x74ffd4[_0x590988(0x8bd)]=!![]),_0x576255<=0.2&&_0x45bda8>0.2&&!_0x74ffd4[_0x590988(0xbd2)]&&(_0x449279(_0x590988(0x773),_0x590988(0xeb3)),_0x74ffd4[_0x590988(0xbd2)]=!![]),_0x576255<=0.1&&_0x45bda8>0.1&&!_0x74ffd4[_0x590988(0x78b)]&&(_0x449279(_0x590988(0x651),_0x590988(0x501)),_0x74ffd4['hasShown10']=!![]));if(_0x576255>0.4)_0x74ffd4['hasShown40']=![];if(_0x576255>0.2)_0x74ffd4[_0x590988(0xbd2)]=![];if(_0x576255>0.1)_0x74ffd4[_0x590988(0x78b)]=![];_0x45bda8=_0x576255;}async function _0x16357a(){const _0x558058=_0x247bea;if('getBattery'in navigator)try{const _0x397f4d=await navigator[_0x558058(0xc1f)]();_0x45bda8=_0x397f4d[_0x558058(0x763)],_0x559ab6(_0x397f4d),_0x397f4d[_0x558058(0x205)]('levelchange',()=>_0x559ab6(_0x397f4d)),_0x397f4d[_0x558058(0x205)]('chargingchange',()=>{const _0x23d537=_0x558058;_0x559ab6(_0x397f4d),_0x397f4d[_0x23d537(0xde9)]&&_0x449279('https://i.postimg.cc/3NDQ0dWG/image.jpg','窝爱泥，电量吃饱饱');});}catch(_0x183b31){console[_0x558058(0x4d9)]('无法获取电池信息:',_0x183b31),document[_0x558058(0x977)](_0x558058(0x8de))['textContent']='ᗜωᗜ';}else console[_0x558058(0x51f)]('浏览器不支持电池状态API。'),document[_0x558058(0x977)]('.battery-text')['textContent']=_0x558058(0xc74);}async function _0x383ac2(){const _0x252c97=_0x247bea,_0x322f8a=document['getElementById'](_0x252c97(0x9e0));if(!_0x322f8a)return;const _0x336f96=await _0x2a2987['qzoneAlbums'][_0x252c97(0xde3)](_0x252c97(0x8ba))[_0x252c97(0xc07)]()['toArray']();_0x322f8a[_0x252c97(0x102a)]='';if(_0x336f96[_0x252c97(0x79b)]===0x0){_0x322f8a[_0x252c97(0x102a)]='<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>你还没有创建任何相册哦~</p>';return;}_0x336f96[_0x252c97(0xd6a)](_0x57fbd5=>{const _0x46c738=_0x252c97,_0x2dae40=document[_0x46c738(0x1292)]('div');_0x2dae40[_0x46c738(0x84)]=_0x46c738(0x492),_0x2dae40[_0x46c738(0x102a)]=_0x46c738(0x1124)+_0x57fbd5['coverUrl']+');\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22album-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22album-name\x22>'+_0x57fbd5[_0x46c738(0x578)]+_0x46c738(0x1216)+(_0x57fbd5[_0x46c738(0x21f)]||0x0)+_0x46c738(0xca8),_0x2dae40[_0x46c738(0x205)]('click',()=>{_0x4092e2(_0x57fbd5['id']);}),_0x29b870(_0x2dae40,async()=>{const _0x11e09b=_0x46c738,_0x3efdff=await _0x270512(_0x11e09b(0xcdc),_0x11e09b(0x11a9)+_0x57fbd5[_0x11e09b(0x578)]+'》吗？此操作将同时删除相册内的所有照片，且无法恢复。',{'confirmButtonClass':_0x11e09b(0xa2)});_0x3efdff&&(await _0x2a2987['qzonePhotos'][_0x11e09b(0x8b5)](_0x11e09b(0x28c))['equals'](_0x57fbd5['id'])[_0x11e09b(0x9ea)](),await _0x2a2987[_0x11e09b(0xe7b)][_0x11e09b(0x9ea)](_0x57fbd5['id']),await _0x383ac2(),alert('相册已成功删除。'));}),_0x322f8a[_0x46c738(0xf77)](_0x2dae40);});}async function _0x4092e2(_0x44bcb6){const _0x570c6a=_0x247bea;_0x12493e[_0x570c6a(0xa35)]=_0x44bcb6,await _0x5e7651(),_0x38f00f('album-photos-screen');}async function _0x5e7651(){const _0x624e77=_0x247bea;if(!_0x12493e[_0x624e77(0xa35)])return;const _0x562aee=document[_0x624e77(0xc33)](_0x624e77(0x31e)),_0x10fb17=document['getElementById']('album-photos-title'),_0x33e1fa=await _0x2a2987[_0x624e77(0xe7b)][_0x624e77(0xec0)](_0x12493e[_0x624e77(0xa35)]);if(!_0x33e1fa){console[_0x624e77(0x4d9)](_0x624e77(0xadd),_0x12493e[_0x624e77(0xa35)]),_0x38f00f(_0x624e77(0x1d8));return;}_0x10fb17['textContent']=_0x33e1fa[_0x624e77(0x578)];const _0xb03e4=await _0x2a2987[_0x624e77(0xd37)][_0x624e77(0x8b5)]('albumId')['equals'](_0x12493e['activeAlbumId'])['toArray']();_0x562aee[_0x624e77(0x102a)]='',_0xb03e4['length']===0x0?_0x562aee['innerHTML']='<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>这个相册还是空的，快上传第一张照片吧！</p>':_0xb03e4[_0x624e77(0xd6a)](_0x149ede=>{const _0x2dc2e2=_0x624e77,_0x2b16d1=document[_0x2dc2e2(0x1292)]('div');_0x2b16d1[_0x2dc2e2(0x84)]=_0x2dc2e2(0xc08),_0x2b16d1[_0x2dc2e2(0x102a)]=_0x2dc2e2(0x7cb)+_0x149ede[_0x2dc2e2(0x11a)]+_0x2dc2e2(0x117e)+_0x149ede['id']+_0x2dc2e2(0xfa1),_0x562aee[_0x2dc2e2(0xf77)](_0x2b16d1);});}async function _0x4e9a82(_0x16fbea){const _0x564f17=_0x247bea;if(!_0x12493e[_0x564f17(0xa35)])return;const _0x5e066b=await _0x2a2987['qzonePhotos'][_0x564f17(0x8b5)](_0x564f17(0x28c))[_0x564f17(0x10bd)](_0x12493e[_0x564f17(0xa35)])['toArray']();_0x2af0fc[_0x564f17(0x716)]=_0x5e066b[_0x564f17(0x9d5)](_0x4e8692=>_0x4e8692[_0x564f17(0x11a)]),_0x2af0fc[_0x564f17(0x12a0)]=_0x2af0fc[_0x564f17(0x716)][_0x564f17(0xce9)](_0x39d1d5=>_0x39d1d5===_0x16fbea);if(_0x2af0fc[_0x564f17(0x12a0)]===-0x1)return;document['getElementById']('photo-viewer-modal')[_0x564f17(0x10d3)][_0x564f17(0xb9)](_0x564f17(0x143)),_0x4fc66f(),_0x2af0fc['isOpen']=!![];}function _0x4fc66f(){const _0x52752e=_0x247bea;if(_0x2af0fc[_0x52752e(0x12a0)]===-0x1)return;const _0x5c2aec=document[_0x52752e(0xc33)](_0x52752e(0x332)),_0x7cedeb=document[_0x52752e(0xc33)](_0x52752e(0x938)),_0x1bde41=document[_0x52752e(0xc33)](_0x52752e(0xbb8));_0x5c2aec['style'][_0x52752e(0x8d1)]=0x0,setTimeout(()=>{const _0x29dbcf=_0x52752e;_0x5c2aec[_0x29dbcf(0x87b)]=_0x2af0fc[_0x29dbcf(0x716)][_0x2af0fc[_0x29dbcf(0x12a0)]],_0x5c2aec[_0x29dbcf(0x105d)][_0x29dbcf(0x8d1)]=0x1;},0x64),_0x7cedeb['disabled']=_0x2af0fc[_0x52752e(0x12a0)]===0x0,_0x1bde41[_0x52752e(0xfd8)]=_0x2af0fc[_0x52752e(0x12a0)]===_0x2af0fc['photos'][_0x52752e(0x79b)]-0x1;}function _0x2152ba(){const _0x1957a4=_0x247bea;_0x2af0fc[_0x1957a4(0x12a0)]<_0x2af0fc[_0x1957a4(0x716)]['length']-0x1&&(_0x2af0fc['currentIndex']++,_0x4fc66f());}function _0x5f2a6d(){const _0x1decdc=_0x247bea;_0x2af0fc[_0x1decdc(0x12a0)]>0x0&&(_0x2af0fc[_0x1decdc(0x12a0)]--,_0x4fc66f());}function _0x26c7da(){const _0x4ba0a3=_0x247bea;document[_0x4ba0a3(0xc33)](_0x4ba0a3(0x3e9))[_0x4ba0a3(0x10d3)][_0x4ba0a3(0x2c7)](_0x4ba0a3(0x143)),_0x2af0fc[_0x4ba0a3(0x1d9)]=![],_0x2af0fc[_0x4ba0a3(0x716)]=[],_0x2af0fc['currentIndex']=-0x1,document[_0x4ba0a3(0xc33)](_0x4ba0a3(0x332))[_0x4ba0a3(0x87b)]='';}function _0x3d400b(_0x1da32f){const _0x3d0566=_0x247bea;_0x38b5ff=_0x1da32f,localStorage[_0x3d0566(0xec8)]('unreadPostsCount',_0x1da32f);const _0x242e90=document[_0x3d0566(0x977)]('.nav-item[data-view=\x22qzone-screen\x22]'),_0x351759=_0x242e90[_0x3d0566(0x977)](_0x3d0566(0xa64));let _0x26cecf=_0x242e90[_0x3d0566(0x977)](_0x3d0566(0x798));_0x1da32f>0x0?(!_0x26cecf&&(_0x26cecf=document['createElement'](_0x3d0566(0xa64)),_0x26cecf[_0x3d0566(0x84)]='unread-indicator',_0x351759[_0x3d0566(0x105d)][_0x3d0566(0x1015)]=_0x3d0566(0xfdd),_0x351759[_0x3d0566(0xf77)](_0x26cecf)),_0x26cecf[_0x3d0566(0x11b0)]=_0x1da32f>0x63?'99+':_0x1da32f,_0x26cecf['style'][_0x3d0566(0xf44)]='block'):_0x26cecf&&(_0x26cecf[_0x3d0566(0x105d)]['display']='none'),_0x1f4bf2();}function _0x53da85(){const _0x3afe83=_0x247bea;if(_0x2f136d)return;const _0x59f11a=_0x12493e[_0x3afe83(0x10f6)]['backgroundActivityInterval']||0x3c;_0x2f136d=setInterval(_0x357299,_0x59f11a*0x3e8),_0x338f9e();}function _0x5d2a03(){_0x2f136d&&(clearInterval(_0x2f136d),_0x2f136d=null),_0x375e7d();}async function _0x357299(){const _0x15e418=_0x247bea;console[_0x15e418(0x51f)](_0x15e418(0x99e));if(!_0x12493e[_0x15e418(0x10f6)][_0x15e418(0xdde)]){_0x5d2a03();return;}const _0xd14cec=Object[_0x15e418(0xd28)](_0x12493e['chats'])[_0x15e418(0x1054)](_0x5354c9=>!_0x5354c9['isGroup']);_0xd14cec[_0x15e418(0xd6a)](_0x40d9da=>{const _0x18a146=_0x15e418;if(_0x40d9da[_0x18a146(0x1cb)]?.[_0x18a146(0xbc8)]===_0x18a146(0x49e)){const _0x58c319=_0x40d9da[_0x18a146(0x1cb)][_0x18a146(0x713)];if(!_0x58c319)return;const _0x55b89d=Date['now']()-_0x58c319,_0x56435d=(_0x12493e[_0x18a146(0x10f6)][_0x18a146(0x127f)]||0x1)*0x3c*0x3c*0x3e8;_0x55b89d>_0x56435d&&(_0x40d9da[_0x18a146(0x1cb)][_0x18a146(0xbc8)]=_0x18a146(0x786),_0x4f7dbd(_0x40d9da['id']));}else{if(_0x40d9da[_0x18a146(0x1cb)]?.[_0x18a146(0xbc8)]===_0x18a146(0xe59)&&_0x40d9da['id']!==_0x12493e[_0x18a146(0x7bc)]){if(_0x40d9da['settings'][_0x18a146(0xdde)]===![]){console['log'](_0x18a146(0x5d4)+_0x40d9da[_0x18a146(0x578)]+_0x18a146(0xb2b));return;}Math[_0x18a146(0xa11)]()<0.2&&(console[_0x18a146(0x51f)](_0x18a146(0x5d4)+_0x40d9da['name']+_0x18a146(0x11ca)),_0x34a1c7(_0x40d9da['id']));}}});const _0x5025aa=Object['values'](_0x12493e[_0x15e418(0xc45)])[_0x15e418(0x1054)](_0x3ab390=>_0x3ab390[_0x15e418(0x80b)]);_0x5025aa[_0x15e418(0xd6a)](_0x44ef6a=>{const _0x3beab1=_0x15e418;if(_0x44ef6a[_0x3beab1(0x2ea)][_0x3beab1(0xdde)]===![]){console['log'](_0x3beab1(0xcc7)+_0x44ef6a[_0x3beab1(0x578)]+_0x3beab1(0x7d3));return;}_0x44ef6a['id']!==_0x12493e[_0x3beab1(0x7bc)]&&Math[_0x3beab1(0xa11)]()<0.1&&(console['log'](_0x3beab1(0xcc7)+_0x44ef6a[_0x3beab1(0x578)]+_0x3beab1(0x11ca)),_0x420617(_0x44ef6a['id']));});try{const _0xc6bb3f=await _0x2a2987['npcs'][_0x15e418(0xf15)]();if(_0xc6bb3f['length']===0x0)return;const _0x461c08=await _0x2a2987[_0x15e418(0x110b)][_0x15e418(0xde3)](_0x15e418(0x2f0))[_0x15e418(0xc07)]()[_0x15e418(0xae4)](0xa)[_0x15e418(0xf15)]();for(const _0x257407 of _0xc6bb3f){if(_0x257407['enableBackgroundActivity']===![])continue;const _0x5bcf1c=_0x257407[_0x15e418(0x663)]||0xf;if(_0x257407[_0x15e418(0x87a)]){const _0x4145f5=(Date[_0x15e418(0x6ee)]()-_0x257407[_0x15e418(0x87a)])/(0x3e8*0x3c);if(_0x4145f5<_0x5bcf1c)continue;}if(Math[_0x15e418(0xa11)]()>0.3)continue;const _0x2b9f9d=[];for(const _0x4255b9 of _0x461c08){if(_0x4255b9[_0x15e418(0xd48)]===_0x15e418(0xb90)+_0x257407['id'])continue;const _0x1f99a8=_0x4255b9[_0x15e418(0xc83)]?.[_0x15e418(0xfa7)](_0x30f57c=>_0x30f57c[_0x15e418(0x108)]===_0x257407[_0x15e418(0x578)]),_0x5662b7=_0x4255b9[_0x15e418(0xc83)]?.['slice'](-0x1)[0x0]?.[_0x15e418(0xfd9)];if(_0x5662b7===_0x257407['name'])continue;let _0x551785=![];if(_0x4255b9[_0x15e418(0xd48)]==='user'||_0x4255b9[_0x15e418(0xd48)]['startsWith']('chat_'))_0x257407[_0x15e418(0x83d)][_0x15e418(0x1d4)](_0x4255b9[_0x15e418(0xd48)])&&(_0x551785=!![]);else{if(_0x4255b9[_0x15e418(0xd48)][_0x15e418(0xece)]('npc_')){const _0x2b316e=parseInt(_0x4255b9[_0x15e418(0xd48)]['replace'](_0x15e418(0xb90),'')),_0x219ef3=await _0x2a2987[_0x15e418(0xc61)][_0x15e418(0xec0)](_0x2b316e);if(_0x219ef3&&_0x219ef3[_0x15e418(0x83d)]){const _0x3090a0=_0x257407['associatedWith'][_0x15e418(0x1054)](_0x56b1e1=>_0x219ef3[_0x15e418(0x83d)]['includes'](_0x56b1e1));_0x3090a0[_0x15e418(0x79b)]>0x0&&(_0x551785=!![]);}}}(_0x551785||_0x1f99a8)&&_0x2b9f9d[_0x15e418(0x2d6)](_0x4255b9);}if(_0x2b9f9d[_0x15e418(0x79b)]>0x0||Math['random']()<0.2){console[_0x15e418(0x51f)](_0x15e418(0x103b)+_0x257407[_0x15e418(0x578)]+_0x15e418(0x93b));const _0x445fb6=await _0x473649(_0x257407,_0x2b9f9d);if(_0x445fb6&&_0x445fb6[_0x15e418(0x79b)]>0x0){for(const _0x22b07a of _0x445fb6){if(_0x22b07a[_0x15e418(0x52a)]==='qzone_comment'){const _0xba8d40=await _0x2a2987[_0x15e418(0x110b)][_0x15e418(0xec0)](_0x22b07a['postId']);if(_0xba8d40){if(!_0xba8d40[_0x15e418(0xc83)])_0xba8d40[_0x15e418(0xc83)]=[];_0xba8d40['comments'][_0x15e418(0x2d6)]({'commenterName':_0x257407['name'],'text':_0x22b07a[_0x15e418(0x11d0)],'replyTo':_0x22b07a[_0x15e418(0x108)]||null,'timestamp':Date[_0x15e418(0x6ee)]()+Math[_0x15e418(0xa11)]()}),await _0x2a2987[_0x15e418(0x110b)]['update'](_0x22b07a['postId'],{'comments':_0xba8d40[_0x15e418(0xc83)]}),_0x3d400b(_0x38b5ff+0x1);}}else{if(_0x22b07a[_0x15e418(0x52a)]==='qzone_post'){const _0x54de0b={'type':_0x22b07a[_0x15e418(0x4bc)]||_0x15e418(0x5c4),'content':_0x22b07a[_0x15e418(0xcbd)],'timestamp':Date['now'](),'authorId':_0x15e418(0xb90)+_0x257407['id'],'authorOriginalName':_0x257407['name'],'visibleTo':_0x257407[_0x15e418(0x83d)],'likes':[],'comments':[],'isDeleted':![]};await _0x2a2987['qzonePosts'][_0x15e418(0xb9)](_0x54de0b),console[_0x15e418(0x51f)](_0x15e418(0x103b)+_0x257407[_0x15e418(0x578)]+_0x15e418(0xc75)),_0x3d400b(_0x38b5ff+0x1);}}}await _0x2a2987[_0x15e418(0xc61)]['update'](_0x257407['id'],{'lastActionTimestamp':Date[_0x15e418(0x6ee)]()}),document['getElementById'](_0x15e418(0x496))[_0x15e418(0x10d3)][_0x15e418(0x3af)](_0x15e418(0x1043))&&await _0x14f3b0();}}}}catch(_0x3803de){console[_0x15e418(0x4d9)](_0x15e418(0xfa),_0x3803de);}}async function _0x473649(_0xc075a9,_0x2d61fa){const _0x40edd5=_0x247bea,{proxyUrl:_0x511c32,apiKey:_0x4c7b5e,model:_0x24f59f}=_0x12493e[_0x40edd5(0xdd4)];if(!_0x511c32||!_0x4c7b5e||!_0x24f59f)return console[_0x40edd5(0x4d9)](_0x40edd5(0x6f4)),null;let _0x289dda=_0x40edd5(0xbdc);const _0x1af542=_0x12493e[_0x40edd5(0x76c)][_0x40edd5(0x66a)]||'我',_0x7d9b94=_0x12493e[_0x40edd5(0xc45)][Object['keys'](_0x12493e['chats'])[0x0]]?.[_0x40edd5(0x2ea)]['myPersona']||'(未设置)';_0x289dda+=_0x40edd5(0x100f)+_0x1af542+_0x40edd5(0xe6)+_0x7d9b94+'\x0a';_0xc075a9[_0x40edd5(0x83d)]&&_0xc075a9[_0x40edd5(0x83d)][_0x40edd5(0x79b)]>0x0&&_0xc075a9[_0x40edd5(0x83d)][_0x40edd5(0xd6a)](_0x3bb2e3=>{const _0x2f7523=_0x40edd5,_0x36ade6=_0x12493e[_0x2f7523(0xc45)][_0x3bb2e3];_0x36ade6&&!_0x36ade6[_0x2f7523(0x80b)]&&(_0x289dda+=_0x2f7523(0x100f)+_0x36ade6['name']+_0x2f7523(0x8c5)+_0x36ade6[_0x2f7523(0x776)]+_0x2f7523(0x1286)+_0x36ade6['settings'][_0x2f7523(0x679)]+'\x0a');});const _0x598b3e=(await Promise['all'](_0x2d61fa[_0x40edd5(0x9d5)](async _0x3f0445=>{const _0x5b8825=_0x40edd5;let _0x3c34a3='未知作者';if(_0x3f0445[_0x5b8825(0xd48)]===_0x5b8825(0x717))_0x3c34a3=_0x12493e[_0x5b8825(0x76c)][_0x5b8825(0x66a)]||'用户';else{if(_0x3f0445[_0x5b8825(0xd48)]['startsWith'](_0x5b8825(0x657)))_0x3c34a3=_0x1353b6(_0x3f0445[_0x5b8825(0x11af)]||_0x3f0445['authorId']);else{if(_0x3f0445[_0x5b8825(0xd48)][_0x5b8825(0xece)](_0x5b8825(0xb90))){const _0x231cd0=parseInt(_0x3f0445[_0x5b8825(0xd48)][_0x5b8825(0xc12)]('npc_','')),_0x725fc9=await _0x2a2987['npcs'][_0x5b8825(0xec0)](_0x231cd0);_0x725fc9&&(_0x3c34a3=_0x725fc9[_0x5b8825(0x578)]);}}}const _0xf52f=(_0x3f0445[_0x5b8825(0xc83)]||[])[_0x5b8825(0x9d5)](_0x3dcd03=>{const _0x54d40=_0x5b8825;if(typeof _0x3dcd03===_0x54d40(0xe37)&&_0x3dcd03[_0x54d40(0xfd9)]){const _0x538981=_0x1353b6(_0x3dcd03[_0x54d40(0xfd9)]);return _0x54d40(0x100f)+_0x538981+_0x54d40(0xe55)+_0x3dcd03['text'];}return'-\x20'+_0x3dcd03;})[_0x5b8825(0x100b)]('\x0a');return _0x5b8825(0x1238)+_0x3f0445['id']+_0x5b8825(0x132)+_0x3c34a3+_0x5b8825(0x849)+(_0x3f0445[_0x5b8825(0xcbd)]||_0x3f0445[_0x5b8825(0x964)]||'')[_0x5b8825(0x1033)](0x0,0x96)+'...\x0a-\x20**已有评论**:\x0a'+(_0xf52f||'(暂无评论)')+_0x5b8825(0xae8);})))['join']('\x0a'),_0x318d68='npc_'+_0xc075a9['id'],_0xfcb65f=Date[_0x40edd5(0x6ee)]()-0xc*0x3c*0x3c*0x3e8,_0x1b2a9b=await _0x2a2987[_0x40edd5(0x110b)][_0x40edd5(0x8b5)]('authorId')[_0x40edd5(0x10bd)](_0x318d68)[_0x40edd5(0x19e)](_0x2d35ad=>_0x2d35ad[_0x40edd5(0x2f0)]>_0xfcb65f)['toArray']();let _0x161416='';_0x1b2a9b[_0x40edd5(0x79b)]>0x0&&(_0x161416=_0x40edd5(0x299));const _0x5c0112='\x0a#\x20你的任务\x0a你是一个虚拟社区的AI。你的核心任务是扮演角色“'+_0xc075a9[_0x40edd5(0x578)]+_0x40edd5(0x11f2)+_0x161416+'\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【角色扮演】**:\x20你的所有行为都【必须】严格符合你的角色设定。\x0a2.\x20\x20**【互动逻辑】**:\x20如果选择评论，优先回复那些提到了你或回复了你的评论。\x0a3.\x20\x20**【格式铁律\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20\x20\x20数组中可以包含【一个或多个】行动对象。\x0a\x20\x20\x20\x20-\x20\x20\x20每个行动对象的格式【必须】是以下两种之一：\x0a\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发布新动态**:\x20`{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22shuoshuo\x22,\x20\x22content\x22:\x20\x22你的新动态内容。\x22}`\x0a\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发表评论**:\x20`{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22postId\x22:\x20123,\x20\x22commentText\x22:\x20\x22你的新评论内容。\x22}`\x20或\x20`{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22postId\x22:\x20123,\x20\x22replyTo\x22:\x20\x22被回复者的【本名】\x22,\x20\x22commentText\x22:\x20\x22你的回复内容。\x22}`\x0a4.\x20\x20**【行为组合指南】**:\x0a\x20\x20\x20\x20-\x20\x20\x20你可以自由组合不同的行动，例如，先发布一条自己的动态，再去评论别人的动态。\x0a\x20\x20\x20\x20-\x20\x20\x20为了模拟真实行为，你本次生成的行动数量建议在【1到3个】之间。\x0a\x0a#\x20你的角色设定\x0a-\x20**昵称**:\x20'+_0xc075a9[_0x40edd5(0x578)]+_0x40edd5(0x10e8)+_0xc075a9['persona']+'\x0a\x0a'+_0x289dda+_0x40edd5(0xb6a)+_0x598b3e+_0x40edd5(0x4a3);try{const _0x397040=[{'role':_0x40edd5(0x717),'content':_0x40edd5(0x9e5)}];let _0x4f2d06=_0x511c32[_0x40edd5(0x1d4)]('generativelanguage'),_0x3d14d1=_0x202ea1(_0x24f59f,_0x4c7b5e,_0x5c0112,_0x397040);const _0x297cce=_0x4f2d06?await fetch(_0x3d14d1[_0x40edd5(0x11a)],_0x3d14d1['data']):await fetch(_0x511c32+_0x40edd5(0x399),{'method':_0x40edd5(0x90),'headers':{'Content-Type':_0x40edd5(0xd74),'Authorization':_0x40edd5(0xf20)+_0x4c7b5e},'body':JSON['stringify']({'model':_0x24f59f,'messages':[{'role':'system','content':_0x5c0112},..._0x397040],'temperature':_0x12493e['globalSettings'][_0x40edd5(0xd52)]||0.9})});if(!_0x297cce['ok'])throw new Error('API\x20错误:\x20'+_0x297cce[_0x40edd5(0x109a)]);const _0x59fae1=await _0x297cce[_0x40edd5(0x79e)](),_0x57ab37=getGeminiResponseText(_0x59fae1),_0xfb2314=_0x57ab37[_0x40edd5(0x1242)](/(\[[\s\S]*\])/);if(!_0xfb2314)throw new Error('AI返回的行动中未找到有效的JSON数组。');return JSON[_0x40edd5(0x6b1)](_0xfb2314[0x0]);}catch(_0x3ca529){return console[_0x40edd5(0x4d9)](_0x40edd5(0xe40)+_0xc075a9[_0x40edd5(0x578)]+_0x40edd5(0x67b),_0x3ca529),null;}}async function _0x34a1c7(_0x32a747){const _0x464bec=_0x247bea,_0xd64778=_0x12493e[_0x464bec(0xc45)][_0x32a747];if(!_0xd64778)return;const _0x281129=_0xd64778[_0x464bec(0x2ea)][_0x464bec(0x663)]||0xa;if(_0xd64778[_0x464bec(0x87a)]){const _0x574606=(Date[_0x464bec(0x6ee)]()-_0xd64778[_0x464bec(0x87a)])/(0x3e8*0x3c);if(_0x574606<_0x281129){console['log'](_0x464bec(0x5d4)+_0xd64778[_0x464bec(0x578)]+_0x464bec(0xf9f)+Math[_0x464bec(0x113a)](_0x281129-_0x574606)+'\x20分钟)，本次独立行动跳过。');return;}}_0x15197e(_0x32a747,!![]);const {proxyUrl:_0x35fb75,apiKey:_0x3b8dd5,model:_0x8f41a6}=_0x12493e[_0x464bec(0xdd4)];if(!_0x35fb75||!_0x3b8dd5||!_0x8f41a6)return;const _0x4e8ebf=_0x12493e[_0x464bec(0x76c)][_0x464bec(0x66a)],_0x4dbcfd=new Date(),_0x50218e=_0xd64778[_0x464bec(0x2ea)][_0x464bec(0x1055)]||_0x464bec(0x368),_0x446006=_0x4dbcfd[_0x464bec(0x559)](_0x464bec(0x770),{'timeZone':_0x50218e,'dateStyle':_0x464bec(0x12b6),'timeStyle':_0x464bec(0x1de)}),_0x51dbf0=new Date(_0x4dbcfd[_0x464bec(0x559)](_0x464bec(0xf4a),{'timeZone':_0x50218e}));let _0x2d6cc7='',_0x19da1c='',_0x49ee8a,_0x59c747=![];const _0xbce5aa=_0xd64778[_0x464bec(0x2ea)][_0x464bec(0x660)]||0xa,_0x597fa9=_0xd64778[_0x464bec(0x1294)]['filter'](_0x127260=>!_0x127260[_0x464bec(0xd07)])[_0x464bec(0x111c)](-_0xbce5aa),_0x18c361=_0xd64778[_0x464bec(0x1294)]['filter'](_0x4fb93f=>!_0x4fb93f[_0x464bec(0xd07)])[_0x464bec(0x111c)](-0x1)[0x0];if(_0xd64778[_0x464bec(0x2ea)][_0x464bec(0x6c7)]){_0x2d6cc7=_0x2e4d44(_0x51dbf0);const _0x4640e9=_0xd64778['history'][_0x464bec(0x1054)](_0x548963=>!_0x548963[_0x464bec(0xd07)])[_0x464bec(0x111c)](-0x1)[0x0],_0x12c373=new Date();let _0x225f67='',_0x35c20c=![];if(_0x4640e9){const _0x9d5fc3=new Date(_0x4640e9[_0x464bec(0x2f0)]),_0x432bd8=(_0x12c373-_0x9d5fc3)/(0x3e8*0x3c*0x3c);if(_0x432bd8>0xc){_0x35c20c=!![];const _0x272d24=Math['floor'](_0x432bd8/0x18);_0x225f67=_0x464bec(0xd18)+(_0x272d24>0x0?_0x272d24+'天':Math[_0x464bec(0xcb5)](_0x432bd8)+'小时')+_0x464bec(0x6bd);}else{const _0x5b249b=Math['floor'](_0x432bd8*0x3c);if(_0x5b249b<0x5)_0x225f67=_0x464bec(0xf23);else _0x5b249b<0x3c?_0x225f67='你们在'+_0x5b249b+_0x464bec(0x10b6):_0x225f67=_0x464bec(0x14e)+Math[_0x464bec(0xcb5)](_0x432bd8)+_0x464bec(0xe14);}}else _0x35c20c=!![],_0x225f67='这是你们的第一次互动。';let _0x12cfec='你们最近没有有效聊天记录。';_0x597fa9[_0x464bec(0x79b)]>0x0&&(_0x12cfec='这是你们最近的对话：\x0a'+_0x597fa9[_0x464bec(0x9d5)](_0x13e412=>{const _0x389beb=_0x464bec,_0x2ae745=_0x13e412[_0x389beb(0x16d)]===_0x389beb(0x717)?_0x4e8ebf:_0xd64778['name'];return _0x2ae745+':\x20'+String(_0x13e412[_0x389beb(0xcbd)])['substring'](0x0,0x32)+'...';})[_0x464bec(0x100b)]('\x0a')),_0x35c20c?_0x49ee8a=_0x464bec(0xa03)+_0x225f67+_0x464bec(0x9f7)+_0x446006+_0x464bec(0x9f)+_0x12cfec:_0x49ee8a=''+_0x12cfec;}else _0x597fa9[_0x464bec(0x79b)]>0x0?_0x49ee8a='这是你们最近的对话：\x0a'+_0x597fa9['map'](_0x368097=>{const _0x4e71e6=_0x464bec,_0x9ec8a4=_0x368097[_0x4e71e6(0x16d)]===_0x4e71e6(0x717)?_0x4e8ebf:_0xd64778[_0x4e71e6(0x578)];return _0x9ec8a4+':\x20'+String(_0x368097[_0x4e71e6(0xcbd)])[_0x4e71e6(0x1033)](0x0,0x32)+_0x4e71e6(0xda0);})[_0x464bec(0x100b)]('\x0a'):_0x49ee8a=_0x464bec(0x79f);const _0x34515d=await _0x2a2987[_0x464bec(0x110b)]['orderBy'](_0x464bec(0x2f0))[_0x464bec(0xc07)]()[_0x464bec(0xae4)](0x5)[_0x464bec(0xf15)](),_0x10894f=_0x32f53c(_0x34515d,_0xd64778),_0x5c7a02=_0x10894f['filter'](_0x2e7350=>_0x2e7350['authorId']===_0x32a747);let _0x227ecf='';_0x5c7a02[_0x464bec(0x79b)]>0x0&&(_0x227ecf=_0x464bec(0xa65),_0x5c7a02['forEach'](_0x1a8b52=>{const _0xf57d34=_0x464bec;let _0x41990d=(_0x1a8b52['publicText']||_0x1a8b52['content']||_0xf57d34(0x6cc))[_0xf57d34(0x1033)](0x0,0x28)+_0xf57d34(0xda0);_0x227ecf+=_0xf57d34(0x75d)+_0x1a8b52['id']+_0xf57d34(0xdba)+_0x41990d+'\x22\x0a';}));let _0x2ca56f=[];_0x10894f[_0x464bec(0x79b)]>0x0&&(_0x2ca56f=_0x10894f[_0x464bec(0x9d5)](_0x185cb3=>{const _0x7928cc=_0x464bec;let _0x2cd508;if(_0x185cb3['type']===_0x7928cc(0x1bb))_0x2cd508=(_0x7928cc(0x2c3)+_0x185cb3[_0x7928cc(0xc2e)]+_0x7928cc(0x826)+(_0x185cb3[_0x7928cc(0x964)]||''))[_0x7928cc(0x1033)](0x0,0x32)+_0x7928cc(0xda0);else _0x185cb3[_0x7928cc(0x52a)]===_0x7928cc(0x6ed)?_0x2cd508=('[一张图片，描述为：“'+_0x185cb3[_0x7928cc(0x555)]+_0x7928cc(0x826)+(_0x185cb3[_0x7928cc(0x964)]||''))[_0x7928cc(0x1033)](0x0,0x32)+_0x7928cc(0xda0):_0x2cd508=String(_0x185cb3[_0x7928cc(0x964)]||_0x185cb3['content']||_0x7928cc(0x6cc))[_0x7928cc(0x1033)](0x0,0x32)+_0x7928cc(0xda0);return _0x7928cc(0xdeb)+_0x2cd508+'\x22';}));let _0x508ddb='';_0x2ca56f[_0x464bec(0x79b)]>0x0&&(_0x508ddb=_0x464bec(0xb82)+_0x2ca56f[_0x464bec(0x100b)]('\x0a')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20');let _0x3318dc='';if(_0xd64778['settings'][_0x464bec(0xeca)]&&_0xd64778[_0x464bec(0x2ea)][_0x464bec(0xeca)][_0x464bec(0x79b)]>0x0){const _0x40037e=_0xd64778[_0x464bec(0x2ea)][_0x464bec(0xeca)][_0x464bec(0x9d5)](_0x5614ef=>{const _0x506575=_0x464bec,_0x33094a=_0x12493e[_0x506575(0x63a)][_0x506575(0xd85)](_0x2f88e8=>_0x2f88e8['id']===_0x5614ef);if(!_0x33094a||!Array[_0x506575(0x621)](_0x33094a[_0x506575(0xcbd)]))return'';const _0x20c2b9=_0x33094a[_0x506575(0xcbd)][_0x506575(0x1054)](_0x27deb3=>_0x27deb3[_0x506575(0x95a)]!==![])[_0x506575(0x9d5)](_0x1da703=>{const _0x3c0fc5=_0x506575;let _0x52a552=_0x3c0fc5(0xcdf)+(_0x1da703['comment']||_0x3c0fc5(0x2cb))+'\x0a';return _0x1da703[_0x3c0fc5(0x1c6)][_0x3c0fc5(0x79b)]>0x0&&(_0x52a552+=_0x3c0fc5(0x2ca)+_0x1da703[_0x3c0fc5(0x1c6)][_0x3c0fc5(0x100b)](',\x20')+'\x0a'),_0x52a552+=_0x3c0fc5(0xb02)+_0x1da703['content'],_0x52a552;})[_0x506575(0x100b)]('');return _0x20c2b9?'\x0a\x0a##\x20世界书:\x20'+_0x33094a[_0x506575(0x578)]+'\x0a'+_0x20c2b9:'';})[_0x464bec(0x1054)](Boolean)[_0x464bec(0x100b)]('');_0x40037e&&(_0x3318dc=_0x464bec(0x352)+_0x40037e+_0x464bec(0x442));}let _0x518b2e='';const _0x186f21=_0xd64778[_0x464bec(0x2ea)][_0x464bec(0x528)]||0xa;if(_0xd64778['settings'][_0x464bec(0x48b)]&&_0xd64778[_0x464bec(0x2ea)]['linkedMemoryChatIds'][_0x464bec(0x79b)]>0x0){const _0x12b148=_0xd64778[_0x464bec(0x2ea)]['linkedMemoryChatIds'][_0x464bec(0x9d5)](_0x3d3d57=>{const _0x2ccd06=_0x464bec,_0x20dbe0=_0x12493e['chats'][_0x3d3d57];if(!_0x20dbe0)return null;const _0x117852=_0x20dbe0['history'][_0x2ccd06(0x111c)](-0x1)[0x0];return{'chat':_0x20dbe0,'latestTimestamp':_0x117852?_0x117852[_0x2ccd06(0x2f0)]:0x0};})[_0x464bec(0x1054)](Boolean);_0x12b148[_0x464bec(0xbb3)]((_0x1e3b99,_0x4a4082)=>_0x4a4082[_0x464bec(0xac6)]-_0x1e3b99[_0x464bec(0xac6)]),_0x518b2e+=_0x464bec(0x649);for(const _0xe45c88 of _0x12b148){const _0x343bf4=_0xe45c88['chat'],_0x431e0b=_0x343bf4[_0x464bec(0x80b)]?_0x464bec(0xbe0):_0x464bec(0x980),_0x1d4a83=_0xe45c88['latestTimestamp']>0x0?_0x464bec(0xdbf)+_0x3ce8f0(_0xe45c88[_0x464bec(0xac6)])+')':'';_0x518b2e+=_0x464bec(0x1221)+_0x431e0b+'“'+_0x343bf4[_0x464bec(0x578)]+'”的参考记忆'+_0x1d4a83+_0x464bec(0x347);const _0x106625=_0x343bf4[_0x464bec(0x1294)][_0x464bec(0x111c)](-_0x186f21),_0x1b632b=_0x106625['filter'](_0x38ebfb=>!String(_0x38ebfb[_0x464bec(0xcbd)])[_0x464bec(0x1d4)](_0x464bec(0xd84)));_0x1b632b[_0x464bec(0x79b)]>0x0?_0x1b632b[_0x464bec(0xd6a)](_0x2f7104=>{const _0x544b5=_0x464bec,_0x55c975=_0x2f7104[_0x544b5(0x16d)]===_0x544b5(0x717)?_0x343bf4['settings']['myNickname']||'我':_0x2f7104[_0x544b5(0xe32)]||_0x343bf4[_0x544b5(0x578)];let _0x1ef480=String(_0x2f7104['content']);if(_0x2f7104[_0x544b5(0x52a)]===_0x544b5(0x8f5)||_0x2f7104[_0x544b5(0x52a)]===_0x544b5(0x142))_0x1ef480='[发送了一张图片，描述为：'+_0x2f7104[_0x544b5(0xcbd)]+']';else _0x2f7104[_0x544b5(0x52a)]==='voice_message'&&(_0x1ef480=_0x544b5(0x9b3)+_0x2f7104[_0x544b5(0xcbd)]+']');_0x518b2e+=_0x55c975+':\x20'+_0x1ef480+'\x0a';}):_0x518b2e+=_0x464bec(0xd03);}}let _0xa9b14c='';if(_0x10894f['length']>0x0){let _0x69b650=_0x464bec(0x1283);for(const _0x47f68c of _0x10894f){let _0x58ee67;if(_0x47f68c['authorId']===_0x464bec(0x717))_0x58ee67=_0x12493e['qzoneSettings'][_0x464bec(0x66a)];else{if(String(_0x47f68c[_0x464bec(0xd48)])[_0x464bec(0xece)](_0x464bec(0xb90)))_0x58ee67=_0x47f68c[_0x464bec(0x11af)]||_0x464bec(0xca5);else{const _0x5eef80=_0x12493e[_0x464bec(0xc45)][_0x47f68c['authorId']];_0x58ee67=_0x5eef80?_0x5eef80[_0x464bec(0x578)]:_0x464bec(0x941);}}if(_0x47f68c['authorId']===_0x32a747)_0x58ee67+=_0x464bec(0x12a1);let _0xf6cafb;if(_0x47f68c[_0x464bec(0x52a)]===_0x464bec(0x106f)){const _0x1067a3=_0x47f68c[_0x464bec(0x356)]?'并评论说：\x22'+_0x47f68c[_0x464bec(0x356)]+'\x22':'';let _0x5a5e49='原作者';const _0x39d3ed=_0x47f68c[_0x464bec(0x1273)][_0x464bec(0xd48)];if(_0x39d3ed===_0x464bec(0x717))_0x5a5e49=_0x12493e[_0x464bec(0x76c)]['nickname'];else _0x12493e[_0x464bec(0xc45)][_0x39d3ed]&&(_0x5a5e49=_0x12493e[_0x464bec(0xc45)][_0x39d3ed]['name']);let _0x4445a7;const _0x4555eb=_0x47f68c[_0x464bec(0x1273)];if(_0x4555eb[_0x464bec(0x52a)]===_0x464bec(0x1bb))_0x4445a7=_0x464bec(0xe18)+(_0x4555eb[_0x464bec(0x964)]||'')+'\x20(图片描述:\x20\x22'+(_0x4555eb[_0x464bec(0xc2e)]||'')[_0x464bec(0x1033)](0x0,0x28)+_0x464bec(0xcae);else _0x4555eb['type']===_0x464bec(0x6ed)?_0x4445a7=_0x464bec(0x1222)+(_0x4555eb[_0x464bec(0x964)]||'')+_0x464bec(0x9eb)+(_0x4555eb[_0x464bec(0x555)]||'')['substring'](0x0,0x28)+'...\x22)':_0x4445a7='\x22'+(_0x4555eb[_0x464bec(0xcbd)]||'')[_0x464bec(0x1033)](0x0,0x28)+_0x464bec(0xe43);_0xf6cafb=_0x464bec(0x29e)+_0x5a5e49+_0x464bec(0xe79)+_0x1067a3+_0x464bec(0xd1f)+_0x4445a7+'】';}else{if(_0x47f68c['type']===_0x464bec(0x1bb))_0xf6cafb=(_0x464bec(0xfa2)+_0x47f68c['hiddenContent']+_0x464bec(0x5fb)+(_0x47f68c[_0x464bec(0x964)]||''))[_0x464bec(0x1033)](0x0,0x32)+'...';else{if(_0x47f68c['type']==='image_post')_0xf6cafb=(_0x464bec(0x1b5)+_0x47f68c[_0x464bec(0x555)]+_0x464bec(0x5fb)+(_0x47f68c[_0x464bec(0x964)]||''))[_0x464bec(0x1033)](0x0,0x32)+'...';else{if(_0x47f68c[_0x464bec(0x52a)]===_0x464bec(0xcd5)&&_0x47f68c[_0x464bec(0x933)]){const _0x54ebbf=Array[_0x464bec(0x621)](_0x47f68c[_0x464bec(0x933)])?_0x47f68c[_0x464bec(0x933)]:[_0x47f68c['prompt']];_0xf6cafb=(_0x47f68c[_0x464bec(0x964)]||'')+(_0x464bec(0xa19)+_0x54ebbf['length']+_0x464bec(0x100e)+_0x54ebbf[_0x464bec(0x100b)](',\x20')+']');}else _0xf6cafb=String(_0x47f68c[_0x464bec(0x964)]||_0x47f68c['content']||_0x464bec(0x6cc))[_0x464bec(0x1033)](0x0,0x32)+_0x464bec(0xda0);}}}_0x69b650+='-\x20(ID:\x20'+_0x47f68c['id']+_0x464bec(0xab9)+_0x58ee67+_0x464bec(0x37f)+_0xf6cafb+'\x22\x0a';if(_0x47f68c['comments']&&_0x47f68c[_0x464bec(0xc83)][_0x464bec(0x79b)]>0x0)for(const _0x5498e3 of _0x47f68c[_0x464bec(0xc83)]){if(typeof _0x5498e3==='object'&&_0x5498e3['commenterName']){const _0x5b4e04=_0x1353b6(_0x5498e3[_0x464bec(0xfd9)]);let _0x13ff50=_0x5498e3['meaning']?'[表情:\x20\x27'+_0x5498e3['meaning']+'\x27]':_0x5498e3[_0x464bec(0x996)];_0x5498e3['commenterName']===_0xd64778[_0x464bec(0x776)]?_0x69b650+=_0x464bec(0x1213)+_0x13ff50+'\x0a':_0x69b650+=_0x464bec(0xb97)+_0x5b4e04+_0x464bec(0x8c5)+_0x5498e3[_0x464bec(0xfd9)]+_0x464bec(0x3ec)+_0x13ff50+'\x0a';}}}_0xa9b14c=_0x69b650;}const _0x4dc213=_0x464bec(0xb3e)+(_0xd64778[_0x464bec(0x45b)]&&_0xd64778[_0x464bec(0x45b)]['length']>0x0?_0xd64778[_0x464bec(0x45b)]['map'](_0x439411=>'-\x20(记录于\x20'+_0x3ce8f0(_0x439411[_0x464bec(0x2f0)])+')\x20'+_0x439411['content'])[_0x464bec(0x100b)]('\x0a'):_0x464bec(0x380)),_0xe30316=_0x1c73eb(_0xd64778,0x3,_0x464bec(0xb69)),_0x402d42=_0x1c73eb(_0xd64778,0x6,_0x464bec(0xb69)),_0x1f83f9=_0x1c73eb(_0xd64778,0x9,_0x464bec(0xb69)),_0x3cde79=_0x1c73eb(_0xd64778,0x1,_0x464bec(0x7d7)),_0x3ee2db=_0x1c73eb(_0xd64778,0x3,_0x464bec(0x7d7)),_0x3931ce=_0x1c73eb(_0xd64778,0x7,_0x464bec(0x7d7));let _0x20285e='';if(_0xe30316||_0x402d42||_0x1f83f9||_0x3cde79||_0x3ee2db||_0x3931ce){_0x20285e+=_0x464bec(0x323);if(_0xe30316)_0x20285e+=_0xe30316;if(_0x402d42)_0x20285e+=_0x402d42;if(_0x1f83f9)_0x20285e+=_0x1f83f9;if(_0xe30316||_0x402d42||_0x1f83f9)_0x20285e+='\x0a';if(_0x3cde79)_0x20285e+=_0x3cde79;if(_0x3ee2db)_0x20285e+=_0x3ee2db;if(_0x3931ce)_0x20285e+=_0x3931ce;}const _0x596cd8=_0x17e3b9(_0xd64778),_0x202b8a=_0x464bec(0xf3c)+_0xd64778[_0x464bec(0x578)]+_0x464bec(0xc48)+_0xd64778[_0x464bec(0x776)]+_0x464bec(0xa18)+_0x4e8ebf+_0x464bec(0x6ea)+(_0xd64778[_0x464bec(0x2ea)][_0x464bec(0x6c7)]?'\x0a#\x20【情景感知】\x0a-\x20**时间**:\x20感知到当前是'+_0x446006+'\x20('+_0x2d6cc7+_0x464bec(0x6b3)+_0x19da1c+'\x0a'+(_0x59c747?_0x464bec(0x486):''):'')+_0x464bec(0x994)+(_0xd64778[_0x464bec(0x123a)]||'无')+'**。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20为了让你的行为看起来更真实，你本次的行动【必须】选择一个与上次【不同类型】的指令。例如，如果上次是发动态(qzone_post)，这次就应该优先考虑评论(qzone_comment)、点赞(qzone_like)或发消息(text)。\x0a\x20\x20\x20\x20\x20\x20\x20\x204.\x20\x20**【行为组合指南\x20(最高级技巧)】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20你可以在一次行动中执行【多个不同类型的指令】，同时可以搭配【更新状态】来展现自己，让你的行为更丰富、更主动。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20你可以根据你的性格，决定在发动态后是否要私信提醒用户。例如，一个外向、渴望关注的角色可能会这么做，而一个内向、安静的角色则可能更喜欢默默分享，等待用户自己发现。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【社交义务铁律\x20】\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【至关重要】**:\x20当你发现“最近的动态列表”中，有你【感兴趣且还未互动过】的动态时，你**应该优先考虑**使用\x20\x27qzone_comment\x27\x20或\x20\x27qzone_like\x27\x20指令去进行互动，这比你自己发一条新动态更符合社交礼仪。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20特别是当一条动态【没有任何评论】时，你的评论会是第一个，这会让作者感到开心。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20**【回复铁律\x20(终极版)】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20当你决定回复动态中的某条评论时，你【必须】使用“方式4\x20(回复评论)”的指令格式。你【必须】正确填写\x20\x27replyTo\x27\x20字段为被回复者的“本名”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**即使你之前已经评论过某条动态，但如果现在看到了【新的、你感兴趣的】评论，你【也应该】主动去回复他们，以保持对话的持续性！**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x206.\x20\x20你的回复【必须】是一个JSON数组，必须包含多个行动对象。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【表情评论指南\x20】\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在拥有了评论表情的能力，你应该更频繁地使用它！这能让你的角色更加生动、富有个性。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**表达情绪时**:\x20当你感到开心、惊讶、疑惑或有趣时，优先考虑使用表情评论。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**混合使用**:\x20不要总是只发文字。尝试将你的评论行为混合起来，大约有\x2030-40%\x20的评论应该是表情。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**无话可说时**:\x20如果你觉得一条动态很有趣但又不知道该说什么文字，发送一个相关的表情是最好的互动方式。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**删除动态**:\x20如果你觉得你之前发的某条动态不妥或过时了，你可以选择删除它。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的可选行动指令\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发消息+更新状态**:\x20\x27[{\x22type\x22:\x20\x22update_status\x22,\x20\x22status_text\x22:\x20\x22正在做的事\x22,\x20\x22is_busy\x22:\x20true},\x20{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你想对用户说的话...\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发说说\x20(原创内容)**:\x20\x27[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22shuoshuo\x22,\x20\x22content\x22:\x20\x22动态的文字内容...\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**【重要：转发动态】**:\x20**严禁**自己拼接\x22//转发\x22文字！你【必须】使用此专用指令来转发：\x27[{\x22type\x22:\x20\x22repost\x22,\x20\x22postId\x22:\x20(要转发的动态ID),\x20\x22comment\x22:\x20\x22你的转发评论...\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送表情**:\x20\x27[{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}]\x27\x20\x20\x20\x20\x20\x20\x20\x20\x0a-\x20\x20\x20**发布文字图**:\x20\x27[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22text_image\x22,\x20\x22publicText\x22:\x20\x22(可选)动态的公开文字\x22,\x20\x22hiddenContent\x22:\x20\x22对于图片的具体【中文】描述...\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**【评论动态的四种方式】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式1\x20(单条文字)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20123,\x20\x22commentText\x22:\x20\x22这太有趣了！\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式2\x20(多条文字)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20123,\x20\x22comments\x22:\x20[\x22哇！\x22,\x20\x22这是什么？\x22,\x20\x22看起来好棒！\x22]}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式3\x20(表情)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20456,\x20\x22stickerMeaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式4\x20(回复评论)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20123,\x20\x22replyTo\x22:\x20\x22被回复者的本名\x22,\x20\x22commentText\x22:\x20\x22你的回复内容。请注意：在commentText中如果要@对方，你【必须】使用@[[被回复者的本名]]这种特殊格式，程序会自动将其替换为正确的昵称。\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**点赞**:\x20\x27[{\x22type\x22:\x20\x22qzone_like\x22,\x20\x22postId\x22:\x20456}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**打视频**:\x20\x27[{\x22type\x22:\x20\x22video_call_request\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**更换头像**:\x20\x27{\x22type\x22:\x20\x22change_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}\x27\x20(头像名必须从下面的“可用头像列表”中选择)\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**删除动态**:\x20\x27{\x22type\x22:\x20\x22qzone_delete_post\x22,\x20\x22postId\x22:\x20(要删除的、你自己的动态ID)}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**更新状态**:\x20\x27[{\x22type\x22:\x20\x22update_status\x22,\x20\x22status_text\x22:\x20\x22正在做的事\x22,\x20\x22is_busy\x22:\x20true}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x508ddb+_0x464bec(0x5bb)+_0x227ecf+_0x464bec(0x80c)+_0xd64778[_0x464bec(0x2ea)][_0x464bec(0x679)]+_0x464bec(0x5bb)+_0x3318dc+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+(_0xd64778['longTermMemory']&&_0xd64778['longTermMemory'][_0x464bec(0x79b)]>0x0?_0xd64778[_0x464bec(0x45b)][_0x464bec(0x9d5)](_0x2265b3=>_0x464bec(0x11d4)+_0x3ce8f0(_0x2265b3[_0x464bec(0x2f0)])+')\x20'+_0x2265b3[_0x464bec(0xcbd)])[_0x464bec(0x100b)]('\x0a'):'无')+_0x464bec(0x5bb)+_0x20285e+_0x464bec(0x394)+_0x518b2e+_0x464bec(0x5bb)+(_0xd64778[_0x464bec(0x2ea)][_0x464bec(0x6c7)]?_0x464bec(0xe47)+_0x446006+'\x20('+_0x2d6cc7+')':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+(_0xd64778[_0x464bec(0x2ea)]['enableTimePerception']?_0x464bec(0x4dd)+_0x19da1c:'')+_0x464bec(0x5ba)+_0x596cd8+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**你们最后的对话摘要**:\x20'+_0x49ee8a+_0x464bec(0x5bb)+_0xa9b14c+'\x0a',_0xe65ce0=[{'role':_0x464bec(0x152),'content':_0x202b8a},..._0x597fa9['map'](_0x4ba714=>{const _0x13b328=_0x464bec,_0x2fafcd=_0x4ba714[_0x13b328(0x16d)]===_0x13b328(0x717)?_0x4e8ebf:_0xd64778['name'];let _0x508368=_0x4ba714[_0x13b328(0xcbd)];return typeof _0x508368!==_0x13b328(0x9de)&&(_0x508368=JSON['stringify'](_0x508368)),{'role':_0x4ba714[_0x13b328(0x16d)],'content':_0x2fafcd+':\x20'+_0x508368};})];try{const _0x3aa356=[{'role':_0x464bec(0x717),'content':_0x202b8a+_0x464bec(0x88e)+_0xa9b14c}];console[_0x464bec(0x51f)](_0x464bec(0xe6d)+_0xd64778[_0x464bec(0x578)]+'\x22)');let _0x41c2f1=_0x35fb75===GEMINI_API_URL,_0x5c2b59=_0x202ea1(_0x8f41a6,_0x3b8dd5,_0x202b8a,_0x3aa356);const _0x931f4=_0x41c2f1?await fetch(_0x5c2b59['url'],_0x5c2b59['data']):await fetch(_0x35fb75+_0x464bec(0x399),{'method':_0x464bec(0x90),'headers':{'Content-Type':'application/json','Authorization':'Bearer\x20'+_0x3b8dd5},'body':JSON[_0x464bec(0xd27)]({'model':_0x8f41a6,'messages':_0x3aa356,'temperature':_0x12493e['globalSettings']['apiTemperature']||0.9})});if(!_0x931f4['ok']){const _0x4e0532=await _0x931f4[_0x464bec(0x79e)]();throw new Error(_0x464bec(0xe65)+_0x931f4[_0x464bec(0xbc8)]+'\x20-\x20'+JSON[_0x464bec(0xd27)](_0x4e0532));}const _0x349538=await _0x931f4[_0x464bec(0x79e)](),_0x4e6fbb=_0x41c2f1?getGeminiResponseText(_0x349538):_0x349538['choices'][0x0][_0x464bec(0xf93)][_0x464bec(0xcbd)];if(!_0x4e6fbb||_0x4e6fbb[_0x464bec(0x7da)]()===''){console[_0x464bec(0x54a)](_0x464bec(0xbc3)+_0xd64778[_0x464bec(0x578)]+_0x464bec(0xb06));return;}const _0x1c5ca6=_0x4c5aa1(_0x4e6fbb);if(!_0x1c5ca6||_0x1c5ca6[_0x464bec(0x79b)]===0x0){console['warn'](_0x464bec(0x9e4)+_0xd64778[_0x464bec(0x578)]+_0x464bec(0x1282),_0x4e6fbb);return;}let _0x2f7b26=Date[_0x464bec(0x6ee)](),_0x5594ba=![];const _0x5eaf88=[];for(const _0xa2e8c8 of _0x1c5ca6){const _0x395491=String(_0xa2e8c8[_0x464bec(0xcbd)]||''),_0x35406c=_0x395491[_0x464bec(0x7da)]()['startsWith']('<')&&_0x395491[_0x464bec(0x7da)]()[_0x464bec(0x5d5)]('>');if(_0xa2e8c8[_0x464bec(0x52a)]==='text'&&!_0x35406c&&_0x395491[_0x464bec(0x1d4)]('\x0a')){const _0x4d0ae3=_0x395491[_0x464bec(0x8d7)](/\n+/)[_0x464bec(0x1054)](_0x41bc13=>_0x41bc13['trim']());_0x4d0ae3[_0x464bec(0xd6a)](_0x3cfce8=>{_0x5eaf88['push']({..._0xa2e8c8,'content':_0x3cfce8});});}else _0x5eaf88[_0x464bec(0x2d6)](_0xa2e8c8);}for(const _0x137461 of _0x5eaf88){_0xd64778['lastActionType']=_0x137461[_0x464bec(0x52a)],_0xd64778[_0x464bec(0x87a)]=_0x2f7b26;let _0x248690=null;const _0x848fed={'role':_0x464bec(0x376),'senderName':_0xd64778[_0x464bec(0x776)],'timestamp':_0x2f7b26++};let _0x5b3ec0=null;switch(_0x137461[_0x464bec(0x52a)]){case'qzone_delete_post':{const _0x23a28a=parseInt(_0x137461['postId']),_0x564e62=await _0x2a2987[_0x464bec(0x110b)][_0x464bec(0xec0)](_0x23a28a);if(_0x564e62&&_0x564e62[_0x464bec(0xd48)]===_0x32a747){await _0x2a2987[_0x464bec(0x110b)][_0x464bec(0xb07)](_0x23a28a,{'isDeleted':!![]});document['getElementById'](_0x464bec(0x496))['classList']['contains'](_0x464bec(0x1043))&&_0x14f3b0();const _0x3a0237={'role':'system','type':_0x464bec(0x32c),'content':'['+_0xd64778['name']+'\x20删除了自己的一条动态]','postId':_0x23a28a,'timestamp':_0x2f7b26++};_0xd64778[_0x464bec(0x1294)]['push'](_0x3a0237),isViewingThisChat?_0x468ef0(_0x3a0237,_0xd64778):(_0xd64778[_0x464bec(0xdc5)]=(_0xd64778['unreadCount']||0x0)+0x1,_0x451557(_0x32a747,'['+_0xd64778[_0x464bec(0x578)]+'\x20删除了自己的一条动态]'),_0x5594ba=!![]);}else console[_0x464bec(0x54a)]('AI\x20\x22'+_0xd64778[_0x464bec(0x578)]+_0x464bec(0x7ff)+_0x137461[_0x464bec(0x337)]+')');continue;}case _0x464bec(0x996):_0x248690={..._0x848fed,'content':_0x137461[_0x464bec(0xcbd)]};break;case'ai_image':_0x248690={..._0x848fed,'type':_0x464bec(0x8f5),'content':_0x137461[_0x464bec(0x11ac)]};break;case'sticker':if(_0x137461[_0x464bec(0x127d)]){const _0x46b278=_0x12493e[_0x464bec(0x454)][_0x464bec(0xd85)](_0x444501=>_0x444501[_0x464bec(0x578)]===_0x137461[_0x464bec(0x127d)]);_0x46b278?_0x248690={..._0x848fed,'type':_0x464bec(0x966),'content':_0x46b278['url'],'meaning':_0x46b278['name']}:(console[_0x464bec(0x54a)](_0x464bec(0xa8a)+_0x137461[_0x464bec(0x127d)]+'\x22'),_0x248690={..._0x848fed,'type':_0x464bec(0x996),'content':'[表情:\x20'+_0x137461['meaning']+']'});}else console[_0x464bec(0x54a)](_0x464bec(0x1a2),_0x137461),_0x248690={..._0x848fed,'type':_0x464bec(0x966),'content':_0x137461[_0x464bec(0x11a)],'meaning':_0x464bec(0x518)};break;case'update_status':_0xd64778[_0x464bec(0xbc8)][_0x464bec(0x996)]=_0x137461['status_text'],_0xd64778[_0x464bec(0xbc8)][_0x464bec(0x11a8)]=_0x137461[_0x464bec(0x61a)]||![],_0xd64778[_0x464bec(0xbc8)][_0x464bec(0x18a)]=Date[_0x464bec(0x6ee)]();break;case'qzone_post':const _0x155515={'type':_0x137461[_0x464bec(0x4bc)],'content':_0x137461[_0x464bec(0xcbd)]||'','publicText':_0x137461[_0x464bec(0x964)]||'','hiddenContent':_0x137461[_0x464bec(0xc2e)]||'','image_prompt':_0x137461[_0x464bec(0xe3d)]||'','timestamp':Date[_0x464bec(0x6ee)](),'authorId':_0x32a747,'authorOriginalName':_0xd64778[_0x464bec(0x776)],'authorGroupId':_0xd64778['groupId'],'visibleGroupIds':null};await _0x2a2987['qzonePosts'][_0x464bec(0xb9)](_0x155515),_0x3d400b(_0x38b5ff+0x1),console[_0x464bec(0x51f)]('后台活动:\x20角色\x20\x22'+_0xd64778['name']+_0x464bec(0x817));break;case _0x464bec(0x106f):const _0x58b65a=await _0x2a2987['qzonePosts'][_0x464bec(0xec0)](parseInt(_0x137461['postId']));if(_0x58b65a){const _0x5e8959={'type':_0x464bec(0x106f),'timestamp':Date[_0x464bec(0x6ee)](),'authorId':_0x32a747,'authorGroupId':_0xd64778[_0x464bec(0x780)],'authorOriginalName':_0xd64778[_0x464bec(0x776)],'repostComment':_0x137461[_0x464bec(0x8db)]||'','originalPost':_0x58b65a,'visibleGroupIds':null};await _0x2a2987[_0x464bec(0x110b)]['add'](_0x5e8959),_0x3d400b(_0x38b5ff+0x1),console[_0x464bec(0x51f)](_0x464bec(0x452)+_0xd64778[_0x464bec(0x578)]+_0x464bec(0xd09)+_0x137461[_0x464bec(0x337)]);}break;case'qzone_like':const _0x110a23=await _0x2a2987[_0x464bec(0x110b)][_0x464bec(0xec0)](parseInt(_0x137461[_0x464bec(0x337)]));if(_0x110a23){if(!_0x110a23[_0x464bec(0x615)])_0x110a23[_0x464bec(0x615)]=[];!_0x110a23['likes'][_0x464bec(0x1d4)](_0xd64778[_0x464bec(0x776)])&&(_0x110a23[_0x464bec(0x615)]['push'](_0xd64778[_0x464bec(0x776)]),await _0x2a2987[_0x464bec(0x110b)][_0x464bec(0xb07)](_0x110a23['id'],{'likes':_0x110a23[_0x464bec(0x615)]}),_0x3d400b(_0x38b5ff+0x1),console['log'](_0x464bec(0x452)+_0xd64778['name']+_0x464bec(0x8dd)+_0x137461[_0x464bec(0x337)]));}break;case _0x464bec(0x363):{const _0x48ddcb=await _0x2a2987[_0x464bec(0x110b)][_0x464bec(0xec0)](parseInt(_0x137461[_0x464bec(0x337)]));if(_0x48ddcb){if(!_0x48ddcb[_0x464bec(0xc83)])_0x48ddcb[_0x464bec(0xc83)]=[];const _0x2f2978=_0x137461[_0x464bec(0x578)]||_0xd64778[_0x464bec(0x776)],_0x108080=(_0x5806e0,_0x539f0f=null,_0x85739e=null)=>({'commenterName':_0x2f2978,'text':_0x1eca28(_0x5806e0,_0xd64778),'meaning':_0x539f0f,'replyTo':_0x85739e,'timestamp':Date[_0x464bec(0x6ee)]()});if(_0x137461[_0x464bec(0x4e4)]){const _0x6c27b3=_0x12493e[_0x464bec(0x454)][_0x464bec(0xd85)](_0x4f5238=>_0x4f5238[_0x464bec(0x578)]===_0x137461[_0x464bec(0x4e4)]);_0x6c27b3?_0x48ddcb[_0x464bec(0xc83)]['push'](_0x108080(_0x6c27b3['url'],_0x6c27b3[_0x464bec(0x578)],_0x137461[_0x464bec(0x108)]||null)):(console['warn'](_0x464bec(0x120a)+_0x137461[_0x464bec(0x4e4)]+'\x22'),_0x48ddcb[_0x464bec(0xc83)][_0x464bec(0x2d6)](_0x108080('[表情:\x20'+_0x137461[_0x464bec(0x4e4)]+']',null,_0x137461['replyTo']||null)));}else{if(Array[_0x464bec(0x621)](_0x137461[_0x464bec(0xc83)]))_0x137461['comments'][_0x464bec(0xd6a)](_0x2d6292=>{const _0x36b7a9=_0x464bec;typeof _0x2d6292===_0x36b7a9(0x9de)&&_0x2d6292[_0x36b7a9(0x7da)]()&&_0x48ddcb['comments'][_0x36b7a9(0x2d6)](_0x108080(_0x2d6292,null,_0x137461[_0x36b7a9(0x108)]||null));});else typeof _0x137461['commentText']===_0x464bec(0x9de)&&_0x137461[_0x464bec(0x11d0)][_0x464bec(0x7da)]()&&_0x48ddcb[_0x464bec(0xc83)][_0x464bec(0x2d6)](_0x108080(_0x137461['commentText'],null,_0x137461[_0x464bec(0x108)]||null));}await _0x2a2987['qzonePosts']['update'](_0x48ddcb['id'],{'comments':_0x48ddcb[_0x464bec(0xc83)]}),_0x3d400b(_0x38b5ff+0x1),console[_0x464bec(0x51f)](_0x464bec(0x452)+_0xd64778[_0x464bec(0x578)]+_0x464bec(0x410)+_0x137461[_0x464bec(0x337)]);if(!_0xd64778[_0x464bec(0xfe)])_0xd64778[_0x464bec(0xfe)]={};_0xd64778[_0x464bec(0xfe)][_0x137461[_0x464bec(0x337)]]=Date[_0x464bec(0x6ee)]();}continue;}case _0x464bec(0x95e):!_0x3b6ec9[_0x464bec(0x1f3)]&&!_0x3b6ec9['isAwaitingResponse']&&(_0x3b6ec9['isAwaitingResponse']=!![],_0x3b6ec9[_0x464bec(0x7bc)]=_0x32a747,_0x3b6ec9['isGroupCall']=![],_0x3b6ec9['callRequester']=_0xd64778[_0x464bec(0x578)],_0x47174c());break;default:console[_0x464bec(0x54a)](_0x464bec(0x5d4)+_0xd64778[_0x464bec(0x578)]+_0x464bec(0xe8a),_0x137461[_0x464bec(0x52a)]);break;case _0x464bec(0x3c7):{const _0x1a5a39=_0x137461[_0x464bec(0x578)],_0x2f88b4=_0xd64778[_0x464bec(0x2ea)]['aiAvatarLibrary'][_0x464bec(0xd85)](_0x3da8f3=>_0x3da8f3[_0x464bec(0x578)]===_0x1a5a39);_0x2f88b4&&(_0xd64778[_0x464bec(0x2ea)]['aiAvatar']=_0x2f88b4[_0x464bec(0x11a)],await _0x4c9fe9(_0xd64778),visibleSystemMessage={'content':'['+_0xd64778[_0x464bec(0x578)]+_0x464bec(0x9c7)},console[_0x464bec(0x51f)](_0x464bec(0x452)+_0xd64778['name']+_0x464bec(0x588)));break;}}if(_0x248690){_0xd64778[_0x464bec(0x1294)][_0x464bec(0x2d6)](_0x248690),_0xd64778[_0x464bec(0xdc5)]=(_0xd64778[_0x464bec(0xdc5)]||0x0)+0x1;if(!_0x5594ba){let _0x177b53=_0x248690[_0x464bec(0x52a)]===_0x464bec(0x8f5)?'[图片]':_0x248690[_0x464bec(0xcbd)]||'';_0x451557(_0x32a747,_0x177b53),_0x5594ba=!![];}}}await _0x2a2987['chats'][_0x464bec(0xf36)](_0xd64778);}catch(_0x57cff3){console[_0x464bec(0x4d9)]('角色\x20\x22'+_0xd64778[_0x464bec(0x578)]+_0x464bec(0xf76),_0x57cff3);}finally{_0x15197e(_0x32a747,![]),_0x597ed7(),document[_0x464bec(0xc33)](_0x464bec(0x496))[_0x464bec(0x10d3)][_0x464bec(0x3af)](_0x464bec(0x1043))&&_0x14f3b0();}}async function _0x420617(_0x482a52){const _0x1ed48c=_0x247bea,_0x364b9e=_0x12493e[_0x1ed48c(0xc45)][_0x482a52];if(!_0x364b9e||!_0x364b9e['isGroup'])return;const _0x1fb41c=_0x364b9e[_0x1ed48c(0x2ea)]['actionCooldownMinutes']||0xa;if(_0x364b9e['lastActionTimestamp']){const _0x23ec6d=(Date[_0x1ed48c(0x6ee)]()-_0x364b9e[_0x1ed48c(0x87a)])/(0x3e8*0x3c);if(_0x23ec6d<_0x1fb41c){console[_0x1ed48c(0x51f)](_0x1ed48c(0xcc7)+_0x364b9e[_0x1ed48c(0x578)]+'\x22\x20处于行动冷却中，本次独立行动跳过。');return;}}const {proxyUrl:_0x351cf4,apiKey:_0x49b16d,model:_0x2b080f}=_0x12493e[_0x1ed48c(0xdd4)];if(!_0x351cf4||!_0x49b16d||!_0x2b080f)return;const _0x291050=_0x364b9e['settings']['myNickname']||'我',_0x25e631=new Date();let _0x552602;const _0x404a35=_0x364b9e[_0x1ed48c(0x1294)][_0x1ed48c(0x1054)](_0x5b1f0c=>!_0x5b1f0c[_0x1ed48c(0xd07)])[_0x1ed48c(0x111c)](-0x5),_0x39bb81=_0x404a35[_0x1ed48c(0xd85)](_0x52e804=>_0x52e804[_0x1ed48c(0x52a)]===_0x1ed48c(0xaa2)&&!_0x52e804['isFullyClaimed']);if(_0x39bb81){const _0x158914=_0x3fb61d(_0x364b9e,_0x39bb81[_0x1ed48c(0xe32)]);console[_0x1ed48c(0x51f)](_0x1ed48c(0xda4)+_0x364b9e[_0x1ed48c(0x578)]+'\x22\x20中有未领完的红包，正在生成抢红包指令...'),_0x552602=_0x1ed48c(0xbf2)+_0x158914+_0x1ed48c(0xd25)+_0x39bb81[_0x1ed48c(0x2f0)]+_0x1ed48c(0x427)+_0x39bb81[_0x1ed48c(0x2f0)]+_0x1ed48c(0x691);}else{let _0x5ac3fe='';const _0x4d351b=_0x364b9e[_0x1ed48c(0x2ea)]['timeZone']||_0x1ed48c(0x368),_0x4a0309=_0x25e631[_0x1ed48c(0x559)](_0x1ed48c(0x770),{'timeZone':_0x4d351b,'dateStyle':_0x1ed48c(0x12b6),'timeStyle':_0x1ed48c(0x1de)}),_0x5e4003=new Date(_0x25e631[_0x1ed48c(0x559)](_0x1ed48c(0xf4a),{'timeZone':_0x4d351b}));if(_0x364b9e[_0x1ed48c(0x2ea)][_0x1ed48c(0x6c7)]){const _0x594737=_0x364b9e[_0x1ed48c(0x1294)]['filter'](_0x85a9bc=>!_0x85a9bc['isHidden'])[_0x1ed48c(0x111c)](-0x1)[0x0];if(_0x594737){const _0x301066=new Date(_0x594737[_0x1ed48c(0x2f0)]),_0x579c96=(_0x25e631-_0x301066)/(0x3e8*0x3c);_0x579c96>0x3c?_0x5ac3fe='群里已经安静了\x20'+Math['round'](_0x579c96/0x3c)+_0x1ed48c(0x76f):_0x5ac3fe=_0x1ed48c(0x7ce)+Math[_0x1ed48c(0xcb5)](_0x579c96)+_0x1ed48c(0x104d);}else _0x5ac3fe='群里还没有任何消息。';}let _0xa1a85d=_0x1ed48c(0x79f);const _0x2a47f3=_0x364b9e['settings'][_0x1ed48c(0x660)]||0xa,_0x5daa57=_0x364b9e[_0x1ed48c(0x1294)]['filter'](_0xbc8bbe=>!_0xbc8bbe[_0x1ed48c(0xd07)])[_0x1ed48c(0x111c)](-_0x2a47f3);_0x5daa57[_0x1ed48c(0x79b)]>0x0&&(_0xa1a85d=_0x1ed48c(0x48c)+_0x5daa57[_0x1ed48c(0x9d5)](_0x6eef33=>{const _0x27499e=_0x1ed48c,_0x7c1087=_0x6eef33[_0x27499e(0x16d)]===_0x27499e(0x717)?_0x291050:_0x3fb61d(_0x364b9e,_0x6eef33[_0x27499e(0xe32)]),_0xfc73b8=String(_0x6eef33[_0x27499e(0xcbd)]||_0x6eef33[_0x27499e(0xf93)]||'')['substring'](0x0,0x32);return _0x7c1087+':\x20'+_0xfc73b8+_0x27499e(0xda0);})[_0x1ed48c(0x100b)]('\x0a'));const _0x4f8d6c=_0x364b9e[_0x1ed48c(0xd5b)]['map'](_0x9767fd=>_0x1ed48c(0x100f)+_0x9767fd['groupNickname']+_0x1ed48c(0xb14)+_0x9767fd[_0x1ed48c(0x776)]+_0x1ed48c(0x3ec)+_0x9767fd[_0x1ed48c(0x421)])[_0x1ed48c(0x100b)]('\x0a');let _0x4bab3f=_0x1ed48c(0x1258),_0x4a07a4=![];_0x364b9e[_0x1ed48c(0xd5b)][_0x1ed48c(0xd6a)](_0x155c13=>{const _0x2fe2d5=_0x1ed48c,_0x13f372=_0x12493e[_0x2fe2d5(0xc45)][_0x155c13['id']];_0x13f372&&_0x13f372[_0x2fe2d5(0x45b)]&&_0x13f372[_0x2fe2d5(0x45b)][_0x2fe2d5(0x79b)]>0x0&&(_0x4bab3f+=_0x2fe2d5(0x10ef)+_0x155c13['groupNickname']+_0x2fe2d5(0x10c4),_0x4bab3f+=_0x13f372[_0x2fe2d5(0x45b)][_0x2fe2d5(0x9d5)](_0x58f4fc=>'-\x20'+_0x58f4fc[_0x2fe2d5(0xcbd)])['join']('\x0a'),_0x4a07a4=!![]);});!_0x4a07a4&&(_0x4bab3f+='-\x20(暂无)');let _0x4262e6='';if(_0x364b9e[_0x1ed48c(0x2ea)][_0x1ed48c(0xeca)]&&_0x364b9e['settings'][_0x1ed48c(0xeca)][_0x1ed48c(0x79b)]>0x0){const _0x451a7e=_0x364b9e[_0x1ed48c(0x2ea)][_0x1ed48c(0xeca)][_0x1ed48c(0x9d5)](_0x560f45=>{const _0x331dd8=_0x1ed48c,_0x259154=_0x12493e[_0x331dd8(0x63a)][_0x331dd8(0xd85)](_0x1390ee=>_0x1390ee['id']===_0x560f45);if(!_0x259154||!Array[_0x331dd8(0x621)](_0x259154[_0x331dd8(0xcbd)]))return'';const _0x59ec0f=_0x259154[_0x331dd8(0xcbd)]['filter'](_0x163a9f=>_0x163a9f[_0x331dd8(0x95a)]!==![])[_0x331dd8(0x9d5)](_0x19f3ae=>{const _0x4897f0=_0x331dd8;let _0x1d9399=_0x4897f0(0xcdf)+(_0x19f3ae[_0x4897f0(0x8db)]||_0x4897f0(0x2cb))+'\x0a';return _0x19f3ae[_0x4897f0(0x1c6)][_0x4897f0(0x79b)]>0x0&&(_0x1d9399+=_0x4897f0(0x2ca)+_0x19f3ae['keys'][_0x4897f0(0x100b)](',\x20')+'\x0a'),_0x1d9399+=_0x4897f0(0xb02)+_0x19f3ae[_0x4897f0(0xcbd)],_0x1d9399;})['join']('');return _0x59ec0f?'\x0a\x0a##\x20世界书:\x20'+_0x259154['name']+'\x0a'+_0x59ec0f:'';})[_0x1ed48c(0x1054)](Boolean)[_0x1ed48c(0x100b)]('');_0x451a7e&&(_0x4262e6='#\x20---\x20世界书\x20(World\x20Book)\x20---\x0a#\x20【最高优先级规则：世界观设定】\x0a#\x20你【必须】将以下所有“世界书”中的设定，视为绝对的、不可动摇的背景事实。\x0a#\x20你的所有回复和行为都【绝对不能】与这些设定产生任何冲突。\x0a'+_0x451a7e+_0x1ed48c(0x442));}let _0x2c2ff1='';const _0xa8620e=_0x364b9e[_0x1ed48c(0x2ea)]['linkedMemoryCount']||0xa;if(_0x364b9e[_0x1ed48c(0x2ea)][_0x1ed48c(0x48b)]&&_0x364b9e[_0x1ed48c(0x2ea)][_0x1ed48c(0x48b)][_0x1ed48c(0x79b)]>0x0){const _0x36bd5a=_0x364b9e[_0x1ed48c(0x2ea)][_0x1ed48c(0x48b)]['map'](_0x54e269=>{const _0x105261=_0x1ed48c,_0x40027c=_0x12493e[_0x105261(0xc45)][_0x54e269];if(!_0x40027c)return null;const _0x369da5=_0x40027c[_0x105261(0x1294)][_0x105261(0x111c)](-0x1)[0x0];return{'chat':_0x40027c,'latestTimestamp':_0x369da5?_0x369da5[_0x105261(0x2f0)]:0x0};})[_0x1ed48c(0x1054)](Boolean);_0x36bd5a[_0x1ed48c(0xbb3)]((_0x4f0eee,_0xae28b6)=>_0xae28b6[_0x1ed48c(0xac6)]-_0x4f0eee[_0x1ed48c(0xac6)]),_0x2c2ff1+='\x0a\x0a#\x20参考记忆\x20(至关重要！群内角色必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你们拥有完整的共同记忆。)\x0a';for(const _0x2070cd of _0x36bd5a){const _0x16a981=_0x2070cd[_0x1ed48c(0x824)],_0xf0c851=_0x16a981[_0x1ed48c(0x80b)]?_0x1ed48c(0xbe0):_0x1ed48c(0x980),_0x408817=_0x2070cd[_0x1ed48c(0xac6)]>0x0?_0x1ed48c(0xdbf)+_0x3ce8f0(_0x2070cd['latestTimestamp'])+')':'';_0x2c2ff1+=_0x1ed48c(0x1221)+_0xf0c851+'“'+_0x16a981[_0x1ed48c(0x578)]+'”的参考记忆'+_0x408817+_0x1ed48c(0x347);const _0x3bc902=_0x16a981[_0x1ed48c(0x1294)][_0x1ed48c(0x111c)](-_0xa8620e),_0x2d06f2=_0x3bc902[_0x1ed48c(0x1054)](_0x4854ee=>!String(_0x4854ee[_0x1ed48c(0xcbd)])[_0x1ed48c(0x1d4)](_0x1ed48c(0xd84)));_0x2d06f2[_0x1ed48c(0x79b)]>0x0?_0x2d06f2[_0x1ed48c(0xd6a)](_0x16d52a=>{const _0x21632a=_0x1ed48c,_0x523e05=_0x16d52a['role']==='user'?_0x16a981[_0x21632a(0x2ea)][_0x21632a(0xbf6)]||'我':_0x16d52a[_0x21632a(0xe32)]||_0x16a981[_0x21632a(0x578)];let _0x4b188b=String(_0x16d52a['content']);if(_0x16d52a[_0x21632a(0x52a)]==='ai_image'||_0x16d52a[_0x21632a(0x52a)]===_0x21632a(0x142))_0x4b188b=_0x21632a(0x20d)+_0x16d52a[_0x21632a(0xcbd)]+']';else _0x16d52a[_0x21632a(0x52a)]===_0x21632a(0xb41)&&(_0x4b188b=_0x21632a(0x9b3)+_0x16d52a['content']+']');_0x2c2ff1+=_0x523e05+':\x20'+_0x4b188b+'\x0a';}):_0x2c2ff1+=_0x1ed48c(0xd03);}}const _0x32193f=await _0x2a2987[_0x1ed48c(0x110b)][_0x1ed48c(0xde3)](_0x1ed48c(0x2f0))[_0x1ed48c(0xc07)]()[_0x1ed48c(0xae4)](0x5)['toArray']();let _0x3e829d='';const _0x49fb73=new Set();for(const _0x479554 of _0x364b9e[_0x1ed48c(0xd5b)]){const _0x3f47ed=_0x12493e[_0x1ed48c(0xc45)][_0x479554['id']];if(_0x3f47ed){const _0x4042f8=_0x32f53c(_0x32193f,_0x3f47ed);_0x4042f8[_0x1ed48c(0xd6a)](_0x35f395=>_0x49fb73[_0x1ed48c(0xb9)](_0x35f395));}}const _0xc295e3=new Set(_0x364b9e['members'][_0x1ed48c(0x9d5)](_0x29cf09=>_0x29cf09[_0x1ed48c(0x776)])),_0xf146c4=[..._0x49fb73][_0x1ed48c(0x1054)](_0x1254f8=>{const _0x29771a=_0x1ed48c,_0x21bc4e=_0x1254f8[_0x29771a(0x615)]&&_0x1254f8['likes']['some'](_0x2abbb4=>_0xc295e3[_0x29771a(0xa7)](_0x2abbb4)),_0x2a9ee6=_0x1254f8[_0x29771a(0xc83)]&&_0x1254f8['comments'][_0x29771a(0xfa7)](_0x33f784=>typeof _0x33f784===_0x29771a(0xe37)&&_0xc295e3[_0x29771a(0xa7)](_0x33f784[_0x29771a(0xfd9)]));return!_0x21bc4e&&!_0x2a9ee6;});if(_0xf146c4[_0x1ed48c(0x79b)]>0x0){let _0x64a1ae='\x0a\x0a#\x20最近的动态列表\x20(供群内角色参考和评论):\x0a';for(const _0x3db6e1 of _0xf146c4){let _0xa99a68=_0x3db6e1['authorId']===_0x1ed48c(0x717)?_0x291050:_0x12493e[_0x1ed48c(0xc45)][_0x3db6e1[_0x1ed48c(0xd48)]]?.[_0x1ed48c(0x578)]||_0x1ed48c(0x941),_0x3b9ae6;if(_0x3db6e1[_0x1ed48c(0x52a)]==='repost'){const _0x31853c=_0x3db6e1['repostComment']?'并评论说：“'+_0x3db6e1['repostComment']+'”':'';let _0x2ab38c=_0x1ed48c(0x400);const _0x110677=_0x3db6e1['originalPost'][_0x1ed48c(0xd48)];if(_0x110677===_0x1ed48c(0x717))_0x2ab38c=_0x12493e[_0x1ed48c(0x76c)][_0x1ed48c(0x66a)];else _0x12493e[_0x1ed48c(0xc45)][_0x110677]&&(_0x2ab38c=_0x12493e[_0x1ed48c(0xc45)][_0x110677][_0x1ed48c(0x578)]);let _0x276034;const _0x1757c9=_0x3db6e1['originalPost'];if(_0x1757c9['type']===_0x1ed48c(0x1bb))_0x276034=_0x1ed48c(0xe18)+(_0x1757c9[_0x1ed48c(0x964)]||'')+'\x20(图片描述:\x20“'+(_0x1757c9[_0x1ed48c(0xc2e)]||'')[_0x1ed48c(0x1033)](0x0,0x28)+_0x1ed48c(0x565);else _0x1757c9[_0x1ed48c(0x52a)]===_0x1ed48c(0x6ed)?_0x276034=_0x1ed48c(0x1222)+(_0x1757c9['publicText']||'')+_0x1ed48c(0x5f3)+(_0x1757c9[_0x1ed48c(0x555)]||'')[_0x1ed48c(0x1033)](0x0,0x28)+_0x1ed48c(0x565):_0x276034='“'+(_0x1757c9[_0x1ed48c(0xcbd)]||'')[_0x1ed48c(0x1033)](0x0,0x28)+_0x1ed48c(0x12a7);_0x3b9ae6=_0x1ed48c(0x29e)+_0x2ab38c+_0x1ed48c(0xe79)+_0x31853c+_0x1ed48c(0xd1f)+_0x276034+'】';}else{if(_0x3db6e1[_0x1ed48c(0x52a)]===_0x1ed48c(0x1bb))_0x3b9ae6=(_0x1ed48c(0x2c3)+_0x3db6e1[_0x1ed48c(0xc2e)]+_0x1ed48c(0x826)+(_0x3db6e1['publicText']||''))[_0x1ed48c(0x1033)](0x0,0x32)+'...';else _0x3db6e1[_0x1ed48c(0x52a)]===_0x1ed48c(0x6ed)?_0x3b9ae6=(_0x1ed48c(0x2cd)+_0x3db6e1['imageDescription']+_0x1ed48c(0x826)+(_0x3db6e1['publicText']||''))[_0x1ed48c(0x1033)](0x0,0x32)+'...':_0x3b9ae6=String(_0x3db6e1['publicText']||_0x3db6e1[_0x1ed48c(0xcbd)]||_0x1ed48c(0x6cc))['substring'](0x0,0x32)+'...';}_0x64a1ae+=_0x1ed48c(0x75d)+_0x3db6e1['id']+_0x1ed48c(0xab9)+_0xa99a68+_0x1ed48c(0x37f)+_0x3b9ae6+'\x22\x0a';if(_0x3db6e1[_0x1ed48c(0xc83)]&&_0x3db6e1[_0x1ed48c(0xc83)][_0x1ed48c(0x79b)]>0x0)for(const _0x55ee0a of _0x3db6e1[_0x1ed48c(0xc83)]){if(typeof _0x55ee0a===_0x1ed48c(0xe37)&&_0x55ee0a['commenterName']){const _0x92e253=_0x1353b6(_0x55ee0a[_0x1ed48c(0xfd9)]);let _0x30fe6d=_0x55ee0a[_0x1ed48c(0x127d)]?'[表情:\x20\x27'+_0x55ee0a[_0x1ed48c(0x127d)]+'\x27]':_0x55ee0a[_0x1ed48c(0x996)];_0x64a1ae+='\x20\x20-\x20评论:\x20'+_0x92e253+'\x20(本名:\x20'+_0x55ee0a[_0x1ed48c(0xfd9)]+_0x1ed48c(0x3ec)+_0x30fe6d+'\x0a';}}}_0x3e829d=_0x64a1ae;}const _0x39a5e5=_0x1c73eb(_0x364b9e,0x3,_0x1ed48c(0xb69)),_0x813b33=_0x1c73eb(_0x364b9e,0x6,_0x1ed48c(0xb69)),_0x580e05=_0x1c73eb(_0x364b9e,0x9,_0x1ed48c(0xb69)),_0x3d8254=_0x1c73eb(_0x364b9e,0x1,'days'),_0x54cf9c=_0x1c73eb(_0x364b9e,0x3,_0x1ed48c(0x7d7)),_0xeca4ac=_0x1c73eb(_0x364b9e,0x7,_0x1ed48c(0x7d7));let _0x512aaa='';if(_0x39a5e5||_0x813b33||_0x580e05||_0x3d8254||_0x54cf9c||_0xeca4ac){_0x512aaa+='\x0a#\x20智能总结\x20(基于不同时间维度的群聊回顾)\x0a';if(_0x39a5e5)_0x512aaa+=_0x39a5e5;if(_0x813b33)_0x512aaa+=_0x813b33;if(_0x580e05)_0x512aaa+=_0x580e05;if(_0x39a5e5||_0x813b33||_0x580e05)_0x512aaa+='\x0a';if(_0x3d8254)_0x512aaa+=_0x3d8254;if(_0x54cf9c)_0x512aaa+=_0x54cf9c;if(_0xeca4ac)_0x512aaa+=_0xeca4ac;}const _0x428571=_0x4d75d0(_0x364b9e);_0x552602=_0x1ed48c(0x72)+_0x364b9e['name']+'”的群聊。\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x364b9e[_0x1ed48c(0x2ea)][_0x1ed48c(0x6c7)]?'当前时间是\x20'+_0x4a0309+'。':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x5ac3fe?_0x5ac3fe+'\x20':'')+_0x1ed48c(0x7c0)+_0x4bab3f+_0x1ed48c(0x7a2)+_0x291050+'\x22\x20的消息。严格遵守每个角色的设定，禁止出戏。\x0a-请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的可选行动指令:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送文本**:\x20\x27{\x22type\x22:\x20\x22text\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22文本内容\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送表情**:\x20\x27{\x22type\x22:\x20\x22sticker\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送图片**:\x20\x27{\x22type\x22:\x20\x22ai_image\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22description\x22:\x20\x22图片的详细【中文】描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发起投票**:\x20\x27{\x22type\x22:\x20\x22poll\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22question\x22:\x20\x22...\x22,\x20\x22options\x22:\x20\x22...\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发起群视频**:\x20\x27{\x22type\x22:\x20\x22group_call_request\x22,\x20\x22name\x22:\x20\x22角色本名\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-如何正确使用“引用回复”功能：\x0a-\x20当你想明确地针对群内【任何成员】（包括用户或其他AI角色）之前的某一句具体的话进行回复时，你就应该使用这个功能。\x0a-\x20这会让你的回复上方出现一个灰色的小框，里面是被你引用的那句话，这样对话就不会乱了。\x0a-\x20指令格式:\x20\x27{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20(你想引用的那句话的时间戳),\x20\x22reply_content\x22:\x20\x22你的回复内容\x22}\x27\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20当前群聊信息\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**群名称**:\x20'+_0x364b9e[_0x1ed48c(0x578)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x4262e6+_0x1ed48c(0xa22)+(_0x364b9e[_0x1ed48c(0x45b)]&&_0x364b9e[_0x1ed48c(0x45b)][_0x1ed48c(0x79b)]>0x0?_0x364b9e[_0x1ed48c(0x45b)]['map'](_0x30d0a8=>'-\x20'+_0x30d0a8[_0x1ed48c(0xcbd)])[_0x1ed48c(0x100b)]('\x0a'):'-\x20(暂无)')+_0x1ed48c(0x38c)+_0x512aaa+_0x1ed48c(0x5bb)+_0x2c2ff1+_0x1ed48c(0x8f6)+_0x4f8d6c+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20可用表情包\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x428571+'\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20用户的角色\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**'+_0x291050+_0x1ed48c(0xe55)+_0x364b9e[_0x1ed48c(0x2ea)][_0x1ed48c(0xf75)]+_0x1ed48c(0x575)+_0xa1a85d+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20最近的动态列表\x20(供你参考和评论)\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x3e829d+_0x1ed48c(0x1107);}const _0x5bc5b3=_0x364b9e['history']['filter'](_0x266853=>!_0x266853[_0x1ed48c(0xd07)])[_0x1ed48c(0x111c)](-0xa),_0x495f4b=[{'role':_0x1ed48c(0x152),'content':_0x552602},..._0x5bc5b3[_0x1ed48c(0x9d5)](_0x2e1cb6=>{const _0x1eac1e=_0x1ed48c,_0x49be42=_0x2e1cb6[_0x1eac1e(0x16d)]===_0x1eac1e(0x717)?_0x291050:_0x3fb61d(_0x364b9e,_0x2e1cb6['senderName']);let _0x15b43d=_0x2e1cb6[_0x1eac1e(0xcbd)];if(_0x2e1cb6[_0x1eac1e(0x52a)]===_0x1eac1e(0x8f5)||_0x2e1cb6[_0x1eac1e(0x52a)]===_0x1eac1e(0x142))_0x15b43d=_0x1eac1e(0xe57)+_0x2e1cb6[_0x1eac1e(0xcbd)]+'\x27]';else{if(_0x2e1cb6[_0x1eac1e(0x52a)]==='voice_message')_0x15b43d=_0x1eac1e(0x97f)+_0x2e1cb6[_0x1eac1e(0xcbd)]+'\x27]';else typeof _0x15b43d!=='string'&&(_0x15b43d='[发送了一条复杂消息，如卡片或转账]');}return{'role':_0x1eac1e(0x717),'content':_0x49be42+':\x20'+_0x15b43d};})];try{const _0x2bafa2=[{'role':_0x1ed48c(0x717),'content':_0x552602}];let _0x26944c=_0x351cf4===GEMINI_API_URL,_0x2b5cce=_0x202ea1(_0x2b080f,_0x49b16d,_0x552602,_0x2bafa2);const _0x2077dd=_0x26944c?await fetch(_0x2b5cce[_0x1ed48c(0x11a)],_0x2b5cce[_0x1ed48c(0xa78)]):await fetch(_0x351cf4+'/v1/chat/completions',{'method':_0x1ed48c(0x90),'headers':{'Content-Type':_0x1ed48c(0xd74),'Authorization':_0x1ed48c(0xf20)+_0x49b16d},'body':JSON[_0x1ed48c(0xd27)]({'model':_0x2b080f,'messages':_0x2bafa2,'temperature':_0x12493e[_0x1ed48c(0x10f6)][_0x1ed48c(0xd52)]||0.9})});if(!_0x2077dd['ok'])throw new Error((await _0x2077dd[_0x1ed48c(0x79e)]())[_0x1ed48c(0x4d9)][_0x1ed48c(0xf93)]);const _0xf26a0c=await _0x2077dd[_0x1ed48c(0x79e)](),_0xc4669=_0x26944c?_0xf26a0c[_0x1ed48c(0x11de)][0x0]['content'][_0x1ed48c(0xec1)][0x0][_0x1ed48c(0x996)]:_0xf26a0c[_0x1ed48c(0x326)][0x0][_0x1ed48c(0xf93)][_0x1ed48c(0xcbd)],_0x3c9ee1=_0x4c5aa1(_0xc4669);if(!_0x3c9ee1||_0x3c9ee1[_0x1ed48c(0x79b)]===0x0){console[_0x1ed48c(0x54a)](_0x1ed48c(0xcc7)+_0x364b9e[_0x1ed48c(0x578)]+_0x1ed48c(0x120e));return;}let _0x469e88=Date[_0x1ed48c(0x6ee)](),_0x2b98c0=![],_0x17db16='',_0x2bfafb='';const _0x3dc715=[];for(const _0x237632 of _0x3c9ee1){const _0x6dfebb=String(_0x237632[_0x1ed48c(0xcbd)]||''),_0x8eabaa=_0x6dfebb[_0x1ed48c(0x7da)]()[_0x1ed48c(0xece)]('<')&&_0x6dfebb[_0x1ed48c(0x7da)]()[_0x1ed48c(0x5d5)]('>');if(_0x237632['type']===_0x1ed48c(0x996)&&!_0x8eabaa&&_0x6dfebb['includes']('\x0a')){const _0x141582=_0x6dfebb[_0x1ed48c(0x8d7)](/\n+/)[_0x1ed48c(0x1054)](_0xce213e=>_0xce213e[_0x1ed48c(0x7da)]());_0x141582[_0x1ed48c(0xd6a)](_0x4c6b83=>{const _0x560987=_0x1ed48c;_0x3dc715[_0x560987(0x2d6)]({..._0x237632,'content':_0x4c6b83});});}else _0x3dc715['push'](_0x237632);}for(const _0x3f8f8f of _0x3dc715){if(!_0x3f8f8f||!_0x3f8f8f[_0x1ed48c(0x52a)]||!_0x3f8f8f[_0x1ed48c(0x578)])continue;const _0x581cce=_0x3fb61d(_0x364b9e,_0x3f8f8f[_0x1ed48c(0x578)]);let _0x12c0ce=null,_0x41ffbc=null;const _0x45b7ca={'role':_0x1ed48c(0x376),'senderName':_0x3f8f8f[_0x1ed48c(0x578)],'timestamp':_0x469e88++};if(_0x3f8f8f['type']===_0x1ed48c(0x800)){const _0x356da2=_0x364b9e[_0x1ed48c(0x1294)][_0x1ed48c(0xd85)](_0x42eb42=>_0x42eb42[_0x1ed48c(0x2f0)]===_0x3f8f8f[_0x1ed48c(0x803)]);if(_0x356da2&&!_0x356da2[_0x1ed48c(0x1140)]&&!(_0x356da2[_0x1ed48c(0xea5)]&&_0x356da2[_0x1ed48c(0xea5)][_0x3f8f8f[_0x1ed48c(0x578)]])){let _0x1bf5a4=0x0;const _0x3d31a5=_0x356da2[_0x1ed48c(0x10ed)]-Object['values'](_0x356da2['claimedBy']||{})[_0x1ed48c(0xdf9)]((_0x5ef80f,_0x32e683)=>_0x5ef80f+_0x32e683,0x0),_0x15a7ae=_0x356da2[_0x1ed48c(0x109)]-Object[_0x1ed48c(0x1c6)](_0x356da2[_0x1ed48c(0xea5)]||{})[_0x1ed48c(0x79b)];if(_0x15a7ae>0x0){if(_0x15a7ae===0x1)_0x1bf5a4=_0x3d31a5;else{const _0x5f31a1=0.01,_0x573f0d=_0x3d31a5-(_0x15a7ae-0x1)*_0x5f31a1;_0x1bf5a4=Math['random']()*(_0x573f0d-_0x5f31a1)+_0x5f31a1;}_0x1bf5a4=parseFloat(_0x1bf5a4['toFixed'](0x2));if(!_0x356da2[_0x1ed48c(0xea5)])_0x356da2[_0x1ed48c(0xea5)]={};_0x356da2[_0x1ed48c(0xea5)][_0x3f8f8f[_0x1ed48c(0x578)]]=_0x1bf5a4,_0x364b9e[_0x1ed48c(0x1294)]['push']({'role':'system','type':_0x1ed48c(0xc05),'content':_0x581cce+'\x20领取了\x20'+_0x3fb61d(_0x364b9e,_0x356da2[_0x1ed48c(0xe32)])+_0x1ed48c(0xda9),'timestamp':Date[_0x1ed48c(0x6ee)]()});let _0x3221c0=_0x1ed48c(0xb47)+_0x581cce+_0x1ed48c(0x4e6)+_0x1bf5a4[_0x1ed48c(0xcab)](0x2)+_0x1ed48c(0x1250);if(Object[_0x1ed48c(0x1c6)](_0x356da2['claimedBy'])[_0x1ed48c(0x79b)]>=_0x356da2['count']){_0x356da2[_0x1ed48c(0x1140)]=!![],_0x364b9e['history']['push']({'role':_0x1ed48c(0x152),'type':'pat_message','content':_0x3fb61d(_0x364b9e,_0x356da2['senderName'])+_0x1ed48c(0x104e),'timestamp':Date[_0x1ed48c(0x6ee)]()+0x1});let _0x203916={'name':'','amount':-0x1};Object[_0x1ed48c(0x43e)](_0x356da2['claimedBy'])[_0x1ed48c(0xd6a)](([_0x3ba12d,_0x14472c])=>{const _0x5b9e78=_0x1ed48c;_0x14472c>_0x203916[_0x5b9e78(0x609)]&&(_0x203916={'name':_0x3ba12d,'amount':_0x14472c});});if(_0x203916[_0x1ed48c(0x578)]){const _0x519132=_0x3fb61d(_0x364b9e,_0x203916[_0x1ed48c(0x578)]);_0x3221c0+='\x20红包已被领完，手气王是\x20'+_0x519132+'！';}}_0x3221c0+=_0x1ed48c(0xcf5),_0x364b9e['history'][_0x1ed48c(0x2d6)]({'role':_0x1ed48c(0x152),'content':_0x3221c0,'timestamp':Date[_0x1ed48c(0x6ee)]()+0x2,'isHidden':!![]});}}_0x2b98c0=!![];continue;}switch(_0x3f8f8f[_0x1ed48c(0x52a)]){case _0x1ed48c(0x966):if(_0x3f8f8f[_0x1ed48c(0x127d)]){const _0x3895a1=_0x12493e[_0x1ed48c(0x454)][_0x1ed48c(0xd85)](_0x255fe3=>_0x255fe3[_0x1ed48c(0x578)]===_0x3f8f8f[_0x1ed48c(0x127d)]);_0x3895a1?_0x41ffbc={..._0x45b7ca,'type':'sticker','content':_0x3895a1[_0x1ed48c(0x11a)],'meaning':_0x3895a1[_0x1ed48c(0x578)]}:(console[_0x1ed48c(0x54a)](_0x1ed48c(0xa5b)+_0x3f8f8f[_0x1ed48c(0x127d)]+'\x22'),_0x41ffbc={..._0x45b7ca,'type':_0x1ed48c(0x996),'content':_0x1ed48c(0xa21)+_0x3f8f8f[_0x1ed48c(0x127d)]+']'});}else console['warn'](_0x1ed48c(0xd7),_0x3f8f8f),_0x41ffbc={..._0x45b7ca,'type':'sticker','content':_0x3f8f8f[_0x1ed48c(0x11a)],'meaning':_0x1ed48c(0x518)};break;case'qzone_post':const _0x43ee20={'type':_0x3f8f8f[_0x1ed48c(0x4bc)]||_0x1ed48c(0x5c4),'content':_0x3f8f8f[_0x1ed48c(0xcbd)],'timestamp':Date[_0x1ed48c(0x6ee)](),'authorId':_0x12493e[_0x1ed48c(0xc45)][Object['keys'](_0x12493e[_0x1ed48c(0xc45)])[_0x1ed48c(0xd85)](_0x5642d7=>_0x12493e[_0x1ed48c(0xc45)][_0x5642d7][_0x1ed48c(0x776)]===_0x3f8f8f[_0x1ed48c(0x578)])]?.['id']||_0x3f8f8f[_0x1ed48c(0x578)],'authorOriginalName':_0x3f8f8f['name'],'visibleGroupIds':null};await _0x2a2987[_0x1ed48c(0x110b)][_0x1ed48c(0xb9)](_0x43ee20),_0x3d400b(_0x38b5ff+0x1),_0x12c0ce={'content':'['+_0x581cce+_0x1ed48c(0x1084)};break;case _0x1ed48c(0x363):const _0x582e8a=await _0x2a2987[_0x1ed48c(0x110b)][_0x1ed48c(0xec0)](parseInt(_0x3f8f8f['postId']));if(_0x582e8a){if(!_0x582e8a[_0x1ed48c(0xc83)])_0x582e8a[_0x1ed48c(0xc83)]=[];_0x582e8a['comments'][_0x1ed48c(0x2d6)]({'commenterName':_0x3f8f8f[_0x1ed48c(0x578)],'text':_0x3f8f8f[_0x1ed48c(0x11d0)],'timestamp':Date[_0x1ed48c(0x6ee)]()}),await _0x2a2987[_0x1ed48c(0x110b)][_0x1ed48c(0xb07)](_0x582e8a['id'],{'comments':_0x582e8a[_0x1ed48c(0xc83)]}),_0x3d400b(_0x38b5ff+0x1),_0x12c0ce={'content':'['+_0x581cce+_0x1ed48c(0x635)};}break;case _0x1ed48c(0x1e2):const _0xe17ccc=await _0x2a2987[_0x1ed48c(0x110b)]['get'](parseInt(_0x3f8f8f[_0x1ed48c(0x337)]));if(_0xe17ccc){if(!_0xe17ccc['likes'])_0xe17ccc[_0x1ed48c(0x615)]=[];!_0xe17ccc[_0x1ed48c(0x615)][_0x1ed48c(0x1d4)](_0x3f8f8f[_0x1ed48c(0x578)])&&(_0xe17ccc[_0x1ed48c(0x615)][_0x1ed48c(0x2d6)](_0x3f8f8f[_0x1ed48c(0x578)]),await _0x2a2987[_0x1ed48c(0x110b)]['update'](_0xe17ccc['id'],{'likes':_0xe17ccc[_0x1ed48c(0x615)]}),_0x3d400b(_0x38b5ff+0x1),_0x12c0ce={'content':'['+_0x581cce+'\x20点赞了动态]'});}break;case'ai_image':_0x41ffbc={..._0x45b7ca,'type':_0x1ed48c(0x8f5),'content':_0x3f8f8f[_0x1ed48c(0x11ac)],'image_prompt':msgData['image_prompt']};break;default:if(_0x3f8f8f[_0x1ed48c(0x52a)]===_0x1ed48c(0x9ba)){const _0x2906ce=typeof _0x3f8f8f[_0x1ed48c(0x6c2)]===_0x1ed48c(0x9de)?_0x3f8f8f[_0x1ed48c(0x6c2)][_0x1ed48c(0x8d7)]('\x0a')[_0x1ed48c(0x1054)](_0x49eebc=>_0x49eebc[_0x1ed48c(0x7da)]()):Array['isArray'](_0x3f8f8f['options'])?_0x3f8f8f[_0x1ed48c(0x6c2)]:[];if(_0x2906ce[_0x1ed48c(0x79b)]<0x2)continue;_0x41ffbc={..._0x45b7ca,..._0x3f8f8f,'options':_0x2906ce,'votes':{},'isClosed':![]};}else{const _0x211a1f=_0x3f8f8f[_0x1ed48c(0xcbd)]||_0x3f8f8f[_0x1ed48c(0xf93)];_0x41ffbc={..._0x45b7ca,..._0x3f8f8f};if(_0x211a1f)_0x41ffbc[_0x1ed48c(0xcbd)]=_0x211a1f;}break;}if(_0x12c0ce)_0x364b9e[_0x1ed48c(0x1294)][_0x1ed48c(0x2d6)]({'role':_0x1ed48c(0x152),'type':_0x1ed48c(0xc05),'content':_0x12c0ce[_0x1ed48c(0xcbd)],'timestamp':_0x469e88++});else _0x41ffbc&&(_0x364b9e['history'][_0x1ed48c(0x2d6)](_0x41ffbc),!_0x2bfafb&&(_0x2bfafb=_0x581cce,_0x17db16=_0x41ffbc[_0x1ed48c(0x52a)]===_0x1ed48c(0x8f5)?'[图片]':_0x41ffbc[_0x1ed48c(0xcbd)]||'['+_0x41ffbc[_0x1ed48c(0x52a)]+']'));_0x2b98c0=!![];}_0x2b98c0&&(_0x364b9e[_0x1ed48c(0x87a)]=Date[_0x1ed48c(0x6ee)](),_0x364b9e[_0x1ed48c(0xdc5)]=(_0x364b9e[_0x1ed48c(0xdc5)]||0x0)+_0x3c9ee1[_0x1ed48c(0x1054)](_0xf5f4c0=>_0xf5f4c0[_0x1ed48c(0x52a)]!=='qzone_post'&&_0xf5f4c0[_0x1ed48c(0x52a)]!==_0x1ed48c(0x363)&&_0xf5f4c0[_0x1ed48c(0x52a)]!==_0x1ed48c(0x1e2))[_0x1ed48c(0x79b)],_0x2bfafb&&_0x17db16&&_0x451557(_0x482a52,_0x2bfafb+':\x20'+_0x17db16),await _0x2a2987[_0x1ed48c(0xc45)][_0x1ed48c(0xf36)](_0x364b9e));}catch(_0x42bbbb){console[_0x1ed48c(0x4d9)](_0x1ed48c(0xcc7)+_0x364b9e['name']+_0x1ed48c(0xf76),_0x42bbbb);}finally{_0x597ed7();}}function _0x813b8a(_0x3f116b,_0x55a976,_0x1854af){const _0x1c0068=_0x247bea,_0x57c11e=document[_0x1c0068(0xc33)](_0x1854af);if(!_0x57c11e)return;if(!_0x3f116b||_0x3f116b[_0x1c0068(0x7da)]()===''){_0x57c11e['innerHTML']='';return;}const _0x35e178=_0x3f116b[_0x1c0068(0xc12)](/\s*\.message-bubble\.user\s+([^{]+\{)/g,_0x55a976+_0x1c0068(0x139))[_0x1c0068(0xc12)](/\s*\.message-bubble\.ai\s+([^{]+\{)/g,_0x55a976+'\x20.message-bubble.ai\x20$1')[_0x1c0068(0xc12)](/\s*\.message-bubble\s+([^{]+\{)/g,_0x55a976+_0x1c0068(0xee9));_0x57c11e[_0x1c0068(0x102a)]=_0x35e178;}async function _0x20b86d(){const _0x46cca4=_0x247bea;if(!_0x12493e[_0x46cca4(0x7bc)])return;const _0x481ce7=_0x12493e[_0x46cca4(0xc45)][_0x12493e[_0x46cca4(0x7bc)]],_0x1d437a=document[_0x46cca4(0xc33)](_0x46cca4(0x438));if(!_0x1d437a)return;const _0x372ed9=document['querySelector'](_0x46cca4(0xa9a))?.['value']||_0x46cca4(0xfae),_0x344df1=document['getElementById'](_0x46cca4(0x4a8))[_0x46cca4(0x22a)],_0x38e109=document[_0x46cca4(0xc33)](_0x46cca4(0xf6c))[_0x46cca4(0x22a)],_0x5a0293=_0x481ce7[_0x46cca4(0x2ea)][_0x46cca4(0xc88)];_0x1d437a[_0x46cca4(0x85)][_0x46cca4(0x8a9)]=_0x372ed9,_0x1d437a[_0x46cca4(0x105d)][_0x46cca4(0x7f3)](_0x46cca4(0x101b),_0x344df1+'px');_0x5a0293&&_0x5a0293[_0x46cca4(0xece)](_0x46cca4(0x4c5))?(_0x1d437a[_0x46cca4(0x105d)]['backgroundImage']=_0x46cca4(0xb23)+_0x5a0293+')',_0x1d437a[_0x46cca4(0x105d)][_0x46cca4(0x1c5)]=_0x46cca4(0xaca)):(_0x1d437a['style']['backgroundImage']=_0x46cca4(0x854),_0x1d437a[_0x46cca4(0x105d)][_0x46cca4(0xc88)]=_0x5a0293||_0x46cca4(0xf78));_0x1d437a[_0x46cca4(0x102a)]='';const _0x5be1e1={'role':'ai','content':_0x46cca4(0x1266),'timestamp':0x1,'senderName':_0x481ce7[_0x46cca4(0x578)]},_0x404568=await _0x3f3a68(_0x5be1e1,_0x481ce7);if(_0x404568)_0x1d437a[_0x46cca4(0xf77)](_0x404568);const _0x5ef716={'role':_0x46cca4(0x717),'content':_0x46cca4(0x1e4),'timestamp':0x2},_0xadc885=await _0x3f3a68(_0x5ef716,_0x481ce7);if(_0xadc885)_0x1d437a[_0x46cca4(0xf77)](_0xadc885);const _0x3e9604=document[_0x46cca4(0x1292)](_0x46cca4(0x58c));_0x3e9604[_0x46cca4(0x105d)][_0x46cca4(0x4c1)]=_0x46cca4(0xdbc),_0x3e9604[_0x46cca4(0x11b0)]=_0x46cca4(0x3df),_0x1d437a[_0x46cca4(0xf77)](_0x3e9604);const _0x64ab37=document[_0x46cca4(0xc33)](_0x46cca4(0x2c5))[_0x46cca4(0x22a)],_0x506240=document[_0x46cca4(0xc33)]('lyrics-horizontal-pos')[_0x46cca4(0x22a)],_0x55b132=parseInt(document['getElementById'](_0x46cca4(0xfcc))[_0x46cca4(0x22a)])||0xa;_0x64ab37===_0x46cca4(0xcbe)?_0x3e9604['style'][_0x46cca4(0xcbe)]=_0x55b132+'px':_0x3e9604[_0x46cca4(0x105d)][_0x46cca4(0xbc2)]=_0x55b132+'px';switch(_0x506240){case _0x46cca4(0x9e2):_0x3e9604[_0x46cca4(0x105d)][_0x46cca4(0x9e2)]='15px';break;case _0x46cca4(0xc3f):_0x3e9604['style']['right']='15px';break;default:_0x3e9604[_0x46cca4(0x105d)][_0x46cca4(0x9e2)]='50%',_0x3e9604[_0x46cca4(0x105d)][_0x46cca4(0x404)]=_0x46cca4(0xab7);break;}_0x813b8a(_0x38e109,'#settings-preview-area',_0x46cca4(0xcb6));}async function _0x129cb0(){const _0x1c43d1=_0x247bea;await _0x1f78c5(),document['getElementById'](_0x1c43d1(0x276))[_0x1c43d1(0x10d3)]['add'](_0x1c43d1(0x143));}async function _0x1f78c5(){const _0x5986a=_0x247bea,_0x48d1d1=document[_0x5986a(0xc33)]('existing-groups-list'),_0xa92d65=await _0x2a2987[_0x5986a(0x54b)][_0x5986a(0xf15)]();_0x48d1d1['innerHTML']='',_0xa92d65['length']===0x0&&(_0x48d1d1[_0x5986a(0x102a)]=_0x5986a(0xb71)),_0xa92d65[_0x5986a(0xd6a)](_0x1cc44b=>{const _0x366524=_0x5986a,_0x451fda=document[_0x366524(0x1292)](_0x366524(0x58c));_0x451fda['className']=_0x366524(0x1151),_0x451fda['innerHTML']=_0x366524(0x2c1)+_0x1cc44b[_0x366524(0x578)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22delete-group-btn\x22\x20data-id=\x22'+_0x1cc44b['id']+_0x366524(0x5ac),_0x48d1d1[_0x366524(0xf77)](_0x451fda);});}async function _0x35c18b(){const _0x5a90ee=_0x247bea,_0x14cd01=document[_0x5a90ee(0xc33)](_0x5a90ee(0xf64)),_0x20b211=_0x14cd01[_0x5a90ee(0x22a)]['trim']();if(!_0x20b211){alert(_0x5a90ee(0x10b));return;}const _0x37e81b=await _0x2a2987['qzoneGroups'][_0x5a90ee(0x8b5)]('name')[_0x5a90ee(0x10bd)](_0x20b211)[_0x5a90ee(0x4e3)]();if(_0x37e81b){alert('分组\x20\x22'+_0x20b211+_0x5a90ee(0x8e7));return;}await _0x2a2987[_0x5a90ee(0x54b)][_0x5a90ee(0xb9)]({'name':_0x20b211}),_0x14cd01[_0x5a90ee(0x22a)]='',await _0x1f78c5();}async function _0x1f7043(_0x3b877b){const _0x58c18a=_0x247bea,_0x2119e1=await _0x270512(_0x58c18a(0x8d6),_0x58c18a(0x1194),{'confirmButtonClass':_0x58c18a(0xa2)});if(_0x2119e1){await _0x2a2987['qzoneGroups'][_0x58c18a(0x9ea)](_0x3b877b);const _0x5ed38b=await _0x2a2987[_0x58c18a(0xc45)][_0x58c18a(0x8b5)]('groupId')['equals'](_0x3b877b)[_0x58c18a(0xf15)]();for(const _0x49dae3 of _0x5ed38b){_0x49dae3['groupId']=null,await _0x2a2987['chats'][_0x58c18a(0xf36)](_0x49dae3);if(_0x12493e['chats'][_0x49dae3['id']])_0x12493e[_0x58c18a(0xc45)][_0x49dae3['id']][_0x58c18a(0x780)]=null;}await _0x1f78c5();}}function _0xeddcd0(_0x57773b){const _0x24f3d3=_0x247bea,_0x501d0e=_0x12493e[_0x24f3d3(0xc45)][_0x12493e[_0x24f3d3(0x7bc)]];document['getElementById'](_0x24f3d3(0x61d))[_0x24f3d3(0x105d)]['display']=_0x501d0e[_0x24f3d3(0x80b)]?_0x24f3d3(0xa20):_0x24f3d3(0x854);if(_0x4085b7)return;_0x464fa7=_0x57773b,document[_0x24f3d3(0xc33)]('message-actions-modal')[_0x24f3d3(0x10d3)][_0x24f3d3(0xb9)](_0x24f3d3(0x143));}function _0x13dccc(){const _0x4b8c03=_0x247bea;document[_0x4b8c03(0xc33)](_0x4b8c03(0x119e))[_0x4b8c03(0x10d3)][_0x4b8c03(0x2c7)](_0x4b8c03(0x143)),_0x464fa7=null;}async function _0x2189c1(){const _0xebf22=_0x247bea;if(!_0x464fa7)return;const _0x49d847=_0x464fa7,_0x400bfc=_0x12493e[_0xebf22(0xc45)][_0x12493e[_0xebf22(0x7bc)]],_0x11d7dc=_0x400bfc[_0xebf22(0x1294)][_0xebf22(0xd85)](_0x4e6505=>_0x4e6505[_0xebf22(0x2f0)]===_0x49d847);if(!_0x11d7dc)return;_0x13dccc();let _0x218d69;const _0x4231af=_0x11d7dc[_0xebf22(0x52a)]&&['voice_message','ai_image',_0xebf22(0xe86),'share_link'][_0xebf22(0x1d4)](_0x11d7dc[_0xebf22(0x52a)]);if(_0x4231af){let _0xe4a60b={'type':_0x11d7dc[_0xebf22(0x52a)]};if(_0x11d7dc[_0xebf22(0x52a)]===_0xebf22(0xb41))_0xe4a60b[_0xebf22(0xcbd)]=_0x11d7dc[_0xebf22(0xcbd)];else{if(_0x11d7dc['type']===_0xebf22(0x8f5))_0xe4a60b[_0xebf22(0x11ac)]=_0x11d7dc[_0xebf22(0xcbd)];else{if(_0x11d7dc[_0xebf22(0x52a)]===_0xebf22(0xe86))_0xe4a60b[_0xebf22(0x609)]=_0x11d7dc[_0xebf22(0x609)],_0xe4a60b['note']=_0x11d7dc['note'];else _0x11d7dc[_0xebf22(0x52a)]===_0xebf22(0xa6a)&&(_0xe4a60b['title']=_0x11d7dc[_0xebf22(0x874)],_0xe4a60b[_0xebf22(0x11ac)]=_0x11d7dc[_0xebf22(0x11ac)],_0xe4a60b[_0xebf22(0x50a)]=_0x11d7dc['source_name'],_0xe4a60b[_0xebf22(0xcbd)]=_0x11d7dc[_0xebf22(0xcbd)]);}}_0x218d69=JSON[_0xebf22(0xd27)](_0xe4a60b,null,0x2);}else typeof _0x11d7dc[_0xebf22(0xcbd)]===_0xebf22(0xe37)?_0x218d69=JSON[_0xebf22(0xd27)](_0x11d7dc['content'],null,0x2):_0x218d69=_0x11d7dc[_0xebf22(0xcbd)];const _0x5a96aa={'voice':{'type':_0xebf22(0xb41),'content':'在这里输入语音内容'},'image':{'type':'ai_image','description':'在这里输入图片描述'},'transfer':{'type':_0xebf22(0xe86),'amount':5.2,'note':_0xebf22(0x14c)},'link':{'type':'share_link','title':_0xebf22(0xb83),'description':'文章摘要...','source_name':'来源网站','content':_0xebf22(0x10b9)}},_0x73b7b2=_0xebf22(0x27e)+JSON[_0xebf22(0xd27)](_0x5a96aa[_0xebf22(0x1029)])+_0xebf22(0x85b)+JSON[_0xebf22(0xd27)](_0x5a96aa[_0xebf22(0x695)])+_0xebf22(0xe28)+JSON[_0xebf22(0xd27)](_0x5a96aa['transfer'])+_0xebf22(0x2ee)+JSON[_0xebf22(0xd27)](_0x5a96aa['link'])+_0xebf22(0xc13),_0x2ee991=await _0x1ca09c(_0xebf22(0x295),'在此修改，或点击上方按钮使用格式模板...',_0x218d69,_0xebf22(0x89c),_0x73b7b2);_0x2ee991!==null&&await _0x560089(_0x49d847,_0x2ee991,!![]);}async function _0x4262c9(){const _0x10f9bc=_0x247bea;if(!_0x464fa7)return;const _0x47604a=_0x12493e[_0x10f9bc(0xc45)][_0x12493e['activeChatId']],_0x466bdc=_0x47604a[_0x10f9bc(0x1294)][_0x10f9bc(0xd85)](_0x5f009d=>_0x5f009d[_0x10f9bc(0x2f0)]===_0x464fa7);if(!_0x466bdc)return;let _0x448b19;typeof _0x466bdc[_0x10f9bc(0xcbd)]===_0x10f9bc(0xe37)?_0x448b19=JSON[_0x10f9bc(0xd27)](_0x466bdc['content']):_0x448b19=String(_0x466bdc[_0x10f9bc(0xcbd)]);try{await navigator[_0x10f9bc(0xa15)][_0x10f9bc(0x882)](_0x448b19),await _0x2d7ddd(_0x10f9bc(0x123f),_0x10f9bc(0x56d));}catch(_0x56ce8a){await _0x2d7ddd(_0x10f9bc(0x11a7),_0x10f9bc(0xe34));}_0x13dccc();}async function _0x2d9227(){const _0x9fd43b=_0x247bea;if(!_0x464fa7)return;try{await navigator['clipboard'][_0x9fd43b(0x882)](_0x464fa7),await _0x2d7ddd(_0x9fd43b(0x123f),_0x9fd43b(0xfe1)+_0x464fa7+_0x9fd43b(0xaf));}catch(_0x18788c){await _0x2d7ddd('复制失败',_0x9fd43b(0xe34));}_0x13dccc();}function _0x230004(_0x28fd0c=''){const _0x49bd70=_0x247bea,_0x54136a=document[_0x49bd70(0x1292)]('div');_0x54136a['className']=_0x49bd70(0x9ef);const _0x1a0e7d={'voice':{'type':_0x49bd70(0xb41),'content':'在这里输入语音内容'},'image':{'type':_0x49bd70(0x8f5),'description':'在这里输入图片描述'},'transfer':{'type':_0x49bd70(0xe86),'amount':5.2,'note':_0x49bd70(0x14c)},'link':{'type':_0x49bd70(0xa6a),'title':_0x49bd70(0xb83),'description':_0x49bd70(0xd73),'source_name':_0x49bd70(0x238),'content':'文章完整内容...'},'offline':{'type':_0x49bd70(0x6bf),'content':_0x49bd70(0x1219)},'quote':{'type':_0x49bd70(0x4bf),'target_timestamp':0x499602d2,'reply_content':_0x49bd70(0x98f)}};return _0x54136a[_0x49bd70(0x102a)]=_0x49bd70(0x348)+_0x28fd0c+_0x49bd70(0xe1e)+JSON['stringify'](_0x1a0e7d[_0x49bd70(0x1029)])+_0x49bd70(0xd4d)+JSON[_0x49bd70(0xd27)](_0x1a0e7d['image'])+_0x49bd70(0xf37)+JSON[_0x49bd70(0xd27)](_0x1a0e7d[_0x49bd70(0xe86)])+_0x49bd70(0xeea)+JSON[_0x49bd70(0xd27)](_0x1a0e7d[_0x49bd70(0x858)])+_0x49bd70(0xc44)+JSON[_0x49bd70(0xd27)](_0x1a0e7d['offline'])+_0x49bd70(0x30d)+JSON[_0x49bd70(0xd27)](_0x1a0e7d[_0x49bd70(0xf74)])+_0x49bd70(0x1210),_0x54136a[_0x49bd70(0x977)](_0x49bd70(0xaad))[_0x49bd70(0x205)](_0x49bd70(0x335),()=>{const _0x1de632=_0x49bd70;document[_0x1de632(0x67a)](_0x1de632(0x5bd))[_0x1de632(0x79b)]>0x1?_0x54136a[_0x1de632(0x2c7)]():alert(_0x1de632(0x752));}),_0x54136a[_0x49bd70(0x67a)]('.format-btn')[_0x49bd70(0xd6a)](_0x5a6fb0=>{_0x5a6fb0['addEventListener']('click',()=>{const _0x1ca298=_0x26e9,_0x3cb44c=_0x5a6fb0[_0x1ca298(0x85)]['template'],_0x237ea3=_0x54136a[_0x1ca298(0x977)](_0x1ca298(0x89c));if(_0x3cb44c&&_0x237ea3)try{const _0x13a7ac=JSON[_0x1ca298(0x6b1)](_0x3cb44c);_0x237ea3['value']=JSON[_0x1ca298(0xd27)](_0x13a7ac,null,0x2),_0x237ea3[_0x1ca298(0xd59)]();}catch(_0x360ba7){console[_0x1ca298(0x4d9)](_0x1ca298(0x195),_0x360ba7);}});}),_0x54136a;}function _0x5db1c6(){const _0x3b7b81=_0x247bea;if(!_0x464fa7)return;const _0x76a324=_0x464fa7,_0x238aec=_0x12493e[_0x3b7b81(0xc45)][_0x12493e[_0x3b7b81(0x7bc)]],_0x5eb521=_0x238aec['history'][_0x3b7b81(0xd85)](_0x1e97be=>_0x1e97be['timestamp']===_0x76a324);if(!_0x5eb521)return;_0x13dccc();const _0x221304=document[_0x3b7b81(0xc33)](_0x3b7b81(0x1046)),_0x14facd=document['getElementById'](_0x3b7b81(0x23c));_0x14facd[_0x3b7b81(0x102a)]='';let _0x1ee386;if(_0x5eb521[_0x3b7b81(0xf74)]){const _0x53c725={'type':_0x3b7b81(0x4bf),'target_timestamp':_0x5eb521[_0x3b7b81(0xf74)]['timestamp'],'reply_content':_0x5eb521[_0x3b7b81(0xcbd)]};_0x1ee386=JSON['stringify'](_0x53c725,null,0x2);}else{if(_0x5eb521['type']&&['voice_message','ai_image',_0x3b7b81(0xe86),'offline_text',_0x3b7b81(0xa6a)]['includes'](_0x5eb521[_0x3b7b81(0x52a)])){let _0x46965e={'type':_0x5eb521[_0x3b7b81(0x52a)]};if(_0x5eb521['type']==='voice_message')_0x46965e['content']=_0x5eb521[_0x3b7b81(0xcbd)];else{if(_0x5eb521[_0x3b7b81(0x52a)]===_0x3b7b81(0x8f5))_0x46965e[_0x3b7b81(0x11ac)]=_0x5eb521[_0x3b7b81(0xcbd)];else{if(_0x5eb521[_0x3b7b81(0x52a)]===_0x3b7b81(0xe86))_0x46965e[_0x3b7b81(0x609)]=_0x5eb521[_0x3b7b81(0x609)],_0x46965e[_0x3b7b81(0x164)]=_0x5eb521[_0x3b7b81(0x164)];else{if(_0x5eb521['type']===_0x3b7b81(0x6bf))_0x5eb521[_0x3b7b81(0xcbd)]?_0x46965e[_0x3b7b81(0xcbd)]=_0x5eb521['content']:(_0x46965e[_0x3b7b81(0x156)]=_0x5eb521['dialogue'],_0x46965e[_0x3b7b81(0x11ac)]=_0x5eb521[_0x3b7b81(0x11ac)]);else _0x5eb521[_0x3b7b81(0x52a)]===_0x3b7b81(0xa6a)&&(_0x46965e[_0x3b7b81(0x874)]=_0x5eb521[_0x3b7b81(0x874)],_0x46965e[_0x3b7b81(0x11ac)]=_0x5eb521['description'],_0x46965e['source_name']=_0x5eb521['source_name'],_0x46965e[_0x3b7b81(0xcbd)]=_0x5eb521['content']);}}}_0x1ee386=JSON[_0x3b7b81(0xd27)](_0x46965e,null,0x2);}else typeof _0x5eb521[_0x3b7b81(0xcbd)]===_0x3b7b81(0xe37)?_0x1ee386=JSON[_0x3b7b81(0xd27)](_0x5eb521[_0x3b7b81(0xcbd)],null,0x2):_0x1ee386=_0x5eb521['content'];}const _0x5498f4=_0x230004(_0x1ee386);_0x14facd['appendChild'](_0x5498f4);const _0x371ef5=document[_0x3b7b81(0xc33)](_0x3b7b81(0xcbc)),_0x33c1c4=_0x371ef5[_0x3b7b81(0xbc5)](!![]);_0x371ef5[_0x3b7b81(0x1053)][_0x3b7b81(0xcaa)](_0x33c1c4,_0x371ef5),_0x33c1c4[_0x3b7b81(0x205)](_0x3b7b81(0x335),()=>{const _0x21e7f4=_0x3b7b81,_0xb1c06b=_0x230004();_0x14facd['appendChild'](_0xb1c06b),_0xb1c06b[_0x21e7f4(0x977)](_0x21e7f4(0x89c))['focus']();});const _0x64521a=document['getElementById'](_0x3b7b81(0x73d)),_0x3b8bc3=_0x64521a[_0x3b7b81(0xbc5)](!![]);_0x64521a[_0x3b7b81(0x1053)][_0x3b7b81(0xcaa)](_0x3b8bc3,_0x64521a),_0x3b8bc3[_0x3b7b81(0x205)](_0x3b7b81(0x335),()=>{const _0x215363=_0x3b7b81;_0x221304[_0x215363(0x10d3)][_0x215363(0x2c7)](_0x215363(0x143));});const _0x50bd88=document[_0x3b7b81(0xc33)](_0x3b7b81(0xa44)),_0x522c55=_0x50bd88[_0x3b7b81(0xbc5)](!![]);_0x50bd88['parentNode'][_0x3b7b81(0xcaa)](_0x522c55,_0x50bd88),_0x522c55[_0x3b7b81(0x205)](_0x3b7b81(0x335),()=>{_0x560089(_0x76a324);}),_0x221304[_0x3b7b81(0x10d3)][_0x3b7b81(0xb9)](_0x3b7b81(0x143));}async function _0x4262c9(){const _0x8e2651=_0x247bea;if(!_0x464fa7)return;const _0x27d310=_0x12493e[_0x8e2651(0xc45)][_0x12493e[_0x8e2651(0x7bc)]],_0x55b8d0=_0x27d310[_0x8e2651(0x1294)][_0x8e2651(0xd85)](_0x3ce41a=>_0x3ce41a[_0x8e2651(0x2f0)]===_0x464fa7);if(!_0x55b8d0)return;let _0xeca44a;if(_0x55b8d0[_0x8e2651(0x52a)]==='offline_text')_0x55b8d0[_0x8e2651(0xcbd)]?_0xeca44a=_0x55b8d0[_0x8e2651(0xcbd)]:_0xeca44a='「'+(_0x55b8d0[_0x8e2651(0x156)]||'')+'」\x0a'+(_0x55b8d0[_0x8e2651(0x11ac)]||'');else typeof _0x55b8d0['content']===_0x8e2651(0xe37)?_0xeca44a=JSON[_0x8e2651(0xd27)](_0x55b8d0[_0x8e2651(0xcbd)]):_0xeca44a=String(_0x55b8d0[_0x8e2651(0xcbd)]);try{await navigator[_0x8e2651(0xa15)][_0x8e2651(0x882)](_0xeca44a),await _0x2d7ddd(_0x8e2651(0x123f),_0x8e2651(0x56d));}catch(_0x3249c9){await _0x2d7ddd(_0x8e2651(0x11a7),'无法访问剪贴板。');}_0x13dccc();}function _0x1b7002(_0x4e9dea){const _0x42d9ee=_0x247bea,_0x3d2741=_0x4e9dea[_0x42d9ee(0x7da)]();if(_0x3d2741['startsWith']('{')&&_0x3d2741[_0x42d9ee(0x5d5)]('}'))try{const _0x4b5874=JSON[_0x42d9ee(0x6b1)](_0x3d2741);if(_0x4b5874['type'])return _0x4b5874;}catch(_0x5b48f1){}if(_0x301121['test'](_0x3d2741))return{'type':_0x42d9ee(0x966),'content':_0x3d2741};return{'type':'text','content':_0x3d2741};}async function _0x560089(_0x3ff87c,_0x1d9084=null){const _0x4c87a5=_0x247bea;if(!_0x3ff87c)return;const _0x36e31a=_0x12493e['chats'][_0x12493e['activeChatId']],_0x8ed8db=_0x36e31a[_0x4c87a5(0x1294)][_0x4c87a5(0xce9)](_0x31ff3d=>_0x31ff3d[_0x4c87a5(0x2f0)]===_0x3ff87c);if(_0x8ed8db===-0x1)return;const _0x571aa4=_0x36e31a[_0x4c87a5(0x1294)][_0x8ed8db];let _0x5e71fb=[];const _0x5ae340=_0x1d9084!==null?[_0x1d9084]:Array[_0x4c87a5(0x301)](document[_0x4c87a5(0x67a)]('#message-editor-container\x20textarea'))[_0x4c87a5(0x9d5)](_0x54c031=>_0x54c031['value']);for(const _0x6b5a73 of _0x5ae340){if(!_0x6b5a73[_0x4c87a5(0x7da)]())continue;const _0x546c1e=_0x1b7002(_0x6b5a73['trim']()),_0x2dc232={'role':_0x571aa4['role'],'senderName':_0x571aa4[_0x4c87a5(0xe32)],'timestamp':_0x571aa4[_0x4c87a5(0x2f0)]};switch(_0x546c1e[_0x4c87a5(0x52a)]){case _0x4c87a5(0x996):_0x2dc232[_0x4c87a5(0x52a)]=_0x4c87a5(0x996),_0x2dc232[_0x4c87a5(0xcbd)]=_0x546c1e[_0x4c87a5(0xcbd)];break;case'offline_text':_0x2dc232['type']=_0x4c87a5(0x6bf);_0x546c1e[_0x4c87a5(0xcbd)]?_0x2dc232[_0x4c87a5(0xcbd)]=_0x546c1e[_0x4c87a5(0xcbd)]:(_0x2dc232[_0x4c87a5(0x156)]=_0x546c1e[_0x4c87a5(0x156)],_0x2dc232[_0x4c87a5(0x11ac)]=_0x546c1e['description']);break;case'quote_reply':_0x2dc232[_0x4c87a5(0x52a)]=_0x4c87a5(0x4bf),_0x2dc232[_0x4c87a5(0xcbd)]=_0x546c1e[_0x4c87a5(0xa32)];const _0x245d22=_0x36e31a['history'][_0x4c87a5(0xd85)](_0x3b9b48=>_0x3b9b48[_0x4c87a5(0x2f0)]===_0x546c1e[_0x4c87a5(0xdbb)]);if(_0x245d22){let _0x1efb19=_0x245d22['senderName'];_0x245d22[_0x4c87a5(0x16d)]===_0x4c87a5(0x717)&&(_0x1efb19=_0x12493e[_0x4c87a5(0x76c)][_0x4c87a5(0x66a)]||_0x4c87a5(0x10d0)),_0x2dc232['quote']={'timestamp':_0x546c1e[_0x4c87a5(0xdbb)],'senderName':_0x1efb19,'content':String(_0x245d22['content']||'')};}else _0x2dc232['quote']={'timestamp':_0x546c1e[_0x4c87a5(0xdbb)],'senderName':'未知用户','content':'原始消息已删除或不存在'};break;case _0x4c87a5(0xb41):case'ai_image':case _0x4c87a5(0x142):_0x2dc232[_0x4c87a5(0x52a)]=_0x546c1e[_0x4c87a5(0x52a)],_0x2dc232[_0x4c87a5(0xcbd)]=_0x546c1e[_0x4c87a5(0xcbd)]||_0x546c1e[_0x4c87a5(0x11ac)];if(_0x546c1e[_0x4c87a5(0x127d)])_0x2dc232[_0x4c87a5(0x127d)]=_0x546c1e['meaning'];break;case'sticker':{_0x2dc232[_0x4c87a5(0x52a)]=_0x4c87a5(0x966);let _0x15c701=![];if(_0x546c1e[_0x4c87a5(0x127d)]){const _0x2df8a5=_0x12493e[_0x4c87a5(0x454)][_0x4c87a5(0xd85)](_0x1ad282=>_0x1ad282[_0x4c87a5(0x578)]===_0x546c1e[_0x4c87a5(0x127d)]);_0x2df8a5?(_0x2dc232[_0x4c87a5(0xcbd)]=_0x2df8a5[_0x4c87a5(0x11a)],_0x2dc232[_0x4c87a5(0x127d)]=_0x2df8a5['name'],console['log']('导演/编辑模式保存(Sticker):\x20使用了\x20meaning\x20查找'),_0x15c701=!![]):(_0x2dc232[_0x4c87a5(0x52a)]='text',_0x2dc232[_0x4c87a5(0xcbd)]=_0x4c87a5(0xa21)+_0x546c1e['meaning']+']',console['warn']('导演/编辑模式保存(Sticker):\x20提供了\x20meaning\x20但未找到对应表情:',_0x546c1e['meaning']),_0x15c701=!![]);}if(!_0x15c701&&_0x546c1e['url']){_0x2dc232[_0x4c87a5(0xcbd)]=_0x546c1e[_0x4c87a5(0x11a)];const _0x352bf0=_0x12493e[_0x4c87a5(0x454)][_0x4c87a5(0xd85)](_0x3563dc=>_0x3563dc[_0x4c87a5(0x11a)]===_0x546c1e[_0x4c87a5(0x11a)]);if(_0x546c1e['meaning']&&(!_0x352bf0||_0x352bf0[_0x4c87a5(0x578)]===_0x546c1e[_0x4c87a5(0x127d)]))_0x2dc232[_0x4c87a5(0x127d)]=_0x546c1e[_0x4c87a5(0x127d)];else _0x352bf0?_0x2dc232['meaning']=_0x352bf0[_0x4c87a5(0x578)]:_0x2dc232[_0x4c87a5(0x127d)]=_0x4c87a5(0x518);console[_0x4c87a5(0x51f)](_0x4c87a5(0x5cb),_0x2dc232[_0x4c87a5(0x127d)]),_0x15c701=!![];}if(!_0x15c701&&_0x546c1e[_0x4c87a5(0xcbd)]&&typeof _0x546c1e[_0x4c87a5(0xcbd)]===_0x4c87a5(0x9de)&&_0x301121[_0x4c87a5(0x677)](_0x546c1e[_0x4c87a5(0xcbd)])){_0x2dc232['content']=_0x546c1e[_0x4c87a5(0xcbd)];const _0x4efc95=_0x12493e[_0x4c87a5(0x454)]['find'](_0x2d7632=>_0x2d7632[_0x4c87a5(0x11a)]===_0x546c1e[_0x4c87a5(0xcbd)]);_0x2dc232[_0x4c87a5(0x127d)]=_0x4efc95?_0x4efc95['name']:'未知表情',console[_0x4c87a5(0x51f)](_0x4c87a5(0x1262),_0x2dc232[_0x4c87a5(0x127d)]),_0x15c701=!![];}if(!_0x15c701){console[_0x4c87a5(0x4d9)](_0x4c87a5(0x1a5),_0x546c1e);continue;}break;}case _0x4c87a5(0xe86):_0x2dc232[_0x4c87a5(0x52a)]='transfer',_0x2dc232[_0x4c87a5(0x609)]=_0x546c1e['amount'],_0x2dc232['note']=_0x546c1e['note'];break;case _0x4c87a5(0xa6a):_0x2dc232['type']=_0x4c87a5(0xa6a),_0x2dc232[_0x4c87a5(0x874)]=_0x546c1e[_0x4c87a5(0x874)],_0x2dc232[_0x4c87a5(0x11ac)]=_0x546c1e[_0x4c87a5(0x11ac)],_0x2dc232[_0x4c87a5(0x50a)]=_0x546c1e[_0x4c87a5(0x50a)],_0x2dc232[_0x4c87a5(0xcbd)]=_0x546c1e[_0x4c87a5(0xcbd)];break;default:Object[_0x4c87a5(0x26f)](_0x2dc232,_0x546c1e);break;}_0x5e71fb[_0x4c87a5(0x2d6)](_0x2dc232);}if(_0x5e71fb[_0x4c87a5(0x79b)]===0x0){document[_0x4c87a5(0xc33)](_0x4c87a5(0x1046))[_0x4c87a5(0x10d3)][_0x4c87a5(0x2c7)](_0x4c87a5(0x143));return;}_0x36e31a[_0x4c87a5(0x1294)][_0x4c87a5(0xbd1)](_0x8ed8db,0x1,..._0x5e71fb);let _0x119c19=_0x3ff87c;for(let _0xef26bd=_0x8ed8db;_0xef26bd<_0x36e31a['history']['length'];_0xef26bd++){_0x36e31a[_0x4c87a5(0x1294)][_0xef26bd][_0x4c87a5(0x2f0)]=_0x119c19,_0x119c19++;}await _0x2a2987[_0x4c87a5(0xc45)]['put'](_0x36e31a),document['getElementById']('message-editor-modal')['classList'][_0x4c87a5(0x2c7)](_0x4c87a5(0x143)),_0x1bbfd3(_0x12493e[_0x4c87a5(0x7bc)]),await _0x2d7ddd('成功',_0x4c87a5(0x462));}function _0x2ae560(_0x4e9316){const _0xe3e9d=_0x247bea;_0x206483=_0x4e9316,document['getElementById'](_0xe3e9d(0x11a6))[_0xe3e9d(0x10d3)][_0xe3e9d(0xb9)](_0xe3e9d(0x143));}function _0x35dc62(){const _0x19ec86=_0x247bea;document[_0x19ec86(0xc33)](_0x19ec86(0x11a6))['classList'][_0x19ec86(0x2c7)]('visible'),_0x206483=null;}async function _0x26291e(){const _0x62af5d=_0x247bea;if(!_0x206483)return;const _0x17aa97=_0x206483,_0x4f9aed=await _0x2a2987['qzonePosts'][_0x62af5d(0xec0)](_0x17aa97);if(!_0x4f9aed)return;_0x35dc62();let _0x1ec976;if(_0x4f9aed['type']==='shuoshuo')_0x1ec976=_0x4f9aed[_0x62af5d(0xcbd)];else{const _0x493395={'type':_0x4f9aed['type'],'publicText':_0x4f9aed[_0x62af5d(0x964)]||''};if(_0x4f9aed[_0x62af5d(0x52a)]===_0x62af5d(0x6ed))_0x493395[_0x62af5d(0x891)]=_0x4f9aed[_0x62af5d(0x891)],_0x493395['imageDescription']=_0x4f9aed[_0x62af5d(0x555)];else _0x4f9aed['type']===_0x62af5d(0x1bb)&&(_0x493395['hiddenContent']=_0x4f9aed[_0x62af5d(0xc2e)]);_0x1ec976=JSON[_0x62af5d(0xd27)](_0x493395,null,0x2);}const _0x43ef24={'shuoshuo':_0x62af5d(0x8d3),'image':{'type':_0x62af5d(0x6ed),'publicText':'','imageUrl':'https://...','imageDescription':''},'text_image':{'type':_0x62af5d(0x1bb),'publicText':'','hiddenContent':''}},_0x56eedd=_0x62af5d(0xef7)+JSON[_0x62af5d(0xd27)](_0x43ef24[_0x62af5d(0x695)])+_0x62af5d(0xe17)+JSON[_0x62af5d(0xd27)](_0x43ef24['text_image'])+'\x27>文字图</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x207ad7=await _0x1ca09c('编辑动态','在此修改内容...',_0x1ec976,_0x62af5d(0x89c),_0x56eedd);setTimeout(()=>{const _0x547922=_0x62af5d,_0x4b5494=document[_0x547922(0x977)]('#custom-modal-body\x20.format-btn[data-type=\x22text\x22]');_0x4b5494&&_0x4b5494[_0x547922(0x205)](_0x547922(0x335),()=>{const _0x329ea0=_0x547922,_0x5acbd5=document[_0x329ea0(0xc33)](_0x329ea0(0x878));_0x5acbd5[_0x329ea0(0x22a)]=_0x43ef24[_0x329ea0(0x5c4)],_0x5acbd5[_0x329ea0(0xd59)]();});},0x64),_0x207ad7!==null&&await _0x164741(_0x17aa97,_0x207ad7);}async function _0x164741(_0x40a855,_0x5bbbbd){const _0x5dd4ca=_0x247bea,_0x352c45=await _0x2a2987['qzonePosts'][_0x5dd4ca(0xec0)](_0x40a855);if(!_0x352c45)return;const _0x54c216=_0x5bbbbd['trim']();try{const _0x9f06d7=JSON[_0x5dd4ca(0x6b1)](_0x54c216);_0x352c45[_0x5dd4ca(0x52a)]=_0x9f06d7[_0x5dd4ca(0x52a)]||_0x5dd4ca(0x6ed),_0x352c45[_0x5dd4ca(0x964)]=_0x9f06d7['publicText']||'',_0x352c45[_0x5dd4ca(0x891)]=_0x9f06d7['imageUrl']||'',_0x352c45[_0x5dd4ca(0x555)]=_0x9f06d7[_0x5dd4ca(0x555)]||'',_0x352c45['hiddenContent']=_0x9f06d7[_0x5dd4ca(0xc2e)]||'',_0x352c45[_0x5dd4ca(0xcbd)]='';}catch(_0x309394){_0x352c45[_0x5dd4ca(0x52a)]=_0x5dd4ca(0x5c4),_0x352c45[_0x5dd4ca(0xcbd)]=_0x54c216,_0x352c45[_0x5dd4ca(0x964)]='',_0x352c45[_0x5dd4ca(0x891)]='',_0x352c45[_0x5dd4ca(0x555)]='',_0x352c45[_0x5dd4ca(0xc2e)]='';}await _0x2a2987['qzonePosts'][_0x5dd4ca(0xf36)](_0x352c45),await _0x14f3b0(),await _0x2d7ddd('成功',_0x5dd4ca(0xbb4));}async function _0x380724(){const _0x5d4aac=_0x247bea;if(!_0x206483)return;const _0x438d37=await _0x2a2987[_0x5d4aac(0x110b)]['get'](_0x206483);if(!_0x438d37)return;let _0x1e79e6=_0x438d37[_0x5d4aac(0xcbd)]||_0x438d37[_0x5d4aac(0x964)]||_0x438d37[_0x5d4aac(0xc2e)]||_0x438d37[_0x5d4aac(0x555)]||_0x5d4aac(0x97);try{await navigator[_0x5d4aac(0xa15)]['writeText'](_0x1e79e6),await _0x2d7ddd(_0x5d4aac(0x123f),_0x5d4aac(0x1d7));}catch(_0x1a8a82){await _0x2d7ddd(_0x5d4aac(0x11a7),'无法访问剪贴板。');}_0x35dc62();}let _0x53d82e=new Set();async function _0x9a04cf(){const _0xa0f25b=_0x247bea,_0x23419b=await _0x46f58a('创建群聊',[{'text':'创建普通群聊\x20(我参与)','value':_0xa0f25b(0xe25)},{'text':'创建旁观群聊\x20(我围观)','value':_0xa0f25b(0x3d7)}]);if(_0x23419b==='normal'){_0x53d82e[_0xa0f25b(0xebb)]();const _0x438054=document['getElementById']('confirm-contact-picker-btn'),_0x209875=_0x438054[_0xa0f25b(0xbc5)](!![]);_0x438054[_0xa0f25b(0x1053)]['replaceChild'](_0x209875,_0x438054),_0x209875[_0xa0f25b(0x205)](_0xa0f25b(0x335),_0x14fd47),await _0x131ec6(),_0x38f00f(_0xa0f25b(0x931));}else _0x23419b==='spectator'&&_0x31d0ee();}async function _0x31d0ee(){const _0x5dbd53=_0x247bea;_0x53d82e[_0x5dbd53(0xebb)]();const _0x59fea8=document['getElementById'](_0x5dbd53(0x1102)),_0x304593=_0x59fea8[_0x5dbd53(0xbc5)](!![]);_0x59fea8[_0x5dbd53(0x1053)][_0x5dbd53(0xcaa)](_0x304593,_0x59fea8),_0x304593['addEventListener'](_0x5dbd53(0x335),_0xf7632e),await _0x19509b(),_0x38f00f(_0x5dbd53(0x931));}async function _0x19509b(){const _0x2310e7=_0x247bea,_0x406dfc=document[_0x2310e7(0xc33)](_0x2310e7(0xf0));_0x406dfc[_0x2310e7(0x102a)]='';const _0x5cc638=Object[_0x2310e7(0xd28)](_0x12493e[_0x2310e7(0xc45)])[_0x2310e7(0x1054)](_0x2faed4=>!_0x2faed4[_0x2310e7(0x80b)]),_0x187c3f=await _0x2a2987[_0x2310e7(0xc61)][_0x2310e7(0xf15)]();if(_0x5cc638[_0x2310e7(0x79b)]===0x0&&_0x187c3f[_0x2310e7(0x79b)]===0x0){_0x406dfc['innerHTML']=_0x2310e7(0xf3d);return;}_0x5cc638[_0x2310e7(0xd6a)](_0x197cf5=>{const _0x531d25=_0x2310e7,_0x568ddc=document['createElement']('div');_0x568ddc[_0x531d25(0x84)]=_0x531d25(0x676),_0x568ddc[_0x531d25(0x85)]['contactId']=_0x197cf5['id'],_0x568ddc[_0x531d25(0x102a)]=_0x531d25(0x3f9)+(_0x197cf5[_0x531d25(0x2ea)]['aiAvatar']||_0x190acc)+_0x531d25(0x163)+_0x197cf5['name']+'\x20<small\x20style=\x22color:#888;\x22>(角色)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x406dfc['appendChild'](_0x568ddc);}),_0x187c3f[_0x2310e7(0xd6a)](_0x4cb84d=>{const _0x30958c=_0x2310e7,_0x3dc204=document[_0x30958c(0x1292)](_0x30958c(0x58c));_0x3dc204[_0x30958c(0x84)]=_0x30958c(0x676),_0x3dc204[_0x30958c(0x85)][_0x30958c(0xbcb)]=_0x4cb84d['id'],_0x3dc204[_0x30958c(0x85)][_0x30958c(0x70b)]=_0x30958c(0xa6f),_0x3dc204[_0x30958c(0x102a)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+(_0x4cb84d[_0x30958c(0xbac)]||_0x5b9dd3)+_0x30958c(0x163)+_0x4cb84d[_0x30958c(0x578)]+_0x30958c(0x46c),_0x406dfc[_0x30958c(0xf77)](_0x3dc204);}),_0x280d80();}async function _0xf7632e(){const _0x44fef9=_0x247bea;if(_0x53d82e['size']<0x2){alert('旁观群聊至少需要选择2个成员。');return;}const _0x57e475=await _0x1ca09c(_0x44fef9(0x595),'请输入群聊的名字',_0x44fef9(0x4e0));if(!_0x57e475||!_0x57e475[_0x44fef9(0x7da)]())return;const _0xd80c6=_0x44fef9(0xe9c)+Date[_0x44fef9(0x6ee)](),_0x1a6197=[],_0x497b1d=await _0x2a2987[_0x44fef9(0xc61)][_0x44fef9(0xf15)]();for(const _0x20f655 of _0x53d82e){const _0x1532e0=document[_0x44fef9(0x977)](_0x44fef9(0x726)+_0x20f655+'\x22]')[_0x44fef9(0x85)][_0x44fef9(0x70b)]===_0x44fef9(0xa6f);if(_0x1532e0){const _0x2210d9=_0x497b1d['find'](_0x30f29e=>_0x30f29e['id']===parseInt(_0x20f655));_0x2210d9&&_0x1a6197[_0x44fef9(0x2d6)]({'id':'npc_'+_0x2210d9['id'],'originalName':_0x2210d9[_0x44fef9(0x578)],'groupNickname':_0x2210d9[_0x44fef9(0x578)],'persona':_0x2210d9[_0x44fef9(0x421)],'avatar':_0x2210d9[_0x44fef9(0xbac)]||_0x5b9dd3,'isNpc':!![]});}else{const _0x55363e=_0x12493e[_0x44fef9(0xc45)][_0x20f655];_0x55363e&&_0x1a6197[_0x44fef9(0x2d6)]({'id':_0x20f655,'originalName':_0x55363e[_0x44fef9(0x776)],'groupNickname':_0x55363e[_0x44fef9(0x578)],'persona':_0x55363e[_0x44fef9(0x2ea)][_0x44fef9(0x679)],'avatar':_0x55363e[_0x44fef9(0x2ea)][_0x44fef9(0x18e)]||_0x190acc,'isNpc':![]});}}const _0x40556f={'id':_0xd80c6,'name':_0x57e475[_0x44fef9(0x7da)](),'isGroup':!![],'isSpectatorGroup':!![],'members':_0x1a6197,'settings':{'maxMemory':0xa,'groupAvatar':_0x2ff70a,'background':'','theme':'default','fontSize':0xd,'customCss':'','linkedWorldBookIds':[]},'history':[{'role':'system','content':_0x44fef9(0x343),'timestamp':Date[_0x44fef9(0x6ee)](),'isHidden':!![]}],'musicData':{'totalTime':0x0}};_0x12493e['chats'][_0xd80c6]=_0x40556f,await _0x2a2987[_0x44fef9(0xc45)]['put'](_0x40556f),await _0x597ed7(),_0x38f00f(_0x44fef9(0xe8f)),_0x157ff1(_0xd80c6);}async function _0x131ec6(){const _0x5093d9=_0x247bea,_0xc4d930=document[_0x5093d9(0xc33)]('contact-picker-list');_0xc4d930[_0x5093d9(0x102a)]='';const _0xe693dd=Object[_0x5093d9(0xd28)](_0x12493e['chats'])[_0x5093d9(0x1054)](_0x2ed123=>!_0x2ed123[_0x5093d9(0x80b)]),_0xf6c947=await _0x2a2987[_0x5093d9(0xc61)][_0x5093d9(0xf15)]();if(_0xe693dd[_0x5093d9(0x79b)]===0x0&&_0xf6c947[_0x5093d9(0x79b)]===0x0){_0xc4d930[_0x5093d9(0x102a)]=_0x5093d9(0x5e6);return;}_0xe693dd[_0x5093d9(0xd6a)](_0x5b6bca=>{const _0x24a413=_0x5093d9,_0x2713e4=document['createElement'](_0x24a413(0x58c));_0x2713e4[_0x24a413(0x84)]='contact-picker-item',_0x2713e4[_0x24a413(0x85)][_0x24a413(0xbcb)]=_0x5b6bca['id'],_0x2713e4[_0x24a413(0x102a)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+(_0x5b6bca[_0x24a413(0x2ea)]['aiAvatar']||_0x190acc)+_0x24a413(0x163)+_0x5b6bca['name']+'\x20<small\x20style=\x22color:#888;\x22>(角色)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0xc4d930[_0x24a413(0xf77)](_0x2713e4);}),_0xf6c947[_0x5093d9(0xd6a)](_0x3fddfe=>{const _0x2d716b=_0x5093d9,_0x106c72=document['createElement']('div');_0x106c72[_0x2d716b(0x84)]=_0x2d716b(0x676),_0x106c72[_0x2d716b(0x85)][_0x2d716b(0xbcb)]='npc_'+_0x3fddfe['id'],_0x106c72[_0x2d716b(0x102a)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+(_0x3fddfe[_0x2d716b(0xbac)]||_0x5b9dd3)+_0x2d716b(0x163)+_0x3fddfe[_0x2d716b(0x578)]+'\x20<small\x20style=\x22color:#007722;\x22>(NPC)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0xc4d930[_0x2d716b(0xf77)](_0x106c72);}),_0x280d80();}function _0x280d80(){const _0xfba87d=_0x247bea,_0x385da0=document[_0xfba87d(0xc33)](_0xfba87d(0x1102));_0x385da0['textContent']='完成('+_0x53d82e[_0xfba87d(0x57e)]+')',_0x385da0[_0xfba87d(0xfd8)]=_0x53d82e[_0xfba87d(0x57e)]<0x2;}async function _0x14fd47(){const _0x3ef915=_0x247bea;if(_0x53d82e[_0x3ef915(0x57e)]<0x2){alert(_0x3ef915(0xccd));return;}const _0xfa58a5=await _0x1ca09c(_0x3ef915(0x595),_0x3ef915(0xa06),'我们的群聊');if(!_0xfa58a5||!_0xfa58a5[_0x3ef915(0x7da)]())return;const _0x1b5a97=_0x3ef915(0xe9c)+Date['now'](),_0x18ef7e=[],_0x23eb7b=await _0x2a2987['npcs'][_0x3ef915(0xf15)]();for(const _0x3b9255 of _0x53d82e){if(_0x3b9255[_0x3ef915(0xece)](_0x3ef915(0xb90))){const _0x3a0e48=parseInt(_0x3b9255[_0x3ef915(0xc12)](_0x3ef915(0xb90),'')),_0xdaf742=_0x23eb7b['find'](_0x386f37=>_0x386f37['id']===_0x3a0e48);_0xdaf742&&_0x18ef7e['push']({'id':_0x3b9255,'originalName':_0xdaf742[_0x3ef915(0x578)],'groupNickname':_0xdaf742[_0x3ef915(0x578)],'persona':_0xdaf742[_0x3ef915(0x421)],'avatar':_0xdaf742[_0x3ef915(0xbac)]||_0x5b9dd3,'isNpc':!![]});}else{const _0x5f392c=_0x12493e[_0x3ef915(0xc45)][_0x3b9255];_0x5f392c&&_0x18ef7e['push']({'id':_0x3b9255,'originalName':_0x5f392c['originalName'],'groupNickname':_0x5f392c[_0x3ef915(0x578)],'persona':_0x5f392c[_0x3ef915(0x2ea)][_0x3ef915(0x679)],'avatar':_0x5f392c['settings'][_0x3ef915(0x18e)]||_0x190acc,'isNpc':![]});}}const _0x31cba6={'id':_0x1b5a97,'name':_0xfa58a5[_0x3ef915(0x7da)](),'isGroup':!![],'members':_0x18ef7e,'settings':{'myPersona':_0x3ef915(0x25f),'myNickname':'我','maxMemory':0xa,'groupAvatar':_0x2ff70a,'myAvatar':_0x200461,'background':'','theme':_0x3ef915(0xfae),'fontSize':0xd,'customCss':'','linkedWorldBookIds':[]},'history':[],'musicData':{'totalTime':0x0}};_0x12493e['chats'][_0x1b5a97]=_0x31cba6,await _0x2a2987['chats'][_0x3ef915(0xf36)](_0x31cba6),await _0x597ed7(),_0x38f00f(_0x3ef915(0xe8f)),_0x157ff1(_0x1b5a97);}function _0x2d6c16(){const _0x1b377e=_0x247bea;if(!_0x12493e[_0x1b377e(0x7bc)]||!_0x12493e[_0x1b377e(0xc45)][_0x12493e[_0x1b377e(0x7bc)]][_0x1b377e(0x80b)])return;_0x14af8a(),_0x38f00f(_0x1b377e(0x10ce));}function _0x14af8a(){const _0xb838d2=_0x247bea,_0x370f37=document[_0xb838d2(0xc33)](_0xb838d2(0x9a)),_0x87aafa=_0x12493e[_0xb838d2(0xc45)][_0x12493e[_0xb838d2(0x7bc)]];_0x370f37[_0xb838d2(0x102a)]='',_0x87aafa[_0xb838d2(0xd5b)][_0xb838d2(0xd6a)](_0x3a0ec9=>{const _0xdf0ca0=_0xb838d2,_0x373c91=document['createElement'](_0xdf0ca0(0x58c));_0x373c91[_0xdf0ca0(0x84)]=_0xdf0ca0(0x8ea),_0x373c91[_0xdf0ca0(0x102a)]=_0xdf0ca0(0x173)+_0x3a0ec9[_0xdf0ca0(0xbac)]+_0xdf0ca0(0x8bf)+_0x3a0ec9[_0xdf0ca0(0x6e2)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-member-btn\x22\x20data-member-id=\x22'+_0x3a0ec9['id']+'\x22\x20title=\x22移出群聊\x22>-</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x370f37[_0xdf0ca0(0xf77)](_0x373c91);});}async function _0x467e5c(_0x28ce6e){const _0x15873b=_0x247bea,_0x54b412=_0x12493e[_0x15873b(0xc45)][_0x12493e[_0x15873b(0x7bc)]],_0x1c1bb2=_0x54b412[_0x15873b(0xd5b)]['findIndex'](_0xfbcf99=>_0xfbcf99['id']===_0x28ce6e);if(_0x1c1bb2===-0x1)return;if(_0x54b412['members'][_0x15873b(0x79b)]<=0x2){alert(_0x15873b(0xb81));return;}const _0x379e07=_0x54b412[_0x15873b(0xd5b)][_0x1c1bb2][_0x15873b(0x6e2)],_0x33c760=await _0x270512(_0x15873b(0xc5f),_0x15873b(0x11f1)+_0x379e07+_0x15873b(0x10bc),{'confirmButtonClass':_0x15873b(0xa2)});_0x33c760&&(_0x54b412['members'][_0x15873b(0xbd1)](_0x1c1bb2,0x1),await _0x2a2987['chats'][_0x15873b(0xf36)](_0x54b412),_0x14af8a(),document[_0x15873b(0xc33)](_0x15873b(0xea0))[_0x15873b(0x335)]());}async function _0x286a3f(){const _0x329261=_0x247bea,_0x3fbbe3=document[_0x329261(0xc33)](_0x329261(0x1102)),_0x13d316=_0x3fbbe3[_0x329261(0xbc5)](!![]);_0x3fbbe3[_0x329261(0x1053)][_0x329261(0xcaa)](_0x13d316,_0x3fbbe3),_0x13d316[_0x329261(0x205)](_0x329261(0x335),_0x1d598b),await _0x5bf240(),_0x38f00f('contact-picker-screen');}async function _0x5bf240(){const _0x38c710=_0x247bea,_0x156540=document['getElementById'](_0x38c710(0xf0));_0x156540[_0x38c710(0x102a)]='',_0x53d82e['clear']();const _0x5d82d3=_0x12493e['chats'][_0x12493e[_0x38c710(0x7bc)]],_0x2e0a7c=new Set(_0x5d82d3['members'][_0x38c710(0x9d5)](_0x1460de=>_0x1460de['id'])),_0x1c4abf=Object[_0x38c710(0xd28)](_0x12493e[_0x38c710(0xc45)])[_0x38c710(0x1054)](_0x10a6b1=>!_0x10a6b1['isGroup']&&!_0x2e0a7c['has'](_0x10a6b1['id'])),_0x4cfe33=(await _0x2a2987[_0x38c710(0xc61)][_0x38c710(0xf15)]())[_0x38c710(0x1054)](_0x475731=>!_0x2e0a7c[_0x38c710(0xa7)](_0x38c710(0xb90)+_0x475731['id']));_0x1c4abf[_0x38c710(0x79b)]===0x0&&_0x4cfe33['length']===0x0?(_0x156540['innerHTML']=_0x38c710(0x10c0),document[_0x38c710(0xc33)]('confirm-contact-picker-btn')[_0x38c710(0x105d)][_0x38c710(0xf44)]=_0x38c710(0x854)):(document[_0x38c710(0xc33)](_0x38c710(0x1102))[_0x38c710(0x105d)][_0x38c710(0xf44)]='block',_0x1c4abf[_0x38c710(0xd6a)](_0x2e4349=>{const _0x42e049=_0x38c710,_0x1714b0=document[_0x42e049(0x1292)](_0x42e049(0x58c));_0x1714b0['className']=_0x42e049(0x676),_0x1714b0[_0x42e049(0x85)][_0x42e049(0xbcb)]=_0x2e4349['id'],_0x1714b0['dataset'][_0x42e049(0xcc1)]=_0x42e049(0x46a),_0x1714b0[_0x42e049(0x102a)]=_0x42e049(0xdfe)+(_0x2e4349[_0x42e049(0x2ea)][_0x42e049(0x18e)]||_0x190acc)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x2e4349[_0x42e049(0x578)]+_0x42e049(0xc7b),_0x156540[_0x42e049(0xf77)](_0x1714b0);}),_0x4cfe33['forEach'](_0x909aaa=>{const _0x1ee5d0=_0x38c710,_0x2b56e0=document[_0x1ee5d0(0x1292)](_0x1ee5d0(0x58c));_0x2b56e0[_0x1ee5d0(0x84)]=_0x1ee5d0(0x676),_0x2b56e0['dataset']['contactId']=_0x1ee5d0(0xb90)+_0x909aaa['id'],_0x2b56e0[_0x1ee5d0(0x85)][_0x1ee5d0(0xcc1)]='npc',_0x2b56e0[_0x1ee5d0(0x85)][_0x1ee5d0(0x29c)]=_0x909aaa['id'],_0x2b56e0[_0x1ee5d0(0x102a)]=_0x1ee5d0(0xdfe)+(_0x909aaa[_0x1ee5d0(0xbac)]||_0x5b9dd3)+_0x1ee5d0(0x958)+_0x909aaa[_0x1ee5d0(0x578)]+_0x1ee5d0(0x633),_0x156540['appendChild'](_0x2b56e0);})),_0x280d80();}async function _0x1d598b(){const _0x314c59=_0x247bea;if(_0x53d82e[_0x314c59(0x57e)]===0x0){alert(_0x314c59(0x8c0));return;}const _0x1c2e7b=_0x12493e[_0x314c59(0xc45)][_0x12493e[_0x314c59(0x7bc)]],_0x5b7206=await _0x2a2987[_0x314c59(0xc61)][_0x314c59(0xf15)]();for(const _0x40d002 of _0x53d82e){const _0x8fc652=document[_0x314c59(0x977)](_0x314c59(0x726)+_0x40d002+'\x22]');if(!_0x8fc652)continue;const _0x528de9=_0x8fc652[_0x314c59(0x85)][_0x314c59(0xcc1)];if(_0x528de9===_0x314c59(0x46a)){const _0x511ec9=_0x12493e[_0x314c59(0xc45)][_0x40d002];_0x511ec9&&_0x1c2e7b[_0x314c59(0xd5b)]['push']({'id':_0x40d002,'originalName':_0x511ec9[_0x314c59(0x776)],'groupNickname':_0x511ec9[_0x314c59(0x578)],'persona':_0x511ec9[_0x314c59(0x2ea)][_0x314c59(0x679)],'avatar':_0x511ec9[_0x314c59(0x2ea)]['aiAvatar']||_0x190acc,'isNpc':![]});}else{if(_0x528de9===_0x314c59(0x10b1)){const _0xb9d226=parseInt(_0x8fc652[_0x314c59(0x85)][_0x314c59(0x29c)]),_0x45bcb3=_0x5b7206[_0x314c59(0xd85)](_0x3c93c8=>_0x3c93c8['id']===_0xb9d226);_0x45bcb3&&_0x1c2e7b[_0x314c59(0xd5b)][_0x314c59(0x2d6)]({'id':_0x314c59(0xb90)+_0xb9d226,'originalName':_0x45bcb3[_0x314c59(0x578)],'groupNickname':_0x45bcb3['name'],'persona':_0x45bcb3[_0x314c59(0x421)],'avatar':_0x45bcb3['avatar']||_0x5b9dd3,'isNpc':!![]});}}}await _0x2a2987[_0x314c59(0xc45)][_0x314c59(0xf36)](_0x1c2e7b),_0x2d6c16();}function _0x23f96f(){_0x375377=!![],_0x4e0128(null);}function _0x4de697(_0x56d0ee,_0x4c45f6){const _0x36fa6c=setInterval(()=>{const _0x1bc5a1=_0x26e9,_0x122952=Date['now'](),_0xcf2d76=_0x4c45f6-_0x122952;if(_0xcf2d76<0x0){clearInterval(_0x36fa6c),_0x56d0ee[_0x1bc5a1(0x102a)]=_0x1bc5a1(0x102e);return;}const _0x51fc68=Math[_0x1bc5a1(0xcb5)](_0xcf2d76%(0x3e8*0x3c*0x3c)/(0x3e8*0x3c)),_0x5a5ff3=Math['floor'](_0xcf2d76%(0x3e8*0x3c)/0x3e8),_0x35ffcb=String(_0x51fc68)[_0x1bc5a1(0x70d)](0x2,'0'),_0x45ac70=String(_0x5a5ff3)[_0x1bc5a1(0x70d)](0x2,'0');_0x56d0ee[_0x1bc5a1(0x102a)]=_0x1bc5a1(0x76e)+_0x35ffcb[_0x1bc5a1(0x34e)](0x0)+'</span><span>'+_0x35ffcb[_0x1bc5a1(0x34e)](0x1)+_0x1bc5a1(0x1ed)+_0x45ac70[_0x1bc5a1(0x34e)](0x0)+_0x1bc5a1(0x1225)+_0x45ac70[_0x1bc5a1(0x34e)](0x1)+_0x1bc5a1(0xc70);},0x3e8);return _0x36fa6c;}function _0x1b43dc(){for(const _0x36e64f in _0x4bc591){clearInterval(_0x4bc591[_0x36e64f]);}_0x4bc591={};}async function _0xae7b2e(_0x22ac35){const _0x332d2d=_0x247bea,_0x5400a2=_0x12493e[_0x332d2d(0xc45)][_0x12493e[_0x332d2d(0x7bc)]];if(!_0x5400a2)return;const _0x4191ed=_0x5400a2[_0x332d2d(0x1294)][_0x332d2d(0xd85)](_0x2c3050=>_0x2c3050['timestamp']===_0x22ac35);if(!_0x4191ed||![_0x332d2d(0x71d),_0x332d2d(0x329)][_0x332d2d(0x1d4)](_0x4191ed[_0x332d2d(0x52a)])){console[_0x332d2d(0x4d9)]('showWaimaiDetails:\x20找不到消息或消息类型不正确',_0x22ac35);return;}let _0x1ccebc='';if(_0x4191ed['type']===_0x332d2d(0x71d)){let _0x4c7f0d;switch(_0x4191ed['status']){case'paid':const _0x1171b3=_0x4191ed['paidBy']||'对方',_0x5226d6=_0x3fb61d(_0x5400a2,_0x1171b3);_0x4c7f0d='由\x20'+_0x5226d6+_0x332d2d(0xb0f);break;case _0x332d2d(0x923):_0x4c7f0d='代付请求已被拒绝';break;default:_0x4c7f0d='等待对方处理';break;}_0x1ccebc='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20left;\x20font-size:\x2015px;\x20line-height:\x201.8;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>商品:</strong>\x20'+_0x4191ed[_0x332d2d(0x11d3)]+_0x332d2d(0x91a)+Number(_0x4191ed[_0x332d2d(0x609)])[_0x332d2d(0xcab)](0x2)+'<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>状态:</strong>\x20'+_0x4c7f0d+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}else{if(_0x4191ed[_0x332d2d(0x52a)]===_0x332d2d(0x329)){let _0x53464d,_0x5e283b;_0x5400a2[_0x332d2d(0x80b)]?(_0x53464d=_0x3fb61d(_0x5400a2,_0x4191ed[_0x332d2d(0xe32)]),_0x5e283b=_0x3fb61d(_0x5400a2,_0x4191ed[_0x332d2d(0xd4c)])):_0x4191ed['role']==='user'?(_0x53464d=_0x5400a2['settings']['myNickname']||'我',_0x5e283b=_0x5400a2['name']):(_0x53464d=_0x5400a2['name'],_0x5e283b=_0x5400a2[_0x332d2d(0x2ea)][_0x332d2d(0xbf6)]||'我'),_0x1ccebc=_0x332d2d(0x866)+_0x53464d+'<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>接收方:</strong>\x20'+_0x5e283b+_0x332d2d(0x99d)+_0x4191ed[_0x332d2d(0x11d3)]+'<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>金额:</strong>\x20¥'+Number(_0x4191ed[_0x332d2d(0x609)])[_0x332d2d(0xcab)](0x2)+_0x332d2d(0x117d);}}await _0x2d7ddd(_0x332d2d(0xdc),_0x1ccebc);}async function _0xff41ed(_0xf731f8,_0x1068ab){const _0x2b2cd6=_0x247bea,_0x4aff55=_0x12493e['chats'][_0x12493e[_0x2b2cd6(0x7bc)]];if(!_0x4aff55)return;const _0x5dabc5=_0x4aff55[_0x2b2cd6(0x1294)]['findIndex'](_0x4cdc99=>_0x4cdc99[_0x2b2cd6(0x2f0)]===_0xf731f8);if(_0x5dabc5===-0x1)return;const _0x41975f=_0x4aff55[_0x2b2cd6(0x1294)][_0x5dabc5];_0x41975f[_0x2b2cd6(0xbc8)]=_0x1068ab;let _0x1dac56;const _0xf65639=_0x4aff55[_0x2b2cd6(0x80b)]?_0x4aff55['settings'][_0x2b2cd6(0xbf6)]||'我':'我';_0x1068ab===_0x2b2cd6(0x5ec)?(_0x41975f[_0x2b2cd6(0x116d)]=_0xf65639,_0x1dac56=_0x2b2cd6(0xb47)+_0xf65639+_0x2b2cd6(0x5d0)+_0x41975f[_0x2b2cd6(0xe32)]+_0x2b2cd6(0xd0d)+_0xf731f8+_0x2b2cd6(0x284)):_0x1dac56=_0x2b2cd6(0xb47)+_0xf65639+_0x2b2cd6(0x556)+_0x41975f['senderName']+_0x2b2cd6(0x79)+_0xf731f8+_0x2b2cd6(0x78);const _0x2649f6={'role':_0x2b2cd6(0x152),'content':_0x1dac56,'timestamp':Date[_0x2b2cd6(0x6ee)](),'isHidden':!![]};_0x4aff55[_0x2b2cd6(0x1294)]['push'](_0x2649f6),await _0x2a2987[_0x2b2cd6(0xc45)][_0x2b2cd6(0xf36)](_0x4aff55),_0x1bbfd3(_0x12493e[_0x2b2cd6(0x7bc)]);}let _0x3b6ec9={'isActive':![],'isAwaitingResponse':![],'isGroupCall':![],'activeChatId':null,'initiator':null,'startTime':null,'participants':[],'isUserParticipating':!![],'callHistory':[],'preCallContext':''},_0x35a8fc=null;async function _0x973b3d(){const _0x1edb72=_0x247bea;if(!_0x12493e[_0x1edb72(0x7bc)]||_0x3b6ec9[_0x1edb72(0x1f3)]||_0x3b6ec9[_0x1edb72(0xd0)])return;const _0x2f65ad=_0x12493e[_0x1edb72(0xc45)][_0x12493e[_0x1edb72(0x7bc)]];_0x3b6ec9[_0x1edb72(0x1255)]=_0x2f65ad['isGroup'],_0x3b6ec9[_0x1edb72(0xd0)]=!![],_0x3b6ec9[_0x1edb72(0x1279)]=_0x1edb72(0x717),_0x3b6ec9['activeChatId']=_0x2f65ad['id'],_0x3b6ec9[_0x1edb72(0x1092)]=!![];_0x2f65ad[_0x1edb72(0x80b)]?(document['getElementById']('outgoing-call-avatar')['src']=_0x2f65ad[_0x1edb72(0x2ea)][_0x1edb72(0x1006)]||_0x200461,document[_0x1edb72(0xc33)](_0x1edb72(0xeeb))[_0x1edb72(0x11b0)]=_0x2f65ad[_0x1edb72(0x2ea)]['myNickname']||'我'):(document['getElementById'](_0x1edb72(0xc8c))[_0x1edb72(0x87b)]=_0x2f65ad[_0x1edb72(0x2ea)][_0x1edb72(0x18e)]||_0x190acc,document[_0x1edb72(0xc33)](_0x1edb72(0xeeb))['textContent']=_0x2f65ad[_0x1edb72(0x578)]);document[_0x1edb72(0x977)](_0x1edb72(0xb2f))['textContent']=_0x2f65ad[_0x1edb72(0x80b)]?_0x1edb72(0x914):_0x1edb72(0x549),_0x38f00f(_0x1edb72(0x674));const _0x44d8bb={'role':_0x1edb72(0x152),'content':_0x2f65ad[_0x1edb72(0x80b)]?'[系统提示：用户\x20('+(_0x2f65ad[_0x1edb72(0x2ea)][_0x1edb72(0xbf6)]||'我')+_0x1edb72(0xac1):'[系统提示：用户向你发起了视频通话请求。请根据你的人设，使用\x20\x22video_call_response\x22\x20指令，并设置\x20\x22decision\x22\x20为\x20\x22accept\x22\x20或\x20\x22reject\x22\x20来回应。]','timestamp':Date['now'](),'isHidden':!![]};_0x2f65ad[_0x1edb72(0x1294)][_0x1edb72(0x2d6)](_0x44d8bb),await _0x2a2987[_0x1edb72(0xc45)][_0x1edb72(0xf36)](_0x2f65ad),await _0x439587();}function _0x8b7bf9(){const _0xbced3c=_0x247bea,_0x18c231=_0x12493e['chats'][_0x3b6ec9[_0xbced3c(0x7bc)]];if(!_0x18c231)return;_0x3b6ec9[_0xbced3c(0x1f3)]=!![],_0x3b6ec9[_0xbced3c(0xd0)]=![],_0x3b6ec9[_0xbced3c(0xb2c)]=Date['now'](),_0x3b6ec9[_0xbced3c(0xe0c)]=[];const _0xbe8b1=_0x18c231[_0xbced3c(0x1294)][_0xbced3c(0x111c)](-0xa);_0x3b6ec9[_0xbced3c(0x723)]=_0xbe8b1[_0xbced3c(0x9d5)](_0xf46f4=>{const _0x4c5f48=_0xbced3c,_0x1e54a8=_0xf46f4['role']===_0x4c5f48(0x717)?_0x18c231[_0x4c5f48(0x2ea)][_0x4c5f48(0xbf6)]||'我':_0xf46f4['senderName']||_0x18c231[_0x4c5f48(0x578)];return _0x1e54a8+':\x20'+String(_0xf46f4['content'])['substring'](0x0,0x32)+_0x4c5f48(0xda0);})[_0xbced3c(0x100b)]('\x0a'),_0x4f5430(),document[_0xbced3c(0xc33)](_0xbced3c(0x8cb))['innerHTML']=_0xbced3c(0xdd9)+(_0x3b6ec9[_0xbced3c(0x1255)]?_0xbced3c(0x6f2):_0xbced3c(0x1b0))+_0xbced3c(0xb64),_0x38f00f(_0xbced3c(0x12c)),document[_0xbced3c(0xc33)](_0xbced3c(0x66d))[_0xbced3c(0x105d)][_0xbced3c(0xf44)]=_0x3b6ec9[_0xbced3c(0x1092)]?_0xbced3c(0xa20):_0xbced3c(0x854),document[_0xbced3c(0xc33)](_0xbced3c(0x4c8))[_0xbced3c(0x105d)][_0xbced3c(0xf44)]=_0x3b6ec9['isUserParticipating']?_0xbced3c(0x854):_0xbced3c(0xa20);if(_0x35a8fc)clearInterval(_0x35a8fc);_0x35a8fc=setInterval(_0x31e862,0x3e8),_0x31e862(),_0x1ff84d();}async function _0xb5f1de(){const _0x5aab9d=_0x247bea;if(!_0x3b6ec9[_0x5aab9d(0x1f3)])return;const _0x701b4e=Math[_0x5aab9d(0xcb5)]((Date['now']()-_0x3b6ec9['startTime'])/0x3e8),_0x2f151c=Math['floor'](_0x701b4e/0x3c)+'分'+_0x701b4e%0x3c+'秒',_0x17f494='通话结束，时长\x20'+_0x2f151c,_0x13bd44=_0x12493e[_0x5aab9d(0xc45)][_0x3b6ec9[_0x5aab9d(0x7bc)]];if(_0x13bd44){const _0xf3e647=[];_0x3b6ec9[_0x5aab9d(0x1255)]?(_0x3b6ec9[_0x5aab9d(0x10d4)]['forEach'](_0x45924d=>_0xf3e647[_0x5aab9d(0x2d6)]({'name':_0x45924d[_0x5aab9d(0x776)],'avatar':_0x45924d[_0x5aab9d(0xbac)]})),_0x3b6ec9['isUserParticipating']&&_0xf3e647[_0x5aab9d(0x613)]({'name':_0x13bd44[_0x5aab9d(0x2ea)][_0x5aab9d(0xbf6)]||'我','avatar':_0x13bd44[_0x5aab9d(0x2ea)][_0x5aab9d(0x1006)]||_0x200461})):(_0xf3e647[_0x5aab9d(0x2d6)]({'name':_0x13bd44[_0x5aab9d(0x578)],'avatar':_0x13bd44['settings'][_0x5aab9d(0x18e)]||_0x190acc}),_0xf3e647[_0x5aab9d(0x613)]({'name':'我','avatar':_0x13bd44[_0x5aab9d(0x2ea)][_0x5aab9d(0x1006)]||_0x190acc}));const _0x1edc05={'chatId':_0x3b6ec9[_0x5aab9d(0x7bc)],'timestamp':Date['now'](),'duration':_0x701b4e,'participants':_0xf3e647,'transcript':[..._0x3b6ec9[_0x5aab9d(0xe0c)]]};await _0x2a2987[_0x5aab9d(0x508)][_0x5aab9d(0xb9)](_0x1edc05),console[_0x5aab9d(0x51f)](_0x5aab9d(0x712),_0x1edc05);let _0x593bdc={'role':_0x3b6ec9['initiator']===_0x5aab9d(0x717)?'user':_0x5aab9d(0x376),'content':_0x17f494,'timestamp':Date[_0x5aab9d(0x6ee)]()};_0x13bd44['isGroup']&&_0x593bdc[_0x5aab9d(0x16d)]===_0x5aab9d(0x376)&&(_0x593bdc['senderName']=_0x3b6ec9[_0x5aab9d(0xbba)]||_0x13bd44[_0x5aab9d(0xd5b)][0x0]?.[_0x5aab9d(0x776)]||_0x13bd44[_0x5aab9d(0x578)]);_0x13bd44[_0x5aab9d(0x1294)]['push'](_0x593bdc);const _0x559472=_0x3b6ec9[_0x5aab9d(0xe0c)][_0x5aab9d(0x9d5)](_0x4150d6=>{const _0x347424=_0x5aab9d,_0x158ad1=_0x4150d6['role']==='user'?_0x13bd44[_0x347424(0x2ea)][_0x347424(0xbf6)]||'我':_0x4150d6[_0x347424(0xe32)];return _0x158ad1+':\x20'+_0x4150d6['content'];})['join']('\x0a');_0x32d54d(_0x13bd44['id'],_0x559472);const _0x50d240={'role':'system','content':_0x5aab9d(0x8fa),'timestamp':Date[_0x5aab9d(0x6ee)]()+0x1,'isHidden':!![]};_0x13bd44[_0x5aab9d(0x1294)][_0x5aab9d(0x2d6)](_0x50d240),await _0x2a2987[_0x5aab9d(0xc45)][_0x5aab9d(0xf36)](_0x13bd44);}clearInterval(_0x35a8fc),_0x35a8fc=null,_0x3b6ec9={'isActive':![],'isAwaitingResponse':![],'isGroupCall':![],'activeChatId':null,'initiator':null,'startTime':null,'participants':[],'isUserParticipating':!![],'callHistory':[],'preCallContext':''},_0x13bd44&&(_0x157ff1(_0x13bd44['id']),_0x439587());}function _0x4f5430(){const _0x51a4f4=_0x247bea,_0x3d7a16=document[_0x51a4f4(0xc33)](_0x51a4f4(0x11a2));_0x3d7a16['innerHTML']='';const _0x481456=_0x12493e['chats'][_0x3b6ec9[_0x51a4f4(0x7bc)]];if(!_0x481456)return;let _0x1884ec=[];_0x3b6ec9[_0x51a4f4(0x1255)]?(_0x1884ec=[..._0x3b6ec9[_0x51a4f4(0x10d4)]],_0x3b6ec9['isUserParticipating']&&_0x1884ec['unshift']({'id':_0x51a4f4(0x717),'name':_0x481456[_0x51a4f4(0x2ea)]['myNickname']||'我','avatar':_0x481456[_0x51a4f4(0x2ea)][_0x51a4f4(0x1006)]||_0x200461})):_0x1884ec[_0x51a4f4(0x2d6)]({'id':'ai','name':_0x481456[_0x51a4f4(0x578)],'avatar':_0x481456[_0x51a4f4(0x2ea)][_0x51a4f4(0x18e)]||_0x190acc}),_0x1884ec[_0x51a4f4(0xd6a)](_0x56049b=>{const _0x144077=_0x51a4f4,_0x55f9b3=document['createElement'](_0x144077(0x58c));_0x55f9b3['className']=_0x144077(0x1051),_0x55f9b3[_0x144077(0x85)][_0x144077(0xb50)]=_0x56049b['id'];const _0x4c707d=_0x56049b[_0x144077(0x6e2)]||_0x56049b[_0x144077(0x578)];_0x55f9b3[_0x144077(0x102a)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x56049b['avatar']+_0x144077(0xbbc)+_0x4c707d+_0x144077(0x51b)+_0x4c707d+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x3d7a16[_0x144077(0xf77)](_0x55f9b3);});}function _0x256897(){const _0x2a20a1=_0x247bea;if(!_0x3b6ec9['isActive']||_0x3b6ec9[_0x2a20a1(0x1092)])return;_0x3b6ec9[_0x2a20a1(0x1092)]=!![],_0x4f5430(),document[_0x2a20a1(0xc33)](_0x2a20a1(0x66d))[_0x2a20a1(0x105d)][_0x2a20a1(0xf44)]=_0x2a20a1(0xa20),document[_0x2a20a1(0xc33)]('join-call-btn')[_0x2a20a1(0x105d)][_0x2a20a1(0xf44)]='none',_0x1ff84d(_0x2a20a1(0xb8d));}function _0x31e862(){const _0x28a9c5=_0x247bea;if(!_0x3b6ec9[_0x28a9c5(0x1f3)])return;const _0x2e5013=Math[_0x28a9c5(0xcb5)]((Date[_0x28a9c5(0x6ee)]()-_0x3b6ec9[_0x28a9c5(0xb2c)])/0x3e8),_0x10feb6=Math[_0x28a9c5(0xcb5)](_0x2e5013/0x3c),_0x3cf472=_0x2e5013%0x3c;document[_0x28a9c5(0xc33)](_0x28a9c5(0xd81))[_0x28a9c5(0x11b0)]=String(_0x10feb6)[_0x28a9c5(0x70d)](0x2,'0')+':'+String(_0x3cf472)[_0x28a9c5(0x70d)](0x2,'0');}function _0x47174c(){const _0x2dc91e=_0x247bea,_0x1075aa=_0x12493e[_0x2dc91e(0xc45)][_0x12493e[_0x2dc91e(0x7bc)]];if(!_0x1075aa)return;if(_0x1075aa['isGroup']){const _0x335b5a=_0x3b6ec9['callRequester']||_0x1075aa['members'][0x0]?.[_0x2dc91e(0x578)]||_0x2dc91e(0x745);document[_0x2dc91e(0xc33)](_0x2dc91e(0x180))[_0x2dc91e(0x87b)]=_0x1075aa[_0x2dc91e(0x2ea)]['groupAvatar']||_0x2ff70a,document[_0x2dc91e(0xc33)](_0x2dc91e(0x8d2))['textContent']=_0x1075aa['name'],document['querySelector'](_0x2dc91e(0x6b5))['textContent']=_0x335b5a+_0x2dc91e(0x285);}else document[_0x2dc91e(0xc33)]('caller-avatar')['src']=_0x1075aa['settings'][_0x2dc91e(0x18e)]||_0x190acc,document[_0x2dc91e(0xc33)]('caller-name')[_0x2dc91e(0x11b0)]=_0x1075aa['name'],document[_0x2dc91e(0x977)](_0x2dc91e(0x6b5))[_0x2dc91e(0x11b0)]=_0x2dc91e(0x8cf);document['getElementById'](_0x2dc91e(0x148))[_0x2dc91e(0x10d3)]['add'](_0x2dc91e(0x143));}function _0x516ccf(){const _0x2b7dcf=_0x247bea;document[_0x2b7dcf(0xc33)]('incoming-call-modal')['classList']['remove'](_0x2b7dcf(0x143));}async function _0x1ff84d(_0x44b2bc=null){const _0x4d04aa=_0x247bea;if(!_0x3b6ec9[_0x4d04aa(0x1f3)])return;const _0x8168af=_0x12493e['chats'][_0x3b6ec9['activeChatId']],{proxyUrl:_0x49b563,apiKey:_0x5d5607,model:_0x56b50c}=_0x12493e[_0x4d04aa(0xdd4)],_0x33b14e=document[_0x4d04aa(0xc33)](_0x4d04aa(0x8cb)),_0xa4fe01=_0x8168af[_0x4d04aa(0x2ea)][_0x4d04aa(0xbf6)]||'我';let _0x55f7d0='';if(_0x8168af[_0x4d04aa(0x2ea)][_0x4d04aa(0xeca)]&&_0x8168af[_0x4d04aa(0x2ea)][_0x4d04aa(0xeca)][_0x4d04aa(0x79b)]>0x0){const _0x38f527=_0x8168af[_0x4d04aa(0x2ea)][_0x4d04aa(0xeca)]['map'](_0x5a32dd=>{const _0x3c36ff=_0x4d04aa,_0x58da28=_0x12493e['worldBooks'][_0x3c36ff(0xd85)](_0x3675c5=>_0x3675c5['id']===_0x5a32dd);return _0x58da28&&_0x58da28[_0x3c36ff(0xcbd)]?_0x3c36ff(0xc39)+_0x58da28['name']+'\x0a'+_0x58da28[_0x3c36ff(0xcbd)]:'';})['filter'](Boolean)[_0x4d04aa(0x100b)]('');_0x38f527&&(_0x55f7d0=_0x4d04aa(0x352)+_0x38f527+_0x4d04aa(0x442));}if(_0x44b2bc&&_0x3b6ec9[_0x4d04aa(0x1092)]){const _0x2803f0=Date[_0x4d04aa(0x6ee)](),_0x27ad86=document[_0x4d04aa(0x1292)](_0x4d04aa(0x58c));_0x27ad86['className']=_0x4d04aa(0x53b),_0x27ad86[_0x4d04aa(0x11b0)]=_0x44b2bc,_0x27ad86[_0x4d04aa(0x85)][_0x4d04aa(0x2f0)]=_0x2803f0,_0x29b870(_0x27ad86,()=>_0x279f3b(_0x2803f0)),_0x33b14e[_0x4d04aa(0xf77)](_0x27ad86),_0x33b14e[_0x4d04aa(0x1244)]=_0x33b14e[_0x4d04aa(0xa87)],_0x3b6ec9['callHistory']['push']({'role':'user','content':_0x44b2bc,'timestamp':_0x2803f0});}let _0x271fae;if(_0x3b6ec9[_0x4d04aa(0x1255)]){const _0x4e62e2=_0x3b6ec9[_0x4d04aa(0x10d4)][_0x4d04aa(0x9d5)](_0x107bd2=>_0x107bd2['name']);_0x3b6ec9[_0x4d04aa(0x1092)]&&_0x4e62e2['unshift'](_0xa4fe01),_0x271fae=_0x4d04aa(0x27a)+_0xa4fe01+_0x4d04aa(0x757)+_0xa4fe01+_0x4d04aa(0x805)+_0x3b6ec9[_0x4d04aa(0x723)]+_0x4d04aa(0xe73)+_0x4e62e2[_0x4d04aa(0x100b)]('、\x20')+_0x4d04aa(0x8ae)+_0x55f7d0+_0x4d04aa(0xc19);}else{let _0x444e34=_0x3b6ec9[_0x4d04aa(0x1279)]===_0x4d04aa(0x717)?_0x4d04aa(0xd8c):'用户刚刚接听了你主动发起的视频通话。';_0x271fae='\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在是一个场景描述引擎。你的任务是扮演\x20'+_0x8168af[_0x4d04aa(0x578)]+'\x20('+_0x8168af['settings'][_0x4d04aa(0x679)]+')，并以【第三人称旁观视角】来描述TA在视频通话中的所有动作和语言。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【【【视角铁律】】】**:\x20你的回复【绝对不能】使用第一人称“我”。必须使用第三人称，如“他”、“她”、或直接使用角色名“'+_0x8168af[_0x4d04aa(0x578)]+_0x4d04aa(0xb3d)+_0xa4fe01+'，人设:\x20'+_0x8168af[_0x4d04aa(0x2ea)][_0x4d04aa(0xf75)]+_0x4d04aa(0x1c9)+_0x444e34+_0x4d04aa(0x3e2)+_0x3b6ec9[_0x4d04aa(0x723)]+_0x4d04aa(0x658);}const _0x33d765=[{'role':'system','content':_0x271fae},..._0x3b6ec9['callHistory'][_0x4d04aa(0x9d5)](_0x14fea2=>({'role':_0x14fea2[_0x4d04aa(0x16d)],'content':_0x14fea2[_0x4d04aa(0xcbd)]}))];if(_0x3b6ec9['callHistory'][_0x4d04aa(0x79b)]===0x0){const _0x2766ff=_0x3b6ec9['initiator']===_0x4d04aa(0x717)?'*你按下了接听键...*':_0x4d04aa(0x581);_0x33d765[_0x4d04aa(0x2d6)]({'role':'user','content':_0x2766ff});}try{let _0x29c99d=_0x49b563===GEMINI_API_URL,_0xc4bf1f=_0x202ea1(_0x56b50c,_0x5d5607,_0x271fae,_0x33d765);const _0x322846=_0x29c99d?await fetch(_0xc4bf1f[_0x4d04aa(0x11a)],_0xc4bf1f[_0x4d04aa(0xa78)]):await fetch(_0x49b563+_0x4d04aa(0x399),{'method':'POST','headers':{'Content-Type':_0x4d04aa(0xd74),'Authorization':_0x4d04aa(0xf20)+_0x5d5607},'body':JSON[_0x4d04aa(0xd27)]({'model':_0x56b50c,'messages':_0x33d765,'temperature':_0x12493e[_0x4d04aa(0x10f6)][_0x4d04aa(0xd52)]||0.8})});if(!_0x322846['ok'])throw new Error((await _0x322846['json']())[_0x4d04aa(0x4d9)][_0x4d04aa(0xf93)]);const _0x520a08=await _0x322846[_0x4d04aa(0x79e)](),_0x1c56d2=_0x29c99d?_0x520a08[_0x4d04aa(0x11de)][0x0]['content'][_0x4d04aa(0xec1)][0x0][_0x4d04aa(0x996)]:_0x520a08['choices'][0x0][_0x4d04aa(0xf93)][_0x4d04aa(0xcbd)],_0x6a8141=_0x33b14e['querySelector']('em');if(_0x6a8141)_0x6a8141['remove']();if(_0x3b6ec9[_0x4d04aa(0x1255)]){const _0x3fdbc9=_0x4c5aa1(_0x1c56d2);_0x3fdbc9[_0x4d04aa(0xd6a)](_0x1f1489=>{const _0x543b7a=_0x4d04aa;if(!_0x1f1489[_0x543b7a(0x578)]||_0x1f1489[_0x543b7a(0x578)]===_0xa4fe01||!_0x1f1489[_0x543b7a(0x5e9)])return;const _0x45a786=Date[_0x543b7a(0x6ee)]()+Math['random'](),_0xdf3d5c=document[_0x543b7a(0x1292)](_0x543b7a(0x58c));_0xdf3d5c['className']=_0x543b7a(0x3cf),_0xdf3d5c[_0x543b7a(0x102a)]=_0x543b7a(0xf69)+_0x1f1489['name']+_0x543b7a(0xd3b)+_0x1f1489['speech'],_0xdf3d5c['dataset'][_0x543b7a(0x2f0)]=_0x45a786,_0x29b870(_0xdf3d5c,()=>_0x279f3b(_0x45a786)),_0x33b14e[_0x543b7a(0xf77)](_0xdf3d5c),_0x3b6ec9[_0x543b7a(0xe0c)][_0x543b7a(0x2d6)]({'role':_0x543b7a(0x376),'content':_0x1f1489[_0x543b7a(0x578)]+':\x20'+_0x1f1489[_0x543b7a(0x5e9)],'timestamp':_0x45a786});const _0x3c5b7d=_0x3b6ec9['participants'][_0x543b7a(0xd85)](_0x1156d7=>_0x1156d7['name']===_0x1f1489['name']);if(_0x3c5b7d){const _0x586909=document['querySelector'](_0x543b7a(0xaa1)+_0x3c5b7d['id']+_0x543b7a(0xd0e));_0x586909&&(_0x586909[_0x543b7a(0x10d3)][_0x543b7a(0xb9)](_0x543b7a(0x6a0)),setTimeout(()=>_0x586909[_0x543b7a(0x10d3)][_0x543b7a(0x2c7)]('speaking'),0x7d0));}});}else{const _0x41ffb0=Date[_0x4d04aa(0x6ee)](),_0x1334b7=document[_0x4d04aa(0x1292)](_0x4d04aa(0x58c));_0x1334b7[_0x4d04aa(0x84)]=_0x4d04aa(0x3cf),_0x1334b7[_0x4d04aa(0x11b0)]=_0x1c56d2,_0x1334b7['dataset'][_0x4d04aa(0x2f0)]=_0x41ffb0,_0x29b870(_0x1334b7,()=>_0x279f3b(_0x41ffb0)),_0x33b14e[_0x4d04aa(0xf77)](_0x1334b7),_0x3b6ec9['callHistory'][_0x4d04aa(0x2d6)]({'role':_0x4d04aa(0x376),'content':_0x1c56d2,'timestamp':_0x41ffb0});const _0x4f6cd0=document['querySelector'](_0x4d04aa(0x115c));_0x4f6cd0&&(_0x4f6cd0['classList'][_0x4d04aa(0xb9)](_0x4d04aa(0x6a0)),setTimeout(()=>_0x4f6cd0[_0x4d04aa(0x10d3)][_0x4d04aa(0x2c7)](_0x4d04aa(0x6a0)),0x7d0));}_0x33b14e[_0x4d04aa(0x1244)]=_0x33b14e['scrollHeight'];}catch(_0x244e87){const _0x2561e7=document['createElement'](_0x4d04aa(0x58c));_0x2561e7[_0x4d04aa(0x84)]='call-message-bubble\x20ai-speech',_0x2561e7[_0x4d04aa(0x105d)][_0x4d04aa(0x41e)]=_0x4d04aa(0x9ec),_0x2561e7[_0x4d04aa(0x11b0)]=_0x4d04aa(0x10c)+_0x244e87['message']+']',_0x33b14e[_0x4d04aa(0xf77)](_0x2561e7),_0x33b14e[_0x4d04aa(0x1244)]=_0x33b14e[_0x4d04aa(0xa87)],_0x3b6ec9[_0x4d04aa(0xe0c)]['push']({'role':_0x4d04aa(0x376),'content':_0x4d04aa(0x10c)+_0x244e87['message']+']'});}}function _0x4c4c1c(_0x2fb354){const _0x4dafc5=_0x247bea;document[_0x4dafc5(0xc33)](_0x4dafc5(0x255))[_0x4dafc5(0x105d)][_0x4dafc5(0xf44)]=_0x2fb354?_0x4dafc5(0x854):_0x4dafc5(0x21a),document[_0x4dafc5(0xc33)]('group-video-call-btn')[_0x4dafc5(0x105d)][_0x4dafc5(0xf44)]=_0x2fb354?_0x4dafc5(0x21a):'none';}async function _0xff41ed(_0x3fdee6,_0x58acc0){const _0x3d5006=_0x247bea,_0x4fda0c=_0x12493e['chats'][_0x12493e['activeChatId']];if(!_0x4fda0c)return;const _0x4efbda=_0x4fda0c[_0x3d5006(0x1294)]['findIndex'](_0x4f658a=>_0x4f658a[_0x3d5006(0x2f0)]===_0x3fdee6);if(_0x4efbda===-0x1)return;const _0x29ca0b=_0x4fda0c[_0x3d5006(0x1294)][_0x4efbda];_0x29ca0b['status']=_0x58acc0;let _0x4797b1;const _0x1f35f7=_0x4fda0c[_0x3d5006(0x80b)]?_0x4fda0c['settings'][_0x3d5006(0xbf6)]||'我':'我';_0x58acc0===_0x3d5006(0x5ec)?(_0x29ca0b[_0x3d5006(0x116d)]=_0x1f35f7,_0x4797b1=_0x3d5006(0xb47)+_0x1f35f7+_0x3d5006(0x5d0)+_0x29ca0b[_0x3d5006(0xe32)]+_0x3d5006(0xd0d)+_0x3fdee6+_0x3d5006(0x284)):_0x4797b1=_0x3d5006(0xb47)+_0x1f35f7+_0x3d5006(0x556)+_0x29ca0b[_0x3d5006(0xe32)]+_0x3d5006(0x79)+_0x3fdee6+_0x3d5006(0x78);const _0x191dac={'role':'system','content':_0x4797b1,'timestamp':Date['now'](),'isHidden':!![]};_0x4fda0c[_0x3d5006(0x1294)][_0x3d5006(0x2d6)](_0x191dac),await _0x2a2987[_0x3d5006(0xc45)]['put'](_0x4fda0c),_0x1bbfd3(_0x12493e[_0x3d5006(0x7bc)]),_0x58acc0===_0x3d5006(0x5ec)&&_0x439587();}async function _0x893b88(_0x3e0516,_0x589395){const _0x3804af=_0x247bea,_0x1c2a51=_0x12493e['chats'][_0x3e0516];if(!_0x1c2a51)return;let _0x2699ba;_0x1c2a51[_0x3804af(0x80b)]?_0x2699ba=_0x3fb61d(_0x1c2a51,_0x589395):_0x2699ba=_0x1c2a51['name'];const _0x4cd7dd=document[_0x3804af(0xc33)](_0x3804af(0x779));_0x4cd7dd[_0x3804af(0x10d3)][_0x3804af(0x2c7)](_0x3804af(0xb1)),void _0x4cd7dd[_0x3804af(0xeba)],_0x4cd7dd['classList'][_0x3804af(0xb9)]('pat-animation');const _0x37319b=await _0x1ca09c(_0x3804af(0xd72)+_0x2699ba+'”',_0x3804af(0x198),'',_0x3804af(0x996));if(_0x37319b===null)return;const _0x2a16c7=_0x3fb61d(_0x1c2a51,_0x12493e[_0x3804af(0x76c)][_0x3804af(0x66a)]),_0x3e2c90=_0x2a16c7+'\x20拍了拍\x20“'+_0x2699ba+'”\x20'+_0x37319b[_0x3804af(0x7da)](),_0x39265b={'role':'system','type':_0x3804af(0xc05),'content':_0x3e2c90,'timestamp':Date[_0x3804af(0x6ee)]()};_0x1c2a51['history'][_0x3804af(0x2d6)](_0x39265b);const _0x5b66dc=_0x3804af(0x10c8)+_0x2a16c7+_0x3804af(0x68e)+_0x589395+'）'+_0x37319b[_0x3804af(0x7da)]()+_0x3804af(0xc4),_0x113d03={'role':'system','content':_0x5b66dc,'timestamp':Date[_0x3804af(0x6ee)]()+0x1,'isHidden':!![]};_0x1c2a51[_0x3804af(0x1294)][_0x3804af(0x2d6)](_0x113d03),await _0x2a2987['chats'][_0x3804af(0xf36)](_0x1c2a51),_0x12493e[_0x3804af(0x7bc)]===_0x3e0516&&_0x468ef0(_0x39265b,_0x1c2a51),await _0x597ed7();}let _0x57be22=null,_0x52569b=![],_0x289122=new Set();function _0x279f3b(_0x424e6a){const _0x29eccc=_0x247bea;_0x57be22=_0x424e6a,document[_0x29eccc(0xc33)](_0x29eccc(0x3e8))[_0x29eccc(0x10d3)][_0x29eccc(0xb9)](_0x29eccc(0x143));}function _0x40883c(){const _0xc5db08=_0x247bea;document[_0xc5db08(0xc33)](_0xc5db08(0x3e8))[_0xc5db08(0x10d3)][_0xc5db08(0x2c7)](_0xc5db08(0x143)),_0x57be22=null;}async function _0x867ce5(){const _0x1e8e00=_0x247bea;if(!_0x57be22)return;const _0x3d7618=_0x57be22,_0x25461d=_0x3b6ec9[_0x1e8e00(0xe0c)][_0x1e8e00(0xd85)](_0x5df721=>_0x5df721[_0x1e8e00(0x2f0)]===_0x3d7618);if(!_0x25461d)return;_0x40883c();let _0x2b8aa4=_0x25461d['content'];if(_0x3b6ec9[_0x1e8e00(0x1255)]&&_0x25461d['role']==='assistant'){const _0x1191e0=_0x25461d[_0x1e8e00(0xcbd)][_0x1e8e00(0x8d7)](':\x20');_0x1191e0[_0x1e8e00(0x79b)]>0x1&&(_0x2b8aa4=_0x1191e0[_0x1e8e00(0x111c)](0x1)[_0x1e8e00(0x100b)](':\x20'));}const _0x1ab47b=await _0x1ca09c(_0x1e8e00(0xbf4),_0x1e8e00(0x986),_0x2b8aa4,'textarea');_0x1ab47b!==null&&await _0x32c52c(_0x3d7618,_0x1ab47b);}async function _0x32c52c(_0x4477c8,_0x1ba7e5){const _0x3adbd2=_0x247bea,_0x3b974b=_0x3b6ec9[_0x3adbd2(0xe0c)][_0x3adbd2(0xd85)](_0x2b5d57=>_0x2b5d57[_0x3adbd2(0x2f0)]===_0x4477c8);if(_0x3b974b){let _0x452328=_0x1ba7e5;if(_0x3b6ec9[_0x3adbd2(0x1255)]&&_0x3b974b[_0x3adbd2(0x16d)]==='assistant'){const _0x3dda9c=_0x3b974b[_0x3adbd2(0xcbd)]['split'](':\x20'),_0x89de75=_0x3dda9c[0x0];_0x452328=_0x89de75+':\x20'+_0x1ba7e5;}_0x3b974b[_0x3adbd2(0xcbd)]=_0x452328;const _0x258fab=document[_0x3adbd2(0x977)](_0x3adbd2(0xc2b)+_0x4477c8+'\x22]');if(_0x258fab){if(_0x3b6ec9['isGroupCall']&&_0x3b974b['role']===_0x3adbd2(0x376)){const _0xdf2aba=_0x3b974b['content']['split'](':\x20'),_0x570b7a=_0xdf2aba[0x0];_0x258fab[_0x3adbd2(0x102a)]=_0x3adbd2(0xf69)+_0x570b7a+_0x3adbd2(0xd3b)+_0x1ba7e5;}else _0x258fab['textContent']=_0x1ba7e5;}}await _0x2d7ddd('成功',_0x3adbd2(0xe8c));}async function _0x3a6c0e(){const _0x2ecd45=_0x247bea;if(!_0x57be22)return;const _0x274588=await _0x270512(_0x2ecd45(0x28a),_0x2ecd45(0x10ff),{'confirmButtonClass':'btn-danger'});if(_0x274588){const _0x347f93=_0x57be22;_0x40883c();const _0x33cd43=_0x3b6ec9[_0x2ecd45(0xe0c)][_0x2ecd45(0xce9)](_0x274450=>_0x274450[_0x2ecd45(0x2f0)]===_0x347f93);_0x33cd43>-0x1&&_0x3b6ec9[_0x2ecd45(0xe0c)][_0x2ecd45(0xbd1)](_0x33cd43,0x1);const _0x222bc8=document[_0x2ecd45(0x977)](_0x2ecd45(0xc2b)+_0x347f93+'\x22]');_0x222bc8&&_0x222bc8['remove']();}else _0x40883c();}function _0x47ae3b(_0x190337){const _0x444e93=_0x247bea;_0x12f09b=_0x190337;const _0x28314c=_0x12493e['chats'][_0x12493e[_0x444e93(0x7bc)]],_0x1bbfda=_0x28314c[_0x444e93(0x1294)][_0x444e93(0xd85)](_0x49eeb8=>_0x49eeb8[_0x444e93(0x2f0)]===_0x190337);_0x1bbfda&&(document[_0x444e93(0xc33)](_0x444e93(0xec6))[_0x444e93(0x11b0)]=_0x1bbfda[_0x444e93(0xe32)]),document[_0x444e93(0xc33)]('transfer-actions-modal')['classList']['add']('visible');}function _0x3a4059(){const _0x4d294f=_0x247bea;document[_0x4d294f(0xc33)](_0x4d294f(0x393))[_0x4d294f(0x10d3)]['remove'](_0x4d294f(0x143)),_0x12f09b=null;}async function _0x185d0c(_0x4740eb){const _0x3febb2=_0x247bea;if(!_0x12f09b)return;const _0x90e0c5=_0x12f09b,_0x1c685d=_0x12493e['chats'][_0x12493e[_0x3febb2(0x7bc)]],_0x207597=_0x1c685d['history'][_0x3febb2(0xce9)](_0x6ae413=>_0x6ae413[_0x3febb2(0x2f0)]===_0x90e0c5);if(_0x207597===-0x1)return;const _0x6b97c6=_0x1c685d[_0x3febb2(0x1294)][_0x207597];_0x6b97c6['status']=_0x4740eb;let _0x5ddaba;if(_0x4740eb===_0x3febb2(0x95b)){const _0x3ab7b1={'role':_0x3febb2(0x717),'type':_0x3febb2(0xe86),'isRefund':!![],'amount':_0x6b97c6[_0x3febb2(0x609)],'note':_0x3febb2(0x1009),'timestamp':Date[_0x3febb2(0x6ee)]()};_0x1c685d[_0x3febb2(0x1294)][_0x3febb2(0x2d6)](_0x3ab7b1),_0x5ddaba='[系统提示：你拒绝并退还了“'+_0x6b97c6['senderName']+_0x3febb2(0x3dc);}else _0x5ddaba=_0x3febb2(0x101)+_0x6b97c6[_0x3febb2(0xe32)]+_0x3febb2(0x3dc);const _0x5a9c18={'role':_0x3febb2(0x152),'content':_0x5ddaba,'timestamp':Date[_0x3febb2(0x6ee)]()+0x1,'isHidden':!![]};_0x1c685d[_0x3febb2(0x1294)][_0x3febb2(0x2d6)](_0x5a9c18),await _0x2a2987[_0x3febb2(0xc45)][_0x3febb2(0xf36)](_0x1c685d),_0x3a4059(),_0x1bbfd3(_0x12493e[_0x3febb2(0x7bc)]),_0x597ed7();}function _0x20a97f(_0x48a7a8){const _0x1f13f4=_0x247bea;_0x26a58f=null;if(_0x48a7a8){const _0x1d1617=_0x48a7a8[_0x1f13f4(0x977)](_0x1f13f4(0x457));_0x1d1617&&(_0x1d1617[_0x1f13f4(0x1126)]=_0x1f13f4(0x314));}}async function _0xc1a19(){const _0x2491ed=_0x247bea,_0x1cbdc3=document[_0x2491ed(0xc33)](_0x2491ed(0xac9));_0x1cbdc3[_0x2491ed(0x102a)]='';const _0x337574=await _0x2a2987[_0x2491ed(0x37c)][_0x2491ed(0xde3)](_0x2491ed(0x2f0))[_0x2491ed(0xc07)]()['toArray']();if(_0x337574['length']===0x0){_0x1cbdc3[_0x2491ed(0x102a)]=_0x2491ed(0x8b4);return;}_0x337574['sort']((_0x1fb235,_0x334707)=>{const _0x3afa66=_0x2491ed,_0x3a6895=_0x1fb235[_0x3afa66(0x52a)]===_0x3afa66(0x353)&&_0x1fb235[_0x3afa66(0xd23)]>Date[_0x3afa66(0x6ee)](),_0x317df8=_0x334707[_0x3afa66(0x52a)]==='countdown'&&_0x334707[_0x3afa66(0xd23)]>Date[_0x3afa66(0x6ee)]();if(_0x3a6895&&!_0x317df8)return-0x1;if(!_0x3a6895&&_0x317df8)return 0x1;if(_0x3a6895&&_0x317df8)return _0x1fb235['targetDate']-_0x334707['targetDate'];return 0x0;}),_0x337574[_0x2491ed(0xd6a)](_0x56e5ff=>{const _0x1e0558=_0x2491ed;let _0x33370f;_0x56e5ff[_0x1e0558(0x52a)]===_0x1e0558(0x353)&&_0x56e5ff[_0x1e0558(0xd23)]>Date[_0x1e0558(0x6ee)]()?_0x33370f=_0x47af5f(_0x56e5ff):_0x33370f=_0x28fe5b(_0x56e5ff),_0x1cbdc3[_0x1e0558(0xf77)](_0x33370f);}),_0x571e1b();}function _0x28fe5b(_0x417793){const _0xc8c101=_0x247bea,_0x3df8e5=document['createElement'](_0xc8c101(0x58c));_0x3df8e5[_0xc8c101(0x84)]=_0xc8c101(0xc0);const _0x7985a3=new Date(_0x417793[_0xc8c101(0x2f0)]),_0x56599d=_0x7985a3[_0xc8c101(0x80d)]()+'-'+String(_0x7985a3[_0xc8c101(0xf99)]()+0x1)['padStart'](0x2,'0')+'-'+String(_0x7985a3[_0xc8c101(0x6be)]())[_0xc8c101(0x70d)](0x2,'0')+'\x20'+String(_0x7985a3['getHours']())['padStart'](0x2,'0')+':'+String(_0x7985a3[_0xc8c101(0xa88)]())[_0xc8c101(0x70d)](0x2,'0');let _0x3a2cec,_0x561a7e;if(_0x417793[_0xc8c101(0x52a)]===_0xc8c101(0x353)&&_0x417793[_0xc8c101(0xd23)])_0x3a2cec=_0xc8c101(0x120f)+_0x417793[_0xc8c101(0x11ac)],_0x561a7e=_0x45d05d('在\x20'+new Date(_0x417793[_0xc8c101(0xd23)])[_0xc8c101(0x559)]()+_0xc8c101(0x108b))[_0xc8c101(0xc12)](/\n/g,_0xc8c101(0xfd5));else{let _0x2d1730=_0xc8c101(0x109d);if(_0x417793[_0xc8c101(0xd48)]){const _0x19314a=_0x12493e['chats'][_0x417793[_0xc8c101(0xd48)]];_0x19314a?_0x2d1730=_0x19314a[_0xc8c101(0x578)]:_0x2d1730=_0x417793[_0xc8c101(0x43b)]||_0xc8c101(0x941);}else _0x417793[_0xc8c101(0x43b)]&&(_0x2d1730=_0x417793[_0xc8c101(0x43b)]);_0x3a2cec=_0x2d1730+_0xc8c101(0xccc),_0x561a7e=_0x45d05d(_0x417793[_0xc8c101(0x11ac)]);}return _0x3df8e5[_0xc8c101(0x102a)]=_0xc8c101(0x10e6)+_0x56599d+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22author\x22>'+_0x3a2cec+_0xc8c101(0x4ed)+_0x561a7e+_0xc8c101(0x968),_0x29b870(_0x3df8e5,async()=>{const _0x110dd2=_0xc8c101,_0x273c71=await _0x270512('删除记录',_0x110dd2(0x81f),{'confirmButtonClass':_0x110dd2(0xa2)});_0x273c71&&(await _0x2a2987[_0x110dd2(0x37c)]['delete'](_0x417793['id']),_0xc1a19());}),_0x3df8e5;}function _0x47af5f(_0x39a774){const _0x993258=_0x247bea,_0x531237=document[_0x993258(0x1292)](_0x993258(0x58c));_0x531237[_0x993258(0x84)]='countdown-card';const _0x146960=new Date(_0x39a774[_0x993258(0xd23)]),_0x5d3a82=_0x146960[_0x993258(0x559)](_0x993258(0x770),{'dateStyle':_0x993258(0x12b6),'timeStyle':'short'});return _0x531237[_0x993258(0x102a)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>'+_0x39a774['description']+_0x993258(0x458)+_0x39a774['targetDate']+_0x993258(0xdda)+_0x5d3a82+_0x993258(0x968),_0x29b870(_0x531237,async()=>{const _0x3eba88=_0x993258,_0x2d03bb=await _0x270512('删除约定',_0x3eba88(0x5ee),{'confirmButtonClass':'btn-danger'});_0x2d03bb&&(await _0x2a2987[_0x3eba88(0x37c)][_0x3eba88(0x9ea)](_0x39a774['id']),_0xc1a19());}),_0x531237;}let _0x5b3d01=[];function _0x571e1b(){const _0x377350=_0x247bea;_0x5b3d01[_0x377350(0xd6a)](_0x5af341=>clearInterval(_0x5af341)),_0x5b3d01=[],document['querySelectorAll']('.countdown-card\x20.timer')['forEach'](_0x3c8260=>{const _0x115dc0=_0x377350,_0x3bdacc=parseInt(_0x3c8260['dataset'][_0x115dc0(0xd23)]);let _0x1b50b8;const _0x2a691f=()=>{const _0x5302cf=_0x115dc0,_0x4dcda1=Date['now'](),_0x440b77=_0x3bdacc-_0x4dcda1;if(_0x440b77<0x0){_0x3c8260[_0x5302cf(0x11b0)]=_0x5302cf(0xdc7),clearInterval(_0x1b50b8),setTimeout(()=>_0xc1a19(),0x7d0);return;}const _0x46fb57=Math[_0x5302cf(0xcb5)](_0x440b77/(0x3e8*0x3c*0x3c*0x18)),_0xe98b6b=Math[_0x5302cf(0xcb5)](_0x440b77%(0x3e8*0x3c*0x3c*0x18)/(0x3e8*0x3c*0x3c)),_0x366360=Math['floor'](_0x440b77%(0x3e8*0x3c*0x3c)/(0x3e8*0x3c)),_0x176fbb=Math[_0x5302cf(0xcb5)](_0x440b77%(0x3e8*0x3c)/0x3e8);_0x3c8260[_0x5302cf(0x11b0)]=_0x46fb57+'天\x20'+_0xe98b6b+'时\x20'+_0x366360+'分\x20'+_0x176fbb+'秒';};_0x2a691f(),_0x1b50b8=setInterval(_0x2a691f,0x3e8),_0x5b3d01[_0x115dc0(0x2d6)](_0x1b50b8);});}async function _0x4f7dbd(_0x398d24){const _0x55717a=_0x247bea,_0x46143c=_0x12493e[_0x55717a(0xc45)][_0x398d24];if(!_0x46143c)return;await _0x2d7ddd('流程启动',_0x55717a(0xe0)+_0x46143c[_0x55717a(0x578)]+'”准备好友申请...');const {proxyUrl:_0x3a97f5,apiKey:_0x46bffe,model:_0x5a49d2}=_0x12493e[_0x55717a(0xdd4)];if(!_0x3a97f5||!_0x46bffe||!_0x5a49d2){await _0x2d7ddd(_0x55717a(0x26b),_0x55717a(0xbd4));return;}const _0x2c1bfc=_0x46143c[_0x55717a(0x1294)]['slice'](-0x5)[_0x55717a(0x9d5)](_0x5c0c78=>{const _0x3e08dd=_0x55717a,_0x28893a=_0x5c0c78['role']==='user'?_0x46143c['settings'][_0x3e08dd(0xbf6)]||'我':_0x5c0c78['senderName']||_0x46143c[_0x3e08dd(0x578)];return _0x28893a+':\x20'+String(_0x5c0c78[_0x3e08dd(0xcbd)])['substring'](0x0,0x32)+_0x3e08dd(0xda0);})[_0x55717a(0x100b)]('\x0a');let _0x3a2479='';if(_0x46143c['settings']['linkedWorldBookIds']&&_0x46143c[_0x55717a(0x2ea)][_0x55717a(0xeca)][_0x55717a(0x79b)]>0x0){const _0x10ab41=_0x46143c['settings'][_0x55717a(0xeca)][_0x55717a(0x9d5)](_0x1e181a=>{const _0x2ace7a=_0x55717a,_0x160be7=_0x12493e[_0x2ace7a(0x63a)][_0x2ace7a(0xd85)](_0x136ca8=>_0x136ca8['id']===_0x1e181a);if(!_0x160be7||!Array[_0x2ace7a(0x621)](_0x160be7['content']))return'';const _0x18cbdc=_0x160be7[_0x2ace7a(0xcbd)][_0x2ace7a(0x9d5)](_0x166bdb=>{const _0x419ea0=_0x2ace7a;let _0xc5e802='\x0a###\x20条目:\x20'+(_0x166bdb[_0x419ea0(0x8db)]||_0x419ea0(0x2cb))+'\x0a';return _0x166bdb[_0x419ea0(0x1c6)]['length']>0x0&&(_0xc5e802+='**关键词:**\x20'+_0x166bdb[_0x419ea0(0x1c6)][_0x419ea0(0x100b)](',\x20')+'\x0a'),_0xc5e802+=_0x419ea0(0xb02)+_0x166bdb[_0x419ea0(0xcbd)],_0xc5e802;})['join']('\x0a');return _0x18cbdc?_0x2ace7a(0xc39)+_0x160be7[_0x2ace7a(0x578)]+'\x0a'+_0x18cbdc:'';})[_0x55717a(0x1054)](Boolean)['join']('');_0x10ab41&&(_0x3a2479=_0x55717a(0xb7d)+_0x10ab41+'\x0a');}const _0x3b84a7=_0x55717a(0x168)+_0x46143c[_0x55717a(0x578)]+_0x55717a(0xf9b)+_0x46143c['settings'][_0x55717a(0x679)]+_0x55717a(0x5bb)+_0x3a2479+_0x55717a(0x2aa)+_0x2c1bfc+_0x55717a(0xd5);try{const _0x960d2e=[{'role':_0x55717a(0x152),'content':_0x3b84a7},{'role':'user','content':'请根据以上设定开始你的决策。'}];let _0x423cac=_0x3a97f5===GEMINI_API_URL,_0x191f8e=_0x202ea1(_0x5a49d2,_0x46bffe,_0x3b84a7,_0x960d2e);const _0x289dfa=_0x423cac?await fetch(_0x191f8e[_0x55717a(0x11a)],_0x191f8e[_0x55717a(0xa78)]):await fetch(_0x3a97f5+_0x55717a(0x399),{'method':_0x55717a(0x90),'headers':{'Content-Type':'application/json','Authorization':_0x55717a(0xf20)+_0x46bffe},'body':JSON[_0x55717a(0xd27)]({'model':_0x5a49d2,'messages':_0x960d2e,'temperature':_0x12493e[_0x55717a(0x10f6)][_0x55717a(0xd52)]||0.9})});if(!_0x289dfa['ok']){const _0x2aa277=await _0x289dfa[_0x55717a(0x79e)]();throw new Error(_0x55717a(0x3e0)+_0x289dfa[_0x55717a(0xbc8)]+_0x55717a(0x804)+_0x2aa277[_0x55717a(0x4d9)][_0x55717a(0xf93)]);}const _0x43e6c4=await _0x289dfa[_0x55717a(0x79e)]();let _0x211d36=_0x423cac?_0x43e6c4[_0x55717a(0x11de)][0x0][_0x55717a(0xcbd)][_0x55717a(0xec1)][0x0][_0x55717a(0x996)]:_0x43e6c4['choices'][0x0][_0x55717a(0xf93)][_0x55717a(0xcbd)];_0x211d36=_0x211d36['replace'](/^```json\s*/,'')[_0x55717a(0xc12)](/```$/,'');const _0xcd8df=_0x211d36['trim'](),_0x4b9c6f=JSON[_0x55717a(0x6b1)](_0xcd8df);_0x4b9c6f['decision']==='apply'&&_0x4b9c6f['reason']?(_0x46143c[_0x55717a(0x1cb)][_0x55717a(0xbc8)]='pending_user_approval',_0x46143c[_0x55717a(0x1cb)][_0x55717a(0xaff)]=_0x4b9c6f[_0x55717a(0x842)],_0x12493e[_0x55717a(0xc45)][_0x398d24]=_0x46143c,_0x597ed7(),await _0x2d7ddd(_0x55717a(0xb78),'“'+_0x46143c[_0x55717a(0x578)]+'”已向你发送好友申请。请返回聊天列表查看。')):(await _0x2d7ddd(_0x55717a(0xa84),'“'+_0x46143c['name']+'”思考后决定暂时不发送好友申请，将重置冷静期。'),_0x46143c['relationship']['status']=_0x55717a(0x49e),_0x46143c[_0x55717a(0x1cb)]['blockedTimestamp']=Date[_0x55717a(0x6ee)]());}catch(_0x319020){await _0x2d7ddd(_0x55717a(0x2c9),'为“'+_0x46143c['name']+_0x55717a(0xbce)+_0x319020[_0x55717a(0xf93)]+_0x55717a(0xad7)),_0x46143c[_0x55717a(0x1cb)][_0x55717a(0xbc8)]=_0x55717a(0x49e),_0x46143c['relationship'][_0x55717a(0x713)]=Date[_0x55717a(0x6ee)]();}finally{await _0x2a2987['chats'][_0x55717a(0xf36)](_0x46143c),_0x1bbfd3(_0x398d24);}}function _0x45a13d(){const _0x1f3a85=_0x247bea;if(!_0x12493e[_0x1f3a85(0x7bc)])return;const _0x180e9a=_0x12493e['chats'][_0x12493e[_0x1f3a85(0x7bc)]];_0x180e9a[_0x1f3a85(0x80b)]?_0xe9acd5():document[_0x1f3a85(0xc33)](_0x1f3a85(0x89a))['classList']['add'](_0x1f3a85(0x143));}function _0xe9acd5(){const _0x4ef4d2=_0x247bea,_0xad33b4=document[_0x4ef4d2(0xc33)](_0x4ef4d2(0x6e6)),_0x3cfa34=_0x12493e[_0x4ef4d2(0xc45)][_0x12493e[_0x4ef4d2(0x7bc)]];document[_0x4ef4d2(0xc33)](_0x4ef4d2(0xd3c))[_0x4ef4d2(0x22a)]='',document[_0x4ef4d2(0xc33)]('rp-group-count')['value']='',document[_0x4ef4d2(0xc33)]('rp-group-greeting')[_0x4ef4d2(0x22a)]='',document['getElementById']('rp-direct-amount')[_0x4ef4d2(0x22a)]='',document[_0x4ef4d2(0xc33)](_0x4ef4d2(0xd04))[_0x4ef4d2(0x22a)]='',document[_0x4ef4d2(0xc33)](_0x4ef4d2(0xa53))[_0x4ef4d2(0x11b0)]='¥\x200.00',document['getElementById'](_0x4ef4d2(0x1181))[_0x4ef4d2(0x11b0)]='¥\x200.00';const _0x23c47d=document[_0x4ef4d2(0xc33)]('rp-direct-receiver');_0x23c47d[_0x4ef4d2(0x102a)]='',_0x3cfa34[_0x4ef4d2(0xd5b)]['forEach'](_0x3df333=>{const _0x1bae9d=_0x4ef4d2,_0x419a21=document['createElement']('option');_0x419a21[_0x1bae9d(0x22a)]=_0x3df333['originalName'],_0x419a21[_0x1bae9d(0x11b0)]=_0x3df333[_0x1bae9d(0x6e2)],_0x23c47d['appendChild'](_0x419a21);}),document[_0x4ef4d2(0xc33)](_0x4ef4d2(0x739))[_0x4ef4d2(0x335)](),_0xad33b4['classList'][_0x4ef4d2(0xb9)]('visible');}async function _0x4b5117(){const _0x5d34dc=_0x247bea,_0x45b8c8=_0x12493e[_0x5d34dc(0xc45)][_0x12493e[_0x5d34dc(0x7bc)]],_0x558f44=parseFloat(document[_0x5d34dc(0xc33)](_0x5d34dc(0xd3c))['value']),_0x37e859=parseInt(document[_0x5d34dc(0xc33)](_0x5d34dc(0x31b))['value']),_0x642a8c=document['getElementById'](_0x5d34dc(0x6af))[_0x5d34dc(0x22a)][_0x5d34dc(0x7da)]();if(isNaN(_0x558f44)||_0x558f44<=0x0){alert('请输入有效的总金额！');return;}if(isNaN(_0x37e859)||_0x37e859<=0x0){alert(_0x5d34dc(0xa96));return;}if(_0x558f44/_0x37e859<0.01){alert(_0x5d34dc(0xa33));return;}const _0x1a9b5d=_0x45b8c8[_0x5d34dc(0x2ea)][_0x5d34dc(0xbf6)]||'我',_0x3c73af={'role':_0x5d34dc(0x717),'senderName':_0x1a9b5d,'type':'red_packet','packetType':_0x5d34dc(0x2f2),'timestamp':Date[_0x5d34dc(0x6ee)](),'totalAmount':_0x558f44,'count':_0x37e859,'greeting':_0x642a8c||_0x5d34dc(0x759),'claimedBy':{},'isFullyClaimed':![]};_0x45b8c8[_0x5d34dc(0x1294)]['push'](_0x3c73af),await _0x2a2987[_0x5d34dc(0xc45)][_0x5d34dc(0xf36)](_0x45b8c8),_0x468ef0(_0x3c73af,_0x45b8c8),_0x597ed7(),document[_0x5d34dc(0xc33)](_0x5d34dc(0x6e6))[_0x5d34dc(0x10d3)][_0x5d34dc(0x2c7)](_0x5d34dc(0x143));}async function _0x3b51a2(){const _0x7b7ad9=_0x247bea,_0x3bceb0=_0x12493e['chats'][_0x12493e[_0x7b7ad9(0x7bc)]],_0x57af9e=parseFloat(document[_0x7b7ad9(0xc33)]('rp-direct-amount')[_0x7b7ad9(0x22a)]),_0x2f86b4=document[_0x7b7ad9(0xc33)]('rp-direct-receiver')[_0x7b7ad9(0x22a)],_0x4ed21b=document[_0x7b7ad9(0xc33)]('rp-direct-greeting')[_0x7b7ad9(0x22a)][_0x7b7ad9(0x7da)]();if(isNaN(_0x57af9e)||_0x57af9e<=0x0){alert(_0x7b7ad9(0x1a6));return;}if(!_0x2f86b4){alert('请选择一个接收人！');return;}const _0x15b95c=_0x3bceb0['settings'][_0x7b7ad9(0xbf6)]||'我',_0x5ad48c={'role':_0x7b7ad9(0x717),'senderName':_0x15b95c,'type':_0x7b7ad9(0xaa2),'packetType':'direct','timestamp':Date['now'](),'totalAmount':_0x57af9e,'count':0x1,'greeting':_0x4ed21b||_0x7b7ad9(0x170),'receiverName':_0x2f86b4,'claimedBy':{},'isFullyClaimed':![]};_0x3bceb0[_0x7b7ad9(0x1294)][_0x7b7ad9(0x2d6)](_0x5ad48c),await _0x2a2987[_0x7b7ad9(0xc45)][_0x7b7ad9(0xf36)](_0x3bceb0),_0x468ef0(_0x5ad48c,_0x3bceb0),_0x597ed7(),document[_0x7b7ad9(0xc33)]('red-packet-modal')[_0x7b7ad9(0x10d3)][_0x7b7ad9(0x2c7)](_0x7b7ad9(0x143));}async function _0x3701f1(_0x22a913){const _0x5555d3=_0x247bea,_0x6892d1=_0x12493e[_0x5555d3(0x7bc)],_0x1dca62=await _0x2a2987['chats']['get'](_0x6892d1);if(!_0x1dca62)return;_0x12493e['chats'][_0x6892d1]=_0x1dca62;const _0x40632e=_0x1dca62[_0x5555d3(0x1294)][_0x5555d3(0xd85)](_0x4b021d=>_0x4b021d['timestamp']===_0x22a913);if(!_0x40632e)return;const _0x19d954=_0x12493e[_0x5555d3(0x76c)]['nickname']||_0x5555d3(0x10d0),_0x32e15d=_0x40632e[_0x5555d3(0xea5)]&&_0x40632e[_0x5555d3(0xea5)][_0x19d954];if(_0x40632e[_0x5555d3(0xa2a)]===_0x5555d3(0x3d4)&&_0x40632e[_0x5555d3(0x204)]!==_0x19d954&&Object['keys'](_0x40632e[_0x5555d3(0xea5)])['length']>0x0||_0x40632e[_0x5555d3(0x1140)]||_0x32e15d){_0x1ee2b4(_0x40632e);return;}const _0x170ed1=await _0x54ebc7(_0x40632e);_0x170ed1!==null&&(await _0x1bbfd3(_0x6892d1),await _0x2d7ddd(_0x5555d3(0x3e4),_0x5555d3(0x440)+_0x3fb61d(_0x1dca62,_0x40632e['senderName'])+_0x5555d3(0x6e1)+_0x170ed1[_0x5555d3(0xcab)](0x2)+_0x5555d3(0x1250)));const _0x5f5a92=_0x12493e[_0x5555d3(0xc45)][_0x6892d1][_0x5555d3(0x1294)][_0x5555d3(0xd85)](_0x5686b1=>_0x5686b1[_0x5555d3(0x2f0)]===_0x22a913);_0x5f5a92&&_0x1ee2b4(_0x5f5a92);}async function _0x54ebc7(_0x54fa06){const _0x45d4cf=_0x247bea,_0x299dc3=_0x12493e[_0x45d4cf(0xc45)][_0x12493e['activeChatId']];let _0x490506=Date[_0x45d4cf(0x6ee)]();const _0x4583b3=_0x12493e[_0x45d4cf(0x76c)]['nickname']||_0x45d4cf(0x10d0),_0x695e41=_0x54fa06[_0x45d4cf(0x109)]-Object[_0x45d4cf(0x1c6)](_0x54fa06[_0x45d4cf(0xea5)]||{})[_0x45d4cf(0x79b)];if(_0x695e41<=0x0)return _0x54fa06[_0x45d4cf(0x1140)]=!![],await _0x2a2987[_0x45d4cf(0xc45)][_0x45d4cf(0xf36)](_0x299dc3),await _0x2d7ddd('手慢了',_0x45d4cf(0xdd5)),null;let _0x111c2b=0x0;const _0x7529fa=_0x54fa06['totalAmount']-Object[_0x45d4cf(0xd28)](_0x54fa06[_0x45d4cf(0xea5)]||{})[_0x45d4cf(0xdf9)]((_0x402d83,_0x18bc3a)=>_0x402d83+_0x18bc3a,0x0);if(_0x54fa06[_0x45d4cf(0xa2a)]===_0x45d4cf(0x2f2)){if(_0x695e41===0x1)_0x111c2b=_0x7529fa;else{const _0x27c980=0.01,_0x444de3=_0x7529fa-(_0x695e41-0x1)*_0x27c980;_0x111c2b=Math['random']()*(_0x444de3-_0x27c980)+_0x27c980;}}else _0x111c2b=_0x54fa06[_0x45d4cf(0x10ed)];_0x111c2b=parseFloat(_0x111c2b[_0x45d4cf(0xcab)](0x2));if(!_0x54fa06[_0x45d4cf(0xea5)])_0x54fa06[_0x45d4cf(0xea5)]={};_0x54fa06[_0x45d4cf(0xea5)][_0x4583b3]=_0x111c2b;const _0x208563=Object[_0x45d4cf(0x1c6)](_0x54fa06[_0x45d4cf(0xea5)])[_0x45d4cf(0x79b)]>=_0x54fa06['count'];_0x208563&&(_0x54fa06[_0x45d4cf(0x1140)]=!![]);const _0x2f0b41=_0x3fb61d(_0x299dc3,_0x4583b3),_0x302a3c=_0x3fb61d(_0x299dc3,_0x54fa06[_0x45d4cf(0xe32)]),_0x167baf={'role':'system','type':_0x45d4cf(0xc05),'content':_0x45d4cf(0x440)+_0x302a3c+_0x45d4cf(0xda9),'timestamp':_0x490506++};_0x299dc3['history'][_0x45d4cf(0x2d6)](_0x167baf);let _0x211161;if(_0x208563){const _0x5d92aa={'role':_0x45d4cf(0x152),'type':'pat_message','content':_0x302a3c+_0x45d4cf(0x104e),'timestamp':_0x490506++};_0x299dc3[_0x45d4cf(0x1294)][_0x45d4cf(0x2d6)](_0x5d92aa);let _0x51d1ca={'name':'','amount':-0x1};_0x54fa06[_0x45d4cf(0xa2a)]===_0x45d4cf(0x2f2)&&_0x54fa06[_0x45d4cf(0x109)]>0x1&&Object[_0x45d4cf(0x43e)](_0x54fa06['claimedBy'])[_0x45d4cf(0xd6a)](([_0x4de3c9,_0x1d819c])=>{_0x1d819c>_0x51d1ca['amount']&&(_0x51d1ca={'name':_0x4de3c9,'amount':_0x1d819c});});const _0x54942a=_0x51d1ca[_0x45d4cf(0x578)]?_0x3fb61d(_0x299dc3,_0x51d1ca[_0x45d4cf(0x578)]):'无';_0x211161=_0x45d4cf(0xadb)+_0x2f0b41+')\x20领取了最后一个红包。红包已被领完，手气王是\x20'+_0x54942a+_0x45d4cf(0x622);}else _0x211161=_0x45d4cf(0xadb)+_0x2f0b41+')\x20刚刚领取了红包\x20(时间戳:\x20'+_0x54fa06[_0x45d4cf(0x2f0)]+_0x45d4cf(0x564);const _0x1feeb1={'role':'system','content':_0x211161,'timestamp':_0x490506++,'isHidden':!![]};return _0x299dc3[_0x45d4cf(0x1294)]['push'](_0x1feeb1),await _0x2a2987[_0x45d4cf(0xc45)][_0x45d4cf(0xf36)](_0x299dc3),_0x111c2b;}async function _0x1ee2b4(_0x3bfeda){const _0x2618cd=_0x247bea;if(!_0x3bfeda){console[_0x2618cd(0x4d9)](_0x2618cd(0x967));return;}const _0x321804=_0x12493e[_0x2618cd(0xc45)][_0x12493e[_0x2618cd(0x7bc)]];if(!_0x321804)return;const _0x1cca0e=document[_0x2618cd(0xc33)](_0x2618cd(0xb36)),_0xc99a62=_0x12493e['qzoneSettings'][_0x2618cd(0x66a)]||_0x2618cd(0x10d0),_0x26e2ea=_0x3fb61d(_0x321804,_0x3bfeda[_0x2618cd(0xe32)]);document[_0x2618cd(0xc33)](_0x2618cd(0x8ff))[_0x2618cd(0x11b0)]=_0x26e2ea,document[_0x2618cd(0xc33)](_0x2618cd(0xaec))[_0x2618cd(0x11b0)]=_0x3bfeda['greeting']||'恭喜发财，大吉大利！';const _0x333826=document[_0x2618cd(0xc33)](_0x2618cd(0xf58));_0x3bfeda[_0x2618cd(0xea5)]&&_0x3bfeda[_0x2618cd(0xea5)][_0xc99a62]?(_0x333826[_0x2618cd(0x977)](_0x2618cd(0x473))['textContent']=_0x3bfeda['claimedBy'][_0xc99a62][_0x2618cd(0xcab)](0x2),_0x333826[_0x2618cd(0x105d)][_0x2618cd(0xf44)]='block'):_0x333826[_0x2618cd(0x105d)][_0x2618cd(0xf44)]='none';const _0x61b877=Object[_0x2618cd(0x1c6)](_0x3bfeda['claimedBy']||{})[_0x2618cd(0x79b)],_0x28c014=Object['values'](_0x3bfeda['claimedBy']||{})[_0x2618cd(0xdf9)]((_0x169eaa,_0x49d9bd)=>_0x169eaa+_0x49d9bd,0x0);let _0x2efd05=_0x61b877+'/'+_0x3bfeda[_0x2618cd(0x109)]+_0x2618cd(0x3e6)+_0x28c014[_0x2618cd(0xcab)](0x2)+'/'+_0x3bfeda[_0x2618cd(0x10ed)][_0x2618cd(0xcab)](0x2)+'元。';if(!_0x3bfeda[_0x2618cd(0x1140)]&&_0x61b877<_0x3bfeda[_0x2618cd(0x109)]){const _0xbee2ec=Math[_0x2618cd(0xcb5)]((_0x3bfeda[_0x2618cd(0x2f0)]+0x18*0x3c*0x3c*0x3e8-Date[_0x2618cd(0x6ee)]())/(0x3e8*0x3c*0x3c));if(_0xbee2ec>0x0)_0x2efd05+=_0x2618cd(0xc32)+_0xbee2ec+_0x2618cd(0x115a);}document[_0x2618cd(0xc33)](_0x2618cd(0x1000))['textContent']=_0x2efd05;const _0x40db1a=document['getElementById']('rp-details-list');_0x40db1a[_0x2618cd(0x102a)]='';const _0x552465=Object[_0x2618cd(0x43e)](_0x3bfeda[_0x2618cd(0xea5)]||{});let _0x5dd6db={'name':'','amount':-0x1};_0x3bfeda[_0x2618cd(0xa2a)]===_0x2618cd(0x2f2)&&_0x3bfeda[_0x2618cd(0x1140)]&&_0x552465[_0x2618cd(0x79b)]>0x1&&_0x552465[_0x2618cd(0xd6a)](([_0x5b7001,_0x153c26])=>{const _0x354336=_0x2618cd;_0x153c26>_0x5dd6db[_0x354336(0x609)]&&(_0x5dd6db={'name':_0x5b7001,'amount':_0x153c26});}),_0x552465[_0x2618cd(0xbb3)]((_0x38b717,_0x320522)=>_0x320522[0x1]-_0x38b717[0x1]),_0x552465[_0x2618cd(0xd6a)](([_0x59f283,_0x183bbd])=>{const _0x4e8134=_0x2618cd,_0x386a69=document[_0x4e8134(0x1292)]('div');_0x386a69[_0x4e8134(0x84)]='rp-details-item';let _0x5b5d4f='';_0x5dd6db[_0x4e8134(0x578)]&&_0x59f283===_0x5dd6db['name']&&(_0x5b5d4f=_0x4e8134(0xbae));const _0x3ceee9=_0x3fb61d(_0x321804,_0x59f283);_0x386a69[_0x4e8134(0x102a)]=_0x4e8134(0x909)+_0x3ceee9+_0x4e8134(0x1f9)+_0x183bbd[_0x4e8134(0xcab)](0x2)+'\x20元</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x5b5d4f+_0x4e8134(0x188),_0x40db1a[_0x4e8134(0xf77)](_0x386a69);}),_0x1cca0e[_0x2618cd(0x10d3)][_0x2618cd(0xb9)](_0x2618cd(0x143));}document['getElementById'](_0x247bea(0x179))[_0x247bea(0x205)]('click',()=>{const _0x51fd2f=_0x247bea;document['getElementById'](_0x51fd2f(0xb36))[_0x51fd2f(0x10d3)]['remove'](_0x51fd2f(0x143));}),window[_0x247bea(0x10c9)]=_0x3701f1;function _0x3985ab(){const _0x313036=_0x247bea,_0x1595bd=document['getElementById'](_0x313036(0xc73));document['getElementById'](_0x313036(0x1134))['value']='';const _0x11e325=document[_0x313036(0xc33)](_0x313036(0x6f));_0x11e325['innerHTML']='',_0x4e7d4e(),_0x4e7d4e(),_0x1595bd[_0x313036(0x10d3)][_0x313036(0xb9)](_0x313036(0x143));}function _0x4e7d4e(){const _0x1ee308=_0x247bea,_0x5ca0fb=document[_0x1ee308(0xc33)](_0x1ee308(0x6f)),_0x12a836=document[_0x1ee308(0x1292)](_0x1ee308(0x58c));_0x12a836['className']=_0x1ee308(0x106c),_0x12a836[_0x1ee308(0x102a)]=_0x1ee308(0xcc3),_0x12a836[_0x1ee308(0x977)](_0x1ee308(0xc30))[_0x1ee308(0x205)](_0x1ee308(0x335),()=>{const _0x2d375c=_0x1ee308;_0x5ca0fb[_0x2d375c(0x103f)]['length']>0x2?_0x12a836[_0x2d375c(0x2c7)]():alert(_0x2d375c(0x945));}),_0x5ca0fb[_0x1ee308(0xf77)](_0x12a836);}async function _0x5200b9(){const _0xd97005=_0x247bea;if(!_0x12493e[_0xd97005(0x7bc)])return;const _0x435af9=document['getElementById'](_0xd97005(0x1134))[_0xd97005(0x22a)][_0xd97005(0x7da)]();if(!_0x435af9){alert(_0xd97005(0x230));return;}const _0x522492=Array[_0xd97005(0x301)](document[_0xd97005(0x67a)]('.poll-option-input'))['map'](_0x19dbf1=>_0x19dbf1[_0xd97005(0x22a)]['trim']())[_0xd97005(0x1054)](_0x20bb34=>_0x20bb34);if(_0x522492[_0xd97005(0x79b)]<0x2){alert(_0xd97005(0xa77));return;}const _0x72c20=_0x12493e[_0xd97005(0xc45)][_0x12493e['activeChatId']],_0x3e9667=_0x72c20[_0xd97005(0x80b)]?_0x72c20[_0xd97005(0x2ea)][_0xd97005(0xbf6)]||'我':'我',_0x25f5be={'role':_0xd97005(0x717),'senderName':_0x3e9667,'type':_0xd97005(0x9ba),'timestamp':Date['now'](),'question':_0x435af9,'options':_0x522492,'votes':{},'isClosed':![]};_0x72c20['history'][_0xd97005(0x2d6)](_0x25f5be),await _0x2a2987[_0xd97005(0xc45)]['put'](_0x72c20),_0x468ef0(_0x25f5be,_0x72c20),_0x597ed7(),document[_0xd97005(0xc33)](_0xd97005(0xc73))[_0xd97005(0x10d3)]['remove'](_0xd97005(0x143));}async function _0x3595c0(_0x2872d0,_0x11f9cc){const _0x37de86=_0x247bea,_0x16935e=_0x12493e['chats'][_0x12493e['activeChatId']],_0x16355b=_0x16935e['history'][_0x37de86(0xd85)](_0x300f52=>_0x300f52[_0x37de86(0x2f0)]===_0x2872d0),_0x1eeb94=_0x16935e[_0x37de86(0x80b)]?_0x16935e[_0x37de86(0x2ea)][_0x37de86(0xbf6)]||'我':'我';if(!_0x16355b||_0x16355b[_0x37de86(0xead)]){_0x16355b&&_0x16355b[_0x37de86(0xead)]&&_0x2fdcd6(_0x2872d0);return;}const _0x55ed48=_0x16355b[_0x37de86(0x4d4)][_0x11f9cc]&&_0x16355b[_0x37de86(0x4d4)][_0x11f9cc][_0x37de86(0x1d4)](_0x1eeb94);if(!_0x55ed48){for(const _0x101df1 in _0x16355b[_0x37de86(0x4d4)]){const _0x357cc8=_0x16355b[_0x37de86(0x4d4)][_0x101df1][_0x37de86(0x107e)](_0x1eeb94);_0x357cc8>-0x1&&_0x16355b[_0x37de86(0x4d4)][_0x101df1][_0x37de86(0xbd1)](_0x357cc8,0x1);}!_0x16355b[_0x37de86(0x4d4)][_0x11f9cc]&&(_0x16355b['votes'][_0x11f9cc]=[]),_0x16355b[_0x37de86(0x4d4)][_0x11f9cc][_0x37de86(0x2d6)](_0x1eeb94);}let _0x76526=null;!_0x55ed48&&(_0x76526=_0x37de86(0xadb)+_0x1eeb94+')\x20刚刚投票给了\x20“'+_0x11f9cc+'”。]');if(_0x76526){const _0x2a8f54={'role':_0x37de86(0x152),'content':_0x76526,'timestamp':Date['now'](),'isHidden':!![]};_0x16935e[_0x37de86(0x1294)][_0x37de86(0x2d6)](_0x2a8f54);}await _0x2a2987[_0x37de86(0xc45)][_0x37de86(0xf36)](_0x16935e),_0x1bbfd3(_0x12493e[_0x37de86(0x7bc)]);}async function _0x1491a0(_0x70121c){const _0xb0f917=_0x247bea,_0x429be0=_0x12493e[_0xb0f917(0xc45)][_0x12493e[_0xb0f917(0x7bc)]],_0x25afde=_0x429be0[_0xb0f917(0x1294)][_0xb0f917(0xd85)](_0x5ce208=>_0x5ce208[_0xb0f917(0x2f0)]===_0x70121c);if(!_0x25afde||_0x25afde[_0xb0f917(0xead)])return;const _0x5694df=await _0x270512('结束投票',_0xb0f917(0x892));if(_0x5694df){_0x25afde['isClosed']=!![];const _0x333792=_0x25afde[_0xb0f917(0x6c2)][_0xb0f917(0x9d5)](_0x4daa59=>'“'+_0x4daa59+'”('+(_0x25afde[_0xb0f917(0x4d4)][_0x4daa59]?.[_0xb0f917(0x79b)]||0x0)+'票)')[_0xb0f917(0x100b)]('，'),_0x155631=_0xb0f917(0x7cc)+_0x333792+'。]',_0x3363c2={'role':_0xb0f917(0x152),'content':_0x155631,'timestamp':Date[_0xb0f917(0x6ee)](),'isHidden':!![]};_0x429be0[_0xb0f917(0x1294)]['push'](_0x3363c2),await _0x2a2987[_0xb0f917(0xc45)][_0xb0f917(0xf36)](_0x429be0),_0x1bbfd3(_0x12493e[_0xb0f917(0x7bc)]);}}function _0x2fdcd6(_0x28ec8c){const _0x904f09=_0x247bea,_0x2359fc=_0x12493e[_0x904f09(0xc45)][_0x12493e[_0x904f09(0x7bc)]],_0x24f272=_0x2359fc['history'][_0x904f09(0xd85)](_0x23df05=>_0x23df05['timestamp']===_0x28ec8c);if(!_0x24f272||!_0x24f272[_0x904f09(0xead)])return;let _0x1cc07c=_0x904f09(0x11d8)+_0x24f272[_0x904f09(0x11a3)]+'</strong></p><hr\x20style=\x22opacity:\x200.2;\x20margin:\x2010px\x200;\x22>';Object[_0x904f09(0x1c6)](_0x24f272['votes'])[_0x904f09(0x79b)]===0x0?_0x1cc07c+=_0x904f09(0xb5b):_0x24f272['options'][_0x904f09(0xd6a)](_0x227636=>{const _0x54a803=_0x904f09,_0x238be7=_0x24f272['votes'][_0x227636]||[],_0x4221ba=_0x238be7['map'](_0x32b914=>_0x3fb61d(_0x2359fc,_0x32b914))[_0x54a803(0x100b)]('、\x20');_0x1cc07c+=_0x54a803(0x10f8)+_0x227636+'\x20('+_0x238be7[_0x54a803(0x79b)]+'票)</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2013px;\x20color:\x20#555;\x20margin:\x200;\x20line-height:\x201.5;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x238be7['length']>0x0?_0x4221ba:_0x54a803(0x10c1))+_0x54a803(0x11bd);}),_0x2d7ddd(_0x904f09(0x7a1),_0x1cc07c);}function _0x48078d(){const _0xd42231=_0x247bea;if(!_0x12493e[_0xd42231(0x7bc)])return;const _0x20d960=_0x12493e['chats'][_0x12493e['activeChatId']];document[_0xd42231(0xc33)](_0xd42231(0xf6a))[_0xd42231(0x11b0)]='“'+_0x20d960[_0xd42231(0x578)]+'”的头像库',_0x4a5796(),document[_0xd42231(0xc33)](_0xd42231(0x92e))[_0xd42231(0x10d3)][_0xd42231(0xb9)](_0xd42231(0x143));}function _0x4a5796(){const _0x39a072=_0x247bea,_0x28b58b=document['getElementById'](_0x39a072(0x6ef));_0x28b58b[_0x39a072(0x102a)]='';const _0x26e03b=_0x12493e['chats'][_0x12493e[_0x39a072(0x7bc)]],_0x4a1879=_0x26e03b[_0x39a072(0x2ea)]['aiAvatarLibrary']||[];if(_0x4a1879['length']===0x0){_0x28b58b['innerHTML']=_0x39a072(0x624);return;}_0x4a1879['forEach']((_0x10b757,_0x394e16)=>{const _0xf913a1=_0x39a072,_0x5b1a95=document['createElement'](_0xf913a1(0x58c));_0x5b1a95[_0xf913a1(0x84)]=_0xf913a1(0x696),_0x5b1a95['title']=_0x10b757['name'],_0x5b1a95[_0xf913a1(0x102a)]=_0xf913a1(0x87f)+_0x10b757['url']+_0xf913a1(0x58a)+_0x10b757[_0xf913a1(0x578)]+_0xf913a1(0x149);const _0x3e59a0=document[_0xf913a1(0x1292)](_0xf913a1(0x58c));_0x3e59a0[_0xf913a1(0x84)]=_0xf913a1(0x7d1),_0x3e59a0[_0xf913a1(0x102a)]='×',_0x3e59a0[_0xf913a1(0x105d)][_0xf913a1(0xf44)]=_0xf913a1(0xa20),_0x3e59a0['onclick']=async _0x2d871d=>{const _0x47ebb3=_0xf913a1;_0x2d871d[_0x47ebb3(0xea2)]();const _0x43d463=await _0x270512(_0x47ebb3(0xa94),_0x47ebb3(0x3e7)+_0x10b757[_0x47ebb3(0x578)]+'”吗？',{'confirmButtonClass':_0x47ebb3(0xa2)});_0x43d463&&(_0x26e03b['settings'][_0x47ebb3(0xfc5)][_0x47ebb3(0xbd1)](_0x394e16,0x1),await _0x2a2987[_0x47ebb3(0xc45)]['put'](_0x26e03b),_0x4a5796());},_0x5b1a95[_0xf913a1(0xf77)](_0x3e59a0),_0x28b58b['appendChild'](_0x5b1a95);});}async function _0x190b8c(){const _0x392d84=_0x247bea,_0x37cc05=await _0x1ca09c(_0x392d84(0xa89),'请为这个头像起个名字（例如：开心、哭泣）');if(!_0x37cc05||!_0x37cc05[_0x392d84(0x7da)]())return;const _0x312e9c=await _0x1ca09c(_0x392d84(0xa89),_0x392d84(0x1159),'',_0x392d84(0x11a));if(!_0x312e9c||!_0x312e9c['trim']()[_0x392d84(0xece)]('http')){alert(_0x392d84(0x107f));return;}const _0x5c3b9d=_0x12493e[_0x392d84(0xc45)][_0x12493e[_0x392d84(0x7bc)]];!_0x5c3b9d[_0x392d84(0x2ea)][_0x392d84(0xfc5)]&&(_0x5c3b9d[_0x392d84(0x2ea)][_0x392d84(0xfc5)]=[]),_0x5c3b9d['settings'][_0x392d84(0xfc5)]['push']({'name':_0x37cc05[_0x392d84(0x7da)](),'url':_0x312e9c[_0x392d84(0x7da)]()}),await _0x2a2987['chats'][_0x392d84(0xf36)](_0x5c3b9d),_0x4a5796();}function _0x3344c1(){const _0x1b4bdb=_0x247bea;document[_0x1b4bdb(0xc33)]('ai-avatar-library-modal')[_0x1b4bdb(0x10d3)][_0x1b4bdb(0x2c7)](_0x1b4bdb(0x143));}function _0x5e2192(){const _0xa0656c=_0x247bea;if(!_0x12493e['activeChatId'])return;const _0x188f2a=_0x12493e[_0xa0656c(0xc45)][_0x12493e[_0xa0656c(0x7bc)]];document[_0xa0656c(0xc33)](_0xa0656c(0xed4))[_0xa0656c(0x11b0)]='“'+(_0x188f2a['settings'][_0xa0656c(0xbf6)]||'我')+'”的头像库',_0x2e6797(),document['getElementById'](_0xa0656c(0x48a))[_0xa0656c(0x10d3)]['add'](_0xa0656c(0x143));}function _0x2e6797(){const _0x199714=_0x247bea,_0x593a68=document[_0x199714(0xc33)](_0x199714(0x3e1));_0x593a68[_0x199714(0x102a)]='';const _0x24507a=_0x12493e[_0x199714(0xc45)][_0x12493e[_0x199714(0x7bc)]],_0x7e7eda=_0x24507a[_0x199714(0x2ea)][_0x199714(0x10df)]||[];if(_0x7e7eda[_0x199714(0x79b)]===0x0){_0x593a68[_0x199714(0x102a)]='<p\x20style=\x22color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x22>这个头像库还是空的，点击右上角“添加”吧！</p>';return;}_0x7e7eda[_0x199714(0xd6a)]((_0x10bfd1,_0x49c6d3)=>{const _0x5137b3=_0x199714,_0x3106ad=document[_0x5137b3(0x1292)](_0x5137b3(0x58c));_0x3106ad[_0x5137b3(0x84)]=_0x5137b3(0x696),_0x3106ad[_0x5137b3(0x874)]=_0x10bfd1[_0x5137b3(0x578)],_0x3106ad[_0x5137b3(0x102a)]=_0x5137b3(0x87f)+_0x10bfd1[_0x5137b3(0x11a)]+_0x5137b3(0x58a)+_0x10bfd1[_0x5137b3(0x578)]+_0x5137b3(0x149);const _0x50403a=document[_0x5137b3(0x1292)](_0x5137b3(0x58c));_0x50403a['className']=_0x5137b3(0x7d1),_0x50403a[_0x5137b3(0x102a)]='×',_0x50403a['style']['display']=_0x5137b3(0xa20),_0x50403a[_0x5137b3(0x8a)]=async _0x766629=>{const _0xa8b917=_0x5137b3;_0x766629[_0xa8b917(0xea2)]();const _0x1c333e=await _0x270512(_0xa8b917(0xa94),'确定要从你的头像库中删除“'+_0x10bfd1['name']+_0xa8b917(0x6ec),{'confirmButtonClass':_0xa8b917(0xa2)});_0x1c333e&&(_0x24507a['settings']['myAvatarLibrary']['splice'](_0x49c6d3,0x1),await _0x2a2987[_0xa8b917(0xc45)][_0xa8b917(0xf36)](_0x24507a),_0x2e6797());},_0x3106ad['appendChild'](_0x50403a),_0x593a68[_0x5137b3(0xf77)](_0x3106ad);});}async function _0x397845(){const _0x2d8518=_0x247bea,_0x5a7465=await _0x1ca09c(_0x2d8518(0xa89),_0x2d8518(0xf8d));if(!_0x5a7465||!_0x5a7465[_0x2d8518(0x7da)]())return;const _0x156cf7=await _0x1ca09c(_0x2d8518(0xa89),'请输入头像的图片URL','',_0x2d8518(0x11a));if(!_0x156cf7||!_0x156cf7['trim']()[_0x2d8518(0xece)](_0x2d8518(0xd8d))){alert(_0x2d8518(0x107f));return;}const _0x2d77fc=_0x12493e[_0x2d8518(0xc45)][_0x12493e[_0x2d8518(0x7bc)]];!_0x2d77fc['settings']['myAvatarLibrary']&&(_0x2d77fc[_0x2d8518(0x2ea)]['myAvatarLibrary']=[]),_0x2d77fc[_0x2d8518(0x2ea)]['myAvatarLibrary']['push']({'name':_0x5a7465['trim'](),'url':_0x156cf7[_0x2d8518(0x7da)]()}),await _0x2a2987[_0x2d8518(0xc45)][_0x2d8518(0xf36)](_0x2d77fc),_0x2e6797();}async function _0x1b6916(_0x1ae5b4){const _0x26c9cc=_0x247bea,_0x28194f=_0x1ae5b4[_0x26c9cc(0xe16)][_0x26c9cc(0x1d0)][0x0];if(!_0x28194f)return;const _0x58d96a=await new Promise(_0x2def39=>{const _0x4c3d01=_0x26c9cc,_0x7eeecb=new FileReader();_0x7eeecb['onload']=()=>_0x2def39(_0x7eeecb['result']),_0x7eeecb[_0x4c3d01(0xbcf)](_0x28194f);}),_0x42e7c8=await _0x1ca09c(_0x26c9cc(0xfb3),_0x26c9cc(0x118e));if(!_0x42e7c8||!_0x42e7c8[_0x26c9cc(0x7da)]())return;const _0x243937=_0x12493e[_0x26c9cc(0xc45)][_0x12493e['activeChatId']];!_0x243937[_0x26c9cc(0x2ea)]['myAvatarLibrary']&&(_0x243937[_0x26c9cc(0x2ea)]['myAvatarLibrary']=[]),_0x243937[_0x26c9cc(0x2ea)]['myAvatarLibrary']['push']({'name':_0x42e7c8[_0x26c9cc(0x7da)](),'url':_0x58d96a}),await _0x2a2987[_0x26c9cc(0xc45)][_0x26c9cc(0xf36)](_0x243937),_0x2e6797(),_0x1ae5b4[_0x26c9cc(0xe16)]['value']=null;}async function _0x53bdc8(_0x30d810){const _0x4f7bd8=_0x247bea,_0x401ae3=_0x12493e['chats'][_0x12493e['activeChatId']];if(!_0x401ae3)return;const _0x2c7ee8=_0x30d810[_0x4f7bd8(0x7da)]()[_0x4f7bd8(0x8d7)]('\x0a'),_0x300b20=[],_0x2aa716=_0x4f7bd8(0x8a1);let _0xef7cfc=0x0;for(const _0x4c5fb2 of _0x2c7ee8){const _0x502e31=_0x4c5fb2[_0x4f7bd8(0x7da)]();if(!_0x502e31||_0x502e31['includes'](_0x4f7bd8(0xd8d))||_0x502e31[_0x4f7bd8(0x1d4)]('填入'))continue;let _0x174d72=null,_0x4424d9=null;const _0x3aecaa=_0x502e31['match'](/^([\u4e00-\u9fa5]+)([a-zA-Z0-9]+\..+)$/);if(_0x3aecaa)_0x174d72=_0x3aecaa[0x1],_0x4424d9=_0x3aecaa[0x2];else{const _0x3c3c6f=_0x502e31[_0x4f7bd8(0x8d7)](/\s+/);_0x3c3c6f[_0x4f7bd8(0x79b)]>=0x2&&(_0x4424d9=_0x3c3c6f['pop'](),_0x174d72=_0x3c3c6f[_0x4f7bd8(0x100b)]('\x20'));}_0x174d72&&_0x4424d9&&_0x4424d9[_0x4f7bd8(0x1d4)]('.')?_0x300b20['push']({'name':_0x174d72,'url':_0x2aa716+_0x4424d9}):_0xef7cfc++;}if(_0xef7cfc>0x0)await _0x2d7ddd(_0x4f7bd8(0x436),'有\x20'+_0xef7cfc+'\x20行的格式不正确，已被跳过。');if(_0x300b20[_0x4f7bd8(0x79b)]>0x0){if(!_0x401ae3[_0x4f7bd8(0x2ea)][_0x4f7bd8(0x10df)])_0x401ae3[_0x4f7bd8(0x2ea)][_0x4f7bd8(0x10df)]=[];_0x401ae3[_0x4f7bd8(0x2ea)][_0x4f7bd8(0x10df)]['push'](..._0x300b20),await _0x2a2987[_0x4f7bd8(0xc45)]['put'](_0x401ae3),_0x2e6797(),await _0x2d7ddd('导入成功',_0x4f7bd8(0xd30)+_0x300b20[_0x4f7bd8(0x79b)]+_0x4f7bd8(0x4a9));}else _0xef7cfc===0x0&&alert(_0x4f7bd8(0x2d1));}function _0xf28e1e(){const _0x9d774f=_0x247bea;document['getElementById'](_0x9d774f(0x48a))[_0x9d774f(0x10d3)]['remove'](_0x9d774f(0x143));}function _0x59d7a3(){const _0x51ceb8=_0x247bea;if(!_0x12493e[_0x51ceb8(0x7bc)])return;const _0x1eb8cb=_0x12493e[_0x51ceb8(0xc45)][_0x12493e[_0x51ceb8(0x7bc)]];document[_0x51ceb8(0xc33)](_0x51ceb8(0x100))['textContent']='“'+_0x1eb8cb[_0x51ceb8(0x578)]+_0x51ceb8(0xe3e),_0x1ca77a(),document[_0x51ceb8(0xc33)]('group-avatar-library-modal')['classList'][_0x51ceb8(0xb9)](_0x51ceb8(0x143));}function _0x1ca77a(){const _0xdafb15=_0x247bea,_0x645574=document[_0xdafb15(0xc33)](_0xdafb15(0xcc));_0x645574[_0xdafb15(0x102a)]='';const _0x2a79a3=_0x12493e[_0xdafb15(0xc45)][_0x12493e[_0xdafb15(0x7bc)]],_0x5b1ab9=_0x2a79a3[_0xdafb15(0x2ea)][_0xdafb15(0x100d)]||[];if(_0x5b1ab9[_0xdafb15(0x79b)]===0x0){_0x645574[_0xdafb15(0x102a)]='<p\x20style=\x22color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x22>这个头像库还是空的，点击右上角“添加”吧！</p>';return;}_0x5b1ab9[_0xdafb15(0xd6a)]((_0x312596,_0x4498d5)=>{const _0x1f4bee=_0xdafb15,_0x1986ec=document[_0x1f4bee(0x1292)](_0x1f4bee(0x58c));_0x1986ec['className']='sticker-item',_0x1986ec[_0x1f4bee(0x874)]=_0x312596[_0x1f4bee(0x578)],_0x1986ec[_0x1f4bee(0x102a)]=_0x1f4bee(0x87f)+_0x312596['url']+_0x1f4bee(0x58a)+_0x312596['name']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';const _0x55b44e=document[_0x1f4bee(0x1292)]('div');_0x55b44e['className']=_0x1f4bee(0x7d1),_0x55b44e['innerHTML']='×',_0x55b44e[_0x1f4bee(0x105d)][_0x1f4bee(0xf44)]=_0x1f4bee(0xa20),_0x55b44e['onclick']=async _0x327aa4=>{const _0x2e0fa8=_0x1f4bee;_0x327aa4[_0x2e0fa8(0xea2)]();const _0x53bd41=await _0x270512(_0x2e0fa8(0xa94),_0x2e0fa8(0x3e7)+_0x312596[_0x2e0fa8(0x578)]+_0x2e0fa8(0x6ec),{'confirmButtonClass':_0x2e0fa8(0xa2)});_0x53bd41&&(_0x2a79a3[_0x2e0fa8(0x2ea)][_0x2e0fa8(0x100d)][_0x2e0fa8(0xbd1)](_0x4498d5,0x1),await _0x2a2987[_0x2e0fa8(0xc45)]['put'](_0x2a79a3),_0x1ca77a());},_0x1986ec[_0x1f4bee(0xf77)](_0x55b44e),_0x645574[_0x1f4bee(0xf77)](_0x1986ec);});}async function _0x542b0f(){const _0x520105=_0x247bea,_0xfb9e13=await _0x1ca09c('添加头像',_0x520105(0x66c));if(!_0xfb9e13||!_0xfb9e13[_0x520105(0x7da)]())return;const _0x437459=await _0x1ca09c('添加头像',_0x520105(0x1159),'',_0x520105(0x11a));if(!_0x437459||!_0x437459['trim']()[_0x520105(0xece)](_0x520105(0xd8d))){alert(_0x520105(0x107f));return;}const _0x149c24=_0x12493e['chats'][_0x12493e[_0x520105(0x7bc)]];!_0x149c24[_0x520105(0x2ea)][_0x520105(0x100d)]&&(_0x149c24['settings'][_0x520105(0x100d)]=[]),_0x149c24[_0x520105(0x2ea)][_0x520105(0x100d)][_0x520105(0x2d6)]({'name':_0xfb9e13[_0x520105(0x7da)](),'url':_0x437459['trim']()}),await _0x2a2987[_0x520105(0xc45)][_0x520105(0xf36)](_0x149c24),_0x1ca77a();}function _0x19c8de(){const _0x5eb854=_0x247bea;document[_0x5eb854(0xc33)](_0x5eb854(0x81))[_0x5eb854(0x10d3)]['remove']('visible');}async function _0x405d83(_0x12301e){const _0x138226=_0x247bea,_0x5ea5bf=_0x138226(0xf84),_0x3722d6=await _0x1ca09c('批量导入头像',_0x5ea5bf,'',_0x138226(0x89c));_0x3722d6&&_0x3722d6[_0x138226(0x7da)]()&&await _0x362f29(_0x12301e,_0x3722d6);}async function _0x362f29(_0x67b37c,_0x4aac52){const _0x423eb=_0x247bea,_0x51323b=_0x12493e[_0x423eb(0xc45)][_0x12493e[_0x423eb(0x7bc)]];if(!_0x51323b)return;const _0x2f32eb=_0x4aac52[_0x423eb(0x7da)]()['split']('\x0a'),_0x73a78=[],_0x20fad2='https://files.catbox.moe/';let _0x1e2fa8=0x0;for(const _0x27b3e9 of _0x2f32eb){const _0x425b4b=_0x27b3e9[_0x423eb(0x7da)]();if(!_0x425b4b||_0x425b4b[_0x423eb(0x1d4)](_0x423eb(0xd8d))||_0x425b4b[_0x423eb(0x1d4)]('填入'))continue;let _0x3da140=null,_0x4d2851=null;const _0x2d8e88=_0x425b4b[_0x423eb(0x1242)](/^([\u4e00-\u9fa5]+)([a-zA-Z0-9]+\..+)$/);if(_0x2d8e88)_0x3da140=_0x2d8e88[0x1],_0x4d2851=_0x2d8e88[0x2];else{const _0x1b5717=_0x425b4b['split'](/\s+/);_0x1b5717[_0x423eb(0x79b)]>=0x2&&(_0x4d2851=_0x1b5717[_0x423eb(0xf56)](),_0x3da140=_0x1b5717['join']('\x20'));}_0x3da140&&_0x4d2851&&_0x4d2851[_0x423eb(0x1d4)]('.')?_0x73a78[_0x423eb(0x2d6)]({'name':_0x3da140,'url':_0x20fad2+_0x4d2851}):(_0x1e2fa8++,console['warn'](_0x423eb(0x861),_0x425b4b));}_0x1e2fa8>0x0&&await _0x2d7ddd('部分导入失败','有\x20'+_0x1e2fa8+_0x423eb(0x429));if(_0x73a78[_0x423eb(0x79b)]>0x0){if(_0x67b37c==='ai'){if(!_0x51323b[_0x423eb(0x2ea)][_0x423eb(0xfc5)])_0x51323b[_0x423eb(0x2ea)][_0x423eb(0xfc5)]=[];_0x51323b['settings'][_0x423eb(0xfc5)][_0x423eb(0x2d6)](..._0x73a78),await _0x2a2987[_0x423eb(0xc45)][_0x423eb(0xf36)](_0x51323b),_0x4a5796();}else{if(_0x67b37c===_0x423eb(0x121f)){if(!_0x51323b[_0x423eb(0x2ea)][_0x423eb(0x100d)])_0x51323b[_0x423eb(0x2ea)][_0x423eb(0x100d)]=[];_0x51323b[_0x423eb(0x2ea)][_0x423eb(0x100d)]['push'](..._0x73a78),await _0x2a2987['chats']['put'](_0x51323b),_0x1ca77a();}}await _0x2d7ddd(_0x423eb(0x455),_0x423eb(0xd30)+_0x73a78[_0x423eb(0x79b)]+_0x423eb(0x4a9));}else _0x1e2fa8===0x0&&alert(_0x423eb(0x1e3));}async function _0x3427c0(){const _0x5acb97=_0x247bea,_0x1b927b=await _0x1ca09c(_0x5acb97(0xa89),_0x5acb97(0x66c));if(!_0x1b927b||!_0x1b927b[_0x5acb97(0x7da)]())return;const _0x4064c7=await _0x1ca09c(_0x5acb97(0xa89),_0x5acb97(0x1159),'',_0x5acb97(0x11a));if(!_0x4064c7||!_0x4064c7['trim']()[_0x5acb97(0xece)]('http')){alert(_0x5acb97(0x107f));return;}const _0x4f700d=_0x12493e['chats'][_0x12493e[_0x5acb97(0x7bc)]];!_0x4f700d[_0x5acb97(0x2ea)]['groupAvatarLibrary']&&(_0x4f700d[_0x5acb97(0x2ea)][_0x5acb97(0x100d)]=[]),_0x4f700d[_0x5acb97(0x2ea)][_0x5acb97(0x100d)][_0x5acb97(0x2d6)]({'name':_0x1b927b['trim'](),'url':_0x4064c7[_0x5acb97(0x7da)]()}),await _0x2a2987['chats'][_0x5acb97(0xf36)](_0x4f700d),_0x1ca77a();}function _0x37a720(_0x42ab66){return new Promise(_0x20c010=>{const _0x33d267=_0x26e9,_0xc0162c=document[_0x33d267(0xc33)](_0x33d267(0x1243)),_0x175a79=document['getElementById'](_0x33d267(0x7ea)),_0x37f586=document[_0x33d267(0xc33)](_0x33d267(0xb77)),_0x128cec=document[_0x33d267(0xc33)]('chat-list-action-cancel');_0x175a79[_0x33d267(0x11b0)]=_0x42ab66[_0x33d267(0x4fe)]?_0x33d267(0xaae):_0x33d267(0x377);const _0x5d9572=_0x175a79[_0x33d267(0xbc5)](!![]);_0x175a79[_0x33d267(0x1053)][_0x33d267(0xcaa)](_0x5d9572,_0x175a79),_0x5d9572[_0x33d267(0x8a)]=()=>{const _0x26128=_0x33d267;_0xc0162c['classList'][_0x26128(0x2c7)](_0x26128(0x143)),_0x20c010(_0x26128(0x69e));};const _0x30be9e=_0x37f586['cloneNode'](!![]);_0x37f586[_0x33d267(0x1053)][_0x33d267(0xcaa)](_0x30be9e,_0x37f586),_0x30be9e['onclick']=()=>{const _0xd5549f=_0x33d267;_0xc0162c[_0xd5549f(0x10d3)][_0xd5549f(0x2c7)]('visible'),_0x20c010(_0xd5549f(0x9ea));};const _0x5f3327=_0x128cec[_0x33d267(0xbc5)](!![]);_0x128cec[_0x33d267(0x1053)][_0x33d267(0xcaa)](_0x5f3327,_0x128cec),_0x5f3327['onclick']=()=>{const _0x2cca5a=_0x33d267;_0xc0162c[_0x2cca5a(0x10d3)][_0x2cca5a(0x2c7)]('visible'),_0x20c010(null);},_0xc0162c[_0x33d267(0x10d3)][_0x33d267(0xb9)](_0x33d267(0x143));});}function _0x44847e(){const _0x3c33f7=_0x247bea,_0x14d519=document[_0x3c33f7(0xc33)](_0x3c33f7(0x6c1)),_0x45ce96=_0x12493e[_0x3c33f7(0x10f6)][_0x3c33f7(0x2f5)];_0x45ce96?_0x14d519[_0x3c33f7(0x105d)]['backgroundImage']=_0x3c33f7(0xb23)+_0x45ce96+')':_0x14d519[_0x3c33f7(0x105d)]['backgroundImage']=_0x3c33f7(0x530);}function _0x1ed875(){const _0x7b772=_0x247bea;if(!_0x12493e[_0x7b772(0x10f6)]['cphoneAppIcons'])return;for(const _0x50fbd6 in _0x12493e[_0x7b772(0x10f6)][_0x7b772(0x2d4)]){const _0x798ae7=document[_0x7b772(0xc33)](_0x7b772(0x31d)+_0x50fbd6);_0x798ae7&&(_0x798ae7[_0x7b772(0x87b)]=_0x12493e[_0x7b772(0x10f6)][_0x7b772(0x2d4)][_0x50fbd6]);}}function _0x45c50d(){const _0x4fcd76=_0x247bea,_0x173ef1=document[_0x4fcd76(0xc33)]('cphone-icon-settings-grid');if(!_0x173ef1)return;_0x173ef1[_0x4fcd76(0x102a)]='';const _0x2eb60b={'qq':'QQ','album':'相册','browser':_0x4fcd76(0x821),'taobao':'淘宝','memo':_0x4fcd76(0x100a),'diary':'日记','amap':_0x4fcd76(0x51e),'usage':_0x4fcd76(0xaf6),'music':_0x4fcd76(0x515),'ephone':_0x4fcd76(0xbbd)};for(const _0x423d47 in _0x12493e[_0x4fcd76(0x10f6)]['cphoneAppIcons']){const _0x2ced7a=_0x12493e[_0x4fcd76(0x10f6)]['cphoneAppIcons'][_0x423d47],_0x1201f8=_0x2eb60b[_0x423d47]||_0x4fcd76(0xaa3),_0x5587d4=document[_0x4fcd76(0x1292)](_0x4fcd76(0x58c));_0x5587d4[_0x4fcd76(0x84)]=_0x4fcd76(0x6bc),_0x5587d4[_0x4fcd76(0x85)][_0x4fcd76(0x12f)]=_0x423d47,_0x5587d4[_0x4fcd76(0x102a)]=_0x4fcd76(0x30b)+_0x2ced7a+_0x4fcd76(0xd71)+_0x1201f8+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22change-icon-btn\x22>更换</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x173ef1[_0x4fcd76(0xf77)](_0x5587d4);}}function _0x21aa4c(){const _0x3da7e7=_0x247bea;if(!_0x12493e[_0x3da7e7(0x10f6)]['appIcons'])return;for(const _0x5223ea in _0x12493e[_0x3da7e7(0x10f6)][_0x3da7e7(0x4da)]){const _0x180c6f=document['getElementById'](_0x3da7e7(0x1114)+_0x5223ea);_0x180c6f&&(_0x180c6f[_0x3da7e7(0x87b)]=_0x12493e[_0x3da7e7(0x10f6)]['appIcons'][_0x5223ea]);}}function _0x2ee1a1(){const _0x25e0d9=_0x247bea,_0x279eef=document[_0x25e0d9(0xc33)](_0x25e0d9(0x181));if(!_0x279eef)return;_0x279eef[_0x25e0d9(0x102a)]='';const _0x466acc={'qq':'QQ','world-book':_0x25e0d9(0x628),'wallpaper':_0x25e0d9(0x894),'renderer':_0x25e0d9(0x8b0),'api-settings':_0x25e0d9(0xd8e),'font':'字体','char-phone':_0x25e0d9(0x8ce),'douban':_0x25e0d9(0x3a6),'preset':'预设','tutorial':'教程','werewolf':_0x25e0d9(0x441),'x':'X'};for(const _0x59bfa2 in _0x12493e[_0x25e0d9(0x10f6)][_0x25e0d9(0x4da)]){const _0x45df27=_0x12493e[_0x25e0d9(0x10f6)][_0x25e0d9(0x4da)][_0x59bfa2],_0x413025=_0x466acc[_0x59bfa2]||_0x25e0d9(0x8ce),_0x948d38=document['createElement'](_0x25e0d9(0x58c));_0x948d38[_0x25e0d9(0x84)]=_0x25e0d9(0x6bc),_0x948d38[_0x25e0d9(0x85)]['iconId']=_0x59bfa2,_0x948d38['innerHTML']=_0x25e0d9(0x30b)+_0x45df27+_0x25e0d9(0xd71)+_0x413025+_0x25e0d9(0xf59),_0x279eef[_0x25e0d9(0xf77)](_0x948d38);}}function _0x4689ef(_0x5290ae){const _0x23d8d9=_0x247bea;if(!_0x12493e[_0x23d8d9(0x7bc)])return;const _0x5a9cb0=_0x12493e[_0x23d8d9(0xc45)][_0x12493e[_0x23d8d9(0x7bc)]];if(!_0x5a9cb0||!_0x5a9cb0[_0x23d8d9(0x1294)])return;const _0x512715=_0x5a9cb0[_0x23d8d9(0x1294)][_0x23d8d9(0xd85)](_0x3d5aa7=>_0x3d5aa7[_0x23d8d9(0x2f0)]===_0x5290ae);if(!_0x512715||_0x512715[_0x23d8d9(0x52a)]!==_0x23d8d9(0xa6a)){console[_0x23d8d9(0x4d9)](_0x23d8d9(0xb28),_0x5290ae);return;}document[_0x23d8d9(0xc33)](_0x23d8d9(0xa95))[_0x23d8d9(0x11b0)]=_0x512715['source_name']||'文章详情';const _0x4a8549=document[_0x23d8d9(0xc33)](_0x23d8d9(0x477));_0x4a8549[_0x23d8d9(0x102a)]=_0x23d8d9(0xef9)+(_0x512715[_0x23d8d9(0x874)]||_0x23d8d9(0x645))+'</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22article-meta\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>来源:\x20'+(_0x512715['source_name']||'未知')+_0x23d8d9(0x918)+(_0x512715[_0x23d8d9(0xcbd)]||_0x23d8d9(0xde2))['replace'](/\n/g,_0x23d8d9(0x808))+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x38f00f(_0x23d8d9(0x1167));}function _0x542989(){const _0x2d3241=_0x247bea;_0x38f00f(_0x2d3241(0xf1b));}function _0x542989(){const _0xc5ab43=_0x247bea;_0x38f00f(_0xc5ab43(0xf1b));}function _0x28c400(){const _0x2d222d=_0x247bea;if(!_0x12493e[_0x2d222d(0x7bc)])return;document['getElementById'](_0x2d222d(0xab8))[_0x2d222d(0x22a)]='',document[_0x2d222d(0xc33)](_0x2d222d(0xcc8))[_0x2d222d(0x22a)]='',document[_0x2d222d(0xc33)]('link-source-input')['value']='',document[_0x2d222d(0xc33)]('link-content-input')['value']='',document[_0x2d222d(0xc33)](_0x2d222d(0x461))[_0x2d222d(0x10d3)]['add'](_0x2d222d(0x143));}async function _0x3ea51b(){const _0x436595=_0x247bea;if(!_0x12493e[_0x436595(0x7bc)])return;const _0x2f3789=document['getElementById']('link-title-input')[_0x436595(0x22a)]['trim']();if(!_0x2f3789){alert(_0x436595(0xcf6));return;}const _0x4dd573=document[_0x436595(0xc33)](_0x436595(0xcc8))[_0x436595(0x22a)][_0x436595(0x7da)](),_0x14e5df=document['getElementById']('link-source-input')[_0x436595(0x22a)][_0x436595(0x7da)](),_0x42ca91=document['getElementById'](_0x436595(0x784))[_0x436595(0x22a)][_0x436595(0x7da)](),_0x1aed80=_0x12493e[_0x436595(0xc45)][_0x12493e['activeChatId']],_0x47ca0c={'role':_0x436595(0x717),'type':_0x436595(0xa6a),'timestamp':Date[_0x436595(0x6ee)](),'title':_0x2f3789,'description':_0x4dd573,'source_name':_0x14e5df,'content':_0x42ca91,'thumbnail_url':null};_0x1aed80[_0x436595(0x1294)][_0x436595(0x2d6)](_0x47ca0c),await _0x2a2987[_0x436595(0xc45)][_0x436595(0xf36)](_0x1aed80),_0x468ef0(_0x47ca0c,_0x1aed80),_0x597ed7(),document['getElementById']('share-link-modal')[_0x436595(0x10d3)][_0x436595(0x2c7)](_0x436595(0x143));}function _0x32f53c(_0x307700,_0x24f006){const _0x20d5e0=_0x247bea;if(!_0x24f006||!_0x24f006['id'])return[];const _0x316bca=_0x24f006[_0x20d5e0(0x780)],_0x561938=_0x24f006['id'];return _0x307700[_0x20d5e0(0x1054)](_0x2358e7=>{const _0x44ded0=_0x20d5e0;if(_0x2358e7[_0x44ded0(0xd48)]===_0x44ded0(0x717)){if(_0x2358e7['visibleGroupIds']&&_0x2358e7[_0x44ded0(0xbd)][_0x44ded0(0x79b)]>0x0)return _0x316bca&&_0x2358e7['visibleGroupIds']['includes'](_0x316bca);return!![];}if(String(_0x2358e7[_0x44ded0(0xd48)])[_0x44ded0(0xece)]('npc_')){if(Array['isArray'](_0x2358e7[_0x44ded0(0xab0)]))return _0x2358e7[_0x44ded0(0xab0)][_0x44ded0(0x1d4)](_0x561938);return![];}const _0x2155fb=_0x12493e[_0x44ded0(0xc45)][_0x2358e7['authorId']];if(!_0x2155fb)return![];const _0x59904e=_0x2155fb[_0x44ded0(0x780)],_0x54208b=_0x59904e&&_0x316bca&&_0x59904e===_0x316bca,_0x2a16df=!_0x59904e&&!_0x316bca;return _0x54208b||_0x2a16df;});}function _0x11d9f4(_0x4b3db5){const _0x1ca5a5=_0x247bea,_0x103b1a=document['getElementById'](_0x1ca5a5(0x779)),_0x2e6266=document[_0x1ca5a5(0xc33)](_0x1ca5a5(0x8f9)),_0xedd020=_0x4b3db5==='dark';_0x103b1a[_0x1ca5a5(0x10d3)][_0x1ca5a5(0xe2c)](_0x1ca5a5(0x10d2),_0xedd020),_0x2e6266&&(_0x2e6266[_0x1ca5a5(0x737)]=_0xedd020),localStorage[_0x1ca5a5(0xec8)](_0x1ca5a5(0x3f1),_0x4b3db5);}function _0x49a863(){const _0x940b43=_0x247bea,_0x5be5a4=document[_0x940b43(0xc33)](_0x940b43(0x8f9)),_0x3a1e0e=_0x5be5a4[_0x940b43(0x737)]?'dark':_0x940b43(0x5b3);_0x11d9f4(_0x3a1e0e);}function _0x519f0f(){const _0x20d1dd=_0x247bea;if(!_0x12493e[_0x20d1dd(0x7bc)])return;_0x4bc13a(),_0x38f00f(_0x20d1dd(0xfaa));}function _0x4bc13a(){const _0x4d43a6=_0x247bea,_0x5ba7a1=document[_0x4d43a6(0xc33)]('memory-list-container'),_0x41f3f6=_0x12493e['chats'][_0x12493e[_0x4d43a6(0x7bc)]];_0x5ba7a1['innerHTML']='';let _0x3e76d7=[];_0x41f3f6[_0x4d43a6(0x80b)]?_0x41f3f6[_0x4d43a6(0xd5b)][_0x4d43a6(0xd6a)](_0x38d761=>{const _0x3bfff7=_0x4d43a6,_0x36303f=_0x12493e['chats'][_0x38d761['id']];if(_0x36303f&&_0x36303f[_0x3bfff7(0x45b)]){const _0xf65b5d=_0x36303f[_0x3bfff7(0x45b)][_0x3bfff7(0x9d5)](_0x4e2213=>({..._0x4e2213,'authorName':_0x38d761[_0x3bfff7(0x6e2)],'authorChatId':_0x38d761['id']}));_0x3e76d7[_0x3bfff7(0x2d6)](..._0xf65b5d);}}):_0x41f3f6[_0x4d43a6(0x45b)]&&(_0x3e76d7=_0x41f3f6[_0x4d43a6(0x45b)][_0x4d43a6(0x9d5)](_0x3cd3e2=>({..._0x3cd3e2,'authorName':_0x41f3f6[_0x4d43a6(0x578)],'authorChatId':_0x41f3f6['id']})));if(_0x3e76d7[_0x4d43a6(0x79b)]===0x0){_0x5ba7a1[_0x4d43a6(0x102a)]=_0x4d43a6(0xcee);return;}_0x3e76d7['sort']((_0x1fed1e,_0x40c980)=>_0x40c980[_0x4d43a6(0x2f0)]-_0x1fed1e['timestamp']),_0x3e76d7[_0x4d43a6(0xd6a)]((_0x5e24a6,_0x4fb573)=>{const _0x2669bb=_0x4d43a6,_0x5cc117=document[_0x2669bb(0x1292)](_0x2669bb(0x58c));_0x5cc117[_0x2669bb(0x84)]=_0x2669bb(0xc0),_0x5cc117['style'][_0x2669bb(0x437)]=_0x2669bb(0xfae),_0x5cc117['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20flex-start;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22\x20style=\x22padding:\x200;\x20flex-grow:\x201;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20新增：显示记忆来源\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-size:\x200.8em;\x20color:\x20#999;\x20margin-bottom:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20[\x20'+_0x5e24a6[_0x2669bb(0x43b)]+_0x2669bb(0x1074)+_0x5e24a6[_0x2669bb(0xcbd)][_0x2669bb(0xc12)](/\n/g,'<br>')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20gap:\x208px;\x20flex-shrink:\x200;\x20margin-left:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22memory-action-btn\x20edit-memory-btn\x22\x20data-author-id=\x22'+_0x5e24a6[_0x2669bb(0xffd)]+_0x2669bb(0x5e3)+_0x5e24a6['timestamp']+_0x2669bb(0xf30)+_0x5e24a6[_0x2669bb(0xffd)]+_0x2669bb(0x5e3)+_0x5e24a6['timestamp']+_0x2669bb(0xce8),_0x5ba7a1[_0x2669bb(0xf77)](_0x5cc117);});}async function _0x1050c4(){const _0x81ca77=_0x247bea,_0x56eec4=_0x12493e[_0x81ca77(0xc45)][_0x12493e['activeChatId']];if(!_0x56eec4)return;let _0x20d5b7=_0x56eec4;if(_0x56eec4[_0x81ca77(0x80b)]){const _0x33ad06=_0x56eec4[_0x81ca77(0xd5b)]['map'](_0x12be66=>({'text':'为“'+_0x12be66['groupNickname']+_0x81ca77(0x527),'value':_0x12be66['id']})),_0x101047=await _0x46f58a(_0x81ca77(0xef2),_0x33ad06);if(!_0x101047)return;_0x20d5b7=_0x12493e[_0x81ca77(0xc45)][_0x101047];if(!_0x20d5b7){alert(_0x81ca77(0xa9d));return;}}const _0x414140=await _0x1ca09c('为“'+_0x20d5b7[_0x81ca77(0x578)]+_0x81ca77(0x527),'请输入要添加的记忆要点：','',_0x81ca77(0x89c));if(_0x414140&&_0x414140[_0x81ca77(0x7da)]()){if(!_0x20d5b7[_0x81ca77(0x45b)])_0x20d5b7['longTermMemory']=[];_0x20d5b7[_0x81ca77(0x45b)][_0x81ca77(0x2d6)]({'content':_0x414140[_0x81ca77(0x7da)](),'timestamp':Date[_0x81ca77(0x6ee)](),'source':_0x81ca77(0xca6)}),await _0x2a2987['chats']['put'](_0x20d5b7),_0x4bc13a();}}async function _0x2f3aad(_0x500802,_0x47ee77){const _0x31ab68=_0x247bea,_0x557499=_0x12493e[_0x31ab68(0xc45)][_0x500802];if(!_0x557499||!_0x557499[_0x31ab68(0x45b)])return;const _0x45e325=_0x557499[_0x31ab68(0x45b)]['findIndex'](_0x37ce62=>_0x37ce62[_0x31ab68(0x2f0)]===_0x47ee77);if(_0x45e325===-0x1)return;const _0x4fb156=_0x557499[_0x31ab68(0x45b)][_0x45e325],_0x16d810=await _0x1ca09c(_0x31ab68(0x6e8),_0x31ab68(0x49b),_0x4fb156[_0x31ab68(0xcbd)],_0x31ab68(0x89c));_0x16d810&&_0x16d810[_0x31ab68(0x7da)]()&&(_0x4fb156[_0x31ab68(0xcbd)]=_0x16d810[_0x31ab68(0x7da)](),await _0x2a2987['chats'][_0x31ab68(0xf36)](_0x557499),_0x4bc13a());}async function _0x32f7b1(_0x183f7e,_0x54e922){const _0x532ace=_0x247bea,_0x455a7b=await _0x270512(_0x532ace(0x8d6),'确定要删除这条长期记忆吗？',{'confirmButtonClass':'btn-danger'});if(_0x455a7b){const _0x4423e3=_0x12493e[_0x532ace(0xc45)][_0x183f7e];if(!_0x4423e3||!_0x4423e3['longTermMemory'])return;_0x4423e3[_0x532ace(0x45b)]=_0x4423e3['longTermMemory'][_0x532ace(0x1054)](_0xf81242=>_0xf81242[_0x532ace(0x2f0)]!==_0x54e922),await _0x2a2987['chats'][_0x532ace(0xf36)](_0x4423e3),_0x4bc13a();}}async function _0x4a05e6(){const _0x5254fa=await _0x270512('确认操作','这将提取最近的对话内容发送给AI进行总结，会消耗API额度。确定要继续吗？');_0x5254fa&&await _0x3296a7(_0x12493e['activeChatId'],!![]);}async function _0x1ffd9c(_0x3a77f7){const _0x2086af=_0x247bea,_0x556e85=_0x12493e[_0x2086af(0xc45)][_0x3a77f7];if(!_0x556e85||!_0x556e85[_0x2086af(0x2ea)][_0x2086af(0x86)])return;const _0x5c79fa=_0x556e85['lastMemorySummaryTimestamp']||0x0,_0x196dec=_0x556e85[_0x2086af(0x1294)]['filter'](_0x317ce7=>_0x317ce7['timestamp']>_0x5c79fa&&!_0x317ce7[_0x2086af(0xd07)]);_0x196dec[_0x2086af(0x79b)]>=_0x556e85['settings'][_0x2086af(0x10da)]&&(console[_0x2086af(0x51f)](_0x2086af(0x34b)+_0x196dec['length']+'/'+_0x556e85[_0x2086af(0x2ea)][_0x2086af(0x10da)]+')，开始总结...'),await _0x3296a7(_0x3a77f7));}async function _0x32d54d(_0x24919f,_0x301b88){const _0x4f63cd=_0x247bea,_0x39fe08=_0x12493e[_0x4f63cd(0xc45)][_0x24919f];if(!_0x39fe08||!_0x301b88)throw new Error(_0x4f63cd(0xe82));const _0x1ce943=_0x12493e[_0x4f63cd(0x76c)][_0x4f63cd(0x66a)]||'用户';let _0x210044,_0x166cb7=_0x39fe08;const _0x54f776=new Date()[_0x4f63cd(0x11f9)]('zh-CN',{'year':'numeric','month':_0x4f63cd(0x330),'day':'numeric'});if(_0x39fe08[_0x4f63cd(0x80b)]){let _0xb41451=null;_0x3b6ec9['callRequester']&&(_0xb41451=_0x39fe08[_0x4f63cd(0xd5b)][_0x4f63cd(0xd85)](_0x5dc306=>_0x5dc306[_0x4f63cd(0x776)]===_0x3b6ec9['callRequester']));!_0xb41451&&(_0xb41451=_0x39fe08[_0x4f63cd(0xd5b)][_0x4f63cd(0xd85)](_0x3e5b3b=>_0x3e5b3b['id']!==_0x4f63cd(0x717)&&_0x3b6ec9[_0x4f63cd(0x10d4)][_0x4f63cd(0xfa7)](_0x2e9d4b=>_0x2e9d4b['id']===_0x3e5b3b['id'])));!_0xb41451&&(_0xb41451=_0x39fe08[_0x4f63cd(0xd5b)][_0x4f63cd(0xd85)](_0x3b63e8=>_0x3b63e8['id']!=='user'));if(!_0xb41451)throw new Error(_0x4f63cd(0x9c1));const _0xa80cec=_0x12493e[_0x4f63cd(0xc45)][_0xb41451['id']];if(!_0xa80cec)throw new Error(_0x4f63cd(0x7fe)+_0xb41451[_0x4f63cd(0x6e2)]+_0x4f63cd(0x12ae));const _0x4e50dd=_0x39fe08[_0x4f63cd(0x2ea)][_0x4f63cd(0xf75)]||'(未设置)';_0x210044='\x0a#\x20你的任务\x0a你就是角色“'+_0xb41451[_0x4f63cd(0x776)]+_0x4f63cd(0xb4e)+_0x1ce943+_0x4f63cd(0x336)+_0x54f776+'**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**关键议题**:\x20我们在群聊通话里讨论了哪些核心话题？\x0a\x20\x20\x20\x20*\x20\x20\x20**重要决定与共识**:\x20我们达成了什么共识或做出了什么决定？\x0a\x20\x20\x20\x20*\x20\x20\x20**后续计划与任务**:\x20有没有确定下来什么下一步的行动或计划？\x0a\x20\x20\x20\x20*\x20\x20\x20**关键信息**:\x20有没有交换什么重要的信息？（例如：约定了时间、地点等）\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果通话中提到了相对时间（如“明天”），你【必须】结合“今天是'+_0x54f776+_0x4f63cd(0x121)+_0xa80cec[_0x4f63cd(0x2ea)][_0x4f63cd(0x679)]+'\x0a\x0a#\x20你的聊天对象（用户）的人设\x0a'+_0x4e50dd+_0x4f63cd(0x66e)+_0x301b88+_0x4f63cd(0x428)+_0xb41451['originalName']+'”的身份，开始你的客观总结。',_0x166cb7=_0xa80cec;}else _0x210044=_0x4f63cd(0xcc4)+_0x39fe08[_0x4f63cd(0x776)]+_0x4f63cd(0x85f)+_0x1ce943+'”的视频通话，然后用【第一人称\x20(\x22我\x22)】的口吻，总结出一段简短的、客观的、包含关键信息的记忆。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：'+_0x54f776+'**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**关键议题**:\x20我们聊了什么核心话题？\x0a\x20\x20\x20\x20*\x20\x20\x20**重要决定与共识**:\x20我们达成了什么共识或做出了什么决定？\x0a\x20\x20\x20\x20*\x20\x20\x20**后续计划与任务**:\x20有没有确定下来什么下一步的行动或计划？\x0a\x20\x20\x20\x20*\x20\x20\x20**关键信息**:\x20有没有交换什么重要的信息？（例如：约定了时间、地点等）\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果通话中提到了相对时间（如“明天”），你【必须】结合“今天是'+_0x54f776+_0x4f63cd(0x1085)+_0x39fe08[_0x4f63cd(0x2ea)][_0x4f63cd(0x679)]+_0x4f63cd(0xf97)+_0x39fe08[_0x4f63cd(0x2ea)]['myPersona']+_0x4f63cd(0x1e1)+_0x301b88+_0x4f63cd(0x428)+_0x39fe08[_0x4f63cd(0x776)]+_0x4f63cd(0xe3a);try{const _0x490c2b=_0x12493e['apiConfig'][_0x4f63cd(0x246)]&&_0x12493e['apiConfig']['secondaryApiKey']&&_0x12493e[_0x4f63cd(0xdd4)][_0x4f63cd(0x479)],{proxyUrl:_0x626aa8,apiKey:_0x422fc5,model:_0x47e5a9}=_0x490c2b?{'proxyUrl':_0x12493e[_0x4f63cd(0xdd4)]['secondaryProxyUrl'],'apiKey':_0x12493e['apiConfig'][_0x4f63cd(0xbd3)],'model':_0x12493e[_0x4f63cd(0xdd4)][_0x4f63cd(0x479)]}:_0x12493e[_0x4f63cd(0xdd4)];if(!_0x626aa8||!_0x422fc5||!_0x47e5a9)throw new Error(_0x4f63cd(0x3bd));let _0x4a7ade=_0x626aa8[_0x4f63cd(0x1d4)](_0x4f63cd(0x113e)),_0x2b51a2=_0x202ea1(_0x47e5a9,_0x422fc5,_0x210044,[{'role':_0x4f63cd(0x717),'content':_0x4f63cd(0xa0f)}]);const _0xf0a9fd=_0x4a7ade?await fetch(_0x2b51a2[_0x4f63cd(0x11a)],_0x2b51a2['data']):await fetch(_0x626aa8+'/v1/chat/completions',{'method':_0x4f63cd(0x90),'headers':{'Content-Type':_0x4f63cd(0xd74),'Authorization':_0x4f63cd(0xf20)+_0x422fc5},'body':JSON[_0x4f63cd(0xd27)]({'model':_0x47e5a9,'messages':[{'role':_0x4f63cd(0x152),'content':_0x210044},{'role':_0x4f63cd(0x717),'content':_0x4f63cd(0xa0f)}],'temperature':0.1})});if(!_0xf0a9fd['ok']){const _0x1bf4cd=await _0xf0a9fd['json']()[_0x4f63cd(0x876)](()=>({'error':{'message':_0xf0a9fd[_0x4f63cd(0x109a)]}}));throw new Error(_0x4f63cd(0x3e0)+_0xf0a9fd['status']+_0x4f63cd(0x804)+_0x1bf4cd[_0x4f63cd(0x4d9)][_0x4f63cd(0xf93)]);}const _0x363323=await _0xf0a9fd['json']();let _0x11ac4d=_0x4a7ade?getGeminiResponseText(_0x363323):_0x363323['choices'][0x0][_0x4f63cd(0xf93)][_0x4f63cd(0xcbd)];_0x11ac4d=_0x11ac4d['replace'](/^```json\s*/,'')['replace'](/```$/,'')[_0x4f63cd(0x7da)]();const _0x810ac5=JSON[_0x4f63cd(0x6b1)](_0x11ac4d);if(_0x810ac5[_0x4f63cd(0xaa5)]&&_0x810ac5[_0x4f63cd(0xaa5)][_0x4f63cd(0x7da)]()){const _0x4b1615={'content':_0x4f63cd(0xbfb)+(_0x39fe08['isGroup']?'群聊':'')+'通话中，'+_0x810ac5[_0x4f63cd(0xaa5)][_0x4f63cd(0x7da)]()+')','timestamp':Date['now'](),'source':_0x39fe08[_0x4f63cd(0x80b)]?_0x4f63cd(0x5d8):_0x4f63cd(0x315)};if(!_0x166cb7[_0x4f63cd(0x45b)])_0x166cb7[_0x4f63cd(0x45b)]=[];return _0x166cb7[_0x4f63cd(0x45b)]['push'](_0x4b1615),await _0x2a2987[_0x4f63cd(0xc45)][_0x4f63cd(0xf36)](_0x166cb7),console['log'](_0x4f63cd(0x545)+_0x166cb7[_0x4f63cd(0x578)]+_0x4f63cd(0x9a1)),!![];}else throw new Error(_0x4f63cd(0x78e));}catch(_0x5e649c){console[_0x4f63cd(0x4d9)](_0x4f63cd(0x772),_0x5e649c);throw _0x5e649c;}}function _0xc06e3a(_0x4c8456){const _0x5f4bc9=_0x247bea,_0x124aef=new Set(['的','是','了','在','我','你','他','她','它','我们','你们','他们','这','那','一个','也','和','与','或','但','然而','所以','因此','就','都','地','得','着','过','吧','吗','呢','啊','哦','嗯','什么','怎么','为什么','哪个','一些','这个','那个','还有']),_0x11cbac=_0x4c8456['match'](/[\u4e00-\u9fa5]+|[a-zA-Z0-9]+/g)||[],_0x2bdaa7=new Map();let _0x2817b4=0x0;_0x11cbac['forEach'](_0x3eb368=>{const _0x4bc403=_0x26e9;if(_0x3eb368[_0x4bc403(0x79b)]>0x1&&!_0x124aef[_0x4bc403(0xa7)](_0x3eb368)){const _0x46f738=(_0x2bdaa7['get'](_0x3eb368)||0x0)+0x1;_0x2bdaa7[_0x4bc403(0xdf)](_0x3eb368,_0x46f738);if(_0x46f738>_0x2817b4)_0x2817b4=_0x46f738;}});const _0x1b014a=[],_0x337436=[],_0x5b9027=_0x2817b4*0.9,_0x3b3727=_0x2817b4*0.6;_0x2bdaa7[_0x5f4bc9(0xd6a)]((_0x3b9dba,_0x4523a9)=>{const _0x58e75d=_0x5f4bc9;if(_0x3b9dba>=_0x5b9027)_0x1b014a[_0x58e75d(0x2d6)](_0x4523a9);else _0x3b9dba>=_0x3b3727&&_0x337436['push'](_0x4523a9);});const _0x573fb9=new Set(_0x1b014a),_0x2b9afa=_0x337436[_0x5f4bc9(0x1054)](_0x3b2a1f=>!_0x573fb9['has'](_0x3b2a1f))['slice'](0x0,0x5);return{'coreKeywords':_0x1b014a[_0x5f4bc9(0x111c)](0x0,0x3),'situationalKeywords':_0x2b9afa};}function _0x1c73eb(_0x5ae532,_0x24027b,_0x3807cb){const _0x67768=_0x247bea;let _0x457ca5;_0x3807cb===_0x67768(0xb69)?_0x457ca5=Date['now']()-_0x24027b*0x3c*0x3c*0x3e8:_0x457ca5=Date['now']()-_0x24027b*0x18*0x3c*0x3c*0x3e8;const _0x1413d4=_0x5ae532[_0x67768(0x1294)]['filter'](_0xd423b5=>_0xd423b5[_0x67768(0x2f0)]>_0x457ca5&&!_0xd423b5['isHidden']);if(_0x1413d4[_0x67768(0x79b)]<0x3)return'';const _0x4dd2f8=_0x1413d4[_0x67768(0x9d5)](_0x558b8b=>{const _0x5620cd=_0x67768;if(typeof _0x558b8b['content']===_0x5620cd(0x9de))return _0x558b8b[_0x5620cd(0xcbd)];if(_0x558b8b[_0x5620cd(0x52a)]===_0x5620cd(0xb41))return _0x558b8b[_0x5620cd(0xcbd)];if(_0x558b8b['type']===_0x5620cd(0x6bf))return(_0x558b8b[_0x5620cd(0x156)]||'')+'\x20'+(_0x558b8b[_0x5620cd(0x11ac)]||'');return'';})[_0x67768(0x100b)]('\x20'),_0xcbc9cf=new Set(['的','是','了','在','我','你','他','她','它','我们','你们','他们','这','那','一个','也','和','与','或','但','然而','所以','因此','就','都','地','得','着','过','吧','吗','呢','啊','哦','嗯']),_0xc016c1=_0x4dd2f8[_0x67768(0x1242)](/[\u4e00-\u9fa5]+|[a-zA-Z0-9]+/g)||[],_0x95485a=new Map();_0xc016c1[_0x67768(0xd6a)](_0xa7b585=>{const _0x2a80d1=_0x67768;_0xa7b585[_0x2a80d1(0x79b)]>0x1&&!_0xcbc9cf['has'](_0xa7b585)&&_0x95485a[_0x2a80d1(0xdf)](_0xa7b585,(_0x95485a[_0x2a80d1(0xec0)](_0xa7b585)||0x0)+0x1);});const _0x5c804b=[..._0x95485a[_0x67768(0x43e)]()][_0x67768(0xbb3)]((_0x5e171b,_0x2ba506)=>_0x2ba506[0x1]-_0x5e171b[0x1])[_0x67768(0x9d5)](_0x371b6b=>_0x371b6b[0x0]);if(_0x5c804b[_0x67768(0x79b)]===0x0)return'';let _0xc865c;return _0x3807cb===_0x67768(0xb69)?_0xc865c='最近'+_0x24027b+_0x67768(0x73a):_0x24027b===0x1?_0xc865c=_0x67768(0xe39):_0xc865c='最近'+_0x24027b+_0x67768(0xd01),'\x0a-\x20**'+_0xc865c+_0x67768(0xd54)+_0x5c804b[_0x67768(0x111c)](0x0,0x3)[_0x67768(0x100b)]('、\x20')+_0x67768(0x1079);}function _0x25fa21(_0x44d51a){const _0x46ca0c=_0x247bea;if(!_0x44d51a||typeof _0x44d51a!==_0x46ca0c(0x9de))return null;const _0x39e529=_0x44d51a[_0x46ca0c(0xc12)](/^```json\s*/,'')[_0x46ca0c(0xc12)](/```$/,'')['trim'](),_0x182f6a=_0x39e529[_0x46ca0c(0x1242)](/{[\s\S]*}/);if(_0x182f6a)try{const _0x552e3e=JSON[_0x46ca0c(0x6b1)](_0x182f6a[0x0]);return console[_0x46ca0c(0x51f)]('容错解析：策略1成功\x20(找到并解析了完整的JSON对象)'),_0x552e3e;}catch(_0x1baf0e){console['warn'](_0x46ca0c(0x38a));}const _0x397344=_0x39e529[_0x46ca0c(0x1242)](/"summary"\s*:\s*"((?:[^"\\]|\\.)*)"/);if(_0x397344&&_0x397344[0x1])return console[_0x46ca0c(0x51f)](_0x46ca0c(0x11ea)),{'summary':_0x397344[0x1][_0x46ca0c(0xc12)](/\\"/g,'\x22')};if(_0x39e529)return console[_0x46ca0c(0x51f)](_0x46ca0c(0x1228)),{'summary':_0x39e529};return null;}async function _0x36c719(_0x383a82){const _0x287a1f=_0x247bea;let _0x5f2cca=_0x12493e[_0x287a1f(0xc45)][_0x383a82];if(!_0x5f2cca)return;let _0x377e17=_0x5f2cca;if(_0x5f2cca[_0x287a1f(0x80b)]){const _0x39361c=_0x5f2cca['members']['map'](_0x347857=>{const _0x5a5c41=_0x287a1f,_0x587e8d=_0x12493e[_0x5a5c41(0xc45)][_0x347857['id']];if(_0x587e8d&&_0x587e8d[_0x5a5c41(0x45b)]&&_0x587e8d[_0x5a5c41(0x45b)][_0x5a5c41(0x79b)]>=0x2)return{'text':_0x5a5c41(0xf2a)+_0x347857[_0x5a5c41(0x6e2)]+_0x5a5c41(0xd4a)+_0x587e8d[_0x5a5c41(0x45b)][_0x5a5c41(0x79b)]+'条)','value':_0x347857['id']};return null;})[_0x287a1f(0x1054)](Boolean);if(_0x39361c[_0x287a1f(0x79b)]===0x0){alert(_0x287a1f(0x33a));return;}const _0x1fb060=await _0x46f58a(_0x287a1f(0x1026),_0x39361c);if(!_0x1fb060)return;_0x377e17=_0x12493e[_0x287a1f(0xc45)][_0x1fb060];}if(!_0x377e17[_0x287a1f(0x45b)]||_0x377e17[_0x287a1f(0x45b)][_0x287a1f(0x79b)]<0x2){alert('“'+_0x377e17['name']+_0x287a1f(0xd4));return;}const _0x5ec5c5=_0x377e17[_0x287a1f(0x45b)][_0x287a1f(0x79b)],_0xdd76c8=await _0x46f58a(_0x287a1f(0xb68),[{'text':'全部记忆\x20('+_0x5ec5c5+'条)','value':_0x287a1f(0x5c8)},{'text':_0x287a1f(0x823),'value':'20'},{'text':_0x287a1f(0xe63),'value':'50'},{'text':'最近\x20100\x20条','value':_0x287a1f(0x8cd)},{'text':_0x287a1f(0x9ab),'value':_0x287a1f(0x1145)}][_0x287a1f(0x1054)](_0x3b59a3=>_0x3b59a3[_0x287a1f(0x22a)]==='all'||_0x3b59a3['value']==='custom'||parseInt(_0x3b59a3[_0x287a1f(0x22a)])<_0x5ec5c5));if(_0xdd76c8===null)return;let _0x181081,_0xbd00f=_0x5ec5c5;if(_0xdd76c8==='all')_0x181081=[..._0x377e17[_0x287a1f(0x45b)]];else{if(_0xdd76c8==='custom'){const _0x17b503=await _0x1ca09c('自定义数量','请输入要精炼的最近记忆条数\x20(最多\x20'+_0x5ec5c5+'\x20条)');if(_0x17b503===null)return;const _0x3d83fa=parseInt(_0x17b503);if(isNaN(_0x3d83fa)||_0x3d83fa<0x2||_0x3d83fa>_0x5ec5c5){alert(_0x287a1f(0x11e6)+_0x5ec5c5+'\x20之间的有效数字。');return;}_0xbd00f=_0x3d83fa,_0x181081=_0x377e17[_0x287a1f(0x45b)]['slice'](-_0xbd00f);}else _0xbd00f=parseInt(_0xdd76c8),_0xbd00f>=_0x5ec5c5?(_0x181081=[..._0x377e17['longTermMemory']],_0xbd00f=_0x5ec5c5):_0x181081=_0x377e17['longTermMemory'][_0x287a1f(0x111c)](-_0xbd00f);}const _0x2bc89e=await _0x1ca09c(_0x287a1f(0x3ad),_0x287a1f(0x6f9),_0x287a1f(0xc71));if(_0x2bc89e===null)return;const _0x1b5bae=parseInt(_0x2bc89e);if(isNaN(_0x1b5bae)||_0x1b5bae<0x14){alert('请输入一个有效的数字（建议大于20）。');return;}const _0xc746a3=await _0x270512(_0x287a1f(0x9e7),_0x287a1f(0x7d6)+_0xbd00f+_0x287a1f(0x82d)+_0x1b5bae+'\x20字的核心记忆。这些旧记忆将被替换，此操作不可撤销。确定要继续吗？',{'confirmButtonClass':'btn-danger','confirmText':_0x287a1f(0x7e1)});if(!_0xc746a3)return;const _0x25df5b=_0x181081[_0x287a1f(0x9d5)](_0x2c7164=>'-\x20'+_0x2c7164['content'])[_0x287a1f(0x100b)]('\x0a'),_0x21b801=_0x12493e['qzoneSettings'][_0x287a1f(0x66a)]||'用户',_0xd62007=new Date()[_0x287a1f(0x11f9)]('zh-CN',{'year':_0x287a1f(0xb4d),'month':_0x287a1f(0x330),'day':_0x287a1f(0xb4d)}),_0x584e73='\x0a#\x20你的任务\x0a你就是角色“'+_0x377e17[_0x287a1f(0x776)]+_0x287a1f(0x601)+_0x21b801+_0x287a1f(0x84f)+_0xd62007+_0x287a1f(0xacd)+_0xd62007+_0x287a1f(0x10d9)+_0x1b5bae+'\x20字左右**。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x20(必须严格遵守)\x0a'+_0x377e17[_0x287a1f(0x2ea)][_0x287a1f(0x679)]+_0x287a1f(0xf97)+_0x377e17[_0x287a1f(0x2ea)]['myPersona']+_0x287a1f(0x194)+_0x25df5b+_0x287a1f(0x428)+_0x377e17[_0x287a1f(0x776)]+'”的身份，开始你的回忆梳理与精炼。';await _0x2d7ddd('请稍候...',_0x287a1f(0xc40));try{const _0x548da8=_0x12493e[_0x287a1f(0xdd4)][_0x287a1f(0x246)]&&_0x12493e[_0x287a1f(0xdd4)][_0x287a1f(0xbd3)]&&_0x12493e['apiConfig'][_0x287a1f(0x479)],{proxyUrl:_0x37dc49,apiKey:_0x29b260,model:_0x416a51}=_0x548da8?{'proxyUrl':_0x12493e['apiConfig'][_0x287a1f(0x246)],'apiKey':_0x12493e[_0x287a1f(0xdd4)]['secondaryApiKey'],'model':_0x12493e[_0x287a1f(0xdd4)][_0x287a1f(0x479)]}:_0x12493e[_0x287a1f(0xdd4)];if(!_0x37dc49||!_0x29b260||!_0x416a51)throw new Error('请先在API设置中配置好（主或副）API以进行总结。');let _0x5d7dfb=_0x37dc49[_0x287a1f(0x1d4)](_0x287a1f(0x113e)),_0x2aa644=_0x202ea1(_0x416a51,_0x29b260,_0x584e73,[{'role':_0x287a1f(0x717),'content':_0x287a1f(0xa71)}]);const _0x573d68=_0x5d7dfb?await fetch(_0x2aa644['url'],_0x2aa644[_0x287a1f(0xa78)]):await fetch(_0x37dc49+'/v1/chat/completions',{'method':_0x287a1f(0x90),'headers':{'Content-Type':_0x287a1f(0xd74),'Authorization':_0x287a1f(0xf20)+_0x29b260},'body':JSON['stringify']({'model':_0x416a51,'messages':[{'role':_0x287a1f(0x152),'content':_0x584e73},{'role':_0x287a1f(0x717),'content':_0x287a1f(0xa71)}],'temperature':0.2})});if(!_0x573d68['ok'])throw new Error(_0x287a1f(0xf43)+_0x573d68[_0x287a1f(0x109a)]);const _0x45bc8b=await _0x573d68[_0x287a1f(0x79e)]();let _0x5513e2=_0x5d7dfb?getGeminiResponseText(_0x45bc8b):_0x45bc8b['choices'][0x0][_0x287a1f(0xf93)]['content'];const _0x4206e2=_0x25fa21(_0x5513e2);if(_0x4206e2&&_0x4206e2[_0x287a1f(0xaa5)]&&typeof _0x4206e2[_0x287a1f(0xaa5)]===_0x287a1f(0x9de)&&_0x4206e2[_0x287a1f(0xaa5)]['trim']()){const _0x1ebfa0=await _0x270512('精炼完成，请确认',_0x287a1f(0x1211)+_0xbd00f+_0x287a1f(0x157)+_0x4206e2[_0x287a1f(0xaa5)][_0x287a1f(0x7da)]()+_0x287a1f(0x98e),{'confirmText':'确认替换','cancelText':_0x287a1f(0xb0d),'confirmButtonClass':_0x287a1f(0xa2)});if(_0x1ebfa0){const _0x5524b0={'content':_0x4206e2[_0x287a1f(0xaa5)][_0x287a1f(0x7da)](),'timestamp':Date['now'](),'source':_0x287a1f(0x286)},_0x4655f4=_0x5ec5c5-_0xbd00f,_0x5e1d95=_0x4655f4>0x0?_0x377e17[_0x287a1f(0x45b)][_0x287a1f(0x111c)](0x0,_0x4655f4):[];_0x377e17[_0x287a1f(0x45b)]=[..._0x5e1d95,_0x5524b0],_0x377e17[_0x287a1f(0xd8)]=Date[_0x287a1f(0x6ee)](),await _0x2a2987[_0x287a1f(0xc45)][_0x287a1f(0xf36)](_0x377e17),document[_0x287a1f(0xc33)](_0x287a1f(0xfaa))[_0x287a1f(0x10d3)][_0x287a1f(0x3af)](_0x287a1f(0x1043))&&_0x4bc13a(),await _0x2d7ddd(_0x287a1f(0x77c),_0x287a1f(0x9f0)+_0xbd00f+_0x287a1f(0x665));}else await _0x2d7ddd(_0x287a1f(0x1f8),_0x287a1f(0x6df));}else throw new Error(_0x287a1f(0x78e));}catch(_0x330ed7){console['error'](_0x287a1f(0x40f),_0x330ed7),await _0x2d7ddd(_0x287a1f(0x811),_0x287a1f(0xcc0)+_0x330ed7[_0x287a1f(0xf93)]);}}async function _0x3296a7(_0x2f1f39,_0x4b1e95=![]){const _0x4e0375=_0x247bea,_0x341c2a=_0x12493e['chats'][_0x2f1f39];if(!_0x341c2a)return;const _0x4b9d4a=_0x341c2a[_0x4e0375(0xd8)]||0x0,_0x2d75f7=_0x4b1e95?_0x341c2a[_0x4e0375(0x1294)]['filter'](_0x2612f4=>!_0x2612f4[_0x4e0375(0xd07)]||_0x2612f4[_0x4e0375(0x16d)]===_0x4e0375(0x152)&&_0x2612f4['content'][_0x4e0375(0x1d4)]('内心独白'))[_0x4e0375(0x111c)](-(_0x341c2a[_0x4e0375(0x2ea)][_0x4e0375(0x10da)]||0x14)):_0x341c2a['history'][_0x4e0375(0x1054)](_0x64e91d=>_0x64e91d[_0x4e0375(0x2f0)]>_0x4b9d4a&&(!_0x64e91d['isHidden']||_0x64e91d['role']===_0x4e0375(0x152)&&_0x64e91d['content'][_0x4e0375(0x1d4)]('内心独白')));if(_0x2d75f7[_0x4e0375(0x79b)]<0x5){if(_0x4b1e95)alert('最近的消息太少，无法进行有意义的总结。');return;}const _0x4fd3a3=_0x12493e[_0x4e0375(0x76c)][_0x4e0375(0x66a)]||'用户',_0x95fa65=_0x2d75f7[_0x4e0375(0x9d5)](_0x3b8b9f=>{const _0xc2c43e=_0x4e0375;if(_0x3b8b9f[_0xc2c43e(0xd07)]&&_0x3b8b9f[_0xc2c43e(0x16d)]===_0xc2c43e(0x152)&&_0x3b8b9f['content']['includes']('内心独白'))return _0x3b8b9f[_0xc2c43e(0xcbd)];let _0x120b4d;_0x3b8b9f[_0xc2c43e(0x16d)]==='user'?_0x120b4d=_0x4fd3a3:_0x120b4d=_0x3b8b9f[_0xc2c43e(0xe32)]||_0x341c2a[_0xc2c43e(0x776)];let _0x42ce55='';if(_0x3b8b9f[_0xc2c43e(0x52a)]===_0xc2c43e(0x6bf)){if(_0x3b8b9f[_0xc2c43e(0xcbd)])_0x42ce55=_0x3b8b9f[_0xc2c43e(0xcbd)];else{const _0x1b69e1=_0x3b8b9f[_0xc2c43e(0x156)]?'「'+_0x3b8b9f[_0xc2c43e(0x156)]+'」':'',_0x3b3321=_0x3b8b9f[_0xc2c43e(0x11ac)]?'('+_0x3b8b9f[_0xc2c43e(0x11ac)]+')':'';_0x42ce55=(_0x1b69e1+'\x20'+_0x3b3321)[_0xc2c43e(0x7da)]();}}else _0x42ce55=String(_0x3b8b9f[_0xc2c43e(0xcbd)]);return _0x120b4d+':\x20'+_0x42ce55;})[_0x4e0375(0x100b)]('\x0a');let _0x3d0c8b;if(_0x341c2a[_0x4e0375(0x80b)])_0x3d0c8b=_0x4e0375(0x75b)+_0x4fd3a3+_0x4e0375(0x11ff)+_0x95fa65+_0x4e0375(0x7a6)+_0x341c2a[_0x4e0375(0xd5b)][_0x4e0375(0x9d5)](_0x4d5dae=>'-\x20'+_0x4d5dae[_0x4e0375(0x6e2)]+_0x4e0375(0x8c5)+_0x4d5dae[_0x4e0375(0x776)]+')')[_0x4e0375(0x100b)]('\x0a')+_0x4e0375(0x248);else{const _0x520827=new Date()[_0x4e0375(0x11f9)](_0x4e0375(0x770),{'year':'numeric','month':_0x4e0375(0x330),'day':'numeric'});_0x3d0c8b=_0x4e0375(0xcc4)+_0x341c2a[_0x4e0375(0x776)]+_0x4e0375(0x85f)+_0x4fd3a3+_0x4e0375(0x309)+_0x520827+'**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**重要事件**:\x20刚才发生了什么具体的事情？\x0a\x20\x20\x20\x20*\x20\x20\x20**关键决定**:\x20我们达成了什么共识或做出了什么决定？\x0a\x20\x20\x20\x20*\x20\x20\x20**未来计划**:\x20我们约定了什么未来的计划或待办事项？\x0a\x20\x20\x20\x20*\x20\x20\x20**重要时间点**:\x20对话中提到了哪些具体的日期或时间？\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果对话中提到了相对时间（如“明天”、“后天”），你【必须】结合“今天是'+_0x520827+_0x4e0375(0x125c)+new Date(Date[_0x4e0375(0x6ee)]()+0x5265c00)['toLocaleDateString'](_0x4e0375(0x770),{'month':_0x4e0375(0x330),'day':'numeric'})+_0x4e0375(0x973)+_0x341c2a[_0x4e0375(0x2ea)][_0x4e0375(0x679)]+_0x4e0375(0x810)+_0x341c2a[_0x4e0375(0x2ea)][_0x4e0375(0xf75)]+_0x4e0375(0xb35)+_0x95fa65+_0x4e0375(0x428)+_0x341c2a['originalName']+'”的身份，开始你的客观总结。';}try{const _0x4d78a3=_0x12493e[_0x4e0375(0xdd4)][_0x4e0375(0x246)]&&_0x12493e[_0x4e0375(0xdd4)][_0x4e0375(0xbd3)]&&_0x12493e['apiConfig']['secondaryModel'],{proxyUrl:_0xddd51d,apiKey:_0x49119d,model:_0xd5a46a}=_0x4d78a3?{'proxyUrl':_0x12493e[_0x4e0375(0xdd4)]['secondaryProxyUrl'],'apiKey':_0x12493e['apiConfig'][_0x4e0375(0xbd3)],'model':_0x12493e[_0x4e0375(0xdd4)][_0x4e0375(0x479)]}:_0x12493e[_0x4e0375(0xdd4)];if(!_0xddd51d||!_0x49119d||!_0xd5a46a)throw new Error(_0x4e0375(0x1197));let _0xb75b06=_0xddd51d[_0x4e0375(0x1d4)](_0x4e0375(0x113e)),_0x5e01b0=_0x202ea1(_0xd5a46a,_0x49119d,_0x3d0c8b,[{'role':_0x4e0375(0x717),'content':_0x4e0375(0xa0f)}]);const _0x3e342b=_0xb75b06?await fetch(_0x5e01b0[_0x4e0375(0x11a)],_0x5e01b0[_0x4e0375(0xa78)]):await fetch(_0xddd51d+_0x4e0375(0x399),{'method':_0x4e0375(0x90),'headers':{'Content-Type':_0x4e0375(0xd74),'Authorization':_0x4e0375(0xf20)+_0x49119d},'body':JSON[_0x4e0375(0xd27)]({'model':_0xd5a46a,'messages':[{'role':_0x4e0375(0x152),'content':_0x3d0c8b},{'role':'user','content':_0x4e0375(0xa0f)}],'temperature':0.2})});if(!_0x3e342b['ok'])throw new Error(_0x4e0375(0xf43)+_0x3e342b[_0x4e0375(0x109a)]);const _0x97fb52=await _0x3e342b[_0x4e0375(0x79e)]();let _0xe08b2c=_0xb75b06?getGeminiResponseText(_0x97fb52):_0x97fb52['choices'][0x0][_0x4e0375(0xf93)][_0x4e0375(0xcbd)];_0xe08b2c=_0xe08b2c[_0x4e0375(0xc12)](/^```json\s*/,'')[_0x4e0375(0xc12)](/```$/,'')[_0x4e0375(0x7da)]();const _0x1ca5a0=JSON[_0x4e0375(0x6b1)](_0xe08b2c);if(_0x341c2a[_0x4e0375(0x80b)]){if(_0x1ca5a0['summaries']&&typeof _0x1ca5a0['summaries']===_0x4e0375(0xe37)){let _0x27d0a1=0x0;for(const _0x489b32 in _0x1ca5a0[_0x4e0375(0x97c)]){const _0x1b63c3=_0x1ca5a0[_0x4e0375(0x97c)][_0x489b32];if(_0x1b63c3&&_0x1b63c3['trim']()){const _0x1058ab=Object[_0x4e0375(0xd28)](_0x12493e['chats'])[_0x4e0375(0xd85)](_0x4fde33=>_0x4fde33[_0x4e0375(0x776)]===_0x489b32);if(_0x1058ab){const _0xc984a={'content':_0x1b63c3[_0x4e0375(0x7da)](),'timestamp':Date[_0x4e0375(0x6ee)](),'source':_0x4e0375(0xd65)+_0x341c2a[_0x4e0375(0x578)]};if(!_0x1058ab[_0x4e0375(0x45b)])_0x1058ab[_0x4e0375(0x45b)]=[];_0x1058ab[_0x4e0375(0x45b)]['push'](_0xc984a),await _0x2a2987[_0x4e0375(0xc45)]['put'](_0x1058ab),_0x27d0a1++;}}}if(_0x27d0a1>0x0)console[_0x4e0375(0x51f)](_0x4e0375(0x3b3)+_0x27d0a1+_0x4e0375(0x6f6));else throw new Error('AI返回了空的或格式不正确的总结内容。');}else throw new Error('AI返回的JSON格式不正确，缺少\x20\x27summaries\x27\x20字段。');}else{if(_0x1ca5a0[_0x4e0375(0xaa5)]&&_0x1ca5a0[_0x4e0375(0xaa5)][_0x4e0375(0x7da)]()){const _0x27abbe={'content':_0x1ca5a0[_0x4e0375(0xaa5)][_0x4e0375(0x7da)](),'timestamp':Date['now'](),'source':'auto'};_0x341c2a[_0x4e0375(0x45b)][_0x4e0375(0x2d6)](_0x27abbe),await _0x2a2987[_0x4e0375(0xc45)][_0x4e0375(0xf36)](_0x341c2a),console[_0x4e0375(0x51f)](_0x4e0375(0x229));}else throw new Error('AI返回了空的或格式不正确的总结内容。');}_0x341c2a[_0x4e0375(0xd8)]=_0x2d75f7[_0x4e0375(0x111c)](-0x1)[0x0]['timestamp'],await _0x2a2987[_0x4e0375(0xc45)][_0x4e0375(0xf36)](_0x341c2a),document['getElementById'](_0x4e0375(0xfaa))[_0x4e0375(0x10d3)][_0x4e0375(0x3af)](_0x4e0375(0x1043))&&_0x4bc13a();}catch(_0x4d03b0){console[_0x4e0375(0x4d9)]('总结长期记忆时出错:',_0x4d03b0),await _0x2d7ddd(_0x4e0375(0x76b),_0x4e0375(0xa26)+_0x4d03b0[_0x4e0375(0xf93)]);}}function _0x2b626c(){const _0x547578=_0x247bea;if(!_0x464fa7)return;const _0x2e2dce=_0x12493e[_0x547578(0xc45)][_0x12493e[_0x547578(0x7bc)]],_0x13a43e=_0x2e2dce[_0x547578(0x1294)][_0x547578(0xd85)](_0x1e0163=>_0x1e0163[_0x547578(0x2f0)]===_0x464fa7);if(!_0x13a43e)return;let _0x49ecb5;_0x13a43e[_0x547578(0x16d)]==='user'?_0x49ecb5=_0x2e2dce[_0x547578(0x80b)]?_0x2e2dce[_0x547578(0x2ea)]['myNickname']||'我':'我':_0x2e2dce[_0x547578(0x80b)]?_0x49ecb5=_0x3fb61d(_0x2e2dce,_0x13a43e['senderName']):_0x49ecb5=_0x2e2dce[_0x547578(0x578)];const _0x327855=String(_0x13a43e['content']||'');let _0x10d664='';if(typeof _0x13a43e[_0x547578(0xcbd)]==='string'&&_0x301121[_0x547578(0x677)](_0x13a43e[_0x547578(0xcbd)]))_0x10d664=_0x547578(0x75c);else{if(_0x13a43e['type']===_0x547578(0x8f5)||_0x13a43e[_0x547578(0x52a)]===_0x547578(0x142))_0x10d664=_0x547578(0x10e1);else _0x13a43e[_0x547578(0x52a)]===_0x547578(0xb41)?_0x10d664=_0x547578(0x11d1):_0x10d664=_0x327855[_0x547578(0x1033)](0x0,0x32)+(_0x327855[_0x547578(0x79b)]>0x32?_0x547578(0xda0):'');}_0x3afdd9={'timestamp':_0x13a43e['timestamp'],'senderName':_0x49ecb5,'content':_0x327855};const _0x4077b7=document[_0x547578(0xc33)](_0x547578(0xf07));_0x4077b7['querySelector'](_0x547578(0xd44))[_0x547578(0x11b0)]=_0x547578(0x106)+_0x3afdd9['senderName']+':',_0x4077b7['querySelector'](_0x547578(0x3d8))['textContent']=_0x10d664,_0x4077b7[_0x547578(0x105d)][_0x547578(0xf44)]=_0x547578(0xa20),_0x13dccc(),document[_0x547578(0xc33)]('chat-input')[_0x547578(0xd59)]();}function _0x9e2080(){const _0x39af51=_0x247bea;_0x3afdd9=null,document['getElementById'](_0x39af51(0xf07))['style']['display']='none';}let _0x12f09b=null;function _0x47ae3b(_0x3a059d){const _0x3791b8=_0x247bea;_0x12f09b=_0x3a059d;const _0x406e56=_0x12493e['chats'][_0x12493e[_0x3791b8(0x7bc)]],_0x11030b=_0x406e56[_0x3791b8(0x1294)][_0x3791b8(0xd85)](_0xb4cb36=>_0xb4cb36[_0x3791b8(0x2f0)]===_0x3a059d);_0x11030b&&(document[_0x3791b8(0xc33)](_0x3791b8(0xec6))[_0x3791b8(0x11b0)]=_0x11030b[_0x3791b8(0xe32)]),document['getElementById'](_0x3791b8(0x393))['classList']['add'](_0x3791b8(0x143));}function _0x3a4059(){const _0x48561c=_0x247bea;document[_0x48561c(0xc33)](_0x48561c(0x393))[_0x48561c(0x10d3)][_0x48561c(0x2c7)](_0x48561c(0x143)),_0x12f09b=null;}async function _0x185d0c(_0x1fb1cf){const _0x3f9e02=_0x247bea;if(!_0x12f09b)return;const _0x4dc0cf=_0x12f09b,_0x50bf9d=_0x12493e[_0x3f9e02(0xc45)][_0x12493e['activeChatId']],_0x5e7451=_0x50bf9d[_0x3f9e02(0x1294)][_0x3f9e02(0xce9)](_0x45a5f8=>_0x45a5f8[_0x3f9e02(0x2f0)]===_0x4dc0cf);if(_0x5e7451===-0x1)return;const _0x4ec7ab=_0x50bf9d[_0x3f9e02(0x1294)][_0x5e7451];_0x4ec7ab[_0x3f9e02(0xbc8)]=_0x1fb1cf;let _0x5a7587;if(_0x1fb1cf===_0x3f9e02(0x95b)){const _0x59f98b={'role':'user','type':_0x3f9e02(0xe86),'isRefund':!![],'amount':_0x4ec7ab[_0x3f9e02(0x609)],'note':_0x3f9e02(0x1009),'timestamp':Date['now']()};_0x50bf9d['history'][_0x3f9e02(0x2d6)](_0x59f98b),_0x5a7587='[系统提示：你拒绝并退还了“'+_0x4ec7ab[_0x3f9e02(0xe32)]+_0x3f9e02(0x3dc);}else _0x5a7587='[系统提示：你接受了“'+_0x4ec7ab[_0x3f9e02(0xe32)]+_0x3f9e02(0x3dc);const _0x304da6={'role':_0x3f9e02(0x152),'content':_0x5a7587,'timestamp':Date['now']()+0x1,'isHidden':!![]};_0x50bf9d[_0x3f9e02(0x1294)]['push'](_0x304da6),await _0x2a2987['chats'][_0x3f9e02(0xf36)](_0x50bf9d),_0x3a4059(),_0x1bbfd3(_0x12493e['activeChatId']),_0x597ed7();}async function _0x264dda(){const _0x43d477=_0x247bea;_0x38f00f(_0x43d477(0xf14));const _0x8a16d8=document['getElementById'](_0x43d477(0x3e3)),_0x1253e4=document[_0x43d477(0xc33)]('call-history-title');_0x8a16d8['innerHTML']='',_0x1253e4['textContent']=_0x43d477(0xaaf);const _0x2b4aac=await _0x2a2987['callRecords']['orderBy']('timestamp')['reverse']()[_0x43d477(0xf15)]();if(_0x2b4aac[_0x43d477(0x79b)]===0x0){_0x8a16d8[_0x43d477(0x102a)]=_0x43d477(0x13c);return;}_0x2b4aac['forEach'](_0xf349dd=>{const _0x4e0ca0=_0x5e3679(_0xf349dd);_0x29b870(_0x4e0ca0,async()=>{const _0x236c11=_0x26e9,_0x2cdd18=await _0x1ca09c('自定义通话名称',_0x236c11(0x2ef),_0xf349dd['customName']||'');if(_0x2cdd18===null)return;await _0x2a2987[_0x236c11(0x508)][_0x236c11(0xb07)](_0xf349dd['id'],{'customName':_0x2cdd18[_0x236c11(0x7da)]()}),await _0x264dda(),await _0x2d7ddd('成功',_0x236c11(0xcf4));}),_0x8a16d8['appendChild'](_0x4e0ca0);});}function _0x5e3679(_0xb86eb4){const _0x3437d7=_0x247bea,_0x4ed158=document[_0x3437d7(0x1292)](_0x3437d7(0x58c));_0x4ed158[_0x3437d7(0x84)]=_0x3437d7(0x38f),_0x4ed158['dataset'][_0x3437d7(0xe49)]=_0xb86eb4['id'];const _0x17bf52=_0x12493e[_0x3437d7(0xc45)][_0xb86eb4[_0x3437d7(0x109b)]],_0x1ed403=_0x17bf52?_0x17bf52[_0x3437d7(0x578)]:'未知会话',_0x4c0f5a=new Date(_0xb86eb4['timestamp']),_0x55918f=_0x4c0f5a[_0x3437d7(0x80d)]()+'-'+String(_0x4c0f5a[_0x3437d7(0xf99)]()+0x1)[_0x3437d7(0x70d)](0x2,'0')+'-'+String(_0x4c0f5a['getDate']())[_0x3437d7(0x70d)](0x2,'0')+'\x20'+String(_0x4c0f5a[_0x3437d7(0xa75)]())['padStart'](0x2,'0')+':'+String(_0x4c0f5a[_0x3437d7(0xa88)]())['padStart'](0x2,'0'),_0x48f8c9=Math[_0x3437d7(0xcb5)](_0xb86eb4[_0x3437d7(0xc6a)]/0x3c)+'分'+_0xb86eb4[_0x3437d7(0xc6a)]%0x3c+'秒',_0x3bf4e9=_0xb86eb4[_0x3437d7(0x10d4)]['map'](_0x1865ac=>'<img\x20src=\x22'+_0x1865ac[_0x3437d7(0xbac)]+_0x3437d7(0xd71)+_0x1865ac[_0x3437d7(0x578)]+_0x3437d7(0x9f9)+_0x1865ac[_0x3437d7(0x578)]+'\x22>')[_0x3437d7(0x100b)]('');return _0x4ed158[_0x3437d7(0x102a)]=_0x3437d7(0x1271)+_0x55918f+_0x3437d7(0xb4a)+_0x48f8c9+_0x3437d7(0xe3b)+(_0xb86eb4[_0x3437d7(0xa7d)]?'<div\x20class=\x22custom-title\x22>'+_0xb86eb4['customName']+'</div>':'')+_0x3437d7(0xd9b)+_0x3bf4e9+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22participants-names\x22>与\x20'+_0x1ed403+_0x3437d7(0x37b),_0x4ed158;}async function _0x5778e6(_0x53f46c){const _0x463ca1=_0x247bea,_0xc75c66=await _0x2a2987[_0x463ca1(0x508)]['get'](_0x53f46c);if(!_0xc75c66)return;const _0x37f789=document[_0x463ca1(0xc33)](_0x463ca1(0x785)),_0x3bc49f=document[_0x463ca1(0xc33)](_0x463ca1(0x991)),_0xf9663e=document[_0x463ca1(0xc33)](_0x463ca1(0xa47));_0x3bc49f[_0x463ca1(0x11b0)]='通话于\x20'+new Date(_0xc75c66[_0x463ca1(0x2f0)])[_0x463ca1(0x559)]()+_0x463ca1(0xcfd)+Math[_0x463ca1(0xcb5)](_0xc75c66['duration']/0x3c)+'分'+_0xc75c66[_0x463ca1(0xc6a)]%0x3c+'秒)',_0xf9663e['innerHTML']='';const _0x4ee86d=document[_0x463ca1(0xc33)](_0x463ca1(0x5f7)),_0x2a14a1=document[_0x463ca1(0xc33)](_0x463ca1(0xce));!_0xc75c66[_0x463ca1(0x2e3)]||_0xc75c66[_0x463ca1(0x2e3)][_0x463ca1(0x79b)]===0x0?(_0xf9663e[_0x463ca1(0x102a)]=_0x463ca1(0xae1),_0x2a14a1[_0x463ca1(0x105d)][_0x463ca1(0xf44)]='none'):(_0x2a14a1['style']['display']=_0x463ca1(0xa20),_0xc75c66[_0x463ca1(0x2e3)][_0x463ca1(0xd6a)](_0x5d9eca=>{const _0x2e32c2=_0x463ca1,_0x2bdba3=document[_0x2e32c2(0x1292)](_0x2e32c2(0x58c));_0x2bdba3[_0x2e32c2(0x84)]='transcript-entry\x20'+_0x5d9eca[_0x2e32c2(0x16d)],_0x2bdba3[_0x2e32c2(0x11b0)]=_0x5d9eca[_0x2e32c2(0xcbd)],_0xf9663e['appendChild'](_0x2bdba3);}));const _0x565648=_0x4ee86d[_0x463ca1(0xbc5)](!![]);_0x4ee86d[_0x463ca1(0x1053)]['replaceChild'](_0x565648,_0x4ee86d);const _0x366020=_0x2a14a1[_0x463ca1(0xbc5)](!![]);_0x2a14a1[_0x463ca1(0x1053)][_0x463ca1(0xcaa)](_0x366020,_0x2a14a1),_0x565648['addEventListener'](_0x463ca1(0x335),async()=>{const _0x2864=_0x463ca1,_0x1301b2=await _0x270512(_0x2864(0x8d6),_0x2864(0xcbb),{'confirmButtonClass':_0x2864(0xa2)});_0x1301b2&&(_0x37f789[_0x2864(0x10d3)]['remove'](_0x2864(0x143)),await _0x2a2987['callRecords'][_0x2864(0x9ea)](_0x53f46c),await _0x264dda(),alert(_0x2864(0xb98)));}),_0x366020['addEventListener'](_0x463ca1(0x335),async()=>{const _0x4aff19=_0x463ca1,_0xb8a73e=await _0x270512(_0x4aff19(0x583),_0x4aff19(0x112a),{'confirmText':_0x4aff19(0xb74)});if(!_0xb8a73e)return;_0x37f789['classList'][_0x4aff19(0x2c7)](_0x4aff19(0x143));const _0x579af8=_0x12493e['chats'][_0xc75c66['chatId']];if(!_0x579af8){alert(_0x4aff19(0xb9f));return;}await _0x2d7ddd(_0x4aff19(0xb37),_0x4aff19(0x6c3));try{const _0x2299b8=_0xc75c66['transcript'][_0x4aff19(0x9d5)](_0x5cf508=>{const _0x16392f=_0x4aff19,_0xaf2d77=_0x5cf508['role']===_0x16392f(0x717)?_0x579af8[_0x16392f(0x2ea)][_0x16392f(0xbf6)]||'我':_0x5cf508[_0x16392f(0xe32)]||_0x579af8[_0x16392f(0x578)];return _0xaf2d77+':\x20'+_0x5cf508[_0x16392f(0xcbd)];})[_0x4aff19(0x100b)]('\x0a');await _0x32d54d(_0xc75c66[_0x4aff19(0x109b)],_0x2299b8),await _0x2d7ddd(_0x4aff19(0xd6),_0x4aff19(0x125f)+_0x579af8[_0x4aff19(0x578)]+_0x4aff19(0x9a1));}catch(_0x2cf37e){await _0x2d7ddd(_0x4aff19(0x76b),_0x4aff19(0x9f5)+_0x2cf37e[_0x4aff19(0xf93)]);}});const _0x45354d=document['getElementById']('close-transcript-modal-btn'),_0x18829c=_0x45354d[_0x463ca1(0xbc5)](!![]);_0x45354d[_0x463ca1(0x1053)][_0x463ca1(0xcaa)](_0x18829c,_0x45354d),_0x18829c['addEventListener'](_0x463ca1(0x335),()=>{const _0x641369=_0x463ca1;_0x37f789[_0x641369(0x10d3)][_0x641369(0x2c7)]('visible');}),_0x37f789[_0x463ca1(0x10d3)][_0x463ca1(0xb9)](_0x463ca1(0x143));}async function _0x3c7301(){const _0x437075=_0x247bea;if(!_0x12493e[_0x437075(0x7bc)]||_0x12493e[_0x437075(0xc45)][_0x12493e[_0x437075(0x7bc)]][_0x437075(0x80b)])return;const _0x574d9c=_0x12493e['chats'][_0x12493e[_0x437075(0x7bc)]],_0x158673=await _0x1ca09c('编辑对方状态',_0x437075(0x1193),_0x574d9c[_0x437075(0xbc8)]['text']);_0x158673!==null&&(_0x574d9c[_0x437075(0xbc8)][_0x437075(0x996)]=_0x158673['trim']()||'在线',_0x574d9c[_0x437075(0xbc8)]['isBusy']=![],_0x574d9c[_0x437075(0xbc8)][_0x437075(0x18a)]=Date[_0x437075(0x6ee)](),await _0x2a2987[_0x437075(0xc45)]['put'](_0x574d9c),_0x1bbfd3(_0x12493e['activeChatId']),_0x597ed7(),await _0x2d7ddd(_0x437075(0xed3),'“'+_0x574d9c[_0x437075(0x578)]+_0x437075(0xb0)+_0x574d9c[_0x437075(0xbc8)][_0x437075(0x996)]));}async function _0x2739a4(){const _0x1c9cea=_0x247bea,_0x4f948b=document['getElementById'](_0x1c9cea(0x126)),_0x4be057=document[_0x1c9cea(0xc33)](_0x1c9cea(0xb1f));_0x4be057['innerHTML']='';const _0x4e362d=Object['values'](_0x12493e[_0x1c9cea(0xc45)]);_0x4e362d[_0x1c9cea(0xd6a)](_0x491822=>{const _0x5c5ef0=_0x1c9cea,_0xe1fbc3=document[_0x5c5ef0(0x1292)]('div');_0xe1fbc3['className']=_0x5c5ef0(0x676),_0xe1fbc3['innerHTML']=_0x5c5ef0(0x905)+_0x491822['id']+_0x5c5ef0(0x513)+(_0x491822[_0x5c5ef0(0x80b)]?_0x491822[_0x5c5ef0(0x2ea)]['groupAvatar']:_0x491822[_0x5c5ef0(0x2ea)][_0x5c5ef0(0x18e)]||_0x190acc)+_0x5c5ef0(0x8bf)+_0x491822[_0x5c5ef0(0x578)]+_0x5c5ef0(0xdec),_0x4be057[_0x5c5ef0(0xf77)](_0xe1fbc3);}),_0x4f948b[_0x1c9cea(0x10d3)][_0x1c9cea(0xb9)](_0x1c9cea(0x143));}function _0x1bca3d(_0x328adf){const _0x2f7b9c=_0x247bea,_0x429a99=document['getElementById']('music-player-overlay');if(!_0x429a99[_0x2f7b9c(0x10d3)][_0x2f7b9c(0x3af)]('visible')){if(_0x328adf)_0x328adf();return;}_0x429a99[_0x2f7b9c(0x10d3)][_0x2f7b9c(0x2c7)](_0x2f7b9c(0x143)),setTimeout(()=>{const _0x1bca89=_0x2f7b9c;document[_0x1bca89(0xc33)]('music-playlist-panel')[_0x1bca89(0x10d3)][_0x1bca89(0x2c7)](_0x1bca89(0x143));if(_0x328adf)_0x328adf();},0x190);}function _0x35419b(_0x1f56ad){const _0x5a54d4=_0x247bea;if(!_0x1f56ad)return[];const _0x366acb=String(_0x1f56ad)[_0x5a54d4(0x8d7)](/\r\n?|\n/),_0x3a43e7=[],_0x15bdd9=/\[(\d{2}):(\d{2})[.:](\d{2,3})\]/g;for(const _0x52e2c9 of _0x366acb){const _0x134b07=_0x52e2c9[_0x5a54d4(0xc12)](_0x15bdd9,'')[_0x5a54d4(0x7da)]();if(!_0x134b07)continue;_0x15bdd9[_0x5a54d4(0x90a)]=0x0;let _0x3b6806;while((_0x3b6806=_0x15bdd9[_0x5a54d4(0x97a)](_0x52e2c9))!==null){const _0x2aef6e=parseInt(_0x3b6806[0x1],0xa),_0xcadedd=parseInt(_0x3b6806[0x2],0xa),_0x47f577=parseInt(_0x3b6806[0x3]['padEnd'](0x3,'0'),0xa),_0x1934f2=_0x2aef6e*0x3c+_0xcadedd+_0x47f577/0x3e8;_0x3a43e7['push']({'time':_0x1934f2,'text':_0x134b07});}}return _0x3a43e7[_0x5a54d4(0xbb3)]((_0x5d3523,_0x188733)=>_0x5d3523[_0x5a54d4(0x61f)]-_0x188733['time']);}function _0x409a99(){const _0x11b7f5=_0x247bea,_0xdeb03c=document[_0x11b7f5(0xc33)](_0x11b7f5(0xea4));_0xdeb03c['innerHTML']='';if(!_0x5ebb31['parsedLyrics']||_0x5ebb31[_0x11b7f5(0x1ca)][_0x11b7f5(0x79b)]===0x0){_0xdeb03c[_0x11b7f5(0x102a)]='<div\x20class=\x22lyric-line\x22>♪\x20暂无歌词\x20♪</div>';return;}_0x5ebb31[_0x11b7f5(0x1ca)][_0x11b7f5(0xd6a)]((_0x2b489d,_0x396caf)=>{const _0xb6feaf=_0x11b7f5,_0x132ef9=document[_0xb6feaf(0x1292)](_0xb6feaf(0x58c));_0x132ef9[_0xb6feaf(0x84)]='lyric-line',_0x132ef9[_0xb6feaf(0x11b0)]=_0x2b489d[_0xb6feaf(0x996)],_0x132ef9[_0xb6feaf(0x85)]['index']=_0x396caf,_0xdeb03c[_0xb6feaf(0xf77)](_0x132ef9);}),_0xdeb03c[_0x11b7f5(0x105d)]['transform']=_0x11b7f5(0x94);}function _0x5ab0ba(_0x154c51){const _0x52cf93=_0x247bea;if(_0x5ebb31['parsedLyrics'][_0x52cf93(0x79b)]===0x0)return;let _0x332fba=-0x1;for(let _0x28a9fe=0x0;_0x28a9fe<_0x5ebb31['parsedLyrics'][_0x52cf93(0x79b)];_0x28a9fe++){if(_0x154c51>=_0x5ebb31['parsedLyrics'][_0x28a9fe][_0x52cf93(0x61f)])_0x332fba=_0x28a9fe;else break;}if(_0x332fba===_0x5ebb31[_0x52cf93(0x612)])return;_0x5ebb31[_0x52cf93(0x612)]=_0x332fba,_0x107a33();const _0x2ac183=document[_0x52cf93(0xc33)](_0x52cf93(0x4d1));_0x2ac183&&(_0x332fba>-0x1&&_0x5ebb31[_0x52cf93(0x1ca)][_0x332fba]?_0x2ac183[_0x52cf93(0x11b0)]=_0x5ebb31[_0x52cf93(0x1ca)][_0x332fba][_0x52cf93(0x996)]:_0x2ac183[_0x52cf93(0x11b0)]=_0x52cf93(0x6a2));const _0x537170=document[_0x52cf93(0xc33)](_0x52cf93(0x65b));_0x537170[_0x52cf93(0x10d3)]['contains'](_0x52cf93(0x143))&&(_0x332fba>-0x1&&_0x5ebb31['parsedLyrics'][_0x332fba]?_0x537170[_0x52cf93(0x11b0)]=_0x5ebb31['parsedLyrics'][_0x332fba][_0x52cf93(0x996)]:_0x537170[_0x52cf93(0x11b0)]='♪');}function _0x107a33(_0xf02c06=![]){const _0x4daabf=_0x247bea,_0x54f6d7=_0xf02c06?'#fullscreen-lyrics-container\x20.music-lyrics-list':_0x4daabf(0xf1d),_0x1bba83=_0xf02c06?_0x4daabf(0xafd):_0x4daabf(0x54f),_0x21c20a=document[_0x4daabf(0x977)](_0x54f6d7),_0x1d7c8b=document[_0x4daabf(0x977)](_0x1bba83);if(!_0x21c20a||!_0x1d7c8b)return;const _0x24e57d=_0x21c20a[_0x4daabf(0x67a)]('.lyric-line');_0x24e57d['forEach'](_0x2b7477=>_0x2b7477['classList'][_0x4daabf(0x2c7)](_0x4daabf(0x1043)));if(_0x5ebb31['currentLyricIndex']===-0x1){_0x21c20a[_0x4daabf(0x105d)][_0x4daabf(0x404)]=_0x4daabf(0x94);return;}const _0x54d71e=_0x21c20a[_0x4daabf(0x977)](_0x4daabf(0x126e)+_0x5ebb31[_0x4daabf(0x612)]+'\x22]');if(_0x54d71e){_0x54d71e[_0x4daabf(0x10d3)][_0x4daabf(0xb9)](_0x4daabf(0x1043));const _0x4b711d=_0x1d7c8b[_0x4daabf(0x1a0)],_0x31aea2=_0x4b711d/2.2-_0x54d71e[_0x4daabf(0xa2f)]-_0x54d71e[_0x4daabf(0x1a0)]/0x2;_0x21c20a['style'][_0x4daabf(0x404)]='translateY('+_0x31aea2+_0x4daabf(0x8e9);}}function _0x3bff12(_0x24c630){const _0x4aa008=_0x247bea;if(isNaN(_0x24c630)||_0x24c630<0x0)return _0x4aa008(0x1130);const _0x18bbeb=Math[_0x4aa008(0xcb5)](_0x24c630/0x3c),_0x247593=Math[_0x4aa008(0xcb5)](_0x24c630%0x3c);return _0x18bbeb+':'+String(_0x247593)[_0x4aa008(0x70d)](0x2,'0');}let _0x2a271f=0x0,_0x22a623;function _0x438baf(){_0x22a623&&cancelAnimationFrame(_0x22a623);function _0x3887cf(){const _0x3bb585=_0x26e9;if(!_0x5ebb31['isPlaying']||!_0x3ced3a[_0x3bb585(0xc6a)])return;const _0x59d757=performance[_0x3bb585(0x6ee)](),_0x377290=_0x3ced3a[_0x3bb585(0x10ba)],_0x13b657=_0x3ced3a[_0x3bb585(0xc6a)],_0x1e0c14=_0x377290/_0x13b657*0x64;document[_0x3bb585(0xc33)]('music-progress-fill')[_0x3bb585(0x105d)][_0x3bb585(0x5f8)]=_0x1e0c14+'%',_0x59d757-_0x2a271f>0x3e8&&(document['getElementById'](_0x3bb585(0xe04))[_0x3bb585(0x11b0)]=_0x3bff12(_0x377290),document['getElementById'](_0x3bb585(0x708))['textContent']=_0x3bff12(_0x13b657),_0x2a271f=_0x59d757),_0x5ab0ba(_0x377290),_0x22a623=requestAnimationFrame(_0x3887cf);}_0x22a623=requestAnimationFrame(_0x3887cf);}function _0x1d6a4f(){const _0x2b5492=_0x247bea;if(!lastRawAiResponse){alert(_0x2b5492(0xb6c));return;}const _0x492c71=document[_0x2b5492(0xc33)](_0x2b5492(0x7e8)),_0x52f4ce=document[_0x2b5492(0xc33)](_0x2b5492(0x333));_0x52f4ce[_0x2b5492(0x102a)]='';const _0x2e4454=lastRawAiResponse[_0x2b5492(0x1242)](/{[^{}]*}/g);if(_0x2e4454)_0x2e4454[_0x2b5492(0xd6a)](_0x44c3d6=>{const _0x2995ae=_0x2b5492;try{const _0x192506=JSON[_0x2995ae(0x6b1)](_0x44c3d6),_0x226d1d=JSON[_0x2995ae(0xd27)](_0x192506,null,0x2),_0x4bb3fd=_0xb561c1(_0x226d1d);_0x52f4ce[_0x2995ae(0xf77)](_0x4bb3fd);}catch(_0x545781){const _0x586fdb=_0xb561c1(_0x44c3d6);_0x52f4ce[_0x2995ae(0xf77)](_0x586fdb),console[_0x2995ae(0x54a)]('在导演模式中发现一个无效的JSON片段:',_0x44c3d6);}});else{const _0x5743c0=_0xb561c1(lastRawAiResponse);_0x52f4ce[_0x2b5492(0xf77)](_0x5743c0);}_0x492c71[_0x2b5492(0x10d3)][_0x2b5492(0xb9)](_0x2b5492(0x143));}function _0xb561c1(_0x12e25f=''){const _0x193e49=_0x247bea,_0x2df4b2=document['createElement'](_0x193e49(0x58c));_0x2df4b2[_0x193e49(0x84)]=_0x193e49(0x10c3);const _0xdd367d={'text':{'type':_0x193e49(0x996),'content':_0x193e49(0xd7b)},'sticker':{'type':_0x193e49(0x966),'url':_0x193e49(0x7a8),'meaning':'表情含义'},'image':{'type':_0x193e49(0x8f5),'description':_0x193e49(0x988)},'voice':{'type':'voice_message','content':_0x193e49(0x397)},'transfer':{'type':_0x193e49(0xe86),'amount':5.2,'note':'一点心意'},'offline':{'type':_0x193e49(0x6bf),'content':_0x193e49(0xac4)},'quote':{'type':_0x193e49(0x4bf),'target_timestamp':0x499602d2,'reply_content':_0x193e49(0x98f)}};return _0x2df4b2[_0x193e49(0x102a)]=_0x193e49(0x11e)+_0x12e25f+'</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON['stringify'](_0xdd367d[_0x193e49(0x996)])+_0x193e49(0x490)+JSON['stringify'](_0xdd367d[_0x193e49(0x966)])+'\x27>表情</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x193e49(0xd27)](_0xdd367d[_0x193e49(0x695)])+'\x27>图片</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x193e49(0xd27)](_0xdd367d['voice'])+_0x193e49(0xd4d)+JSON['stringify'](_0xdd367d[_0x193e49(0xe86)])+_0x193e49(0xeea)+JSON[_0x193e49(0xd27)](_0xdd367d[_0x193e49(0xd5e)])+_0x193e49(0x30d)+JSON[_0x193e49(0xd27)](_0xdd367d[_0x193e49(0xf74)])+_0x193e49(0x1210),_0x2df4b2[_0x193e49(0x977)](_0x193e49(0xaad))[_0x193e49(0x205)](_0x193e49(0x335),()=>{const _0x42eb3b=_0x193e49;_0x2df4b2[_0x42eb3b(0x2c7)]();}),_0x2df4b2[_0x193e49(0x67a)](_0x193e49(0x1281))[_0x193e49(0xd6a)](_0x1fafb5=>{const _0x1cd9a2=_0x193e49;_0x1fafb5[_0x1cd9a2(0x205)]('click',()=>{const _0x9acf60=_0x1cd9a2,_0x4e02c2=_0x1fafb5[_0x9acf60(0x85)]['template'],_0x498c2d=_0x2df4b2['querySelector'](_0x9acf60(0x89c));if(_0x4e02c2&&_0x498c2d)try{const _0x447a3b=JSON[_0x9acf60(0x6b1)](_0x4e02c2);_0x498c2d[_0x9acf60(0x22a)]=JSON[_0x9acf60(0xd27)](_0x447a3b,null,0x2),_0x498c2d[_0x9acf60(0xd59)]();}catch(_0x140bc7){console[_0x9acf60(0x4d9)](_0x9acf60(0x195),_0x140bc7);}});}),_0x2df4b2;}async function _0x1c94c9(){const _0x59583f=_0x247bea,_0x3010d5=_0x12493e[_0x59583f(0xc45)][_0x12493e['activeChatId']];if(!_0x3010d5)return;const _0x352cd8=document['getElementById'](_0x59583f(0x333)),_0x45c9ae=_0x352cd8[_0x59583f(0x67a)]('textarea'),_0x29bd7a=Array['from'](_0x45c9ae)['map'](_0xc9d15d=>_0xc9d15d[_0x59583f(0x22a)][_0x59583f(0x7da)]())[_0x59583f(0x1054)](Boolean);if(_0x29bd7a[_0x59583f(0x79b)]===0x0){_0x3010d5[_0x59583f(0x1294)]=_0x3010d5[_0x59583f(0x1294)][_0x59583f(0x1054)](_0x2dc77b=>!lastResponseTimestamps[_0x59583f(0x1d4)](_0x2dc77b[_0x59583f(0x2f0)])),await _0x2a2987[_0x59583f(0xc45)][_0x59583f(0xf36)](_0x3010d5),_0x1bbfd3(_0x12493e['activeChatId']),_0x597ed7(),document[_0x59583f(0xc33)](_0x59583f(0x7e8))['classList'][_0x59583f(0x2c7)](_0x59583f(0x143)),lastRawAiResponse='',lastResponseTimestamps=[];return;}let _0x285231=[];for(const _0x5dde1f of _0x29bd7a){try{const _0x33cae6=JSON[_0x59583f(0x6b1)](_0x5dde1f);_0x285231[_0x59583f(0x2d6)](_0x33cae6);}catch(_0x4e62e1){console[_0x59583f(0x54a)](_0x59583f(0x30a),_0x5dde1f);}}_0x3010d5[_0x59583f(0x1294)]=_0x3010d5[_0x59583f(0x1294)][_0x59583f(0x1054)](_0x338ff8=>!lastResponseTimestamps[_0x59583f(0x1d4)](_0x338ff8[_0x59583f(0x2f0)]));let _0x154271=[],_0x2f203f=Date['now']();for(const _0x4079c1 of _0x285231){if(!_0x4079c1||typeof _0x4079c1!==_0x59583f(0xe37)||!_0x4079c1[_0x59583f(0x52a)]){console[_0x59583f(0x54a)](_0x59583f(0x10fa),_0x4079c1);continue;}let _0x5489eb=null;const _0x164623={'role':_0x59583f(0x376),'senderName':_0x4079c1['name']||_0x3010d5[_0x59583f(0x776)],'timestamp':_0x2f203f++};switch(_0x4079c1[_0x59583f(0x52a)]){case'text':_0x5489eb={..._0x164623,'content':String(_0x4079c1[_0x59583f(0xcbd)]||_0x4079c1[_0x59583f(0xf93)])};break;case'sticker':{let _0x171f31=![];if(_0x4079c1[_0x59583f(0x11a)]&&_0x4079c1['meaning'])_0x5489eb={..._0x164623,'type':_0x59583f(0x966),'content':_0x4079c1[_0x59583f(0x11a)],'meaning':_0x4079c1[_0x59583f(0x127d)]},console[_0x59583f(0x51f)](_0x59583f(0xb3c)),_0x171f31=!![];else{if(_0x4079c1[_0x59583f(0x127d)]){const _0x4150ae=_0x12493e[_0x59583f(0x454)][_0x59583f(0xd85)](_0x53d0aa=>_0x53d0aa[_0x59583f(0x578)]===_0x4079c1[_0x59583f(0x127d)]);_0x4150ae?(_0x5489eb={..._0x164623,'type':_0x59583f(0x966),'content':_0x4150ae[_0x59583f(0x11a)],'meaning':_0x4150ae['name']},console[_0x59583f(0x51f)](_0x59583f(0xf4e)),_0x171f31=!![]):(_0x5489eb={..._0x164623,'type':'text','content':_0x59583f(0xa21)+_0x4079c1['meaning']+']'},console['warn'](_0x59583f(0x1052),_0x4079c1[_0x59583f(0x127d)]),_0x171f31=!![]);}else{if(_0x4079c1[_0x59583f(0x11a)]){_0x5489eb={..._0x164623,'type':_0x59583f(0x966),'content':_0x4079c1[_0x59583f(0x11a)]};const _0x5c4f96=_0x12493e[_0x59583f(0x454)][_0x59583f(0xd85)](_0x35c5c1=>_0x35c5c1[_0x59583f(0x11a)]===_0x4079c1[_0x59583f(0x11a)]);_0x5489eb[_0x59583f(0x127d)]=_0x5c4f96?_0x5c4f96[_0x59583f(0x578)]:_0x59583f(0x518),console[_0x59583f(0x51f)](_0x59583f(0x64f),_0x5489eb[_0x59583f(0x127d)]),_0x171f31=!![];}else{if(_0x4079c1[_0x59583f(0xcbd)]&&typeof _0x4079c1['content']===_0x59583f(0x9de)&&_0x301121['test'](_0x4079c1[_0x59583f(0xcbd)])){_0x5489eb={..._0x164623,'type':_0x59583f(0x966),'content':_0x4079c1['content']};const _0x580bfa=_0x12493e['userStickers']['find'](_0x7cc8d7=>_0x7cc8d7[_0x59583f(0x11a)]===_0x4079c1[_0x59583f(0xcbd)]);_0x5489eb['meaning']=_0x580bfa?_0x580bfa[_0x59583f(0x578)]:_0x59583f(0x518),console[_0x59583f(0x51f)](_0x59583f(0x166),_0x5489eb[_0x59583f(0x127d)]),_0x171f31=!![];}}}}if(!_0x171f31){console['error'](_0x59583f(0xeae),_0x4079c1);continue;}break;}case _0x59583f(0x8f5):_0x5489eb={..._0x164623,'type':_0x59583f(0x8f5),'content':_0x4079c1[_0x59583f(0x11ac)]};break;case _0x59583f(0xb41):_0x5489eb={..._0x164623,'type':_0x59583f(0xb41),'content':_0x4079c1['content']};break;case _0x59583f(0xe86):_0x5489eb={..._0x164623,'type':_0x59583f(0xe86),'amount':_0x4079c1[_0x59583f(0x609)],'note':_0x4079c1[_0x59583f(0x164)],'receiverName':_0x4079c1[_0x59583f(0x44d)]||'我'};break;case'waimai_request':_0x5489eb={..._0x164623,'type':_0x59583f(0x71d),'productInfo':_0x4079c1[_0x59583f(0x11d3)],'amount':_0x4079c1[_0x59583f(0x609)],'status':'pending','countdownEndTime':Date['now']()+0xf*0x3c*0x3e8};break;case _0x59583f(0x6bf):_0x5489eb={..._0x164623,..._0x4079c1};break;case _0x59583f(0x1c4):{const _0x3313df=_0xafc893[_0x3010d5['id']];if(_0x3313df){const _0x16c6ef=_0x3313df[_0x59583f(0x1294)][_0x59583f(0xfc9)](_0x1e1b3e=>_0x1e1b3e[_0x59583f(0xc86)]===0x2);if(_0x16c6ef>-0x1){const _0x47127a=_0x3313df[_0x59583f(0x1294)][_0x16c6ef];_0x3313df[_0x59583f(0x52d)][_0x47127a['y']][_0x47127a['x']]=0x0,_0x3313df[_0x59583f(0x1294)][_0x59583f(0xbd1)](_0x16c6ef,0x1),console[_0x59583f(0x51f)](_0x59583f(0xdcb)+_0x47127a['x']+',\x20'+_0x47127a['y']+_0x59583f(0x12a2));}}const _0x25692b=parseInt(_0x4079c1['x']),_0x583c82=parseInt(_0x4079c1['y']);!isNaN(_0x25692b)&&!isNaN(_0x583c82)?_0x4cd171({'x':_0x25692b,'y':_0x583c82},!![]):console['warn']('导演模式保存了一个无效的五子棋移动指令:',_0x4079c1);continue;}case'update_thoughts':{if(!_0x3010d5['isGroup']){_0x4079c1[_0x59583f(0xb66)]&&(_0x3010d5['heartfeltVoice']=String(_0x4079c1[_0x59583f(0xb66)]));_0x4079c1[_0x59583f(0x634)]&&(_0x3010d5[_0x59583f(0xb53)]=String(_0x4079c1[_0x59583f(0x634)]));!Array[_0x59583f(0x621)](_0x3010d5['thoughtsHistory'])&&(_0x3010d5['thoughtsHistory']=[]);_0x3010d5['thoughtsHistory'][_0x59583f(0x2d6)]({'heartfeltVoice':_0x3010d5[_0x59583f(0x70a)],'randomJottings':_0x3010d5[_0x59583f(0xb53)],'timestamp':Date[_0x59583f(0x6ee)]()});_0x3010d5[_0x59583f(0x11e9)][_0x59583f(0x79b)]>0x32&&_0x3010d5[_0x59583f(0x11e9)][_0x59583f(0x4fd)]();const _0x36c96c=_0x59583f(0x253)+_0x3010d5[_0x59583f(0x70a)]+'\x0a-\x20散记:\x20'+_0x3010d5[_0x59583f(0xb53)],_0x3996bb={'role':_0x59583f(0x152),'content':_0x36c96c,'timestamp':Date[_0x59583f(0x6ee)](),'isHidden':!![]};}continue;}case'quote_reply':{const _0x4cc37c=_0x3010d5[_0x59583f(0x1294)][_0x59583f(0xd85)](_0x143912=>_0x143912['timestamp']===_0x4079c1[_0x59583f(0xdbb)]);let _0x3f6b0f=null;if(_0x4cc37c){let _0x1b76c4=_0x4cc37c['senderName'];_0x4cc37c[_0x59583f(0x16d)]===_0x59583f(0x717)&&(_0x1b76c4=_0x3010d5[_0x59583f(0x80b)]?_0x3010d5['settings'][_0x59583f(0xbf6)]||'我':_0x12493e['qzoneSettings']['nickname']||_0x59583f(0x10d0)),_0x3f6b0f={'timestamp':_0x4079c1['target_timestamp'],'senderName':_0x1b76c4,'content':String(_0x4cc37c[_0x59583f(0xcbd)]||'')};}else _0x3f6b0f={'timestamp':_0x4079c1[_0x59583f(0xdbb)],'senderName':_0x59583f(0xffa),'content':'原始消息已删除或不存在'};_0x5489eb={..._0x164623,'content':_0x4079c1[_0x59583f(0xa32)],'quote':_0x3f6b0f};break;}default:console[_0x59583f(0x54a)](_0x59583f(0x77e),_0x4079c1[_0x59583f(0x52a)]);break;}_0x5489eb&&(_0x3010d5[_0x59583f(0x1294)][_0x59583f(0x2d6)](_0x5489eb),_0x154271[_0x59583f(0x2d6)](_0x5489eb['timestamp']));}await _0x2a2987[_0x59583f(0xc45)][_0x59583f(0xf36)](_0x3010d5),_0x1bbfd3(_0x12493e[_0x59583f(0x7bc)]),_0x597ed7(),document[_0x59583f(0xc33)](_0x59583f(0x7e8))[_0x59583f(0x10d3)][_0x59583f(0x2c7)](_0x59583f(0x143)),lastRawAiResponse=_0x29bd7a['join']('\x0a\x0a'),lastResponseTimestamps=_0x154271,await _0x2d7ddd(_0x59583f(0x1112),_0x59583f(0x862));}async function _0x74f38a(){const _0x1be4e6=_0x247bea;if(!_0x464fa7)return;const _0x12f2ff=0x2*0x3c*0x3e8,_0x4adb5e=_0x464fa7,_0x2cddfc=Date[_0x1be4e6(0x6ee)]();if(_0x2cddfc-_0x4adb5e>_0x12f2ff){_0x13dccc(),await _0x2d7ddd('操作失败','该消息发送已超过2分钟，无法撤回。');return;}await _0x2ea6ae(_0x4adb5e,!![]),_0x13dccc();}async function _0x2ea6ae(_0x306b8a,_0x4dae2f){const _0x4cfec9=_0x247bea,_0xe30d12=_0x12493e[_0x4cfec9(0xc45)][_0x12493e[_0x4cfec9(0x7bc)]];if(!_0xe30d12)return;const _0x378497=_0xe30d12[_0x4cfec9(0x1294)][_0x4cfec9(0xce9)](_0x20763d=>_0x20763d[_0x4cfec9(0x2f0)]===_0x306b8a);if(_0x378497===-0x1)return;const _0x580f64=_0xe30d12[_0x4cfec9(0x1294)][_0x378497],_0x3781d3={'originalType':_0x580f64['type']||_0x4cfec9(0x996),'originalContent':_0x580f64[_0x4cfec9(0xcbd)],'originalMeaning':_0x580f64[_0x4cfec9(0x127d)],'originalQuote':_0x580f64[_0x4cfec9(0xf74)]};_0x580f64['type']=_0x4cfec9(0x960),_0x580f64[_0x4cfec9(0xcbd)]=_0x4dae2f?_0x4cfec9(0x949):'对方撤回了一条消息',_0x580f64['recalledData']=_0x3781d3,delete _0x580f64[_0x4cfec9(0x127d)],delete _0x580f64[_0x4cfec9(0xf74)];if(_0x4dae2f){const _0x4928c7=_0xe30d12[_0x4cfec9(0x80b)]?_0xe30d12['settings'][_0x4cfec9(0xbf6)]||'我':'我';let _0x46407f='';if(_0x3781d3[_0x4cfec9(0xa5f)]===_0x4cfec9(0x966))_0x46407f=_0x4cfec9(0xca0)+(_0x3781d3['originalMeaning']||'未知')+']';else _0x3781d3[_0x4cfec9(0xa5f)]===_0x4cfec9(0x8f5)||_0x3781d3[_0x4cfec9(0xa5f)]===_0x4cfec9(0x142)?_0x46407f=_0x4cfec9(0x51d)+_0x3781d3[_0x4cfec9(0x96c)]+']':_0x46407f='“'+String(_0x3781d3[_0x4cfec9(0x96c)])+'”';const _0x1ae93a={'role':_0x4cfec9(0x152),'content':'[系统提示：用户（'+_0x4928c7+_0x4cfec9(0x74a)+_0x46407f+_0x4cfec9(0x1106),'timestamp':Date[_0x4cfec9(0x6ee)](),'isHidden':!![]};_0xe30d12[_0x4cfec9(0x1294)][_0x4cfec9(0x2d6)](_0x1ae93a);}await _0x2a2987[_0x4cfec9(0xc45)][_0x4cfec9(0xf36)](_0xe30d12),_0x1bbfd3(_0x12493e[_0x4cfec9(0x7bc)]),_0x4dae2f&&(_0x597ed7(),_0x439587());}async function _0x225d02(){const _0x3d5144=_0x247bea;await _0x151840(),document[_0x3d5144(0xc33)]('world-book-category-manager-modal')['classList'][_0x3d5144(0xb9)](_0x3d5144(0x143));}async function _0x151840(){const _0x460062=_0x247bea,_0x5d9503=document[_0x460062(0xc33)](_0x460062(0xaa6)),_0x4181ed=await _0x2a2987[_0x460062(0xd06)]['toArray']();_0x5d9503[_0x460062(0x102a)]='',_0x4181ed[_0x460062(0x79b)]===0x0&&(_0x5d9503[_0x460062(0x102a)]=_0x460062(0xc8f)),_0x4181ed['forEach'](_0x3531a4=>{const _0x25b53b=_0x460062,_0x509aac=document['createElement'](_0x25b53b(0x58c));_0x509aac[_0x25b53b(0x84)]=_0x25b53b(0x1151),_0x509aac[_0x25b53b(0x102a)]=_0x25b53b(0x2c1)+_0x3531a4['name']+_0x25b53b(0xeef)+_0x3531a4['id']+_0x25b53b(0x5ac),_0x5d9503[_0x25b53b(0xf77)](_0x509aac);});}async function _0x232903(){const _0x5126ec=_0x247bea,_0x4c3b79=document['getElementById'](_0x5126ec(0x127)),_0xc4387d=_0x4c3b79['value'][_0x5126ec(0x7da)]();if(!_0xc4387d){alert('分类名不能为空！');return;}const _0x5856ba=await _0x2a2987['worldBookCategories']['where'](_0x5126ec(0x578))[_0x5126ec(0x10bd)](_0xc4387d)[_0x5126ec(0x4e3)]();if(_0x5856ba){alert('分类\x20\x22'+_0xc4387d+_0x5126ec(0xe85));return;}await _0x2a2987['worldBookCategories'][_0x5126ec(0xb9)]({'name':_0xc4387d}),_0x4c3b79[_0x5126ec(0x22a)]='',await _0x151840();}async function _0x33cebb(_0xbd91c5){const _0x534421=_0x247bea,_0x17f2ac=await _0x270512(_0x534421(0x8d6),_0x534421(0x659),{'confirmButtonClass':_0x534421(0xa2)});if(_0x17f2ac){await _0x2a2987[_0x534421(0xd06)][_0x534421(0x9ea)](_0xbd91c5);const _0x486bbe=await _0x2a2987[_0x534421(0x63a)]['where']('categoryId')[_0x534421(0x10bd)](_0xbd91c5)[_0x534421(0xf15)]();for(const _0x3a3a16 of _0x486bbe){_0x3a3a16['categoryId']=null,await _0x2a2987[_0x534421(0x63a)][_0x534421(0xf36)](_0x3a3a16);const _0x153ca3=_0x12493e[_0x534421(0x63a)][_0x534421(0xd85)](_0x4bd754=>_0x4bd754['id']===_0x3a3a16['id']);if(_0x153ca3)_0x153ca3[_0x534421(0x305)]=null;}await _0x151840();}}async function _0x5e4c7b(){const _0x4abb75=_0x247bea;if(!_0x464fa7)return;const _0xe2fb95=_0x464fa7;_0x13dccc();const _0xf50ab8=_0x12493e[_0x4abb75(0xc45)][_0x12493e['activeChatId']],_0x2606d2=_0xf50ab8[_0x4abb75(0x1294)][_0x4abb75(0xd85)](_0x2b3220=>_0x2b3220[_0x4abb75(0x2f0)]===_0xe2fb95);if(!_0x2606d2)return;let _0x1ad6f3=String(_0x2606d2[_0x4abb75(0xcbd)]||'')[_0x4abb75(0x1033)](0x0,0x32)+_0x4abb75(0xda0);if(_0x2606d2[_0x4abb75(0x52a)]==='ai_image')_0x1ad6f3=_0x4abb75(0x1222)+_0x1ad6f3;const _0x7fea0b=await _0x270512('发布公告','确定要将以下消息发布到公告板吗？\x0a\x0a“'+_0x1ad6f3+'”',{'confirmText':_0x4abb75(0x488)});if(_0x7fea0b){const _0x2e46c8=_0xf50ab8[_0x4abb75(0x2ea)][_0x4abb75(0xbf6)]||'我';!Array[_0x4abb75(0x621)](_0xf50ab8[_0x4abb75(0x3d1)])&&(_0xf50ab8[_0x4abb75(0x3d1)]=[]);const _0x10e270={'id':_0x4abb75(0xfe5)+Date[_0x4abb75(0x6ee)](),'messageTimestamp':_0xe2fb95,'publisher':_0x2e46c8,'publishedAt':Date[_0x4abb75(0x6ee)](),'isPinned':![]};_0xf50ab8['announcements'][_0x4abb75(0x2d6)](_0x10e270);const _0x1f95e8={'role':_0x4abb75(0x152),'type':_0x4abb75(0xc05),'content':_0x2e46c8+_0x4abb75(0x111a),'timestamp':Date[_0x4abb75(0x6ee)]()};_0xf50ab8[_0x4abb75(0x1294)][_0x4abb75(0x2d6)](_0x1f95e8),await _0x2a2987[_0x4abb75(0xc45)]['put'](_0xf50ab8),_0x468ef0(_0x1f95e8,_0xf50ab8),_0x597ed7(),await _0x2d7ddd('成功',_0x4abb75(0xca9));}}async function _0x1275b4(){const _0x5d707a=_0x247bea,_0x28a412=_0x12493e[_0x5d707a(0xc45)][_0x12493e[_0x5d707a(0x7bc)]],_0x4b390f=_0x28a412[_0x5d707a(0x3d1)]||[];if(!_0x28a412||_0x4b390f[_0x5d707a(0x79b)]===0x0){_0x2d7ddd('提示',_0x5d707a(0xc6));return;}const _0x4a5d67=document[_0x5d707a(0xc33)](_0x5d707a(0xb4f));_0x4a5d67[_0x5d707a(0x102a)]='',_0x4b390f['sort']((_0x2df37d,_0x352de5)=>(_0x352de5[_0x5d707a(0x4fe)]?0x1:0x0)-(_0x2df37d[_0x5d707a(0x4fe)]?0x1:0x0));for(const _0xdeb0c6 of _0x4b390f){const _0x1812dc=_0x28a412['history'][_0x5d707a(0xd85)](_0x38eb61=>_0x38eb61['timestamp']===_0xdeb0c6[_0x5d707a(0x111f)]),_0xe5ef16=document[_0x5d707a(0x1292)](_0x5d707a(0x58c));_0xe5ef16[_0x5d707a(0x84)]=_0x5d707a(0xfb0);if(_0x1812dc){const _0x199d30=await _0x3f3a68(_0x1812dc,_0x28a412);_0x199d30&&_0xe5ef16[_0x5d707a(0xf77)](_0x199d30);}else _0xe5ef16[_0x5d707a(0x102a)]=_0x5d707a(0x9f1);_0xdeb0c6['isPinned']&&(_0xe5ef16['innerHTML']+=_0x5d707a(0x39b)),_0xe5ef16['innerHTML']+=_0x5d707a(0x46d)+_0xdeb0c6['id']+'\x22>...</div>',_0x4a5d67[_0x5d707a(0xf77)](_0xe5ef16);}document[_0x5d707a(0xc33)]('announcement-board-modal')[_0x5d707a(0x10d3)][_0x5d707a(0xb9)](_0x5d707a(0x143));}let _0x5f238f=null;function _0x2378d4(_0x2ad431){const _0x300dee=_0x247bea;_0x5f238f=_0x2ad431;const _0x4b7d0b=_0x12493e['chats'][_0x12493e['activeChatId']],_0x49489c=_0x4b7d0b['announcements'][_0x300dee(0xd85)](_0xd9773c=>_0xd9773c['id']===_0x2ad431);if(!_0x49489c)return;const _0x4fede3=document[_0x300dee(0xc33)]('announcement-action-pin');_0x4fede3[_0x300dee(0x11b0)]=_0x49489c['isPinned']?'取消置顶':_0x300dee(0xb40),document['getElementById'](_0x300dee(0x65f))['classList'][_0x300dee(0xb9)](_0x300dee(0x143));}async function _0x487486(){const _0x4206ef=_0x247bea;if(!_0x5f238f)return;const _0x55b5dd=_0x12493e['chats'][_0x12493e[_0x4206ef(0x7bc)]],_0xe6f38f=_0x55b5dd[_0x4206ef(0x3d1)][_0x4206ef(0xd85)](_0x57c059=>_0x57c059['id']===_0x5f238f);_0xe6f38f&&(_0xe6f38f[_0x4206ef(0x4fe)]=!_0xe6f38f['isPinned'],await _0x2a2987[_0x4206ef(0xc45)][_0x4206ef(0xf36)](_0x55b5dd),_0x1275b4()),document[_0x4206ef(0xc33)](_0x4206ef(0x65f))[_0x4206ef(0x10d3)]['remove']('visible');}async function _0x40da2a(){const _0x26ac59=_0x247bea;if(!_0x5f238f)return;const _0x388827=await _0x270512(_0x26ac59(0x8d6),_0x26ac59(0x7b0),{'confirmButtonClass':'btn-danger'});if(_0x388827){const _0x109185=_0x12493e[_0x26ac59(0xc45)][_0x12493e[_0x26ac59(0x7bc)]];_0x109185[_0x26ac59(0x3d1)]=_0x109185[_0x26ac59(0x3d1)]['filter'](_0x110b60=>_0x110b60['id']!==_0x5f238f),await _0x2a2987[_0x26ac59(0xc45)][_0x26ac59(0xf36)](_0x109185),_0x1275b4();}document[_0x26ac59(0xc33)](_0x26ac59(0x65f))[_0x26ac59(0x10d3)]['remove'](_0x26ac59(0x143));}let _0x5bb322=![],_0x1da720={'ai':null,'my':null};function _0x3286e7(_0x334a41='chat'){const _0x3c92ed=_0x247bea,_0x329f69=document[_0x3c92ed(0xc33)](_0x3c92ed(0xe94));if(!_0x12493e['activeChatId'])return;const _0x1446eb=_0x12493e[_0x3c92ed(0xc45)][_0x12493e['activeChatId']];_0x5bb322=_0x334a41===_0x3c92ed(0xe99);if(_0x5bb322){const _0x1cbd3c=_0x1446eb['members'][_0x3c92ed(0xd85)](_0x3aaea0=>_0x3aaea0['id']===_0x31659f);if(!_0x1cbd3c)return;_0x1da720['my']=_0x1cbd3c['avatarFrame']||'',_0x3280ee(!![],_0x1cbd3c[_0x3c92ed(0xbac)],_0x1cbd3c[_0x3c92ed(0x2f4)]);}else _0x1da720['ai']=_0x1446eb[_0x3c92ed(0x2ea)][_0x3c92ed(0x435)]||'',_0x1da720['my']=_0x1446eb['settings'][_0x3c92ed(0xe8b)]||'',_0x3280ee(![]);_0x329f69[_0x3c92ed(0x10d3)][_0x3c92ed(0xb9)](_0x3c92ed(0x143));}function _0x3280ee(_0x5e4135=![],_0x4a3ace=null,_0x412456=null){const _0x12ac2a=_0x247bea,_0x5d0487=document[_0x12ac2a(0xc33)](_0x12ac2a(0x126d)),_0xf24a2a=document[_0x12ac2a(0xc33)](_0x12ac2a(0x6de)),_0x9daa71=_0x12493e[_0x12ac2a(0xc45)][_0x12493e[_0x12ac2a(0x7bc)]];_0x5d0487[_0x12ac2a(0x102a)]='',_0xf24a2a[_0x12ac2a(0x102a)]='',document[_0x12ac2a(0x977)](_0x12ac2a(0x760))[_0x12ac2a(0x105d)]['display']=_0x5e4135?'none':_0x12ac2a(0x21a),document[_0x12ac2a(0xc33)](_0x12ac2a(0xbe))[_0x12ac2a(0x105d)][_0x12ac2a(0xf44)]=_0x12ac2a(0xa20),document[_0x12ac2a(0xc33)](_0x12ac2a(0xc1d))[_0x12ac2a(0x105d)]['display']=_0x12ac2a(0x854),document[_0x12ac2a(0xc33)](_0x12ac2a(0x738))[_0x12ac2a(0x10d3)]['add']('active'),document[_0x12ac2a(0xc33)](_0x12ac2a(0x912))[_0x12ac2a(0x10d3)][_0x12ac2a(0x2c7)](_0x12ac2a(0x1043));if(_0x5e4135)_0x491751['forEach'](_0x58019f=>{const _0x7ffdd1=_0x12ac2a,_0x4c9eeb=_0x3bd24b(_0x58019f,'my',_0x4a3ace);_0x58019f[_0x7ffdd1(0x11a)]===_0x412456&&_0x4c9eeb[_0x7ffdd1(0x10d3)][_0x7ffdd1(0xb9)]('selected'),_0x5d0487[_0x7ffdd1(0xf77)](_0x4c9eeb);});else{const _0x48946a=_0x9daa71[_0x12ac2a(0x2ea)][_0x12ac2a(0x18e)]||_0x190acc,_0x509b3b=_0x9daa71[_0x12ac2a(0x2ea)]['myAvatar']||(_0x9daa71[_0x12ac2a(0x80b)]?_0x200461:_0x190acc);_0x491751['forEach'](_0x402d71=>{const _0x4ce3c6=_0x12ac2a,_0x4066a1=_0x3bd24b(_0x402d71,'ai',_0x48946a);if(_0x402d71[_0x4ce3c6(0x11a)]===_0x1da720['ai'])_0x4066a1['classList'][_0x4ce3c6(0xb9)](_0x4ce3c6(0x63f));_0x5d0487[_0x4ce3c6(0xf77)](_0x4066a1);const _0x22edbd=_0x3bd24b(_0x402d71,'my',_0x509b3b);if(_0x402d71[_0x4ce3c6(0x11a)]===_0x1da720['my'])_0x22edbd['classList'][_0x4ce3c6(0xb9)]('selected');_0xf24a2a['appendChild'](_0x22edbd);});}}function _0x3bd24b(_0x469d13,_0x30d8e7,_0x474c79){const _0x6687d2=_0x247bea,_0x2457ab=document[_0x6687d2(0x1292)](_0x6687d2(0x58c));return _0x2457ab[_0x6687d2(0x84)]=_0x6687d2(0x10cd),_0x2457ab['dataset'][_0x6687d2(0x782)]=_0x469d13[_0x6687d2(0x11a)],_0x2457ab[_0x6687d2(0x874)]=_0x469d13[_0x6687d2(0x578)],_0x2457ab[_0x6687d2(0x102a)]=_0x6687d2(0x6d7)+_0x474c79+_0x6687d2(0x71f)+(_0x469d13[_0x6687d2(0x11a)]?_0x6687d2(0xb19)+_0x469d13[_0x6687d2(0x11a)]+'\x22\x20class=\x22preview-frame\x22>':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x2457ab[_0x6687d2(0x205)](_0x6687d2(0x335),()=>{const _0x3ff71c=_0x6687d2;_0x1da720[_0x30d8e7]=_0x469d13['url'];const _0x3b1d6c=_0x30d8e7==='ai'?document[_0x3ff71c(0xc33)](_0x3ff71c(0x126d)):document['getElementById'](_0x3ff71c(0x6de));_0x3b1d6c[_0x3ff71c(0x67a)](_0x3ff71c(0xa8d))['forEach'](_0x23c281=>_0x23c281[_0x3ff71c(0x10d3)][_0x3ff71c(0x2c7)](_0x3ff71c(0x63f))),_0x2457ab[_0x3ff71c(0x10d3)][_0x3ff71c(0xb9)](_0x3ff71c(0x63f));}),_0x2457ab;}async function _0x5bcc80(){const _0x2dee44=_0x247bea;if(!_0x12493e[_0x2dee44(0x7bc)])return;const _0x12d5ea=_0x12493e[_0x2dee44(0xc45)][_0x12493e[_0x2dee44(0x7bc)]];if(_0x5bb322){const _0x1037ae=_0x12d5ea[_0x2dee44(0xd5b)][_0x2dee44(0xd85)](_0x4ef3f4=>_0x4ef3f4['id']===_0x31659f);_0x1037ae&&(_0x1037ae[_0x2dee44(0x2f4)]=_0x1da720['my']);}else _0x12d5ea[_0x2dee44(0x2ea)][_0x2dee44(0x435)]=_0x1da720['ai'],_0x12d5ea['settings'][_0x2dee44(0xe8b)]=_0x1da720['my'];await _0x2a2987[_0x2dee44(0xc45)][_0x2dee44(0xf36)](_0x12d5ea);if(!_0x5bb322&&!_0x12d5ea[_0x2dee44(0x80b)]){const _0x245db1=_0x12d5ea['id'];for(const _0x2ec0ec of Object['values'](_0x12493e[_0x2dee44(0xc45)])){if(_0x2ec0ec[_0x2dee44(0x80b)]&&_0x2ec0ec[_0x2dee44(0xd5b)]){const _0x1a7d51=_0x2ec0ec['members']['find'](_0x25c978=>_0x25c978['id']===_0x245db1);_0x1a7d51&&(_0x1a7d51[_0x2dee44(0x2f4)]=_0x12d5ea[_0x2dee44(0x2ea)]['aiAvatarFrame'],await _0x2a2987[_0x2dee44(0xc45)][_0x2dee44(0xf36)](_0x2ec0ec),console[_0x2dee44(0x51f)]('已同步角色\x20'+_0x245db1+'\x20的头像框到群聊\x20\x22'+_0x2ec0ec['name']+'\x22'));}}}document[_0x2dee44(0xc33)](_0x2dee44(0xe94))[_0x2dee44(0x10d3)][_0x2dee44(0x2c7)]('visible'),_0x1bbfd3(_0x12493e[_0x2dee44(0x7bc)]),alert(_0x2dee44(0xfdf)),_0x5bb322=![];}function _0x59483d(){const _0xa30bde=_0x247bea;_0x52569b=!_0x52569b;const _0x59c5c5=document[_0xa30bde(0xc33)](_0xa30bde(0xba4)),_0x23c12b=document[_0xa30bde(0xc33)](_0xa30bde(0xd6f)),_0x58e89f=document['getElementById']('select-all-frames-checkbox');document['querySelectorAll'](_0xa30bde(0x165))[_0xa30bde(0xd6a)](_0x11ba16=>{const _0x4c30b6=_0xa30bde;_0x11ba16[_0x4c30b6(0x10d3)][_0x4c30b6(0xe2c)](_0x4c30b6(0x491),_0x52569b);}),_0x52569b?(_0x59c5c5[_0xa30bde(0x11b0)]='完成',_0x23c12b[_0xa30bde(0x105d)]['display']=_0xa30bde(0x21a),_0x289122[_0xa30bde(0xebb)](),_0x58e89f['checked']=![],_0x8f575c()):(_0x59c5c5[_0xa30bde(0x11b0)]='管理',_0x23c12b[_0xa30bde(0x105d)][_0xa30bde(0xf44)]=_0xa30bde(0x854),document[_0xa30bde(0x67a)](_0xa30bde(0x6db))[_0xa30bde(0xd6a)](_0x1fec5f=>{const _0x3cdacf=_0xa30bde;_0x1fec5f[_0x3cdacf(0x10d3)][_0x3cdacf(0x2c7)](_0x3cdacf(0x63f));}));}function _0x8f575c(){const _0x487ad3=_0x247bea,_0x22bc75=document[_0x487ad3(0xc33)](_0x487ad3(0xb80));_0x22bc75[_0x487ad3(0x11b0)]=_0x487ad3(0x6fb)+_0x289122[_0x487ad3(0x57e)]+')';}function _0x54191f(){const _0x4694e2=_0x247bea,_0x253cf7=document[_0x4694e2(0xc33)]('select-all-frames-checkbox')[_0x4694e2(0x737)],_0x1f953f=document['querySelector'](_0x4694e2(0x8a2));if(!_0x1f953f)return;_0x1f953f[_0x4694e2(0x67a)](_0x4694e2(0x956))[_0x4694e2(0xd6a)](_0x50c569=>{const _0xb98f3f=_0x4694e2,_0x51ba41=parseInt(_0x50c569[_0xb98f3f(0x977)]('.delete-btn')[_0xb98f3f(0x85)]['id']);if(isNaN(_0x51ba41))return;_0x50c569[_0xb98f3f(0x10d3)][_0xb98f3f(0xe2c)](_0xb98f3f(0x63f),_0x253cf7),_0x253cf7?_0x289122[_0xb98f3f(0xb9)](_0x51ba41):_0x289122[_0xb98f3f(0x9ea)](_0x51ba41);}),_0x8f575c();}async function _0x188b5b(){const _0x4a5f85=_0x247bea;if(_0x289122[_0x4a5f85(0x57e)]===0x0)return;const _0x2103e5=await _0x270512(_0x4a5f85(0x8d6),_0x4a5f85(0x12d)+_0x289122[_0x4a5f85(0x57e)]+'\x20个自定义头像框吗？',{'confirmButtonClass':_0x4a5f85(0xa2)});if(_0x2103e5){const _0x5ea3e4=[..._0x289122];await _0x2a2987['customAvatarFrames'][_0x4a5f85(0x98b)](_0x5ea3e4),_0x59483d(),_0x3280ee(_0x5bb322),await _0x2d7ddd(_0x4a5f85(0xf8f),_0x4a5f85(0x7f0));}}function _0x3e472a(_0x1c35d5){const _0x3569d8=_0x247bea,_0x3c33c6=document['getElementById'](_0x3569d8(0x52e));_0x3c33c6&&(_0x3c33c6[_0x3569d8(0x102a)]=_0x1c35d5||'');}async function _0x2b9cc6(_0x591c8c){const _0x4cfaa4=_0x247bea;if(!_0x5ebb31[_0x4cfaa4(0x1f3)]||!_0x5ebb31[_0x4cfaa4(0x7bc)])return;const _0xa1a42f=_0x12493e['chats'][_0x5ebb31['activeChatId']];if(!_0xa1a42f)return;const _0x34be47=_0xa1a42f['isGroup']?_0xa1a42f[_0x4cfaa4(0x2ea)][_0x4cfaa4(0xbf6)]||'我':'我',_0x5d06ae=_0x4cfaa4(0xadb)+_0x34be47+')\x20'+_0x591c8c+']',_0x23979c={'role':_0x4cfaa4(0x152),'content':_0x5d06ae,'timestamp':Date['now'](),'isHidden':!![]};_0xa1a42f[_0x4cfaa4(0x1294)]['push'](_0x23979c),await _0x2a2987[_0x4cfaa4(0xc45)]['put'](_0xa1a42f);}async function _0xdf290d(){const _0x5a7000=_0x247bea;if(_0x2078e5[_0x5a7000(0x57e)]===0x0)return;const _0x4bfd22=_0x12493e[_0x5a7000(0xc45)][_0x12493e['activeChatId']];if(!_0x4bfd22)return;const _0x407210=document['getElementById'](_0x5a7000(0xcca)),_0x1b3a4c=_0x407210['textContent'];_0x407210[_0x5a7000(0x11b0)]='生成中...',_0x407210[_0x5a7000(0xfd8)]=!![];const _0xc6c0fa=document[_0x5a7000(0x1292)](_0x5a7000(0x58c)),_0x543479=document[_0x5a7000(0xc33)](_0x5a7000(0x779));_0xc6c0fa[_0x5a7000(0x105d)][_0x5a7000(0x5f8)]=_0x543479[_0x5a7000(0xeba)]+'px',_0xc6c0fa[_0x5a7000(0x105d)][_0x5a7000(0x1015)]='absolute',_0xc6c0fa[_0x5a7000(0x105d)][_0x5a7000(0xcbe)]=_0x5a7000(0x364),_0xc6c0fa[_0x5a7000(0x105d)][_0x5a7000(0x9e2)]=_0x5a7000(0x364),_0xc6c0fa['style']['display']=_0x5a7000(0x21a),_0xc6c0fa['style'][_0x5a7000(0xdf7)]=_0x5a7000(0xe89),_0xc6c0fa[_0x5a7000(0x105d)][_0x5a7000(0x27d)]=_0x5a7000(0x2c6);const _0x5dbb3b=document['getElementById'](_0x5a7000(0xf1b));_0xc6c0fa[_0x5a7000(0x105d)][_0x5a7000(0x4b5)]=_0x5dbb3b['style'][_0x5a7000(0x4b5)],_0xc6c0fa[_0x5a7000(0x105d)][_0x5a7000(0x1c5)]=_0x5dbb3b[_0x5a7000(0x105d)]['backgroundColor']||(document[_0x5a7000(0xc33)](_0x5a7000(0x779))['classList'][_0x5a7000(0x3af)](_0x5a7000(0x10d2))?_0x5a7000(0xa40):_0x5a7000(0xf78));const _0x59b34f=document['createElement'](_0x5a7000(0x105d));_0x59b34f['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.message-bubble.selected::after\x20{\x20display:\x20none\x20!important;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cloned-header\x20.default-controls\x20{\x20display:\x20flex\x20!important;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x20width:\x20100%;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cloned-header\x20.selection-controls\x20{\x20display:\x20none\x20!important;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',document[_0x5a7000(0xcb4)][_0x5a7000(0xf77)](_0x59b34f);try{const _0x9a2519=_0x5dbb3b[_0x5a7000(0x977)](_0x5a7000(0xa93))[_0x5a7000(0xbc5)](!![]);_0x9a2519[_0x5a7000(0x10d3)]['add'](_0x5a7000(0x63b));const _0x128cad=document[_0x5a7000(0x1292)](_0x5a7000(0x58c)),_0x1f8865=document['getElementById'](_0x5a7000(0xe81));_0x128cad[_0x5a7000(0x105d)][_0x5a7000(0xf44)]='flex',_0x128cad[_0x5a7000(0x105d)]['flexDirection']=_0x5a7000(0xe89),_0x128cad[_0x5a7000(0x105d)][_0x5a7000(0x1207)]=_0x5a7000(0x910),_0x128cad[_0x5a7000(0x105d)]['padding']=_0x5a7000(0xce3),_0x128cad[_0x5a7000(0x105d)][_0x5a7000(0x5f8)]='100%',_0x128cad[_0x5a7000(0x105d)][_0x5a7000(0x1a4)]=_0x5a7000(0x955),_0x128cad['dataset'][_0x5a7000(0x8a9)]=_0x1f8865[_0x5a7000(0x85)][_0x5a7000(0x8a9)],_0x128cad[_0x5a7000(0x105d)][_0x5a7000(0x7f3)](_0x5a7000(0x101b),_0x1f8865[_0x5a7000(0x105d)][_0x5a7000(0x106a)](_0x5a7000(0x101b)));const _0x482517=_0x5dbb3b['querySelector']('#chat-input-area')[_0x5a7000(0xbc5)](!![]),_0x473f44=[..._0x2078e5]['sort']((_0xfe4bfb,_0x2c8666)=>_0xfe4bfb-_0x2c8666);_0x473f44['forEach'](_0x4d3a19=>{const _0x717ab1=_0x5a7000,_0x51f5f1=document['querySelector'](_0x717ab1(0xe27)+_0x4d3a19+'\x22]');if(_0x51f5f1){const _0x651ba=_0x51f5f1[_0x717ab1(0x7a7)](_0x717ab1(0x1ab));_0x651ba&&_0x128cad[_0x717ab1(0xf77)](_0x651ba[_0x717ab1(0xbc5)](!![]));}}),_0xc6c0fa['appendChild'](_0x9a2519),_0xc6c0fa[_0x5a7000(0xf77)](_0x128cad),_0xc6c0fa[_0x5a7000(0xf77)](_0x482517),document[_0x5a7000(0x344)]['appendChild'](_0xc6c0fa);const _0x244514=Array['from'](_0xc6c0fa[_0x5a7000(0xe7c)](_0x5a7000(0x605))),_0x1eb4e0=_0x244514[_0x5a7000(0x9d5)](_0x5460aa=>new Promise((_0x473743,_0x110767)=>{const _0xc7aeb8=_0x5a7000;if(_0x5460aa['src'][_0xc7aeb8(0xece)](_0xc7aeb8(0x351))){_0x473743();return;}const _0x550bdd=new Image();_0x550bdd[_0xc7aeb8(0xf03)]=_0xc7aeb8(0x214),_0x550bdd[_0xc7aeb8(0x833)]=_0x473743,_0x550bdd[_0xc7aeb8(0x6e0)]=_0x473743,_0x550bdd['src']=_0x5460aa[_0xc7aeb8(0x87b)];}));await Promise[_0x5a7000(0x5c8)](_0x1eb4e0);const _0xf998c1=await html2canvas(_0xc6c0fa,{'allowTaint':!![],'useCORS':!![],'backgroundColor':null,'scale':window[_0x5a7000(0x5ce)]||0x2});_0xf998c1[_0x5a7000(0xa04)](function(_0x163ff4){const _0x1ef2fb=_0x5a7000,_0x16a5f1=URL[_0x1ef2fb(0xca2)](_0x163ff4),_0x155b39=document[_0x1ef2fb(0x1292)]('a');_0x155b39['download']=_0x1ef2fb(0x16a)+_0x4bfd22[_0x1ef2fb(0x578)]+'-'+Date[_0x1ef2fb(0x6ee)]()+_0x1ef2fb(0x11c2),_0x155b39[_0x1ef2fb(0x9c0)]=_0x16a5f1,document[_0x1ef2fb(0x344)][_0x1ef2fb(0xf77)](_0x155b39),_0x155b39[_0x1ef2fb(0x335)](),document[_0x1ef2fb(0x344)]['removeChild'](_0x155b39),URL[_0x1ef2fb(0x1202)](_0x16a5f1);},'image/png');}catch(_0x19a7f4){console[_0x5a7000(0x4d9)](_0x5a7000(0xb1e),_0x19a7f4),await _0x2d7ddd(_0x5a7000(0x8b1),'生成截图时发生错误，请检查控制台获取详情。');}finally{document[_0x5a7000(0x344)][_0x5a7000(0xefc)](_0xc6c0fa),document[_0x5a7000(0xcb4)][_0x5a7000(0xefc)](_0x59b34f),_0x407210[_0x5a7000(0x11b0)]=_0x1b3a4c,_0x407210[_0x5a7000(0xfd8)]=![],_0x5e1dc2();}}function _0x45d05d(_0x1ca66d){const _0x572ea0=_0x247bea;if(!_0x1ca66d||typeof _0x1ca66d!==_0x572ea0(0x9de))return'';return _0x1ca66d=_0x1ca66d[_0x572ea0(0xc12)](/!h\{(.*?)\}/g,'<span\x20class=\x22diary-highlight\x22>$1</span>'),_0x1ca66d=_0x1ca66d['replace'](/!u\{(.*?)\}/g,_0x572ea0(0xda1)),_0x1ca66d=_0x1ca66d[_0x572ea0(0xc12)](/!e\{(.*?)\}/g,_0x572ea0(0xe30)),_0x1ca66d=_0x1ca66d[_0x572ea0(0xc12)](/!w\{(.*?)\}/g,_0x572ea0(0x5f0)),_0x1ca66d=_0x1ca66d[_0x572ea0(0xc12)](/!m\{(.*?)\}/g,_0x572ea0(0xb29)),_0x1ca66d=_0x1ca66d[_0x572ea0(0xc12)](/\|\|(.*?)\|\|/g,_0x572ea0(0x2fd)),_0x1ca66d=_0x1ca66d['replace'](/\*\*(.*?)\*\*/g,'<strong>$1</strong>'),_0x1ca66d=_0x1ca66d[_0x572ea0(0xc12)](/\~\~(.*?)\~\~/g,_0x572ea0(0x1173)),_0x1ca66d=_0x1ca66d[_0x572ea0(0xc12)](/\*(.*?)\*/g,_0x572ea0(0x127a)),_0x1ca66d;}async function _0x901c31(){const _0x50e66a=_0x247bea;console[_0x50e66a(0x51f)]('开始检查并迁移旧的红包数据...');let _0x4bdc2f=0x0;const _0xcf827c=Object[_0x50e66a(0xd28)](_0x12493e[_0x50e66a(0xc45)]);for(const _0x3c9f60 of _0xcf827c){let _0x26bc2b=![];for(const _0x2b2153 of _0x3c9f60[_0x50e66a(0x1294)]){_0x2b2153[_0x50e66a(0x52a)]==='red_packet'&&_0x2b2153[_0x50e66a(0xa2a)]===_0x50e66a(0x3d4)&&_0x2b2153['role']===_0x50e66a(0x376)&&_0x2b2153['hasOwnProperty'](_0x50e66a(0x44d))&&!_0x2b2153['hasOwnProperty']('receiverName')&&(_0x2b2153['receiverName']=_0x2b2153[_0x50e66a(0x44d)],delete _0x2b2153['receiver'],_0x26bc2b=!![],_0x4bdc2f++);}_0x26bc2b&&(console[_0x50e66a(0x51f)](_0x50e66a(0xb86)+_0x3c9f60[_0x50e66a(0x578)]+_0x50e66a(0x1296)),await _0x2a2987[_0x50e66a(0xc45)][_0x50e66a(0xf36)](_0x3c9f60));}_0x4bdc2f>0x0?(console[_0x50e66a(0x51f)](_0x50e66a(0xde0)+_0x4bdc2f+_0x50e66a(0x1a7)),alert(_0x50e66a(0x102f)+_0x4bdc2f+_0x50e66a(0xceb)),location[_0x50e66a(0x99b)]()):console[_0x50e66a(0x51f)]('未发现需要迁移的旧红包数据。');}function _0x51e92a(_0x108b22){const _0x3bce09=_0x247bea,_0x4af431=_0x12493e['chats'][_0x108b22];if(!_0x4af431||_0x4af431[_0x3bce09(0x80b)])return;document[_0x3bce09(0xc33)](_0x3bce09(0x44f))[_0x3bce09(0x11b0)]=_0x4af431[_0x3bce09(0x70a)]||_0x3bce09(0xda0),document[_0x3bce09(0xc33)](_0x3bce09(0xc3d))[_0x3bce09(0x11b0)]=_0x4af431[_0x3bce09(0xb53)]||_0x3bce09(0xda0);const _0x177073=document[_0x3bce09(0xc33)]('character-profile-modal');_0x177073[_0x3bce09(0x10d3)][_0x3bce09(0xb9)]('visible');}function _0x318890(){const _0x491671=_0x247bea;document['getElementById'](_0x491671(0xab))[_0x491671(0x105d)]['display']='none',document[_0x491671(0xc33)](_0x491671(0x110a))[_0x491671(0x105d)][_0x491671(0xf44)]=_0x491671(0x21a),_0x2d1b8f();}function _0x4958eb(){const _0x366305=_0x247bea;document['getElementById'](_0x366305(0x110a))['style'][_0x366305(0xf44)]=_0x366305(0x854),document['getElementById'](_0x366305(0xab))[_0x366305(0x105d)][_0x366305(0xf44)]='flex';}function _0x2d1b8f(){const _0x48fdea=_0x247bea,_0x272e12=document[_0x48fdea(0xc33)](_0x48fdea(0xa1c)),_0x5cbc61=_0x12493e[_0x48fdea(0xc45)][_0x12493e[_0x48fdea(0x7bc)]];_0x272e12[_0x48fdea(0x102a)]='';if(!_0x5cbc61||!_0x5cbc61[_0x48fdea(0x11e9)]||_0x5cbc61['thoughtsHistory']['length']===0x0){_0x272e12[_0x48fdea(0x102a)]='<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20padding:\x2030px\x200;\x22>这里还没有历史记录哦。</p>';return;}const _0x42e3d5=[..._0x5cbc61['thoughtsHistory']][_0x48fdea(0xc07)](),_0x1f3b06=_0x42e3d5[_0x48fdea(0x111c)](0x0,_0x5e839e);_0x1f3b06[_0x48fdea(0xd6a)](_0xc283b4=>{const _0x22ab29=_0x40c62e(_0xc283b4);_0x272e12['appendChild'](_0x22ab29);}),_0x574be1=_0x1f3b06[_0x48fdea(0x79b)],_0x42e3d5['length']>_0x574be1&&appendLoadMoreThoughtsButton(_0x272e12);}async function _0x4b642c(){const _0x4aad0b=_0x247bea;if(_0x4f8071)return;_0x4f8071=!![];const _0x834685=document[_0x4aad0b(0xc33)]('thoughts-history-list'),_0x6b41fd=_0x12493e[_0x4aad0b(0xc45)][_0x12493e[_0x4aad0b(0x7bc)]];if(!_0x6b41fd){_0x4f8071=![];return;}_0x11bb7f(_0x834685,'bottom'),await new Promise(_0x31a331=>setTimeout(_0x31a331,0x1f4));const _0x699677=[..._0x6b41fd[_0x4aad0b(0x11e9)]][_0x4aad0b(0xc07)](),_0x169376=_0x699677['length'],_0x120c5c=_0x574be1,_0x29088f=_0x574be1+_0x5e839e,_0x1b0219=_0x699677[_0x4aad0b(0x111c)](_0x120c5c,_0x29088f);_0x153aed(_0x834685),_0x1b0219[_0x4aad0b(0xd6a)](_0x485e51=>{const _0x383645=_0x4aad0b,_0x14f223=_0x40c62e(_0x485e51);_0x834685[_0x383645(0xf77)](_0x14f223);}),_0x574be1+=_0x1b0219[_0x4aad0b(0x79b)],_0x4f8071=![];}function _0x40c62e(_0x31f616){const _0xa79359=_0x247bea,_0x12f03a=document['createElement'](_0xa79359(0x58c));_0x12f03a[_0xa79359(0x84)]=_0xa79359(0x3d6);const _0x557791=new Date(_0x31f616[_0xa79359(0x2f0)]),_0x33d177=_0x557791[_0xa79359(0x80d)]()+'-'+String(_0x557791['getMonth']()+0x1)[_0xa79359(0x70d)](0x2,'0')+'-'+String(_0x557791['getDate']())[_0xa79359(0x70d)](0x2,'0')+'\x20'+String(_0x557791['getHours']())['padStart'](0x2,'0')+':'+String(_0x557791['getMinutes']())['padStart'](0x2,'0');return _0x12f03a['innerHTML']=_0xa79359(0x119c)+_0x31f616[_0xa79359(0x2f0)]+'\x22\x20title=\x22删除此条记录\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22thought-header\x22>'+_0x33d177+_0xa79359(0x883)+_0x31f616[_0xa79359(0x70a)]+_0xa79359(0x837)+_0x31f616[_0xa79359(0xb53)]+_0xa79359(0x109e),_0x12f03a;}async function _0x295e3c(_0x4dc552){const _0x44afff=_0x247bea,_0x3489f3=_0x4dc552['target'][_0x44afff(0x1d0)][0x0];if(!_0x3489f3)return;try{let _0x2f1046,_0x2fb0a9=null;if(_0x3489f3[_0x44afff(0x578)]['endsWith'](_0x44afff(0xc8))){const _0x43232b=await _0x3489f3[_0x44afff(0x996)]();_0x2f1046=JSON[_0x44afff(0x6b1)](_0x43232b);}else{if(_0x3489f3[_0x44afff(0x578)][_0x44afff(0x5d5)](_0x44afff(0x11c2))){const _0x1aa085=await _0x3489f3[_0x44afff(0xf5e)]();_0x2f1046=await _0x29aa12(_0x1aa085),_0x2fb0a9=await new Promise(_0x11fefa=>{const _0x28aa03=_0x44afff,_0x10d813=new FileReader();_0x10d813['onload']=()=>_0x11fefa(_0x10d813[_0x28aa03(0x129)]),_0x10d813[_0x28aa03(0xbcf)](_0x3489f3);});}else throw new Error(_0x44afff(0x1017));}await _0x347242(_0x2f1046,_0x2fb0a9);}catch(_0x20da44){console['error'](_0x44afff(0x7a0),_0x20da44),await _0x2d7ddd('导入失败',_0x44afff(0x97d)+_0x20da44[_0x44afff(0xf93)]);}finally{_0x4dc552['target'][_0x44afff(0x22a)]=null;}}function _0x29aa12(_0x55e191){return new Promise((_0x412031,_0x26dfda)=>{const _0xa661c1=_0x26e9,_0x5b59b3=new DataView(_0x55e191);if(_0x5b59b3[_0xa661c1(0xf6f)](0x0)!==0x89504e47||_0x5b59b3[_0xa661c1(0xf6f)](0x4)!==0xd0a1a0a)return _0x26dfda(new Error(_0xa661c1(0x2db)));let _0x853b2c=0x8;const _0x5ec6d0=new TextDecoder();while(_0x853b2c<_0x5b59b3['byteLength']){const _0x11975f=_0x5b59b3[_0xa661c1(0xf6f)](_0x853b2c),_0x52d365=_0x5ec6d0['decode'](_0x55e191['slice'](_0x853b2c+0x4,_0x853b2c+0x8));if(_0x52d365===_0xa661c1(0x1094)){const _0x4e0ac7=new Uint8Array(_0x55e191,_0x853b2c+0x8,_0x11975f),_0x404b6c=_0x4e0ac7[_0xa661c1(0x107e)](0x0);if(_0x404b6c!==-0x1){const _0x542321=_0x5ec6d0['decode'](_0x4e0ac7[_0xa661c1(0x111c)](0x0,_0x404b6c));if(_0x542321===_0xa661c1(0x11fc)){const _0xe8f5f9=_0x5ec6d0[_0xa661c1(0x291)](_0x4e0ac7[_0xa661c1(0x111c)](_0x404b6c+0x1));try{const _0x4e86b4=atob(_0xe8f5f9),_0x43cdb0=new Uint8Array(_0x4e86b4[_0xa661c1(0x79b)]);for(let _0x2aea54=0x0;_0x2aea54<_0x4e86b4[_0xa661c1(0x79b)];_0x2aea54++){_0x43cdb0[_0x2aea54]=_0x4e86b4[_0xa661c1(0xe1)](_0x2aea54);}const _0x1617a0=new TextDecoder('utf-8')[_0xa661c1(0x291)](_0x43cdb0);_0x412031(JSON[_0xa661c1(0x6b1)](_0x1617a0));return;}catch(_0x3d8af5){return _0x26dfda(new Error(_0xa661c1(0x64a)+_0x3d8af5[_0xa661c1(0xf93)]));}}}}_0x853b2c+=0x4+0x4+_0x11975f+0x4;}_0x26dfda(new Error(_0xa661c1(0x448)));});}function _0x472de5(_0x45e695){const _0x23b5ea=_0x247bea;if(_0x45e695['data']?.[_0x23b5ea(0xe83)]?.[_0x23b5ea(0x43e)]?.['length']>0x0)return console[_0x23b5ea(0x51f)](_0x23b5ea(0xf61)),_0x45e695[_0x23b5ea(0xa78)][_0x23b5ea(0xe83)][_0x23b5ea(0x43e)];if(_0x45e695[_0x23b5ea(0x118c)]?.[_0x23b5ea(0xe83)]?.[_0x23b5ea(0x43e)]?.[_0x23b5ea(0x79b)]>0x0)return console[_0x23b5ea(0x51f)]('诊断：在\x20extensions.character_book\x20中找到世界书。'),_0x45e695[_0x23b5ea(0x118c)][_0x23b5ea(0xe83)][_0x23b5ea(0x43e)];if(_0x45e695[_0x23b5ea(0xa78)]?.[_0x23b5ea(0x118c)]?.['character_book']?.[_0x23b5ea(0x43e)]?.['length']>0x0)return console['log'](_0x23b5ea(0x45d)),_0x45e695[_0x23b5ea(0xa78)][_0x23b5ea(0x118c)][_0x23b5ea(0xe83)][_0x23b5ea(0x43e)];const _0x349b45=['character_book',_0x23b5ea(0x4bb),_0x23b5ea(0xd24),'char_book'];for(const _0x737cac of _0x349b45){if(_0x45e695[_0x737cac]?.[_0x23b5ea(0x43e)]?.['length']>0x0)return console['log'](_0x23b5ea(0xd2b)+_0x737cac+_0x23b5ea(0xc2d)),_0x45e695[_0x737cac]['entries'];}return console[_0x23b5ea(0x51f)](_0x23b5ea(0xc36)),null;}async function _0x347242(_0x285d29,_0x47de8c=null){const _0x203ba3=_0x247bea,_0x46738e=_0x285d29[_0x203ba3(0xa78)]||_0x285d29;if(!_0x46738e['name'])throw new Error('角色卡数据无效或缺少\x27name\x27字段。');let _0xbaa9e9=null;const _0x2ab2fc=_0x472de5(_0x285d29);if(_0x2ab2fc){const _0x741b6d=_0x2ab2fc[_0x203ba3(0x1054)](_0x28fa28=>_0x28fa28[_0x203ba3(0x95a)]&&_0x28fa28[_0x203ba3(0xcbd)])[_0x203ba3(0x9d5)](_0xb263b5=>({'keys':_0xb263b5[_0x203ba3(0x1c6)]||[],'comment':_0xb263b5[_0x203ba3(0x8db)]||'','content':_0xb263b5[_0x203ba3(0xcbd)][_0x203ba3(0xc12)](/<memory>|<\/memory>/g,'')[_0x203ba3(0x7da)]()}));if(_0x741b6d['length']>0x0){const _0x189c54={'id':'wb_'+Date['now'](),'name':_0x46738e[_0x203ba3(0x578)]+_0x203ba3(0x7b1),'content':_0x741b6d,'categoryId':null};await _0x2a2987['worldBooks'][_0x203ba3(0xb9)](_0x189c54),_0x12493e[_0x203ba3(0x63a)][_0x203ba3(0x2d6)](_0x189c54),_0xbaa9e9=_0x189c54['id'];}}let _0x34ef97=_0x46738e[_0x203ba3(0x11ac)]||_0x285d29[_0x203ba3(0x11ac)]||'无';_0x34ef97=_0x34ef97[_0x203ba3(0xc12)](/```yaml/g,'')[_0x203ba3(0xc12)](/```/g,'')[_0x203ba3(0xc12)](/<\/?info>/g,'')['replace'](/<\/?character>/g,'')[_0x203ba3(0xc12)](/<\/?writing_rule>/g,'')[_0x203ba3(0xc12)](/\[OOC：.*?\]/g,'')[_0x203ba3(0x7da)]();let _0x9e27ff=_0x203ba3(0x987)+_0x34ef97+'\x0a\x0a';if(_0x46738e[_0x203ba3(0xb44)])_0x9e27ff+=_0x203ba3(0xc38)+_0x46738e[_0x203ba3(0xb44)]+'\x0a\x0a';if(_0x46738e[_0x203ba3(0x381)])_0x9e27ff+=_0x203ba3(0xdc4)+_0x46738e[_0x203ba3(0x381)]+'\x0a\x0a';if(_0x46738e[_0x203ba3(0x1096)])_0x9e27ff+='#\x20对话示例\x0a'+_0x46738e[_0x203ba3(0x1096)]+'\x0a\x0a';const _0xedac51=_0x46738e['name'],_0x4936cb=_0x46738e[_0x203ba3(0x578)],_0x537c33=_0x203ba3(0x657)+Date[_0x203ba3(0x6ee)](),_0x54f6b7={'id':_0x537c33,'name':_0xedac51[_0x203ba3(0x7da)](),'originalName':_0x4936cb[_0x203ba3(0x7da)](),'isGroup':![],'relationship':{'status':_0x203ba3(0xe59)},'status':{'text':'在线','lastUpdate':Date[_0x203ba3(0x6ee)](),'isBusy':![]},'settings':{'aiPersona':_0x9e27ff,'myPersona':'我是谁呀。','maxMemory':0xa,'aiAvatar':_0x190acc,'myAvatar':_0x190acc,'background':'','theme':_0x203ba3(0xfae),'fontSize':0xd,'customCss':'','linkedWorldBookIds':_0xbaa9e9?[_0xbaa9e9]:[],'aiAvatarLibrary':[]},'history':[],'musicData':{'totalTime':0x0},'longTermMemory':[]};_0x47de8c&&(_0x54f6b7['settings'][_0x203ba3(0x18e)]=_0x47de8c,_0x54f6b7['settings'][_0x203ba3(0xfc5)][_0x203ba3(0x2d6)]({'name':_0x203ba3(0x62a),'url':_0x47de8c}));const _0x14418d=_0x46738e[_0x203ba3(0xe06)]||_0x285d29[_0x203ba3(0xe06)];if(_0x14418d&&typeof _0x14418d===_0x203ba3(0x9de)){const _0x5e1847=document[_0x203ba3(0x1292)](_0x203ba3(0x58c));_0x5e1847[_0x203ba3(0x102a)]=_0x14418d;const _0x2323a0=(_0x5e1847[_0x203ba3(0x11b0)]||_0x5e1847[_0x203ba3(0x60e)]||'')['replace'](/原作者UR.*?开局/s,'')['trim']();_0x2323a0&&_0x54f6b7[_0x203ba3(0x1294)][_0x203ba3(0x2d6)]({'role':'assistant','senderName':_0x54f6b7[_0x203ba3(0x776)],'content':_0x2323a0,'timestamp':Date[_0x203ba3(0x6ee)]()});}_0x12493e[_0x203ba3(0xc45)][_0x537c33]=_0x54f6b7,await _0x2a2987[_0x203ba3(0xc45)][_0x203ba3(0xf36)](_0x54f6b7),_0x597ed7();let _0x1434e0=_0x203ba3(0x121c)+_0x54f6b7['name']+'”\x20已成功导入！';_0xbaa9e9&&(_0x1434e0+='\x0a\x0a其专属的“世界书”也已自动创建并关联。'),await _0x2d7ddd('导入成功！',_0x1434e0);}async function _0x4f52ba(){const _0x36c5d3=_0x247bea;if(!_0x12493e['activeChatId'])return;const _0x317583=_0x12493e[_0x36c5d3(0xc45)][_0x12493e[_0x36c5d3(0x7bc)]],_0x291576=_0x317583[_0x36c5d3(0x2ea)]['alternateGreetings'];if(!_0x291576||_0x291576['length']===0x0){alert(_0x36c5d3(0x8a3));return;}const _0x428f91=_0x291576[_0x36c5d3(0x9d5)]((_0x4ac0f0,_0x44464d)=>{const _0x3fa400=_0x36c5d3,_0xe90ea9=_0x4ac0f0[_0x3fa400(0xc12)](/<[^>]*>/g,'')[_0x3fa400(0x7da)]()['substring'](0x0,0x14);return{'text':_0x3fa400(0x98c)+(_0x44464d+0x1)+':\x20'+_0xe90ea9+_0x3fa400(0xda0),'value':_0x44464d};}),_0x2f0297=await _0x46f58a(_0x36c5d3(0x3d5),_0x428f91);if(_0x2f0297!==null){const _0x4ccf13=await _0x270512(_0x36c5d3(0x583),_0x36c5d3(0xbeb),{'confirmButtonClass':_0x36c5d3(0xa2),'confirmText':_0x36c5d3(0xe2e)});if(_0x4ccf13){const _0x1510a2=_0x291576[_0x2f0297],_0x4ce2a4={'role':_0x36c5d3(0x376),'senderName':_0x317583[_0x36c5d3(0x776)],'content':_0x1510a2,'timestamp':Date[_0x36c5d3(0x6ee)]()};_0x317583[_0x36c5d3(0x1294)]=[_0x4ce2a4],await _0x2a2987[_0x36c5d3(0xc45)]['put'](_0x317583),_0x1bbfd3(_0x317583['id']),document[_0x36c5d3(0xc33)](_0x36c5d3(0x293))[_0x36c5d3(0x10d3)]['remove'](_0x36c5d3(0x143)),await _0x2d7ddd('成功','已切换到新的开场故事！');}}}function _0x535ca1(_0x48e1c8={'keys':[],'comment':'','content':'','enabled':!![]}){const _0x4c4153=_0x247bea,_0x53b58f=document[_0x4c4153(0x1292)]('div');_0x53b58f[_0x4c4153(0x84)]=_0x4c4153(0x9ef);const _0x40bc66=_0x48e1c8[_0x4c4153(0x95a)]!==![]?_0x4c4153(0x737):'';return _0x53b58f[_0x4c4153(0x102a)]=_0x4c4153(0x6b0)+_0x40bc66+_0x4c4153(0xd78)+(_0x48e1c8['comment']||'')+_0x4c4153(0x11f3)+(_0x48e1c8['keys']||[])['join'](',\x20')+_0x4c4153(0x33e)+(_0x48e1c8[_0x4c4153(0xcbd)]||'')+'</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x53b58f[_0x4c4153(0x977)]('.delete-block-btn')[_0x4c4153(0x205)]('click',()=>{_0x53b58f['remove']();}),_0x53b58f;}async function _0x7d5db1(){const _0x5d0618=_0x247bea;if(!_0x12493e['activeChatId'])return;const _0x5a249f=_0x12493e[_0x5d0618(0x7bc)],_0x3ab350=document[_0x5d0618(0xc33)](_0x5d0618(0xb5c));if(!_0x3ab350[_0x5d0618(0x10d3)][_0x5d0618(0x3af)]('visible')){const _0x5e2b6c=document[_0x5d0618(0x977)](_0x5d0618(0xb6));_0x3ab350[_0x5d0618(0x105d)][_0x5d0618(0xcbe)]=_0x5e2b6c[_0x5d0618(0x1a0)]+'px',_0x3ab350[_0x5d0618(0x105d)]['display']=_0x5d0618(0xa20),(!_0xafc893[_0x5a249f]||!_0xafc893[_0x5a249f][_0x5d0618(0x1f3)])&&_0x4820fb(_0x5a249f),_0x87349(_0x5a249f),setTimeout(async()=>{const _0x3eddda=_0x5d0618;_0x3ab350[_0x3eddda(0x10d3)][_0x3eddda(0xb9)](_0x3eddda(0x143));const _0x149c59={'role':'system','content':_0x3eddda(0x906),'timestamp':Date['now'](),'isHidden':!![]};_0x12493e['chats'][_0x5a249f][_0x3eddda(0x1294)][_0x3eddda(0x2d6)](_0x149c59),await _0x2a2987[_0x3eddda(0xc45)][_0x3eddda(0xf36)](_0x12493e['chats'][_0x5a249f]);},0xa);}else await _0x1fe64c();}async function _0x1fe64c(){const _0x250f5d=_0x247bea;if(!_0x12493e[_0x250f5d(0x7bc)])return;const _0x5bbd6b=_0x12493e[_0x250f5d(0x7bc)],_0x1bdd24=document[_0x250f5d(0xc33)]('gomoku-overlay');_0x1bdd24[_0x250f5d(0x10d3)]['remove'](_0x250f5d(0x143)),setTimeout(()=>{const _0x433aee=_0x250f5d;_0x1bdd24[_0x433aee(0x105d)]['display']=_0x433aee(0x854);},0x12c);if(_0xafc893[_0x5bbd6b]){_0xafc893[_0x5bbd6b]['isActive']=![];const _0x4ccce8={'role':_0x250f5d(0x152),'content':_0x250f5d(0xc5),'timestamp':Date['now'](),'isHidden':!![]};_0x12493e[_0x250f5d(0xc45)][_0x5bbd6b][_0x250f5d(0x1294)][_0x250f5d(0x2d6)](_0x4ccce8),await _0x2a2987[_0x250f5d(0xc45)]['put'](_0x12493e[_0x250f5d(0xc45)][_0x5bbd6b]);}}function _0x4820fb(_0x517d04){const _0x72126f=_0x247bea,_0x3ae349=document[_0x72126f(0xc33)]('gomoku-board'),_0x17d3a3=document[_0x72126f(0xc33)](_0x72126f(0xb5c)),_0x5496a9=document['getElementById']('gomoku-controls'),_0x4e471b=_0x17d3a3[_0x72126f(0xeba)]-0x28,_0x3aa886=_0x17d3a3[_0x72126f(0x1a0)]-_0x5496a9[_0x72126f(0x1a0)]-0x28,_0x4810ed=Math[_0x72126f(0xcb5)](Math[_0x72126f(0x755)](_0x4e471b,_0x3aa886)),_0xc1f352=0xf,_0x20ba58=Math['floor'](_0x4810ed/_0xc1f352),_0x62624=_0x20ba58*_0xc1f352;_0x3ae349[_0x72126f(0x5f8)]=_0x62624,_0x3ae349['height']=_0x62624,_0xafc893[_0x517d04]={'isActive':!![],'board':Array(_0xc1f352)[_0x72126f(0x1101)](0x0)[_0x72126f(0x9d5)](()=>Array(_0xc1f352)[_0x72126f(0x1101)](0x0)),'currentPlayer':0x1,'history':[],'isGameOver':![],'GRID_SIZE':_0xc1f352,'CELL_SIZE':_0x20ba58};}function _0x87349(_0x104359){const _0xf8cc0b=_0x247bea,_0x16c523=_0xafc893[_0x104359];if(!_0x16c523)return;const _0x24b0ef=document[_0xf8cc0b(0xc33)]('gomoku-board'),_0xdf4acf=_0x24b0ef[_0xf8cc0b(0x3b9)]('2d'),{GRID_SIZE:_0x4e642e,CELL_SIZE:_0x4a5c0f}=_0x16c523,_0x3bd697=_0x4a5c0f/0x2;_0xdf4acf[_0xf8cc0b(0x2d7)](0x0,0x0,_0x24b0ef[_0xf8cc0b(0x5f8)],_0x24b0ef[_0xf8cc0b(0x27d)]),_0xdf4acf[_0xf8cc0b(0xa6)]=_0xf8cc0b(0x1004),_0xdf4acf[_0xf8cc0b(0xaf4)](0x0,0x0,_0x24b0ef[_0xf8cc0b(0x5f8)],_0x24b0ef[_0xf8cc0b(0x27d)]),_0xdf4acf['strokeStyle']='#5b3a29',_0xdf4acf[_0xf8cc0b(0x1274)]=0x1;for(let _0x3c98b3=0x0;_0x3c98b3<_0x4e642e;_0x3c98b3++){_0xdf4acf[_0xf8cc0b(0x125e)](),_0xdf4acf['moveTo'](_0x3bd697,_0x3bd697+_0x3c98b3*_0x4a5c0f),_0xdf4acf[_0xf8cc0b(0x2e5)](_0x24b0ef['width']-_0x3bd697,_0x3bd697+_0x3c98b3*_0x4a5c0f),_0xdf4acf[_0xf8cc0b(0xcec)](),_0xdf4acf['beginPath'](),_0xdf4acf[_0xf8cc0b(0xbdb)](_0x3bd697+_0x3c98b3*_0x4a5c0f,_0x3bd697),_0xdf4acf[_0xf8cc0b(0x2e5)](_0x3bd697+_0x3c98b3*_0x4a5c0f,_0x24b0ef['height']-_0x3bd697),_0xdf4acf[_0xf8cc0b(0xcec)]();}for(let _0x5674e0=0x0;_0x5674e0<_0x4e642e;_0x5674e0++){for(let _0x36c177=0x0;_0x36c177<_0x4e642e;_0x36c177++){_0x16c523[_0xf8cc0b(0x52d)][_0x5674e0][_0x36c177]!==0x0&&_0x2305bc(_0xdf4acf,_0x36c177,_0x5674e0,_0x16c523[_0xf8cc0b(0x52d)][_0x5674e0][_0x36c177],_0x16c523);}}}function _0x2305bc(_0x4fd3b5,_0x3325ac,_0x1666d5,_0x4d088e,_0x5c9803){const _0x382a64=_0x247bea,{CELL_SIZE:_0x2e6c4d}=_0x5c9803,_0x88aeb7=_0x2e6c4d/0x2,_0x4ffc72=_0x2e6c4d/0x2-0x2;_0x4fd3b5[_0x382a64(0x125e)](),_0x4fd3b5[_0x382a64(0xa67)](_0x88aeb7+_0x3325ac*_0x2e6c4d,_0x88aeb7+_0x1666d5*_0x2e6c4d,_0x4ffc72,0x0,0x2*Math['PI']),_0x4d088e===0x1?_0x4fd3b5[_0x382a64(0xa6)]=_0x382a64(0x420):_0x4fd3b5[_0x382a64(0xa6)]='white',_0x4fd3b5[_0x382a64(0x1101)]();}function _0x429d01(_0x33b2d8){const _0x1761ea=_0x247bea,_0xac94fc=_0x12493e['activeChatId'],_0xcd6b47=_0xafc893[_0xac94fc];if(!_0xcd6b47||_0xcd6b47[_0x1761ea(0x72e)]||_0xcd6b47[_0x1761ea(0xa48)]!==0x1)return;const _0x42ecd7=document[_0x1761ea(0xc33)](_0x1761ea(0x4ee)),_0x5d9047=_0x42ecd7[_0x1761ea(0x3b9)]('2d'),_0x42a890=_0x42ecd7[_0x1761ea(0x9f3)](),_0x36bfbc=_0x33b2d8[_0x1761ea(0x86f)]-_0x42a890[_0x1761ea(0x9e2)],_0x119790=_0x33b2d8[_0x1761ea(0xd20)]-_0x42a890[_0x1761ea(0xcbe)],_0x4da018=Math[_0x1761ea(0x113a)]((_0x36bfbc-_0xcd6b47['CELL_SIZE']/0x2)/_0xcd6b47[_0x1761ea(0x126b)]),_0x53f769=Math[_0x1761ea(0x113a)]((_0x119790-_0xcd6b47['CELL_SIZE']/0x2)/_0xcd6b47[_0x1761ea(0x126b)]);_0x87349(_0xac94fc);if(_0x4da018>=0x0&&_0x4da018<_0xcd6b47[_0x1761ea(0x2d0)]&&_0x53f769>=0x0&&_0x53f769<_0xcd6b47[_0x1761ea(0x2d0)]&&_0xcd6b47[_0x1761ea(0x52d)][_0x53f769][_0x4da018]===0x0){const _0xcc460a=_0xcd6b47[_0x1761ea(0x126b)]/0x2-0x2;_0x5d9047[_0x1761ea(0x125e)](),_0x5d9047[_0x1761ea(0xa67)](_0xcd6b47[_0x1761ea(0x126b)]/0x2+_0x4da018*_0xcd6b47[_0x1761ea(0x126b)],_0xcd6b47[_0x1761ea(0x126b)]/0x2+_0x53f769*_0xcd6b47[_0x1761ea(0x126b)],_0xcc460a,0x0,0x2*Math['PI']),_0x5d9047[_0x1761ea(0xa6)]='rgba(0,\x200,\x200,\x200.4)',_0x5d9047[_0x1761ea(0x1101)]();}}function _0x4c6f80(_0x241c1d){const _0x34540a=_0x247bea,_0x559093=_0x12493e['activeChatId'],_0x972b29=_0xafc893[_0x559093];if(!_0x972b29||_0x972b29[_0x34540a(0x72e)]||_0x972b29[_0x34540a(0xa48)]!==0x1)return;const _0x2e2a6e=document[_0x34540a(0xc33)](_0x34540a(0x4ee)),_0x548109=_0x2e2a6e['getBoundingClientRect'](),_0x59137e=_0x241c1d[_0x34540a(0x86f)]-_0x548109[_0x34540a(0x9e2)],_0x5b94e3=_0x241c1d[_0x34540a(0xd20)]-_0x548109[_0x34540a(0xcbe)],_0x51c0e9=Math[_0x34540a(0x113a)]((_0x59137e-_0x972b29[_0x34540a(0x126b)]/0x2)/_0x972b29[_0x34540a(0x126b)]),_0x195cef=Math[_0x34540a(0x113a)]((_0x5b94e3-_0x972b29[_0x34540a(0x126b)]/0x2)/_0x972b29[_0x34540a(0x126b)]);_0x51c0e9>=0x0&&_0x51c0e9<_0x972b29['GRID_SIZE']&&_0x195cef>=0x0&&_0x195cef<_0x972b29[_0x34540a(0x2d0)]&&_0x972b29[_0x34540a(0x52d)][_0x195cef][_0x51c0e9]===0x0&&(_0x972b29[_0x34540a(0x52d)][_0x195cef][_0x51c0e9]=0x1,_0x972b29[_0x34540a(0x1294)][_0x34540a(0x2d6)]({'x':_0x51c0e9,'y':_0x195cef,'player':0x1}),_0x87349(_0x559093),_0x3c63e2(_0x51c0e9,_0x195cef,0x1,_0x972b29)?(_0x972b29['isGameOver']=!![],setTimeout(()=>alert(_0x34540a(0x4ad)),0x64),_0x2fe519(_0x34540a(0x717))):_0x972b29[_0x34540a(0xa48)]=0x2);}function _0x4cd171(_0x2e77ee,_0x4d8572=![]){const _0x32eba3=_0x247bea,_0x179b78=_0x12493e[_0x32eba3(0x7bc)],_0x4b6708=_0xafc893[_0x179b78];if(!_0x4b6708||_0x4b6708[_0x32eba3(0x72e)])return;if(!_0x4d8572&&_0x4b6708['currentPlayer']!==0x2)return;const {x:_0x59e9f3,y:_0x27d98e}=_0x2e77ee;_0x59e9f3>=0x0&&_0x59e9f3<_0x4b6708[_0x32eba3(0x2d0)]&&_0x27d98e>=0x0&&_0x27d98e<_0x4b6708[_0x32eba3(0x2d0)]&&_0x4b6708[_0x32eba3(0x52d)][_0x27d98e][_0x59e9f3]===0x0?(_0x4b6708[_0x32eba3(0x52d)][_0x27d98e][_0x59e9f3]=0x2,_0x4b6708[_0x32eba3(0x1294)][_0x32eba3(0x2d6)]({'x':_0x59e9f3,'y':_0x27d98e,'player':0x2}),_0x87349(_0x179b78),_0x3c63e2(_0x59e9f3,_0x27d98e,0x2,_0x4b6708)?(_0x4b6708[_0x32eba3(0x72e)]=!![],setTimeout(()=>alert('AI\x20获胜了！'),0x64),_0x2fe519('ai')):_0x4b6708[_0x32eba3(0xa48)]=0x1):(console[_0x32eba3(0x54a)](_0x32eba3(0x762),_0x2e77ee),_0x4b6708[_0x32eba3(0xa48)]=0x1);}function _0x3c63e2(_0x79b334,_0x2b67d5,_0xe72a27,_0x3013e7){const {board:_0x528731,GRID_SIZE:_0x590763}=_0x3013e7,_0x175e97=[[0x1,0x0],[0x0,0x1],[0x1,0x1],[0x1,-0x1]];for(const [_0x37c7d7,_0x274ea0]of _0x175e97){let _0x4c3aea=0x1;for(let _0x3d34cf=0x1;_0x3d34cf<0x5;_0x3d34cf++){const _0x22abe8=_0x79b334+_0x3d34cf*_0x37c7d7,_0x35cb71=_0x2b67d5+_0x3d34cf*_0x274ea0;if(_0x22abe8>=0x0&&_0x22abe8<_0x590763&&_0x35cb71>=0x0&&_0x35cb71<_0x590763&&_0x528731[_0x35cb71][_0x22abe8]===_0xe72a27)_0x4c3aea++;else break;}for(let _0x197d63=0x1;_0x197d63<0x5;_0x197d63++){const _0x53a09e=_0x79b334-_0x197d63*_0x37c7d7,_0xfe1542=_0x2b67d5-_0x197d63*_0x274ea0;if(_0x53a09e>=0x0&&_0x53a09e<_0x590763&&_0xfe1542>=0x0&&_0xfe1542<_0x590763&&_0x528731[_0xfe1542][_0x53a09e]===_0xe72a27)_0x4c3aea++;else break;}if(_0x4c3aea>=0x5)return!![];}return![];}function _0x3dbdee(_0x404ee8){const _0x4dc48f=_0x247bea;if(!_0x404ee8||!_0x404ee8['isActive'])return'';let _0x17b949=_0x4dc48f(0xcf9);_0x17b949+=_0x404ee8[_0x4dc48f(0x52d)][_0x4dc48f(0x9d5)](_0xef0355=>_0xef0355[_0x4dc48f(0x100b)]('\x20'))[_0x4dc48f(0x100b)]('\x0a');let _0x23bd4b=_0x4dc48f(0xfd);return _0x23bd4b+=_0x404ee8[_0x4dc48f(0x1294)][_0x4dc48f(0x9d5)](_0x389895=>'玩家'+_0x389895[_0x4dc48f(0xc86)]+_0x4dc48f(0xf7f)+_0x389895['x']+','+_0x389895['y']+')')[_0x4dc48f(0x100b)](_0x4dc48f(0xe61)),_0x4dc48f(0xa3f)+_0x17b949+_0x4dc48f(0x546)+_0x23bd4b+'\x0a\x0a#\x20【【【五子棋核心规则与强制思考步骤\x20(最高优先级指令！)】】】\x0a\x0a###\x20**【【【落子铁律\x20(绝对禁止！)】】】**\x0a你【绝对不能】选择一个棋盘上已经是\x201\x20或\x202\x20的坐标。你的落子点【必须】是\x200。\x0a---\x0a\x0a###\x20**第一步：逻辑分析\x20(内部思考，不要输出)**\x0a\x0a1.\x20\x20**【规则定义】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20棋子:\x201代表用户(黑棋)，2代表你(白棋)。\x0a\x20\x20\x20\x20-\x20\x20\x20获胜条件:\x20横、竖、斜线上有【连续五个】自己的棋子。\x0a\x0a2.\x20\x20**【防守分析\x20(必须执行)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20**检查用户(1)是否有“四子连线”的威胁？**\x20如果有，我必须下在哪个坐标才能堵住？\x0a\x20\x20\x20\x20-\x20\x20\x20**检查用户(1)是否有“活三”的威胁？**\x20如果有，最佳的防守点是哪里？\x0a\x0a3.\x20\x20**【进攻分析\x20(必须执行)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20**检查我(2)是否有“一步胜利”的机会？**\x20(即已有四子连线)\x20如果有，我应该下在哪里？\x0a\x20\x20\x20\x20-\x20\x20\x20**检查我(2)是否有制造“活四”或“双三”的机会？**\x20如果有，最佳的进攻点是哪里？\x0a\x0a###\x20**第二步：决策与扮演\x20(内部思考，不要输出)**\x0a\x0a1.\x20\x20**【决策】**:\x20综合以上攻防分析，我的最佳棋步是落在坐标\x20(x,\x20y)。\x0a\x0a2.\x20\x20**【融入角色扮演】**:\x0a\x20\x20\x20\x20-\x20\x20\x20我的性格是：(在此处回顾你的人设)。\x0a\x20\x20\x20\x20-\x20\x20\x20根据我的性格，我应该：\x0a\x20\x20\x20\x20\x20\x20\x20\x20a)\x20**(聪明/好胜型)**\x20下在刚刚分析出的最佳位置。\x0a\x20\x20\x20\x20\x20\x20\x20\x20b)\x20**(迷糊/放水型)**\x20故意选择一个次优的位置，但【前提是不能让用户立刻获胜】。\x0a\x20\x20\x20\x20\x20\x20\x20\x20c)\x20**(其他性格)**\x20根据性格特点，选择一个合理的棋步。\x0a\x0a3.\x20\x20**【构思台词】**:\x20根据我选择的棋步和我的性格，我应该说一句什么样的台词来评论棋局？\x0a\x0a---\x0a###\x20**第三步：生成最终回复\x20(你的唯一输出)**\x0a\x0a现在，根据你第二步的最终决策，生成你的行动。\x0a-\x20\x20\x20你的回复【必须且只能】是一个JSON数组。\x0a-\x20\x20\x20**绝对不要**在最终回复中包含任何上述的思考过程。\x0a-\x20\x20\x20格式:\x20`[{\x22type\x22:\x20\x22gomoku_move\x22,\x20\x22name\x22:\x20\x22你的角色本名\x22,\x20\x22x\x22:\x20(0-14),\x20\x22y\x22:\x20(0-14)},\x20{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你的台词...\x22}]`\x0a';}async function _0x2fe519(_0x256883){const _0xc699ce=_0x247bea,_0x6ab5f2=_0x12493e[_0xc699ce(0x7bc)],_0x5c7a8e=_0x12493e[_0xc699ce(0xc45)][_0x6ab5f2];if(!_0x5c7a8e)return;const _0x2ec8c0=_0x5c7a8e['isGroup']?_0x5c7a8e[_0xc699ce(0x2ea)]['myNickname']||'我':'我',_0x1af971=_0x5c7a8e[_0xc699ce(0x80b)]?_0xc699ce(0xac7):_0x5c7a8e[_0xc699ce(0x578)],_0x16f6cb=_0x256883===_0xc699ce(0x717)?_0x2ec8c0:_0x1af971,_0x4d51e9=_0x256883===_0xc699ce(0x717)?'你输了':_0xc699ce(0xe97),_0x10cbb3=_0xc699ce(0x11fe)+_0x16f6cb+_0xc699ce(0x771)+_0x4d51e9+'。]',_0x2e5f08={'role':_0xc699ce(0x152),'content':_0x10cbb3,'timestamp':Date[_0xc699ce(0x6ee)](),'isHidden':!![]};_0x5c7a8e['history']['push'](_0x2e5f08),await _0x2a2987['chats'][_0xc699ce(0xf36)](_0x5c7a8e),console[_0xc699ce(0x51f)]('游戏结束的系统提示已添加到历史记录中，等待AI下次查看。胜者:\x20'+_0x256883);}let _0x38ddb1=![];async function _0x34cd96(){const _0x52432f=_0x247bea,_0x66d135=document[_0x52432f(0xc33)](_0x52432f(0x715)),_0x52a6ca=document[_0x52432f(0xc33)]('product-category-tabs'),_0x5e4ea0=document[_0x52432f(0xc33)]('shopping-screen');_0x66d135[_0x52432f(0x102a)]='',_0x52a6ca[_0x52432f(0x102a)]='';const [_0x1e047f,_0x52418f]=await Promise[_0x52432f(0x5c8)]([_0x2a2987['shoppingProducts'][_0x52432f(0xf15)](),_0x2a2987['shoppingCategories'][_0x52432f(0xde3)](_0x52432f(0x578))[_0x52432f(0xf15)]()]);_0x5e4ea0[_0x52432f(0x10d3)][_0x52432f(0xe2c)](_0x52432f(0x491),_0x38ddb1);const _0x2d9073=document[_0x52432f(0x1292)](_0x52432f(0xeb1));_0x2d9073[_0x52432f(0x84)]=_0x52432f(0x73e),_0x2d9073['textContent']='全部',_0x2d9073[_0x52432f(0x85)]['categoryId']=_0x52432f(0x5c8);if(activeShoppingCategoryId===_0x52432f(0x5c8))_0x2d9073[_0x52432f(0x10d3)][_0x52432f(0xb9)](_0x52432f(0x1043));_0x52a6ca[_0x52432f(0xf77)](_0x2d9073),_0x52418f['forEach'](_0x2e3872=>{const _0x17529b=_0x52432f,_0x5da67b=document[_0x17529b(0x1292)](_0x17529b(0xeb1));_0x5da67b[_0x17529b(0x84)]='product-category-tab',_0x5da67b[_0x17529b(0x11b0)]=_0x2e3872[_0x17529b(0x578)],_0x5da67b[_0x17529b(0x85)][_0x17529b(0x305)]=_0x2e3872['id'];if(activeShoppingCategoryId===_0x2e3872['id'])_0x5da67b[_0x17529b(0x10d3)][_0x17529b(0xb9)](_0x17529b(0x1043));_0x52a6ca[_0x17529b(0xf77)](_0x5da67b);});let _0x4b25b5;activeShoppingCategoryId===_0x52432f(0x5c8)?_0x4b25b5=_0x1e047f:_0x4b25b5=_0x1e047f[_0x52432f(0x1054)](_0x4c1ae7=>_0x4c1ae7['categoryId']===activeShoppingCategoryId);if(_0x4b25b5[_0x52432f(0x79b)]===0x0){const _0x1405a4=activeShoppingCategoryId==='all'?'商店空空如也，点击“管理”添加商品吧！':_0x52432f(0xab4);_0x66d135[_0x52432f(0x102a)]=_0x52432f(0xa25)+_0x1405a4+_0x52432f(0xcc9);return;}_0x4b25b5[_0x52432f(0xd6a)](_0x9516e=>{const _0x186252=_0x52432f,_0x1a58b5=document[_0x186252(0x1292)](_0x186252(0x58c));_0x1a58b5[_0x186252(0x84)]=_0x186252(0x9cd),_0x1a58b5[_0x186252(0x85)]['id']=_0x9516e['id'];const _0x3accec=_0x186252(0xe21);_0x1a58b5[_0x186252(0x102a)]=_0x186252(0x7dc)+_0x3accec+_0x186252(0x173)+_0x9516e[_0x186252(0x891)]+_0x186252(0x9ad)+_0x9516e[_0x186252(0x578)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-price\x22>'+_0x9516e['price'][_0x186252(0xcab)](0x2)+_0x186252(0x4d0),_0x66d135['appendChild'](_0x1a58b5);});}function _0x190bb7(_0x5dcdf6){activeShoppingCategoryId=_0x5dcdf6,_0x34cd96(),_0x4f9fa7();}function _0x4f9fa7(){const _0x3bd235=_0x247bea,_0x23fef2=document[_0x3bd235(0xc33)](_0x3bd235(0x976));if(!_0x23fef2)return;const _0x3cc94e=_0x38ddb1&&activeShoppingCategoryId!==_0x3bd235(0x5c8);_0x23fef2[_0x3bd235(0x105d)][_0x3bd235(0xf44)]=_0x3cc94e?_0x3bd235(0x21a):'none';}async function _0x3e2e48(){const _0x1a42c1=_0x247bea;if(activeShoppingCategoryId===_0x1a42c1(0x5c8))return;const _0x338488=activeShoppingCategoryId,_0x12991c=await _0x2a2987['shoppingCategories'][_0x1a42c1(0xec0)](_0x338488);if(!_0x12991c){alert('错误：找不到要删除的分类。');return;}const _0x20554e=_0x1a42c1(0xcd2)+_0x12991c[_0x1a42c1(0x578)]+_0x1a42c1(0x53d),_0x148184=await _0x270512(_0x1a42c1(0x124e),_0x20554e,{'confirmButtonClass':_0x1a42c1(0xa2),'confirmText':_0x1a42c1(0x8d6)});_0x148184&&(await _0x4c57bc(_0x338488),activeShoppingCategoryId='all',await _0x34cd96(),_0x4f9fa7(),await _0x2d7ddd('成功','分类\x20“'+_0x12991c['name']+_0x1a42c1(0xf5c)));}async function _0x1d035a(){const _0x565307=_0x247bea;activeShoppingCategoryId=_0x565307(0x5c8),await _0x34cd96(),_0x38f00f(_0x565307(0x1be)),_0x4f9fa7();}async function _0x34cd96(){const _0x5c8246=_0x247bea,_0x18ac11=document['getElementById']('product-grid'),_0x41c042=document[_0x5c8246(0xc33)](_0x5c8246(0x190)),_0x322462=document['getElementById'](_0x5c8246(0x1be));_0x18ac11['innerHTML']='',_0x41c042[_0x5c8246(0x102a)]='';const [_0x5ddcca,_0x2a3114]=await Promise['all']([_0x2a2987[_0x5c8246(0x6b4)]['toArray'](),_0x2a2987[_0x5c8246(0x1df)][_0x5c8246(0xde3)]('name')['toArray']()]);_0x322462['classList'][_0x5c8246(0xe2c)](_0x5c8246(0x491),_0x38ddb1);const _0x14c6f9=document[_0x5c8246(0x1292)]('button');_0x14c6f9['className']=_0x5c8246(0x73e),_0x14c6f9[_0x5c8246(0x11b0)]='全部',_0x14c6f9['dataset'][_0x5c8246(0x305)]=_0x5c8246(0x5c8);if(activeShoppingCategoryId===_0x5c8246(0x5c8))_0x14c6f9['classList'][_0x5c8246(0xb9)](_0x5c8246(0x1043));_0x41c042[_0x5c8246(0xf77)](_0x14c6f9),_0x2a3114[_0x5c8246(0xd6a)](_0x39f52d=>{const _0x2244d0=_0x5c8246,_0x588def=document[_0x2244d0(0x1292)](_0x2244d0(0xeb1));_0x588def[_0x2244d0(0x84)]=_0x2244d0(0x73e),_0x588def[_0x2244d0(0x11b0)]=_0x39f52d['name'],_0x588def[_0x2244d0(0x85)][_0x2244d0(0x305)]=_0x39f52d['id'];if(activeShoppingCategoryId===_0x39f52d['id'])_0x588def[_0x2244d0(0x10d3)][_0x2244d0(0xb9)](_0x2244d0(0x1043));_0x41c042[_0x2244d0(0xf77)](_0x588def);});let _0x1edf57;activeShoppingCategoryId==='all'?_0x1edf57=_0x5ddcca:_0x1edf57=_0x5ddcca[_0x5c8246(0x1054)](_0x56a4bb=>_0x56a4bb['categoryId']===activeShoppingCategoryId);if(_0x1edf57[_0x5c8246(0x79b)]===0x0){const _0x5c1f22=activeShoppingCategoryId===_0x5c8246(0x5c8)?'商店空空如也，点击“管理”添加商品吧！':'这个分类下还没有商品哦~';_0x18ac11[_0x5c8246(0x102a)]=_0x5c8246(0xa25)+_0x5c1f22+'</p>';return;}_0x1edf57[_0x5c8246(0xd6a)](_0xd8e6d2=>{const _0x36954f=_0x5c8246,_0x2e1ee3=document['createElement'](_0x36954f(0x58c));_0x2e1ee3[_0x36954f(0x84)]=_0x36954f(0x9cd),_0x2e1ee3[_0x36954f(0x85)]['id']=_0xd8e6d2['id'];const _0x169519=_0x38ddb1?_0x36954f(0x5ab):'';_0x2e1ee3[_0x36954f(0x102a)]=_0x36954f(0x10e5)+_0x169519+_0x36954f(0xce7)+_0xd8e6d2[_0x36954f(0x891)]+_0x36954f(0x113f)+_0xd8e6d2['name']+_0x36954f(0x756)+_0xd8e6d2[_0x36954f(0xae2)][_0x36954f(0xcab)](0x2)+_0x36954f(0x5e5),_0x18ac11[_0x36954f(0xf77)](_0x2e1ee3);});}async function _0x50393c(_0x32a79c,_0x452b81=0x1,_0xb457aa=null){const _0x2fa8d4=_0x247bea,_0x2675aa=_0xb457aa?_0x2b0414[_0x2fa8d4(0xd85)](_0x12b126=>_0x12b126['productId']===_0x32a79c&&_0x12b126[_0x2fa8d4(0xdff)]?.['name']===_0xb457aa[_0x2fa8d4(0x578)]):_0x2b0414[_0x2fa8d4(0xd85)](_0x467555=>_0x467555[_0x2fa8d4(0x10ea)]===_0x32a79c&&!_0x467555[_0x2fa8d4(0xdff)]);if(_0x2675aa)_0x2675aa[_0x2fa8d4(0x162)]+=_0x452b81;else{const _0x9f6ce0=await _0x2a2987[_0x2fa8d4(0x6b4)][_0x2fa8d4(0xec0)](_0x32a79c);_0x9f6ce0&&_0x2b0414[_0x2fa8d4(0x2d6)]({'productId':_0x9f6ce0['id'],'quantity':_0x452b81,'variation':_0xb457aa});}_0x42d20e();}function _0x25bf67(_0x11334c,_0x572b25){const _0x5a9c62=_0x247bea,_0x141b4a=_0x2b0414['findIndex'](_0x444c2c=>_0x444c2c[_0x5a9c62(0x10ea)]===_0x11334c);_0x141b4a>-0x1&&(_0x2b0414[_0x141b4a][_0x5a9c62(0x162)]+=_0x572b25,_0x2b0414[_0x141b4a][_0x5a9c62(0x162)]<=0x0&&_0x2b0414[_0x5a9c62(0xbd1)](_0x141b4a,0x1),_0x42d20e(),_0x518f76());}function _0x42d20e(){const _0x5b3755=_0x247bea,_0xbcb94a=_0x2b0414[_0x5b3755(0xdf9)]((_0x8d0077,_0x4a9e2d)=>_0x8d0077+_0x4a9e2d[_0x5b3755(0x162)],0x0);document[_0x5b3755(0xc33)]('cart-count')[_0x5b3755(0x11b0)]=_0xbcb94a,document['getElementById']('cart-title')['textContent']=_0x5b3755(0x2d3)+_0xbcb94a+')',document[_0x5b3755(0xc33)](_0x5b3755(0x375))['textContent']=_0x5b3755(0x89b)+_0xbcb94a+')';}function _0x1bc9e3(){_0x518f76(),_0x38f00f('cart-screen');}async function _0x518f76(){const _0x48c8f4=_0x247bea,_0x25992a=document[_0x48c8f4(0xc33)]('cart-items-list');_0x25992a[_0x48c8f4(0x102a)]='';let _0x1416a1=0x0;if(_0x2b0414[_0x48c8f4(0x79b)]===0x0)_0x25992a[_0x48c8f4(0x102a)]=_0x48c8f4(0x1121);else{const _0x1c3132=_0x2b0414[_0x48c8f4(0x9d5)](_0x411858=>_0x411858['productId']),_0x9aece4=await _0x2a2987[_0x48c8f4(0x6b4)][_0x48c8f4(0x8b5)]('id')['anyOf'](_0x1c3132)['toArray'](),_0x1ba5fd=new Map(_0x9aece4[_0x48c8f4(0x9d5)](_0x242235=>[_0x242235['id'],_0x242235]));_0x2b0414['forEach'](_0x11ea96=>{const _0x431a24=_0x48c8f4,_0x522bd2=_0x1ba5fd[_0x431a24(0xec0)](_0x11ea96[_0x431a24(0x10ea)]);if(_0x522bd2){const _0x19b483=document[_0x431a24(0x1292)]('div');_0x19b483[_0x431a24(0x84)]=_0x431a24(0xbc7);const _0x39de22=_0x11ea96[_0x431a24(0xdff)]?_0x431a24(0x120)+_0x11ea96[_0x431a24(0xdff)][_0x431a24(0x578)]+'</div>':'';_0x19b483['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22cart-item-checkbox\x22\x20data-id=\x22'+_0x522bd2['id']+_0x431a24(0x1215)+(_0x11ea96[_0x431a24(0xdff)]?.[_0x431a24(0x891)]||_0x522bd2[_0x431a24(0x891)])+_0x431a24(0x610)+_0x522bd2[_0x431a24(0x578)]+_0x431a24(0xf21)+_0x39de22+_0x431a24(0x29f)+(_0x11ea96[_0x431a24(0xdff)]?.[_0x431a24(0xae2)]||_0x522bd2[_0x431a24(0xae2)])[_0x431a24(0xcab)](0x2)+_0x431a24(0x391)+_0x522bd2['id']+_0x431a24(0x69b)+_0x11ea96[_0x431a24(0x162)]+_0x431a24(0xa6d)+_0x522bd2['id']+'\x22>+</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x25992a[_0x431a24(0xf77)](_0x19b483);}});}_0x2cc1c0();}async function _0x2cc1c0(){const _0x5883fe=_0x247bea;let _0x27c04b=0x0;const _0x549956=document[_0x5883fe(0x67a)](_0x5883fe(0xd47)),_0x149ccb=Array[_0x5883fe(0x301)](_0x549956)[_0x5883fe(0x9d5)](_0x48397d=>parseInt(_0x48397d[_0x5883fe(0x85)]['id']));if(_0x149ccb[_0x5883fe(0x79b)]>0x0){const _0x5d9b2c=await _0x2a2987['shoppingProducts'][_0x5883fe(0x8b5)]('id')[_0x5883fe(0x6b8)](_0x149ccb)[_0x5883fe(0xf15)](),_0x46437e=new Map(_0x5d9b2c[_0x5883fe(0x9d5)](_0x5526ab=>[_0x5526ab['id'],_0x5526ab]));_0x2b0414[_0x5883fe(0xd6a)](_0x30edc8=>{const _0x4e8eb2=_0x5883fe;if(_0x149ccb[_0x4e8eb2(0x1d4)](_0x30edc8[_0x4e8eb2(0x10ea)])){const _0x277c82=_0x46437e['get'](_0x30edc8[_0x4e8eb2(0x10ea)]);if(_0x277c82){const _0x2da88e=_0x30edc8['variation']?_0x30edc8['variation'][_0x4e8eb2(0xae2)]:_0x277c82[_0x4e8eb2(0xae2)];_0x27c04b+=_0x2da88e*_0x30edc8[_0x4e8eb2(0x162)];}}});}document[_0x5883fe(0xc33)]('cart-total')[_0x5883fe(0x11b0)]='合计:\x20¥'+_0x27c04b[_0x5883fe(0xcab)](0x2);}async function _0x3e6505(){const _0x1f0ddb=_0x247bea,_0xa7b6e4=_0x12493e[_0x1f0ddb(0xc45)][_0x12493e['activeChatId']];if(!_0xa7b6e4||!_0xa7b6e4[_0x1f0ddb(0x80b)])return;const _0x54f885=document[_0x1f0ddb(0xc33)]('gift-recipient-modal'),_0x460ee4=document['getElementById']('gift-recipient-list');_0x460ee4['innerHTML']='';const _0x253f5b=_0xa7b6e4[_0x1f0ddb(0x2ea)][_0x1f0ddb(0xbf6)]||'我',_0x586f36=_0xa7b6e4[_0x1f0ddb(0xd5b)][_0x1f0ddb(0x1054)](_0x38e040=>_0x38e040[_0x1f0ddb(0x6e2)]!==_0x253f5b);_0x586f36[_0x1f0ddb(0xd6a)](_0xc6fa3a=>{const _0xc24a3e=_0x1f0ddb,_0x39e09c=document[_0xc24a3e(0x1292)](_0xc24a3e(0x58c));_0x39e09c[_0xc24a3e(0x84)]=_0xc24a3e(0x676),_0x39e09c[_0xc24a3e(0x85)][_0xc24a3e(0xd4c)]=_0xc6fa3a[_0xc24a3e(0x776)],_0x39e09c['innerHTML']=_0xc24a3e(0x611)+(_0xc6fa3a[_0xc24a3e(0xbac)]||_0x5b9dd3)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0xc6fa3a[_0xc24a3e(0x6e2)]+_0xc24a3e(0xdec),_0x460ee4['appendChild'](_0x39e09c);}),document[_0x1f0ddb(0xc33)](_0x1f0ddb(0xff1))['checked']=![],_0x54f885[_0x1f0ddb(0x10d3)]['add'](_0x1f0ddb(0x143));}async function _0x196e9f(){const _0x1fa78f=_0x247bea,_0x1e5a71=_0x12493e[_0x1fa78f(0xc45)][_0x12493e['activeChatId']],_0x142e09=_0x2b0414[_0x1fa78f(0x1054)](_0x3d44b2=>document[_0x1fa78f(0x977)](_0x1fa78f(0x1148)+_0x3d44b2[_0x1fa78f(0x10ea)]+_0x1fa78f(0x1e7)));if(_0x142e09[_0x1fa78f(0x79b)]===0x0){alert(_0x1fa78f(0xcac));return;}if(_0x1e5a71[_0x1fa78f(0x80b)])_0x3e6505();else{const _0x4ec6ed=await _0x270512(_0x1fa78f(0x467),_0x1fa78f(0x865),{'confirmText':_0x1fa78f(0x187)});_0x4ec6ed&&await _0x388297(_0x142e09);}}async function _0x388297(_0x4f5601,_0x27430b=null){const _0x46a819=_0x247bea;if(!_0x12493e[_0x46a819(0x7bc)])return;const _0x5895f8=_0x12493e[_0x46a819(0xc45)][_0x12493e[_0x46a819(0x7bc)]],_0x201cb6=_0x4f5601['map'](_0xb5d1df=>_0xb5d1df[_0x46a819(0x10ea)]),_0x20ab1f=await _0x2a2987[_0x46a819(0x6b4)]['where']('id')[_0x46a819(0x6b8)](_0x201cb6)[_0x46a819(0xf15)](),_0x594360=new Map(_0x20ab1f[_0x46a819(0x9d5)](_0x55a640=>[_0x55a640['id'],_0x55a640])),_0x48b61e=_0x4f5601[_0x46a819(0x9d5)](_0x31e04f=>{const _0x17da99=_0x46a819,_0x29225f=_0x594360[_0x17da99(0xec0)](_0x31e04f[_0x17da99(0x10ea)]);return _0x31e04f[_0x17da99(0xdff)]?{'name':_0x29225f[_0x17da99(0x578)]+_0x17da99(0x804)+_0x31e04f[_0x17da99(0xdff)][_0x17da99(0x578)],'price':_0x31e04f[_0x17da99(0xdff)][_0x17da99(0xae2)],'imageUrl':_0x31e04f[_0x17da99(0xdff)][_0x17da99(0x891)]||_0x29225f[_0x17da99(0x891)],'quantity':_0x31e04f[_0x17da99(0x162)]}:{'name':_0x29225f[_0x17da99(0x578)],'price':_0x29225f['price'],'imageUrl':_0x29225f[_0x17da99(0x891)],'quantity':_0x31e04f['quantity']};}),_0x26b9d1={'role':'user','type':_0x46a819(0x7ef),'timestamp':Date[_0x46a819(0x6ee)](),'items':_0x48b61e,'total':_0x48b61e[_0x46a819(0xdf9)]((_0x703b72,_0x1b41a5)=>_0x703b72+_0x1b41a5[_0x46a819(0xae2)]*_0x1b41a5[_0x46a819(0x162)],0x0),'recipients':_0x27430b};_0x5895f8[_0x46a819(0x1294)]['push'](_0x26b9d1);if(_0x27430b&&_0x27430b[_0x46a819(0x79b)]>0x0){const _0x77a63f=_0x27430b[_0x46a819(0x9d5)](_0x3b952a=>_0x3fb61d(_0x5895f8,_0x3b952a))['join']('、'),_0x18a0ba={'role':_0x46a819(0x152),'content':_0x46a819(0xadb)+(_0x5895f8['settings'][_0x46a819(0xbf6)]||'我')+')\x20送出了一份礼物，收礼人是：'+_0x77a63f+_0x46a819(0x290),'timestamp':Date[_0x46a819(0x6ee)]()+0x1,'isHidden':!![]};_0x5895f8[_0x46a819(0x1294)][_0x46a819(0x2d6)](_0x18a0ba);}await _0x2a2987[_0x46a819(0xc45)][_0x46a819(0xf36)](_0x5895f8),_0x468ef0(_0x26b9d1,_0x5895f8),_0x597ed7(),_0x2b0414=_0x2b0414[_0x46a819(0x1054)](_0x1fe964=>!_0x4f5601['some'](_0x3b056e=>_0x3b056e[_0x46a819(0x10ea)]===_0x1fe964['productId'])),_0x42d20e(),_0x38f00f('chat-interface-screen'),await _0x2d7ddd('成功',_0x46a819(0x867));}function _0x501b1e(_0x4fd275){const _0x2bf5f6=_0x247bea,_0xcd3ccf=_0x12493e[_0x2bf5f6(0xc45)][_0x12493e[_0x2bf5f6(0x7bc)]],_0xdce14a=_0xcd3ccf[_0x2bf5f6(0x1294)]['find'](_0x1f0338=>_0x1f0338['timestamp']===_0x4fd275);if(!_0xdce14a||_0xdce14a['type']!==_0x2bf5f6(0x7ef))return;const _0x2d5463=document[_0x2bf5f6(0xc33)](_0x2bf5f6(0xb24));let _0x485f5a='';_0xdce14a[_0x2bf5f6(0x88d)][_0x2bf5f6(0xd6a)](_0x1ed0e8=>{const _0x6f78ff=_0x2bf5f6;_0x485f5a+=_0x6f78ff(0x13d)+_0x1ed0e8[_0x6f78ff(0x578)]+'</td><td\x20class=\x22item-qty\x22>'+_0x1ed0e8[_0x6f78ff(0x162)]+_0x6f78ff(0xbec)+_0x1ed0e8[_0x6f78ff(0xae2)][_0x6f78ff(0xcab)](0x2)+_0x6f78ff(0x362)+(_0x1ed0e8['price']*_0x1ed0e8[_0x6f78ff(0x162)])[_0x6f78ff(0xcab)](0x2)+_0x6f78ff(0x129f);}),_0x2d5463[_0x2bf5f6(0x102a)]=_0x2bf5f6(0xe4d)+new Date(_0xdce14a[_0x2bf5f6(0x2f0)])['toLocaleString']()+_0x2bf5f6(0x5b9)+_0x485f5a+_0x2bf5f6(0x2ec)+_0xdce14a[_0x2bf5f6(0x856)][_0x2bf5f6(0xcab)](0x2)+_0x2bf5f6(0x121b),document['getElementById'](_0x2bf5f6(0x3db))[_0x2bf5f6(0x10d3)][_0x2bf5f6(0xb9)](_0x2bf5f6(0x143));}async function _0x38489a(_0x46b9ea=null){const _0x444958=_0x247bea;_0x368297=_0x46b9ea;const _0x72051f=document[_0x444958(0xc33)]('product-editor-modal'),_0x58690c=document[_0x444958(0xc33)](_0x444958(0x582)),_0x1cdf34=document[_0x444958(0xc33)](_0x444958(0xa46)),_0x350d21=document[_0x444958(0xc33)](_0x444958(0x465)),_0x59127b=document['getElementById'](_0x444958(0xddc)),_0x27c9fc=document['getElementById'](_0x444958(0xc87)),_0x64cfc=document[_0x444958(0xc33)](_0x444958(0xdfc)),_0x35748b=document[_0x444958(0xc33)](_0x444958(0x1086));_0x35748b[_0x444958(0x102a)]='',_0x64cfc[_0x444958(0x102a)]=_0x444958(0x758);const _0x100974=await _0x2a2987[_0x444958(0x1df)][_0x444958(0xf15)]();_0x100974[_0x444958(0xd6a)](_0x35d0da=>{const _0x48fcb1=_0x444958,_0x67d944=document['createElement'](_0x48fcb1(0x2f6));_0x67d944[_0x48fcb1(0x22a)]=_0x35d0da['id'],_0x67d944['textContent']=_0x35d0da[_0x48fcb1(0x578)],_0x64cfc[_0x48fcb1(0xf77)](_0x67d944);});if(_0x46b9ea){_0x58690c[_0x444958(0x11b0)]='编辑商品';const _0x3d8631=await _0x2a2987[_0x444958(0x6b4)][_0x444958(0xec0)](_0x46b9ea);_0x1cdf34[_0x444958(0x22a)]=_0x3d8631[_0x444958(0x578)],_0x350d21[_0x444958(0x22a)]=_0x3d8631[_0x444958(0xae2)],_0x59127b[_0x444958(0x22a)]=_0x3d8631[_0x444958(0x11ac)]||'',_0x27c9fc['src']=_0x3d8631[_0x444958(0x891)],_0x64cfc[_0x444958(0x22a)]=_0x3d8631[_0x444958(0x305)]||'',_0x3d8631[_0x444958(0x81e)]&&_0x3d8631[_0x444958(0x81e)][_0x444958(0x79b)]>0x0&&_0x3d8631[_0x444958(0x81e)][_0x444958(0xd6a)](_0x7df9fc=>_0x376ab0(_0x7df9fc));}else _0x58690c['textContent']=_0x444958(0x9d2),_0x1cdf34[_0x444958(0x22a)]='',_0x350d21[_0x444958(0x22a)]='',_0x59127b['value']='',_0x27c9fc[_0x444958(0x87b)]=_0x444958(0x10d),_0x64cfc[_0x444958(0x22a)]='';_0x72051f[_0x444958(0x10d3)][_0x444958(0xb9)](_0x444958(0x143));}async function _0x579ae7(){const _0x5b087f=_0x247bea,_0x10e0bd=document[_0x5b087f(0xc33)](_0x5b087f(0xa46))[_0x5b087f(0x22a)]['trim'](),_0x369986=parseFloat(document[_0x5b087f(0xc33)](_0x5b087f(0x465))[_0x5b087f(0x22a)]),_0x6eac87=document[_0x5b087f(0xc33)](_0x5b087f(0xddc))[_0x5b087f(0x22a)][_0x5b087f(0x7da)](),_0x1fe3f8=document[_0x5b087f(0xc33)](_0x5b087f(0xc87))[_0x5b087f(0x87b)],_0x21a3a5=parseInt(document[_0x5b087f(0xc33)](_0x5b087f(0xdfc))[_0x5b087f(0x22a)])||null;if(!_0x10e0bd){alert(_0x5b087f(0x202));return;}if(isNaN(_0x369986)||_0x369986<0x0){alert('请输入有效的默认价格！');return;}const _0x2f91d5=[];document['querySelectorAll']('.variation-block')[_0x5b087f(0xd6a)](_0x101d97=>{const _0x5b4e87=_0x5b087f,_0x41d5e0=_0x101d97[_0x5b4e87(0x977)](_0x5b4e87(0x778))[_0x5b4e87(0x22a)][_0x5b4e87(0x7da)](),_0x426979=parseFloat(_0x101d97[_0x5b4e87(0x977)](_0x5b4e87(0x626))[_0x5b4e87(0x22a)]),_0xc06e0b=_0x101d97[_0x5b4e87(0x977)](_0x5b4e87(0xd2c))[_0x5b4e87(0x87b)];_0x41d5e0&&!isNaN(_0x426979)&&_0x426979>=0x0&&_0x2f91d5['push']({'name':_0x41d5e0,'price':_0x426979,'imageUrl':_0xc06e0b['includes'](_0x5b4e87(0x79d))?null:_0xc06e0b});});const _0x25c4b8={'name':_0x10e0bd,'price':_0x369986,'description':_0x6eac87,'imageUrl':_0x1fe3f8,'categoryId':_0x21a3a5,'variations':_0x2f91d5};_0x368297?await _0x2a2987[_0x5b087f(0x6b4)][_0x5b087f(0xb07)](_0x368297,_0x25c4b8):await _0x2a2987[_0x5b087f(0x6b4)]['add'](_0x25c4b8),document[_0x5b087f(0xc33)](_0x5b087f(0xfaf))[_0x5b087f(0x10d3)]['remove'](_0x5b087f(0x143)),await _0x34cd96();}async function _0x367e8e(){const _0x3c0c51=_0x247bea;await _0x1f8559(),_0x38f00f(_0x3c0c51(0xc51));}async function _0x1f8559(){const _0x3b2c4d=_0x247bea,_0x84a2aa=document[_0x3b2c4d(0xc33)](_0x3b2c4d(0xce0)),_0xa8f840=document[_0x3b2c4d(0xc33)]('rules-content-container');_0x84a2aa[_0x3b2c4d(0x102a)]='',_0xa8f840[_0x3b2c4d(0x102a)]='';const _0x17e396=await _0x2a2987[_0x3b2c4d(0x1103)][_0x3b2c4d(0xf15)]();if(_0x17e396[_0x3b2c4d(0x79b)]===0x0){_0xa8f840[_0x3b2c4d(0x102a)]=_0x3b2c4d(0x768);return;}const _0x37abfe=document[_0x3b2c4d(0x1292)](_0x3b2c4d(0xeb1));_0x37abfe['className']='rules-tab\x20active',_0x37abfe[_0x3b2c4d(0x11b0)]=_0x3b2c4d(0x161),_0x37abfe['dataset'][_0x3b2c4d(0x305)]='global',_0x84a2aa['appendChild'](_0x37abfe);const _0x481661=document['createElement'](_0x3b2c4d(0x58c));_0x481661[_0x3b2c4d(0x84)]='rules-category-pane\x20active',_0x481661['dataset'][_0x3b2c4d(0x305)]='global',_0xa8f840[_0x3b2c4d(0xf77)](_0x481661);const _0x4e5135=Object['values'](_0x12493e['chats'])['filter'](_0x240d43=>!_0x240d43[_0x3b2c4d(0x80b)]&&_0x17e396[_0x3b2c4d(0xfa7)](_0x3fc953=>_0x3fc953['chatId']===_0x240d43['id']));_0x4e5135['forEach'](_0x4766e6=>{const _0x21a27e=_0x3b2c4d,_0x86c246=document[_0x21a27e(0x1292)](_0x21a27e(0xeb1));_0x86c246[_0x21a27e(0x84)]=_0x21a27e(0x7c1),_0x86c246[_0x21a27e(0x11b0)]=_0x4766e6[_0x21a27e(0x578)],_0x86c246[_0x21a27e(0x85)]['categoryId']=_0x4766e6['id'],_0x84a2aa[_0x21a27e(0xf77)](_0x86c246);const _0x5d0d0f=document[_0x21a27e(0x1292)](_0x21a27e(0x58c));_0x5d0d0f[_0x21a27e(0x84)]=_0x21a27e(0x843),_0x5d0d0f[_0x21a27e(0x85)]['categoryId']=_0x4766e6['id'],_0xa8f840['appendChild'](_0x5d0d0f);}),_0x17e396[_0x3b2c4d(0xd6a)](_0x30f525=>{const _0x3da147=_0x19ebd5(_0x30f525),_0x4cdecc=_0xa8f840['querySelector']('.rules-category-pane[data-category-id=\x22'+_0x30f525['chatId']+'\x22]');_0x4cdecc&&_0x4cdecc['appendChild'](_0x3da147);}),document['querySelectorAll'](_0x3b2c4d(0x2b8))[_0x3b2c4d(0xd6a)](_0x72e01f=>{const _0x147d0f=_0x3b2c4d;_0x72e01f['addEventListener'](_0x147d0f(0x335),()=>_0x46808e(_0x72e01f[_0x147d0f(0x85)]['categoryId']));});}function _0x19ebd5(_0x35ed86){const _0x28441c=_0x247bea,_0xff5f4b=document['createElement']('div');return _0xff5f4b[_0x28441c(0x84)]=_0x28441c(0x3b5)+(_0x35ed86[_0x28441c(0xbc6)]?_0x28441c(0x95a):''),_0xff5f4b['dataset'][_0x28441c(0x2b5)]=_0x35ed86['id'],_0xff5f4b[_0x28441c(0x102a)]=_0x28441c(0x753)+_0x35ed86[_0x28441c(0x578)]+_0x28441c(0x191)+_0x35ed86[_0x28441c(0xbcd)]+_0x28441c(0x968),_0xff5f4b[_0x28441c(0x205)](_0x28441c(0x335),()=>_0x24ad8a(_0x35ed86['id'])),_0x29b870(_0xff5f4b,()=>_0x75747e(_0x35ed86['id'])),_0xff5f4b;}async function _0x24ad8a(_0x52b85b=null){const _0x3ca299=_0x247bea;_0x3f944e=_0x52b85b;const _0x351bde=document[_0x3ca299(0xc33)](_0x3ca299(0x3ca)),_0x3e40de=document[_0x3ca299(0xc33)]('rule-editor-title'),_0x34fd2e=document['getElementById'](_0x3ca299(0xcfa)),_0x1a1b72=document['getElementById']('rule-chat-id-select'),_0xeaf586=document[_0x3ca299(0xc33)](_0x3ca299(0x484)),_0x362276=document[_0x3ca299(0xc33)](_0x3ca299(0x346)),_0x5c20d1=document[_0x3ca299(0xc33)]('rule-enabled-switch');_0x1a1b72[_0x3ca299(0x102a)]=_0x3ca299(0x5aa),Object[_0x3ca299(0xd28)](_0x12493e[_0x3ca299(0xc45)])[_0x3ca299(0x1054)](_0x275c24=>!_0x275c24[_0x3ca299(0x80b)])['forEach'](_0x556934=>{const _0x313820=_0x3ca299;_0x1a1b72[_0x313820(0x102a)]+=_0x313820(0x11f0)+_0x556934['id']+'\x22>'+_0x556934[_0x313820(0x578)]+_0x313820(0xd79);});if(_0x52b85b){_0x3e40de[_0x3ca299(0x11b0)]='编辑规则';const _0x3cff77=await _0x2a2987[_0x3ca299(0x1103)][_0x3ca299(0xec0)](_0x52b85b);_0x34fd2e[_0x3ca299(0x22a)]=_0x3cff77[_0x3ca299(0x578)],_0x1a1b72[_0x3ca299(0x22a)]=_0x3cff77[_0x3ca299(0x109b)],_0xeaf586[_0x3ca299(0x22a)]=_0x3cff77[_0x3ca299(0xbcd)],_0x362276['value']=_0x3cff77[_0x3ca299(0x747)],_0x5c20d1[_0x3ca299(0x737)]=_0x3cff77[_0x3ca299(0xbc6)];}else _0x3e40de[_0x3ca299(0x11b0)]=_0x3ca299(0x851),_0x34fd2e[_0x3ca299(0x22a)]='',_0x1a1b72[_0x3ca299(0x22a)]='global',_0xeaf586['value']='',_0x362276[_0x3ca299(0x22a)]='',_0x5c20d1[_0x3ca299(0x737)]=!![];_0x351bde['classList']['add'](_0x3ca299(0x143));}async function _0x3b812b(){const _0x2d8ab6=_0x247bea,_0x84a302=document[_0x2d8ab6(0xc33)]('rule-name-input')[_0x2d8ab6(0x22a)][_0x2d8ab6(0x7da)](),_0x466ff0=document[_0x2d8ab6(0xc33)]('rule-regex-input')['value']['trim']();if(!_0x84a302||!_0x466ff0){alert(_0x2d8ab6(0x37e));return;}try{new RegExp(_0x466ff0);}catch(_0x44be91){alert(_0x2d8ab6(0xb55)+_0x44be91[_0x2d8ab6(0xf93)]);return;}const _0x5efcb3={'name':_0x84a302,'chatId':document['getElementById'](_0x2d8ab6(0x10ee))[_0x2d8ab6(0x22a)],'regex':_0x466ff0,'template':document[_0x2d8ab6(0xc33)]('rule-template-input')[_0x2d8ab6(0x22a)],'isEnabled':document['getElementById']('rule-enabled-switch')[_0x2d8ab6(0x737)]};_0x3f944e?await _0x2a2987[_0x2d8ab6(0x1103)][_0x2d8ab6(0xb07)](_0x3f944e,_0x5efcb3):await _0x2a2987[_0x2d8ab6(0x1103)]['add'](_0x5efcb3),document[_0x2d8ab6(0xc33)](_0x2d8ab6(0x3ca))['classList']['remove'](_0x2d8ab6(0x143)),await _0x1f8559();}async function _0x75747e(_0x747321){const _0x341462=_0x247bea,_0x741bd8=await _0x270512(_0x341462(0x73b),_0x341462(0x7f2),{'confirmButtonClass':_0x341462(0xa2)});_0x741bd8&&(await _0x2a2987[_0x341462(0x1103)]['delete'](_0x747321),await _0x1f8559());}async function _0x141392(_0x37a250,_0x1360c0){const _0x58a9a0=_0x247bea;if(_0x37a250[_0x58a9a0(0x7da)]()[_0x58a9a0(0xece)]('<')||!_0x37a250[_0x58a9a0(0x1d4)]('[')&&!_0x37a250['includes']('{'))return _0x37a250;const _0x47a793=await _0x2a2987[_0x58a9a0(0x1103)]['where'](_0x58a9a0(0x109b))[_0x58a9a0(0x10bd)]('global')['or'](_0x58a9a0(0x109b))[_0x58a9a0(0x10bd)](_0x1360c0)[_0x58a9a0(0xf15)]();let _0x156080=_0x37a250;for(const _0x2d06c7 of _0x47a793[_0x58a9a0(0x1054)](_0x5d4742=>_0x5d4742[_0x58a9a0(0xbc6)])){try{const _0x5aa3bf=new RegExp(_0x2d06c7[_0x58a9a0(0xbcd)],'g');_0x5aa3bf[_0x58a9a0(0x677)](_0x156080)&&(_0x156080=_0x156080[_0x58a9a0(0xc12)](_0x5aa3bf,_0x2d06c7[_0x58a9a0(0x747)]));}catch(_0x35cae8){console[_0x58a9a0(0x4d9)]('渲染规则\x20['+_0x2d06c7[_0x58a9a0(0x578)]+_0x58a9a0(0x6d8),_0x35cae8);}}return _0x156080;}async function _0x367e8e(){const _0x474451=_0x247bea;await _0x1f8559(),_0x38f00f(_0x474451(0xc51));}async function _0x1f8559(){const _0x5ce907=_0x247bea,_0x485b7c=document[_0x5ce907(0xc33)](_0x5ce907(0xce0)),_0x547276=document[_0x5ce907(0xc33)]('rules-content-container');_0x485b7c[_0x5ce907(0x102a)]='',_0x547276[_0x5ce907(0x102a)]='';const _0x3d6128=await _0x2a2987[_0x5ce907(0x1103)]['toArray']();if(_0x3d6128[_0x5ce907(0x79b)]===0x0){_0x547276['innerHTML']='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>还没有任何渲染规则。点击右上角“+”创建第一个吧！</p>';return;}const _0xf5e4b7=document[_0x5ce907(0x1292)]('button');_0xf5e4b7[_0x5ce907(0x84)]=_0x5ce907(0x267),_0xf5e4b7['textContent']=_0x5ce907(0x161),_0xf5e4b7[_0x5ce907(0x85)][_0x5ce907(0x305)]=_0x5ce907(0x331),_0x485b7c[_0x5ce907(0xf77)](_0xf5e4b7);const _0x457813=document['createElement'](_0x5ce907(0x58c));_0x457813[_0x5ce907(0x84)]=_0x5ce907(0x10a0),_0x457813[_0x5ce907(0x85)][_0x5ce907(0x305)]=_0x5ce907(0x331),_0x547276[_0x5ce907(0xf77)](_0x457813);const _0xc57300=Object[_0x5ce907(0xd28)](_0x12493e[_0x5ce907(0xc45)])['filter'](_0x4e22da=>!_0x4e22da['isGroup']&&_0x3d6128[_0x5ce907(0xfa7)](_0x1ae779=>_0x1ae779[_0x5ce907(0x109b)]===_0x4e22da['id']));_0xc57300[_0x5ce907(0xd6a)](_0xd69e32=>{const _0x220881=_0x5ce907,_0xd02115=document[_0x220881(0x1292)](_0x220881(0xeb1));_0xd02115['className']=_0x220881(0x7c1),_0xd02115[_0x220881(0x11b0)]=_0xd69e32[_0x220881(0x578)],_0xd02115['dataset'][_0x220881(0x305)]=_0xd69e32['id'],_0x485b7c[_0x220881(0xf77)](_0xd02115);const _0x9715e8=document['createElement']('div');_0x9715e8['className']='rules-category-pane',_0x9715e8[_0x220881(0x85)][_0x220881(0x305)]=_0xd69e32['id'],_0x547276[_0x220881(0xf77)](_0x9715e8);}),_0x3d6128[_0x5ce907(0xd6a)](_0x14feee=>{const _0x3d811e=_0x5ce907,_0x33a937=_0x19ebd5(_0x14feee),_0xfb733a=_0x547276[_0x3d811e(0x977)]('.rules-category-pane[data-category-id=\x22'+_0x14feee['chatId']+'\x22]');_0xfb733a&&_0xfb733a[_0x3d811e(0xf77)](_0x33a937);}),document['querySelectorAll'](_0x5ce907(0x2b8))[_0x5ce907(0xd6a)](_0x5eb91e=>{const _0x73bfd3=_0x5ce907;_0x5eb91e[_0x73bfd3(0x205)](_0x73bfd3(0x335),()=>_0x46808e(_0x5eb91e['dataset'][_0x73bfd3(0x305)]));});}function _0x19ebd5(_0x34630c){const _0x50b4da=_0x247bea,_0x29f68e=document[_0x50b4da(0x1292)]('div');return _0x29f68e[_0x50b4da(0x84)]=_0x50b4da(0x3b5)+(_0x34630c[_0x50b4da(0xbc6)]?_0x50b4da(0x95a):''),_0x29f68e['dataset']['ruleId']=_0x34630c['id'],_0x29f68e[_0x50b4da(0x102a)]=_0x50b4da(0x753)+_0x34630c[_0x50b4da(0x578)]+_0x50b4da(0x191)+_0x34630c['regex']+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x29f68e[_0x50b4da(0x205)](_0x50b4da(0x335),()=>_0x24ad8a(_0x34630c['id'])),_0x29b870(_0x29f68e,()=>_0x75747e(_0x34630c['id'])),_0x29f68e;}async function _0x24ad8a(_0x5bde16=null){const _0x3c801a=_0x247bea;_0x3f944e=_0x5bde16;const _0x2eb767=document['getElementById'](_0x3c801a(0x3ca)),_0xc6faae=document['getElementById'](_0x3c801a(0xd98)),_0x3c39aa=document[_0x3c801a(0xc33)](_0x3c801a(0xcfa)),_0x33192a=document[_0x3c801a(0xc33)](_0x3c801a(0x10ee)),_0x17842e=document[_0x3c801a(0xc33)](_0x3c801a(0x484)),_0x19d12b=document['getElementById'](_0x3c801a(0x346)),_0x44713d=document[_0x3c801a(0xc33)](_0x3c801a(0x414));_0x33192a[_0x3c801a(0x102a)]='<option\x20value=\x22global\x22>公用\x20(所有角色)</option>',Object[_0x3c801a(0xd28)](_0x12493e[_0x3c801a(0xc45)])[_0x3c801a(0x1054)](_0x24c9d4=>!_0x24c9d4[_0x3c801a(0x80b)])[_0x3c801a(0xd6a)](_0x73b61=>{const _0x53d2fb=_0x3c801a;_0x33192a[_0x53d2fb(0x102a)]+=_0x53d2fb(0x11f0)+_0x73b61['id']+'\x22>'+_0x73b61['name']+_0x53d2fb(0xd79);});if(_0x5bde16){_0xc6faae['textContent']=_0x3c801a(0x201);const _0xabb096=await _0x2a2987[_0x3c801a(0x1103)]['get'](_0x5bde16);_0x3c39aa['value']=_0xabb096[_0x3c801a(0x578)],_0x33192a['value']=_0xabb096[_0x3c801a(0x109b)],_0x17842e[_0x3c801a(0x22a)]=_0xabb096['regex'],_0x19d12b['value']=_0xabb096[_0x3c801a(0x747)],_0x44713d['checked']=_0xabb096[_0x3c801a(0xbc6)];}else _0xc6faae[_0x3c801a(0x11b0)]='创建新规则',_0x3c39aa[_0x3c801a(0x22a)]='',_0x33192a[_0x3c801a(0x22a)]=_0x3c801a(0x331),_0x17842e['value']='',_0x19d12b['value']='',_0x44713d['checked']=!![];_0x2eb767[_0x3c801a(0x10d3)][_0x3c801a(0xb9)](_0x3c801a(0x143));}async function _0x3b812b(){const _0x9ea2a8=_0x247bea,_0x129c51=document[_0x9ea2a8(0xc33)](_0x9ea2a8(0xcfa))[_0x9ea2a8(0x22a)][_0x9ea2a8(0x7da)](),_0x5cbac5=document['getElementById']('rule-regex-input')[_0x9ea2a8(0x22a)]['trim']();if(!_0x129c51||!_0x5cbac5){alert(_0x9ea2a8(0x37e));return;}try{new RegExp(_0x5cbac5);}catch(_0x410640){alert('正则表达式格式错误:\x20'+_0x410640[_0x9ea2a8(0xf93)]);return;}const _0x4a175a={'name':_0x129c51,'chatId':document[_0x9ea2a8(0xc33)](_0x9ea2a8(0x10ee))[_0x9ea2a8(0x22a)],'regex':_0x5cbac5,'template':document[_0x9ea2a8(0xc33)](_0x9ea2a8(0x346))['value'],'isEnabled':document['getElementById'](_0x9ea2a8(0x414))[_0x9ea2a8(0x737)]};_0x3f944e?await _0x2a2987[_0x9ea2a8(0x1103)][_0x9ea2a8(0xb07)](_0x3f944e,_0x4a175a):await _0x2a2987[_0x9ea2a8(0x1103)][_0x9ea2a8(0xb9)](_0x4a175a),document[_0x9ea2a8(0xc33)]('rule-editor-modal')[_0x9ea2a8(0x10d3)][_0x9ea2a8(0x2c7)](_0x9ea2a8(0x143)),await _0x1f8559();}async function _0x75747e(_0x212a95){const _0x5195b6=_0x247bea,_0x552807=await _0x270512('删除规则',_0x5195b6(0x7f2),{'confirmButtonClass':_0x5195b6(0xa2)});_0x552807&&(await _0x2a2987[_0x5195b6(0x1103)][_0x5195b6(0x9ea)](_0x212a95),await _0x1f8559());}async function _0x141392(_0x17e324,_0x1d3329){const _0x512403=_0x247bea;if(_0x17e324[_0x512403(0x7da)]()['startsWith']('<')||!_0x17e324[_0x512403(0x1d4)]('[')&&!_0x17e324[_0x512403(0x1d4)]('{'))return _0x17e324;if(!_0x4c9e39[_0x1d3329]){console[_0x512403(0x51f)](_0x512403(0xb8)+_0x1d3329);const _0x1d0016=await _0x2a2987['renderingRules'][_0x512403(0x8b5)](_0x512403(0x109b))['equals']('global')['or'](_0x512403(0x109b))[_0x512403(0x10bd)](_0x1d3329)[_0x512403(0xf15)]();_0x4c9e39[_0x1d3329]=_0x1d0016[_0x512403(0x1054)](_0x198576=>_0x198576[_0x512403(0xbc6)]);}const _0xa1e80=_0x4c9e39[_0x1d3329];let _0x13fad1=_0x17e324;for(const _0x293634 of _0xa1e80){try{const _0x33fecf=new RegExp(_0x293634[_0x512403(0xbcd)],'g');let _0x6349cf=_0x13fad1;_0x33fecf[_0x512403(0x677)](_0x6349cf)&&(_0x13fad1=_0x13fad1[_0x512403(0xc12)](_0x33fecf,_0x293634[_0x512403(0x747)]));}catch(_0xe17b0){console['error']('渲染规则\x20['+_0x293634[_0x512403(0x578)]+_0x512403(0x6d8),_0xe17b0);}}return _0x13fad1;}function _0x146ebd(_0x3721cc){const _0x4cc3bb=_0x247bea;if(!_0x3721cc)return'';const _0x30657c=new Date(),_0xc46ce6=new Date(_0x3721cc),_0x35340f=String(_0xc46ce6[_0x4cc3bb(0xa75)]())['padStart'](0x2,'0'),_0x4fe56c=String(_0xc46ce6['getMinutes']())['padStart'](0x2,'0'),_0x121a70=_0x35340f+':'+_0x4fe56c;if(_0x30657c[_0x4cc3bb(0xc8d)]()===_0xc46ce6[_0x4cc3bb(0xc8d)]())return _0x121a70;const _0x563dc1=new Date();_0x563dc1[_0x4cc3bb(0x1157)](_0x30657c[_0x4cc3bb(0x6be)]()-0x1);if(_0x563dc1[_0x4cc3bb(0xc8d)]()===_0xc46ce6[_0x4cc3bb(0xc8d)]())return _0x4cc3bb(0x5c1)+_0x121a70;const _0x44f062=_0xc46ce6[_0x4cc3bb(0x80d)](),_0x2b3db3=String(_0xc46ce6[_0x4cc3bb(0xf99)]()+0x1)['padStart'](0x2,'0'),_0x390b0f=String(_0xc46ce6['getDate']())['padStart'](0x2,'0');return _0x30657c[_0x4cc3bb(0x80d)]()===_0x44f062?_0x2b3db3+'月'+_0x390b0f+'日\x20'+_0x121a70:_0x44f062+'年'+_0x2b3db3+'月'+_0x390b0f+'日\x20'+_0x121a70;}function _0x58cae3(_0x223b49){const _0x3c58cf=_0x247bea,_0x39fbc5=document['createElement'](_0x3c58cf(0x58c));_0x39fbc5[_0x3c58cf(0x84)]=_0x3c58cf(0x1252);const _0x856335=document[_0x3c58cf(0x1292)](_0x3c58cf(0x58c));return _0x856335[_0x3c58cf(0x84)]=_0x3c58cf(0xc1b),_0x856335[_0x3c58cf(0x11b0)]=_0x146ebd(_0x223b49),_0x39fbc5[_0x3c58cf(0xf77)](_0x856335),_0x39fbc5;}async function _0x33f20c(){const _0x59f6c1=_0x247bea,_0x3267b5=_0x12493e[_0x59f6c1(0xc45)][_0x12493e[_0x59f6c1(0x7bc)]];if(!_0x3267b5||!lastResponseTimestamps||lastResponseTimestamps['length']===0x0){alert('没有可供重新生成的AI响应。');return;}_0x3267b5[_0x59f6c1(0x1294)]=_0x3267b5[_0x59f6c1(0x1294)]['filter'](_0x855a1c=>!lastResponseTimestamps[_0x59f6c1(0x1d4)](_0x855a1c[_0x59f6c1(0x2f0)])),await _0x2a2987['chats'][_0x59f6c1(0xf36)](_0x3267b5),await _0x1bbfd3(_0x12493e['activeChatId']),_0x2fb62c();}async function _0x5f1cab(){const _0x49b3c7=_0x247bea,_0x53fa23=_0x12493e['chats'][_0x12493e[_0x49b3c7(0x7bc)]];if(!_0x53fa23)return;const _0x48535a=_0x53fa23[_0x49b3c7(0x1294)][_0x49b3c7(0xfc9)](_0x193eab=>_0x193eab[_0x49b3c7(0x16d)]==='user'&&!_0x193eab[_0x49b3c7(0xd07)]);if(_0x48535a===-0x1){alert(_0x49b3c7(0x12b2));return;}const _0x5eb91f=_0x53fa23['history'][_0x49b3c7(0xfc9)](_0x1be9d7=>_0x1be9d7['role']==='assistant');if(_0x5eb91f<_0x48535a){alert(_0x49b3c7(0xc63));return;}_0x53fa23[_0x49b3c7(0x1294)]['splice'](_0x48535a+0x1),await _0x2a2987[_0x49b3c7(0xc45)]['put'](_0x53fa23),await _0x1bbfd3(_0x12493e[_0x49b3c7(0x7bc)]),await _0x439587();}async function _0x1b9944(){const _0x2a36b8=_0x247bea;if(!_0x3b6ec9[_0x2a36b8(0x1f3)])return;const _0x2c0441=_0x3b6ec9[_0x2a36b8(0xe0c)][_0x2a36b8(0xfc9)](_0x18d022=>_0x18d022['role']===_0x2a36b8(0x717));if(_0x2c0441===-0x1){alert(_0x2a36b8(0x42d));return;}_0x3b6ec9[_0x2a36b8(0xe0c)][_0x2a36b8(0xbd1)](_0x2c0441+0x1);const _0x5253e0=document[_0x2a36b8(0xc33)](_0x2a36b8(0x8cb));_0x5253e0[_0x2a36b8(0x102a)]='',_0x3b6ec9[_0x2a36b8(0xe0c)][_0x2a36b8(0xd6a)](_0x33c255=>{const _0x3f22c9=_0x2a36b8,_0x21ccd4=document[_0x3f22c9(0x1292)](_0x3f22c9(0x58c));_0x21ccd4[_0x3f22c9(0x84)]=_0x3f22c9(0x1278)+_0x33c255[_0x3f22c9(0x16d)]+_0x3f22c9(0x144),_0x21ccd4[_0x3f22c9(0x85)][_0x3f22c9(0x2f0)]=_0x33c255[_0x3f22c9(0x2f0)],_0x33c255['role']==='user'?_0x21ccd4[_0x3f22c9(0x11b0)]=_0x33c255[_0x3f22c9(0xcbd)]:_0x21ccd4[_0x3f22c9(0x102a)]=_0x33c255[_0x3f22c9(0xcbd)],_0x29b870(_0x21ccd4,()=>_0x279f3b(_0x33c255[_0x3f22c9(0x2f0)])),_0x5253e0[_0x3f22c9(0xf77)](_0x21ccd4);}),_0x5253e0[_0x2a36b8(0x1244)]=_0x5253e0['scrollHeight'],_0x1ff84d(null);}async function _0x4eb299(){const _0x5528a0=_0x247bea,_0x1487c2=_0x12493e[_0x5528a0(0xc45)][_0x12493e[_0x5528a0(0x7bc)]];if(!_0x1487c2)return;_0x15197e(_0x1487c2['id'],!![]);const _0x52f86e=document[_0x5528a0(0xc33)](_0x5528a0(0x40c));!_0x1487c2[_0x5528a0(0x80b)]&&(_0x52f86e[_0x5528a0(0x105d)][_0x5528a0(0x8d1)]=0x0,setTimeout(()=>{const _0x2c26d5=_0x5528a0;_0x52f86e['textContent']=_0x2c26d5(0x10a7),_0x52f86e[_0x2c26d5(0x10d3)][_0x2c26d5(0xb9)](_0x2c26d5(0x1201)),_0x52f86e[_0x2c26d5(0x105d)][_0x2c26d5(0x8d1)]=0x1;},0xc8));try{const {proxyUrl:_0xcc715b,apiKey:_0x4dd4f9,model:_0x396c2c}=_0x12493e[_0x5528a0(0xdd4)];if(!_0xcc715b||!_0x4dd4f9||!_0x396c2c)throw new Error('API未配置');const _0x2d8750=parseInt(_0x1487c2[_0x5528a0(0x2ea)][_0x5528a0(0x660)])||0xa,_0x1a7a1f=_0x1487c2[_0x5528a0(0x1294)]['slice'](-_0x2d8750),_0x1d6b1b=new Date(),_0x5a6525=new Date(_0x1d6b1b[_0x5528a0(0x234)]()+_0x1d6b1b[_0x5528a0(0x254)]()*0xea60+0x36ee80*0x8),_0x3cad52=_0x5a6525['toLocaleString'](_0x5528a0(0x770),{'timeZone':_0x5528a0(0x368),'dateStyle':_0x5528a0(0x12b6),'timeStyle':_0x5528a0(0x1de)}),_0x13c012=_0x2e4d44(_0x5a6525),_0x524ea9=_0x1487c2[_0x5528a0(0x2ea)]['myNickname']||'我';let _0x3ca0ff='';if(_0x1487c2['settings'][_0x5528a0(0xeca)]&&_0x1487c2[_0x5528a0(0x2ea)][_0x5528a0(0xeca)][_0x5528a0(0x79b)]>0x0){const _0x38dae4=_0x1487c2[_0x5528a0(0x2ea)][_0x5528a0(0xeca)][_0x5528a0(0x9d5)](_0x4738bc=>{const _0x4498d4=_0x5528a0,_0x28a1ca=_0x12493e[_0x4498d4(0x63a)][_0x4498d4(0xd85)](_0x33f6f5=>_0x33f6f5['id']===_0x4738bc);if(!_0x28a1ca||!Array[_0x4498d4(0x621)](_0x28a1ca[_0x4498d4(0xcbd)]))return'';const _0x4daa6d=_0x28a1ca[_0x4498d4(0xcbd)]['filter'](_0x109ded=>_0x109ded[_0x4498d4(0x95a)]!==![])[_0x4498d4(0x9d5)](_0x18a999=>{const _0x210c50=_0x4498d4;let _0x53d4b4='\x0a###\x20条目:\x20'+(_0x18a999[_0x210c50(0x8db)]||_0x210c50(0x2cb))+'\x0a';if(_0x18a999[_0x210c50(0x1c6)][_0x210c50(0x79b)]>0x0)_0x53d4b4+=_0x210c50(0x2ca)+_0x18a999[_0x210c50(0x1c6)][_0x210c50(0x100b)](',\x20')+'\x0a';return _0x53d4b4+=_0x210c50(0xb02)+_0x18a999[_0x210c50(0xcbd)],_0x53d4b4;})['join']('');return _0x4daa6d?_0x4498d4(0xc39)+_0x28a1ca[_0x4498d4(0x578)]+'\x0a'+_0x4daa6d:'';})['filter'](Boolean)['join']('');_0x38dae4&&(_0x3ca0ff=_0x5528a0(0x352)+_0x38dae4+'\x0a#\x20---\x20世界书设定结束\x20---\x0a');}let _0x3ec563='';if(_0x5ebb31['isActive']&&_0x5ebb31[_0x5528a0(0x7bc)]===_0x1487c2['id']){const _0x2b1e7a=_0x5ebb31['currentIndex']>-0x1?_0x5ebb31[_0x5528a0(0xd9f)][_0x5ebb31['currentIndex']]:null;_0x3ec563=_0x5528a0(0x903);}const _0x1021ec=_0x3dbdee(_0xafc893[_0x1487c2['id']]);let _0x4429e4='';_0x1487c2[_0x5528a0(0xa1a)]&&_0x1487c2[_0x5528a0(0xa1a)][_0x5528a0(0x79b)]>0x0&&(_0x4429e4='\x0a-\x20**你的曾用名**:\x20['+_0x1487c2[_0x5528a0(0xa1a)]['join'](',\x20')+_0x5528a0(0x3a0));let _0x3e89bd='';const _0x117de2=_0x12493e['qzoneSettings'][_0x5528a0(0x66a)]||'用户';_0x3e89bd+='-\x20用户的QZone昵称是\x20\x22'+_0x117de2+_0x5528a0(0x3c8);const _0x20e3fe=Object[_0x5528a0(0xd28)](_0x12493e['chats'])[_0x5528a0(0x1054)](_0x297f7c=>_0x297f7c['isGroup']&&_0x297f7c['members'][_0x5528a0(0xfa7)](_0x1a0301=>_0x1a0301['id']===_0x1487c2['id']));_0x20e3fe[_0x5528a0(0x79b)]>0x0&&(_0x3e89bd+=_0x5528a0(0x2e2),_0x20e3fe[_0x5528a0(0xd6a)](_0x1ad7d3=>{const _0x41af7b=_0x5528a0,_0x360d21=_0x1ad7d3[_0x41af7b(0x2ea)][_0x41af7b(0xbf6)]||_0x117de2;_0x3e89bd+=_0x41af7b(0x831)+_0x1ad7d3[_0x41af7b(0x578)]+_0x41af7b(0x672)+_0x360d21+_0x41af7b(0xd91);}));_0x3e89bd+='当你在任何系统提示、动态评论或挂载的群聊记忆中看到这些名字时，它们都指代的是【你的聊天对象】。';const _0x416bbb=_0x17e3b9(_0x1487c2),_0x3b1cc6=_0x5528a0(0x10cb)+_0x1487c2[_0x5528a0(0x776)]+_0x5528a0(0x153)+_0x3cad52+'\x20('+_0x13c012+_0x5528a0(0x11ee)+(_0x3ec563?'你们正在一起听歌，'+_0x3ec563:'你们没有在听歌。')+'\x0a\x0a3.\x20\x20**主动性**:\x0a\x20\x20\x20\x20-\x20你可以根据对话发展，使用指令来更新自己的状态、更换头像、记录回忆、发起约定或执行其他社交行为。\x0a\x20\x20\x20\x20-\x20【关系破裂时】才可使用\x20`block_user`\x20指令。\x0a4.\x20\x20**内心独白\x20(必须执行)**:\x20在所有其他指令之后，JSON数组的【最后】必须包含一个\x20\x22update_thoughts\x22\x20指令，用于更新角色的“心声”和“散记”。\x0a\x20\x20\x20\x20-\x20**心声\x20(heartfelt_voice)**:\x20一句话概括角色此刻最核心、最私密的想法。\x0a\x20\x20\x20\x20-\x20**散记\x20(random_jottings)**:\x20一段50字以上的、符合人设的思考或心情记录，禁止OOC。\x0a请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20长期记忆\x20(必须严格遵守)\x0a'+(_0x1487c2[_0x5528a0(0x45b)]&&_0x1487c2[_0x5528a0(0x45b)]['length']>0x0?_0x1487c2[_0x5528a0(0x45b)]['map'](_0x541ffa=>'-\x20'+_0x541ffa[_0x5528a0(0xcbd)])[_0x5528a0(0x100b)]('\x0a'):_0x5528a0(0x380))+_0x5528a0(0xe08)+_0x1487c2['settings'][_0x5528a0(0x679)]+'\x0a\x0a#\x20关系与身份档案\x20(至关重要)\x0a-\x20\x20\x20**你的本名**:\x20\x22'+_0x1487c2['originalName']+_0x5528a0(0x252)+_0x1487c2['name']+'\x22\x20(你可以建议修改)\x0a-\x20\x20\x20**你对用户的称呼**:\x20“'+_0x524ea9+_0x5528a0(0xe56)+_0x3e89bd+'\x0a\x20\x20\x20\x20'+_0x4429e4+'\x0a\x20\x20\x20\x20'+_0x3ca0ff+'\x0a#\x20可用表情包\x0a\x20\x20\x20\x20'+_0x416bbb+_0x5528a0(0x1224)+(_0x1487c2[_0x5528a0(0x2ea)]['aiAvatarLibrary']&&_0x1487c2[_0x5528a0(0x2ea)]['aiAvatarLibrary'][_0x5528a0(0x79b)]>0x0?_0x1487c2['settings'][_0x5528a0(0xfc5)][_0x5528a0(0x9d5)](_0x4855f4=>'-\x20'+_0x4855f4[_0x5528a0(0x578)])[_0x5528a0(0x100b)]('\x0a'):_0x5528a0(0x1041))+_0x5528a0(0x412)+(_0x1487c2[_0x5528a0(0x2ea)][_0x5528a0(0x10df)]&&_0x1487c2['settings']['myAvatarLibrary']['length']>0x0?_0x1487c2[_0x5528a0(0x2ea)][_0x5528a0(0x10df)][_0x5528a0(0x9d5)](_0x59777e=>'-\x20'+_0x59777e[_0x5528a0(0x578)])[_0x5528a0(0x100b)]('\x0a'):_0x5528a0(0x1041))+'\x0a\x0a#\x20可用指令列表\x0a###\x20核心聊天指令\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你好呀！\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22description\x22:\x20\x22详细中文描述\x22}`\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22content\x22:\x20\x22语音文字内容\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20消息时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a\x0a###\x20社交与互动指令\x0a-\x20\x20\x20**拍用户**:\x20`{\x22type\x22:\x20\x22pat_user\x22,\x20\x22suffix\x22:\x20\x22(可选)后缀\x22}`\x0a-\x20\x20\x20**分享链接**:\x20`{\x22type\x22:\x20\x22share_link\x22,\x20\x22title\x22:\x20\x22标题\x22,\x20\x22description\x22:\x20\x22摘要\x22,\x20\x22source_name\x22:\x20\x22来源\x22,\x20\x22content\x22:\x20\x22正文\x22}`\x0a-\x20\x20\x20**共享位置**:\x20\x27{\x22type\x22:\x20\x22location_share\x22,\x20\x22content\x22:\x20\x22你想分享的位置名\x22}\x27\x0a\x0a###\x20状态与关系指令\x0a-\x20\x20\x20**改自己备注**:\x20`{\x22type\x22:\x20\x22change_remark_name\x22,\x20\x22new_name\x22:\x20\x22新名字\x22}`\x0a-\x20\x20\x20**改用户称呼**:\x20`{\x22type\x22:\x20\x22change_user_nickname\x22,\x20\x22new_name\x22:\x20\x22新称呼\x22}`\x0a-\x20\x20\x20**换自己头像**:\x20`{\x22type\x22:\x20\x22change_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从你头像库选)\x0a-\x20\x20\x20**换用户头像**:\x20`{\x22type\x22:\x20\x22change_user_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从用户头像库选)\x0a-\x20\x20\x20**回应好友申请**:\x20`{\x22type\x22:\x20\x22friend_request_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a-\x20\x20\x20**拉黑用户**:\x20`{\x22type\x22:\x20\x22block_user\x22}`\x0a\x0a###\x20特殊功能指令\x0a-\x20\x20\x20**记录回忆**:\x20`{\x22type\x22:\x20\x22create_memory\x22,\x20\x22description\x22:\x20\x22记录这件有意义的事。\x22}`\x0a-\x20\x20\x20**创建约定**:\x20`{\x22type\x22:\x20\x22create_countdown\x22,\x20\x22title\x22:\x20\x22约定标题\x22,\x20\x22date\x22:\x20\x22YYYY-MM-DDTHH:mm:ss\x22}`\x0a-\x20\x20\x20**切换歌曲**:\x20`{\x22type\x22:\x20\x22change_music\x22,\x20\x22song_name\x22:\x20\x22歌名\x22}`\x20(从播放列表选)\x0a-\x20\x20\x20**发起转账**:\x20`{\x22type\x22:\x20\x22transfer\x22,\x20\x22amount\x22:\x205.20,\x20\x22note\x22:\x20\x22备注\x22}`\x0a-\x20\x20\x20**回应转账**:\x20`{\x22type\x22:\x20\x22accept_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x20或\x20`{\x22type\x22:\x20\x22decline_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_request\x22,\x20\x22productInfo\x22:\x20\x22商品\x22,\x20\x22amount\x22:\x2025}`\x20(你想让【用户】帮你付钱时使用)\x0a-\x20\x20\x20**回应外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_response\x22,\x20\x22status\x22:\x20\x22paid\x22\x20or\x20\x22rejected\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起视频通话**:\x20`{\x22type\x22:\x20\x22video_call_request\x22}`\x0a-\x20\x20\x20**回应视频通话**:\x20`{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a\x0a\x0a#\x20对话者的角色设定\x0a'+_0x1487c2[_0x5528a0(0x2ea)][_0x5528a0(0xf75)]+'\x0a\x0a\x0a\x0a现在，请根据以上规则和下面的对话历史，继续进行对话。',_0x3fc754=_0x1a7a1f['map'](_0x1f35b3=>({'role':_0x1f35b3[_0x5528a0(0x16d)],'content':String(_0x1f35b3['content'])}));_0x3fc754['push']({'role':'user','content':_0x5528a0(0x8ee)});let _0x42a2de=_0xcc715b===GEMINI_API_URL,_0x116a18=_0x202ea1(_0x396c2c,_0x4dd4f9,_0x3b1cc6,_0x3fc754);const _0x227b89=_0x42a2de?await fetch(_0x116a18[_0x5528a0(0x11a)],_0x116a18[_0x5528a0(0xa78)]):await fetch(_0xcc715b+_0x5528a0(0x399),{'method':'POST','headers':{'Content-Type':_0x5528a0(0xd74),'Authorization':_0x5528a0(0xf20)+_0x4dd4f9},'body':JSON[_0x5528a0(0xd27)]({'model':_0x396c2c,'messages':[{'role':_0x5528a0(0x152),'content':_0x3b1cc6},..._0x3fc754],'temperature':_0x12493e['globalSettings']['apiTemperature']||0.8})});if(!_0x227b89['ok']){const _0x2729bb=await _0x227b89[_0x5528a0(0x79e)]();throw new Error('API\x20请求失败:\x20'+_0x2729bb[_0x5528a0(0x4d9)][_0x5528a0(0xf93)]);}const _0x58629b=await _0x227b89[_0x5528a0(0x79e)](),_0x34afd1=getGeminiResponseText(_0x58629b),_0x23c315=_0x4c5aa1(_0x34afd1),_0x1bdb40=[];for(const _0x2d7ffe of _0x23c315){if(_0x2d7ffe['type']===_0x5528a0(0x996)&&typeof _0x2d7ffe[_0x5528a0(0xcbd)]===_0x5528a0(0x9de)&&_0x2d7ffe['content'][_0x5528a0(0x1d4)]('\x0a')){const _0x5ad5d4=_0x2d7ffe['content'][_0x5528a0(0x8d7)](/\n+/)[_0x5528a0(0x1054)](_0x22524b=>_0x22524b[_0x5528a0(0x7da)]());_0x5ad5d4[_0x5528a0(0xd6a)](_0x147ac0=>{const _0xe400cd=_0x5528a0;_0x1bdb40[_0xe400cd(0x2d6)]({..._0x2d7ffe,'content':_0x147ac0});});}else _0x1bdb40['push'](_0x2d7ffe);}let _0x3b9cb5=Date[_0x5528a0(0x6ee)]();for(const _0x3454e1 of _0x1bdb40){const _0x10f422={'role':'assistant','senderName':_0x1487c2[_0x5528a0(0x776)],'timestamp':_0x3b9cb5++,'content':_0x3454e1['content']||_0x3454e1['message'],'type':_0x3454e1[_0x5528a0(0x52a)]||_0x5528a0(0x996)};if(_0x3454e1[_0x5528a0(0x52a)]===_0x5528a0(0xd32)){if(!_0x1487c2[_0x5528a0(0x80b)]){if(_0x3454e1[_0x5528a0(0xb66)])_0x1487c2[_0x5528a0(0x70a)]=String(_0x3454e1[_0x5528a0(0xb66)]);if(_0x3454e1['random_jottings'])_0x1487c2['randomJottings']=String(_0x3454e1[_0x5528a0(0x634)]);}continue;}_0x1487c2[_0x5528a0(0x1294)][_0x5528a0(0x2d6)](_0x10f422),_0x468ef0(_0x10f422,_0x1487c2),await new Promise(_0x2a2e33=>setTimeout(_0x2a2e33,Math[_0x5528a0(0xa11)]()*0x3e8+0x320));}await _0x2a2987[_0x5528a0(0xc45)][_0x5528a0(0xf36)](_0x1487c2),_0x597ed7();}catch(_0x1a2c99){console[_0x5528a0(0x4d9)](_0x5528a0(0xa6e),_0x1a2c99),await _0x2d7ddd('操作失败',_0x5528a0(0x10d5)+_0x1a2c99[_0x5528a0(0xf93)]);}finally{_0x15197e(_0x1487c2['id'],![]);if(!_0x1487c2[_0x5528a0(0x80b)]&&document[_0x5528a0(0xc33)](_0x5528a0(0x40c))){const _0x5b497c=document['getElementById'](_0x5528a0(0x40c));_0x5b497c['style']['opacity']=0x0,setTimeout(()=>{const _0x427b3e=_0x5528a0;_0x5b497c[_0x427b3e(0x11b0)]=_0x1487c2[_0x427b3e(0x578)],_0x5b497c[_0x427b3e(0x10d3)]['remove'](_0x427b3e(0x1201)),_0x5b497c[_0x427b3e(0x105d)][_0x427b3e(0x8d1)]=0x1;},0xc8);}}}function _0x52e066(){const _0x3370f3=_0x247bea,_0x1e8d21=document[_0x3370f3(0xc33)](_0x3370f3(0x19c)),_0x2b5d8d=_0x12493e[_0x3370f3(0x10f6)][_0x3370f3(0xc7)]||_0x29e2c5;_0x2b5d8d&&_0x2b5d8d[_0x3370f3(0x7da)]()&&(_0x1e8d21[_0x3370f3(0x87b)]=_0x2b5d8d,_0x1e8d21[_0x3370f3(0x193)]()[_0x3370f3(0x876)](_0x4750cd=>console[_0x3370f3(0x51f)]('播放被中断，这是正常行为:',_0x4750cd)));}function _0xa1bafb(){const _0x3945ab=_0x247bea;if(!_0x12493e[_0x3945ab(0x10f6)][_0x3945ab(0x28e)])return;for(const _0x2f49fa in _0x12493e[_0x3945ab(0x10f6)][_0x3945ab(0x28e)]){const _0x4f1268=document[_0x3945ab(0xc33)](_0x2f49fa),_0xef2729=_0x12493e['globalSettings'][_0x3945ab(0x28e)][_0x2f49fa];_0x4f1268&&(_0x4f1268['tagName']===_0x3945ab(0xf8c)?_0x4f1268[_0x3945ab(0x87b)]=_0xef2729:_0x4f1268[_0x3945ab(0x11b0)]=_0xef2729);}}function _0x4cf6c8(){return new Promise(_0x579cb9=>{const _0x46bfdf=_0x26e9,_0x5720d5=document[_0x46bfdf(0x1292)](_0x46bfdf(0x36e));_0x5720d5['type']=_0x46bfdf(0xfb2),_0x5720d5[_0x46bfdf(0x61b)]=_0x46bfdf(0xfcb),_0x5720d5[_0x46bfdf(0x4a4)]=_0x55a951=>{const _0x3d6664=_0x46bfdf,_0x2a0988=_0x55a951[_0x3d6664(0xe16)][_0x3d6664(0x1d0)][0x0];if(_0x2a0988){const _0x204c75=new FileReader();_0x204c75['onload']=_0x580fc5=>{const _0x45948d=_0x3d6664;_0x579cb9(_0x580fc5[_0x45948d(0xe16)][_0x45948d(0x129)]);},_0x204c75[_0x3d6664(0xbcf)](_0x2a0988);}else _0x579cb9(null);},_0x5720d5[_0x46bfdf(0x335)]();});}async function _0x2648fa(_0x58781a){const _0x21c969=_0x247bea,_0x3db71b=_0x58781a['id'],_0x43f54f=_0x58781a['textContent'],_0x5c81e6=await _0x1ca09c(_0x21c969(0x597),_0x21c969(0xbe1),_0x43f54f);if(_0x5c81e6!==null&&_0x5c81e6['trim']()!==''){const _0x4198e1=_0x5c81e6[_0x21c969(0x7da)]();_0x58781a[_0x21c969(0x11b0)]=_0x4198e1,_0x12493e[_0x21c969(0x10f6)][_0x21c969(0x28e)][_0x3db71b]=_0x4198e1,await _0x2a2987['globalSettings']['put'](_0x12493e[_0x21c969(0x10f6)]),alert('文字已更新！');}}async function _0x1c0fad(_0x227aad){const _0x7abf74=_0x247bea,_0x50d16a=_0x227aad['id'],_0x40d0f8=await _0x46f58a(_0x7abf74(0x119f),[{'text':'📁\x20从本地上传','value':'local'},{'text':_0x7abf74(0x10ac),'value':'url'}]);let _0x1e3c5e=null;if(_0x40d0f8===_0x7abf74(0xc06))_0x1e3c5e=await _0x4cf6c8();else _0x40d0f8===_0x7abf74(0x11a)&&(_0x1e3c5e=await _0x1ca09c(_0x7abf74(0x119f),_0x7abf74(0x6f1),_0x227aad['src'],_0x7abf74(0x11a)));if(_0x1e3c5e&&_0x1e3c5e['trim']()){const _0xe40a0d=_0x1e3c5e[_0x7abf74(0x7da)]();_0x227aad[_0x7abf74(0x87b)]=_0xe40a0d,_0x12493e[_0x7abf74(0x10f6)][_0x7abf74(0x28e)][_0x50d16a]=_0xe40a0d,await _0x2a2987[_0x7abf74(0x10f6)]['put'](_0x12493e[_0x7abf74(0x10f6)]),alert(_0x7abf74(0x1164));}else _0x40d0f8===_0x7abf74(0x11a)&&_0x1e3c5e!==null&&alert(_0x7abf74(0x8c));}const _0x259332={'getSongCache'(_0x11b588,_0x7a294b){const _0x123469=_0x247bea,_0x2d93e8=(_0x7a294b||'all')+':'+_0x11b588;if(_0x12493e[_0x123469(0x280)]&&_0x12493e[_0x123469(0x280)][_0x123469(0x9a7)]){const _0x38157c=_0x12493e['cache']['songs'][_0x123469(0xec0)](_0x2d93e8);if(_0x38157c&&Date['now']()-_0x38157c[_0x123469(0x2f0)]<0x36ee80)return _0x38157c[_0x123469(0xa78)];}return null;},'setSongCache'(_0x4abd57,_0x2ca688,_0x2541b1){const _0x1de4c6=_0x247bea,_0x5c5e5e=(_0x2541b1||_0x1de4c6(0x5c8))+':'+_0x4abd57;if(!_0x12493e[_0x1de4c6(0x280)])_0x12493e[_0x1de4c6(0x280)]={};if(!_0x12493e[_0x1de4c6(0x280)][_0x1de4c6(0x9a7)])_0x12493e[_0x1de4c6(0x280)][_0x1de4c6(0x9a7)]=new Map();_0x12493e[_0x1de4c6(0x280)][_0x1de4c6(0x9a7)][_0x1de4c6(0xdf)](_0x5c5e5e,{'data':_0x2ca688,'timestamp':Date[_0x1de4c6(0x6ee)]()});}};typeof Http_Get_External==='undefined'&&(window['Http_Get_External']=function(_0x49467a){return new Promise(_0x1d7c10=>{const _0x581dbf=_0x26e9;fetch(_0x49467a)[_0x581dbf(0x5d2)](_0x18fd9e=>_0x18fd9e['json']()[_0x581dbf(0x876)](()=>_0x18fd9e[_0x581dbf(0x996)]()))[_0x581dbf(0x5d2)](_0x1d7c10)[_0x581dbf(0x876)](()=>_0x1d7c10(null));});});async function _0x4e4fc7(_0x599edf){return await Http_Get_External(_0x599edf);}function _0x2b35a1(_0x3840b4){return new Promise(_0x37e996=>{const _0x2a6786=_0x26e9,_0xae2591=new Audio();_0xae2591[_0x2a6786(0x205)](_0x2a6786(0x411),()=>_0x37e996(!![]),{'once':!![]}),_0xae2591[_0x2a6786(0x205)](_0x2a6786(0x4d9),()=>_0x37e996(![]),{'once':!![]}),_0xae2591[_0x2a6786(0x87b)]=_0x3840b4;});}async function _0x76ab06(_0x5e5e60,_0x56778a){const _0x35dee2=_0x247bea;try{let _0x54d390=_0x5e5e60[_0x35dee2(0xc12)](/\s/g,'');_0x56778a&&(_0x54d390+='\x20'+_0x56778a[_0x35dee2(0xc12)](/\s/g,''));const _0x51df8e=_0x35dee2(0xcfe)+encodeURIComponent(_0x54d390);console['log'](_0x35dee2(0xf46),_0x51df8e);const _0x194ec0=await fetch(_0x51df8e);if(!_0x194ec0['ok'])throw new Error(_0x35dee2(0xd7d)+_0x194ec0['status']);const _0x44fddc=await _0x194ec0[_0x35dee2(0x79e)]();if(_0x44fddc[_0x35dee2(0x567)]!==0xc8||!_0x44fddc[_0x35dee2(0xa78)]||_0x44fddc[_0x35dee2(0xa78)][_0x35dee2(0x79b)]===0x0)return console[_0x35dee2(0x51f)]('网易云音乐API未返回有效结果:',_0x44fddc),[];return _0x44fddc[_0x35dee2(0xa78)][_0x35dee2(0x9d5)](_0x17d509=>({'name':_0x17d509['song'],'artist':_0x17d509[_0x35dee2(0xf26)],'id':_0x17d509['id'],'cover':_0x17d509[_0x35dee2(0xd87)]||_0x35dee2(0x4e7),'source':_0x35dee2(0x1188)}))[_0x35dee2(0x111c)](0x0,0x1e);}catch(_0x4cb9ec){return console['error']('网易云音乐搜索失败:',_0x4cb9ec),[];}}async function _0x1c6c06(_0x1c6a40){const _0x16936e=_0x247bea;try{_0x1c6a40=_0x1c6a40['replace'](/\s/g,'');const _0x7ec339=await _0x4e4fc7('https://api.vkeys.cn/v2/music/tencent?word='+encodeURIComponent(_0x1c6a40));if(!_0x7ec339?.[_0x16936e(0xa78)]?.[_0x16936e(0x79b)])return[];return _0x7ec339['data'][_0x16936e(0x9d5)](_0x4c7a55=>({'name':_0x4c7a55['song'],'artist':_0x4c7a55[_0x16936e(0xf26)],'id':_0x4c7a55['id'],'cover':_0x4c7a55[_0x16936e(0xd87)]||_0x16936e(0x35f),'source':_0x16936e(0x942)}))[_0x16936e(0x111c)](0x0,0x1e);}catch(_0x467d39){return console['error']('QQ音乐搜索API失败:',_0x467d39),[];}}async function _0xf8308a(){const _0x32957c=_0x247bea,_0x97c66c=await _0x1ca09c(_0x32957c(0x9be),_0x32957c(0xab1));if(!_0x97c66c||!_0x97c66c[_0x32957c(0x7da)]())return;await _0x2d7ddd(_0x32957c(0xb37),_0x32957c(0xe07));let _0x5e2893=_0x97c66c[_0x32957c(0x7da)](),_0x4d5abb='';if(_0x97c66c['includes']('-')||_0x97c66c[_0x32957c(0x1d4)]('–')){const _0x187357=_0x97c66c[_0x32957c(0x8d7)](/[-–]/);_0x5e2893=_0x187357[0x0][_0x32957c(0x7da)](),_0x4d5abb=_0x187357[_0x32957c(0x111c)](0x1)[_0x32957c(0x100b)]('\x20')[_0x32957c(0x7da)]();}const [_0xd4ae34,_0x20cb74]=await Promise['all']([_0x76ab06(_0x5e2893,_0x4d5abb),_0x1c6c06(_0x5e2893)]),_0x527e82=[..._0xd4ae34,..._0x20cb74];if(_0x527e82[_0x32957c(0x79b)]===0x0){await _0x2d7ddd(_0x32957c(0x816),_0x32957c(0x444));return;}const _0x57514a=document[_0x32957c(0xc33)]('music-search-results-modal'),_0x51ad38=document[_0x32957c(0xc33)](_0x32957c(0x971));_0x51ad38[_0x32957c(0x102a)]='',document[_0x32957c(0xc33)](_0x32957c(0xc1a))[_0x32957c(0x737)]=![],_0x527e82[_0x32957c(0xd6a)](_0x1671cf=>{const _0x30f0cd=_0x32957c,_0x25ff44=document[_0x30f0cd(0x1292)](_0x30f0cd(0x58c));_0x25ff44[_0x30f0cd(0x84)]=_0x30f0cd(0xd89),_0x25ff44[_0x30f0cd(0x85)][_0x30f0cd(0x58e)]=JSON[_0x30f0cd(0xd27)](_0x1671cf),_0x25ff44[_0x30f0cd(0x102a)]=_0x30f0cd(0x114e)+_0x1671cf[_0x30f0cd(0x578)]+_0x30f0cd(0x631)+_0x1671cf[_0x30f0cd(0x200)]+'\x20<span\x20class=\x22source\x22>'+(_0x1671cf[_0x30f0cd(0x127c)]==='netease'?_0x30f0cd(0x515):'QQ音乐')+_0x30f0cd(0x2d5),_0x51ad38[_0x30f0cd(0xf77)](_0x25ff44);}),_0x57514a['classList'][_0x32957c(0xb9)]('visible');}async function _0x38a376(_0x34bffc){const _0x47a278=_0x247bea;let _0x46feab=null,_0x2cc70c=_0x34bffc[_0x47a278(0x127c)];const _0x1b1d53=_0x34bffc[_0x47a278(0x127c)]==='netease'?'https://api.vkeys.cn/v2/music/netease?id='+_0x34bffc['id']:_0x47a278(0x42e)+_0x34bffc['id'];let _0x4383ae=await _0x4e4fc7(_0x1b1d53);_0x4383ae?.['data']?.['url']&&(_0x46feab={'url':_0x4383ae[_0x47a278(0xa78)]['url'],'id':_0x34bffc['id'],'source':_0x34bffc['source']});if(!_0x46feab){const _0x918981=_0x34bffc[_0x47a278(0x127c)]==='netease'?_0x47a278(0x942):_0x47a278(0x1188),_0x5887f3=_0x918981===_0x47a278(0x942)?await _0x1c6c06(_0x34bffc[_0x47a278(0x578)]):await _0x76ab06(_0x34bffc['name'],_0x34bffc[_0x47a278(0x200)]);if(_0x5887f3[_0x47a278(0x79b)]>0x0){const _0x4bc284=_0x918981==='netease'?_0x47a278(0xd11)+_0x5887f3[0x0]['id']:_0x47a278(0x42e)+_0x5887f3[0x0]['id'],_0x102855=await _0x4e4fc7(_0x4bc284);_0x102855?.[_0x47a278(0xa78)]?.[_0x47a278(0x11a)]&&(_0x46feab={'url':_0x102855['data']['url'],'id':_0x5887f3[0x0]['id'],'source':_0x918981},_0x2cc70c=_0x918981);}}if(_0x46feab){_0x46feab[_0x47a278(0x11a)]&&typeof _0x46feab[_0x47a278(0x11a)]===_0x47a278(0x9de)&&(_0x46feab[_0x47a278(0x11a)]=_0x46feab[_0x47a278(0x11a)][_0x47a278(0xc12)](/^http:\/\//i,_0x47a278(0x1118)));_0x34bffc[_0x47a278(0xd87)]&&typeof _0x34bffc[_0x47a278(0xd87)]===_0x47a278(0x9de)&&(_0x34bffc[_0x47a278(0xd87)]=_0x34bffc[_0x47a278(0xd87)]['replace'](/^http:\/\//i,_0x47a278(0x1118)));const _0x2eaf85=await _0x313330(_0x46feab['id'],_0x2cc70c)||'';return{'name':_0x34bffc[_0x47a278(0x578)],'artist':_0x34bffc[_0x47a278(0x200)],'src':_0x46feab[_0x47a278(0x11a)],'cover':_0x34bffc[_0x47a278(0xd87)],'isLocal':![],'lrcContent':_0x2eaf85};}return null;}async function _0x313330(_0x2fe79b,_0x5a0dfd){const _0x47ea1e=_0x247bea,_0x4a9318=_0x5a0dfd===_0x47ea1e(0x1188)?_0x47ea1e(0x710)+_0x2fe79b:'https://api.vkeys.cn/v2/music/tencent/lyric?id='+_0x2fe79b,_0x3f10e3=await _0x4e4fc7(_0x4a9318);if(_0x3f10e3?.[_0x47ea1e(0xa78)]){const _0x2b7465=_0x3f10e3['data'][_0x47ea1e(0x65e)]||_0x3f10e3[_0x47ea1e(0xa78)]['lyric']||'',_0x43f863=_0x3f10e3['data'][_0x47ea1e(0x266)]||_0x3f10e3[_0x47ea1e(0xa78)][_0x47ea1e(0x89e)]||'';return _0x2b7465+'\x0a'+_0x43f863;}return'';}async function _0x30aad1(_0xc2c348){const _0x32dd95=_0x247bea;if(_0xc2c348<0x0||_0xc2c348>=_0x5ebb31[_0x32dd95(0xd9f)]['length'])return;const _0x412a25=await _0x46f58a(_0x32dd95(0x979),[{'text':_0x32dd95(0x11cf),'value':_0x32dd95(0xfb2)},{'text':_0x32dd95(0x46f),'value':_0x32dd95(0x64d)}]);let _0x2aa5e3=null;if(_0x412a25===_0x32dd95(0xfb2))_0x2aa5e3=await new Promise(_0xe47342=>{const _0x2048a5=_0x32dd95,_0x593f6e=document[_0x2048a5(0xc33)](_0x2048a5(0x341)),_0x1716c1=_0x343ce5=>{const _0x3e0e91=_0x2048a5,_0x366a29=_0x343ce5[_0x3e0e91(0xe16)]['files'][0x0];if(_0x366a29){const _0x31e856=new FileReader();_0x31e856[_0x3e0e91(0x833)]=_0x485b7d=>_0xe47342(_0x485b7d[_0x3e0e91(0xe16)][_0x3e0e91(0x129)]),_0x31e856[_0x3e0e91(0x6e0)]=()=>_0xe47342(null),_0x31e856['readAsText'](_0x366a29);}else _0xe47342(null);_0x593f6e[_0x3e0e91(0xb52)](_0x3e0e91(0x644),_0x1716c1),_0x593f6e[_0x3e0e91(0x22a)]='';};_0x593f6e[_0x2048a5(0x205)](_0x2048a5(0x644),_0x1716c1,{'once':!![]}),_0x593f6e[_0x2048a5(0x335)]();});else{if(_0x412a25===_0x32dd95(0x64d)){const _0xd56da9=await _0x1ca09c(_0x32dd95(0x913),'请在此处粘贴完整的LRC格式歌词...','',_0x32dd95(0x89c));if(_0xd56da9)_0x2aa5e3=_0xd56da9[_0x32dd95(0xc12)](/\[/g,'\x0a[')[_0x32dd95(0x7da)]();}}_0x2aa5e3!==null&&(_0x5ebb31[_0x32dd95(0xd9f)][_0xc2c348][_0x32dd95(0x99c)]=_0x2aa5e3,await _0x83d626(),_0x5ebb31[_0x32dd95(0x12a0)]===_0xc2c348&&(_0x5ebb31[_0x32dd95(0x1ca)]=_0x35419b(_0x2aa5e3),_0x409a99(),_0x107a33()),await _0x2d7ddd('成功','《'+_0x5ebb31[_0x32dd95(0xd9f)][_0xc2c348][_0x32dd95(0x578)]+_0x32dd95(0x4af)));}async function _0x4beaad(){const _0x2930cf=_0x247bea;if(_0x5ebb31['currentIndex']===-0x1)return;const _0x39c24f=_0x5ebb31[_0x2930cf(0xd9f)][_0x5ebb31[_0x2930cf(0x12a0)]];if(!_0x39c24f)return;_0x39c24f[_0x2930cf(0xef4)]=!_0x39c24f[_0x2930cf(0xef4)],await _0x83d626();const _0x50e4bb=document[_0x2930cf(0x977)](_0x2930cf(0x6a4)),_0x340347=document[_0x2930cf(0xc33)]('toggle-blur-btn');_0x50e4bb[_0x2930cf(0x10d3)][_0x2930cf(0xe2c)](_0x2930cf(0x8c2),_0x39c24f[_0x2930cf(0xef4)]),_0x340347[_0x2930cf(0x10d3)][_0x2930cf(0xe2c)](_0x2930cf(0x1043),_0x39c24f[_0x2930cf(0xef4)]);}function _0x5b4c6f(){const _0x4f0cc6=_0x247bea,_0x43f6f2=document['getElementById'](_0x4f0cc6(0xcd6)),_0x585628=document['getElementById']('show-avatars-btn');_0x43f6f2&&_0x585628&&(_0x43f6f2['classList'][_0x4f0cc6(0xe2c)](_0x4f0cc6(0x143)),_0x585628['classList']['toggle']('active'));}function _0x8d1db6(){const _0x32b05e=_0x247bea,_0x436498=document[_0x32b05e(0x977)]('.music-player-window'),_0x3aa248=document[_0x32b05e(0xc33)](_0x32b05e(0x390));_0x436498&&_0x3aa248&&(_0x436498[_0x32b05e(0x10d3)][_0x32b05e(0xe2c)](_0x32b05e(0x925)),_0x3aa248['classList']['toggle'](_0x32b05e(0x3ed)));}window[_0x247bea(0x210)]=_0x8d1db6;async function _0x580c13(){const _0x15fcb2=_0x247bea;if(_0x5ebb31[_0x15fcb2(0xd9f)]['length']===0x0){alert(_0x15fcb2(0x951));return;}const _0x52d4d2=await _0x270512(_0x15fcb2(0x4a2),_0x15fcb2(0xc77),{'confirmText':_0x15fcb2(0x664)});if(!_0x52d4d2)return;await _0x2d7ddd(_0x15fcb2(0xb37),_0x15fcb2(0x1147)+_0x5ebb31[_0x15fcb2(0xd9f)][_0x15fcb2(0x79b)]+_0x15fcb2(0xfd3));const _0x5715b7=_0x5ebb31[_0x15fcb2(0xd9f)][_0x15fcb2(0x79b)],_0xa83c9=[],_0x486aa4=[],_0x2632b1=_0x5ebb31[_0x15fcb2(0xd9f)][_0x15fcb2(0x9d5)](async _0x453d98=>{const _0x1764b7=_0x15fcb2;if(_0x453d98[_0x1764b7(0x616)]){_0xa83c9['push'](_0x453d98);return;}const _0x3f05fb=await _0x2b35a1(_0x453d98[_0x1764b7(0x87b)]);_0x3f05fb?_0xa83c9['push'](_0x453d98):(_0x486aa4[_0x1764b7(0x2d6)](_0x453d98[_0x1764b7(0x578)]),console[_0x1764b7(0x54a)](_0x1764b7(0x908)+_0x453d98['name']+'\x20-\x20'+_0x453d98[_0x1764b7(0x87b)]));});await Promise['all'](_0x2632b1);const _0xe0b2ca=_0x5715b7-_0xa83c9[_0x15fcb2(0x79b)];if(_0xe0b2ca>0x0){const _0x4c133c=_0x5ebb31[_0x15fcb2(0xd9f)][_0x5ebb31[_0x15fcb2(0x12a0)]],_0x133b29=_0x486aa4['includes'](_0x4c133c?.[_0x15fcb2(0x578)]);_0x5ebb31[_0x15fcb2(0xd9f)]=_0xa83c9,await _0x83d626();if(_0x133b29)_0x3ced3a[_0x15fcb2(0x47a)](),_0x3ced3a[_0x15fcb2(0x87b)]='',_0x5ebb31[_0x15fcb2(0x12a0)]=_0x5ebb31[_0x15fcb2(0xd9f)][_0x15fcb2(0x79b)]>0x0?0x0:-0x1,_0x5ebb31['isPlaying']=![];else _0x4c133c&&(_0x5ebb31[_0x15fcb2(0x12a0)]=_0x5ebb31[_0x15fcb2(0xd9f)]['findIndex'](_0x3dfcf7=>_0x3dfcf7['src']===_0x4c133c[_0x15fcb2(0x87b)]));_0x596fed(),_0x246e79(),await _0x2d7ddd(_0x15fcb2(0x10fc),'成功移除了\x20'+_0xe0b2ca+_0x15fcb2(0x514)+_0x486aa4[_0x15fcb2(0x100b)](_0x15fcb2(0x110f)));}else await _0x2d7ddd(_0x15fcb2(0x683),'所有歌曲链接均有效，无需清理！');}function _0xadc4e(){const _0x42cac8=_0x247bea,_0xfced23=document['getElementById'](_0x42cac8(0x779));_0xfced23['classList'][_0x42cac8(0xe2c)](_0x42cac8(0x5bc),!!_0x12493e['globalSettings']['showStatusBar']);}async function _0x46d4b5(){const _0x56f4a1=_0x247bea,_0x1a6d1c=document[_0x56f4a1(0xc33)](_0x56f4a1(0xf57)),_0x5e9276=document[_0x56f4a1(0xc33)](_0x56f4a1(0x65d));_0x5e9276[_0x56f4a1(0x102a)]='';const _0x573073=[];_0x573073[_0x56f4a1(0x2d6)]({'text':_0x56f4a1(0x88c),'value':_0x56f4a1(0x5c8),'isDanger':!![]});const _0x3b06b7=_0x12493e[_0x56f4a1(0x76c)][_0x56f4a1(0x66a)]||'我';_0x573073[_0x56f4a1(0x2d6)]({'text':_0x56f4a1(0x118)+_0x3b06b7+_0x56f4a1(0x620),'value':'user'}),Object[_0x56f4a1(0xd28)](_0x12493e[_0x56f4a1(0xc45)])[_0x56f4a1(0xd6a)](_0x1299c5=>{const _0x5b25dc=_0x56f4a1;!_0x1299c5[_0x5b25dc(0x80b)]&&_0x573073[_0x5b25dc(0x2d6)]({'text':_0x5b25dc(0x118)+_0x1299c5[_0x5b25dc(0x578)]+_0x5b25dc(0x5a5),'value':_0x1299c5['id']});});try{const _0x5b17ac=await _0x2a2987['npcs']['toArray']();_0x5b17ac[_0x56f4a1(0x79b)]>0x0&&(_0x573073[_0x56f4a1(0x2d6)]({'isSeparator':!![],'text':_0x56f4a1(0x3c5)}),_0x5b17ac[_0x56f4a1(0xd6a)](_0x4e4d34=>{const _0x273fab=_0x56f4a1;_0x573073[_0x273fab(0x2d6)]({'text':_0x273fab(0x118)+_0x4e4d34[_0x273fab(0x578)]+_0x273fab(0x8a7),'value':_0x273fab(0xb90)+_0x4e4d34['id']});}));}catch(_0x3fdc09){console[_0x56f4a1(0x4d9)]('加载NPC列表失败:',_0x3fdc09);}_0x573073[_0x56f4a1(0xd6a)](_0x41cfed=>{const _0x4cdb53=_0x56f4a1;if(_0x41cfed['isSeparator']){const _0x1204fe=document[_0x4cdb53(0x1292)]('div');_0x1204fe['textContent']=_0x41cfed['text'],_0x1204fe[_0x4cdb53(0x105d)][_0x4cdb53(0x4c1)]=_0x4cdb53(0x11d6),_0x5e9276[_0x4cdb53(0xf77)](_0x1204fe);return;}const _0x18bbdd=document[_0x4cdb53(0x1292)]('div');_0x18bbdd['className']='clear-posts-item',_0x41cfed[_0x4cdb53(0x83e)]&&_0x18bbdd['classList'][_0x4cdb53(0xb9)](_0x4cdb53(0x22f)),_0x18bbdd[_0x4cdb53(0x85)]['targetId']=_0x41cfed[_0x4cdb53(0x22a)],_0x18bbdd[_0x4cdb53(0x102a)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x41cfed[_0x4cdb53(0x996)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x5e9276[_0x4cdb53(0xf77)](_0x18bbdd);}),_0x1a6d1c[_0x56f4a1(0x10d3)][_0x56f4a1(0xb9)](_0x56f4a1(0x143));}async function _0x5ccb2b(){const _0xde223=_0x247bea,_0x480c62=document['querySelectorAll'](_0xde223(0xa8c));if(_0x480c62[_0xde223(0x79b)]===0x0){alert('请至少选择一个要清空的范围。');return;}const _0x10713f=Array[_0xde223(0x301)](_0x480c62)[_0xde223(0x9d5)](_0x4aaee1=>_0x4aaee1[_0xde223(0x85)][_0xde223(0x105c)]);let _0x4b41f3=[];_0x10713f[_0xde223(0x1d4)]('all')?_0x4b41f3[_0xde223(0x2d6)](_0xde223(0xf17)):(_0x10713f[_0xde223(0x1d4)]('user')&&_0x4b41f3['push']('“'+_0x12493e[_0xde223(0x76c)][_0xde223(0x66a)]+'”'),_0x10713f[_0xde223(0xd6a)](_0x58b87a=>{const _0x25e068=_0xde223,_0x82dd22=_0x12493e[_0x25e068(0xc45)][_0x58b87a];_0x82dd22&&_0x4b41f3[_0x25e068(0x2d6)]('“'+_0x82dd22[_0x25e068(0x578)]+'”');}));const _0x1f8b6a=_0xde223(0x313)+_0x4b41f3[_0xde223(0x100b)]('、\x20')+'\x20的所有动态，且无法恢复！',_0x91c434=await _0x270512(_0xde223(0x1f7),_0x1f8b6a,{'confirmButtonClass':_0xde223(0xa2),'confirmText':_0xde223(0x287)});if(!_0x91c434)return;try{_0x10713f[_0xde223(0x1d4)]('all')?await _0x2a2987[_0xde223(0x110b)][_0xde223(0xebb)]():await _0x2a2987['qzonePosts'][_0xde223(0x8b5)]('authorId')[_0xde223(0x6b8)](_0x10713f)[_0xde223(0x9ea)](),_0x2c7a9f=await _0x2a2987['qzonePosts']['orderBy'](_0xde223(0x2f0))[_0xde223(0xc07)]()['toArray'](),_0x291a6f=0x0,await _0x14f3b0(),document[_0xde223(0xc33)]('clear-posts-modal')['classList'][_0xde223(0x2c7)](_0xde223(0x143)),await _0x2d7ddd(_0xde223(0x154),_0xde223(0x26a));}catch(_0x5af519){console['error'](_0xde223(0x36b),_0x5af519),await _0x2d7ddd(_0xde223(0xb9d),_0xde223(0xe03)+_0x5af519['message']);}}async function _0x54c987(_0x455e8b){const _0x1dca10=_0x247bea,_0xd77b32=await _0x270512('确认删除',_0x1dca10(0x3d3),{'confirmButtonClass':_0x1dca10(0xa2),'confirmText':'确认删除'});if(_0xd77b32){const _0x4451a1=_0x12493e[_0x1dca10(0xc45)][_0x12493e['activeChatId']];if(!_0x4451a1||!_0x4451a1[_0x1dca10(0x11e9)])return;const _0x305d53=_0x4451a1['thoughtsHistory'][_0x1dca10(0xce9)](_0x8c99d=>_0x8c99d[_0x1dca10(0x2f0)]===_0x455e8b);if(_0x305d53===-0x1)return;const _0x368783=_0x305d53===_0x4451a1['thoughtsHistory'][_0x1dca10(0x79b)]-0x1;_0x4451a1[_0x1dca10(0x11e9)]=_0x4451a1[_0x1dca10(0x11e9)][_0x1dca10(0x1054)](_0x314f5d=>_0x314f5d[_0x1dca10(0x2f0)]!==_0x455e8b);if(_0x368783){if(_0x4451a1[_0x1dca10(0x11e9)][_0x1dca10(0x79b)]>0x0){const _0x275624=_0x4451a1[_0x1dca10(0x11e9)][_0x4451a1['thoughtsHistory'][_0x1dca10(0x79b)]-0x1];_0x4451a1['heartfeltVoice']=_0x275624[_0x1dca10(0x70a)],_0x4451a1['randomJottings']=_0x275624[_0x1dca10(0xb53)];const _0x18fdb2=document[_0x1dca10(0xc33)](_0x1dca10(0x44f)),_0x2a77b4=document[_0x1dca10(0xc33)](_0x1dca10(0xc3d));if(_0x18fdb2)_0x18fdb2[_0x1dca10(0x11b0)]=_0x4451a1[_0x1dca10(0x70a)];if(_0x2a77b4)_0x2a77b4[_0x1dca10(0x11b0)]=_0x4451a1['randomJottings'];console[_0x1dca10(0x51f)](_0x1dca10(0x67f));}else{_0x4451a1[_0x1dca10(0x70a)]=_0x1dca10(0xda0),_0x4451a1[_0x1dca10(0xb53)]=_0x1dca10(0xda0);const _0x184fb5=document[_0x1dca10(0xc33)](_0x1dca10(0x44f)),_0x127c98=document[_0x1dca10(0xc33)](_0x1dca10(0xc3d));if(_0x184fb5)_0x184fb5[_0x1dca10(0x11b0)]=_0x4451a1[_0x1dca10(0x70a)];if(_0x127c98)_0x127c98['textContent']=_0x4451a1['randomJottings'];console[_0x1dca10(0x51f)](_0x1dca10(0x105));}}await _0x2a2987[_0x1dca10(0xc45)][_0x1dca10(0xf36)](_0x4451a1),_0x2d1b8f(),await _0x2d7ddd('成功','该条记录已成功删除。');}}document[_0x247bea(0xc33)](_0x247bea(0xa1c))['addEventListener'](_0x247bea(0x335),_0x4e903=>{const _0xe3cee6=_0x247bea,_0x168118=_0x4e903[_0xe3cee6(0xe16)][_0xe3cee6(0x7a7)](_0xe3cee6(0x55e));if(_0x168118){const _0x42ee80=parseInt(_0x168118[_0xe3cee6(0x85)][_0xe3cee6(0x2f0)]);!isNaN(_0x42ee80)&&_0x54c987(_0x42ee80);}});async function _0x376ae7(){const _0x4f8748=_0x247bea,_0x323598=document[_0x4f8748(0xc33)](_0x4f8748(0xff6));_0x323598['innerHTML']=_0x4f8748(0x447);const _0x3abc78=await _0x2a2987[_0x4f8748(0x647)][_0x4f8748(0x8b5)](_0x4f8748(0x52a))[_0x4f8748(0x10bd)](_0x4f8748(0x788))['toArray']();_0x3abc78[_0x4f8748(0xd6a)](_0x2430f6=>{const _0x308d65=_0x4f8748,_0x3bc3a0=document[_0x308d65(0x1292)](_0x308d65(0x2f6));_0x3bc3a0[_0x308d65(0x22a)]=_0x2430f6['id'],_0x3bc3a0[_0x308d65(0x11b0)]=_0x2430f6[_0x308d65(0x578)],_0x323598[_0x308d65(0xf77)](_0x3bc3a0);});}async function _0x5ba4e2(){const _0x45c36e=_0x247bea,_0x274b16=document[_0x45c36e(0xc33)](_0x45c36e(0xff6)),_0x38c0cd=parseInt(_0x274b16[_0x45c36e(0x22a)]);if(isNaN(_0x38c0cd))return;const _0x1625e9=await _0x2a2987[_0x45c36e(0x647)][_0x45c36e(0xec0)](_0x38c0cd);if(_0x1625e9){const _0x5bcffa=document['getElementById']('global-css-input');_0x5bcffa[_0x45c36e(0x22a)]=_0x1625e9['value'],_0x3e472a(_0x1625e9[_0x45c36e(0x22a)]);}}async function _0x18df66(){const _0x1311d1=_0x247bea,_0x2f5902=await _0x1ca09c(_0x1311d1(0xc5c),_0x1311d1(0x3da));if(!_0x2f5902||!_0x2f5902['trim']())return;const _0x1f6b5a=document['getElementById'](_0x1311d1(0x85c))['value'],_0x579a6f=await _0x2a2987['appearancePresets']['where']({'name':_0x2f5902['trim'](),'type':_0x1311d1(0x788)})[_0x1311d1(0x4e3)]();if(_0x579a6f){const _0x441de4=await _0x270512(_0x1311d1(0x1295),_0x1311d1(0xc85)+_0x2f5902[_0x1311d1(0x7da)]()+_0x1311d1(0xeb5),{'confirmButtonClass':_0x1311d1(0xa2)});if(!_0x441de4)return;await _0x2a2987[_0x1311d1(0x647)][_0x1311d1(0xb07)](_0x579a6f['id'],{'value':_0x1f6b5a});}else await _0x2a2987[_0x1311d1(0x647)][_0x1311d1(0xb9)]({'name':_0x2f5902[_0x1311d1(0x7da)](),'type':_0x1311d1(0x788),'value':_0x1f6b5a});await _0x376ae7(),alert(_0x1311d1(0xa79));}async function _0x51004b(){const _0x4ccbc4=_0x247bea,_0x30c681=document[_0x4ccbc4(0xc33)](_0x4ccbc4(0xff6)),_0x1e73ab=parseInt(_0x30c681[_0x4ccbc4(0x22a)]);if(isNaN(_0x1e73ab)){alert(_0x4ccbc4(0x954));return;}const _0x42088d=await _0x2a2987[_0x4ccbc4(0x647)][_0x4ccbc4(0xec0)](_0x1e73ab);if(!_0x42088d)return;const _0x544427=await _0x270512(_0x4ccbc4(0x5a0),_0x4ccbc4(0x11e0)+_0x42088d[_0x4ccbc4(0x578)]+'”\x20吗？',{'confirmButtonClass':_0x4ccbc4(0xa2)});_0x544427&&(await _0x2a2987[_0x4ccbc4(0x647)]['delete'](_0x1e73ab),await _0x376ae7(),alert('预设已删除。'));}async function _0x149dea(){const _0x25b9cc=_0x247bea,_0x2b3786=document[_0x25b9cc(0xc33)]('font-preset-select');_0x2b3786[_0x25b9cc(0x102a)]=_0x25b9cc(0x447);const _0x1eaffa=await _0x2a2987['appearancePresets'][_0x25b9cc(0x8b5)]('type')[_0x25b9cc(0x10bd)]('font')['toArray']();_0x1eaffa[_0x25b9cc(0xd6a)](_0x449a55=>{const _0x130ecf=_0x25b9cc,_0x366e09=document[_0x130ecf(0x1292)]('option');_0x366e09[_0x130ecf(0x22a)]=_0x449a55['id'],_0x366e09[_0x130ecf(0x11b0)]=_0x449a55[_0x130ecf(0x578)],_0x2b3786['appendChild'](_0x366e09);});}async function _0x885494(){const _0x3c11a7=_0x247bea,_0x17814f=document[_0x3c11a7(0xc33)](_0x3c11a7(0xa3d)),_0x2772ce=parseInt(_0x17814f[_0x3c11a7(0x22a)]);if(isNaN(_0x2772ce))return;const _0x1f8a3f=await _0x2a2987['appearancePresets'][_0x3c11a7(0xec0)](_0x2772ce);if(_0x1f8a3f){const _0x506fe3=document[_0x3c11a7(0xc33)](_0x3c11a7(0xf1c));_0x506fe3['value']=_0x1f8a3f[_0x3c11a7(0x22a)],_0x2e1ac4(_0x1f8a3f[_0x3c11a7(0x22a)],!![]);}}async function _0x11e789(){const _0x52f4ef=_0x247bea,_0x598980=await _0x1ca09c(_0x52f4ef(0x1031),_0x52f4ef(0x3da));if(!_0x598980||!_0x598980[_0x52f4ef(0x7da)]())return;const _0x42289d=document['getElementById']('font-url-input')[_0x52f4ef(0x22a)][_0x52f4ef(0x7da)]();if(!_0x42289d){alert(_0x52f4ef(0xd33));return;}const _0x1fe4f4=await _0x2a2987[_0x52f4ef(0x647)][_0x52f4ef(0x8b5)]({'name':_0x598980[_0x52f4ef(0x7da)](),'type':_0x52f4ef(0xf50)})[_0x52f4ef(0x4e3)]();if(_0x1fe4f4){const _0x41064a=await _0x270512('覆盖预设',_0x52f4ef(0xc85)+_0x598980['trim']()+_0x52f4ef(0xeb5),{'confirmButtonClass':_0x52f4ef(0xa2)});if(!_0x41064a)return;await _0x2a2987[_0x52f4ef(0x647)]['update'](_0x1fe4f4['id'],{'value':_0x42289d});}else await _0x2a2987[_0x52f4ef(0x647)][_0x52f4ef(0xb9)]({'name':_0x598980[_0x52f4ef(0x7da)](),'type':'font','value':_0x42289d});await _0x149dea(),alert(_0x52f4ef(0x3c0));}async function _0x5956c7(){const _0x3d25bb=_0x247bea,_0x46cda4=document[_0x3d25bb(0xc33)]('font-preset-select'),_0x377bc5=parseInt(_0x46cda4['value']);if(isNaN(_0x377bc5)){alert(_0x3d25bb(0x954));return;}const _0x4c8af2=await _0x2a2987['appearancePresets'][_0x3d25bb(0xec0)](_0x377bc5);if(!_0x4c8af2)return;const _0x2e8941=await _0x270512('删除预设',_0x3d25bb(0x11e0)+_0x4c8af2[_0x3d25bb(0x578)]+_0x3d25bb(0x3be),{'confirmButtonClass':_0x3d25bb(0xa2)});_0x2e8941&&(await _0x2a2987['appearancePresets']['delete'](_0x377bc5),await _0x149dea(),alert(_0x3d25bb(0x733)));}async function _0x26623a(){const _0x55ff5a=_0x247bea,_0x3d2de9=document['getElementById'](_0x55ff5a(0xa9));_0x3d2de9['innerHTML']=_0x55ff5a(0x447);const _0x388232=await _0x2a2987[_0x55ff5a(0x647)][_0x55ff5a(0x8b5)](_0x55ff5a(0x52a))['equals'](_0x55ff5a(0xe5f))['toArray']();_0x388232[_0x55ff5a(0xd6a)](_0x2f2d54=>{const _0x2360da=_0x55ff5a,_0x1186ed=document[_0x2360da(0x1292)](_0x2360da(0x2f6));_0x1186ed[_0x2360da(0x22a)]=_0x2f2d54['id'],_0x1186ed[_0x2360da(0x11b0)]=_0x2f2d54[_0x2360da(0x578)],_0x3d2de9['appendChild'](_0x1186ed);});const _0xef6e24={'wallpaper':_0x12493e[_0x55ff5a(0x10f6)]['wallpaper'],'cphoneWallpaper':_0x12493e[_0x55ff5a(0x10f6)]['cphoneWallpaper'],'globalChatBackground':_0x12493e[_0x55ff5a(0x10f6)][_0x55ff5a(0x840)],'appIcons':_0x12493e[_0x55ff5a(0x10f6)][_0x55ff5a(0x4da)],'cphoneAppIcons':_0x12493e[_0x55ff5a(0x10f6)][_0x55ff5a(0x2d4)],'chatActionButtonsOrder':_0x12493e[_0x55ff5a(0x10f6)]['chatActionButtonsOrder'],'theme':localStorage[_0x55ff5a(0x7bb)](_0x55ff5a(0x3f1))||_0x55ff5a(0x5b3),'showStatusBar':_0x12493e[_0x55ff5a(0x10f6)][_0x55ff5a(0xa86)],'notificationSoundUrl':_0x12493e['globalSettings'][_0x55ff5a(0xc7)],'widgetData':_0x12493e[_0x55ff5a(0x10f6)][_0x55ff5a(0x28e)]};let _0x1124b4=null;for(const _0x5e862c of _0x388232){if(JSON[_0x55ff5a(0xd27)](_0x5e862c[_0x55ff5a(0x22a)])===JSON[_0x55ff5a(0xd27)](_0xef6e24)){_0x1124b4=_0x5e862c['id'];break;}}_0x1124b4?_0x3d2de9[_0x55ff5a(0x22a)]=_0x1124b4:_0x3d2de9[_0x55ff5a(0x22a)]='';}async function _0x4cbf28(){const _0x555131=_0x247bea,_0x179871=document[_0x555131(0xc33)]('appearance-preset-select'),_0x2ec187=parseInt(_0x179871['value']);if(isNaN(_0x2ec187))return;const _0x5139e9=await _0x2a2987[_0x555131(0x647)][_0x555131(0xec0)](_0x2ec187);if(_0x5139e9&&_0x5139e9[_0x555131(0x22a)]){const _0x24a145=_0x5139e9[_0x555131(0x22a)];Object[_0x555131(0x26f)](_0x12493e['globalSettings'],_0x24a145),_0x11d9f4(_0x24a145[_0x555131(0x8a9)]||_0x555131(0x5b3)),await _0x2a2987[_0x555131(0x10f6)][_0x555131(0xf36)](_0x12493e['globalSettings']),_0x5871a7(),_0x44847e(),_0x21aa4c(),_0x1ed875(),_0xadc4e(),_0xa1bafb(),_0x374557(),alert(_0x555131(0x48d)+_0x5139e9[_0x555131(0x578)]+'”');}}async function _0x5b1188(){const _0x3d5a3d=_0x247bea,_0x10d415=await _0x1ca09c(_0x3d5a3d(0xee),_0x3d5a3d(0x3da));if(!_0x10d415||!_0x10d415[_0x3d5a3d(0x7da)]())return;const _0x4d58d3={'wallpaper':_0x12493e[_0x3d5a3d(0x10f6)][_0x3d5a3d(0x93e)],'cphoneWallpaper':_0x12493e[_0x3d5a3d(0x10f6)]['cphoneWallpaper'],'globalChatBackground':_0x12493e[_0x3d5a3d(0x10f6)][_0x3d5a3d(0x840)],'appIcons':_0x12493e[_0x3d5a3d(0x10f6)][_0x3d5a3d(0x4da)],'cphoneAppIcons':_0x12493e[_0x3d5a3d(0x10f6)][_0x3d5a3d(0x2d4)],'chatActionButtonsOrder':_0x12493e[_0x3d5a3d(0x10f6)]['chatActionButtonsOrder'],'theme':localStorage['getItem'](_0x3d5a3d(0x3f1))||'light','showStatusBar':_0x12493e[_0x3d5a3d(0x10f6)]['showStatusBar'],'notificationSoundUrl':_0x12493e[_0x3d5a3d(0x10f6)][_0x3d5a3d(0xc7)],'widgetData':_0x12493e[_0x3d5a3d(0x10f6)][_0x3d5a3d(0x28e)]},_0x28a103=await _0x2a2987['appearancePresets'][_0x3d5a3d(0x8b5)]({'name':_0x10d415[_0x3d5a3d(0x7da)](),'type':_0x3d5a3d(0xe5f)})[_0x3d5a3d(0x4e3)]();if(_0x28a103){const _0x5765b5=await _0x270512(_0x3d5a3d(0x1295),_0x3d5a3d(0xc85)+_0x10d415[_0x3d5a3d(0x7da)]()+_0x3d5a3d(0xeb5),{'confirmButtonClass':_0x3d5a3d(0xa2)});if(!_0x5765b5)return;await _0x2a2987[_0x3d5a3d(0x647)]['update'](_0x28a103['id'],{'value':_0x4d58d3});}else await _0x2a2987[_0x3d5a3d(0x647)][_0x3d5a3d(0xb9)]({'name':_0x10d415[_0x3d5a3d(0x7da)](),'type':_0x3d5a3d(0xe5f),'value':_0x4d58d3});await _0x26623a(),alert('外观预设已保存！');}async function _0x4632e5(){const _0x2ef46e=_0x247bea,_0x3cc551=document[_0x2ef46e(0xc33)](_0x2ef46e(0xa9)),_0x567b11=parseInt(_0x3cc551[_0x2ef46e(0x22a)]);if(isNaN(_0x567b11)){alert('请先从下拉框中选择一个要删除的预设。');return;}const _0x191631=await _0x2a2987[_0x2ef46e(0x647)][_0x2ef46e(0xec0)](_0x567b11);if(!_0x191631)return;const _0x37335a=await _0x270512(_0x2ef46e(0x5a0),_0x2ef46e(0x11e0)+_0x191631[_0x2ef46e(0x578)]+'”\x20吗？',{'confirmButtonClass':'btn-danger'});_0x37335a&&(await _0x2a2987[_0x2ef46e(0x647)][_0x2ef46e(0x9ea)](_0x567b11),await _0x26623a(),alert(_0x2ef46e(0x733)));}async function _0x3866c0(){const _0x29c022=_0x247bea,_0x22b4d9=document[_0x29c022(0xc33)](_0x29c022(0x413));_0x22b4d9[_0x29c022(0x102a)]=_0x29c022(0x447);const _0x1abd41=await _0x2a2987[_0x29c022(0x647)][_0x29c022(0x8b5)](_0x29c022(0x52a))[_0x29c022(0x10bd)](_0x29c022(0x11c4))[_0x29c022(0xf15)]();_0x1abd41[_0x29c022(0xd6a)](_0x35a9d9=>{const _0x308628=_0x29c022,_0x4e3d92=document['createElement']('option');_0x4e3d92['value']=_0x35a9d9['id'],_0x4e3d92['textContent']=_0x35a9d9[_0x308628(0x578)],_0x22b4d9[_0x308628(0xf77)](_0x4e3d92);});}async function _0x150daa(){const _0xa57627=_0x247bea,_0x8ce733=document['getElementById'](_0xa57627(0x413)),_0x5ca0f2=parseInt(_0x8ce733['value']);if(isNaN(_0x5ca0f2))return;const _0x571536=await _0x2a2987['appearancePresets']['get'](_0x5ca0f2);if(_0x571536){const _0x213c52=_0x571536[_0xa57627(0x22a)][_0xa57627(0xa41)]||'default',_0x538aaa=_0x571536[_0xa57627(0x22a)]['custom']||'',_0x11849b=document[_0xa57627(0x977)](_0xa57627(0xbc0)+_0x213c52+'\x22]');_0x11849b&&(_0x11849b[_0xa57627(0x737)]=!![]);const _0x2e140d=document[_0xa57627(0xc33)]('custom-css-input');_0x2e140d[_0xa57627(0x22a)]=_0x538aaa,_0x20b86d();}}async function _0x4b7009(){const _0x1a448e=_0x247bea,_0xde4e78=await _0x1ca09c(_0x1a448e(0x1257),_0x1a448e(0x3da));if(!_0xde4e78||!_0xde4e78[_0x1a448e(0x7da)]())return;const _0x481eba=document[_0x1a448e(0x977)]('input[name=\x22theme-select\x22]:checked'),_0x100a7e=_0x481eba?_0x481eba[_0x1a448e(0x22a)]:'default',_0x491b57=document['getElementById']('custom-css-input')[_0x1a448e(0x22a)]['trim'](),_0x30df54={'base':_0x100a7e,'custom':_0x491b57},_0x18a0fe=await _0x2a2987[_0x1a448e(0x647)][_0x1a448e(0x8b5)]({'name':_0xde4e78[_0x1a448e(0x7da)](),'type':'bubble_theme'})[_0x1a448e(0x4e3)]();if(_0x18a0fe){const _0x3b8f0d=await _0x270512(_0x1a448e(0x1295),_0x1a448e(0xc85)+_0xde4e78['trim']()+_0x1a448e(0xeb5),{'confirmButtonClass':'btn-danger'});if(!_0x3b8f0d)return;await _0x2a2987['appearancePresets']['update'](_0x18a0fe['id'],{'value':_0x30df54});}else await _0x2a2987[_0x1a448e(0x647)][_0x1a448e(0xb9)]({'name':_0xde4e78[_0x1a448e(0x7da)](),'type':'bubble_theme','value':_0x30df54});await _0x3866c0(),alert(_0x1a448e(0xf29));}async function _0x35ad49(){const _0x2a3c9a=_0x247bea,_0x10829c=document['getElementById'](_0x2a3c9a(0x413)),_0x141fe3=parseInt(_0x10829c[_0x2a3c9a(0x22a)]);if(isNaN(_0x141fe3)){alert(_0x2a3c9a(0x954));return;}const _0x30f881=await _0x2a2987[_0x2a3c9a(0x647)][_0x2a3c9a(0xec0)](_0x141fe3);if(!_0x30f881)return;const _0xe99f4c=await _0x270512(_0x2a3c9a(0x5a0),'确定要删除预设\x20“'+_0x30f881[_0x2a3c9a(0x578)]+_0x2a3c9a(0x3be),{'confirmButtonClass':_0x2a3c9a(0xa2)});_0xe99f4c&&(await _0x2a2987[_0x2a3c9a(0x647)]['delete'](_0x141fe3),await _0x3866c0(),alert(_0x2a3c9a(0x733)));}async function _0x15b6b0(){const _0x4238f4=_0x247bea;await _0x2240a3(),document[_0x4238f4(0xc33)]('sticker-category-manager-modal')[_0x4238f4(0x10d3)]['add']('visible');}async function _0x2240a3(){const _0x5b5578=_0x247bea,_0x47071c=document[_0x5b5578(0xc33)]('existing-sticker-categories-list'),_0x21d238=await _0x2a2987[_0x5b5578(0xfb6)][_0x5b5578(0xf15)]();_0x47071c[_0x5b5578(0x102a)]='';if(_0x21d238['length']===0x0){_0x47071c[_0x5b5578(0x102a)]=_0x5b5578(0xc8f);return;}_0x21d238[_0x5b5578(0xd6a)](_0x2486db=>{const _0x142698=_0x5b5578,_0x1ea001=document['createElement'](_0x142698(0x58c));_0x1ea001[_0x142698(0x84)]=_0x142698(0x1151),_0x1ea001[_0x142698(0x102a)]=_0x142698(0x2c1)+_0x2486db[_0x142698(0x578)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22delete-group-btn\x22\x20data-id=\x22'+_0x2486db['id']+'\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x47071c[_0x142698(0xf77)](_0x1ea001);});}async function _0x25d5f6(){const _0x160a34=_0x247bea,_0x505d79=document[_0x160a34(0xc33)](_0x160a34(0x172)),_0x2476e0=_0x505d79[_0x160a34(0x22a)][_0x160a34(0x7da)]();if(!_0x2476e0){alert(_0x160a34(0xa2c));return;}const _0x4c2445=await _0x2a2987[_0x160a34(0xfb6)][_0x160a34(0x8b5)](_0x160a34(0x578))[_0x160a34(0x10bd)](_0x2476e0)[_0x160a34(0x4e3)]();if(_0x4c2445){alert(_0x160a34(0xbe3)+_0x2476e0+_0x160a34(0xe85));return;}await _0x2a2987[_0x160a34(0xfb6)][_0x160a34(0xb9)]({'name':_0x2476e0}),_0x505d79[_0x160a34(0x22a)]='',await _0x2240a3();}async function _0x5f2631(_0x225dc2){const _0x67cb2b=_0x247bea,_0x559cda=await _0x2a2987[_0x67cb2b(0xfb6)][_0x67cb2b(0xec0)](_0x225dc2);if(!_0x559cda)return;const _0x2ed1f1=await _0x2a2987[_0x67cb2b(0x454)][_0x67cb2b(0x8b5)]('categoryId')[_0x67cb2b(0x10bd)](_0x225dc2)[_0x67cb2b(0x109)](),_0x3f5c5d=_0x2ed1f1>0x0?_0x67cb2b(0xb6d)+_0x559cda[_0x67cb2b(0x578)]+_0x67cb2b(0x7a5)+_0x2ed1f1+_0x67cb2b(0xc0c):_0x67cb2b(0xb6d)+_0x559cda[_0x67cb2b(0x578)]+_0x67cb2b(0xa31),_0x21da58=await _0x270512(_0x67cb2b(0x124e),_0x3f5c5d,{'confirmButtonClass':_0x67cb2b(0xa2)});if(_0x21da58)try{await _0x2a2987['transaction']('rw',_0x2a2987['stickerCategories'],_0x2a2987[_0x67cb2b(0x454)],async()=>{const _0x9b2898=_0x67cb2b,_0x3387af=await _0x2a2987['userStickers'][_0x9b2898(0x8b5)](_0x9b2898(0x305))[_0x9b2898(0x10bd)](_0x225dc2)[_0x9b2898(0x481)]();_0x3387af[_0x9b2898(0x79b)]>0x0&&await _0x2a2987[_0x9b2898(0x454)][_0x9b2898(0x98b)](_0x3387af),await _0x2a2987['stickerCategories'][_0x9b2898(0x9ea)](_0x225dc2);}),_0x12493e[_0x67cb2b(0x454)]=await _0x2a2987[_0x67cb2b(0x454)]['toArray'](),_0x1b3792===_0x225dc2&&(_0x1b3792=_0x67cb2b(0x5c8)),await _0x2240a3(),await _0x3f10e9(),alert(_0x67cb2b(0x1122)+_0x559cda[_0x67cb2b(0x578)]+_0x67cb2b(0xda6));}catch(_0xf7ff0f){console[_0x67cb2b(0x4d9)](_0x67cb2b(0x1217),_0xf7ff0f),alert(_0x67cb2b(0x1248));}}function _0x1abb98(_0x6d9ccd){const _0x3fc5ed=_0x247bea;_0x1b3792=_0x6d9ccd,document[_0x3fc5ed(0x67a)](_0x3fc5ed(0xa12))['forEach'](_0x2c1c1d=>{const _0x33d9d4=_0x3fc5ed;_0x2c1c1d['classList'][_0x33d9d4(0xe2c)](_0x33d9d4(0x1043),String(_0x2c1c1d[_0x33d9d4(0x85)]['categoryId'])===String(_0x6d9ccd));}),_0x3f10e9(![]);const _0x155ab1=document[_0x3fc5ed(0xc33)](_0x3fc5ed(0xc2c));if(_0x155ab1)_0x155ab1[_0x3fc5ed(0x737)]=![];}async function _0x2e4aea(){const _0x4ea293=_0x247bea;if(!_0x12493e['activeChatId'])return;const _0x4cc106=_0x12493e['chats'][_0x12493e[_0x4ea293(0x7bc)]];if(!_0x4cc106)return;try{const _0x5d773c={'type':_0x4ea293(0x8bb),'version':0x1,'chatData':_0x4cc106},_0x2315df=new Blob([JSON[_0x4ea293(0xd27)](_0x5d773c,null,0x2)],{'type':'application/json'}),_0x17f86a=URL['createObjectURL'](_0x2315df),_0x453562=document['createElement']('a');_0x453562[_0x4ea293(0x9c0)]=_0x17f86a,_0x453562['download']=_0x4ea293(0xcb3)+_0x4cc106[_0x4ea293(0x578)]+'-'+new Date()[_0x4ea293(0x7a3)]()[_0x4ea293(0x8d7)]('T')[0x0]+_0x4ea293(0xc8),_0x453562[_0x4ea293(0x335)](),URL[_0x4ea293(0x1202)](_0x17f86a),await _0x2d7ddd(_0x4ea293(0x761),'与“'+_0x4cc106['name']+_0x4ea293(0x4ec));}catch(_0x107cdb){console[_0x4ea293(0x4d9)]('导出单个聊天时出错:',_0x107cdb),await _0x2d7ddd(_0x4ea293(0xd21),_0x4ea293(0x2b9)+_0x107cdb[_0x4ea293(0xf93)]);}}async function _0x3f241e(_0xfbe27d){const _0x402a5b=_0x247bea;if(!_0xfbe27d||!_0x12493e[_0x402a5b(0x7bc)])return;const _0x543b69=_0x12493e['activeChatId'],_0x4faed3=_0x12493e[_0x402a5b(0xc45)][_0x543b69];try{const _0x230618=await _0xfbe27d[_0x402a5b(0x996)](),_0x1f5d58=JSON[_0x402a5b(0x6b1)](_0x230618);if(_0x1f5d58[_0x402a5b(0x52a)]!==_0x402a5b(0x8bb)||!_0x1f5d58['chatData'])throw new Error('文件格式不正确，这不是一个有效的单聊备份文件。');const _0x56c581=await _0x270512(_0x402a5b(0x275),'这将用备份文件中的数据【完全覆盖】当前与“'+_0x4faed3[_0x402a5b(0x578)]+_0x402a5b(0x69d),{'confirmButtonClass':_0x402a5b(0xa2),'confirmText':_0x402a5b(0x1154)});if(!_0x56c581)return;const _0x5038d6=_0x1f5d58[_0x402a5b(0x743)];_0x5038d6['id']=_0x543b69,await _0x2a2987[_0x402a5b(0xc45)][_0x402a5b(0xf36)](_0x5038d6),_0x12493e[_0x402a5b(0xc45)][_0x543b69]=_0x5038d6,await _0x2d7ddd(_0x402a5b(0x455),_0x402a5b(0x10a2)),_0x1bbfd3(_0x543b69),_0x597ed7(),document[_0x402a5b(0xc33)]('chat-settings-btn')[_0x402a5b(0x335)]();}catch(_0x185104){console['error'](_0x402a5b(0x11da),_0x185104),await _0x2d7ddd(_0x402a5b(0x11bc),_0x402a5b(0x4e8)+_0x185104[_0x402a5b(0xf93)]);}}function _0x624af8(){const _0x1a09cf=_0x247bea;_0x2c5065(),_0x38f00f(_0x1a09cf(0x732));}function _0x2c5065(){const _0x32682c=_0x247bea,_0x2cfa9c=document[_0x32682c(0xc33)](_0x32682c(0x147));_0x2cfa9c['innerHTML']='';const _0x35022c=Object[_0x32682c(0xd28)](_0x12493e[_0x32682c(0xc45)])['filter'](_0x21f98a=>!_0x21f98a[_0x32682c(0x80b)]);if(_0x35022c[_0x32682c(0x79b)]===0x0){_0x2cfa9c['innerHTML']='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有可以查看手机的角色哦~</p>';return;}_0x35022c[_0x32682c(0xd6a)](_0x139fa3=>{const _0x1f29f9=_0x32682c,_0x286c4f=document['createElement']('div');_0x286c4f['className']='character-select-item',_0x286c4f[_0x1f29f9(0x102a)]=_0x1f29f9(0xce7)+(_0x139fa3['settings']['aiAvatar']||_0x190acc)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x139fa3[_0x1f29f9(0x578)]+_0x1f29f9(0x149),_0x286c4f[_0x1f29f9(0x205)](_0x1f29f9(0x335),()=>_0x3ec1be(_0x139fa3['id'])),_0x2cfa9c['appendChild'](_0x286c4f);});}async function _0x3ec1be(_0x25ed1a){const _0x3d5656=_0x247bea;_0x41e464=_0x25ed1a,console[_0x3d5656(0x51f)](_0x3d5656(0x2a1)+_0x25ed1a+_0x3d5656(0xd58)),_0x44847e(),_0x1ed875(),_0x191da3(),_0x38f00f('character-phone-screen');}function _0x39a41d(){const _0x5c4954=_0x247bea;_0x41e464=null,console[_0x5c4954(0x51f)]('已返回我的手机'),_0x38f00f(_0x5c4954(0x94f));}function _0x191da3(){const _0x38869a=_0x247bea,_0x40ce52=new Date(),_0x53652f=_0x40ce52['toLocaleTimeString'](_0x38869a(0x770),{'hour':_0x38869a(0x55b),'minute':_0x38869a(0x55b)}),_0x4bd6c=_0x40ce52[_0x38869a(0x11f9)](_0x38869a(0x770),{'weekday':_0x38869a(0x330),'month':_0x38869a(0x330),'day':_0x38869a(0xb4d)});document[_0x38869a(0xc33)](_0x38869a(0xe92))['textContent']=_0x53652f,document[_0x38869a(0xc33)]('char-main-date')[_0x38869a(0x11b0)]=_0x4bd6c,_0x11e45b(_0x38869a(0x1270));}function _0x11e45b(_0x169167){const _0x172752=_0x247bea;document[_0x172752(0x67a)](_0x172752(0xf34))['forEach'](_0x43825d=>_0x43825d['classList'][_0x172752(0x2c7)](_0x172752(0x1043))),document[_0x172752(0xc33)](_0x169167)[_0x172752(0x10d3)][_0x172752(0xb9)](_0x172752(0x1043));}window[_0x247bea(0x2f1)]=_0x11e45b;async function _0x36007f(_0x20e998){const _0x42aa8e=_0x247bea;if(!_0x41e464)return;const _0x414cc2=_0x12493e['chats'][_0x41e464];await _0x553359(_0x41e464,_0x20e998);switch(_0x20e998){case'qq':_0x351203(),_0x11e45b(_0x42aa8e(0x646));break;case _0x42aa8e(0x5b0):_0x1d28b8(),_0x11e45b('char-album-screen');break;case _0x42aa8e(0xf13):_0x5e7dcd(),_0x11e45b(_0x42aa8e(0xbf0));break;case _0x42aa8e(0x7a9):_0x3984ad(),_0x11e45b(_0x42aa8e(0x115e));break;case'memo':_0x8e512(),_0x11e45b(_0x42aa8e(0x4f5));break;case _0x42aa8e(0x767):_0x53e481(),_0x11e45b(_0x42aa8e(0x482));break;case _0x42aa8e(0x52f):_0x339a63(),_0x11e45b(_0x42aa8e(0x119));break;case'music':_0x1ad6e6(),_0x11e45b(_0x42aa8e(0x30f));break;case _0x42aa8e(0x95f):_0x543ea9(),_0x11e45b('char-usage-screen');break;}}async function _0x1d28b8(){const _0x1c49ee=_0x247bea,_0x45aba2=document['getElementById'](_0x1c49ee(0xb8f));_0x45aba2[_0x1c49ee(0x102a)]='';if(!_0x41e464)return;const _0x3e6a0c=_0x12493e[_0x1c49ee(0xc45)][_0x41e464],_0x31e0ae=_0x3e6a0c['simulatedAlbum']||[];if(_0x31e0ae[_0x1c49ee(0x79b)]===0x0){_0x45aba2[_0x1c49ee(0x102a)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的相册还是空的，<br>点击右上角刷新按钮生成一些照片吧！</p>';return;}const _0x10d427='https://i.postimg.cc/KYr2qRCK/1.jpg';_0x31e0ae[_0x1c49ee(0xd6a)](_0x5c15af=>{const _0x544991=_0x1c49ee,_0x4ebdbd=document['createElement']('div');_0x4ebdbd[_0x544991(0x84)]='char-photo-item',_0x4ebdbd[_0x544991(0x85)][_0x544991(0x11ac)]=_0x5c15af[_0x544991(0x11ac)],_0x45aba2['appendChild'](_0x4ebdbd);if(_0x12493e[_0x544991(0x10f6)][_0x544991(0xd2f)]){_0x4ebdbd[_0x544991(0x105d)][_0x544991(0x1c5)]='#e9ecef';const _0x225c6b=/[^\x00-\x7F]/[_0x544991(0x677)](_0x5c15af[_0x544991(0xe3d)]),_0x2953f2=_0x5c15af[_0x544991(0xe3d)]&&_0x5c15af[_0x544991(0xe3d)][_0x544991(0x7da)]()&&!_0x225c6b,_0xa38ba9=_0x2953f2?_0x5c15af[_0x544991(0xe3d)]:'a\x20beautiful\x20scenery,\x20anime\x20style,\x20cinematic\x20lighting',_0x306676=_0x544991(0xda8)+encodeURIComponent(_0xa38ba9),_0x3c0dbe=new Image();_0x3c0dbe[_0x544991(0x833)]=function(){const _0x3d6579=_0x544991;_0x4ebdbd['style'][_0x3d6579(0x4b5)]=_0x3d6579(0xb23)+this[_0x3d6579(0x87b)]+')';},_0x3c0dbe['onerror']=function(){const _0x53b0fd=_0x544991;_0x4ebdbd[_0x53b0fd(0x105d)][_0x53b0fd(0x4b5)]=_0x53b0fd(0xb23)+_0x10d427+')';},_0x3c0dbe[_0x544991(0x87b)]=_0x306676;}else{_0x4ebdbd['style']['backgroundColor']=_0x544991(0xf78),_0x4ebdbd[_0x544991(0x105d)][_0x544991(0x8d8)]='1px\x20solid\x20#e0e0e0';const _0x2fa256=document[_0x544991(0x1292)]('p');_0x2fa256[_0x544991(0x84)]=_0x544991(0x873),_0x2fa256[_0x544991(0x11b0)]=_0x5c15af[_0x544991(0x11ac)]||_0x544991(0x10b5),_0x4ebdbd['appendChild'](_0x2fa256);}});}function _0x5e7dcd(){const _0x51c59f=_0x247bea,_0x412bde=document['getElementById']('char-browser-history');_0x412bde[_0x51c59f(0x102a)]='';if(!_0x41e464)return;const _0x256863=_0x12493e[_0x51c59f(0xc45)][_0x41e464],_0x4b2e2d=[_0x256863[_0x51c59f(0x578)],'爱好','旅游','美食','新闻',..._0x256863[_0x51c59f(0x2ea)][_0x51c59f(0x679)][_0x51c59f(0x8d7)](/，|。|\s/)[_0x51c59f(0x111c)](0x0,0x5)],_0x28f07e=['知乎',_0x51c59f(0xdce),_0x51c59f(0xec4),'微博',_0x51c59f(0x11f4)];for(let _0xa2db9c=0x0;_0xa2db9c<0xf;_0xa2db9c++){const _0x23e75e=_0x4b2e2d[Math[_0x51c59f(0xcb5)](Math[_0x51c59f(0xa11)]()*_0x4b2e2d[_0x51c59f(0x79b)])],_0x198ee9=_0x28f07e[Math[_0x51c59f(0xcb5)](Math[_0x51c59f(0xa11)]()*_0x28f07e[_0x51c59f(0x79b)])],_0x1b1cf9=document[_0x51c59f(0x1292)](_0x51c59f(0x58c));_0x1b1cf9[_0x51c59f(0x84)]='char-browser-item',_0x1b1cf9['innerHTML']=_0x51c59f(0x540)+_0x23e75e+_0x51c59f(0x804)+_0x198ee9+_0x51c59f(0x944)+_0x198ee9['toLowerCase']()+_0x51c59f(0x387)+_0x23e75e+_0x51c59f(0x1056),_0x412bde[_0x51c59f(0xf77)](_0x1b1cf9);}}function _0x3984ad(){const _0x44b992=_0x247bea,_0x4fd51c=document[_0x44b992(0xc33)](_0x44b992(0x14a));_0x4fd51c['innerHTML']='';if(!_0x41e464)return;const _0x4b62bb=_0x12493e[_0x44b992(0xc45)][_0x41e464],_0x2c99cd=_0x4b62bb[_0x44b992(0x1156)]?.[_0x44b992(0x638)]||[];if(_0x2c99cd[_0x44b992(0x79b)]===0x0){_0x4fd51c[_0x44b992(0x102a)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA最近好像什么都没买呢，<br>点击右上角刷新按钮生成一些记录吧！</p>';return;}_0x2c99cd[_0x44b992(0xd6a)](_0x424901=>{const _0x1feb65=_0x44b992,_0x83b422=document[_0x1feb65(0x1292)](_0x1feb65(0x58c));_0x83b422[_0x1feb65(0x84)]=_0x1feb65(0x44c),_0x83b422[_0x1feb65(0x85)][_0x1feb65(0x842)]=_0x424901['reason'];let _0x8ff12d;if(_0x12493e['globalSettings'][_0x1feb65(0xd2f)]){const _0x416c47=_0x1feb65(0xda8)+encodeURIComponent(_0x424901[_0x1feb65(0xe3d)]||_0x1feb65(0x72a));_0x8ff12d=_0x1feb65(0xb19)+_0x416c47+'\x22\x20class=\x22product-image\x22>';}else _0x8ff12d=_0x1feb65(0x71b)+(_0x424901[_0x1feb65(0x842)]||_0x1feb65(0xf52))+_0x1feb65(0x1075);_0x83b422[_0x1feb65(0x102a)]=_0x1feb65(0x7dc)+_0x8ff12d+_0x1feb65(0x1c1)+_0x424901[_0x1feb65(0xe0e)]+_0x1feb65(0xe75)+(_0x424901[_0x1feb65(0xae2)]||0x0)[_0x1feb65(0xcab)](0x2)+_0x1feb65(0x61e)+_0x424901['status']+_0x1feb65(0xe05),_0x4fd51c['appendChild'](_0x83b422);});}function _0x61bff(){const _0x1b623a=_0x247bea;_0x11e45b(_0x1b623a(0x1270));}function _0x2def65(){const _0x2cfdb6=_0x247bea,_0x295cc8=document['getElementById'](_0x2cfdb6(0x9c));_0x295cc8[_0x2cfdb6(0x102a)]='';if(!_0x41e464)return;const _0x516f24=Object[_0x2cfdb6(0xd28)](_0x12493e[_0x2cfdb6(0xc45)])[_0x2cfdb6(0x1054)](_0x4d1eb7=>{const _0x2b31e5=_0x2cfdb6;if(_0x4d1eb7['id']===_0x41e464)return!![];if(_0x4d1eb7[_0x2b31e5(0x80b)]&&_0x4d1eb7[_0x2b31e5(0xd5b)][_0x2b31e5(0xfa7)](_0x1308b3=>_0x1308b3['id']===_0x41e464))return!![];return![];});_0x516f24[_0x2cfdb6(0xd6a)](_0x13ec76=>{const _0x4bb72a=_0x59404c(_0x13ec76);_0x295cc8['appendChild'](_0x4bb72a);});}async function _0x553359(_0x5d11a6,_0x2c21f9){const _0x276810=_0x247bea,_0x128ce0=_0x12493e[_0x276810(0xc45)][_0x5d11a6];if(!_0x128ce0)return;!_0x128ce0['appUsageLog']&&(_0x128ce0[_0x276810(0xdd0)]=[]),_0x128ce0[_0x276810(0xdd0)][_0x276810(0x2d6)]({'appName':_0x2c21f9,'timestamp':Date['now']()}),_0x128ce0[_0x276810(0xdd0)][_0x276810(0x79b)]>0x32&&_0x128ce0['appUsageLog'][_0x276810(0x4fd)](),await _0x2a2987[_0x276810(0xc45)]['put'](_0x128ce0);}function _0x543ea9(){const _0x4c1680=_0x247bea,_0x5957d0=document[_0x4c1680(0xc33)](_0x4c1680(0xed5));_0x5957d0['innerHTML']='';const _0x2739d5=_0x12493e['chats'][_0x41e464],_0xb416e7=(_0x2739d5[_0x4c1680(0xdd0)]||[])[_0x4c1680(0x111c)]()[_0x4c1680(0xc07)]();if(_0xb416e7[_0x4c1680(0x79b)]===0x0){_0x5957d0['innerHTML']='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有任何使用记录。</p>';return;}const _0x4a85bb={'qq':'QQ','album':'相册','browser':_0x4c1680(0x821),'taobao':'淘宝','memo':_0x4c1680(0x100a),'diary':'日记','amap':'高德地图','usage':'App记录'};_0xb416e7[_0x4c1680(0xd6a)](_0x244f95=>{const _0x537406=_0x4c1680,_0x17194d=document[_0x537406(0x1292)](_0x537406(0x58c));_0x17194d['className']=_0x537406(0x5df),_0x17194d[_0x537406(0x102a)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22timestamp\x22>'+new Date(_0x244f95[_0x537406(0x2f0)])[_0x537406(0x559)]()+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22action\x22>打开了\x20<strong>'+(_0x4a85bb[_0x244f95[_0x537406(0x742)]]||_0x244f95['appName'])+_0x537406(0x395),_0x5957d0[_0x537406(0xf77)](_0x17194d);});}async function _0x3c4064(_0x30a149){const _0xeac74=_0x247bea,_0x21f2dd=_0x12493e[_0xeac74(0xc45)][_0x41e464];if(!_0x21f2dd)return;const _0x56f38c={'role':_0xeac74(0x376),'senderName':_0x21f2dd[_0xeac74(0x776)],'type':_0xeac74(0x920),'content':_0x30a149,'imageUrl':'https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756262526935_qdqqd_4uque3.jpeg','timestamp':Date['now']()};_0x21f2dd[_0xeac74(0x1294)][_0xeac74(0x2d6)](_0x56f38c),await _0x2a2987[_0xeac74(0xc45)][_0xeac74(0xf36)](_0x21f2dd),_0x12493e[_0xeac74(0x7bc)]===_0x41e464&&_0x468ef0(_0x56f38c,_0x21f2dd),await _0x2d7ddd('分享成功','“'+_0x21f2dd[_0xeac74(0x578)]+_0xeac74(0xc17));}async function _0x5ed955(_0x4ca6ed){const _0x339021=_0x247bea,_0x85ef81=_0x12493e['chats'][_0x41e464];if(!_0x85ef81||!_0x85ef81[_0x339021(0x1f1)])return;const _0xaf16a3=_0x85ef81[_0x339021(0x1f1)][_0x339021(0xd85)](_0x199c34=>_0x199c34['id']===_0x4ca6ed);if(_0xaf16a3){_0x4b387d=_0xaf16a3;const _0x36beab=document[_0x339021(0xc33)]('char-memo-detail-title'),_0x33f69f=document[_0x339021(0xc33)]('char-memo-detail-content'),_0x573cb6=document['getElementById'](_0x339021(0xcbf));if(_0x36beab)_0x36beab['textContent']=_0xaf16a3['title'];if(_0x33f69f)_0x33f69f[_0x339021(0x22a)]=_0xaf16a3['content'];const _0x129b01=await _0x2a2987[_0x339021(0xe69)][_0x339021(0x8b5)]({'type':_0x339021(0x297),'content.id':_0x4ca6ed})['first']();_0x573cb6[_0x339021(0x10d3)][_0x339021(0xe2c)](_0x339021(0x1043),!!_0x129b01),_0x11e45b(_0x339021(0x137));}}function _0x8e512(){const _0x1bfd12=_0x247bea,_0x1482fc=document[_0x1bfd12(0xc33)](_0x1bfd12(0x321));_0x1482fc[_0x1bfd12(0x102a)]='';const _0x3bcfbb=_0x12493e[_0x1bfd12(0xc45)][_0x41e464],_0x5eb75=(_0x3bcfbb[_0x1bfd12(0x1f1)]||[])[_0x1bfd12(0x111c)]()['reverse']();if(_0x5eb75[_0x1bfd12(0x79b)]===0x0){_0x1482fc['innerHTML']=_0x1bfd12(0x593);return;}_0x5eb75[_0x1bfd12(0xd6a)](_0x22e286=>{const _0x3de208=_0x1bfd12,_0x5d788b=document[_0x3de208(0x1292)](_0x3de208(0x58c));_0x5d788b[_0x3de208(0x84)]=_0x3de208(0x8d4),_0x5d788b[_0x3de208(0x102a)]=_0x3de208(0xc7d)+_0x22e286[_0x3de208(0x874)]+_0x3de208(0x623)+(_0x22e286[_0x3de208(0xcbd)]||'')[_0x3de208(0x8d7)]('\x0a')[0x0]+_0x3de208(0x1056),_0x5d788b[_0x3de208(0x205)](_0x3de208(0x335),()=>_0x5ed955(_0x22e286['id'])),_0x29b870(_0x5d788b,()=>deleteMemo(_0x22e286['id'])),_0x1482fc['appendChild'](_0x5d788b);});}async function _0x555387(_0xeb67ab=null){const _0x15d8b2=_0x247bea;_0x4fb2cc=null;const _0x477a54=await _0x1ca09c(_0x15d8b2(0xe6f),_0x15d8b2(0xc28));if(_0x477a54===null||!_0x477a54[_0x15d8b2(0x7da)]())return;const _0x5a657d=await _0x1ca09c(_0x15d8b2(0xa0a)+_0x477a54,_0x15d8b2(0x11d2),'',_0x15d8b2(0x89c));_0x5a657d!==null&&(await _0x59a8e3({'title':_0x477a54[_0x15d8b2(0x7da)](),'content':_0x5a657d}),_0x11e45b(_0x15d8b2(0x4f5)));}async function _0x59a8e3(_0x575bd9){const _0x3a4218=_0x247bea,_0x3e9c57=_0x12493e['chats'][_0x41e464];if(!_0x3e9c57['memos'])_0x3e9c57[_0x3a4218(0x1f1)]=[];_0x3e9c57[_0x3a4218(0x1f1)][_0x3a4218(0x2d6)]({'id':Date[_0x3a4218(0x6ee)](),'title':_0x575bd9[_0x3a4218(0x874)],'content':_0x575bd9[_0x3a4218(0xcbd)]}),await _0x2a2987[_0x3a4218(0xc45)][_0x3a4218(0xf36)](_0x3e9c57),_0x8e512();}async function _0x59a8e3(_0x1c5188){const _0x1cf5cd=_0x247bea,_0x3516a8=_0x12493e[_0x1cf5cd(0xc45)][_0x41e464];if(!_0x3516a8['memos'])_0x3516a8['memos']=[];if(_0x4fb2cc){const _0x18861b=_0x3516a8[_0x1cf5cd(0x1f1)][_0x1cf5cd(0xd85)](_0x481727=>_0x481727['id']===_0x4fb2cc);if(_0x18861b)_0x18861b['content']=_0x1c5188;}else _0x3516a8['memos'][_0x1cf5cd(0x2d6)]({'id':Date[_0x1cf5cd(0x6ee)](),'content':_0x1c5188});await _0x2a2987[_0x1cf5cd(0xc45)]['put'](_0x3516a8),_0x8e512(),_0x4fb2cc=null;}async function _0x26b53f(){const _0x1472c1=_0x247bea;if(!_0x41e464)return;const _0x2ea250=_0x12493e[_0x1472c1(0xc45)][_0x41e464];if(!_0x2ea250)return;await _0x2d7ddd('请稍候...',_0x1472c1(0xea9)+_0x2ea250[_0x1472c1(0x578)]+'”翻开TA的日记本...');const {proxyUrl:_0x44c877,apiKey:_0x18ef4f,model:_0x115bf0}=_0x12493e[_0x1472c1(0xdd4)];if(!_0x44c877||!_0x18ef4f||!_0x115bf0){alert(_0x1472c1(0xabe));return;}const _0xaf3398=_0x12493e[_0x1472c1(0x76c)]['nickname']===_0x1472c1(0x10d0)||!_0x12493e[_0x1472c1(0x76c)][_0x1472c1(0x66a)]?'用户':_0x12493e[_0x1472c1(0x76c)]['nickname'],_0x29e9eb=_0x2ea250[_0x1472c1(0x45b)]&&_0x2ea250['longTermMemory']['length']>0x0?_0x2ea250['longTermMemory'][_0x1472c1(0x9d5)](_0x3c1536=>_0x1472c1(0x11d4)+_0x3ce8f0(_0x3c1536['timestamp'])+')\x20'+_0x3c1536[_0x1472c1(0xcbd)])[_0x1472c1(0x100b)]('\x0a'):'无',_0x2bb39a=_0x2ea250[_0x1472c1(0x2ea)][_0x1472c1(0x660)]||0xa,_0x17296f=_0x2ea250[_0x1472c1(0x1294)][_0x1472c1(0x111c)](-_0x2bb39a)['map'](_0x236091=>(_0x236091[_0x1472c1(0x16d)]==='user'?_0xaf3398:_0x2ea250[_0x1472c1(0x578)])+':\x20'+String(_0x236091[_0x1472c1(0xcbd)])['substring'](0x0,0x1e)+_0x1472c1(0xda0))[_0x1472c1(0x100b)]('\x0a'),_0x3e4ad4=(_0x2ea250[_0x1472c1(0x2ea)][_0x1472c1(0xeca)]||[])['map'](_0x570e94=>_0x12493e[_0x1472c1(0x63a)]['find'](_0x591b51=>_0x591b51['id']===_0x570e94))[_0x1472c1(0x1054)](Boolean)['map'](_0x1b47b4=>_0x1472c1(0x6c6)+_0x1b47b4['name']+'》设定:\x0a'+_0x1b47b4['content'][_0x1472c1(0x1054)](_0x14f2a7=>_0x14f2a7[_0x1472c1(0x95a)])[_0x1472c1(0x9d5)](_0x5790a4=>'-\x20'+_0x5790a4[_0x1472c1(0xcbd)])[_0x1472c1(0x100b)]('\x0a'))[_0x1472c1(0x100b)](''),_0x4d880b=_0x1c73eb(_0x2ea250,0x3,_0x1472c1(0xb69)),_0x285aaf=_0x1c73eb(_0x2ea250,0x6,_0x1472c1(0xb69)),_0x5c2b47=_0x1c73eb(_0x2ea250,0x9,_0x1472c1(0xb69)),_0xb2ecb4=_0x1c73eb(_0x2ea250,0x1,'days'),_0x2ff1a8=_0x1c73eb(_0x2ea250,0x3,_0x1472c1(0x7d7)),_0x2a2b23=_0x1c73eb(_0x2ea250,0x7,'days');let _0x1276df='';if(_0x4d880b||_0x285aaf||_0x5c2b47||_0xb2ecb4||_0x2ff1a8||_0x2a2b23){_0x1276df+=_0x1472c1(0x323);if(_0x4d880b)_0x1276df+=_0x4d880b;if(_0x285aaf)_0x1276df+=_0x285aaf;if(_0x5c2b47)_0x1276df+=_0x5c2b47;if(_0x4d880b||_0x285aaf||_0x5c2b47)_0x1276df+='\x0a';if(_0xb2ecb4)_0x1276df+=_0xb2ecb4;if(_0x2ff1a8)_0x1276df+=_0x2ff1a8;if(_0x2a2b23)_0x1276df+=_0x2a2b23;}const _0x1e7d4a=_0x1472c1(0x740)+_0x2ea250[_0x1472c1(0x578)]+_0x1472c1(0xd93)+new Date()['toLocaleDateString'](_0x1472c1(0x770))+_0x1472c1(0xaa)+_0xaf3398+'”\x20来指代你的聊天对象（用户）。\x0a6.\x20\x20**【日记专属Markdown语法\x20(必须使用！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20`**加粗文字**`:\x20用于强调。\x0a\x20\x20\x20\x20-\x20\x20\x20`~~划掉的文字~~`:\x20用于表示改变主意或自我否定。\x0a\x20\x20\x20\x20-\x20\x20\x20`!h{黄色高亮}`:\x20用于标记关键词或重要信息。\x0a\x20\x20\x20\x20-\x20\x20\x20`!u{粉色下划线}`:\x20用于标注人名、地名或特殊名词。\x0a\x20\x20\x20\x20-\x20\x20\x20`!e{粉色强调}`:\x20用于表达强烈的情绪。\x0a\x20\x20\x20\x20-\x20\x20\x20`!w{手写体}`:\x20用于写下引言、歌词或特殊笔记。\x0a\x20\x20\x20\x20-\x20\x20\x20`!m{凌乱的手写体}`:\x20用于表达激动、慌乱或潦草记录时的心情。\x0a\x20\x20\x20\x20-\x20\x20\x20`||涂黑||`:\x20用于隐藏秘密或敏感词汇\x20(每次涂黑2~5个字)。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20'+_0x2ea250[_0x1472c1(0x2ea)]['aiPersona']+'\x0a-\x20**你的长期记忆**:\x0a'+_0x29e9eb+'\x0a'+_0x3e4ad4+'\x0a'+_0x1276df+_0x1472c1(0x655)+_0xaf3398+_0x1472c1(0x318)+_0x17296f+_0x1472c1(0xc0d);try{const _0x4c9969=[{'role':_0x1472c1(0x717),'content':_0x1472c1(0xa24)}];let _0xcb3103=_0x44c877[_0x1472c1(0x1d4)](_0x1472c1(0x113e)),_0x2b117f=_0x202ea1(_0x115bf0,_0x18ef4f,_0x1e7d4a,_0x4c9969);const _0x557db6=_0xcb3103?await fetch(_0x2b117f['url'],_0x2b117f[_0x1472c1(0xa78)]):await fetch(_0x44c877+_0x1472c1(0x399),{'method':'POST','headers':{'Content-Type':'application/json','Authorization':_0x1472c1(0xf20)+_0x18ef4f},'body':JSON[_0x1472c1(0xd27)]({'model':_0x115bf0,'messages':[{'role':_0x1472c1(0x152),'content':_0x1e7d4a},..._0x4c9969],'temperature':_0x12493e['globalSettings'][_0x1472c1(0xd52)]||0.95})});if(!_0x557db6['ok'])throw new Error(_0x1472c1(0xf43)+_0x557db6[_0x1472c1(0x109a)]);const _0xa1abf9=await _0x557db6[_0x1472c1(0x79e)](),_0x1f9408=getGeminiResponseText(_0xa1abf9),_0x13a253=_0x1f9408[_0x1472c1(0x1242)](/(\[[\s\S]*\])/);if(!_0x13a253||!_0x13a253[0x0])throw new Error(_0x1472c1(0xd3d)+_0x1f9408);const _0x35d69d=_0x13a253[0x0];let _0x1d9bca;try{_0x1d9bca=JSON['parse'](_0x35d69d);}catch(_0x2e71b7){throw new Error('解析AI返回的JSON时出错:\x20'+_0x2e71b7[_0x1472c1(0xf93)]+_0x1472c1(0x118a)+_0x1f9408);}_0x2ea250[_0x1472c1(0x767)]=_0x1d9bca[_0x1472c1(0x9d5)](_0xe24587=>({'id':Date[_0x1472c1(0x6ee)]()+Math[_0x1472c1(0xa11)](),'title':_0xe24587[_0x1472c1(0x874)],'content':_0xe24587['content'],'timestamp':Date['now']()})),await _0x2a2987['chats'][_0x1472c1(0xf36)](_0x2ea250),await _0x53e481();}catch(_0x5b0c0d){console['error'](_0x1472c1(0x112d),_0x5b0c0d),await _0x2d7ddd(_0x1472c1(0x8b1),_0x1472c1(0x171)+_0x5b0c0d[_0x1472c1(0xf93)]);}}async function _0x5f2d2c(){const _0x5b4545=_0x247bea;if(!_0x41e464)return;const _0x51bb2f=_0x12493e['chats'][_0x41e464];if(!_0x51bb2f)return;await _0x2d7ddd('请稍候...',_0x5b4545(0xea9)+_0x51bb2f[_0x5b4545(0x578)]+'”写一篇新日记...');const {proxyUrl:_0x2621cf,apiKey:_0x48f4e0,model:_0x4b7729}=_0x12493e[_0x5b4545(0xdd4)];if(!_0x2621cf||!_0x48f4e0||!_0x4b7729)return;const _0x5ba1b4=_0x12493e[_0x5b4545(0x76c)][_0x5b4545(0x66a)]===_0x5b4545(0x10d0)||!_0x12493e['qzoneSettings'][_0x5b4545(0x66a)]?'用户':_0x12493e[_0x5b4545(0x76c)][_0x5b4545(0x66a)],_0x5f4b0d=_0x51bb2f[_0x5b4545(0x45b)]&&_0x51bb2f[_0x5b4545(0x45b)][_0x5b4545(0x79b)]>0x0?_0x51bb2f['longTermMemory'][_0x5b4545(0x9d5)](_0xb3a41c=>_0x5b4545(0x11d4)+_0x3ce8f0(_0xb3a41c[_0x5b4545(0x2f0)])+')\x20'+_0xb3a41c['content'])[_0x5b4545(0x100b)]('\x0a'):'无',_0xe98302=_0x51bb2f[_0x5b4545(0x2ea)][_0x5b4545(0x660)]||0xa,_0x30dbd3=_0x51bb2f[_0x5b4545(0x1294)][_0x5b4545(0x111c)](-_0xe98302)['map'](_0x1ea092=>(_0x1ea092[_0x5b4545(0x16d)]===_0x5b4545(0x717)?_0x5ba1b4:_0x51bb2f[_0x5b4545(0x578)])+':\x20'+String(_0x1ea092[_0x5b4545(0xcbd)])[_0x5b4545(0x1033)](0x0,0x1e)+_0x5b4545(0xda0))['join']('\x0a'),_0x57b568=(_0x51bb2f['settings'][_0x5b4545(0xeca)]||[])[_0x5b4545(0x9d5)](_0x59aa57=>_0x12493e['worldBooks'][_0x5b4545(0xd85)](_0x5237a9=>_0x5237a9['id']===_0x59aa57))[_0x5b4545(0x1054)](Boolean)[_0x5b4545(0x9d5)](_0x4a36f3=>'\x0a##\x20世界书《'+_0x4a36f3[_0x5b4545(0x578)]+_0x5b4545(0xa27)+_0x4a36f3['content']['filter'](_0x30a500=>_0x30a500[_0x5b4545(0x95a)])['map'](_0x2faa9e=>'-\x20'+_0x2faa9e[_0x5b4545(0xcbd)])['join']('\x0a'))['join'](''),_0x2b90bf=_0x5b4545(0x2e4)+_0x51bb2f[_0x5b4545(0x578)]+_0x5b4545(0x972)+new Date()[_0x5b4545(0x11f9)]('zh-CN')+_0x5b4545(0xdd6)+_0x51bb2f[_0x5b4545(0x2ea)][_0x5b4545(0x679)]+_0x5b4545(0x74c)+_0x5f4b0d+'\x0a'+_0x57b568+'\x0a-\x20**你最近和“'+_0x5ba1b4+_0x5b4545(0x318)+_0x30dbd3+_0x5b4545(0xc9a);try{const _0x1c5c0b=[{'role':_0x5b4545(0x717),'content':'请根据你的设定，写一篇新日记。'}];let _0x336c53=_0x2621cf[_0x5b4545(0x1d4)](_0x5b4545(0x113e)),_0x545f20=_0x202ea1(_0x4b7729,_0x48f4e0,_0x2b90bf,_0x1c5c0b);const _0x43f676=_0x336c53?await fetch(_0x545f20[_0x5b4545(0x11a)],_0x545f20[_0x5b4545(0xa78)]):await fetch(_0x2621cf+_0x5b4545(0x399),{'method':_0x5b4545(0x90),'headers':{'Content-Type':_0x5b4545(0xd74),'Authorization':_0x5b4545(0xf20)+_0x48f4e0},'body':JSON['stringify']({'model':_0x4b7729,'messages':[{'role':_0x5b4545(0x152),'content':_0x2b90bf},..._0x1c5c0b],'temperature':_0x12493e[_0x5b4545(0x10f6)][_0x5b4545(0xd52)]||0.95})});if(!_0x43f676['ok'])throw new Error(_0x5b4545(0xf43)+_0x43f676[_0x5b4545(0x109a)]);const _0x1df8da=await _0x43f676[_0x5b4545(0x79e)](),_0x4a1005=getGeminiResponseText(_0x1df8da),_0xc3c929=_0x4a1005['match'](/(\[[\s\S]*\])/);if(!_0xc3c929||!_0xc3c929[0x0])throw new Error(_0x5b4545(0xd3d)+_0x4a1005);const _0x2565d7=_0xc3c929[0x0];let _0x2d2cbe;try{_0x2d2cbe=JSON['parse'](_0x2565d7)[0x0];}catch(_0x6e6de9){throw new Error(_0x5b4545(0x1127)+_0x6e6de9[_0x5b4545(0xf93)]+_0x5b4545(0x118a)+_0x4a1005);}if(!_0x51bb2f['diary'])_0x51bb2f[_0x5b4545(0x767)]=[];_0x51bb2f[_0x5b4545(0x767)][_0x5b4545(0x2d6)]({'id':Date['now'](),'title':_0x2d2cbe['title'],'content':_0x2d2cbe[_0x5b4545(0xcbd)],'timestamp':Date['now']()}),await _0x2a2987[_0x5b4545(0xc45)][_0x5b4545(0xf36)](_0x51bb2f),await _0x53e481();}catch(_0xc662fa){console[_0x5b4545(0x4d9)](_0x5b4545(0x2bd),_0xc662fa),await _0x2d7ddd(_0x5b4545(0x8b1),_0x5b4545(0xa56)+_0xc662fa[_0x5b4545(0xf93)]);}}function _0x53e481(){const _0x3e5f88=_0x247bea,_0x1d5594=document['getElementById'](_0x3e5f88(0xea7));_0x1d5594[_0x3e5f88(0x102a)]='';const _0x3ff43c=_0x12493e[_0x3e5f88(0xc45)][_0x41e464],_0x46b51b=(_0x3ff43c[_0x3e5f88(0x767)]||[])[_0x3e5f88(0x111c)]()['reverse']();if(_0x46b51b[_0x3e5f88(0x79b)]===0x0){_0x1d5594[_0x3e5f88(0x102a)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>日记本还是空的。</p>';return;}_0x46b51b['forEach'](_0x5a3db1=>{const _0x527aa3=_0x3e5f88,_0x3234db=document[_0x527aa3(0x1292)](_0x527aa3(0x58c));_0x3234db[_0x527aa3(0x84)]=_0x527aa3(0x8d4),_0x3234db[_0x527aa3(0x102a)]=_0x527aa3(0x211)+_0x5a3db1[_0x527aa3(0x874)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-content\x22>'+new Date(_0x5a3db1[_0x527aa3(0x2f0)])['toLocaleDateString']()+_0x527aa3(0x879),_0x3234db[_0x527aa3(0x205)](_0x527aa3(0x335),()=>_0x16502c(_0x5a3db1['id'])),_0x29b870(_0x3234db,()=>_0x57abd8(_0x5a3db1['id'])),_0x1d5594['appendChild'](_0x3234db);});}async function _0x16502c(_0x293d9a){const _0x153a9f=_0x247bea,_0x16f5a3=_0x12493e[_0x153a9f(0xc45)][_0x41e464];if(!_0x16f5a3||!_0x16f5a3[_0x153a9f(0x767)])return;const _0x473791=_0x16f5a3['diary']['find'](_0x5becc1=>_0x5becc1['id']===_0x293d9a);if(_0x473791){_0x1c033b=_0x473791;const _0x5e67b2=document['getElementById'](_0x153a9f(0xab5)),_0x32bdbe=document['getElementById']('char-diary-detail-content'),_0x11d832=document[_0x153a9f(0xc33)]('favorite-diary-btn');_0x5e67b2[_0x153a9f(0x11b0)]=_0x473791[_0x153a9f(0x874)];const _0x2da4f9=_0x45d05d(_0x473791[_0x153a9f(0xcbd)])[_0x153a9f(0x8d7)]('\x0a')[_0x153a9f(0x9d5)](_0xfa88e7=>'<p>'+(_0xfa88e7||_0x153a9f(0xa99))+_0x153a9f(0xcc9))['join']('');_0x32bdbe[_0x153a9f(0x102a)]=_0x2da4f9;const _0x2b0c6c=await _0x2a2987[_0x153a9f(0xe69)][_0x153a9f(0x8b5)]({'type':'char_diary','content.id':_0x293d9a})['first']();_0x11d832[_0x153a9f(0x10d3)][_0x153a9f(0xe2c)]('active',!!_0x2b0c6c),_0x11e45b(_0x153a9f(0x281));}}async function _0x3e0d8d(){const _0x263c9c=_0x247bea;if(!_0x1c033b||!_0x41e464)return;const _0x1e39e4=_0x1c033b,_0x112a5c=_0x12493e[_0x263c9c(0xc45)][_0x41e464],_0x560997=document[_0x263c9c(0xc33)](_0x263c9c(0x1287)),_0x267ef8=await _0x2a2987['favorites'][_0x263c9c(0x8b5)]({'type':'char_diary','content.id':_0x1e39e4['id']})['first']();if(_0x267ef8)await _0x2a2987[_0x263c9c(0xe69)][_0x263c9c(0x9ea)](_0x267ef8['id']),_0x560997[_0x263c9c(0x10d3)]['remove'](_0x263c9c(0x1043)),await _0x2d7ddd('操作成功','已取消收藏。');else{const _0x59ea2c={'type':'char_diary','content':{'id':_0x1e39e4['id'],'title':_0x1e39e4['title'],'content':_0x1e39e4['content'],'timestamp':_0x1e39e4['timestamp'],'characterId':_0x41e464,'characterName':_0x112a5c['name']},'timestamp':Date['now']()};await _0x2a2987['favorites']['add'](_0x59ea2c),_0x560997[_0x263c9c(0x10d3)]['add'](_0x263c9c(0x1043)),await _0x2d7ddd('操作成功','已成功收藏到“我的收藏”页面！');}}async function _0xe21f61(){const _0x322cb3=_0x247bea;if(!_0x4b387d||!_0x41e464)return;const _0x26839b=_0x4b387d,_0x118281=_0x12493e['chats'][_0x41e464],_0x1b7e7f=document[_0x322cb3(0xc33)](_0x322cb3(0xcbf)),_0x4dc7fc=await _0x2a2987[_0x322cb3(0xe69)][_0x322cb3(0x8b5)]({'type':'char_memo','content.id':_0x26839b['id']})[_0x322cb3(0x4e3)]();if(_0x4dc7fc)await _0x2a2987[_0x322cb3(0xe69)][_0x322cb3(0x9ea)](_0x4dc7fc['id']),_0x1b7e7f[_0x322cb3(0x10d3)][_0x322cb3(0x2c7)](_0x322cb3(0x1043)),await _0x2d7ddd(_0x322cb3(0x154),_0x322cb3(0xafe));else{const _0x91d4bd={'type':_0x322cb3(0x297),'content':{'id':_0x26839b['id'],'title':_0x26839b[_0x322cb3(0x874)],'content':_0x26839b['content'],'timestamp':_0x26839b[_0x322cb3(0x2f0)],'characterId':_0x41e464,'characterName':_0x118281[_0x322cb3(0x578)]},'timestamp':Date[_0x322cb3(0x6ee)]()};await _0x2a2987['favorites'][_0x322cb3(0xb9)](_0x91d4bd),_0x1b7e7f[_0x322cb3(0x10d3)][_0x322cb3(0xb9)](_0x322cb3(0x1043)),await _0x2d7ddd('操作成功',_0x322cb3(0x569));}}async function _0x57abd8(_0x2d0e8c){const _0x160b1a=_0x247bea,_0x1364bc=await _0x270512(_0x160b1a(0xed9),_0x160b1a(0x4cc),{'confirmButtonClass':_0x160b1a(0xa2)});if(_0x1364bc){const _0xd070e1=_0x12493e[_0x160b1a(0xc45)][_0x41e464];_0xd070e1['diary']=_0xd070e1[_0x160b1a(0x767)]['filter'](_0x1bd366=>_0x1bd366['id']!==_0x2d0e8c),await _0x2a2987['chats']['put'](_0xd070e1),_0x53e481();}}async function _0x351203(){const _0x1bd45d=_0x247bea,_0x3d170b=document[_0x1bd45d(0xc33)]('char-chat-list');_0x3d170b[_0x1bd45d(0x102a)]='';const _0x189530=_0x12493e[_0x1bd45d(0xc45)][_0x41e464];if(!_0x189530)return;const _0x59bcbc=_0x189530['settings'][_0x1bd45d(0xbf6)]||(_0x12493e[_0x1bd45d(0x76c)][_0x1bd45d(0x66a)]||'我'),_0x183006=_0x189530[_0x1bd45d(0x1294)][_0x1bd45d(0x1054)](_0x2d18ac=>!_0x2d18ac[_0x1bd45d(0xd07)])[_0x1bd45d(0x111c)](-0x1)[0x0]||{'content':_0x1bd45d(0xda0)};let _0x148542=_0x1bd45d(0xda0);if(_0x183006){if(typeof _0x183006['content']===_0x1bd45d(0x9de))_0x148542=_0x183006[_0x1bd45d(0xcbd)];else{if(Array[_0x1bd45d(0x621)](_0x183006['content'])&&_0x183006[_0x1bd45d(0xcbd)][0x0]?.['type']===_0x1bd45d(0x10a1))_0x148542=_0x1bd45d(0x10e1);else{if(_0x183006[_0x1bd45d(0x52a)]){const _0x2d5f65={'voice_message':_0x1bd45d(0x11d1),'transfer':_0x1bd45d(0x6d0),'ai_image':_0x1bd45d(0x10e1)};_0x148542=_0x2d5f65[_0x183006[_0x1bd45d(0x52a)]]||'['+_0x183006[_0x1bd45d(0x52a)]+']';}}}}const _0x582db1=_0x189530[_0x1bd45d(0x2ea)][_0x1bd45d(0x1006)]||_0x190acc,_0x3b3665=_0x189530[_0x1bd45d(0x2ea)][_0x1bd45d(0xe8b)]||'';let _0x262d13;_0x3b3665?_0x262d13=_0x1bd45d(0x11ab)+_0x582db1+_0x1bd45d(0x6fe)+_0x3b3665+'\x22\x20class=\x22avatar-frame\x22></div></div>':_0x262d13=_0x1bd45d(0xfb)+_0x582db1+_0x1bd45d(0x52c);const _0x44742d=document[_0x1bd45d(0x1292)](_0x1bd45d(0x58c));_0x44742d[_0x1bd45d(0x84)]='chat-list-item',_0x44742d['dataset'][_0x1bd45d(0x81d)]='-1',_0x44742d['innerHTML']=_0x1bd45d(0x5bb)+_0x262d13+_0x1bd45d(0xf24)+_0x59bcbc+_0x1bd45d(0x129d)+String(_0x148542)[_0x1bd45d(0x1033)](0x0,0x14)+_0x1bd45d(0x11e4),_0x3d170b[_0x1bd45d(0xf77)](_0x44742d);const _0x2bebc3=await _0x2a2987[_0x1bd45d(0xc61)][_0x1bd45d(0xf15)](),_0x5a1b8f=new Map(_0x2bebc3[_0x1bd45d(0x9d5)](_0x310a66=>[_0x310a66[_0x1bd45d(0x578)],_0x310a66])),_0x35cbf4=_0x189530[_0x1bd45d(0xf18)]||[];if(_0x35cbf4[_0x1bd45d(0x79b)]===0x0&&!_0x44742d){_0x3d170b[_0x1bd45d(0x102a)]=_0x1bd45d(0xfba);return;}_0x35cbf4[_0x1bd45d(0xd6a)]((_0x5430ce,_0x65898d)=>{const _0xd0c81c=_0x1bd45d;if(_0x5430ce['type']===_0xd0c81c(0xa98))return;const _0x486649=document[_0xd0c81c(0x1292)](_0xd0c81c(0x58c));_0x486649['className']=_0xd0c81c(0x56b),_0x486649[_0xd0c81c(0x85)]['conversationIndex']=_0x65898d;let _0x35a9ed,_0x14fd12,_0x1fc02f;if(_0x5430ce[_0xd0c81c(0x52a)]===_0xd0c81c(0x121f)){_0x1fc02f=_0x5430ce[_0xd0c81c(0x70e)]+_0xd0c81c(0x90f),_0x35a9ed=_0x5430ce[_0xd0c81c(0x653)][_0xd0c81c(0x111c)](-0x1)[0x0]||{'content':'...'};const _0x159bbb=_0xd0c81c(0xe78)+_0x5430ce[_0xd0c81c(0x70e)]+'\x27',_0x482acd=_0x12493e[_0xd0c81c(0x10f6)]['enableAiDrawing']?_0xd0c81c(0xda8)+encodeURIComponent(_0x159bbb):_0x2ff70a;_0x14fd12='<div\x20class=\x22avatar-group\x22><img\x20src=\x22'+_0x482acd+_0xd0c81c(0x586);}else{_0x1fc02f=_0x5430ce[_0xd0c81c(0x21b)][_0xd0c81c(0x578)],_0x35a9ed=_0x5430ce[_0xd0c81c(0x653)][_0xd0c81c(0x111c)](-0x1)[0x0]||{'content':_0xd0c81c(0xda0)};const _0x36e979=_0x5a1b8f['get'](_0x1fc02f);let _0x3a5897=_0x36e979&&_0x36e979[_0xd0c81c(0xbac)]?_0x36e979['avatar']:_0x12493e[_0xd0c81c(0x10f6)][_0xd0c81c(0xd2f)]?_0xd0c81c(0xda8)+encodeURIComponent(_0x5430ce[_0xd0c81c(0x21b)][_0xd0c81c(0x8ab)]||_0xd0c81c(0x917)):_0x5b9dd3;_0x14fd12=_0xd0c81c(0x1182)+_0x3a5897+_0xd0c81c(0x586);}let _0x204538=_0xd0c81c(0xda0);_0x35a9ed&&_0x35a9ed[_0xd0c81c(0xcbd)]&&(_0x204538=_0x35a9ed[_0xd0c81c(0xcbd)]),_0x486649[_0xd0c81c(0x102a)]=_0xd0c81c(0x10e5)+_0x14fd12+_0xd0c81c(0x9ac)+_0x1fc02f+_0xd0c81c(0x2ad)+String(_0x204538)[_0xd0c81c(0x1033)](0x0,0x14)+'...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x3d170b[_0xd0c81c(0xf77)](_0x486649);});}async function _0x5a8ef1(){const _0x12de1a=_0x247bea;if(!_0x41e464)return;const _0x2f3198=_0x12493e[_0x12de1a(0xc45)][_0x41e464];if(!_0x2f3198)return;await _0x2d7ddd(_0x12de1a(0xb37),_0x12de1a(0x1cd)+_0x2f3198['name']+_0x12de1a(0x9b7));const {proxyUrl:_0x4a56f5,apiKey:_0x26042f,model:_0x5bfed8}=_0x12493e[_0x12de1a(0xdd4)];if(!_0x4a56f5||!_0x26042f||!_0x5bfed8){alert('请先在API设置中配置好API信息。');return;}const _0x30bd88=await _0x2a2987[_0x12de1a(0xc61)][_0x12de1a(0xf15)](),_0x1f1c02=_0x30bd88[_0x12de1a(0x1054)](_0x5b995f=>_0x5b995f[_0x12de1a(0x83d)]&&_0x5b995f[_0x12de1a(0x83d)][_0x12de1a(0x1d4)](_0x41e464));let _0x5f2e99=_0x12de1a(0xf5);_0x1f1c02['length']>0x0?(_0x5f2e99+='这是你认识的、关系密切的NPC。在生成对话时，你应该【优先】与他们互动。\x0a',_0x1f1c02[_0x12de1a(0xd6a)](_0x202380=>{const _0x58374a=_0x12de1a;_0x5f2e99+=_0x58374a(0x1076)+_0x202380[_0x58374a(0x578)]+_0x58374a(0x7f1)+_0x202380[_0x58374a(0x421)]+'\x0a';})):_0x5f2e99+=_0x12de1a(0xfb4);const _0x5f0382=_0x12493e[_0x12de1a(0x76c)]['nickname']===_0x12de1a(0x10d0)||!_0x12493e[_0x12de1a(0x76c)][_0x12de1a(0x66a)]?'用户':_0x12493e[_0x12de1a(0x76c)][_0x12de1a(0x66a)],_0x50ae18=_0x2f3198[_0x12de1a(0x2ea)]['myNickname']||_0x5f0382,_0x256eaf=_0x2f3198['longTermMemory']&&_0x2f3198[_0x12de1a(0x45b)][_0x12de1a(0x79b)]>0x0?_0x2f3198[_0x12de1a(0x45b)][_0x12de1a(0x9d5)](_0x121607=>'-\x20(记录于\x20'+_0x3ce8f0(_0x121607[_0x12de1a(0x2f0)])+')\x20'+_0x121607[_0x12de1a(0xcbd)])[_0x12de1a(0x100b)]('\x0a'):'无',_0x3ac1cb=_0x2f3198[_0x12de1a(0x2ea)][_0x12de1a(0x660)]||0xa,_0x4fc1fa=_0x2f3198[_0x12de1a(0x1294)]['slice'](-_0x3ac1cb)['map'](_0x5cc888=>(_0x5cc888[_0x12de1a(0x16d)]===_0x12de1a(0x717)?_0x50ae18:_0x2f3198[_0x12de1a(0x578)])+':\x20'+String(_0x5cc888[_0x12de1a(0xcbd)])['substring'](0x0,0x1e)+_0x12de1a(0xda0))['join']('\x0a'),_0x1076ff=(_0x2f3198[_0x12de1a(0x2ea)][_0x12de1a(0xeca)]||[])[_0x12de1a(0x9d5)](_0x4c45e5=>_0x12493e[_0x12de1a(0x63a)][_0x12de1a(0xd85)](_0x1e7723=>_0x1e7723['id']===_0x4c45e5))['filter'](Boolean)[_0x12de1a(0x9d5)](_0x10712c=>_0x12de1a(0x6c6)+_0x10712c[_0x12de1a(0x578)]+_0x12de1a(0x11fa)+_0x10712c['content'][_0x12de1a(0x1054)](_0x3a6adb=>_0x3a6adb[_0x12de1a(0x95a)])[_0x12de1a(0x9d5)](_0x393980=>'-\x20'+_0x393980[_0x12de1a(0xcbd)])[_0x12de1a(0x100b)]('\x0a'))['join'](''),_0x4e8219=_0x2f3198[_0x12de1a(0x776)]||_0x2f3198[_0x12de1a(0x578)],_0xe5da38=_0x4d75d0(_0x2f3198),_0x331f94=_0x12de1a(0x1073)+_0x2f3198[_0x12de1a(0x578)]+_0x12de1a(0x72c)+_0x4e8219+'\x22,\x20\x22content\x22:\x20\x22对话内容1\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22NPC的名字\x22,\x20\x22content\x22:\x20\x22对话内容2\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22'+_0x4e8219+_0x12de1a(0xf1a)+_0x4e8219+_0x12de1a(0xd2a)+_0x2f3198[_0x12de1a(0x2ea)]['aiPersona']+_0x12de1a(0xf27)+_0x256eaf+_0x12de1a(0x751)+_0x1076ff+_0x12de1a(0x2da)+_0x4fc1fa+'\x0a'+_0x5f2e99+_0x12de1a(0x1227)+_0xe5da38+'\x0a现在，请严格按照格式铁律，生成聊天记录的JSON数组。';try{const _0x397d0a=[{'role':_0x12de1a(0x717),'content':_0x12de1a(0x271)}];let _0x56daed=_0x4a56f5[_0x12de1a(0x1d4)](_0x12de1a(0x113e)),_0x57aae1=_0x202ea1(_0x5bfed8,_0x26042f,_0x331f94,_0x397d0a);const _0x45784c=_0x56daed?await fetch(_0x57aae1[_0x12de1a(0x11a)],_0x57aae1[_0x12de1a(0xa78)]):await fetch(_0x4a56f5+_0x12de1a(0x399),{'method':_0x12de1a(0x90),'headers':{'Content-Type':_0x12de1a(0xd74),'Authorization':'Bearer\x20'+_0x26042f},'body':JSON[_0x12de1a(0xd27)]({'model':_0x5bfed8,'messages':[{'role':_0x12de1a(0x152),'content':_0x331f94},..._0x397d0a],'temperature':_0x12493e['globalSettings'][_0x12de1a(0xd52)]||0.9})});if(!_0x45784c['ok'])throw new Error('API\x20错误:\x20'+_0x45784c[_0x12de1a(0x109a)]);const _0x3174c3=await _0x45784c[_0x12de1a(0x79e)](),_0x566f6e=getGeminiResponseText(_0x3174c3),_0x5558a7=_0x566f6e[_0x12de1a(0x1242)](/(\[[\s\S]*\])/);if(!_0x5558a7||!_0x5558a7[0x0])throw new Error(_0x12de1a(0xd3d)+_0x566f6e);const _0x103d87=_0x5558a7[0x0];let _0x1bf596;try{_0x1bf596=JSON['parse'](_0x103d87);}catch(_0x1ee6be){throw new Error('解析AI返回的JSON时出错:\x20'+_0x1ee6be[_0x12de1a(0xf93)]+_0x12de1a(0x118a)+_0x566f6e);}_0x2f3198[_0x12de1a(0xf18)]=_0x1bf596,await _0x2a2987[_0x12de1a(0xc45)][_0x12de1a(0xf36)](_0x2f3198),await _0x351203();const _0x574d64={'role':_0x12de1a(0x152),'content':_0x12de1a(0xde7),'timestamp':Date['now'](),'isHidden':!![]};_0x2f3198[_0x12de1a(0x1294)][_0x12de1a(0x2d6)](_0x574d64),await _0x2a2987[_0x12de1a(0xc45)][_0x12de1a(0xf36)](_0x2f3198),_0x439587();}catch(_0x204b31){console['error']('生成模拟聊天失败:',_0x204b31),await _0x2d7ddd(_0x12de1a(0x8b1),_0x12de1a(0x422)+_0x204b31[_0x12de1a(0xf93)]);}}async function _0x529dee(){const _0x585c19=_0x247bea;if(!_0x41e464)return;const _0x56e075=_0x12493e[_0x585c19(0xc45)][_0x41e464];if(!_0x56e075)return;try{const {proxyUrl:_0x1356d8,apiKey:_0x40d704,model:_0x3b26c9}=_0x12493e['apiConfig'];if(!_0x1356d8||!_0x40d704||!_0x3b26c9)throw new Error(_0x585c19(0x6b2));const _0x344c7b=parseInt(_0x56e075['settings'][_0x585c19(0x660)])||0xa,_0x25ca1c=_0x56e075[_0x585c19(0x1294)]['slice'](-_0x344c7b),_0xd2c4f5=_0x56e075[_0x585c19(0x2ea)][_0x585c19(0xbf6)]||'我',_0x17457e=_0x56e075['settings']['myPersona']||'用户',_0x3ddcf2=_0x585c19(0xad1)+(_0x56e075[_0x585c19(0x45b)]&&_0x56e075[_0x585c19(0x45b)][_0x585c19(0x79b)]>0x0?_0x56e075[_0x585c19(0x45b)][_0x585c19(0x9d5)](_0x257361=>'-\x20'+_0x257361[_0x585c19(0xcbd)])[_0x585c19(0x100b)]('\x0a'):'-\x20(暂无)');let _0x932e61='';if(_0x56e075['settings'][_0x585c19(0xeca)]&&_0x56e075[_0x585c19(0x2ea)][_0x585c19(0xeca)]['length']>0x0){const _0x3344a2=_0x56e075[_0x585c19(0x2ea)][_0x585c19(0xeca)][_0x585c19(0x9d5)](_0x11b8b3=>{const _0x97f5d5=_0x585c19,_0x1e946e=_0x12493e[_0x97f5d5(0x63a)][_0x97f5d5(0xd85)](_0x46c06c=>_0x46c06c['id']===_0x11b8b3);if(!_0x1e946e||!Array[_0x97f5d5(0x621)](_0x1e946e[_0x97f5d5(0xcbd)]))return'';const _0x410791=_0x1e946e['content']['filter'](_0x3384b9=>_0x3384b9[_0x97f5d5(0x95a)]!==![])['map'](_0x434676=>_0x97f5d5(0xcdf)+(_0x434676[_0x97f5d5(0x8db)]||_0x97f5d5(0x2cb))+_0x97f5d5(0x65a)+_0x434676[_0x97f5d5(0xcbd)])[_0x97f5d5(0x100b)]('');return _0x410791?_0x97f5d5(0xc39)+_0x1e946e[_0x97f5d5(0x578)]+'\x0a'+_0x410791:'';})[_0x585c19(0x1054)](Boolean)[_0x585c19(0x100b)]('');_0x3344a2&&(_0x932e61='\x0a\x0a#\x20核心世界观设定\x20(必须严格遵守以下所有设定)\x0a'+_0x3344a2+'\x0a');}const _0x2b6dd2=_0x1c73eb(_0x56e075,0x3,_0x585c19(0xb69)),_0x22043b=_0x1c73eb(_0x56e075,0x6,_0x585c19(0xb69)),_0x3ddab9=_0x1c73eb(_0x56e075,0x9,'hours'),_0x295c60=_0x1c73eb(_0x56e075,0x1,_0x585c19(0x7d7)),_0x1022d5=_0x1c73eb(_0x56e075,0x3,_0x585c19(0x7d7)),_0x133d62=_0x1c73eb(_0x56e075,0x7,_0x585c19(0x7d7));let _0x58aba5='';if(_0x2b6dd2||_0x22043b||_0x3ddab9||_0x295c60||_0x1022d5||_0x133d62){_0x58aba5+=_0x585c19(0x323);if(_0x2b6dd2)_0x58aba5+=_0x2b6dd2;if(_0x22043b)_0x58aba5+=_0x22043b;if(_0x3ddab9)_0x58aba5+=_0x3ddab9;if(_0x2b6dd2||_0x22043b||_0x3ddab9)_0x58aba5+='\x0a';if(_0x295c60)_0x58aba5+=_0x295c60;if(_0x1022d5)_0x58aba5+=_0x1022d5;if(_0x133d62)_0x58aba5+=_0x133d62;}const _0x2969a7=_0x17e3b9(_0x56e075),_0x1921b2=_0x585c19(0xaa0)+_0x56e075[_0x585c19(0x776)]+'”。用户刚刚在TA的手机（CPhone）上点击了一个按钮，希望你能继续你们之前的对话。你的任务是根据上下文，生成【3到5条】符合你人设的、简短的、连续的新回复。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组，每个对象代表一条消息。\x0a-\x20格式:\x20`[{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22第一句话\x22},\x20{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22第二句话\x22},\x20{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}]`\x0a-\x20你可以自由组合使用\x20\x22text\x22,\x20\x22sticker\x22,\x20\x22ai_image\x22,\x20\x22voice_message\x22\x20等多种消息类型。\x0a请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20你的角色设定\x0a'+_0x56e075[_0x585c19(0x2ea)][_0x585c19(0x679)]+_0x585c19(0x1227)+_0x2969a7+_0x585c19(0xf97)+_0x17457e+'\x20\x20\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的本名**:\x20\x22'+_0x56e075['originalName']+_0x585c19(0x650)+_0xd2c4f5+'\x22\x0a'+_0x932e61+'\x0a'+_0x3ddcf2+'\x0a'+_0x58aba5+_0x585c19(0xeab)+_0x25ca1c[_0x585c19(0x9d5)](_0x47f0ad=>(_0x47f0ad['role']==='user'?_0xd2c4f5:_0x56e075[_0x585c19(0x578)])+':\x20'+String(_0x47f0ad[_0x585c19(0xcbd)]))['join']('\x0a')+_0x585c19(0x9ff),_0x1c88fa=_0x25ca1c[_0x585c19(0x9d5)](_0x2b84a2=>({'role':_0x2b84a2[_0x585c19(0x16d)],'content':(_0x2b84a2['role']===_0x585c19(0x717)?_0xd2c4f5:_0x56e075[_0x585c19(0x578)])+':\x20'+String(_0x2b84a2[_0x585c19(0xcbd)])}));let _0x49749c=_0x1356d8[_0x585c19(0x1d4)](_0x585c19(0x113e)),_0x73f18c=_0x202ea1(_0x3b26c9,_0x40d704,_0x1921b2,_0x1c88fa);const _0x341af9=_0x49749c?await fetch(_0x73f18c[_0x585c19(0x11a)],_0x73f18c[_0x585c19(0xa78)]):await fetch(_0x1356d8+_0x585c19(0x399),{'method':_0x585c19(0x90),'headers':{'Content-Type':_0x585c19(0xd74),'Authorization':_0x585c19(0xf20)+_0x40d704},'body':JSON['stringify']({'model':_0x3b26c9,'messages':[{'role':_0x585c19(0x152),'content':_0x1921b2},..._0x1c88fa],'temperature':_0x12493e['globalSettings'][_0x585c19(0xd52)]||0.8})});if(!_0x341af9['ok'])throw new Error('API\x20请求失败:\x20'+(await _0x341af9[_0x585c19(0x79e)]())[_0x585c19(0x4d9)][_0x585c19(0xf93)]);const _0x37e150=await _0x341af9[_0x585c19(0x79e)](),_0x3e2978=getGeminiResponseText(_0x37e150),_0xc6eab6=_0x4c5aa1(_0x3e2978);if(!_0xc6eab6||_0xc6eab6[_0x585c19(0x79b)]===0x0)throw new Error(_0x585c19(0x150));let _0x193f8b=0x0,_0x189d77=Date[_0x585c19(0x6ee)]();for(const _0x4fe133 of _0xc6eab6){const _0x2dbc51={'role':'assistant','senderName':_0x56e075[_0x585c19(0x776)],'timestamp':_0x189d77++};let _0x726c7b=null;switch(_0x4fe133['type']){case _0x585c19(0x996):_0x726c7b={..._0x2dbc51,'content':String(_0x4fe133[_0x585c19(0xcbd)]||_0x4fe133[_0x585c19(0xf93)])};break;case _0x585c19(0x966):if(_0x4fe133['meaning']){const _0x854e0=_0x12493e[_0x585c19(0x454)][_0x585c19(0xd85)](_0x580455=>_0x580455[_0x585c19(0x578)]===_0x4fe133[_0x585c19(0x127d)]);_0x854e0?_0x726c7b={..._0x2dbc51,'type':_0x585c19(0x966),'content':_0x854e0['url'],'meaning':_0x854e0['name']}:(console[_0x585c19(0x54a)](_0x585c19(0xdc0)+_0x4fe133['meaning']+'\x22'),_0x726c7b={..._0x2dbc51,'type':_0x585c19(0x996),'content':_0x585c19(0xa21)+_0x4fe133[_0x585c19(0x127d)]+']'});}else console[_0x585c19(0x54a)]('AI\x20(CPhone)\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。',_0x4fe133),_0x726c7b={..._0x2dbc51,'type':'sticker','content':_0x4fe133['url'],'meaning':_0x585c19(0x518)};break;}_0x726c7b&&(_0x56e075[_0x585c19(0x1294)][_0x585c19(0x2d6)](_0x726c7b),_0x193f8b++);}_0x193f8b>0x0&&(_0x56e075[_0x585c19(0xdc5)]=(_0x56e075['unreadCount']||0x0)+_0x193f8b),await _0x2a2987[_0x585c19(0xc45)][_0x585c19(0xf36)](_0x56e075),await _0x597ed7(),_0x193f8b>0x0&&_0x451557(_0x56e075['id'],_0x585c19(0xe64)+_0x193f8b+_0x585c19(0x11f));}catch(_0x5884a8){console['error']('从CPhone推进真实对话失败:',_0x5884a8),await _0x2d7ddd(_0x585c19(0xb9d),_0x585c19(0xbb9)+_0x5884a8[_0x585c19(0xf93)]);}}async function _0xbbf2f5(){const _0x2b0955=_0x247bea;if(_0x52add8||!_0x41e464)return;_0x52add8=!![];const _0x1138da=document[_0x2b0955(0xc33)](_0x2b0955(0x1113)),_0x9de212=_0x12493e[_0x2b0955(0xc45)][_0x41e464];if(!_0x9de212){_0x52add8=![];return;}_0x11bb7f(_0x1138da,_0x2b0955(0xcbe));const _0x13af41=_0x1138da[_0x2b0955(0xa87)];await new Promise(_0x442ef0=>setTimeout(_0x442ef0,0x1f4));const _0x259853=_0x9de212[_0x2b0955(0x1294)][_0x2b0955(0x79b)],_0x3430e2=_0x12493e[_0x2b0955(0x10f6)][_0x2b0955(0x3fd)]||0x32,_0x4708ee=_0x259853-_0x5d68c8,_0x42971e=Math[_0x2b0955(0xbf8)](0x0,_0x4708ee-_0x3430e2),_0x52edb0=_0x9de212[_0x2b0955(0x1294)]['slice'](_0x42971e,_0x4708ee);_0x153aed(_0x1138da);if(_0x52edb0[_0x2b0955(0x79b)]===0x0){_0x52add8=![];return;}for(const _0x22db1c of _0x52edb0[_0x2b0955(0xc07)]()){const _0xd63d3e={..._0x22db1c,'role':_0x22db1c[_0x2b0955(0x16d)]===_0x2b0955(0x717)?_0x2b0955(0x376):_0x2b0955(0x717)},_0x3e7249={'id':_0x2b0955(0x857),'isGroup':![],'name':_0x9de212['name'],'settings':{..._0x9de212['settings'],'myAvatar':_0x9de212[_0x2b0955(0x2ea)][_0x2b0955(0x18e)],'myAvatarFrame':_0x9de212[_0x2b0955(0x2ea)][_0x2b0955(0x435)],'aiAvatar':_0x9de212[_0x2b0955(0x2ea)][_0x2b0955(0x1006)],'aiAvatarFrame':_0x9de212[_0x2b0955(0x2ea)][_0x2b0955(0xe8b)]}},_0x4fb2b9=await _0x3f3a68(_0xd63d3e,_0x3e7249);_0x4fb2b9&&_0x1138da['prepend'](_0x4fb2b9);}_0x5d68c8+=_0x52edb0[_0x2b0955(0x79b)];const _0x46770c=_0x1138da[_0x2b0955(0xa87)];_0x1138da['scrollTop']=_0x46770c-_0x13af41,_0x52add8=![];}async function _0x90a7f3(_0x3a0c0d){const _0x2ea7ee=_0x247bea,_0x3a8397=_0x12493e['chats'][_0x41e464];if(_0x3a0c0d===-0x1){_0x200133=_0x2ea7ee(0xa98);const _0x5470f0=document[_0x2ea7ee(0xc33)](_0x2ea7ee(0x449)),_0x53cc0b=document[_0x2ea7ee(0xc33)]('char-conversation-messages'),_0xae4243=document[_0x2ea7ee(0xc33)]('char-simulated-input');_0x53cc0b[_0x2ea7ee(0x102a)]='',_0x5470f0['textContent']=_0x3a8397['settings'][_0x2ea7ee(0xbf6)]||(_0x12493e[_0x2ea7ee(0x76c)][_0x2ea7ee(0x66a)]||'我'),_0xae4243['placeholder']='与\x20'+(_0x3a8397[_0x2ea7ee(0x2ea)][_0x2ea7ee(0xbf6)]||'我')+'\x20的对话\x20(只读)',_0x5d68c8=0x0,_0x52add8=![];const _0x4436db=_0x3a8397[_0x2ea7ee(0x1294)],_0x5ef391=_0x12493e[_0x2ea7ee(0x10f6)]['chatRenderWindow']||0x32,_0x50cc86=_0x4436db[_0x2ea7ee(0x111c)](-_0x5ef391),_0x3854c3={'id':_0x2ea7ee(0x857),'isGroup':![],'name':_0x3a8397['name'],'settings':{..._0x3a8397['settings'],'myAvatar':_0x3a8397['settings'][_0x2ea7ee(0x18e)],'myAvatarFrame':_0x3a8397[_0x2ea7ee(0x2ea)][_0x2ea7ee(0x435)],'aiAvatar':_0x3a8397[_0x2ea7ee(0x2ea)][_0x2ea7ee(0x1006)],'aiAvatarFrame':_0x3a8397[_0x2ea7ee(0x2ea)][_0x2ea7ee(0xe8b)]}};for(const _0x479e5d of _0x50cc86){const _0x38259e={..._0x479e5d,'role':_0x479e5d[_0x2ea7ee(0x16d)]===_0x2ea7ee(0x717)?_0x2ea7ee(0x376):_0x2ea7ee(0x717)},_0x36e974=await _0x3f3a68(_0x38259e,_0x3854c3);_0x36e974&&_0x53cc0b['appendChild'](_0x36e974);}_0x5d68c8=_0x50cc86[_0x2ea7ee(0x79b)],_0x11e45b(_0x2ea7ee(0x160)),setTimeout(()=>_0x53cc0b[_0x2ea7ee(0x1244)]=_0x53cc0b[_0x2ea7ee(0xa87)],0x0);return;}const _0x27789c=_0x3a8397[_0x2ea7ee(0xf18)][_0x3a0c0d];if(!_0x27789c)return;_0x200133=_0x27789c[_0x2ea7ee(0x52a)];const _0x1d0b8b=await _0x2a2987[_0x2ea7ee(0xc61)][_0x2ea7ee(0xf15)](),_0x5d1370=new Map(_0x1d0b8b[_0x2ea7ee(0x9d5)](_0x1e51e7=>[_0x1e51e7['name'],_0x1e51e7])),_0x3f65c7=document[_0x2ea7ee(0xc33)]('char-conversation-partner-name'),_0x1fa4b6=document[_0x2ea7ee(0xc33)](_0x2ea7ee(0x1113)),_0x13aed9=document[_0x2ea7ee(0xc33)](_0x2ea7ee(0x4d7));_0x1fa4b6[_0x2ea7ee(0x102a)]='',_0x1fa4b6[_0x2ea7ee(0x85)][_0x2ea7ee(0x8a9)]=_0x3a8397[_0x2ea7ee(0x2ea)][_0x2ea7ee(0x8a9)]||_0x2ea7ee(0xfae);const _0x12c522=document[_0x2ea7ee(0xc33)](_0x2ea7ee(0x779))[_0x2ea7ee(0x10d3)]['contains'](_0x2ea7ee(0x10d2));_0x1fa4b6['style']['backgroundColor']=_0x12c522?_0x2ea7ee(0xa40):'#f0f2f5';let _0x54b354;if(_0x27789c['type']===_0x2ea7ee(0x121f)){_0x3f65c7[_0x2ea7ee(0x11b0)]=_0x27789c[_0x2ea7ee(0x70e)]+'\x20('+(_0x27789c[_0x2ea7ee(0x10d4)][_0x2ea7ee(0x79b)]+0x1)+')',_0x13aed9[_0x2ea7ee(0x1126)]='在\x20'+_0x27789c[_0x2ea7ee(0x70e)]+_0x2ea7ee(0xe1b),_0x54b354={'id':_0x2ea7ee(0x359),'isGroup':!![],'name':_0x27789c[_0x2ea7ee(0x70e)],'originalName':_0x3a8397['originalName'],'members':_0x27789c[_0x2ea7ee(0x10d4)]['map'](_0x33ba56=>{const _0x147908=_0x2ea7ee,_0x15712b=_0x5d1370['get'](_0x33ba56[_0x147908(0x578)]);let _0x1f58df=_0x15712b&&_0x15712b[_0x147908(0xbac)]?_0x15712b['avatar']:_0x12493e[_0x147908(0x10f6)][_0x147908(0xd2f)]?_0x147908(0xda8)+encodeURIComponent(_0x33ba56[_0x147908(0x8ab)]||_0x147908(0x917)):_0x5b9dd3;return{'originalName':_0x33ba56[_0x147908(0x578)],'groupNickname':_0x33ba56[_0x147908(0x578)],'avatar':_0x1f58df};}),'settings':{..._0x3a8397[_0x2ea7ee(0x2ea)],'myNickname':_0x3a8397['name'],'myAvatar':_0x3a8397[_0x2ea7ee(0x2ea)][_0x2ea7ee(0x18e)],'myAvatarFrame':_0x3a8397['settings'][_0x2ea7ee(0x435)]}};for(const _0x3dc6f4 of _0x27789c['messages']){const _0xd8cf89=_0x3dc6f4[_0x2ea7ee(0xe71)]===(_0x3a8397[_0x2ea7ee(0x776)]||_0x3a8397[_0x2ea7ee(0x578)]),_0x1c2264=_0xd8cf89?_0x2ea7ee(0x717):_0x2ea7ee(0x376),_0x200693={'role':_0x1c2264,'senderName':_0x3dc6f4[_0x2ea7ee(0xe71)],'content':_0x3dc6f4[_0x2ea7ee(0xcbd)],'timestamp':Date[_0x2ea7ee(0x6ee)]()+Math[_0x2ea7ee(0xa11)]()},_0x2aa915=await _0x3f3a68(_0x200693,_0x54b354);_0x2aa915&&_0x1fa4b6[_0x2ea7ee(0xf77)](_0x2aa915);}}else{_0x3f65c7[_0x2ea7ee(0x11b0)]=_0x27789c[_0x2ea7ee(0x21b)]['name'],_0x13aed9['placeholder']='与\x20'+_0x27789c[_0x2ea7ee(0x21b)][_0x2ea7ee(0x578)]+'\x20的对话';const _0x56bbf7=_0x5d1370['get'](_0x27789c[_0x2ea7ee(0x21b)][_0x2ea7ee(0x578)]),_0x2bc456=_0x56bbf7&&_0x56bbf7[_0x2ea7ee(0xbac)]?_0x56bbf7[_0x2ea7ee(0xbac)]:_0x12493e[_0x2ea7ee(0x10f6)]['enableAiDrawing']?'https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x27789c[_0x2ea7ee(0x21b)][_0x2ea7ee(0x8ab)]||_0x2ea7ee(0x917)):_0x5b9dd3;_0x54b354={'id':_0x2ea7ee(0x8f4),'isGroup':![],'name':_0x27789c[_0x2ea7ee(0x21b)][_0x2ea7ee(0x578)],'originalName':_0x3a8397['originalName'],'settings':{..._0x3a8397['settings'],'myAvatar':_0x3a8397[_0x2ea7ee(0x2ea)][_0x2ea7ee(0x18e)],'myAvatarFrame':_0x3a8397['settings']['aiAvatarFrame'],'aiAvatar':_0x2bc456,'aiAvatarFrame':''}};for(const _0x48e834 of _0x27789c['messages']){const _0x5c8d11=_0x48e834[_0x2ea7ee(0xe71)]===(_0x3a8397[_0x2ea7ee(0x776)]||_0x3a8397[_0x2ea7ee(0x578)]),_0x10b8be=_0x5c8d11?_0x2ea7ee(0x717):_0x2ea7ee(0x376),_0x4d2837={'role':_0x10b8be,'senderName':_0x48e834[_0x2ea7ee(0xe71)],'content':_0x48e834[_0x2ea7ee(0xcbd)],'timestamp':Date[_0x2ea7ee(0x6ee)]()+Math[_0x2ea7ee(0xa11)]()},_0x226a3d=await _0x3f3a68(_0x4d2837,_0x54b354);_0x226a3d&&_0x1fa4b6[_0x2ea7ee(0xf77)](_0x226a3d);}}_0x11e45b(_0x2ea7ee(0x160)),_0x1fa4b6[_0x2ea7ee(0x1244)]=_0x1fa4b6[_0x2ea7ee(0xa87)];}function _0x5a3c9f(){const _0x4c01dd=_0x247bea;document[_0x4c01dd(0xc33)](_0x4c01dd(0x7ad))[_0x4c01dd(0x10d3)][_0x4c01dd(0x2c7)]('visible');}async function _0x3bbe5f(){const _0x59190a=_0x247bea;if(!_0x41e464)return;const _0xc094d3=_0x12493e[_0x59190a(0xc45)][_0x41e464];if(!_0xc094d3){await _0x2d7ddd(_0x59190a(0xb9d),_0x59190a(0xf2c));return;}await _0x2d7ddd(_0x59190a(0xb37),'正在请求“'+_0xc094d3[_0x59190a(0x578)]+'”回忆TA的相册照片...');const {proxyUrl:_0x27c8a9,apiKey:_0x112209,model:_0x353d39}=_0x12493e[_0x59190a(0xdd4)];if(!_0x27c8a9||!_0x112209||!_0x353d39){alert('请先在API设置中配置好API信息。');return;}const _0xa4265b=_0x12493e[_0x59190a(0x76c)]['nickname']===_0x59190a(0x10d0)||!_0x12493e['qzoneSettings'][_0x59190a(0x66a)]?'用户':_0x12493e['qzoneSettings'][_0x59190a(0x66a)],_0x51a18e=_0xc094d3[_0x59190a(0x45b)]&&_0xc094d3['longTermMemory']['length']>0x0?_0xc094d3[_0x59190a(0x45b)][_0x59190a(0x9d5)](_0x4400b9=>'-\x20(记录于\x20'+_0x3ce8f0(_0x4400b9[_0x59190a(0x2f0)])+')\x20'+_0x4400b9['content'])['join']('\x0a'):'无',_0x4bb4e6=_0xc094d3['settings'][_0x59190a(0x660)]||0xa,_0x2cd28f=_0xc094d3[_0x59190a(0x1294)][_0x59190a(0x111c)](-_0x4bb4e6)[_0x59190a(0x9d5)](_0x591944=>(_0x591944[_0x59190a(0x16d)]==='user'?_0xa4265b:_0xc094d3[_0x59190a(0x578)])+':\x20'+String(_0x591944['content'])[_0x59190a(0x1033)](0x0,0x1e)+'...')[_0x59190a(0x100b)]('\x0a'),_0x84487c=(_0xc094d3[_0x59190a(0x2ea)][_0x59190a(0xeca)]||[])[_0x59190a(0x9d5)](_0x3508c9=>_0x12493e['worldBooks'][_0x59190a(0xd85)](_0x409015=>_0x409015['id']===_0x3508c9))['filter'](Boolean)[_0x59190a(0x9d5)](_0xd8e19d=>_0x59190a(0x6c6)+_0xd8e19d[_0x59190a(0x578)]+_0x59190a(0xa27)+_0xd8e19d['content']['filter'](_0x481a17=>_0x481a17[_0x59190a(0x95a)])['map'](_0x341579=>'-\x20'+_0x341579[_0x59190a(0xcbd)])['join']('\x0a'))['join'](''),_0x4359b7=_0x1c73eb(_0xc094d3,0x3,_0x59190a(0xb69)),_0x42fa57=_0x1c73eb(_0xc094d3,0x6,_0x59190a(0xb69)),_0x38be6a=_0x1c73eb(_0xc094d3,0x9,_0x59190a(0xb69)),_0x1a1a5c=_0x1c73eb(_0xc094d3,0x1,_0x59190a(0x7d7)),_0x5ca9c0=_0x1c73eb(_0xc094d3,0x3,_0x59190a(0x7d7)),_0x4a8276=_0x1c73eb(_0xc094d3,0x7,'days');let _0x2b4a00='';if(_0x4359b7||_0x42fa57||_0x38be6a||_0x1a1a5c||_0x5ca9c0||_0x4a8276){_0x2b4a00+=_0x59190a(0x323);if(_0x4359b7)_0x2b4a00+=_0x4359b7;if(_0x42fa57)_0x2b4a00+=_0x42fa57;if(_0x38be6a)_0x2b4a00+=_0x38be6a;if(_0x4359b7||_0x42fa57||_0x38be6a)_0x2b4a00+='\x0a';if(_0x1a1a5c)_0x2b4a00+=_0x1a1a5c;if(_0x5ca9c0)_0x2b4a00+=_0x5ca9c0;if(_0x4a8276)_0x2b4a00+=_0x4a8276;}const _0x37ff9a=_0x59190a(0xc22)+_0xc094d3[_0x59190a(0x578)]+_0x59190a(0x6aa)+_0xc094d3[_0x59190a(0x2ea)][_0x59190a(0x679)]+'\x0a'+_0x51a18e+'\x0a'+_0x84487c+'\x0a'+_0x2b4a00+'\x20\x0a-\x20**你最近和“'+_0xa4265b+_0x59190a(0x318)+_0x2cd28f+'\x0a\x0a现在，请开始生成这组照片的描述和绘画指令。';try{const _0x4ae3a7=[{'role':_0x59190a(0x717),'content':'请根据你的设定，生成你的相册内容。'}];let _0x1361e9=_0x27c8a9[_0x59190a(0x1d4)]('generativelanguage'),_0x7489dc=_0x202ea1(_0x353d39,_0x112209,_0x37ff9a,_0x4ae3a7);const _0x586fce=_0x1361e9?await fetch(_0x7489dc['url'],_0x7489dc['data']):await fetch(_0x27c8a9+_0x59190a(0x399),{'method':_0x59190a(0x90),'headers':{'Content-Type':_0x59190a(0xd74),'Authorization':_0x59190a(0xf20)+_0x112209},'body':JSON[_0x59190a(0xd27)]({'model':_0x353d39,'messages':[{'role':_0x59190a(0x152),'content':_0x37ff9a},..._0x4ae3a7],'temperature':_0x12493e[_0x59190a(0x10f6)][_0x59190a(0xd52)]||0.9})});if(!_0x586fce['ok'])throw new Error(_0x59190a(0xf43)+_0x586fce['statusText']);const _0x42516f=await _0x586fce[_0x59190a(0x79e)](),_0x405266=getGeminiResponseText(_0x42516f),_0x344e77=_0x405266['match'](/(\[[\s\S]*\])/);if(!_0x344e77||!_0x344e77[0x0])throw new Error('AI返回的内容中未找到有效的JSON数组。原始返回:\x20'+_0x405266);const _0x5bfa1a=_0x344e77[0x0];let _0x3f005c;try{_0x3f005c=JSON[_0x59190a(0x6b1)](_0x5bfa1a);}catch(_0x49e0b9){throw new Error(_0x59190a(0x1127)+_0x49e0b9[_0x59190a(0xf93)]+_0x59190a(0x118a)+_0x405266);}_0xc094d3[_0x59190a(0xf28)]=_0x3f005c,await _0x2a2987['chats'][_0x59190a(0xf36)](_0xc094d3),await _0x1d28b8();}catch(_0x58991e){console[_0x59190a(0x4d9)](_0x59190a(0x8c4),_0x58991e),await _0x2d7ddd(_0x59190a(0x8b1),'无法生成模拟相册，请检查API配置或稍后再试。\x0a错误:\x20'+_0x58991e[_0x59190a(0xf93)]);}}async function _0x1d28b8(){const _0x2c7c02=_0x247bea,_0x2a9174=document[_0x2c7c02(0xc33)](_0x2c7c02(0xb8f));_0x2a9174[_0x2c7c02(0x102a)]='';if(!_0x41e464)return;const _0x1b480c=_0x12493e[_0x2c7c02(0xc45)][_0x41e464],_0x272862=_0x1b480c[_0x2c7c02(0xf28)]||[];if(_0x272862[_0x2c7c02(0x79b)]===0x0){_0x2a9174[_0x2c7c02(0x102a)]=_0x2c7c02(0xdd8);return;}const _0x555bc='https://i.postimg.cc/KYr2qRCK/1.jpg';_0x272862['forEach'](_0x2658d9=>{const _0x3beaab=_0x2c7c02,_0x466f80=document[_0x3beaab(0x1292)](_0x3beaab(0x58c));_0x466f80[_0x3beaab(0x84)]=_0x3beaab(0xfc6),_0x466f80[_0x3beaab(0x85)][_0x3beaab(0x11ac)]=_0x2658d9[_0x3beaab(0x11ac)],_0x2a9174[_0x3beaab(0xf77)](_0x466f80);if(_0x12493e['globalSettings'][_0x3beaab(0xd2f)]){_0x466f80[_0x3beaab(0x105d)][_0x3beaab(0x1c5)]=_0x3beaab(0x10b7);const _0x161291=/[^\x00-\x7F]/['test'](_0x2658d9[_0x3beaab(0xe3d)]),_0x59c026=_0x2658d9[_0x3beaab(0xe3d)]&&_0x2658d9[_0x3beaab(0xe3d)]['trim']()&&!_0x161291,_0x5cb17c=_0x59c026?_0x2658d9[_0x3beaab(0xe3d)]:_0x3beaab(0x654),_0x437b8e=_0x3beaab(0xda8)+encodeURIComponent(_0x5cb17c),_0x39f6f4=new Image();_0x39f6f4['onload']=function(){const _0x5689c2=_0x3beaab;_0x466f80['style'][_0x5689c2(0x4b5)]='url('+this[_0x5689c2(0x87b)]+')';},_0x39f6f4['onerror']=function(){const _0x5487a6=_0x3beaab;_0x466f80[_0x5487a6(0x105d)][_0x5487a6(0x4b5)]=_0x5487a6(0xb23)+_0x555bc+')';},_0x39f6f4[_0x3beaab(0x87b)]=_0x437b8e;}else{_0x466f80[_0x3beaab(0x105d)]['backgroundColor']=_0x3beaab(0xf78),_0x466f80[_0x3beaab(0x105d)][_0x3beaab(0x8d8)]='1px\x20solid\x20#e0e0e0';const _0x158918=document[_0x3beaab(0x1292)]('p');_0x158918['className']=_0x3beaab(0x873),_0x158918['textContent']=_0x2658d9[_0x3beaab(0x11ac)]||_0x3beaab(0x10b5),_0x466f80['appendChild'](_0x158918);}});}async function _0x2cd80c(){const _0x59f99f=_0x247bea;if(!_0x41e464)return;const _0x500299=_0x12493e[_0x59f99f(0xc45)][_0x41e464];if(!_0x500299)return;await _0x2d7ddd(_0x59f99f(0xb37),_0x59f99f(0x6e3)+_0x500299[_0x59f99f(0x578)]+_0x59f99f(0x904));const {proxyUrl:_0x58e358,apiKey:_0x1bf21f,model:_0x1ab8e0}=_0x12493e['apiConfig'];if(!_0x58e358||!_0x1bf21f||!_0x1ab8e0){alert('API未配置，无法生成内容。');return;}const _0x469869=_0x12493e[_0x59f99f(0x76c)][_0x59f99f(0x66a)]===_0x59f99f(0x10d0)||!_0x12493e[_0x59f99f(0x76c)][_0x59f99f(0x66a)]?'用户':_0x12493e['qzoneSettings'][_0x59f99f(0x66a)],_0x47f1ba=_0x500299[_0x59f99f(0x45b)]&&_0x500299[_0x59f99f(0x45b)][_0x59f99f(0x79b)]>0x0?_0x500299[_0x59f99f(0x45b)][_0x59f99f(0x9d5)](_0x4f3e83=>_0x59f99f(0x11d4)+_0x3ce8f0(_0x4f3e83[_0x59f99f(0x2f0)])+')\x20'+_0x4f3e83[_0x59f99f(0xcbd)])[_0x59f99f(0x100b)]('\x0a'):'无',_0x383d09=_0x500299[_0x59f99f(0x2ea)][_0x59f99f(0x660)]||0xa,_0x2a5c35=_0x500299[_0x59f99f(0x1294)][_0x59f99f(0x111c)](-_0x383d09)[_0x59f99f(0x9d5)](_0x40849d=>(_0x40849d[_0x59f99f(0x16d)]===_0x59f99f(0x717)?_0x469869:_0x500299[_0x59f99f(0x578)])+':\x20'+String(_0x40849d[_0x59f99f(0xcbd)])[_0x59f99f(0x1033)](0x0,0x1e)+'...')[_0x59f99f(0x100b)]('\x0a'),_0xfcc97e=(_0x500299[_0x59f99f(0x2ea)][_0x59f99f(0xeca)]||[])[_0x59f99f(0x9d5)](_0x10d5ac=>_0x12493e[_0x59f99f(0x63a)][_0x59f99f(0xd85)](_0x351d5e=>_0x351d5e['id']===_0x10d5ac))[_0x59f99f(0x1054)](Boolean)[_0x59f99f(0x9d5)](_0x36da8c=>_0x59f99f(0x6c6)+_0x36da8c[_0x59f99f(0x578)]+_0x59f99f(0xa27)+_0x36da8c[_0x59f99f(0xcbd)][_0x59f99f(0x1054)](_0x1e31cc=>_0x1e31cc[_0x59f99f(0x95a)])['map'](_0x34de18=>'-\x20'+_0x34de18[_0x59f99f(0xcbd)])[_0x59f99f(0x100b)]('\x0a'))[_0x59f99f(0x100b)](''),_0x187576=_0x1c73eb(_0x500299,0x3,_0x59f99f(0xb69)),_0x2e3b4d=_0x1c73eb(_0x500299,0x6,_0x59f99f(0xb69)),_0x26e02a=_0x1c73eb(_0x500299,0x9,_0x59f99f(0xb69)),_0x5cdb02=_0x1c73eb(_0x500299,0x1,_0x59f99f(0x7d7)),_0x3bed84=_0x1c73eb(_0x500299,0x3,'days'),_0x23638c=_0x1c73eb(_0x500299,0x7,_0x59f99f(0x7d7));let _0x3ccfd0='';if(_0x187576||_0x2e3b4d||_0x26e02a||_0x5cdb02||_0x3bed84||_0x23638c){_0x3ccfd0+=_0x59f99f(0x323);if(_0x187576)_0x3ccfd0+=_0x187576;if(_0x2e3b4d)_0x3ccfd0+=_0x2e3b4d;if(_0x26e02a)_0x3ccfd0+=_0x26e02a;if(_0x187576||_0x2e3b4d||_0x26e02a)_0x3ccfd0+='\x0a';if(_0x5cdb02)_0x3ccfd0+=_0x5cdb02;if(_0x3bed84)_0x3ccfd0+=_0x3bed84;if(_0x23638c)_0x3ccfd0+=_0x23638c;}const _0x28080c='\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器。你的任务是扮演角色“'+_0x500299[_0x59f99f(0x578)]+'”，并根据其人设、记忆和最近的互动，虚构出【10到20条】TA最近的浏览器搜索/浏览记录。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20记录必须完全符合角色的性格、爱好、职业和生活环境。\x0a2.\x20\x20**多样性**:\x20记录类型要丰富，可以是帖子、文章、新闻、问答等。\x0a3.\x20\x20**【格式\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都代表一条浏览记录，并且【必须】使用以下格式:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22type\x22:\x20\x22text\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22一个引人注目的文章或搜索标题\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22url\x22:\x20\x22一个虚构的、看起来很真实的网址\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22一篇200-400字的、详细的文章或帖子正文，支持换行符\x5cn。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20**【绝对禁止】**:\x20你的回复中【绝对不能】包含\x20\x22type\x22:\x20\x22image\x22\x20的对象。所有记录都必须是文字内容。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20'+_0x500299[_0x59f99f(0x2ea)][_0x59f99f(0x679)]+_0x59f99f(0x74c)+_0x47f1ba+'\x0a'+_0xfcc97e+'\x0a'+_0x3ccfd0+_0x59f99f(0x655)+_0x469869+'”的对话摘要**:\x0a'+_0x2a5c35+_0x59f99f(0xbfa);try{const _0x54359b=[{'role':'user','content':_0x59f99f(0x924)}];let _0x186784=_0x58e358[_0x59f99f(0x1d4)]('generativelanguage'),_0x36401e=_0x202ea1(_0x1ab8e0,_0x1bf21f,_0x28080c,_0x54359b);const _0x4b8b61=_0x186784?await fetch(_0x36401e[_0x59f99f(0x11a)],_0x36401e['data']):await fetch(_0x58e358+'/v1/chat/completions',{'method':_0x59f99f(0x90),'headers':{'Content-Type':_0x59f99f(0xd74),'Authorization':_0x59f99f(0xf20)+_0x1bf21f},'body':JSON[_0x59f99f(0xd27)]({'model':_0x1ab8e0,'messages':[{'role':_0x59f99f(0x152),'content':_0x28080c},..._0x54359b],'temperature':_0x12493e[_0x59f99f(0x10f6)][_0x59f99f(0xd52)]||0.9})});if(!_0x4b8b61['ok'])throw new Error(_0x59f99f(0xf43)+_0x4b8b61[_0x59f99f(0x109a)]);const _0xe24300=await _0x4b8b61[_0x59f99f(0x79e)](),_0x599dd1=getGeminiResponseText(_0xe24300),_0x5d7bfb=_0x599dd1[_0x59f99f(0x1242)](/(\[[\s\S]*\])/);if(!_0x5d7bfb||!_0x5d7bfb[0x0])throw new Error(_0x59f99f(0xd3d)+_0x599dd1);const _0x34692b=_0x5d7bfb[0x0];let _0x16be27;try{_0x16be27=JSON['parse'](_0x34692b);}catch(_0xb4182b){throw new Error(_0x59f99f(0x1127)+_0xb4182b[_0x59f99f(0xf93)]+'\x0a\x0aAI原始返回内容:\x0a'+_0x599dd1);}_0x500299[_0x59f99f(0x9c8)]=_0x16be27,await _0x2a2987['chats'][_0x59f99f(0xf36)](_0x500299),await _0x5e7dcd();}catch(_0x4e6a9a){console[_0x59f99f(0x4d9)](_0x59f99f(0x989),_0x4e6a9a),await _0x2d7ddd(_0x59f99f(0x8b1),_0x59f99f(0x1117)+_0x4e6a9a['message']);}}function _0x5e7dcd(){const _0x5a683b=_0x247bea,_0x2f105b=document[_0x5a683b(0xc33)](_0x5a683b(0x11f8));_0x2f105b[_0x5a683b(0x102a)]='';if(!_0x41e464)return;const _0x5da7eb=_0x12493e[_0x5a683b(0xc45)][_0x41e464],_0x39fda2=_0x5da7eb[_0x5a683b(0x9c8)]||[];if(_0x39fda2[_0x5a683b(0x79b)]===0x0){_0x2f105b[_0x5a683b(0x102a)]=_0x5a683b(0x10bb);return;}_0x39fda2[_0x5a683b(0xd6a)]((_0x1bac45,_0x452cfc)=>{const _0x400bd5=_0x5a683b,_0x5bc393=document[_0x400bd5(0x1292)]('div');_0x5bc393[_0x400bd5(0x84)]=_0x400bd5(0xa6c),_0x5bc393[_0x400bd5(0x102a)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>'+_0x1bac45['title']+_0x400bd5(0x1077)+_0x1bac45[_0x400bd5(0x11a)]+_0x400bd5(0x1056),_0x5bc393[_0x400bd5(0x205)](_0x400bd5(0x335),()=>_0x8d9cc7(_0x452cfc)),_0x2f105b[_0x400bd5(0xf77)](_0x5bc393);});}async function _0x8d9cc7(_0x55a937){const _0x821c25=_0x247bea,_0x2b5141=_0x12493e[_0x821c25(0xc45)][_0x41e464],_0x405d5e=_0x2b5141[_0x821c25(0x9c8)][_0x55a937];if(!_0x405d5e)return;_0xa98e96=_0x405d5e,_0x2bc3ff(_0x405d5e),_0x11e45b('char-browser-article-screen');const _0x5bd4b3=document[_0x821c25(0xc33)]('favorite-article-btn'),_0x386a1d=await _0x2a2987[_0x821c25(0xe69)][_0x821c25(0x8b5)]({'type':_0x821c25(0x1011),'content.url':_0x405d5e[_0x821c25(0x11a)]})['first']();_0x5bd4b3[_0x821c25(0x10d3)][_0x821c25(0xe2c)](_0x821c25(0x1043),!!_0x386a1d);}async function _0x27a13d(){const _0x1786ca=_0x247bea;if(!_0xa98e96||!_0x41e464)return;const _0xe56464=_0xa98e96,_0x4b75a0=_0x12493e['chats'][_0x41e464],_0xcbf63d=document[_0x1786ca(0xc33)](_0x1786ca(0x155)),_0x485e6f=await _0x2a2987[_0x1786ca(0xe69)][_0x1786ca(0x8b5)]({'type':_0x1786ca(0x1011),'content.url':_0xe56464['url']})[_0x1786ca(0x4e3)]();if(_0x485e6f)await _0x2a2987['favorites']['delete'](_0x485e6f['id']),_0xcbf63d[_0x1786ca(0x10d3)][_0x1786ca(0x2c7)](_0x1786ca(0x1043)),await _0x2d7ddd('操作成功',_0x1786ca(0xafe));else{const _0x16a957={'type':'char_browser_article','content':{..._0xe56464,'characterId':_0x41e464,'characterName':_0x4b75a0[_0x1786ca(0x578)]},'timestamp':Date[_0x1786ca(0x6ee)]()};await _0x2a2987[_0x1786ca(0xe69)][_0x1786ca(0xb9)](_0x16a957),_0xcbf63d['classList'][_0x1786ca(0xb9)]('active'),await _0x2d7ddd(_0x1786ca(0x154),_0x1786ca(0x569));}}function _0x2bc3ff(_0x318956){const _0x40518b=_0x247bea,_0x11ec1b=document[_0x40518b(0xc33)](_0x40518b(0xd8a)),_0x22ca31=document['getElementById'](_0x40518b(0x1b1));_0x11ec1b['textContent']=_0x318956[_0x40518b(0x874)],_0x22ca31[_0x40518b(0x102a)]='',_0x318956['type']===_0x40518b(0x695)?_0x22ca31[_0x40518b(0x102a)]=_0x40518b(0xeb2)+(_0x318956['title']||_0x40518b(0x41a))+_0x40518b(0xcc9):_0x22ca31[_0x40518b(0x102a)]='<p>'+(_0x318956[_0x40518b(0xcbd)]||_0x40518b(0xd45))[_0x40518b(0xc12)](/\n/g,_0x40518b(0x808))+_0x40518b(0xcc9);}async function _0x19cc00(){const _0x1e3c14=_0x247bea;if(!_0x41e464)return;const _0x3b40e6=_0x12493e['chats'][_0x41e464];if(!_0x3b40e6)return;await _0x2d7ddd(_0x1e3c14(0xb37),_0x1e3c14(0x6e3)+_0x3b40e6[_0x1e3c14(0x578)]+_0x1e3c14(0x96e));const {proxyUrl:_0x54a002,apiKey:_0x2e110b,model:_0x138ade}=_0x12493e[_0x1e3c14(0xdd4)];if(!_0x54a002||!_0x2e110b||!_0x138ade){alert(_0x1e3c14(0x9b8));return;}const _0x1ac636=_0x12493e[_0x1e3c14(0x76c)]['nickname']===_0x1e3c14(0x10d0)||!_0x12493e[_0x1e3c14(0x76c)]['nickname']?'用户':_0x12493e[_0x1e3c14(0x76c)]['nickname'],_0x559cb0=_0x3b40e6[_0x1e3c14(0x45b)]&&_0x3b40e6[_0x1e3c14(0x45b)][_0x1e3c14(0x79b)]>0x0?_0x3b40e6[_0x1e3c14(0x45b)][_0x1e3c14(0x9d5)](_0x24db59=>_0x1e3c14(0x11d4)+_0x3ce8f0(_0x24db59[_0x1e3c14(0x2f0)])+')\x20'+_0x24db59[_0x1e3c14(0xcbd)])[_0x1e3c14(0x100b)]('\x0a'):'无',_0xf02163=_0x3b40e6['settings'][_0x1e3c14(0x660)]||0xa,_0x29dddf=_0x3b40e6[_0x1e3c14(0x1294)][_0x1e3c14(0x111c)](-_0xf02163)[_0x1e3c14(0x9d5)](_0x2f23ef=>(_0x2f23ef['role']===_0x1e3c14(0x717)?_0x1ac636:_0x3b40e6[_0x1e3c14(0x578)])+':\x20'+String(_0x2f23ef[_0x1e3c14(0xcbd)])[_0x1e3c14(0x1033)](0x0,0x1e)+_0x1e3c14(0xda0))[_0x1e3c14(0x100b)]('\x0a'),_0x14f1cd=(_0x3b40e6[_0x1e3c14(0x2ea)][_0x1e3c14(0xeca)]||[])[_0x1e3c14(0x9d5)](_0x40e002=>_0x12493e[_0x1e3c14(0x63a)][_0x1e3c14(0xd85)](_0x23b661=>_0x23b661['id']===_0x40e002))[_0x1e3c14(0x1054)](Boolean)[_0x1e3c14(0x9d5)](_0x2f5c71=>_0x1e3c14(0x6c6)+_0x2f5c71['name']+_0x1e3c14(0xa27)+_0x2f5c71['content']['filter'](_0x3b5d3d=>_0x3b5d3d[_0x1e3c14(0x95a)])[_0x1e3c14(0x9d5)](_0x37dc6a=>'-\x20'+_0x37dc6a[_0x1e3c14(0xcbd)])[_0x1e3c14(0x100b)]('\x0a'))['join'](''),_0x1435ff=_0x1c73eb(_0x3b40e6,0x3,_0x1e3c14(0xb69)),_0x4c9a8e=_0x1c73eb(_0x3b40e6,0x6,_0x1e3c14(0xb69)),_0x5f1d87=_0x1c73eb(_0x3b40e6,0x9,'hours'),_0x151ae8=_0x1c73eb(_0x3b40e6,0x1,_0x1e3c14(0x7d7)),_0x58b535=_0x1c73eb(_0x3b40e6,0x3,_0x1e3c14(0x7d7)),_0x456356=_0x1c73eb(_0x3b40e6,0x7,_0x1e3c14(0x7d7));let _0x256038='';if(_0x1435ff||_0x4c9a8e||_0x5f1d87||_0x151ae8||_0x58b535||_0x456356){_0x256038+=_0x1e3c14(0x323);if(_0x1435ff)_0x256038+=_0x1435ff;if(_0x4c9a8e)_0x256038+=_0x4c9a8e;if(_0x5f1d87)_0x256038+=_0x5f1d87;if(_0x1435ff||_0x4c9a8e||_0x5f1d87)_0x256038+='\x0a';if(_0x151ae8)_0x256038+=_0x151ae8;if(_0x58b535)_0x256038+=_0x58b535;if(_0x456356)_0x256038+=_0x456356;}const _0xd9845d=_0x1e3c14(0xc22)+_0x3b40e6['name']+'”，并根据其人设、记忆和最近的互动，虚构出TA最近的淘宝购物记录和账户余额。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**余额铁律\x20(最高优先级)**:\x20你【必须】根据角色的【经济状况】设定一个合理的\x20`totalBalance`\x20(总余额)。例如，富有的角色应该有更高的余额，而学生或经济拮据的角色则应该有较低的余额。\x0a2.\x20\x20**合理性**:\x20购买记录必须完全符合角色的性格、爱好和经济状况。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个【单一的JSON对象】。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`{`\x20开始，并以\x20`}`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记。\x0a\x20\x20\x20\x20-\x20格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22totalBalance\x22:\x2012345.67,\x20//\x20(这是一个示例数字，你必须根据角色的经济状况生成一个全新的、合理的余额！)\x0a\x20\x20\x20\x20\x20\x20\x22purchases\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22itemName\x22:\x20\x22一个具体、生动的商品名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22price\x22:\x20128.80,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22status\x22:\x20\x22已签收\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22reason\x22:\x20\x22这是角色购买这件商品的内心独白或理由，必须使用第一人称“我”来写。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22一段用于生成这张商品图片的、详细的【英文】关键词,\x20风格为\x20realistic\x20product\x20photo,\x20high\x20quality,\x20on\x20a\x20clean\x20white\x20background\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**purchases**:\x20一个包含12到15个商品对象的数组。\x0a\x20\x20\x20\x20-\x20**status\x20(订单状态)**:\x20只能从\x20\x22已签收\x22,\x20\x22待发货\x22,\x20\x22运输中\x22,\x20\x22待评价\x22\x20中选择。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20'+_0x3b40e6[_0x1e3c14(0x2ea)][_0x1e3c14(0x679)]+_0x1e3c14(0x74c)+_0x559cb0+'\x0a'+_0x14f1cd+'\x0a'+_0x256038+_0x1e3c14(0x655)+_0x1ac636+'”的对话摘要**:\x0a'+_0x29dddf+_0x1e3c14(0xf67);try{const _0x4a613b=[{'role':_0x1e3c14(0x717),'content':_0x1e3c14(0xe4f)}];let _0x333f65=_0x54a002[_0x1e3c14(0x1d4)]('generativelanguage'),_0x22866d=_0x202ea1(_0x138ade,_0x2e110b,_0xd9845d,_0x4a613b);const _0x133a29=_0x333f65?await fetch(_0x22866d['url'],_0x22866d[_0x1e3c14(0xa78)]):await fetch(_0x54a002+_0x1e3c14(0x399),{'method':'POST','headers':{'Content-Type':'application/json','Authorization':_0x1e3c14(0xf20)+_0x2e110b},'body':JSON['stringify']({'model':_0x138ade,'messages':[{'role':_0x1e3c14(0x152),'content':_0xd9845d},..._0x4a613b],'temperature':_0x12493e[_0x1e3c14(0x10f6)][_0x1e3c14(0xd52)]||0.9})});if(!_0x133a29['ok'])throw new Error(_0x1e3c14(0xf43)+_0x133a29[_0x1e3c14(0x109a)]);const _0x4c1b38=await _0x133a29['json'](),_0x3988c5=getGeminiResponseText(_0x4c1b38),_0x14ab16=_0x3988c5[_0x1e3c14(0x1242)](/({[\s\S]*})/);if(!_0x14ab16)throw new Error('AI返回的内容中未找到有效的JSON对象。');const _0x522718=JSON[_0x1e3c14(0x6b1)](_0x14ab16[0x0]);!_0x522718[_0x1e3c14(0x638)]&&(_0x522718[_0x1e3c14(0x638)]=[]),_0x3b40e6[_0x1e3c14(0x1156)]=_0x522718,await _0x2a2987[_0x1e3c14(0xc45)][_0x1e3c14(0xf36)](_0x3b40e6),await _0x3984ad();}catch(_0x533107){console['error']('生成模拟淘宝记录失败:',_0x533107),await _0x2d7ddd(_0x1e3c14(0x8b1),'无法生成购物记录，请检查API配置或稍后再试。\x0a错误:\x20'+_0x533107[_0x1e3c14(0xf93)]);}}function _0x12750b(){_0x4dd19c(),_0x11e45b('char-wallet-screen');}function _0x4dd19c(){const _0x208929=_0x247bea,_0x22b615=document[_0x208929(0xc33)](_0x208929(0x92));_0x22b615[_0x208929(0x102a)]='';const _0x56d3f6=_0x12493e[_0x208929(0xc45)][_0x41e464],_0x11f888=_0x56d3f6[_0x208929(0x1156)]||{},_0x171f1f=_0x11f888[_0x208929(0x638)]||[],_0x23a022=_0x11f888['totalBalance']||0x0,_0x427c42=document['createElement'](_0x208929(0x58c));_0x427c42[_0x208929(0x105d)]['cssText']=_0x208929(0x12b),_0x427c42['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22color:\x20#8a8a8a;\x20margin:\x200\x200\x2010px\x200;\x22>账户余额</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2032px;\x20font-weight:\x20600;\x20color:\x20#1f1f1f;\x20margin:\x200;\x22>¥'+_0x23a022[_0x208929(0xcab)](0x2)+_0x208929(0xdae),_0x22b615['appendChild'](_0x427c42);const _0x4c271e=document[_0x208929(0x1292)]('h3');_0x4c271e[_0x208929(0x11b0)]=_0x208929(0x294),_0x4c271e[_0x208929(0x105d)][_0x208929(0x4c1)]=_0x208929(0xd80),_0x22b615[_0x208929(0xf77)](_0x4c271e);if(_0x171f1f['length']===0x0){_0x22b615[_0x208929(0x102a)]+=_0x208929(0xb21);return;}_0x171f1f[_0x208929(0xd6a)](_0x2c9462=>{const _0x2f7405=_0x208929,_0x270ff1=document[_0x2f7405(0x1292)](_0x2f7405(0x58c));_0x270ff1[_0x2f7405(0x105d)][_0x2f7405(0x4c1)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20flex;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20justify-content:\x20space-between;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20align-items:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2015px\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-bottom:\x201px\x20solid\x20#f0f0f0;\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x270ff1['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-weight:\x20500;\x20margin:\x200\x200\x204px\x200;\x22>'+_0x2c9462[_0x2f7405(0xe0e)]+_0x2f7405(0x928)+_0x2c9462['status']+_0x2f7405(0x371)+(_0x2c9462['price']||0x0)[_0x2f7405(0xcab)](0x2)+_0x2f7405(0x1056),_0x22b615[_0x2f7405(0xf77)](_0x270ff1);});}async function _0x17257b(){const _0x676a0=_0x247bea;if(!_0x41e464)return;const _0x951f77=_0x12493e[_0x676a0(0xc45)][_0x41e464];if(!_0x951f77)return;await _0x2d7ddd('请稍候...',_0x676a0(0xea9)+_0x951f77[_0x676a0(0x578)]+_0x676a0(0x206));const {proxyUrl:_0x1b5aca,apiKey:_0xea2c51,model:_0x22dacf}=_0x12493e['apiConfig'];if(!_0x1b5aca||!_0xea2c51||!_0x22dacf){alert('请先在API设置中配置好API信息。');return;}const _0x2a8b3=_0x12493e[_0x676a0(0x76c)]['nickname']==='{{user}}'||!_0x12493e['qzoneSettings'][_0x676a0(0x66a)]?'用户':_0x12493e[_0x676a0(0x76c)][_0x676a0(0x66a)],_0x3c7468=_0x951f77[_0x676a0(0x45b)]&&_0x951f77['longTermMemory'][_0x676a0(0x79b)]>0x0?_0x951f77[_0x676a0(0x45b)][_0x676a0(0x9d5)](_0x6dd8f2=>_0x676a0(0x11d4)+_0x3ce8f0(_0x6dd8f2[_0x676a0(0x2f0)])+')\x20'+_0x6dd8f2[_0x676a0(0xcbd)])[_0x676a0(0x100b)]('\x0a'):'无',_0x2279c0=_0x951f77[_0x676a0(0x2ea)][_0x676a0(0x660)]||0xa,_0x3777ad=_0x951f77['history'][_0x676a0(0x111c)](-_0x2279c0)[_0x676a0(0x9d5)](_0x46c734=>(_0x46c734[_0x676a0(0x16d)]===_0x676a0(0x717)?_0x2a8b3:_0x951f77[_0x676a0(0x578)])+':\x20'+String(_0x46c734[_0x676a0(0xcbd)])[_0x676a0(0x1033)](0x0,0x1e)+'...')[_0x676a0(0x100b)]('\x0a'),_0x4d12e9=(_0x951f77[_0x676a0(0x2ea)][_0x676a0(0xeca)]||[])[_0x676a0(0x9d5)](_0x2227d3=>_0x12493e[_0x676a0(0x63a)]['find'](_0x49f11c=>_0x49f11c['id']===_0x2227d3))[_0x676a0(0x1054)](Boolean)[_0x676a0(0x9d5)](_0x153a5e=>'\x0a##\x20世界书《'+_0x153a5e[_0x676a0(0x578)]+_0x676a0(0xa27)+_0x153a5e[_0x676a0(0xcbd)][_0x676a0(0x1054)](_0x35e988=>_0x35e988[_0x676a0(0x95a)])[_0x676a0(0x9d5)](_0x3f4c60=>'-\x20'+_0x3f4c60[_0x676a0(0xcbd)])[_0x676a0(0x100b)]('\x0a'))['join'](''),_0x4a57ba=_0x1c73eb(_0x951f77,0x3,_0x676a0(0xb69)),_0x1f3b7e=_0x1c73eb(_0x951f77,0x6,_0x676a0(0xb69)),_0x5c08ee=_0x1c73eb(_0x951f77,0x9,'hours'),_0x46b910=_0x1c73eb(_0x951f77,0x1,_0x676a0(0x7d7)),_0xc056a9=_0x1c73eb(_0x951f77,0x3,_0x676a0(0x7d7)),_0x419499=_0x1c73eb(_0x951f77,0x7,_0x676a0(0x7d7));let _0x33d964='';if(_0x4a57ba||_0x1f3b7e||_0x5c08ee||_0x46b910||_0xc056a9||_0x419499){_0x33d964+='\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a';if(_0x4a57ba)_0x33d964+=_0x4a57ba;if(_0x1f3b7e)_0x33d964+=_0x1f3b7e;if(_0x5c08ee)_0x33d964+=_0x5c08ee;if(_0x4a57ba||_0x1f3b7e||_0x5c08ee)_0x33d964+='\x0a';if(_0x46b910)_0x33d964+=_0x46b910;if(_0xc056a9)_0x33d964+=_0xc056a9;if(_0x419499)_0x33d964+=_0x419499;}const _0x23221d='\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器。你的任务是扮演角色“'+_0x951f77[_0x676a0(0x578)]+_0x676a0(0x9d)+_0x951f77[_0x676a0(0x2ea)]['aiPersona']+'\x0a-\x20**你的长期记忆**:\x0a'+_0x3c7468+'\x0a'+_0x4d12e9+'\x0a'+_0x33d964+_0x676a0(0x6d5)+_0x2a8b3+'”的对话摘要**:\x0a'+_0x3777ad+_0x676a0(0x242);try{const _0x26d987=[{'role':_0x676a0(0x717),'content':'请根据你的设定，生成你的备忘录内容。'}];let _0x4583d1=_0x1b5aca[_0x676a0(0x1d4)](_0x676a0(0x113e)),_0xeaf93a=_0x202ea1(_0x22dacf,_0xea2c51,_0x23221d,_0x26d987);const _0x2ccc36=_0x4583d1?await fetch(_0xeaf93a['url'],_0xeaf93a[_0x676a0(0xa78)]):await fetch(_0x1b5aca+_0x676a0(0x399),{'method':_0x676a0(0x90),'headers':{'Content-Type':_0x676a0(0xd74),'Authorization':_0x676a0(0xf20)+_0xea2c51},'body':JSON[_0x676a0(0xd27)]({'model':_0x22dacf,'messages':[{'role':_0x676a0(0x152),'content':_0x23221d},..._0x26d987],'temperature':_0x12493e[_0x676a0(0x10f6)]['apiTemperature']||0.9})});if(!_0x2ccc36['ok']){const _0x180bd1=await _0x2ccc36[_0x676a0(0x79e)]()['catch'](()=>null),_0x5088e7=_0x180bd1?.[_0x676a0(0x4d9)]?.[_0x676a0(0xf93)]||_0x2ccc36[_0x676a0(0x109a)];throw new Error(_0x676a0(0xf43)+_0x2ccc36[_0x676a0(0xbc8)]+_0x676a0(0x804)+_0x5088e7);}const _0x4a578f=await _0x2ccc36[_0x676a0(0x79e)](),_0x1f52b2=getGeminiResponseText(_0x4a578f),_0x9215ff=_0x1f52b2[_0x676a0(0x1242)](/(\[[\s\S]*\])/);if(!_0x9215ff||!_0x9215ff[0x0])throw new Error('AI返回的内容中未找到有效的JSON数组。原始返回:\x20'+_0x1f52b2);const _0x4c901c=_0x9215ff[0x0];let _0x43247d;try{_0x43247d=JSON[_0x676a0(0x6b1)](_0x4c901c);}catch(_0xbf32f0){throw new Error(_0x676a0(0x1127)+_0xbf32f0[_0x676a0(0xf93)]+'\x0a\x0aAI原始返回内容:\x0a'+_0x1f52b2);}if(!Array[_0x676a0(0x621)](_0x43247d))throw new Error('AI返回的数据不是一个数组。原始返回:\x20'+JSON[_0x676a0(0xd27)](_0x43247d));_0x951f77[_0x676a0(0x1f1)]=_0x43247d[_0x676a0(0x9d5)](_0x2a4029=>({'id':Date[_0x676a0(0x6ee)]()+Math[_0x676a0(0xa11)](),'title':_0x2a4029[_0x676a0(0x874)],'content':_0x2a4029[_0x676a0(0xcbd)]})),await _0x2a2987['chats']['put'](_0x951f77),await _0x8e512();}catch(_0x491811){console[_0x676a0(0x4d9)](_0x676a0(0x64e),_0x491811),await _0x2d7ddd(_0x676a0(0x8b1),_0x676a0(0x7b5)+_0x491811[_0x676a0(0xf93)]);}}async function _0xc867ac(){const _0x55292e=_0x247bea;if(!_0x41e464)return;const _0x4b5704=_0x12493e[_0x55292e(0xc45)][_0x41e464];if(!_0x4b5704)return;await _0x2d7ddd('请稍候...',_0x55292e(0x112)+_0x4b5704['name']+_0x55292e(0xcc2));const {proxyUrl:_0xacd38c,apiKey:_0x5187f5,model:_0x29f3e9}=_0x12493e[_0x55292e(0xdd4)];if(!_0xacd38c||!_0x5187f5||!_0x29f3e9){alert('API未配置，无法生成内容。');return;}const _0x5e847f=_0x12493e['qzoneSettings'][_0x55292e(0x66a)]==='{{user}}'||!_0x12493e['qzoneSettings'][_0x55292e(0x66a)]?'用户':_0x12493e[_0x55292e(0x76c)]['nickname'],_0x442e84=_0x4b5704[_0x55292e(0x45b)]&&_0x4b5704[_0x55292e(0x45b)][_0x55292e(0x79b)]>0x0?_0x4b5704[_0x55292e(0x45b)]['map'](_0x2225b2=>_0x55292e(0x11d4)+_0x3ce8f0(_0x2225b2['timestamp'])+')\x20'+_0x2225b2[_0x55292e(0xcbd)])[_0x55292e(0x100b)]('\x0a'):'无',_0x47db2c=_0x4b5704['settings']['maxMemory']||0xa,_0x3d9008=_0x4b5704[_0x55292e(0x1294)]['slice'](-_0x47db2c)['map'](_0x4f690c=>(_0x4f690c[_0x55292e(0x16d)]===_0x55292e(0x717)?_0x5e847f:_0x4b5704[_0x55292e(0x578)])+':\x20'+String(_0x4f690c[_0x55292e(0xcbd)])['substring'](0x0,0x1e)+_0x55292e(0xda0))[_0x55292e(0x100b)]('\x0a'),_0x553b14=(_0x4b5704[_0x55292e(0x2ea)][_0x55292e(0xeca)]||[])[_0x55292e(0x9d5)](_0xaf3594=>_0x12493e[_0x55292e(0x63a)][_0x55292e(0xd85)](_0x4b8bcc=>_0x4b8bcc['id']===_0xaf3594))['filter'](Boolean)[_0x55292e(0x9d5)](_0x4af528=>_0x55292e(0x6c6)+_0x4af528[_0x55292e(0x578)]+_0x55292e(0xa27)+_0x4af528[_0x55292e(0xcbd)][_0x55292e(0x1054)](_0x551744=>_0x551744[_0x55292e(0x95a)])[_0x55292e(0x9d5)](_0x41893c=>'-\x20'+_0x41893c['content'])[_0x55292e(0x100b)]('\x0a'))[_0x55292e(0x100b)](''),_0x165e0b=_0x1c73eb(_0x4b5704,0x3,_0x55292e(0xb69)),_0x9199f4=_0x1c73eb(_0x4b5704,0x6,_0x55292e(0xb69)),_0x462add=_0x1c73eb(_0x4b5704,0x9,'hours'),_0x2a362b=_0x1c73eb(_0x4b5704,0x1,_0x55292e(0x7d7)),_0x59cb2d=_0x1c73eb(_0x4b5704,0x3,_0x55292e(0x7d7)),_0x42f117=_0x1c73eb(_0x4b5704,0x7,_0x55292e(0x7d7));let _0x85705d='';if(_0x165e0b||_0x9199f4||_0x462add||_0x2a362b||_0x59cb2d||_0x42f117){_0x85705d+=_0x55292e(0x323);if(_0x165e0b)_0x85705d+=_0x165e0b;if(_0x9199f4)_0x85705d+=_0x9199f4;if(_0x462add)_0x85705d+=_0x462add;if(_0x165e0b||_0x9199f4||_0x462add)_0x85705d+='\x0a';if(_0x2a362b)_0x85705d+=_0x2a362b;if(_0x59cb2d)_0x85705d+=_0x59cb2d;if(_0x42f117)_0x85705d+=_0x42f117;}const _0x5ef4ad=_0x55292e(0xc22)+_0x4b5704[_0x55292e(0x578)]+_0x55292e(0xc46)+new Date()[_0x55292e(0x7a3)]()+'**。\x0a\x20\x20\x20\x20-\x20\x20\x20你生成的【所有】足迹的\x20`timestamp`\x20字段，【必须】是今天或今天以前的日期。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】生成任何未来的日期！\x0a\x20\x20\x20\x20-\x20\x20\x20请生成一个看起来像是过去几周内的、时间【从新到旧】排列的足迹列表。\x0a2.\x20\x20**创造性与合理性**:\x20足迹必须完全符合角色的性格、爱好、职业和生活环境。\x0a3.\x20\x20**多样性**:\x20地点类型要丰富，可以包括餐厅、商场、公园、公司、朋友家等。\x0a4.\x20\x20**【格式铁律\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一条足迹，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22locationName\x22:\x20\x22一个具体、生动的地点名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22address\x22:\x20\x22一个虚构但看起来很真实的详细地址\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22comment\x22:\x20\x22这是角色对这次出行或这个地点的内心独白或评论，必须使用第一人称“我”来写。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22(可选)一段用于生成这张地点照片的、详细的【英文】关键词,\x20风格为\x20realistic\x20photo,\x20high\x20quality\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22timestamp\x22:\x20\x22符合\x20ISO\x208601\x20格式的日期时间字符串\x20(例如:\x20\x272025-09-25T18:30:00Z\x27)\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**重要**:\x20大约有【三分之一】的足迹需要包含\x20`image_prompt`\x20字段来生成一张照片。\x0a\x20\x20\x20\x20-\x20**图片**:\x20image_prompt\x20生成的图片【绝对禁止包含真人】。如果地点是室内，可以生成空无一人的场景；如果是室外，可以只有风景或建筑。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20'+_0x4b5704[_0x55292e(0x2ea)][_0x55292e(0x679)]+_0x55292e(0x74c)+_0x442e84+'\x0a'+_0x553b14+'\x0a'+_0x85705d+'\x0a-\x20**你最近和“'+_0x5e847f+_0x55292e(0x318)+_0x3d9008+_0x55292e(0xd9);try{const _0xe4cdf6=[{'role':_0x55292e(0x717),'content':_0x55292e(0x1d6)}];let _0x20e3f8=_0xacd38c['includes'](_0x55292e(0x113e)),_0x19c1d5=_0x202ea1(_0x29f3e9,_0x5187f5,_0x5ef4ad,_0xe4cdf6);const _0x21e9b5=_0x20e3f8?await fetch(_0x19c1d5['url'],_0x19c1d5['data']):await fetch(_0xacd38c+_0x55292e(0x399),{'method':_0x55292e(0x90),'headers':{'Content-Type':_0x55292e(0xd74),'Authorization':_0x55292e(0xf20)+_0x5187f5},'body':JSON['stringify']({'model':_0x29f3e9,'messages':[{'role':_0x55292e(0x152),'content':_0x5ef4ad},..._0xe4cdf6],'temperature':_0x12493e[_0x55292e(0x10f6)][_0x55292e(0xd52)]||0.9})});if(!_0x21e9b5['ok'])throw new Error(_0x55292e(0xf43)+_0x21e9b5[_0x55292e(0x109a)]);const _0x3dedf3=await _0x21e9b5[_0x55292e(0x79e)](),_0x207796=getGeminiResponseText(_0x3dedf3),_0xac419b=_0x207796[_0x55292e(0x1242)](/(\[[\s\S]*\])/);if(!_0xac419b||!_0xac419b[0x0])throw new Error(_0x55292e(0xd3d)+_0x207796);const _0x31863f=_0xac419b[0x0];let _0x183668;try{_0x183668=JSON[_0x55292e(0x6b1)](_0x31863f);}catch(_0x40f2c0){throw new Error(_0x55292e(0x1127)+_0x40f2c0[_0x55292e(0xf93)]+_0x55292e(0x118a)+_0x207796);}_0x4b5704[_0x55292e(0xf7c)]=_0x183668,await _0x2a2987['chats'][_0x55292e(0xf36)](_0x4b5704),await _0x339a63();}catch(_0x2fd2dd){console[_0x55292e(0x4d9)]('生成模拟足迹失败:',_0x2fd2dd),await _0x2d7ddd('生成失败','无法生成足迹，请检查API配置或稍后再试。\x0a错误:\x20'+_0x2fd2dd['message']);}}function _0x339a63(){const _0x1e3b92=_0x247bea,_0x1c2b6d=document[_0x1e3b92(0xc33)](_0x1e3b92(0xade));_0x1c2b6d[_0x1e3b92(0x102a)]='';if(!_0x41e464)return;const _0x26f724=_0x12493e[_0x1e3b92(0xc45)][_0x41e464],_0x1c5c34=_0x26f724['simulatedAmapHistory']||[];if(_0x1c5c34['length']===0x0){_0x1c2b6d[_0x1e3b92(0x102a)]=_0x1e3b92(0xfde);return;}_0x1c5c34['forEach'](_0x1cda50=>{const _0x38bc39=_0x1e3b92,_0x31ceba=document[_0x38bc39(0x1292)](_0x38bc39(0x58c));_0x31ceba[_0x38bc39(0x84)]=_0x38bc39(0x1239);let _0x20b894='';if(_0x1cda50[_0x38bc39(0xe3d)]){const _0x12d0db=_0x38bc39(0xda8)+encodeURIComponent(_0x1cda50[_0x38bc39(0xe3d)]);_0x20b894='<div\x20class=\x22amap-item-photo\x22\x20style=\x22background-image:\x20url(\x27'+_0x12d0db+_0x38bc39(0xb17)+_0x1cda50[_0x38bc39(0x8db)]+_0x38bc39(0xf16);}const _0x5684e1=_0x1cda50['timestamp']?_0x3ce8f0(new Date(_0x1cda50[_0x38bc39(0x2f0)])['getTime']()):_0x38bc39(0x25a);_0x31ceba[_0x38bc39(0x102a)]=_0x38bc39(0x7df)+_0x1cda50[_0x38bc39(0x106d)]+_0x38bc39(0xe60)+_0x1cda50['address']+_0x38bc39(0xbbe)+_0x1cda50[_0x38bc39(0x8db)]['replace'](/\n/g,_0x38bc39(0xfd5))+_0x38bc39(0xd62)+_0x20b894+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-footer\x22>'+_0x5684e1+_0x38bc39(0x879),_0x1c2b6d[_0x38bc39(0xf77)](_0x31ceba);});}async function _0xea8068(){const _0x207cd6=_0x247bea;if(!_0x41e464)return;const _0x3baf77=_0x12493e[_0x207cd6(0xc45)][_0x41e464];if(!_0x3baf77)return;await _0x2d7ddd(_0x207cd6(0xb37),_0x207cd6(0x21e)+_0x3baf77['name']+'”的手机使用习惯...');const {proxyUrl:_0x31517b,apiKey:_0x35317f,model:_0x47036c}=_0x12493e[_0x207cd6(0xdd4)];if(!_0x31517b||!_0x35317f||!_0x47036c){alert(_0x207cd6(0x9b8));return;}const _0x29194f=_0x12493e[_0x207cd6(0x76c)][_0x207cd6(0x66a)]===_0x207cd6(0x10d0)||!_0x12493e[_0x207cd6(0x76c)]['nickname']?'用户':_0x12493e[_0x207cd6(0x76c)][_0x207cd6(0x66a)],_0xd92d2b=_0x3baf77[_0x207cd6(0x45b)]&&_0x3baf77[_0x207cd6(0x45b)][_0x207cd6(0x79b)]>0x0?_0x3baf77[_0x207cd6(0x45b)][_0x207cd6(0x9d5)](_0x17dd5c=>_0x207cd6(0x11d4)+_0x3ce8f0(_0x17dd5c[_0x207cd6(0x2f0)])+')\x20'+_0x17dd5c[_0x207cd6(0xcbd)])[_0x207cd6(0x100b)]('\x0a'):'无',_0x1af862=_0x3baf77[_0x207cd6(0x2ea)][_0x207cd6(0x660)]||0xa,_0x49116d=_0x3baf77[_0x207cd6(0x1294)][_0x207cd6(0x111c)](-_0x1af862)[_0x207cd6(0x9d5)](_0x3fee10=>(_0x3fee10[_0x207cd6(0x16d)]===_0x207cd6(0x717)?_0x29194f:_0x3baf77[_0x207cd6(0x578)])+':\x20'+String(_0x3fee10[_0x207cd6(0xcbd)])[_0x207cd6(0x1033)](0x0,0x1e)+'...')[_0x207cd6(0x100b)]('\x0a'),_0x5b0519=(_0x3baf77[_0x207cd6(0x2ea)][_0x207cd6(0xeca)]||[])['map'](_0x2d4555=>_0x12493e['worldBooks'][_0x207cd6(0xd85)](_0x267606=>_0x267606['id']===_0x2d4555))[_0x207cd6(0x1054)](Boolean)[_0x207cd6(0x9d5)](_0x215e22=>_0x207cd6(0x6c6)+_0x215e22['name']+'》设定:\x0a'+_0x215e22['content']['filter'](_0x38c723=>_0x38c723['enabled'])['map'](_0x255cc3=>'-\x20'+_0x255cc3[_0x207cd6(0xcbd)])[_0x207cd6(0x100b)]('\x0a'))['join'](''),_0x46aaf0=_0x1c73eb(_0x3baf77,0x3,_0x207cd6(0xb69)),_0xf0b964=_0x1c73eb(_0x3baf77,0x6,'hours'),_0x3062d5=_0x1c73eb(_0x3baf77,0x9,_0x207cd6(0xb69)),_0x162d3a=_0x1c73eb(_0x3baf77,0x1,_0x207cd6(0x7d7)),_0x32ac5f=_0x1c73eb(_0x3baf77,0x3,_0x207cd6(0x7d7)),_0x4a1d2b=_0x1c73eb(_0x3baf77,0x7,_0x207cd6(0x7d7));let _0x3789e4='';if(_0x46aaf0||_0xf0b964||_0x3062d5||_0x162d3a||_0x32ac5f||_0x4a1d2b){_0x3789e4+='\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a';if(_0x46aaf0)_0x3789e4+=_0x46aaf0;if(_0xf0b964)_0x3789e4+=_0xf0b964;if(_0x3062d5)_0x3789e4+=_0x3062d5;if(_0x46aaf0||_0xf0b964||_0x3062d5)_0x3789e4+='\x0a';if(_0x162d3a)_0x3789e4+=_0x162d3a;if(_0x32ac5f)_0x3789e4+=_0x32ac5f;if(_0x4a1d2b)_0x3789e4+=_0x4a1d2b;}const _0x550b7e=_0x207cd6(0xc22)+_0x3baf77[_0x207cd6(0x578)]+_0x207cd6(0x8e5)+_0x3baf77[_0x207cd6(0x2ea)][_0x207cd6(0x679)]+'\x0a-\x20**你的长期记忆**:\x0a'+_0xd92d2b+'\x0a'+_0x5b0519+'\x0a'+_0x3789e4+'\x0a-\x20**你最近和“'+_0x29194f+'”的对话摘要**:\x0a'+_0x49116d+'\x0a\x0a现在，请开始生成这组App使用记录。';try{const _0x9d6eb5=[{'role':_0x207cd6(0x717),'content':_0x207cd6(0x8a6)}];let _0x1bb32b=_0x31517b[_0x207cd6(0x1d4)](_0x207cd6(0x113e)),_0x366d62=_0x202ea1(_0x47036c,_0x35317f,_0x550b7e,_0x9d6eb5);const _0x15aedc=_0x1bb32b?await fetch(_0x366d62['url'],_0x366d62[_0x207cd6(0xa78)]):await fetch(_0x31517b+_0x207cd6(0x399),{'method':_0x207cd6(0x90),'headers':{'Content-Type':'application/json','Authorization':_0x207cd6(0xf20)+_0x35317f},'body':JSON[_0x207cd6(0xd27)]({'model':_0x47036c,'messages':[{'role':'system','content':_0x550b7e},..._0x9d6eb5],'temperature':_0x12493e[_0x207cd6(0x10f6)][_0x207cd6(0xd52)]||0.9})});if(!_0x15aedc['ok'])throw new Error(_0x207cd6(0xf43)+_0x15aedc[_0x207cd6(0x109a)]);const _0x519886=await _0x15aedc[_0x207cd6(0x79e)](),_0x48666d=getGeminiResponseText(_0x519886),_0x18d07e=_0x48666d[_0x207cd6(0xc12)](/^```json\s*/,'')[_0x207cd6(0xc12)](/```$/,''),_0x3e1787=JSON[_0x207cd6(0x6b1)](_0x18d07e);_0x3baf77[_0x207cd6(0xf0d)]=_0x3e1787,await _0x2a2987['chats'][_0x207cd6(0xf36)](_0x3baf77),await _0x543ea9();}catch(_0x1842f2){console[_0x207cd6(0x4d9)](_0x207cd6(0x5f4),_0x1842f2),await _0x2d7ddd(_0x207cd6(0x8b1),'无法生成记录，请检查API配置或稍后再试。\x0a错误:\x20'+_0x1842f2[_0x207cd6(0xf93)]);}}function _0x543ea9(){const _0x50c865=_0x247bea,_0xfb414e=document[_0x50c865(0xc33)]('char-usage-list');_0xfb414e[_0x50c865(0x102a)]='';if(!_0x41e464)return;const _0x260461=_0x12493e[_0x50c865(0xc45)][_0x41e464],_0x2fa5b5=(_0x260461[_0x50c865(0xf0d)]||[])[_0x50c865(0xbb3)]((_0x270f90,_0x2f99b9)=>_0x2f99b9[_0x50c865(0x7b9)]-_0x270f90[_0x50c865(0x7b9)]);if(_0x2fa5b5[_0x50c865(0x79b)]===0x0){_0xfb414e['innerHTML']=_0x50c865(0x2f8);return;}_0x2fa5b5['forEach'](_0x3b50c5=>{const _0x41a9a5=_0x50c865,_0x3acd19=document[_0x41a9a5(0x1292)](_0x41a9a5(0x58c));_0x3acd19[_0x41a9a5(0x84)]=_0x41a9a5(0xde8);const _0x4e067d=Math['floor'](_0x3b50c5[_0x41a9a5(0x7b9)]/0x3c),_0x1ac5fc=_0x3b50c5['usageTimeMinutes']%0x3c;let _0x51ed45='';if(_0x4e067d>0x0)_0x51ed45+=_0x4e067d+'小时';if(_0x1ac5fc>0x0)_0x51ed45+=_0x1ac5fc+'分钟';if(!_0x51ed45)_0x51ed45=_0x41a9a5(0x308);const _0x2358ee=_0x3b50c5['image_prompt']||'modern\x20app\x20icon\x20for\x20'+_0x3b50c5[_0x41a9a5(0x742)]+_0x41a9a5(0xbfc),_0x485111=_0x41a9a5(0xda8)+encodeURIComponent(_0x2358ee);_0x3acd19[_0x41a9a5(0x102a)]=_0x41a9a5(0x173)+_0x485111+_0x41a9a5(0xeb4)+_0x3b50c5[_0x41a9a5(0x742)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-category\x22>'+_0x3b50c5['category']+_0x41a9a5(0x1088)+_0x51ed45+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0xfb414e[_0x41a9a5(0xf77)](_0x3acd19);});}async function _0x2b59ec(){const _0x3c9a1b=_0x247bea;if(!_0x41e464)return;const _0x57eed3=_0x12493e[_0x3c9a1b(0xc45)][_0x41e464];if(!_0x57eed3)return;await _0x2d7ddd(_0x3c9a1b(0xb37),_0x3c9a1b(0xea9)+_0x57eed3[_0x3c9a1b(0x578)]+_0x3c9a1b(0x1062));const {proxyUrl:_0x11bbba,apiKey:_0x5d394e,model:_0x4522e2}=_0x12493e[_0x3c9a1b(0xdd4)];if(!_0x11bbba||!_0x5d394e||!_0x4522e2){alert(_0x3c9a1b(0xabe));return;}const _0x43fc66=_0x12493e['qzoneSettings'][_0x3c9a1b(0x66a)]===_0x3c9a1b(0x10d0)||!_0x12493e[_0x3c9a1b(0x76c)][_0x3c9a1b(0x66a)]?'用户':_0x12493e[_0x3c9a1b(0x76c)][_0x3c9a1b(0x66a)],_0x15cb06=_0x57eed3[_0x3c9a1b(0x45b)]&&_0x57eed3[_0x3c9a1b(0x45b)][_0x3c9a1b(0x79b)]>0x0?_0x57eed3[_0x3c9a1b(0x45b)][_0x3c9a1b(0x9d5)](_0x36e70c=>_0x3c9a1b(0x11d4)+_0x3ce8f0(_0x36e70c[_0x3c9a1b(0x2f0)])+')\x20'+_0x36e70c[_0x3c9a1b(0xcbd)])[_0x3c9a1b(0x100b)]('\x0a'):'无',_0x13f84c=_0x57eed3[_0x3c9a1b(0x2ea)][_0x3c9a1b(0x660)]||0xa,_0x40a7dc=_0x57eed3[_0x3c9a1b(0x1294)][_0x3c9a1b(0x111c)](-_0x13f84c)[_0x3c9a1b(0x9d5)](_0x56e042=>(_0x56e042['role']==='user'?_0x43fc66:_0x57eed3[_0x3c9a1b(0x578)])+':\x20'+String(_0x56e042['content'])[_0x3c9a1b(0x1033)](0x0,0x1e)+'...')['join']('\x0a'),_0x4c8df3=(_0x57eed3[_0x3c9a1b(0x2ea)]['linkedWorldBookIds']||[])[_0x3c9a1b(0x9d5)](_0x4ef75a=>_0x12493e[_0x3c9a1b(0x63a)]['find'](_0x3a6580=>_0x3a6580['id']===_0x4ef75a))['filter'](Boolean)['map'](_0x101414=>_0x3c9a1b(0x6c6)+_0x101414[_0x3c9a1b(0x578)]+_0x3c9a1b(0xa27)+_0x101414[_0x3c9a1b(0xcbd)][_0x3c9a1b(0x1054)](_0x17a036=>_0x17a036[_0x3c9a1b(0x95a)])['map'](_0x28dcc1=>'-\x20'+_0x28dcc1[_0x3c9a1b(0xcbd)])[_0x3c9a1b(0x100b)]('\x0a'))[_0x3c9a1b(0x100b)](''),_0x35618c=_0x3c9a1b(0x116f)+_0x57eed3[_0x3c9a1b(0x578)]+'”，并根据其人设、记忆和最近的互动，挑选出【14到18首】最能代表TA此刻心情或品味的歌曲。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20歌单必须完全符合角色的性格、爱好和生活背景。\x0a2.\x20\x20**多样性**:\x20歌曲风格可以多样，但必须逻辑自洽。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一首歌，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22songName\x22:\x20\x22歌曲的准确名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22artistName\x22:\x20\x22歌曲的准确艺术家/歌手名\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20'+_0x57eed3['settings'][_0x3c9a1b(0x679)]+_0x3c9a1b(0x74c)+_0x15cb06+'\x0a'+_0x4c8df3+_0x3c9a1b(0x6d5)+_0x43fc66+'”的对话摘要**:\x0a'+_0x40a7dc+_0x3c9a1b(0x8fc);try{const _0xc63514=[{'role':_0x3c9a1b(0x717),'content':_0x3c9a1b(0x184)}];let _0x4e413d=_0x11bbba['includes']('generativelanguage'),_0x4fd6b4=_0x202ea1(_0x4522e2,_0x5d394e,_0x35618c,_0xc63514);const _0x5e00c5=_0x4e413d?await fetch(_0x4fd6b4[_0x3c9a1b(0x11a)],_0x4fd6b4[_0x3c9a1b(0xa78)]):await fetch(_0x11bbba+_0x3c9a1b(0x399),{'method':_0x3c9a1b(0x90),'headers':{'Content-Type':'application/json','Authorization':_0x3c9a1b(0xf20)+_0x5d394e},'body':JSON['stringify']({'model':_0x4522e2,'messages':[{'role':_0x3c9a1b(0x152),'content':_0x35618c},..._0xc63514],'temperature':_0x12493e[_0x3c9a1b(0x10f6)][_0x3c9a1b(0xd52)]||0x1})});if(!_0x5e00c5['ok'])throw new Error('API\x20错误:\x20'+_0x5e00c5[_0x3c9a1b(0x109a)]);const _0xd430e9=await _0x5e00c5['json'](),_0x2eb5d1=getGeminiResponseText(_0xd430e9),_0x35bd00=_0x2eb5d1[_0x3c9a1b(0xc12)](/^```json\s*/,'')['replace'](/```$/,''),_0x4b06b4=JSON[_0x3c9a1b(0x6b1)](_0x35bd00);await _0x2d7ddd(_0x3c9a1b(0xb37),_0x3c9a1b(0xb5f)+_0x4b06b4[_0x3c9a1b(0x79b)]+_0x3c9a1b(0x225));const _0x321096=_0x4b06b4['map'](async _0x47abe7=>{const _0x55eb8d=_0x3c9a1b;let _0x5cb64b=await _0x76ab06(_0x47abe7[_0x55eb8d(0x66f)],_0x47abe7[_0x55eb8d(0xa1d)]);(!_0x5cb64b||_0x5cb64b['length']===0x0)&&(_0x5cb64b=await _0x1c6c06(_0x47abe7[_0x55eb8d(0x66f)]));if(_0x5cb64b['length']>0x0)return _0x38a376(_0x5cb64b[0x0]);return console[_0x55eb8d(0x54a)](_0x55eb8d(0xbdd)+_0x47abe7[_0x55eb8d(0x66f)]+_0x55eb8d(0x804)+_0x47abe7[_0x55eb8d(0xa1d)]+'”'),null;}),_0x4b18db=(await Promise[_0x3c9a1b(0x5c8)](_0x321096))['filter'](Boolean);_0x57eed3[_0x3c9a1b(0xc23)]=_0x4b18db,await _0x2a2987[_0x3c9a1b(0xc45)][_0x3c9a1b(0xf36)](_0x57eed3),await _0x1ad6e6();}catch(_0x2da302){console[_0x3c9a1b(0x4d9)](_0x3c9a1b(0x59c),_0x2da302),await _0x2d7ddd('生成失败',_0x3c9a1b(0xd00)+_0x2da302[_0x3c9a1b(0xf93)]);}}function _0x1ad6e6(){const _0x2b3ed5=_0x247bea,_0x1d0266=document[_0x2b3ed5(0xc33)](_0x2b3ed5(0x44b));_0x1d0266[_0x2b3ed5(0x102a)]='';if(!_0x41e464)return;const _0xf2edcd=_0x12493e[_0x2b3ed5(0xc45)][_0x41e464],_0x329f9b=_0xf2edcd[_0x2b3ed5(0xc23)]||[];if(_0x329f9b[_0x2b3ed5(0x79b)]===0x0){_0x1d0266[_0x2b3ed5(0x102a)]=_0x2b3ed5(0x10a6);return;}_0x329f9b[_0x2b3ed5(0xd6a)]((_0x63b4b0,_0x5c3c55)=>{const _0x37d388=_0x2b3ed5,_0x3e544d=document[_0x37d388(0x1292)]('div');_0x3e544d['className']=_0x37d388(0x24d),_0x3e544d['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x63b4b0[_0x37d388(0xd87)]+_0x37d388(0x11e1)+_0x63b4b0['name']+_0x37d388(0x91f)+_0x63b4b0[_0x37d388(0x200)]+_0x37d388(0x17b),_0x3e544d[_0x37d388(0x205)](_0x37d388(0x335),()=>_0x2f8d6d(_0x63b4b0)),_0x1d0266['appendChild'](_0x3e544d);});}let _0x5d50ec={'currentPlaylist':[],'currentIndex':-0x1,'isPlaying':![],'playMode':_0x247bea(0x7e9),'lrcUpdateInterval':null,'parsedLyrics':[],'currentLyricIndex':-0x1};function _0x2f8d6d(_0x5c985b){const _0x1dbb28=_0x247bea,_0x20df4e=document['getElementById'](_0x1dbb28(0xf8)),_0x1620e7=document['getElementById']('char-music-player-modal');if(_0x5d50ec[_0x1dbb28(0xc69)])clearInterval(_0x5d50ec[_0x1dbb28(0xc69)]);_0x20df4e[_0x1dbb28(0x47a)]();const _0x4faf5f=_0x5d50ec[_0x1dbb28(0x6a9)]['findIndex'](_0xdd401=>_0xdd401[_0x1dbb28(0x87b)]===_0x5c985b[_0x1dbb28(0x87b)]);_0x4faf5f>-0x1?_0x5d50ec[_0x1dbb28(0x12a0)]=_0x4faf5f:(_0x5d50ec['currentPlaylist']=[_0x5c985b],_0x5d50ec[_0x1dbb28(0x12a0)]=0x0);document['getElementById'](_0x1dbb28(0x694))[_0x1dbb28(0x11b0)]=_0x5c985b['name'],document[_0x1dbb28(0xc33)](_0x1dbb28(0x98a))[_0x1dbb28(0x11b0)]=_0x5c985b[_0x1dbb28(0x200)],document[_0x1dbb28(0xc33)](_0x1dbb28(0x532))[_0x1dbb28(0x87b)]=_0x5c985b[_0x1dbb28(0xd87)],_0x5d50ec['parsedLyrics']=_0x35419b(_0x5c985b['lrcContent']||''),_0x25bd45();if(_0x5c985b[_0x1dbb28(0x616)]){const _0xcca02f=new Blob([_0x5c985b['src']],{'type':_0x5c985b[_0x1dbb28(0x324)]||'audio/mpeg'});_0x20df4e['src']=URL[_0x1dbb28(0xca2)](_0xcca02f);}else _0x20df4e['src']=_0x5c985b['src'];_0x20df4e['play']()[_0x1dbb28(0x876)](_0x4cb9db=>console[_0x1dbb28(0x4d9)](_0x1dbb28(0x3a9),_0x4cb9db)),_0x20df4e[_0x1dbb28(0x2b1)]=()=>{const _0x26e886=_0x1dbb28;document[_0x26e886(0xc33)](_0x26e886(0x10d7))[_0x26e886(0x11b0)]=_0x3bff12(_0x20df4e['duration']),_0x5d50ec[_0x26e886(0xc69)]=setInterval(_0x5066fb,0x1f4);},_0x1620e7[_0x1dbb28(0x10d3)][_0x1dbb28(0xb9)](_0x1dbb28(0x143));}function _0x2fc404(){const _0xe50cc6=_0x247bea,_0x4b1f17=document[_0xe50cc6(0xc33)](_0xe50cc6(0x6b6)),_0xd291ca=document[_0xe50cc6(0xc33)]('char-audio-player');if(_0x5d50ec['lrcUpdateInterval'])clearInterval(_0x5d50ec['lrcUpdateInterval']);_0xd291ca[_0xe50cc6(0x47a)](),_0xd291ca[_0xe50cc6(0x87b)]='',_0x4b1f17[_0xe50cc6(0x10d3)][_0xe50cc6(0x2c7)](_0xe50cc6(0x143)),_0x5d50ec[_0xe50cc6(0xa4e)]=![],document[_0xe50cc6(0xc33)](_0xe50cc6(0x9d0))[_0xe50cc6(0x10d3)][_0xe50cc6(0x2c7)](_0xe50cc6(0x7b8));}function _0x5066fb(){const _0x1c521e=_0x247bea,_0x29af43=document[_0x1c521e(0xc33)](_0x1c521e(0xf8));if(!_0x29af43['duration'])return;const _0xc2934c=_0x29af43[_0x1c521e(0x10ba)],_0x977e69=_0x29af43['duration'];document[_0x1c521e(0xc33)]('char-music-progress-fill')['style']['width']=_0xc2934c/_0x977e69*0x64+'%',document['getElementById'](_0x1c521e(0x934))[_0x1c521e(0x11b0)]=_0x3bff12(_0xc2934c),_0x2cb805(_0xc2934c);}function _0x25bd45(){const _0x4be0dc=_0x247bea,_0x1ac04d=document['getElementById']('char-music-lyrics');_0x1ac04d[_0x4be0dc(0x102a)]='',_0x5d50ec[_0x4be0dc(0x612)]=-0x1;if(!_0x5d50ec[_0x4be0dc(0x1ca)]||_0x5d50ec[_0x4be0dc(0x1ca)]['length']===0x0){_0x1ac04d['innerHTML']='<p>♪\x20暂无歌词\x20♪</p>';return;}_0x5d50ec[_0x4be0dc(0x1ca)][_0x4be0dc(0xd6a)]((_0x2e31d8,_0x442179)=>{const _0x2d0424=_0x4be0dc,_0x27121c=document[_0x2d0424(0x1292)]('p');_0x27121c[_0x2d0424(0x11b0)]=_0x2e31d8[_0x2d0424(0x996)],_0x27121c[_0x2d0424(0x85)][_0x2d0424(0xad)]=_0x442179,_0x1ac04d[_0x2d0424(0xf77)](_0x27121c);});}function _0x2cb805(_0x5b0e00){const _0x150450=_0x247bea,_0x21af0=_0x5d50ec['parsedLyrics'];if(_0x21af0[_0x150450(0x79b)]===0x0)return;let _0x2fc03e=-0x1;for(let _0xe79c8b=0x0;_0xe79c8b<_0x21af0[_0x150450(0x79b)];_0xe79c8b++){if(_0x5b0e00>=_0x21af0[_0xe79c8b][_0x150450(0x61f)])_0x2fc03e=_0xe79c8b;else break;}if(_0x2fc03e===_0x5d50ec[_0x150450(0x612)])return;_0x5d50ec['currentLyricIndex']=_0x2fc03e;const _0x238e3c=document[_0x150450(0xc33)](_0x150450(0xfdb)),_0x43a7d1=_0x238e3c[_0x150450(0x67a)]('p');_0x43a7d1[_0x150450(0xd6a)](_0x109166=>_0x109166[_0x150450(0x10d3)][_0x150450(0x2c7)](_0x150450(0x1043)));if(_0x2fc03e>-0x1){const _0x5e3edc=_0x238e3c[_0x150450(0x977)](_0x150450(0x598)+_0x2fc03e+'\x22]');if(_0x5e3edc){_0x5e3edc[_0x150450(0x10d3)][_0x150450(0xb9)]('active');const _0x2ab7fc=_0x238e3c[_0x150450(0xe53)]/0x2-_0x5e3edc['offsetTop']-_0x5e3edc[_0x150450(0x1a0)]/0x2;_0x43a7d1[_0x150450(0xd6a)](_0x4447cf=>{const _0x2e7d5e=_0x150450;_0x4447cf[_0x2e7d5e(0x105d)][_0x2e7d5e(0x404)]=_0x2e7d5e(0xa8)+_0x2ab7fc+'px)';});}}}function _0x453a87(){const _0x3fc557=_0x247bea;if(_0x5d50ec['currentPlaylist'][_0x3fc557(0x79b)]===0x0)return;let _0x16c5dc;switch(_0x5d50ec[_0x3fc557(0x6f8)]){case'random':_0x16c5dc=Math['floor'](Math[_0x3fc557(0xa11)]()*_0x5d50ec['currentPlaylist'][_0x3fc557(0x79b)]);break;case _0x3fc557(0xde):_0x2f8d6d(_0x5d50ec[_0x3fc557(0x6a9)][_0x5d50ec[_0x3fc557(0x12a0)]]);return;case _0x3fc557(0x7e9):default:_0x16c5dc=(_0x5d50ec[_0x3fc557(0x12a0)]+0x1)%_0x5d50ec[_0x3fc557(0x6a9)][_0x3fc557(0x79b)];break;}_0x2f8d6d(_0x5d50ec[_0x3fc557(0x6a9)][_0x16c5dc]);}function _0x129dcf(){const _0x2b28be=_0x247bea;if(_0x5d50ec[_0x2b28be(0x6a9)][_0x2b28be(0x79b)]===0x0)return;const _0xe4ba9=(_0x5d50ec['currentIndex']-0x1+_0x5d50ec[_0x2b28be(0x6a9)][_0x2b28be(0x79b)])%_0x5d50ec[_0x2b28be(0x6a9)][_0x2b28be(0x79b)];_0x2f8d6d(_0x5d50ec[_0x2b28be(0x6a9)][_0xe4ba9]);}function _0x4f2032(){const _0x173f58=_0x247bea,_0x2dbd5d=[_0x173f58(0x7e9),_0x173f58(0xa11),_0x173f58(0xde)],_0x54d2f8=_0x2dbd5d[_0x173f58(0x107e)](_0x5d50ec[_0x173f58(0x6f8)]);_0x5d50ec[_0x173f58(0x6f8)]=_0x2dbd5d[(_0x54d2f8+0x1)%_0x2dbd5d[_0x173f58(0x79b)]],document['getElementById'](_0x173f58(0x10f5))['textContent']={'order':'顺序','random':'随机','single':'单曲'}[_0x5d50ec[_0x173f58(0x6f8)]];}function _0x15540b(){const _0x413247=_0x247bea,_0x1aff3b=document[_0x413247(0xc33)]('char-audio-player'),_0x57d504=document[_0x413247(0xc33)](_0x413247(0x5ff)),_0x3129b4=document['getElementById'](_0x413247(0x9d0));_0x57d504['addEventListener']('click',()=>{const _0x591f93=_0x413247;if(_0x1aff3b['paused']){if(_0x5d50ec[_0x591f93(0x12a0)]>-0x1)_0x1aff3b['play']();}else _0x1aff3b[_0x591f93(0x47a)]();}),_0x1aff3b['onplay']=()=>{const _0x4751f6=_0x413247;_0x57d504['innerHTML']=_0x4751f6(0x7e3),_0x3129b4[_0x4751f6(0x10d3)][_0x4751f6(0xb9)]('spinning'),_0x5d50ec[_0x4751f6(0xa4e)]=!![];},_0x1aff3b[_0x413247(0x58b)]=()=>{const _0x565a96=_0x413247;_0x57d504[_0x565a96(0x102a)]=_0x565a96(0x35d),_0x3129b4[_0x565a96(0x10d3)][_0x565a96(0x2c7)](_0x565a96(0x7b8)),_0x5d50ec[_0x565a96(0xa4e)]=![];},_0x1aff3b[_0x413247(0xec3)]=()=>{const _0x44bbe5=_0x413247;_0x3129b4[_0x44bbe5(0x10d3)]['remove'](_0x44bbe5(0x7b8)),_0x5d50ec[_0x44bbe5(0xa4e)]=![],_0x453a87();},document[_0x413247(0xc33)](_0x413247(0xed7))[_0x413247(0x205)](_0x413247(0x335),_0x129dcf),document['getElementById']('char-music-next-btn')[_0x413247(0x205)](_0x413247(0x335),_0x453a87),document['getElementById']('char-music-mode-btn')['addEventListener']('click',_0x4f2032),document[_0x413247(0xc33)](_0x413247(0xd7f))[_0x413247(0x205)](_0x413247(0x335),_0x5de668=>{const _0x30ba3b=_0x413247;if(!_0x1aff3b[_0x30ba3b(0xc6a)])return;const _0x491f81=_0x5de668[_0x30ba3b(0x85d)],_0x7a5ae0=_0x5de668[_0x30ba3b(0x6ce)];_0x1aff3b[_0x30ba3b(0x10ba)]=_0x7a5ae0/_0x491f81[_0x30ba3b(0x9dd)]*_0x1aff3b[_0x30ba3b(0xc6a)];});}async function _0xf7f64d(){const _0x14c219=_0x247bea,_0x17aec7=document[_0x14c219(0xc33)](_0x14c219(0x86d));_0x17aec7[_0x14c219(0x102a)]='';const _0x4f4fb0=await _0x2a2987['doubanPosts'][_0x14c219(0xde3)](_0x14c219(0x2f0))[_0x14c219(0xc07)]()['toArray']();if(_0x4f4fb0[_0x14c219(0x79b)]===0x0){_0x17aec7['innerHTML']=_0x14c219(0xdc9);return;}_0x4f4fb0[_0x14c219(0xd6a)](_0x2178f5=>{const _0x367057=_0x14c219;let _0x151f7f;const _0x426f8d=_0x2178f5[_0x367057(0x11af)]?Object['values'](_0x12493e['chats'])[_0x367057(0xd85)](_0x2be7f6=>!_0x2be7f6[_0x367057(0x80b)]&&_0x2be7f6['name']===_0x2178f5[_0x367057(0x11af)]):null;if(_0x426f8d)_0x151f7f=_0x426f8d['settings'][_0x367057(0x18e)];else{const _0x186ee3=Object['values'](_0x12493e['chats'])[_0x367057(0xd85)](_0x568f7e=>!_0x568f7e[_0x367057(0x80b)]&&_0x568f7e[_0x367057(0x578)]===_0x2178f5[_0x367057(0x43b)]);if(_0x186ee3)_0x151f7f=_0x186ee3[_0x367057(0x2ea)][_0x367057(0x18e)];else _0x2178f5['authorAvatarPrompt']?_0x151f7f=_0x367057(0xda8)+encodeURIComponent(_0x2178f5[_0x367057(0x278)]):_0x151f7f=_0x190acc;}const _0x13bacb=document[_0x367057(0x1292)](_0x367057(0x58c));_0x13bacb[_0x367057(0x84)]=_0x367057(0x19f),_0x13bacb[_0x367057(0x8a)]=()=>_0x47583c(_0x2178f5['id']),_0x13bacb[_0x367057(0x102a)]=_0x367057(0x3b2)+_0x151f7f+_0x367057(0x4e2)+_0x2178f5['authorName']+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-group-name\x22>来自\x20'+_0x2178f5[_0x367057(0x70e)]+_0x367057(0xce4)+_0x2178f5['postTitle']+_0x367057(0x272)+_0x2178f5[_0x367057(0xcbd)][_0x367057(0xc12)](/\n/g,_0x367057(0xfd5))+_0x367057(0xd7c)+_0x2178f5[_0x367057(0x8f7)]+_0x367057(0x73)+_0x2178f5[_0x367057(0x1187)]+_0x367057(0xa45)+_0x3ce8f0(_0x2178f5[_0x367057(0x2f0)])+_0x367057(0x88f),_0x17aec7[_0x367057(0xf77)](_0x13bacb);});}async function _0x48c095(){const _0x40c449=_0x247bea,_0x4ba967=_0x12493e['globalSettings'][_0x40c449(0x666)]||[];if(_0x4ba967[_0x40c449(0x79b)]===0x0){await _0x2d7ddd(_0x40c449(0xb32),_0x40c449(0xe51));return;}await _0x2d7ddd('请稍候...','正在为您选择的\x20'+_0x4ba967[_0x40c449(0x79b)]+_0x40c449(0x451));const {proxyUrl:_0x513eb4,apiKey:_0x50bfb5,model:_0x458dd4}=_0x12493e[_0x40c449(0xdd4)];if(!_0x513eb4||!_0x50bfb5||!_0x458dd4){alert('请先在API设置中配置好API信息。');return;}const _0x35e461=new Set();_0x4ba967['forEach'](_0x33b5bc=>{const _0x1d5073=_0x40c449,_0x36b545=_0x12493e['chats'][_0x33b5bc];_0x36b545&&_0x36b545[_0x1d5073(0x2ea)][_0x1d5073(0xeca)]&&_0x36b545[_0x1d5073(0x2ea)][_0x1d5073(0xeca)]['forEach'](_0x7a5349=>_0x35e461['add'](_0x7a5349));});let _0x3e29fa='';_0x35e461[_0x40c449(0x57e)]>0x0&&(_0x3e29fa+='\x0a\x0a#\x20统一世界观设定\x20(以下设定适用于所有参与角色)\x0a',_0x35e461[_0x40c449(0xd6a)](_0x44d760=>{const _0x5322f6=_0x40c449,_0xf983cc=_0x12493e[_0x5322f6(0x63a)][_0x5322f6(0xd85)](_0x426b6a=>_0x426b6a['id']===_0x44d760);if(_0xf983cc){const _0x4fcf39=_0xf983cc[_0x5322f6(0xcbd)][_0x5322f6(0x1054)](_0x4aae78=>_0x4aae78[_0x5322f6(0x95a)]!==![])['map'](_0x54a217=>'-\x20'+_0x54a217[_0x5322f6(0xcbd)])['join']('\x0a');_0x4fcf39&&(_0x3e29fa+=_0x5322f6(0x880)+_0xf983cc[_0x5322f6(0x578)]+_0x5322f6(0xd88)+_0x4fcf39);}}));const _0x14e4dd=_0x12493e['worldBooks']['find'](_0x54a22e=>_0x54a22e[_0x40c449(0x578)]===_0x40c449(0x7c6));let _0x49c6f3='',_0x2b42f7=[];_0x14e4dd&&_0x14e4dd[_0x40c449(0xcbd)][_0x40c449(0xd6a)](_0x263687=>{const _0x183085=_0x40c449;_0x263687[_0x183085(0x8db)]['includes'](_0x183085(0x342))&&(_0x49c6f3+='\x0a#\x20豆瓣社区风格设定\x20(来自世界书)\x0a'+_0x263687[_0x183085(0xcbd)]);if(_0x263687[_0x183085(0x8db)][_0x183085(0x1d4)](_0x183085(0x247))){const _0x3a4589=_0x263687['content'][_0x183085(0x8d7)]('\x0a');_0x3a4589[_0x183085(0xd6a)](_0x1ede95=>{const _0x549b28=_0x183085,_0x19419a=_0x1ede95[_0x549b28(0x1242)](/- \*\*昵称\*\*:\s*(.*?)\s*\*\*人设\*\*:\s*(.*)/);_0x19419a&&_0x2b42f7[_0x549b28(0x2d6)]({'name':_0x19419a[0x1]['trim'](),'persona':_0x19419a[0x2][_0x549b28(0x7da)]()});});}});const _0x17b077=_0x12493e[_0x40c449(0x76c)][_0x40c449(0x66a)]||'我',_0x3428bd=_0x4ba967['length']>0x0&&_0x12493e[_0x40c449(0xc45)][_0x4ba967[0x0]]?_0x12493e[_0x40c449(0xc45)][_0x4ba967[0x0]][_0x40c449(0x2ea)][_0x40c449(0xf75)]:_0x40c449(0x9e8);let _0x3d773b='';_0x4ba967['forEach'](_0x5df302=>{const _0x8b93ca=_0x40c449,_0x4a23be=_0x12493e[_0x8b93ca(0xc45)][_0x5df302];if(_0x4a23be){const _0x47544c=_0x4a23be[_0x8b93ca(0x45b)]&&_0x4a23be[_0x8b93ca(0x45b)]['length']>0x0?_0x4a23be[_0x8b93ca(0x45b)]['map'](_0xa92bc5=>_0xa92bc5['content'])[_0x8b93ca(0x100b)](';\x20'):'无',_0x1b82b7=_0x4a23be['history']['slice'](-0xa)['map'](_0x250a1f=>(_0x250a1f[_0x8b93ca(0x16d)]==='user'?_0x17b077:_0x4a23be[_0x8b93ca(0x578)])+':\x20'+String(_0x250a1f['content'])[_0x8b93ca(0x1033)](0x0,0x1e)+'...')[_0x8b93ca(0x100b)]('\x0a');_0x3d773b+='\x0a<character>\x0a\x20\x20<name>'+_0x4a23be['name']+'</name>\x0a\x20\x20<persona>'+_0x4a23be['settings'][_0x8b93ca(0x679)]+'</persona>\x0a\x20\x20<memory>'+_0x47544c+_0x8b93ca(0xe95)+_0x1b82b7+'</recent_dialogue_with_user>\x0a</character>\x0a';}}),_0x2b42f7[_0x40c449(0xd6a)](_0x496cc9=>{const _0x6282eb=_0x40c449;_0x3d773b+=_0x6282eb(0x766)+_0x496cc9['name']+'</name>\x0a\x20\x20<persona>'+_0x496cc9[_0x6282eb(0x421)]+_0x6282eb(0xbe6);});const _0x9c6845=new Date(),_0x54e639=_0x9c6845['toLocaleString'](_0x40c449(0x770),{'dateStyle':'full','timeStyle':_0x40c449(0x1de)}),_0x14ee23=_0x12493e[_0x40c449(0x10f6)]['doubanMinPosts']||0xc,_0x3a0306=_0x12493e[_0x40c449(0x10f6)][_0x40c449(0xc15)]||0x14,_0x16d6fe='\x0a#\x20你的任务\x0a你是一个虚拟社区内容生成器。你的任务是根据下面提供的【统一角色列表】，虚构出【'+_0x14ee23+'到'+_0x3a0306+_0x40c449(0xb9c)+_0x54e639+'**。\x0a\x20\x20\x20\x20-\x20\x20\x20你的帖子和评论内容【必须】自然地体现出对【当前真实时间】的感知。\x0a2.\x20\x20**【禁止扮演用户\x20(最最最高优先级！！！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20用户的昵称是“'+_0x17b077+_0x40c449(0xe24)+_0x17b077+_0x40c449(0x47d)+_0x49c6f3+'\x0a'+_0x3e29fa+_0x40c449(0x5c9)+_0x54e639+_0x40c449(0x464)+_0x17b077+_0x40c449(0x10e8)+_0x3428bd+_0x40c449(0x793)+_0x3d773b+_0x40c449(0x627);try{const _0x3f8d9a=[{'role':'user','content':'请根据角色列表，生成豆瓣小组帖子。'}];let _0x5736ab=_0x513eb4[_0x40c449(0x1d4)]('generativelanguage'),_0x377578=_0x202ea1(_0x458dd4,_0x50bfb5,_0x16d6fe,_0x3f8d9a);const _0x79f203=_0x5736ab?await fetch(_0x377578[_0x40c449(0x11a)],_0x377578['data']):await fetch(_0x513eb4+_0x40c449(0x399),{'method':'POST','headers':{'Content-Type':_0x40c449(0xd74),'Authorization':_0x40c449(0xf20)+_0x50bfb5},'body':JSON[_0x40c449(0xd27)]({'model':_0x458dd4,'messages':[{'role':'system','content':_0x16d6fe},..._0x3f8d9a],'temperature':_0x12493e[_0x40c449(0x10f6)][_0x40c449(0xd52)]||0x1})});if(!_0x79f203['ok'])throw new Error('API\x20错误:\x20'+_0x79f203['statusText']);const _0x374e6a=await _0x79f203[_0x40c449(0x79e)](),_0x364210=getGeminiResponseText(_0x374e6a),_0x1ddf92=_0x364210[_0x40c449(0x1242)](/\[[\s\S]*\]/);if(!_0x1ddf92)throw new Error(_0x40c449(0xd3d)+_0x364210);const _0x41531c=JSON[_0x40c449(0x6b1)](_0x1ddf92[0x0]);await _0x2a2987[_0x40c449(0x4f0)][_0x40c449(0xebb)](),await _0x2a2987[_0x40c449(0x4f0)][_0x40c449(0x3ab)](_0x41531c['map'](_0x392520=>({..._0x392520,'timestamp':Date[_0x40c449(0x6ee)]()-Math['random']()*0x186a0}))),await _0xf7f64d();}catch(_0xda9c94){console[_0x40c449(0x4d9)](_0x40c449(0x754),_0xda9c94),await _0x2d7ddd(_0x40c449(0x8b1),'无法生成内容，请检查API配置或稍后再试。\x0a错误:\x20'+_0xda9c94[_0x40c449(0xf93)]);}}async function _0x47583c(_0x55f74a){const _0x3a026b=_0x247bea;_0x38f00f(_0x3a026b(0xa13)),_0x2ef46b=_0x55f74a;const _0x3ae5b3=await _0x2a2987[_0x3a026b(0x4f0)][_0x3a026b(0xec0)](_0x55f74a);if(!_0x3ae5b3){_0x38f00f(_0x3a026b(0x21d));return;}document[_0x3a026b(0xc33)](_0x3a026b(0x26d))[_0x3a026b(0x11b0)]=_0x3a026b(0x11e2);let _0x11b3e7=_0x190acc,_0x5cef99=_0x3ae5b3[_0x3a026b(0x43b)];const _0x558fc5=_0x3ae5b3[_0x3a026b(0x11af)]?Object[_0x3a026b(0xd28)](_0x12493e[_0x3a026b(0xc45)])[_0x3a026b(0xd85)](_0x538675=>!_0x538675[_0x3a026b(0x80b)]&&_0x538675[_0x3a026b(0x776)]===_0x3ae5b3['authorOriginalName']):null;if(_0x558fc5)_0x11b3e7=_0x558fc5[_0x3a026b(0x2ea)][_0x3a026b(0x18e)];else{const _0x1d5cbc=Object[_0x3a026b(0xd28)](_0x12493e[_0x3a026b(0xc45)])[_0x3a026b(0xd85)](_0x1b2cf1=>!_0x1b2cf1[_0x3a026b(0x80b)]&&_0x1b2cf1[_0x3a026b(0x578)]===_0x3ae5b3[_0x3a026b(0x43b)]);if(_0x1d5cbc)_0x11b3e7=_0x1d5cbc[_0x3a026b(0x2ea)][_0x3a026b(0x18e)];else _0x3ae5b3[_0x3a026b(0x278)]&&(_0x11b3e7='https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x3ae5b3[_0x3a026b(0x278)]));}document[_0x3a026b(0xc33)](_0x3a026b(0x251))[_0x3a026b(0x87b)]=_0x11b3e7,document[_0x3a026b(0xc33)](_0x3a026b(0xcd4))['textContent']=_0x5cef99,document[_0x3a026b(0xc33)]('douban-detail-group')['textContent']=_0x3a026b(0xed0)+_0x3ae5b3[_0x3a026b(0x70e)],document[_0x3a026b(0xc33)](_0x3a026b(0x1179))['textContent']=_0x3ae5b3['postTitle'],document['getElementById'](_0x3a026b(0xb30))[_0x3a026b(0x102a)]=_0x3ae5b3['content'][_0x3a026b(0xc12)](/\n/g,'<br>'),document['getElementById'](_0x3a026b(0x746))[_0x3a026b(0x87b)]=_0x12493e[_0x3a026b(0x76c)]['avatar'],document[_0x3a026b(0xc33)](_0x3a026b(0x1264))[_0x3a026b(0x22a)]='';const _0x5b4054=document['getElementById'](_0x3a026b(0x796));_0x5b4054['innerHTML']='';if(_0x3ae5b3[_0x3a026b(0xc83)]&&_0x3ae5b3[_0x3a026b(0xc83)]['length']>0x0){const _0x5b4cfa=new Map();_0x3ae5b3[_0x3a026b(0xc83)][_0x3a026b(0xd6a)](_0x5742ed=>{const _0x390706=_0x3a026b;let _0x17371b=_0x190acc;const _0x3a40e1=_0x12493e[_0x390706(0x76c)][_0x390706(0x66a)]||'我',_0x140ba8=_0x5742ed[_0x390706(0xa97)];if(_0x5b4cfa[_0x390706(0xa7)](_0x140ba8))_0x17371b=_0x5b4cfa[_0x390706(0xec0)](_0x140ba8);else{if(_0x140ba8===_0x3a40e1)_0x17371b=_0x12493e['qzoneSettings'][_0x390706(0xbac)];else{if(_0x140ba8===_0x3ae5b3[_0x390706(0x43b)])_0x17371b=_0x11b3e7;else{const _0x3a9147=_0x5742ed['commenterOriginalName']?Object[_0x390706(0xd28)](_0x12493e[_0x390706(0xc45)])[_0x390706(0xd85)](_0x1739e4=>!_0x1739e4[_0x390706(0x80b)]&&_0x1739e4[_0x390706(0x776)]===_0x5742ed[_0x390706(0x2a2)]):null;if(_0x3a9147)_0x17371b=_0x3a9147[_0x390706(0x2ea)][_0x390706(0x18e)];else{const _0x4512e2=Object[_0x390706(0xd28)](_0x12493e['chats'])[_0x390706(0xd85)](_0x47dd76=>!_0x47dd76['isGroup']&&_0x47dd76['name']===_0x140ba8);if(_0x4512e2)_0x17371b=_0x4512e2[_0x390706(0x2ea)]['aiAvatar'];else _0x5742ed[_0x390706(0x8ab)]&&(_0x17371b='https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x5742ed[_0x390706(0x8ab)]));}}}_0x5b4cfa[_0x390706(0xdf)](_0x140ba8,_0x17371b);}const _0x2f22c1=document[_0x390706(0x1292)](_0x390706(0x58c));_0x2f22c1[_0x390706(0x84)]=_0x390706(0xd35),_0x2f22c1['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x17371b+_0x390706(0x91c)+_0x140ba8+_0x390706(0x367)+_0x5742ed[_0x390706(0x996)][_0x390706(0xc12)](/\n/g,'<br>')+_0x390706(0xd2d),_0x5b4054[_0x390706(0xf77)](_0x2f22c1);});}else _0x5b4054['innerHTML']=_0x3a026b(0x87d);const _0x5219a9=document['getElementById']('douban-detail-content-wrapper');if(_0x5219a9)_0x5219a9[_0x3a026b(0x1244)]=0x0;}async function _0x2d2480(){const _0x17c04e=_0x247bea;if(!_0x2ef46b)return;const _0x1c6946=document[_0x17c04e(0xc33)]('douban-comment-input'),_0x4c3e02=_0x1c6946[_0x17c04e(0x22a)][_0x17c04e(0x7da)]();if(!_0x4c3e02)return;const _0x5dad3b=await _0x2a2987[_0x17c04e(0x4f0)][_0x17c04e(0xec0)](_0x2ef46b);if(!_0x5dad3b)return;!_0x5dad3b[_0x17c04e(0xc83)]&&(_0x5dad3b['comments']=[]);const _0x18fa50=_0x12493e[_0x17c04e(0x76c)][_0x17c04e(0x66a)]||'我';_0x5dad3b[_0x17c04e(0xc83)][_0x17c04e(0x2d6)]({'commenter':_0x18fa50,'text':_0x4c3e02}),_0x5dad3b[_0x17c04e(0x1187)]++,await _0x2a2987[_0x17c04e(0x4f0)]['put'](_0x5dad3b),_0x1c6946['value']='',await _0x47583c(_0x2ef46b);}async function _0x18fb55(){const _0x1c89e0=_0x247bea;if(!_0x2ef46b)return;const _0x12f670=_0x2ef46b,_0x18ec8f=await _0x2a2987[_0x1c89e0(0x4f0)]['get'](_0x12f670);if(!_0x18ec8f)return;const _0x1983a1=_0x18ec8f[_0x1c89e0(0xc83)]&&_0x18ec8f[_0x1c89e0(0xc83)]['slice'](-0x1)[0x0];if(!_0x1983a1){alert(_0x1c89e0(0x11a0));return;}await _0x2d7ddd(_0x1c89e0(0xb37),_0x1c89e0(0x1020));try{const {proxyUrl:_0x51319e,apiKey:_0x27a409,model:_0x3d2dfe}=_0x12493e['apiConfig'];if(!_0x51319e||!_0x27a409||!_0x3d2dfe)throw new Error(_0x1c89e0(0x9b8));const _0x2553ae=_0x12493e[_0x1c89e0(0x76c)][_0x1c89e0(0x66a)]||'我',_0x11b9e9=_0x12493e[_0x1c89e0(0xc45)][Object[_0x1c89e0(0x1c6)](_0x12493e['chats'])[0x0]]?.[_0x1c89e0(0x2ea)][_0x1c89e0(0xf75)]||_0x1c89e0(0x9e8),_0x2ec181=new Map();_0x18ec8f['comments']&&_0x18ec8f[_0x1c89e0(0xc83)]['forEach'](_0x12993e=>{const _0x9514e0=_0x1c89e0,_0x5ce2db=(_0x12493e[_0x9514e0(0x10f6)][_0x9514e0(0x666)]||[])[_0x9514e0(0xfa7)](_0x2b161a=>_0x12493e[_0x9514e0(0xc45)][_0x2b161a]?.['name']===_0x12993e[_0x9514e0(0xa97)]);!_0x5ce2db&&_0x12993e[_0x9514e0(0x8ab)]&&_0x2ec181['set'](_0x12993e[_0x9514e0(0xa97)],_0x12993e[_0x9514e0(0x8ab)]);});let _0x32e762=_0x1c89e0(0x80f);_0x2ec181[_0x1c89e0(0x57e)]>0x0?(_0x32e762+=_0x1c89e0(0x87c),_0x2ec181[_0x1c89e0(0xd6a)]((_0x384446,_0x730efa)=>{const _0x3a3f91=_0x1c89e0;_0x32e762+=_0x3a3f91(0x100f)+_0x730efa+'**:\x20\x22'+_0x384446+'\x22\x0a';})):_0x32e762+=_0x1c89e0(0xaea);const _0x3547b8=_0x12493e[_0x1c89e0(0x63a)]['find'](_0x4a5885=>_0x4a5885['name']==='豆瓣设定');let _0x3076b2=[];_0x3547b8&&_0x3547b8[_0x1c89e0(0xcbd)][_0x1c89e0(0xd6a)](_0x486654=>{const _0x57e6c9=_0x1c89e0;if(_0x486654[_0x57e6c9(0x8db)]['includes'](_0x57e6c9(0x247))){const _0x5b0f6e=_0x486654[_0x57e6c9(0xcbd)][_0x57e6c9(0x8d7)]('\x0a');_0x5b0f6e[_0x57e6c9(0xd6a)](_0x3e9503=>{const _0x4fb488=_0x57e6c9,_0x107ea5=_0x3e9503['match'](/- \*\*昵称\*\*:\s*(.*?)\s*\*\*人设\*\*:\s*(.*)/);_0x107ea5&&_0x3076b2[_0x4fb488(0x2d6)]({'name':_0x107ea5[0x1][_0x4fb488(0x7da)](),'persona':_0x107ea5[0x2][_0x4fb488(0x7da)]()});});}});let _0x29a9ea='';const _0x3aaffa=_0x12493e['globalSettings'][_0x1c89e0(0x666)]||[];_0x3aaffa[_0x1c89e0(0xd6a)](_0x387c9a=>{const _0x3a56c6=_0x1c89e0,_0x3a0f5c=_0x12493e['chats'][_0x387c9a];if(_0x3a0f5c){const _0x1d54c5=_0x3a0f5c[_0x3a56c6(0x45b)]&&_0x3a0f5c[_0x3a56c6(0x45b)]['length']>0x0?_0x3a0f5c[_0x3a56c6(0x45b)][_0x3a56c6(0x9d5)](_0x17726c=>_0x17726c[_0x3a56c6(0xcbd)])[_0x3a56c6(0x100b)](';\x20'):'无',_0x449b21=_0x3a0f5c[_0x3a56c6(0x1294)][_0x3a56c6(0x111c)](-0xa)[_0x3a56c6(0x9d5)](_0xfa147f=>(_0xfa147f[_0x3a56c6(0x16d)]===_0x3a56c6(0x717)?_0x2553ae:_0x3a0f5c['name'])+':\x20'+String(_0xfa147f[_0x3a56c6(0xcbd)])[_0x3a56c6(0x1033)](0x0,0x1e)+_0x3a56c6(0xda0))[_0x3a56c6(0x100b)]('\x0a');_0x29a9ea+=_0x3a56c6(0x110f)+_0x3a0f5c[_0x3a56c6(0x578)]+':\x20'+_0x3a0f5c['settings'][_0x3a56c6(0x679)][_0x3a56c6(0x1033)](0x0,0x32)+'...\x20[记忆:\x20'+_0x1d54c5+']\x20[最近对话:\x20'+_0x449b21+']';}}),_0x3076b2[_0x1c89e0(0xd6a)](_0x250497=>{const _0x4cb92e=_0x1c89e0;_0x29a9ea+='\x0a-\x20'+_0x250497[_0x4cb92e(0x578)]+':\x20'+_0x250497[_0x4cb92e(0x421)];});const _0x167fb2=new Date(),_0x4b221f=_0x167fb2[_0x1c89e0(0x559)](_0x1c89e0(0x770),{'dateStyle':_0x1c89e0(0x12b6),'timeStyle':_0x1c89e0(0x1de)}),_0x153b6d=_0x1c89e0(0xa9e)+_0x2553ae+'”刚刚对最后一条评论点击了“等待回复”，TA希望看到更多角色参与讨论。\x0a你的任务是：根据所有角色的设定，选择【10到20位】最适合参与讨论的角色，让他们针对已有评论，发表【全新的、符合人设的】回应。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间感知】**:\x0a\x20\x20\x20\x20-\x20\x20\x20你【必须】意识到当前是\x20**'+_0x4b221f+'**。\x0a\x20\x20\x20\x20-\x20\x20\x20你的评论内容【必须】自然地体现出对【当前真实时间】的感知。\x0a2.\x20\x20**【禁止扮演用户\x20(最最最高优先级！！！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20用户的昵称是“'+_0x2553ae+_0x1c89e0(0x56e)+_0x2553ae+_0x1c89e0(0x7ec)+_0x18ec8f[_0x1c89e0(0x43c)]+'》\x0a-\x20**发帖人**:\x20'+_0x18ec8f[_0x1c89e0(0x43b)]+_0x1c89e0(0xedc)+_0x18ec8f[_0x1c89e0(0xcbd)]['substring'](0x0,0x64)+_0x1c89e0(0x1021)+_0x18ec8f['comments'][_0x1c89e0(0x9d5)](_0x486ec8=>'-\x20'+_0x486ec8[_0x1c89e0(0xa97)]+':\x20'+_0x486ec8['text'])[_0x1c89e0(0x100b)]('\x0a')+'\x0a\x0a'+_0x32e762+_0x1c89e0(0x5c9)+_0x4b221f+_0x1c89e0(0x93c)+_0x2553ae+_0x1c89e0(0x10e8)+_0x11b9e9+_0x1c89e0(0xadf)+_0x29a9ea+_0x1c89e0(0x12b0),_0x51ad43=[{'role':'user','content':'请根据以上情景，生成新的评论。'}];let _0x2e8f15=_0x51319e[_0x1c89e0(0x1d4)](_0x1c89e0(0x113e)),_0x21141a=_0x202ea1(_0x3d2dfe,_0x27a409,_0x153b6d,_0x51ad43);const _0x5c9dbf=_0x2e8f15?await fetch(_0x21141a[_0x1c89e0(0x11a)],_0x21141a[_0x1c89e0(0xa78)]):await fetch(_0x51319e+_0x1c89e0(0x399),{'method':_0x1c89e0(0x90),'headers':{'Content-Type':_0x1c89e0(0xd74),'Authorization':_0x1c89e0(0xf20)+_0x27a409},'body':JSON['stringify']({'model':_0x3d2dfe,'messages':[{'role':_0x1c89e0(0x152),'content':_0x153b6d},..._0x51ad43],'temperature':_0x12493e[_0x1c89e0(0x10f6)][_0x1c89e0(0xd52)]||0x1})});if(!_0x5c9dbf['ok'])throw new Error(_0x1c89e0(0xf43)+_0x5c9dbf[_0x1c89e0(0x109a)]);const _0x556c3d=await _0x5c9dbf[_0x1c89e0(0x79e)](),_0x4b2b51=getGeminiResponseText(_0x556c3d),_0x1574b7=_0x4b2b51['replace'](/^```json\s*/,'')[_0x1c89e0(0xc12)](/```$/,''),_0x26a9bd=JSON['parse'](_0x1574b7);Array[_0x1c89e0(0x621)](_0x26a9bd)&&_0x26a9bd[_0x1c89e0(0x79b)]>0x0&&(_0x18ec8f[_0x1c89e0(0xc83)][_0x1c89e0(0x2d6)](..._0x26a9bd),_0x18ec8f[_0x1c89e0(0x1187)]+=_0x26a9bd[_0x1c89e0(0x79b)],await _0x2a2987['doubanPosts']['put'](_0x18ec8f)),await _0x47583c(_0x12f670),_0x37b8d7();}catch(_0x3fb805){console[_0x1c89e0(0x4d9)]('等待回复失败:',_0x3fb805),await _0x2d7ddd('操作失败',_0x1c89e0(0xca4)+_0x3fb805[_0x1c89e0(0xf93)]);}}async function _0xbb0a45(){const _0x4976c2=_0x247bea,_0x5c2e73=document[_0x4976c2(0xc33)](_0x4976c2(0xe3)),_0x261a67=document['getElementById'](_0x4976c2(0x504));_0x261a67['innerHTML']='';const _0x329e69=Object[_0x4976c2(0xd28)](_0x12493e[_0x4976c2(0xc45)])[_0x4976c2(0x1054)](_0x407af3=>!_0x407af3['isGroup']),_0x4ec683=new Set(_0x12493e[_0x4976c2(0x10f6)][_0x4976c2(0x666)]||[]);_0x329e69[_0x4976c2(0x79b)]===0x0?_0x261a67[_0x4976c2(0x102a)]=_0x4976c2(0xb7f):_0x329e69['forEach'](_0xc354bf=>{const _0x295aba=_0x4976c2,_0x3bb7b0=document[_0x295aba(0x1292)](_0x295aba(0x58c));_0x3bb7b0[_0x295aba(0x84)]=_0x295aba(0x676),_0x3bb7b0['innerHTML']=_0x295aba(0x6e9)+_0xc354bf['id']+'\x22\x20'+(_0x4ec683[_0x295aba(0xa7)](_0xc354bf['id'])?_0x295aba(0x737):'')+_0x295aba(0x1198)+(_0xc354bf[_0x295aba(0x2ea)][_0x295aba(0x18e)]||_0x190acc)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0xc354bf['name']+_0x295aba(0x133),_0x261a67[_0x295aba(0xf77)](_0x3bb7b0);}),_0x5c2e73[_0x4976c2(0x10d3)]['add']('visible');}async function _0x202df8(){const _0x57084a=_0x247bea,_0x24b295=document[_0x57084a(0x67a)](_0x57084a(0xd0c)),_0x5afd0e=Array[_0x57084a(0x301)](_0x24b295)[_0x57084a(0x9d5)](_0x3c043c=>_0x3c043c[_0x57084a(0x85)][_0x57084a(0x109b)]);_0x12493e[_0x57084a(0x10f6)][_0x57084a(0x666)]=_0x5afd0e,await _0x2a2987['globalSettings'][_0x57084a(0xf36)](_0x12493e[_0x57084a(0x10f6)]),document[_0x57084a(0xc33)]('douban-cast-modal')[_0x57084a(0x10d3)][_0x57084a(0x2c7)](_0x57084a(0x143)),await _0x48c095();}document['getElementById'](_0x247bea(0xb10))[_0x247bea(0x205)]('click',_0xbb0a45),document['getElementById'](_0x247bea(0x15b))[_0x247bea(0x205)](_0x247bea(0x335),()=>{const _0x52afdd=_0x247bea;document[_0x52afdd(0xc33)](_0x52afdd(0xe3))[_0x52afdd(0x10d3)][_0x52afdd(0x2c7)](_0x52afdd(0x143));}),document['getElementById'](_0x247bea(0x68c))[_0x247bea(0x205)](_0x247bea(0x335),_0x202df8),document[_0x247bea(0xc33)](_0x247bea(0x504))['addEventListener'](_0x247bea(0x335),_0x4400aa=>{const _0xd510e2=_0x247bea,_0x26ad2a=_0x4400aa[_0xd510e2(0xe16)][_0xd510e2(0x7a7)]('.contact-picker-item');if(_0x26ad2a){const _0x438812=_0x26ad2a[_0xd510e2(0x977)](_0xd510e2(0x41d));_0x438812&&_0x4400aa[_0xd510e2(0xe16)]!==_0x438812&&(_0x438812[_0xd510e2(0x737)]=!_0x438812[_0xd510e2(0x737)]);}});async function _0x466798(_0x42088f){const _0x315b17=_0x247bea;if(!_0x42088f)return;const _0x5bc8fd=await _0x270512(_0x315b17(0xe67),_0x315b17(0x9f4),{'confirmText':_0x315b17(0x28f)});if(!_0x5bc8fd)return;try{const _0x382850=await _0x42088f[_0x315b17(0x996)](),_0x133b4b=JSON[_0x315b17(0x6b1)](_0x382850);if(!_0x133b4b[_0x315b17(0x93e)]&&!_0x133b4b[_0x315b17(0x22c)]&&!_0x133b4b[_0x315b17(0x4da)])throw new Error('文件格式不正确，缺少关键的外观设置项。');Object[_0x315b17(0x26f)](_0x12493e[_0x315b17(0x10f6)],_0x133b4b),await _0x2a2987[_0x315b17(0x10f6)]['put'](_0x12493e[_0x315b17(0x10f6)]),_0x5871a7(),_0x44847e(),_0x21aa4c(),_0x1ed875(),_0x3e472a(_0x12493e[_0x315b17(0x10f6)]['globalCss']),_0x2e1ac4(_0x12493e[_0x315b17(0x10f6)][_0x315b17(0x10cc)]),_0xadc4e(),_0xa1bafb(),_0x374557(),await _0x2d7ddd(_0x315b17(0x455),_0x315b17(0x9b));}catch(_0x5a1ff8){console[_0x315b17(0x4d9)]('导入外观设置时出错:',_0x5a1ff8),await _0x2d7ddd('导入失败',_0x315b17(0x4e8)+_0x5a1ff8[_0x315b17(0xf93)]);}}async function _0x278556(_0x204f5a){const _0x1287f8=_0x247bea;console[_0x1287f8(0x51f)](_0x1287f8(0x378)+_0x204f5a[_0x1287f8(0xcab)](0x1)+_0x1287f8(0x4f4));const _0x38cd17=Object[_0x1287f8(0xd28)](_0x12493e['chats'])[_0x1287f8(0x1054)](_0x3a2d4f=>!_0x3a2d4f[_0x1287f8(0x80b)]&&_0x3a2d4f[_0x1287f8(0x2ea)]['enableBackgroundActivity']&&_0x3a2d4f[_0x1287f8(0x1cb)]?.[_0x1287f8(0xbc8)]===_0x1287f8(0xe59));if(_0x38cd17[_0x1287f8(0x79b)]===0x0){console['log'](_0x1287f8(0xa92));return;}for(const _0xad87b5 of _0x38cd17){const _0x12d7a5=_0xad87b5['settings'][_0x1287f8(0x663)]||0xf,_0x3c3633=_0xad87b5[_0x1287f8(0x87a)]?(Date[_0x1287f8(0x6ee)]()-_0xad87b5['lastActionTimestamp'])/(0x3e8*0x3c):Infinity;_0x204f5a>_0x12d7a5&&_0x3c3633>_0x12d7a5&&(Math[_0x1287f8(0xa11)]()<0.3&&(console[_0x1287f8(0x51f)](_0x1287f8(0x5d4)+_0xad87b5[_0x1287f8(0x578)]+_0x1287f8(0xb38)),Math['random']()<0.7?await _0x34a1c7(_0xad87b5['id']):console['log'](_0x1287f8(0x5d4)+_0xad87b5['name']+_0x1287f8(0x799))));}}function _0x275ed8(){const _0x53ff5a=_0x247bea;if(!_0x12493e['activeChatId'])return;const _0x1f122f=_0x12493e[_0x53ff5a(0xc45)][_0x12493e[_0x53ff5a(0x7bc)]];document[_0x53ff5a(0xc33)](_0x53ff5a(0xee3))[_0x53ff5a(0x22a)]='',document[_0x53ff5a(0xc33)](_0x53ff5a(0x119b))[_0x53ff5a(0x22a)]='',document[_0x53ff5a(0xc33)](_0x53ff5a(0xafa))[_0x53ff5a(0x102a)]=_0x53ff5a(0x885),_0x38f00f(_0x53ff5a(0x41c));}async function _0xc7ba77(){const _0x3577e=_0x247bea,_0x2885a8=_0x12493e[_0x3577e(0xc45)][_0x12493e[_0x3577e(0x7bc)]];if(!_0x2885a8)return;const _0x268eed=document[_0x3577e(0xc33)](_0x3577e(0xee3))[_0x3577e(0x22a)][_0x3577e(0x7da)]()[_0x3577e(0x963)](),_0x40c62c=document['getElementById'](_0x3577e(0x119b))[_0x3577e(0x22a)];if(!_0x268eed&&!_0x40c62c){alert(_0x3577e(0x11a4));return;}let _0x433806=_0x2885a8[_0x3577e(0x1294)][_0x3577e(0x1054)](_0x1a84b9=>!_0x1a84b9[_0x3577e(0xd07)]);_0x268eed&&(_0x433806=_0x433806['filter'](_0xe1cee0=>{const _0xdb06a5=_0x3577e;let _0x345ace='';if(typeof _0xe1cee0[_0xdb06a5(0xcbd)]==='string')_0x345ace=_0xe1cee0['content'];else{if(_0xe1cee0[_0xdb06a5(0x52a)]===_0xdb06a5(0xb41))_0x345ace=_0xe1cee0[_0xdb06a5(0xcbd)];else{if(_0xe1cee0[_0xdb06a5(0x52a)]===_0xdb06a5(0x8f5)||_0xe1cee0['type']===_0xdb06a5(0x142))_0x345ace=_0xe1cee0[_0xdb06a5(0xcbd)];else{if(_0xe1cee0[_0xdb06a5(0x52a)]===_0xdb06a5(0x6bf))_0x345ace=(_0xe1cee0[_0xdb06a5(0x156)]||'')+'\x20'+(_0xe1cee0[_0xdb06a5(0x11ac)]||'');else _0xe1cee0[_0xdb06a5(0xf74)]&&(_0x345ace=_0xe1cee0['content']);}}}return _0x345ace['toLowerCase']()[_0xdb06a5(0x1d4)](_0x268eed);}));if(_0x40c62c){const _0x14e13e=new Date(_0x40c62c),_0x6e3a15=new Date(_0x14e13e['setHours'](0x0,0x0,0x0,0x0))[_0x3577e(0x234)](),_0x28e19a=new Date(_0x14e13e[_0x3577e(0x936)](0x17,0x3b,0x3b,0x3e7))[_0x3577e(0x234)]();_0x433806=_0x433806[_0x3577e(0x1054)](_0x323ba1=>_0x323ba1[_0x3577e(0x2f0)]>=_0x6e3a15&&_0x323ba1['timestamp']<=_0x28e19a);}await _0x342414(_0x433806);}async function _0x342414(_0x485e4a){const _0x13426e=_0x247bea,_0x29f94c=document['getElementById'](_0x13426e(0xafa)),_0x45f7d5=_0x12493e[_0x13426e(0xc45)][_0x12493e[_0x13426e(0x7bc)]];_0x29f94c[_0x13426e(0x102a)]='';if(_0x485e4a[_0x13426e(0x79b)]===0x0){_0x29f94c[_0x13426e(0x102a)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>未找到相关的聊天记录。</p>';return;}let _0x30de99='';for(const _0x11267d of _0x485e4a){const _0x1888dd=new Date(_0x11267d[_0x13426e(0x2f0)]),_0x4c827b=_0x1888dd['toLocaleDateString']();if(_0x4c827b!==_0x30de99){const _0x51868b=document[_0x13426e(0x1292)]('div');_0x51868b[_0x13426e(0x84)]=_0x13426e(0x6a1),_0x51868b[_0x13426e(0x11b0)]=_0x13426e(0xd56)+_0x1888dd[_0x13426e(0x80d)]()+'年'+(_0x1888dd[_0x13426e(0xf99)]()+0x1)+'月'+_0x1888dd['getDate']()+_0x13426e(0x249),_0x29f94c[_0x13426e(0xf77)](_0x51868b),_0x30de99=_0x4c827b;}const _0x47c5e9=await _0x3f3a68(_0x11267d,_0x45f7d5);_0x47c5e9&&(_0x47c5e9[_0x13426e(0x105d)][_0x13426e(0x437)]=_0x13426e(0xc21),_0x47c5e9['addEventListener']('click',()=>_0x585e7c(_0x11267d['timestamp'])),_0x29f94c[_0x13426e(0xf77)](_0x47c5e9));}}async function _0x585e7c(_0x181d23){const _0x293162=_0x247bea,_0x1bcee8=_0x12493e[_0x293162(0x7bc)];if(!_0x1bcee8)return;_0x38f00f(_0x293162(0xf1b)),setTimeout(async()=>{const _0x1f6bf1=_0x293162,_0x2382b0=document['getElementById'](_0x1f6bf1(0xe81)),_0x34daa6=_0x1f6bf1(0xe27)+_0x181d23+'\x22]';let _0x59ec49=_0x2382b0[_0x1f6bf1(0x977)](_0x34daa6),_0x45b64c=0x0;const _0x51e391=0x14;while(!_0x59ec49&&_0x45b64c<_0x51e391){const _0x2aa258=document[_0x1f6bf1(0xc33)](_0x1f6bf1(0x107c));if(_0x2aa258)console[_0x1f6bf1(0x51f)](_0x1f6bf1(0x13b)+(_0x45b64c+0x1)+')'),await _0x4b82a5(),_0x59ec49=_0x2382b0[_0x1f6bf1(0x977)](_0x34daa6),_0x45b64c++;else break;}_0x2d486b(_0x181d23);},0xc8);}async function _0x2905bf(){const _0x2cb0eb=_0x247bea;document[_0x2cb0eb(0xc33)](_0x2cb0eb(0xee3))['value']='',document[_0x2cb0eb(0xc33)](_0x2cb0eb(0x119b))[_0x2cb0eb(0x22a)]='',await _0x342414(_0x12493e[_0x2cb0eb(0xc45)][_0x12493e[_0x2cb0eb(0x7bc)]][_0x2cb0eb(0x1294)]['filter'](_0xbb261d=>!_0xbb261d[_0x2cb0eb(0xd07)]));}async function _0x3280ee(_0x4e3a99=![],_0x449bd7=null,_0x262d9c=null){const _0x36cfee=_0x247bea,_0x1f504a=document[_0x36cfee(0xc33)](_0x36cfee(0x126d)),_0x43cde3=document[_0x36cfee(0xc33)]('my-frame-grid'),_0x3f7f2a=_0x12493e[_0x36cfee(0xc45)][_0x12493e[_0x36cfee(0x7bc)]];_0x1f504a[_0x36cfee(0x102a)]='',_0x43cde3[_0x36cfee(0x102a)]='';const _0x221dc0=await _0x2a2987[_0x36cfee(0xc7e)][_0x36cfee(0xf15)](),_0x1eef87=[..._0x491751,..._0x221dc0];document[_0x36cfee(0x977)](_0x36cfee(0x760))[_0x36cfee(0x105d)][_0x36cfee(0xf44)]=_0x4e3a99?_0x36cfee(0x854):'flex',document[_0x36cfee(0xc33)]('ai-frame-content')[_0x36cfee(0x105d)][_0x36cfee(0xf44)]=_0x36cfee(0xa20),document[_0x36cfee(0xc33)](_0x36cfee(0xc1d))[_0x36cfee(0x105d)]['display']='none',document[_0x36cfee(0xc33)](_0x36cfee(0x738))[_0x36cfee(0x10d3)]['add'](_0x36cfee(0x1043)),document['getElementById']('my-frame-tab')[_0x36cfee(0x10d3)][_0x36cfee(0x2c7)](_0x36cfee(0x1043));if(_0x4e3a99)_0x1eef87[_0x36cfee(0xd6a)](_0x4f08ba=>{const _0xfd7348=_0x36cfee,_0x52c7b9=_0x3bd24b(_0x4f08ba,'my',_0x449bd7);_0x4f08ba[_0xfd7348(0x11a)]===_0x262d9c&&_0x52c7b9[_0xfd7348(0x10d3)][_0xfd7348(0xb9)](_0xfd7348(0x63f)),_0x1f504a[_0xfd7348(0xf77)](_0x52c7b9);});else{const _0x2ad989=_0x3f7f2a[_0x36cfee(0x2ea)][_0x36cfee(0x18e)]||_0x190acc,_0x2dbf65=_0x3f7f2a[_0x36cfee(0x2ea)][_0x36cfee(0x1006)]||(_0x3f7f2a[_0x36cfee(0x80b)]?_0x200461:_0x190acc);_0x1eef87['forEach'](_0x26aae3=>{const _0x3fe1c8=_0x36cfee,_0x2e9ac2=_0x3bd24b(_0x26aae3,'ai',_0x2ad989);if(_0x26aae3[_0x3fe1c8(0x11a)]===_0x1da720['ai'])_0x2e9ac2[_0x3fe1c8(0x10d3)][_0x3fe1c8(0xb9)](_0x3fe1c8(0x63f));_0x1f504a[_0x3fe1c8(0xf77)](_0x2e9ac2);const _0x5b7266=_0x3bd24b(_0x26aae3,'my',_0x2dbf65);if(_0x26aae3[_0x3fe1c8(0x11a)]===_0x1da720['my'])_0x5b7266[_0x3fe1c8(0x10d3)][_0x3fe1c8(0xb9)](_0x3fe1c8(0x63f));_0x43cde3[_0x3fe1c8(0xf77)](_0x5b7266);});}}function _0x3bd24b(_0x1dfc22,_0x1b9e9a,_0x433fe4){const _0x4400e8=_0x247bea,_0xd697f2=document['createElement'](_0x4400e8(0x58c));_0xd697f2[_0x4400e8(0x84)]='frame-item',_0xd697f2[_0x4400e8(0x85)][_0x4400e8(0x782)]=_0x1dfc22['url'],_0xd697f2[_0x4400e8(0x874)]=_0x1dfc22[_0x4400e8(0x578)];const _0x2fed9a=typeof _0x1dfc22['id']===_0x4400e8(0xbd0),_0x285a62=_0x2fed9a?_0x4400e8(0xec2)+_0x1dfc22['id']+_0x4400e8(0x23a):'';return _0xd697f2[_0x4400e8(0x102a)]=_0x4400e8(0x5bb)+_0x285a62+_0x4400e8(0x1297)+_0x433fe4+_0x4400e8(0x50b)+(_0x1dfc22['url']?_0x4400e8(0xb19)+_0x1dfc22[_0x4400e8(0x11a)]+'\x22\x20class=\x22preview-frame\x22>':'')+_0x4400e8(0x1da),_0xd697f2[_0x4400e8(0x205)](_0x4400e8(0x335),_0x29ab71=>{const _0x172dfa=_0x4400e8;if(_0x29ab71['target'][_0x172dfa(0x10d3)][_0x172dfa(0x3af)]('delete-btn'))return;if(_0x52569b){if(_0x2fed9a){const _0x5cb4b8=parseInt(_0x1dfc22['id']);_0xd697f2[_0x172dfa(0x10d3)][_0x172dfa(0xe2c)]('selected'),_0x289122['has'](_0x5cb4b8)?_0x289122[_0x172dfa(0x9ea)](_0x5cb4b8):_0x289122[_0x172dfa(0xb9)](_0x5cb4b8),_0x8f575c();}}else{_0x1da720[_0x1b9e9a]=_0x1dfc22[_0x172dfa(0x11a)];const _0x2d73b3=_0x1b9e9a==='ai'?document['getElementById']('ai-frame-grid'):document[_0x172dfa(0xc33)](_0x172dfa(0x6de));_0x2d73b3['querySelectorAll']('.frame-item')[_0x172dfa(0xd6a)](_0x7449e8=>_0x7449e8[_0x172dfa(0x10d3)][_0x172dfa(0x2c7)](_0x172dfa(0x63f))),_0xd697f2['classList'][_0x172dfa(0xb9)](_0x172dfa(0x63f));}}),_0xd697f2;}async function _0x2b51e3(){const _0x234e4e=_0x247bea,_0x472954=document[_0x234e4e(0xc33)](_0x234e4e(0xdc3)),_0x2b6781=await new Promise(_0x16e67d=>{const _0x219495=_0x234e4e,_0x2f7208=_0x43778d=>{const _0x3d92b4=_0x26e9;_0x16e67d(_0x43778d[_0x3d92b4(0xe16)][_0x3d92b4(0x1d0)][0x0]||null),_0x472954[_0x3d92b4(0xb52)](_0x3d92b4(0x644),_0x2f7208);};_0x472954['addEventListener'](_0x219495(0x644),_0x2f7208,{'once':!![]}),_0x472954[_0x219495(0x335)]();});if(!_0x2b6781)return;const _0x294cab=await _0x1ca09c(_0x234e4e(0x40b),_0x234e4e(0x5ef));if(!_0x294cab||!_0x294cab[_0x234e4e(0x7da)]())return;const _0x16b946=await new Promise(_0x43505b=>{const _0x4c37d9=_0x234e4e,_0x44099f=new FileReader();_0x44099f[_0x4c37d9(0x833)]=()=>_0x43505b(_0x44099f['result']),_0x44099f[_0x4c37d9(0xbcf)](_0x2b6781);});await _0x2a2987['customAvatarFrames'][_0x234e4e(0xb9)]({'name':_0x294cab['trim'](),'url':_0x16b946}),_0x3280ee(_0x5bb322);}async function _0x121e32(){const _0x4ca2e8=_0x247bea,_0x331071=_0x4ca2e8(0x8c7),_0x2575ef=await _0x1ca09c('批量导入头像框',_0x4ca2e8(0x355),'',_0x4ca2e8(0x89c),'<p\x20style=\x22font-size:12px;color:#888;\x22>'+_0x331071+_0x4ca2e8(0xcc9));if(!_0x2575ef||!_0x2575ef['trim']())return;const _0x4e7a73=_0x2575ef[_0x4ca2e8(0x7da)]()[_0x4ca2e8(0x8d7)]('\x0a'),_0x3d661e=[];let _0x5220a5=0x0;for(const _0x4afa8d of _0x4e7a73){const _0x2aaf41=_0x4afa8d[_0x4ca2e8(0x1242)](/^(.+?)[:：]\s*(https?:\/\/.+)$/);if(_0x2aaf41)_0x3d661e[_0x4ca2e8(0x2d6)]({'name':_0x2aaf41[0x1][_0x4ca2e8(0x7da)](),'url':_0x2aaf41[0x2][_0x4ca2e8(0x7da)]()});else _0x4afa8d[_0x4ca2e8(0x7da)]()&&_0x5220a5++;}_0x3d661e[_0x4ca2e8(0x79b)]>0x0&&(await _0x2a2987['customAvatarFrames']['bulkAdd'](_0x3d661e),_0x3280ee(_0x5bb322),await _0x2d7ddd(_0x4ca2e8(0x455),'成功导入\x20'+_0x3d661e[_0x4ca2e8(0x79b)]+_0x4ca2e8(0x128a))),_0x5220a5>0x0&&await _0x2d7ddd(_0x4ca2e8(0x1237),'有\x20'+_0x5220a5+_0x4ca2e8(0x2ab));}async function _0x3f4c15(_0x4d3070){const _0x127f50=_0x247bea,_0x6afbae=await _0x2a2987[_0x127f50(0xc7e)][_0x127f50(0xec0)](_0x4d3070);if(!_0x6afbae)return;const _0x2afc31=await _0x270512(_0x127f50(0x8d6),_0x127f50(0x487)+_0x6afbae[_0x127f50(0x578)]+_0x127f50(0x3be),{'confirmButtonClass':_0x127f50(0xa2)});_0x2afc31&&(await _0x2a2987[_0x127f50(0xc7e)]['delete'](_0x4d3070),_0x3280ee(_0x5bb322));}let _0x2d296a=0x0;const _0xc3c34=0x2;function _0x59f2cd(){const _0x14c179=_0x247bea,_0x2d4dfa=document[_0x14c179(0xc33)]('home-screen-pages-container'),_0x55d1f3=document['getElementById'](_0x14c179(0x985)),_0x4c83fd=document[_0x14c179(0x67a)](_0x14c179(0x8a8));let _0x53e612=0x0,_0x11579c=0x0,_0x29fb43=0x0,_0x24d21c=![],_0x128a7b=!![];const _0x18cdc3=()=>{const _0x49a2c3=_0x14c179;_0x55d1f3[_0x49a2c3(0x105d)]['transform']=_0x49a2c3(0x868)+_0x2d296a*(0x64/_0xc3c34)+'%)',_0x4c83fd[_0x49a2c3(0xd6a)]((_0x42167b,_0x346531)=>{const _0x2e9dc6=_0x49a2c3;_0x42167b[_0x2e9dc6(0x10d3)][_0x2e9dc6(0xe2c)]('active',_0x346531===_0x2d296a);});},_0x2e69a0=_0x23d803=>{const _0x1f52a6=_0x14c179;_0x24d21c=!![],_0x128a7b=!![],_0x53e612=_0x23d803[_0x1f52a6(0x52a)][_0x1f52a6(0x1d4)](_0x1f52a6(0x3ea))?_0x23d803[_0x1f52a6(0xe9f)]:_0x23d803[_0x1f52a6(0xc01)][0x0][_0x1f52a6(0xe9f)],_0x11579c=_0x23d803[_0x1f52a6(0x52a)][_0x1f52a6(0x1d4)](_0x1f52a6(0x3ea))?_0x23d803['pageY']:_0x23d803['touches'][0x0][_0x1f52a6(0xc31)],_0x55d1f3[_0x1f52a6(0x105d)][_0x1f52a6(0x51a)]='none';},_0x563b9a=_0x20d538=>{const _0x207bdf=_0x14c179;if(!_0x24d21c)return;const _0x461ab7=_0x20d538[_0x207bdf(0x52a)]['includes'](_0x207bdf(0x3ea))?_0x20d538[_0x207bdf(0xc31)]:_0x20d538[_0x207bdf(0xc01)][0x0][_0x207bdf(0xc31)];_0x29fb43=_0x20d538['type'][_0x207bdf(0x1d4)](_0x207bdf(0x3ea))?_0x20d538[_0x207bdf(0xe9f)]:_0x20d538[_0x207bdf(0xc01)][0x0][_0x207bdf(0xe9f)];const _0x49413e=_0x29fb43-_0x53e612,_0x13d2f3=_0x461ab7-_0x11579c;_0x128a7b&&(Math['abs'](_0x49413e)>0xa||Math['abs'](_0x13d2f3)>0xa)&&(_0x128a7b=![]);if(Math[_0x207bdf(0x2e0)](_0x49413e)>Math['abs'](_0x13d2f3)){if(_0x20d538[_0x207bdf(0x585)])_0x20d538['preventDefault']();_0x55d1f3[_0x207bdf(0x105d)]['transform']=_0x207bdf(0xdf3)+_0x2d296a*(0x64/_0xc3c34)+_0x207bdf(0x10fd)+_0x49413e+_0x207bdf(0x3fc);}},_0x21d2a1=_0x4c8d58=>{const _0x26a28e=_0x14c179;if(!_0x24d21c)return;_0x24d21c=![],_0x55d1f3[_0x26a28e(0x105d)][_0x26a28e(0x51a)]=_0x26a28e(0xf32);if(_0x128a7b){_0x18cdc3();return;}const _0x41446d=_0x29fb43-_0x53e612;if(Math[_0x26a28e(0x2e0)](_0x41446d)>_0x2d4dfa[_0x26a28e(0xeba)]/0x4){if(_0x41446d>0x0&&_0x2d296a>0x0)_0x2d296a--;else _0x41446d<0x0&&_0x2d296a<_0xc3c34-0x1&&_0x2d296a++;}_0x18cdc3();};_0x2d4dfa[_0x14c179(0x205)](_0x14c179(0x9e6),_0x2e69a0),_0x2d4dfa['addEventListener']('mousemove',_0x563b9a),_0x2d4dfa['addEventListener']('mouseup',_0x21d2a1),_0x2d4dfa['addEventListener']('mouseleave',_0x21d2a1),_0x2d4dfa[_0x14c179(0x205)](_0x14c179(0x4b1),_0x2e69a0,{'passive':![]}),_0x2d4dfa[_0x14c179(0x205)](_0x14c179(0xe66),_0x563b9a,{'passive':![]}),_0x2d4dfa['addEventListener'](_0x14c179(0x706),_0x21d2a1);}let _0x505ce2=null;async function _0x296e2e(){const _0xc1cae9=_0x247bea;await _0x46b9c2(),_0x38f00f(_0xc1cae9(0x825));}async function _0x46b9c2(){const _0x4457b4=_0x247bea,_0x4dc34c=document['getElementById'](_0x4457b4(0x26e)),_0x4242ef=document[_0x4457b4(0xc33)](_0x4457b4(0x59e));_0x4dc34c[_0x4457b4(0x102a)]='',_0x4242ef['innerHTML']='';const [_0x19b4eb,_0x1dfd1a]=await Promise['all']([_0x2a2987[_0x4457b4(0xe31)][_0x4457b4(0xf15)](),_0x2a2987[_0x4457b4(0x4b6)][_0x4457b4(0xde3)](_0x4457b4(0x578))[_0x4457b4(0xf15)]()]);_0x12493e[_0x4457b4(0xe31)]=_0x19b4eb;if(_0x19b4eb['length']===0x0){_0x4242ef[_0x4457b4(0x102a)]='<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20margin-top:\x2050px;\x22>点击右上角\x20\x22+\x22\x20创建你的第一个预设</p>';return;}const _0x125c04=document[_0x4457b4(0x1292)](_0x4457b4(0xeb1));_0x125c04['className']=_0x4457b4(0xcd0),_0x125c04['textContent']='全部',_0x125c04[_0x4457b4(0x85)]['categoryId']=_0x4457b4(0x5c8),_0x4dc34c[_0x4457b4(0xf77)](_0x125c04);const _0x4f7fe9=document[_0x4457b4(0x1292)](_0x4457b4(0x58c));_0x4f7fe9[_0x4457b4(0x84)]='world-book-category-pane\x20active',_0x4f7fe9[_0x4457b4(0x85)][_0x4457b4(0x305)]=_0x4457b4(0x5c8),_0x4242ef[_0x4457b4(0xf77)](_0x4f7fe9),_0x1dfd1a[_0x4457b4(0xd6a)](_0x1d5e1f=>{const _0xc2ec6a=_0x4457b4,_0x8350fc=document[_0xc2ec6a(0x1292)](_0xc2ec6a(0xeb1));_0x8350fc['className']='world-book-tab',_0x8350fc[_0xc2ec6a(0x11b0)]=_0x1d5e1f[_0xc2ec6a(0x578)],_0x8350fc[_0xc2ec6a(0x85)]['categoryId']=String(_0x1d5e1f['id']),_0x4dc34c['appendChild'](_0x8350fc);const _0x54e9a7=document[_0xc2ec6a(0x1292)](_0xc2ec6a(0x58c));_0x54e9a7[_0xc2ec6a(0x84)]=_0xc2ec6a(0xfee),_0x54e9a7[_0xc2ec6a(0x85)][_0xc2ec6a(0x305)]=String(_0x1d5e1f['id']),_0x4242ef[_0xc2ec6a(0xf77)](_0x54e9a7);});const _0x23d8ab=_0x19b4eb['some'](_0x138f41=>!_0x138f41[_0x4457b4(0x305)]);if(_0x23d8ab){const _0x3af0f2=document['createElement']('button');_0x3af0f2['className']=_0x4457b4(0x1068),_0x3af0f2[_0x4457b4(0x11b0)]=_0x4457b4(0x30e),_0x3af0f2[_0x4457b4(0x85)][_0x4457b4(0x305)]=_0x4457b4(0xef1),_0x4dc34c[_0x4457b4(0xf77)](_0x3af0f2);const _0x203128=document[_0x4457b4(0x1292)](_0x4457b4(0x58c));_0x203128[_0x4457b4(0x84)]=_0x4457b4(0xfee),_0x203128[_0x4457b4(0x85)]['categoryId']=_0x4457b4(0xef1),_0x4242ef[_0x4457b4(0xf77)](_0x203128);}_0x19b4eb[_0x4457b4(0xd6a)](_0x54ef6a=>{const _0x3f266d=_0x4457b4,_0x4e6fa1=_0x3f266d(0xff7)+_0x54ef6a[_0x3f266d(0xcbd)][_0x3f266d(0x79b)]+'\x20个条目。',_0x5dcb71=document['createElement'](_0x3f266d(0x58c));_0x5dcb71[_0x3f266d(0x84)]='world-book-card',_0x5dcb71[_0x3f266d(0x102a)]=_0x3f266d(0x111d)+_0x54ef6a['name']+_0x3f266d(0x11dc)+_0x4e6fa1+_0x3f266d(0x1056);const _0x5ebf4d=()=>_0x41e60b(_0x54ef6a['id']),_0x569cfd=async()=>{const _0x2f2a2b=_0x3f266d,_0x4aec82=await _0x270512(_0x2f2a2b(0x5a0),_0x2f2a2b(0xc04)+_0x54ef6a[_0x2f2a2b(0x578)]+_0x2f2a2b(0xa31),{'confirmButtonClass':_0x2f2a2b(0xa2)});_0x4aec82&&(await _0x2a2987[_0x2f2a2b(0xe31)][_0x2f2a2b(0x9ea)](_0x54ef6a['id']),_0x12493e[_0x2f2a2b(0xe31)]=await _0x2a2987[_0x2f2a2b(0xe31)][_0x2f2a2b(0xf15)](),_0x46b9c2());};_0x5dcb71['addEventListener']('click',_0x5ebf4d),_0x29b870(_0x5dcb71,_0x569cfd);const _0x186231=_0x5dcb71[_0x3f266d(0xbc5)](!![]);_0x186231[_0x3f266d(0x205)](_0x3f266d(0x335),_0x5ebf4d),_0x29b870(_0x186231,_0x569cfd),_0x4f7fe9[_0x3f266d(0xf77)](_0x186231);const _0x14e6e5=_0x54ef6a[_0x3f266d(0x305)]?String(_0x54ef6a[_0x3f266d(0x305)]):'uncategorized',_0x17c78a=_0x4242ef[_0x3f266d(0x977)]('.world-book-category-pane[data-category-id=\x22'+_0x14e6e5+'\x22]');_0x17c78a&&_0x17c78a[_0x3f266d(0xf77)](_0x5dcb71);}),document[_0x4457b4(0x67a)](_0x4457b4(0x774))[_0x4457b4(0xd6a)](_0x2cd03b=>{const _0x39f37b=_0x4457b4;_0x2cd03b['addEventListener']('click',()=>_0x5afea2(_0x2cd03b[_0x39f37b(0x85)][_0x39f37b(0x305)]));});}function _0x5afea2(_0x35e871){const _0x404a72=_0x247bea;document[_0x404a72(0x67a)](_0x404a72(0x774))['forEach'](_0x5220ff=>{const _0x50273c=_0x404a72;_0x5220ff['classList'][_0x50273c(0xe2c)]('active',_0x5220ff[_0x50273c(0x85)][_0x50273c(0x305)]===_0x35e871);}),document[_0x404a72(0x67a)](_0x404a72(0x117b))[_0x404a72(0xd6a)](_0xf246c6=>{const _0x22a042=_0x404a72;_0xf246c6[_0x22a042(0x10d3)][_0x22a042(0xe2c)]('active',_0xf246c6['dataset'][_0x22a042(0x305)]===_0x35e871);});}async function _0x41e60b(_0x5e617d){const _0x72e3ab=_0x247bea;_0x38f00f(_0x72e3ab(0xaf7)),_0x505ce2=_0x5e617d;try{const [_0x166c96,_0x30af5f]=await Promise[_0x72e3ab(0x5c8)]([_0x2a2987['presets']['get'](_0x5e617d),_0x2a2987[_0x72e3ab(0x4b6)]['toArray']()]);if(!_0x166c96){console['error'](_0x72e3ab(0xbb5),_0x5e617d),await _0x2d7ddd('加载失败',_0x72e3ab(0xea8)),_0x38f00f('preset-screen');return;}setTimeout(()=>{const _0x5f6e77=_0x72e3ab;document[_0x5f6e77(0xc33)](_0x5f6e77(0x884))[_0x5f6e77(0x11b0)]=_0x166c96[_0x5f6e77(0x578)],document[_0x5f6e77(0xc33)](_0x5f6e77(0xfbb))[_0x5f6e77(0x22a)]=_0x166c96[_0x5f6e77(0x578)];const _0x12252b=document[_0x5f6e77(0xc33)](_0x5f6e77(0x71a));_0x12252b['innerHTML']='<option\x20value=\x22\x22>--\x20未分类\x20--</option>',_0x30af5f['forEach'](_0x5d3dba=>{const _0x18cc48=_0x5f6e77,_0x33e120=document[_0x18cc48(0x1292)](_0x18cc48(0x2f6));_0x33e120[_0x18cc48(0x22a)]=_0x5d3dba['id'],_0x33e120['textContent']=_0x5d3dba[_0x18cc48(0x578)];if(_0x166c96[_0x18cc48(0x305)]===_0x5d3dba['id'])_0x33e120[_0x18cc48(0x63f)]=!![];_0x12252b['appendChild'](_0x33e120);});const _0x39c3a4=document[_0x5f6e77(0xc33)](_0x5f6e77(0x1af));_0x39c3a4[_0x5f6e77(0x102a)]='',Array[_0x5f6e77(0x621)](_0x166c96[_0x5f6e77(0xcbd)])&&_0x166c96[_0x5f6e77(0xcbd)][_0x5f6e77(0x79b)]>0x0?_0x166c96['content'][_0x5f6e77(0xd6a)](_0x1a92ff=>{const _0x4a2f19=_0x5f6e77,_0xb7a531=_0x53de62(_0x1a92ff);_0x39c3a4[_0x4a2f19(0xf77)](_0xb7a531);}):_0x39c3a4['innerHTML']=_0x5f6e77(0x197);},0x32);}catch(_0x434ec1){console[_0x72e3ab(0x4d9)]('打开预设编辑器时发生严重错误:',_0x434ec1),await _0x2d7ddd(_0x72e3ab(0x312),_0x72e3ab(0x196)+_0x434ec1[_0x72e3ab(0xf93)]),_0x38f00f(_0x72e3ab(0x825));}}function _0x53de62(_0x1f99b6={'keys':[],'comment':'','content':'','enabled':!![]}){const _0x1b6742=_0x247bea,_0x362351=document[_0x1b6742(0x1292)](_0x1b6742(0x58c));_0x362351['className']=_0x1b6742(0x9ef);const _0x58409a=_0x1f99b6['enabled']!==![]?_0x1b6742(0x737):'';_0x362351['innerHTML']=_0x1b6742(0x112e)+_0x58409a+_0x1b6742(0x235)+(_0x1f99b6[_0x1b6742(0x8db)]||'')+_0x1b6742(0x1028)+(_0x1f99b6[_0x1b6742(0x1c6)]||[])[_0x1b6742(0x100b)](',\x20')+_0x1b6742(0x209)+(_0x1f99b6[_0x1b6742(0xcbd)]||'')+_0x1b6742(0x5db),_0x362351[_0x1b6742(0x977)](_0x1b6742(0xaad))['addEventListener'](_0x1b6742(0x335),()=>_0x362351['remove']());const _0x2695e1=_0x362351[_0x1b6742(0x977)](_0x1b6742(0x7d2)),_0xd89db4=_0x362351['querySelector'](_0x1b6742(0xdd1));return _0x2695e1['addEventListener'](_0x1b6742(0x335),()=>{const _0x3811d9=_0x1b6742,_0x43decb=_0xd89db4[_0x3811d9(0x105d)]['display']===_0x3811d9(0x854);_0xd89db4[_0x3811d9(0x105d)]['display']=_0x43decb?'block':'none',_0x2695e1[_0x3811d9(0x11b0)]=_0x43decb?'收起':'展开';}),_0x362351;}async function _0x2bd3da(){const _0x46bbc7=_0x247bea;await _0x176820(),document[_0x46bbc7(0x977)]('#group-management-modal\x20.modal-header\x20span')['textContent']='管理预设分类',document[_0x46bbc7(0xc33)](_0x46bbc7(0xf71))[_0x46bbc7(0x8a)]=_0x1b5d0f,document[_0x46bbc7(0xc33)](_0x46bbc7(0x8a4))['onclick']=_0x1b67e8=>{const _0x33481b=_0x46bbc7;_0x1b67e8[_0x33481b(0xe16)][_0x33481b(0x10d3)][_0x33481b(0x3af)](_0x33481b(0x9d6))&&_0x2fc7c7(parseInt(_0x1b67e8[_0x33481b(0xe16)]['dataset']['id']));},document[_0x46bbc7(0xc33)](_0x46bbc7(0x11c8))[_0x46bbc7(0x8a)]=()=>{const _0x9d3ad2=_0x46bbc7;document[_0x9d3ad2(0xc33)]('group-management-modal')[_0x9d3ad2(0x10d3)]['remove'](_0x9d3ad2(0x143)),_0x46b9c2();},document[_0x46bbc7(0xc33)](_0x46bbc7(0x276))[_0x46bbc7(0x10d3)][_0x46bbc7(0xb9)](_0x46bbc7(0x143));}async function _0x176820(){const _0x598b2f=_0x247bea,_0x531d05=document['getElementById'](_0x598b2f(0x8a4)),_0x178e6b=await _0x2a2987[_0x598b2f(0x4b6)][_0x598b2f(0xf15)]();_0x531d05[_0x598b2f(0x102a)]='',_0x178e6b['length']===0x0&&(_0x531d05['innerHTML']='<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-secondary);\x22>还没有任何分类</p>'),_0x178e6b['forEach'](_0x353df1=>{const _0x2877bb=_0x598b2f,_0x398870=document[_0x2877bb(0x1292)](_0x2877bb(0x58c));_0x398870[_0x2877bb(0x84)]=_0x2877bb(0x1151),_0x398870[_0x2877bb(0x102a)]=_0x2877bb(0x500)+_0x353df1['name']+_0x2877bb(0xed1)+_0x353df1['id']+_0x2877bb(0x3fa),_0x531d05[_0x2877bb(0xf77)](_0x398870);});}async function _0x1b5d0f(){const _0x52ad71=_0x247bea,_0x273978=document[_0x52ad71(0xc33)]('new-group-name-input'),_0x498956=_0x273978[_0x52ad71(0x22a)][_0x52ad71(0x7da)]();if(!_0x498956)return alert('分类名不能为空！');const _0x53d425=await _0x2a2987[_0x52ad71(0x4b6)][_0x52ad71(0x8b5)](_0x52ad71(0x578))[_0x52ad71(0x10bd)](_0x498956)[_0x52ad71(0x4e3)]();if(_0x53d425)return alert(_0x52ad71(0xbe3)+_0x498956+_0x52ad71(0xe85));await _0x2a2987[_0x52ad71(0x4b6)]['add']({'name':_0x498956}),_0x273978[_0x52ad71(0x22a)]='',await _0x176820();}async function _0x2fc7c7(_0x30f8fa){const _0x35156e=_0x247bea,_0x8f7c12=await _0x270512(_0x35156e(0x8d6),'删除分类后，该分类下的所有预设将变为“未分类”。确定吗？',{'confirmButtonClass':'btn-danger'});_0x8f7c12&&(await _0x2a2987[_0x35156e(0x4b6)][_0x35156e(0x9ea)](_0x30f8fa),await _0x2a2987[_0x35156e(0xe31)]['where'](_0x35156e(0x305))['equals'](_0x30f8fa)[_0x35156e(0x423)]({'categoryId':null}),_0x12493e['presets']=await _0x2a2987[_0x35156e(0xe31)][_0x35156e(0xf15)](),await _0x176820());}async function _0x38d289(_0x31fa7b){const _0x2cefa6=_0x247bea,_0x31fe27=_0x31fa7b[_0x2cefa6(0xe16)]['files'][0x0];if(!_0x31fe27)return;try{if(!_0x31fe27[_0x2cefa6(0x578)][_0x2cefa6(0x5d5)]('.json'))throw new Error(_0x2cefa6(0x116a));const _0x399777=await _0x31fe27['text'](),_0x3ff671=JSON[_0x2cefa6(0x6b1)](_0x399777);await _0x5a60bb(_0x3ff671,_0x31fe27[_0x2cefa6(0x578)]);}catch(_0x54107f){console['error'](_0x2cefa6(0xac5),_0x54107f),await _0x2d7ddd(_0x2cefa6(0x11bc),_0x2cefa6(0x86e)+_0x54107f[_0x2cefa6(0xf93)]);}finally{_0x31fa7b[_0x2cefa6(0xe16)][_0x2cefa6(0x22a)]=null;}}async function _0x5a60bb(_0xcc918f,_0x178c69){const _0x420e75=_0x247bea;let _0x59d687=[];if(Array[_0x420e75(0x621)](_0xcc918f[_0x420e75(0x9c2)])&&Array[_0x420e75(0x621)](_0xcc918f[_0x420e75(0x47c)])&&_0xcc918f[_0x420e75(0x47c)][_0x420e75(0x79b)]>0x0){console[_0x420e75(0x51f)](_0x420e75(0x10f1));const _0x1eaf10=new Map(_0xcc918f[_0x420e75(0x9c2)]['map'](_0x4d00f0=>[_0x4d00f0[_0x420e75(0xebe)],_0x4d00f0])),_0x2a74ec=_0xcc918f[_0x420e75(0x47c)][_0x420e75(0xdf9)]((_0x21401e,_0x178eb0)=>_0x178eb0[_0x420e75(0x7e9)]&&_0x178eb0[_0x420e75(0x7e9)][_0x420e75(0x79b)]>(_0x21401e[_0x420e75(0x79b)]||0x0)?_0x178eb0['order']:_0x21401e,[]);_0x2a74ec&&_0x2a74ec['length']>0x0&&(_0x59d687=_0x2a74ec[_0x420e75(0x9d5)](_0x355a75=>{const _0x28c07d=_0x420e75,_0x4d8940=_0x1eaf10[_0x28c07d(0xec0)](_0x355a75[_0x28c07d(0xebe)]);if(_0x4d8940)return{'keys':[],'comment':_0x4d8940[_0x28c07d(0x578)]||'无标题','content':_0x4d8940[_0x28c07d(0xcbd)]||'','enabled':_0x355a75[_0x28c07d(0x95a)]};return null;})[_0x420e75(0x1054)](Boolean));}else{if(_0xcc918f[_0x420e75(0x43e)]&&typeof _0xcc918f[_0x420e75(0x43e)]==='object')console[_0x420e75(0x51f)]('检测到\x20\x27entries\x27\x20对象格式的预设，将尝试按顺序导入。'),Array[_0x420e75(0x621)](_0xcc918f['order'])?(console[_0x420e75(0x51f)](_0x420e75(0xa3)),_0x59d687=_0xcc918f[_0x420e75(0x7e9)][_0x420e75(0x9d5)](_0x501fed=>_0xcc918f[_0x420e75(0x43e)][_0x501fed])[_0x420e75(0x1054)](Boolean)[_0x420e75(0x9d5)](_0x554cb4=>({'keys':_0x554cb4[_0x420e75(0x10ae)]||[],'comment':_0x554cb4[_0x420e75(0x8db)]||_0x420e75(0x2cb),'content':_0x554cb4[_0x420e75(0xcbd)]||'','enabled':!_0x554cb4[_0x420e75(0x7cd)]}))):(console[_0x420e75(0x54a)]('未在文件中找到\x20\x27order\x27\x20字段，条目可能无法按原始顺序导入。'),_0x59d687=Object[_0x420e75(0xd28)](_0xcc918f[_0x420e75(0x43e)])[_0x420e75(0x9d5)](_0x5ccd91=>({'keys':_0x5ccd91[_0x420e75(0x10ae)]||[],'comment':_0x5ccd91[_0x420e75(0x8db)]||'无备注','content':_0x5ccd91[_0x420e75(0xcbd)]||'','enabled':!_0x5ccd91[_0x420e75(0x7cd)]})));else{if(Array['isArray'](_0xcc918f[_0x420e75(0x9c2)]))console[_0x420e75(0x51f)]('检测到简单的\x20\x27prompts\x27\x20数组格式，将按数组内顺序导入。'),_0x59d687=_0xcc918f[_0x420e75(0x9c2)][_0x420e75(0x9d5)](_0x19db9a=>({'keys':[],'comment':_0x19db9a[_0x420e75(0x578)]||_0x420e75(0x645),'content':_0x19db9a[_0x420e75(0xcbd)]||'','enabled':!![]}));else throw new Error('文件格式无法识别。未找到有效的\x20\x27prompts\x27\x20数组或\x20\x27entries\x27\x20对象。');}}_0x59d687=_0x59d687['filter'](_0x534f24=>_0x534f24['content']);if(_0x59d687['length']===0x0){alert(_0x420e75(0x834));return;}const _0x4200fa=_0x178c69['replace'](/\.json$/i,''),_0x5f424c=await _0x1ca09c(_0x420e75(0x852),_0x420e75(0x64b),_0x4200fa);if(!_0x5f424c||!_0x5f424c[_0x420e75(0x7da)]()){alert(_0x420e75(0x227));return;}const _0x388ab2={'id':_0x420e75(0xc80)+Date[_0x420e75(0x6ee)](),'name':_0x5f424c[_0x420e75(0x7da)](),'content':_0x59d687,'categoryId':null};await _0x2a2987[_0x420e75(0xe31)][_0x420e75(0xb9)](_0x388ab2),_0x12493e['presets'][_0x420e75(0x2d6)](_0x388ab2),await _0x46b9c2(),await _0x2d7ddd('导入成功！',_0x420e75(0x1cc)+_0x5f424c+'》。');}async function _0x25faa6(_0xe667d0){const _0x2c5620=_0x247bea,_0x5f41fc=document['getElementById'](_0x2c5620(0x5d9));if(!_0x5f41fc)return;const _0x2adb68=_0x12493e[_0x2c5620(0xe31)]||[];_0x5f41fc[_0x2c5620(0x102a)]=_0x2c5620(0xba5),_0x2adb68[_0x2c5620(0xd6a)](_0x5c87b6=>{const _0x4efa71=_0x2c5620,_0x26d0ab=document[_0x4efa71(0x1292)](_0x4efa71(0x2f6));_0x26d0ab[_0x4efa71(0x22a)]=_0x5c87b6['id'],_0x26d0ab[_0x4efa71(0x11b0)]=_0x5c87b6['name'],_0x5f41fc[_0x4efa71(0xf77)](_0x26d0ab);}),_0xe667d0[_0x2c5620(0x2ea)][_0x2c5620(0x1013)]&&(_0x5f41fc[_0x2c5620(0x22a)]=_0xe667d0['settings'][_0x2c5620(0x1013)]);}function _0x404c17(){const _0x780a19=_0x247bea,_0x2b1110=document[_0x780a19(0xc33)](_0x780a19(0x869));if(!_0x2b1110)return;_0x2b1110[_0x780a19(0x102a)]='';let _0x2d4a57=_0x12493e['globalSettings'][_0x780a19(0xff9)]||_0x5a2bf1;_0x2d4a57[_0x780a19(0xd6a)](_0x10e88e=>{const _0x3abafc=_0x780a19,_0x171833=document['getElementById'](_0x10e88e);if(_0x171833){const _0x507e65=document[_0x3abafc(0x1292)](_0x3abafc(0x58c));_0x507e65[_0x3abafc(0x84)]='draggable-button-item',_0x507e65[_0x3abafc(0x630)]=!![],_0x507e65[_0x3abafc(0x85)][_0x3abafc(0xb99)]=_0x10e88e,_0x507e65[_0x3abafc(0x102a)]=_0x171833[_0x3abafc(0x102a)],_0x2b1110[_0x3abafc(0xf77)](_0x507e65);}});}function _0x4a5adc(){const _0x532e8f=_0x247bea,_0xefbbeb=document[_0x532e8f(0xc33)](_0x532e8f(0x869));if(!_0xefbbeb)return;let _0x185008=null;const _0x1cba2f=_0x24f4b8=>{const _0x58bf98=_0x532e8f,_0x175769=_0x24f4b8[_0x58bf98(0xe16)]['closest'](_0x58bf98(0x93d));if(!_0x175769)return;_0x185008=_0x175769,_0x185008[_0x58bf98(0x10d3)][_0x58bf98(0xb9)]('dragging');if(_0x24f4b8[_0x58bf98(0x585)])_0x24f4b8['preventDefault']();},_0x368c7f=_0x5809f8=>{const _0x2e4013=_0x532e8f;if(!_0x185008)return;const _0x2d4acf=_0x5809f8[_0x2e4013(0x52a)]['includes'](_0x2e4013(0x3ea))?_0x5809f8[_0x2e4013(0x86f)]:_0x5809f8[_0x2e4013(0xc01)][0x0][_0x2e4013(0x86f)],_0x326145=_0x22dbe4(_0xefbbeb,_0x2d4acf);_0x326145==null?_0xefbbeb['appendChild'](_0x185008):_0xefbbeb[_0x2e4013(0x829)](_0x185008,_0x326145);},_0x3a2cc6=()=>{const _0xde0d65=_0x532e8f;if(!_0x185008)return;_0x185008[_0xde0d65(0x10d3)]['remove'](_0xde0d65(0xcf2)),_0x185008=null,_0x38edc7();};_0xefbbeb['addEventListener']('mousedown',_0x1cba2f),_0xefbbeb[_0x532e8f(0x205)](_0x532e8f(0x4b1),_0x1cba2f,{'passive':![]}),_0xefbbeb[_0x532e8f(0x205)]('mousemove',_0x368c7f),_0xefbbeb['addEventListener'](_0x532e8f(0xe66),_0x368c7f,{'passive':![]}),_0xefbbeb['addEventListener'](_0x532e8f(0xacf),_0x3a2cc6),_0xefbbeb[_0x532e8f(0x205)]('mouseleave',_0x3a2cc6),_0xefbbeb[_0x532e8f(0x205)](_0x532e8f(0x706),_0x3a2cc6);}function _0x22dbe4(_0x79f92a,_0x34fb51){const _0x17c94f=_0x247bea,_0x14ff70=[..._0x79f92a[_0x17c94f(0x67a)](_0x17c94f(0x1245))];return _0x14ff70['reduce']((_0x214338,_0x45ccf3)=>{const _0x47678b=_0x17c94f,_0x26f1f5=_0x45ccf3[_0x47678b(0x9f3)](),_0x2d92c2=_0x34fb51-_0x26f1f5['left']-_0x26f1f5[_0x47678b(0x5f8)]/0x2;return _0x2d92c2<0x0&&_0x2d92c2>_0x214338[_0x47678b(0x529)]?{'offset':_0x2d92c2,'element':_0x45ccf3}:_0x214338;},{'offset':Number[_0x17c94f(0x64c)]})['element'];}async function _0x38edc7(){const _0x441e8e=_0x247bea,_0x172305=document['getElementById'](_0x441e8e(0x869)),_0x3ceb9e=Array[_0x441e8e(0x301)](_0x172305[_0x441e8e(0x67a)]('.draggable-button-item'))[_0x441e8e(0x9d5)](_0x38174a=>_0x38174a['dataset']['buttonId']);_0x12493e['globalSettings']['chatActionButtonsOrder']=_0x3ceb9e,await _0x2a2987['globalSettings'][_0x441e8e(0xf36)](_0x12493e[_0x441e8e(0x10f6)]);}function _0x1572dc(){const _0x5d81ea=_0x247bea,_0x421bb8=_0x12493e[_0x5d81ea(0x10f6)][_0x5d81ea(0xff9)];if(!_0x421bb8||!Array[_0x5d81ea(0x621)](_0x421bb8)||_0x421bb8[_0x5d81ea(0x79b)]===0x0)return;const _0x1793c2=document[_0x5d81ea(0xc33)](_0x5d81ea(0x128b));if(!_0x1793c2)return;_0x421bb8['forEach'](_0x4cf7cd=>{const _0x3694f8=_0x5d81ea,_0x21b0bc=document[_0x3694f8(0xc33)](_0x4cf7cd);_0x21b0bc&&_0x1793c2[_0x3694f8(0xf77)](_0x21b0bc);});}const _0x5a2bf1=[_0x247bea(0xfc3),'send-photo-btn','upload-image-btn',_0x247bea(0xb3f),_0x247bea(0x900),_0x247bea(0x6a3),_0x247bea(0x255),'group-video-call-btn',_0x247bea(0x2e1),_0x247bea(0x9a8),_0x247bea(0x748),_0x247bea(0xaf3),'open-shopping-btn','pat-btn',_0x247bea(0x1298),_0x247bea(0xef5),_0x247bea(0x9d8),_0x247bea(0x9f8),_0x247bea(0x11b1),_0x247bea(0x2f9)];async function _0x3883db(){const _0x17d80a=_0x247bea;_0x12493e['globalSettings'][_0x17d80a(0xff9)]=null,await _0x2a2987[_0x17d80a(0x10f6)][_0x17d80a(0xf36)](_0x12493e[_0x17d80a(0x10f6)]),_0x404c17(),_0x1572dc(),await _0x2d7ddd('成功','按钮顺序已恢复为默认设置！');}let _0x5a653b=[],_0x257cf9=[];function _0x60b33(){const _0x32e91f=_0x247bea,_0xd80efe=document[_0x32e91f(0xc33)](_0x32e91f(0xb12));_0x5a653b=[],_0x257cf9=[],_0x44a8bc(),document[_0x32e91f(0xc33)](_0x32e91f(0xf02))[_0x32e91f(0x105d)]['display']=_0x32e91f(0x21a),document[_0x32e91f(0xc33)](_0x32e91f(0x78d))[_0x32e91f(0x105d)][_0x32e91f(0xf44)]=_0x32e91f(0x854),_0xd80efe[_0x32e91f(0x10d3)][_0x32e91f(0xb9)](_0x32e91f(0x143));}function _0x44a8bc(){const _0x27ed5f=_0x247bea,_0x14d38d=document['getElementById']('data-clear-char-list');_0x14d38d['innerHTML']='';const _0x2301fe=document[_0x27ed5f(0x1292)](_0x27ed5f(0x58c));_0x2301fe[_0x27ed5f(0x84)]='clear-posts-item',_0x2301fe[_0x27ed5f(0x85)][_0x27ed5f(0x218)]=_0x27ed5f(0x717),_0x2301fe[_0x27ed5f(0x102a)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+(_0x12493e[_0x27ed5f(0x76c)][_0x27ed5f(0x66a)]||'我')+_0x27ed5f(0x819),_0x14d38d[_0x27ed5f(0xf77)](_0x2301fe),Object['values'](_0x12493e[_0x27ed5f(0xc45)])['forEach'](_0x58770b=>{const _0x4b8e87=_0x27ed5f;if(!_0x58770b['isGroup']){const _0x313c24=document['createElement'](_0x4b8e87(0x58c));_0x313c24['className']=_0x4b8e87(0x579),_0x313c24['dataset'][_0x4b8e87(0x218)]=_0x58770b['id'],_0x313c24['innerHTML']=_0x4b8e87(0x244)+_0x58770b[_0x4b8e87(0x578)]+_0x4b8e87(0x16f),_0x14d38d[_0x4b8e87(0xf77)](_0x313c24);}});}function _0x555941(){const _0x38db91=_0x247bea,_0xa172b4=document[_0x38db91(0xc33)]('data-clear-type-list');_0xa172b4[_0x38db91(0x102a)]='';const _0x166d55=[{'id':'chat','name':'聊天记录','description':_0x38db91(0x935)},{'id':_0x38db91(0x112f),'name':_0x38db91(0xb16),'description':'将清空选定角色的所有动态、评论和点赞。'},{'id':_0x38db91(0xb92),'name':_0x38db91(0x1078),'description':'将清空选定角色的所有通话记录。'},{'id':_0x38db91(0x8c6),'name':'心声','description':_0x38db91(0x49f)},{'id':_0x38db91(0x37c),'name':'长期记忆','description':_0x38db91(0x1ee)},{'id':'favorites','name':'收藏','description':_0x38db91(0xfe4)},{'id':_0x38db91(0x1001),'name':'Cphone数据\x20(CPhone)','description':_0x38db91(0xfd2)}];_0x166d55['forEach'](_0xe96280=>{const _0x1cf476=_0x38db91,_0x506ae6=document[_0x1cf476(0x1292)](_0x1cf476(0x58c));_0x506ae6[_0x1cf476(0x84)]='clear-posts-item',_0x506ae6[_0x1cf476(0x85)]['typeId']=_0xe96280['id'],_0x506ae6['innerHTML']=_0x1cf476(0x1064)+_0xe96280[_0x1cf476(0x578)]+_0x1cf476(0x6da)+_0xe96280[_0x1cf476(0x11ac)]+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0xa172b4[_0x1cf476(0xf77)](_0x506ae6);});}function _0x566828(){const _0x4dc135=_0x247bea,_0x259db2=document[_0x4dc135(0x67a)]('#data-clear-char-list\x20.clear-posts-item.selected');if(_0x259db2['length']===0x0){alert(_0x4dc135(0x1176));return;}_0x5a653b=Array[_0x4dc135(0x301)](_0x259db2)[_0x4dc135(0x9d5)](_0x2e7e4b=>_0x2e7e4b[_0x4dc135(0x85)][_0x4dc135(0x218)]),_0x555941(),document[_0x4dc135(0xc33)](_0x4dc135(0xf02))[_0x4dc135(0x105d)]['display']=_0x4dc135(0x854),document[_0x4dc135(0xc33)](_0x4dc135(0x78d))[_0x4dc135(0x105d)]['display']=_0x4dc135(0x21a);}function _0x2af8f2(){const _0x2787ff=_0x247bea;document[_0x2787ff(0xc33)]('data-clear-step-2')[_0x2787ff(0x105d)]['display']=_0x2787ff(0x854),document['getElementById'](_0x2787ff(0xf02))['style'][_0x2787ff(0xf44)]=_0x2787ff(0x21a),document[_0x2787ff(0x67a)]('#data-clear-char-list\x20.clear-posts-item')[_0x2787ff(0xd6a)](_0x4a3936=>{const _0x17d4fe=_0x2787ff;_0x5a653b[_0x17d4fe(0x1d4)](_0x4a3936[_0x17d4fe(0x85)][_0x17d4fe(0x218)])&&_0x4a3936['classList']['add']('selected');});}async function _0x1e9eb3(){const _0xda9443=_0x247bea,_0x5b5ba3=document['querySelectorAll'](_0xda9443(0xb18));if(_0x5b5ba3['length']===0x0){alert('请至少选择一种要清理的数据类型。');return;}_0x257cf9=Array[_0xda9443(0x301)](_0x5b5ba3)[_0xda9443(0x9d5)](_0x4c7678=>_0x4c7678[_0xda9443(0x85)][_0xda9443(0xf4f)]);const _0x3cd34f=await _0x270512(_0xda9443(0xa3b),_0xda9443(0x8e3),{'confirmButtonClass':_0xda9443(0xa2),'confirmText':_0xda9443(0x8d6)});if(!_0x3cd34f)return;await _0x2d7ddd('请稍候...',_0xda9443(0xbee));try{await _0x2a2987[_0xda9443(0xbff)]('rw',_0x2a2987[_0xda9443(0xf92)],async()=>{const _0x4d5fd2=_0xda9443;for(const _0x29a3f3 of _0x5a653b){for(const _0x2b85a4 of _0x257cf9){if(_0x2b85a4===_0x4d5fd2(0x824)){if(_0x29a3f3===_0x4d5fd2(0x717)){const _0x1a1ebe=await _0x2a2987['chats'][_0x4d5fd2(0xf15)]();for(const _0x54fcd5 of _0x1a1ebe){_0x54fcd5[_0x4d5fd2(0x1294)]=_0x54fcd5[_0x4d5fd2(0x1294)]['filter'](_0x45efc5=>_0x45efc5[_0x4d5fd2(0x16d)]!==_0x4d5fd2(0x717)),await _0x2a2987[_0x4d5fd2(0xc45)][_0x4d5fd2(0xf36)](_0x54fcd5);}}else{const _0x4ab5f2=await _0x2a2987[_0x4d5fd2(0xc45)][_0x4d5fd2(0xec0)](_0x29a3f3);_0x4ab5f2&&(_0x4ab5f2['history']=[],_0x4ab5f2[_0x4d5fd2(0x70a)]=_0x4d5fd2(0xda0),_0x4ab5f2['randomJottings']=_0x4d5fd2(0xda0),Array[_0x4d5fd2(0x621)](_0x4ab5f2[_0x4d5fd2(0xa1a)])&&(_0x4ab5f2[_0x4d5fd2(0xa1a)]=[]),_0x4ab5f2[_0x4d5fd2(0x2ea)]&&(_0x4ab5f2['settings'][_0x4d5fd2(0xbf6)]='我'),await _0x2a2987[_0x4d5fd2(0xc45)][_0x4d5fd2(0xf36)](_0x4ab5f2));}}if(_0x2b85a4===_0x4d5fd2(0x112f)){const _0x528f7e=_0x29a3f3===_0x4d5fd2(0x717)?'user':_0x29a3f3;await _0x2a2987[_0x4d5fd2(0x110b)][_0x4d5fd2(0x8b5)](_0x4d5fd2(0xd48))[_0x4d5fd2(0x10bd)](_0x528f7e)[_0x4d5fd2(0x9ea)]();}_0x2b85a4===_0x4d5fd2(0xb92)&&_0x29a3f3!=='user'&&await _0x2a2987[_0x4d5fd2(0x508)]['where']('chatId')['equals'](_0x29a3f3)['delete']();if(_0x2b85a4==='thoughts'&&_0x29a3f3!==_0x4d5fd2(0x717)){const _0x1ff854=await _0x2a2987['chats'][_0x4d5fd2(0xec0)](_0x29a3f3);_0x1ff854&&(_0x1ff854[_0x4d5fd2(0x11e9)]=[],_0x1ff854[_0x4d5fd2(0x70a)]=_0x4d5fd2(0xda0),_0x1ff854[_0x4d5fd2(0xb53)]='...',await _0x2a2987[_0x4d5fd2(0xc45)][_0x4d5fd2(0xf36)](_0x1ff854));}if(_0x2b85a4===_0x4d5fd2(0x37c)&&_0x29a3f3!==_0x4d5fd2(0x717)){const _0x4e107b=await _0x2a2987[_0x4d5fd2(0xc45)][_0x4d5fd2(0xec0)](_0x29a3f3);_0x4e107b&&(_0x4e107b[_0x4d5fd2(0x45b)]=[],await _0x2a2987[_0x4d5fd2(0xc45)][_0x4d5fd2(0xf36)](_0x4e107b));}_0x2b85a4===_0x4d5fd2(0xe69)&&(_0x29a3f3===_0x4d5fd2(0x717)?(await _0x2a2987[_0x4d5fd2(0xe69)][_0x4d5fd2(0x8b5)](_0x4d5fd2(0x52a))[_0x4d5fd2(0x10bd)](_0x4d5fd2(0x4a1))[_0x4d5fd2(0x1054)](_0x3e4e28=>_0x3e4e28[_0x4d5fd2(0xcbd)][_0x4d5fd2(0xd48)]===_0x4d5fd2(0x717))[_0x4d5fd2(0x9ea)](),await _0x2a2987[_0x4d5fd2(0xe69)]['where'](_0x4d5fd2(0x52a))[_0x4d5fd2(0x10bd)](_0x4d5fd2(0x11c0))[_0x4d5fd2(0x1054)](_0x4b55e7=>_0x4b55e7['content']['role']===_0x4d5fd2(0x717))[_0x4d5fd2(0x9ea)]()):(await _0x2a2987[_0x4d5fd2(0xe69)][_0x4d5fd2(0x8b5)](_0x4d5fd2(0x52a))[_0x4d5fd2(0x10bd)](_0x4d5fd2(0x11c0))[_0x4d5fd2(0x19e)](_0x208ee4=>_0x208ee4[_0x4d5fd2(0x109b)]===_0x29a3f3)[_0x4d5fd2(0x9ea)](),await _0x2a2987['favorites'][_0x4d5fd2(0x8b5)](_0x4d5fd2(0x52a))[_0x4d5fd2(0x10bd)]('qzone_post')[_0x4d5fd2(0x1054)](_0x2b8f53=>_0x2b8f53[_0x4d5fd2(0xcbd)]['authorId']===_0x29a3f3)[_0x4d5fd2(0x9ea)](),await _0x2a2987['favorites']['where'](_0x4d5fd2(0x52a))[_0x4d5fd2(0x10bd)](_0x4d5fd2(0xee8))[_0x4d5fd2(0x1054)](_0x25cfa7=>_0x25cfa7[_0x4d5fd2(0xcbd)]['characterId']===_0x29a3f3)[_0x4d5fd2(0x9ea)](),await _0x2a2987[_0x4d5fd2(0xe69)][_0x4d5fd2(0x8b5)](_0x4d5fd2(0x52a))[_0x4d5fd2(0x10bd)]('char_browser_article')['filter'](_0x11c63b=>_0x11c63b[_0x4d5fd2(0xcbd)][_0x4d5fd2(0x602)]===_0x29a3f3)['delete'](),await _0x2a2987[_0x4d5fd2(0xe69)][_0x4d5fd2(0x8b5)](_0x4d5fd2(0x52a))['equals']('char_memo')[_0x4d5fd2(0x1054)](_0x3b353c=>_0x3b353c[_0x4d5fd2(0xcbd)][_0x4d5fd2(0x602)]===_0x29a3f3)[_0x4d5fd2(0x9ea)]()));if(_0x2b85a4===_0x4d5fd2(0x1001)&&_0x29a3f3!==_0x4d5fd2(0x717)){const _0x31fe17=await _0x2a2987[_0x4d5fd2(0xc45)][_0x4d5fd2(0xec0)](_0x29a3f3);_0x31fe17&&(_0x31fe17[_0x4d5fd2(0xf28)]=[],_0x31fe17[_0x4d5fd2(0xf18)]=[],_0x31fe17[_0x4d5fd2(0x9c8)]=[],_0x31fe17[_0x4d5fd2(0x1156)]=null,_0x31fe17[_0x4d5fd2(0xf7c)]=[],_0x31fe17['simulatedAppUsage']=[],_0x31fe17['simulatedMusicPlaylist']=[],_0x31fe17[_0x4d5fd2(0x767)]=[],_0x31fe17[_0x4d5fd2(0x1f1)]=[],await _0x2a2987[_0x4d5fd2(0xc45)][_0x4d5fd2(0xf36)](_0x31fe17));}}}}),await _0x1af137(),await _0x597ed7(),document[_0xda9443(0xc33)]('data-clear-wizard-modal')[_0xda9443(0x10d3)][_0xda9443(0x2c7)](_0xda9443(0x143)),await _0x2d7ddd(_0xda9443(0x10fc),_0xda9443(0x641));}catch(_0x253eb6){console[_0xda9443(0x4d9)](_0xda9443(0xf0c),_0x253eb6),await _0x2d7ddd(_0xda9443(0x141),_0xda9443(0xa26)+_0x253eb6[_0xda9443(0xf93)]);}}async function _0x5044c5(_0x20a14e,_0x4ecf71,_0x4d3996){const _0x2eaa36=_0x247bea,_0x3d5fb6=_0x4d3996[_0x2eaa36(0x977)](_0x2eaa36(0x499))[_0x2eaa36(0x96)],_0x1414ae=await _0x46f58a(_0x2eaa36(0x14d)+_0x3d5fb6+_0x2eaa36(0x7f9),[{'text':_0x2eaa36(0x67d),'value':_0x2eaa36(0xc06)},{'text':_0x2eaa36(0x10ac),'value':_0x2eaa36(0x11a)}]);let _0x376849=null;if(_0x1414ae==='local')_0x376849=await _0x4cf6c8();else{if(_0x1414ae==='url'){const _0x3dcb00=_0x4ecf71==='cphone'?_0x12493e['globalSettings'][_0x2eaa36(0x2d4)][_0x20a14e]:_0x12493e[_0x2eaa36(0x10f6)][_0x2eaa36(0x4da)][_0x20a14e],_0x102c48=_0x3dcb00[_0x2eaa36(0xece)](_0x2eaa36(0x4c5)),_0x2cc6fc=_0x102c48?'':_0x3dcb00;_0x376849=await _0x1ca09c(_0x2eaa36(0x104c),_0x2eaa36(0x416),_0x2cc6fc,_0x2eaa36(0x11a));}}if(_0x376849&&_0x376849[_0x2eaa36(0x7da)]()){const _0xfc117b=_0x376849[_0x2eaa36(0x7da)]();_0x4ecf71===_0x2eaa36(0x1001)?_0x12493e['globalSettings'][_0x2eaa36(0x2d4)][_0x20a14e]=_0xfc117b:_0x12493e[_0x2eaa36(0x10f6)][_0x2eaa36(0x4da)][_0x20a14e]=_0xfc117b,_0x4d3996[_0x2eaa36(0x977)](_0x2eaa36(0x499))['src']=_0xfc117b;}else _0x376849!==null&&alert('请输入一个有效的URL或选择一个文件！');}async function _0x160df8(){const _0xb38fe9=_0x247bea,_0x21d80a=await _0x270512(_0xb38fe9(0xca3),_0xb38fe9(0x304),{'confirmButtonClass':_0xb38fe9(0xa2),'confirmText':_0xb38fe9(0x1131)});if(!_0x21d80a)return;await _0x2d7ddd(_0xb38fe9(0xb37),'正在开始全面压缩图片，根据图片数量，这可能需要几分钟时间，请不要关闭或刷新页面...');let _0x1b108e={'found':0x0,'compressed':0x0,'skipped':0x0,'originalSize':0x0,'newSize':0x0};try{console[_0xb38fe9(0x51f)]('压缩步骤\x201/3:\x20正在从数据库读取所有相关数据...');const _0x22fbbf=[_0xb38fe9(0xc45),_0xb38fe9(0x10f6),_0xb38fe9(0x76c),_0xb38fe9(0x454),_0xb38fe9(0xc7e)],_0x5c73cf=[];for(const _0x242854 of _0x22fbbf){const _0x5a75fc=_0x2a2987[_0xb38fe9(0xf3e)](_0x242854),_0x4c6974=await _0x5a75fc['toArray']();_0x5c73cf[_0xb38fe9(0x2d6)]({'tableName':_0x242854,'records':_0x4c6974});}console[_0xb38fe9(0x51f)](_0xb38fe9(0xb20));for(const _0x6ee9f of _0x5c73cf){for(const _0x53b81c of _0x6ee9f['records']){await _0x4aba08(_0x53b81c,_0x1b108e);}}console[_0xb38fe9(0x51f)](_0xb38fe9(0xacc)),await _0x2a2987[_0xb38fe9(0xbff)]('rw',_0x22fbbf,async()=>{const _0x2b87ae=_0xb38fe9;for(const _0x200a7b of _0x5c73cf){await _0x2a2987[_0x2b87ae(0xf3e)](_0x200a7b[_0x2b87ae(0x81c)])[_0x2b87ae(0xee7)](_0x200a7b[_0x2b87ae(0x81b)]);}});const _0x46c79d=_0x1b108e[_0xb38fe9(0xc3)]-_0x1b108e[_0xb38fe9(0x62c)],_0x4d2b56=_0x1b108e[_0xb38fe9(0xc3)]>0x0?(_0x46c79d/_0x1b108e['originalSize']*0x64)[_0xb38fe9(0xcab)](0x2):0x0;await _0x2d7ddd(_0xb38fe9(0x60c),_0xb38fe9(0xd02)+_0x1b108e[_0xb38fe9(0x5eb)]+_0xb38fe9(0x2c0)+_0x1b108e[_0xb38fe9(0xfd6)]+_0xb38fe9(0x80a)+_0x1b108e['skipped']+_0xb38fe9(0x711)+(_0x46c79d/0x400/0x400)[_0xb38fe9(0xcab)](0x2)+'\x20MB</strong>\x20(压缩率\x20'+_0x4d2b56+_0xb38fe9(0x509));}catch(_0x275626){console[_0xb38fe9(0x4d9)](_0xb38fe9(0x59b),_0x275626),await _0x2d7ddd(_0xb38fe9(0x9d4),_0xb38fe9(0xa26)+_0x275626[_0xb38fe9(0xf93)]);}}function _0x6590df(_0x56b837,_0x2a1398=''){const _0x32abb2=_0x247bea;let _0x39174d=0x0;for(const _0x1c1453 in _0x56b837){if(_0x56b837[_0x32abb2(0x17d)](_0x1c1453)){const _0x776843=_0x56b837[_0x1c1453];if(typeof _0x776843===_0x32abb2(0x9de)&&_0x776843['startsWith']('data:image')){const _0x475ded=_0x2a1398==='globalSettings'&&(_0x1c1453==='wallpaper'||_0x1c1453===_0x32abb2(0x2f5)||_0x1c1453===_0x32abb2(0x840))||_0x2a1398===_0x32abb2(0x28e)||_0x2a1398==='settings'&&_0x1c1453===_0x32abb2(0xc88)||(_0x2a1398===_0x32abb2(0x4da)||_0x2a1398===_0x32abb2(0x2d4));!_0x475ded&&(_0x39174d+=_0x776843['length']);}else typeof _0x776843===_0x32abb2(0xe37)&&_0x776843!==null&&(_0x39174d+=_0x6590df(_0x776843,_0x1c1453));}}return _0x39174d;}async function _0x1aa70a(){const _0x5e9675=_0x247bea,_0x46d873=document[_0x5e9675(0xc33)](_0x5e9675(0x302));if(!_0x46d873)return;_0x46d873[_0x5e9675(0x102a)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-label\x22>正在计算可压缩图片大小...</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-value\x22>--\x20MB</span>\x0a\x20\x20\x20\x20';try{let _0x493ef9=0x0;const _0xa9609b=[_0x5e9675(0xc45),_0x5e9675(0x10f6),_0x5e9675(0x76c),'userStickers',_0x5e9675(0xc7e)];for(const _0x217b38 of _0xa9609b){const _0x27c8c3=_0x2a2987[_0x5e9675(0xf3e)](_0x217b38);await _0x27c8c3[_0x5e9675(0x450)](_0x29b7b7=>{_0x493ef9+=_0x6590df(_0x29b7b7);});}const _0x2529e5=(_0x493ef9/0x400/0x400)['toFixed'](0x2);_0x46d873[_0x5e9675(0x102a)]=_0x5e9675(0xef3)+_0x2529e5+'\x20MB</strong></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}catch(_0xb5c813){console[_0x5e9675(0x4d9)]('计算图片总大小时出错:',_0xb5c813),_0x46d873[_0x5e9675(0x102a)]=_0x5e9675(0x417);}}async function _0x4aba08(_0x6fb9a4,_0x527533,_0x5664b4=''){const _0x43a878=_0x247bea;for(const _0x37282d in _0x6fb9a4){if(_0x6fb9a4[_0x43a878(0x17d)](_0x37282d)){const _0x2a9ed8=_0x6fb9a4[_0x37282d];if(typeof _0x2a9ed8===_0x43a878(0x9de)&&_0x2a9ed8[_0x43a878(0xece)](_0x43a878(0x4c5))){const _0x31604d=_0x5664b4===_0x43a878(0x10f6)&&(_0x37282d==='wallpaper'||_0x37282d==='cphoneWallpaper'||_0x37282d==='globalChatBackground')||_0x5664b4===_0x43a878(0x28e)||_0x5664b4===_0x43a878(0x2ea)&&_0x37282d==='background'||(_0x5664b4===_0x43a878(0x4da)||_0x5664b4===_0x43a878(0x2d4));if(_0x31604d)continue;_0x527533[_0x43a878(0x5eb)]++,_0x527533[_0x43a878(0xc3)]+=_0x2a9ed8[_0x43a878(0x79b)];const _0x245c56=await _0x16cb8a(_0x2a9ed8);_0x245c56&&_0x245c56!==_0x2a9ed8?(_0x6fb9a4[_0x37282d]=_0x245c56,_0x527533[_0x43a878(0xfd6)]++,_0x527533[_0x43a878(0x62c)]+=_0x245c56['length']):(_0x527533['skipped']++,_0x527533[_0x43a878(0x62c)]+=_0x2a9ed8[_0x43a878(0x79b)]);}else typeof _0x2a9ed8===_0x43a878(0xe37)&&_0x2a9ed8!==null&&await _0x4aba08(_0x2a9ed8,_0x527533,_0x37282d);}}}function _0x16cb8a(_0x3981d7,_0x1c6164={}){return new Promise(_0x1925f3=>{const _0x1bd3c4=_0x26e9;if(!_0x3981d7['startsWith']('data:image')){console[_0x1bd3c4(0x54a)](_0x1bd3c4(0x1168),_0x3981d7[_0x1bd3c4(0x1033)](0x0,0x32)+_0x1bd3c4(0xda0)),_0x1925f3(_0x3981d7);return;}const _0x3ac5c2=_0x1c6164[_0x1bd3c4(0x3de)]||0.5,_0x192601=_0x1c6164[_0x1bd3c4(0x101a)]||0x320,_0x433c47=new Image();_0x433c47['onload']=()=>{const _0x206361=_0x1bd3c4;let _0x2a1b19=_0x433c47['width'],_0x40e280=_0x433c47[_0x206361(0x27d)];_0x2a1b19>_0x192601&&(_0x40e280=Math[_0x206361(0x113a)](_0x192601/_0x2a1b19*_0x40e280),_0x2a1b19=_0x192601);const _0x3b5a6a=document[_0x206361(0x1292)]('canvas');_0x3b5a6a['width']=_0x2a1b19,_0x3b5a6a[_0x206361(0x27d)]=_0x40e280;const _0x298066=_0x3b5a6a[_0x206361(0x3b9)]('2d');_0x298066['drawImage'](_0x433c47,0x0,0x0,_0x2a1b19,_0x40e280);const _0x30f358=_0x3b5a6a[_0x206361(0x10ec)](_0x206361(0x614),_0x3ac5c2);_0x1925f3(_0x30f358);},_0x433c47[_0x1bd3c4(0x6e0)]=()=>{const _0x4c87da=_0x1bd3c4;console[_0x4c87da(0x54a)]('加载图片失败，跳过压缩:',_0x3981d7[_0x4c87da(0x1033)](0x0,0x32)+_0x4c87da(0xda0)),_0x1925f3(_0x3981d7);},_0x433c47[_0x1bd3c4(0x87b)]=_0x3981d7;});}function _0x2b0ae2(_0x48ac75,_0x3f588b){const _0x16b8b9=_0x247bea;if(!_0x48ac75||!_0x3f588b||typeof _0x48ac75!==_0x16b8b9(0x9de)||typeof _0x3f588b!==_0x16b8b9(0x9de))return 0x0;const _0x4ceaf7=_0x48ac75[_0x16b8b9(0x8d7)]('.')[_0x16b8b9(0x9d5)](Number),_0x48909d=_0x3f588b[_0x16b8b9(0x8d7)]('.')[_0x16b8b9(0x9d5)](Number),_0x5c93b6=Math['max'](_0x4ceaf7[_0x16b8b9(0x79b)],_0x48909d[_0x16b8b9(0x79b)]);for(let _0x41fefa=0x0;_0x41fefa<_0x5c93b6;_0x41fefa++){const _0x2618db=_0x4ceaf7[_0x41fefa]||0x0,_0x32b949=_0x48909d[_0x41fefa]||0x0;if(_0x2618db>_0x32b949)return 0x1;if(_0x2618db<_0x32b949)return-0x1;}return 0x0;}async function _0x508b22(){const _0x481f96=_0x247bea,_0x570e04=_0x481f96(0x701);try{const _0x47157c=await fetch(_0x481f96(0x86a)+Date[_0x481f96(0x6ee)]());if(!_0x47157c['ok']){console[_0x481f96(0x54a)](_0x481f96(0x118d));return;}const _0xc9c890=await _0x47157c[_0x481f96(0x996)](),_0x476c5e=document[_0x481f96(0x1292)](_0x481f96(0x58c));_0x476c5e['innerHTML']=_0xc9c890;const _0x480e34=_0x476c5e[_0x481f96(0x977)](_0x481f96(0xefb));if(!_0x480e34){console[_0x481f96(0x4d9)]('更新通知文件中缺少\x20data-version\x20属性。');return;}const _0x3a44b7=_0x480e34[_0x481f96(0x85)]['version'],_0x314360=localStorage[_0x481f96(0x7bb)]('dismissedUpdateVersion');!_0x314360||_0x2b0ae2(_0x3a44b7,_0x314360)>0x0?(console[_0x481f96(0x51f)](_0x481f96(0x552)+_0x3a44b7+_0x481f96(0xe38)+(_0x314360||'无')+')'),_0x3a95b1(_0x3a44b7,_0x480e34[_0x481f96(0x102a)])):console[_0x481f96(0x51f)]('当前通知版本\x20('+_0x3a44b7+_0x481f96(0x684));}catch(_0x15fbfc){console[_0x481f96(0x4d9)](_0x481f96(0x5d1),_0x15fbfc);}}function _0x3a95b1(_0x28ecaf,_0x4135cf){const _0x1e6344=_0x247bea,_0xf70fc8=document['getElementById'](_0x1e6344(0x2cf)),_0xff01bb=document['getElementById'](_0x1e6344(0x8dc)),_0x4e5e4e=document[_0x1e6344(0xc33)]('update-notice-confirm-btn'),_0x36a0f9=document[_0x1e6344(0xc33)](_0x1e6344(0x103a));_0xff01bb[_0x1e6344(0x102a)]=_0x4135cf,_0x4e5e4e[_0x1e6344(0x8a)]=()=>{const _0x19c179=_0x1e6344;_0xf70fc8['classList'][_0x19c179(0x2c7)](_0x19c179(0x143));},_0x36a0f9[_0x1e6344(0x8a)]=()=>{const _0x412c72=_0x1e6344;localStorage['setItem'](_0x412c72(0x23b),_0x28ecaf),_0xf70fc8[_0x412c72(0x10d3)][_0x412c72(0x2c7)]('visible'),console[_0x412c72(0x51f)]('用户已忽略版本:\x20'+_0x28ecaf);},_0xf70fc8['classList'][_0x1e6344(0xb9)]('visible');}function _0x19ec2c(){const _0x10e6cf=_0x247bea,_0x2e249f=document['getElementById'](_0x10e6cf(0x4cb));document['getElementById']('douban-min-posts-input')['value']=_0x12493e[_0x10e6cf(0x10f6)][_0x10e6cf(0xabb)]||0xc,document[_0x10e6cf(0xc33)](_0x10e6cf(0x61c))[_0x10e6cf(0x22a)]=_0x12493e['globalSettings'][_0x10e6cf(0xc15)]||0x14,_0x2e249f['classList']['add'](_0x10e6cf(0x143));}async function _0xe6ffde(){const _0x4f8b36=_0x247bea,_0x57533d=document[_0x4f8b36(0xc33)]('douban-min-posts-input'),_0x40b418=document[_0x4f8b36(0xc33)](_0x4f8b36(0x61c)),_0x658852=parseInt(_0x57533d[_0x4f8b36(0x22a)]),_0x2de87e=parseInt(_0x40b418[_0x4f8b36(0x22a)]);if(isNaN(_0x658852)||isNaN(_0x2de87e)||_0x658852<0x1||_0x2de87e<0x1){alert(_0x4f8b36(0x1eb));return;}if(_0x658852>_0x2de87e){alert(_0x4f8b36(0x1246));return;}_0x12493e[_0x4f8b36(0x10f6)][_0x4f8b36(0xabb)]=_0x658852,_0x12493e[_0x4f8b36(0x10f6)][_0x4f8b36(0xc15)]=_0x2de87e,await _0x2a2987[_0x4f8b36(0x10f6)]['put'](_0x12493e[_0x4f8b36(0x10f6)]),document[_0x4f8b36(0xc33)](_0x4f8b36(0x4cb))[_0x4f8b36(0x10d3)][_0x4f8b36(0x2c7)](_0x4f8b36(0x143)),await _0x2d7ddd(_0x4f8b36(0x177),'豆瓣设置已更新！下次重新生成时将生效。');}async function _0xa3b866(_0x9230f7){const _0x4196bb=_0x247bea,_0x3af0fc=document[_0x4196bb(0xc33)](_0x4196bb(0x6ac)),_0x5919c5=document[_0x4196bb(0xc33)]('werewolf-player-selection-list');_0x5919c5['innerHTML']='';let _0x3d9708=[];if(_0x9230f7===_0x4196bb(0x331)){const _0x384f05=Object[_0x4196bb(0xd28)](_0x12493e[_0x4196bb(0xc45)])['filter'](_0x45d2de=>!_0x45d2de[_0x4196bb(0x80b)]),_0x52afeb=await _0x2a2987[_0x4196bb(0xc61)][_0x4196bb(0xf15)]();_0x3d9708=[{'id':_0x4196bb(0x717),'name':_0x12493e[_0x4196bb(0x76c)]['nickname']||'我','originalName':_0x12493e[_0x4196bb(0x76c)][_0x4196bb(0x66a)]||'我','avatar':_0x12493e[_0x4196bb(0x76c)][_0x4196bb(0xbac)],'type':'user'},..._0x384f05[_0x4196bb(0x9d5)](_0x2fc2d7=>({'id':_0x2fc2d7['id'],'name':_0x2fc2d7[_0x4196bb(0x578)],'originalName':_0x2fc2d7[_0x4196bb(0x776)],'avatar':_0x2fc2d7['settings'][_0x4196bb(0x18e)],'type':'character'})),..._0x52afeb['map'](_0x3a294f=>({'id':'npc_'+_0x3a294f['id'],'name':_0x3a294f['name'],'originalName':_0x3a294f['name'],'avatar':_0x3a294f[_0x4196bb(0xbac)],'type':'npc'}))],_0x58b047[_0x4196bb(0x109b)]=null;}else{const _0x49fa93=_0x12493e[_0x4196bb(0xc45)][_0x12493e[_0x4196bb(0x7bc)]];if(!_0x49fa93||!_0x49fa93[_0x4196bb(0x80b)])return;_0x3d9708=[{'id':_0x4196bb(0x717),'name':_0x49fa93[_0x4196bb(0x2ea)][_0x4196bb(0xbf6)]||'我','originalName':_0x12493e[_0x4196bb(0x76c)][_0x4196bb(0x66a)]||'我','avatar':_0x49fa93[_0x4196bb(0x2ea)][_0x4196bb(0x1006)],'type':_0x4196bb(0x717)},..._0x49fa93[_0x4196bb(0xd5b)][_0x4196bb(0x9d5)](_0x1ffcd7=>{const _0x4c71bf=_0x4196bb,_0x17ab7e=_0x12493e['chats'][_0x1ffcd7['id']],_0x5607c1=_0x1ffcd7['avatar']||(_0x17ab7e?_0x17ab7e[_0x4c71bf(0x2ea)][_0x4c71bf(0x18e)]:_0x5b9dd3);return{'id':_0x1ffcd7['id'],'name':_0x1ffcd7['groupNickname'],'originalName':_0x1ffcd7[_0x4c71bf(0x776)],'avatar':_0x5607c1,'type':_0x1ffcd7[_0x4c71bf(0x70b)]?_0x4c71bf(0x10b1):_0x4c71bf(0x46a)};})],_0x58b047[_0x4196bb(0x109b)]=_0x12493e[_0x4196bb(0x7bc)];}_0x3d9708[_0x4196bb(0xd6a)](_0x25f2b3=>{const _0x3b6a7b=_0x4196bb,_0x2475f3=document[_0x3b6a7b(0x1292)]('div');_0x2475f3['className']=_0x3b6a7b(0x676),_0x2475f3[_0x3b6a7b(0x102a)]=_0x3b6a7b(0xc95)+JSON[_0x3b6a7b(0xd27)](_0x25f2b3)+'\x27\x20'+(_0x25f2b3['type']===_0x3b6a7b(0x717)?_0x3b6a7b(0x775):'checked')+_0x3b6a7b(0x3f2)+_0x25f2b3['avatar']+_0x3b6a7b(0x163)+_0x25f2b3[_0x3b6a7b(0x578)]+_0x3b6a7b(0x149),_0x5919c5[_0x3b6a7b(0xf77)](_0x2475f3);}),_0x3af0fc[_0x4196bb(0x10d3)][_0x4196bb(0xb9)]('visible');}async function _0x28fe55(){const _0x29934d=_0x247bea,_0x5420fb=document[_0x29934d(0x67a)]('.werewolf-player-checkbox:checked'),_0x301a57=_0x5420fb[_0x29934d(0x79b)];let _0x10f38f=[];if(_0x301a57===0x6)_0x58b047[_0x29934d(0x7c3)]='6p',_0x10f38f=['狼人','狼人','平民','平民','预言家','猎人'];else{if(_0x301a57===0x9)_0x58b047['gameMode']='9p',_0x10f38f=['狼人','狼人','狼人','平民','平民','平民','预言家','女巫','猎人'];else{if(_0x301a57===0xc)_0x58b047[_0x29934d(0x7c3)]=_0x29934d(0x2a4),_0x10f38f=['狼人','狼人','狼人','狼人','平民','平民','平民','平民','预言家','女巫','猎人','守卫'];else{alert(_0x29934d(0x11ec)+_0x301a57+'\x20不支持。请选择6、9或12人。');return;}}}document[_0x29934d(0xc33)](_0x29934d(0x6ac))['classList'][_0x29934d(0x2c7)](_0x29934d(0x143)),await _0x2d7ddd(_0x29934d(0x96b),_0x29934d(0xbcc));for(let _0x1fae74=_0x10f38f[_0x29934d(0x79b)]-0x1;_0x1fae74>0x0;_0x1fae74--){const _0x52da3d=Math[_0x29934d(0xcb5)](Math[_0x29934d(0xa11)]()*(_0x1fae74+0x1));[_0x10f38f[_0x1fae74],_0x10f38f[_0x52da3d]]=[_0x10f38f[_0x52da3d],_0x10f38f[_0x1fae74]];}const _0x5d6774=Array[_0x29934d(0x301)](_0x5420fb)['map'](_0x26e1ae=>JSON[_0x29934d(0x6b1)](_0x26e1ae['dataset']['playerJson']));_0x58b047[_0x29934d(0x392)]=[];for(let _0x3d758e=0x0;_0x3d758e<_0x5d6774[_0x29934d(0x79b)];_0x3d758e++){const _0x4cb4ab=_0x5d6774[_0x3d758e],_0x3d7210=_0x10f38f[_0x3d758e];let _0x20e57e='一个普通玩家';if(_0x4cb4ab[_0x29934d(0x52a)]==='character'){const _0x4878e2=_0x12493e[_0x29934d(0xc45)][_0x4cb4ab['id']];_0x20e57e=_0x4878e2?_0x4878e2['settings'][_0x29934d(0x679)]:'未知设定的角色';}else{if(_0x4cb4ab['type']===_0x29934d(0x10b1)){const _0x46786b=await _0x2a2987['npcs'][_0x29934d(0xf15)](),_0x216609=_0x46786b[_0x29934d(0xd85)](_0x896c2f=>_0x29934d(0xb90)+_0x896c2f['id']===_0x4cb4ab['id']);_0x20e57e=_0x216609?_0x216609[_0x29934d(0x421)]:_0x29934d(0x49a);}else{if(_0x4cb4ab[_0x29934d(0x52a)]===_0x29934d(0x717)){const _0xb53b9f=_0x58b047[_0x29934d(0x109b)]?_0x12493e['chats'][_0x58b047[_0x29934d(0x109b)]]:null;_0x20e57e=_0xb53b9f?_0xb53b9f[_0x29934d(0x2ea)]['myPersona']:_0x29934d(0x25f);}}}const _0x2781fd={..._0x4cb4ab,'role':_0x3d7210,'isAlive':!![],'character_persona':_0x20e57e};_0x3d7210==='女巫'&&(_0x2781fd[_0x29934d(0x4d8)]=![],_0x2781fd[_0x29934d(0x174)]=![]),_0x3d7210==='守卫'&&(_0x2781fd[_0x29934d(0x12a9)]=null),_0x58b047[_0x29934d(0x392)][_0x29934d(0x2d6)](_0x2781fd);}_0x58b047[_0x29934d(0x1f3)]=!![],_0x58b047[_0x29934d(0x3cb)]=0x1,_0x58b047[_0x29934d(0xfc2)]=_0x29934d(0x10e7),_0x58b047[_0x29934d(0xf85)]=[],_0x58b047[_0x29934d(0x3c9)]=[];const _0x42561b=_0x10f38f[_0x29934d(0xdf9)]((_0x46774b,_0x7522a6)=>{return _0x46774b[_0x7522a6]=(_0x46774b[_0x7522a6]||0x0)+0x1,_0x46774b;},{}),_0x407b84=Object[_0x29934d(0x43e)](_0x42561b)[_0x29934d(0x9d5)](([_0x4d92d7,_0x36b3d4])=>_0x4d92d7+'\x20x'+_0x36b3d4)[_0x29934d(0x100b)]('、');_0x3fc843(_0x29934d(0x836)+_0x301a57+_0x29934d(0x1097)+_0x407b84+'。');const _0x23bd58=_0x58b047[_0x29934d(0x392)][_0x29934d(0xd85)](_0x3c8f2a=>_0x3c8f2a['id']==='user');_0x523a3f(),_0x38f00f('werewolf-game-screen'),_0x162261(_0x23bd58[_0x29934d(0x16d)]);}function _0x523a3f(){const _0x38e9c4=_0x247bea,_0x4caed0=document['getElementById'](_0x38e9c4(0x10f7));_0x4caed0[_0x38e9c4(0x102a)]='';const _0x1536a6=[..._0x58b047[_0x38e9c4(0x392)]][_0x38e9c4(0xbb3)]((_0x192eb7,_0xd60ba7)=>_0x192eb7['isAlive']-_0xd60ba7[_0x38e9c4(0x12a)]);_0x1536a6['forEach']((_0x494c05,_0x54cc5f)=>{const _0xcba28c=_0x38e9c4,_0x285279=_0x58b047[_0xcba28c(0x392)][_0xcba28c(0xce9)](_0x3168eb=>_0x3168eb['id']===_0x494c05['id'])+0x1,_0x1dff5b=document[_0xcba28c(0x1292)](_0xcba28c(0x58c));_0x1dff5b['className']=_0xcba28c(0x128f);if(!_0x494c05[_0xcba28c(0x12a)])_0x1dff5b[_0xcba28c(0x10d3)]['add'](_0xcba28c(0xb05));_0x1dff5b['innerHTML']=_0xcba28c(0xce7)+_0x494c05[_0xcba28c(0xbac)]+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22player-name\x22>'+_0x285279+'.\x20'+_0x494c05[_0xcba28c(0x578)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x4caed0[_0xcba28c(0xf77)](_0x1dff5b);});const _0x3e9572=document[_0x38e9c4(0xc33)](_0x38e9c4(0xe87));_0x3e9572[_0x38e9c4(0x102a)]='';for(let _0x3e9137=0x1;_0x3e9137<=_0x58b047[_0x38e9c4(0x3cb)];_0x3e9137++){const _0x2380ac=[..._0x58b047[_0x38e9c4(0xf85)][_0x38e9c4(0x1054)](_0x3dfe56=>_0x3dfe56[_0x38e9c4(0xa4)]===_0x3e9137),..._0x58b047[_0x38e9c4(0x3c9)][_0x38e9c4(0x1054)](_0x165b65=>_0x165b65['day']===_0x3e9137)]['sort']((_0x23de0f,_0x52eaab)=>(_0x23de0f['timestamp']||0x0)-(_0x52eaab[_0x38e9c4(0x2f0)]||0x0));if(_0x2380ac['length']>0x0){const _0x21b7fe=document[_0x38e9c4(0x1292)](_0x38e9c4(0x58c));_0x21b7fe[_0x38e9c4(0x84)]=_0x38e9c4(0xe52),_0x21b7fe[_0x38e9c4(0x11b0)]=_0x38e9c4(0xd97)+_0x3e9137+_0x38e9c4(0x109c),_0x21b7fe['style'][_0x38e9c4(0x4c1)]=_0x38e9c4(0x1220),_0x3e9572['appendChild'](_0x21b7fe),_0x2380ac[_0x38e9c4(0xd6a)](_0x1e6d97=>{const _0x1e0738=_0x38e9c4,_0x4c9846=document[_0x1e0738(0x1292)](_0x1e0738(0x58c));_0x4c9846['className']='werewolf-log-entry\x20'+_0x1e6d97[_0x1e0738(0x52a)],_0x1e6d97[_0x1e0738(0x52a)]===_0x1e0738(0x156)?_0x4c9846[_0x1e0738(0x102a)]=_0x1e0738(0x11c3)+_0x1e6d97[_0x1e0738(0x84a)]+_0x1e0738(0xbea)+_0x1e6d97[_0x1e0738(0xcbd)]:_0x4c9846[_0x1e0738(0x11b0)]=_0x1e6d97[_0x1e0738(0xcbd)],_0x3e9572[_0x1e0738(0xf77)](_0x4c9846);});}}_0x3e9572[_0x38e9c4(0x1244)]=_0x3e9572[_0x38e9c4(0xa87)];const _0x5306fd={'start':_0x38e9c4(0xe2f),'night':'第'+_0x58b047['currentDay']+_0x38e9c4(0x6f5),'day':'第'+_0x58b047[_0x38e9c4(0x3cb)]+_0x38e9c4(0x69f),'discussion':'第'+_0x58b047[_0x38e9c4(0x3cb)]+_0x38e9c4(0xc9c),'voting':'第'+_0x58b047[_0x38e9c4(0x3cb)]+_0x38e9c4(0xec5),'gameover':_0x38e9c4(0x7aa)};document[_0x38e9c4(0xc33)](_0x38e9c4(0x129a))[_0x38e9c4(0x11b0)]=_0x38e9c4(0x5ad)+(_0x5306fd[_0x58b047['currentPhase']]||_0x58b047['currentPhase']);}function _0x162261(_0x2b2471){const _0x5c7ae1=_0x247bea,_0x5ea22f={'狼人':'你的目标是杀死所有好人。每晚可以和同伴一起刀一个玩家。','平民':'你没有任何特殊能力，你的目标是通过投票放逐所有狼人。','预言家':'每晚可以查验一个玩家的身份是好人还是狼人。','猎人':_0x5c7ae1(0x1162),'女巫':'你有一瓶解药和一瓶毒药，解药可以救活当晚被杀的玩家，毒药可以毒死任意一名玩家。','守卫':_0x5c7ae1(0xb60)};document[_0x5c7ae1(0xc33)]('werewolf-role-name')[_0x5c7ae1(0x11b0)]=_0x2b2471,document[_0x5c7ae1(0xc33)](_0x5c7ae1(0x1cf))[_0x5c7ae1(0x11b0)]=_0x5ea22f[_0x2b2471]||_0x5c7ae1(0x1040),document[_0x5c7ae1(0xc33)](_0x5c7ae1(0x57a))[_0x5c7ae1(0x10d3)][_0x5c7ae1(0xb9)]('visible');}async function _0x529f2f(){const _0x24d23b=_0x247bea;_0x58b047[_0x24d23b(0xfc2)]='第'+_0x58b047[_0x24d23b(0x3cb)]+_0x24d23b(0x6f5),_0x58b047[_0x24d23b(0xde4)]={},_0x3fc843(_0x24d23b(0x1080)),_0x523a3f(),document[_0x24d23b(0xc33)](_0x24d23b(0x662))[_0x24d23b(0x105d)][_0x24d23b(0xf44)]='none',document[_0x24d23b(0xc33)]('werewolf-retry-btn')[_0x24d23b(0x105d)][_0x24d23b(0xf44)]=_0x24d23b(0x854),await new Promise(_0x582a63=>setTimeout(_0x582a63,0x5dc));const _0x12f4d3=_0x58b047[_0x24d23b(0x392)][_0x24d23b(0xd85)](_0x470b70=>_0x470b70[_0x24d23b(0x16d)]==='守卫'&&_0x470b70[_0x24d23b(0x12a)]);if(_0x12f4d3){_0x3fc843(_0x24d23b(0x34f)),_0x523a3f();let _0x57f5af=null;if(_0x12f4d3['id']==='user')_0x57f5af=await _0xbf5c(_0x24d23b(0x3a8),_0x12f4d3[_0x24d23b(0x12a9)]);else{const _0x2c19f2=_0x58b047['players']['filter'](_0x4ddd39=>_0x4ddd39[_0x24d23b(0x12a)]&&_0x4ddd39['id']!==_0x12f4d3[_0x24d23b(0x12a9)]);_0x2c19f2[_0x24d23b(0x79b)]>0x0&&(_0x57f5af=_0x2c19f2[Math[_0x24d23b(0xcb5)](Math[_0x24d23b(0xa11)]()*_0x2c19f2[_0x24d23b(0x79b)])]['id']);}_0x57f5af&&(_0x58b047[_0x24d23b(0xde4)][_0x24d23b(0x2eb)]=_0x57f5af,_0x12f4d3[_0x24d23b(0x12a9)]=_0x57f5af),_0x3fc843(_0x24d23b(0x543)),_0x523a3f(),await new Promise(_0x587383=>setTimeout(_0x587383,0x5dc));}_0x3fc843(_0x24d23b(0x71)),_0x523a3f();const _0x694fea=_0x58b047[_0x24d23b(0x392)][_0x24d23b(0x1054)](_0x4549c2=>_0x4549c2[_0x24d23b(0x16d)]==='狼人'&&_0x4549c2[_0x24d23b(0x12a)]),_0x42ccba=_0x694fea[_0x24d23b(0xfa7)](_0x23b963=>_0x23b963['id']==='user');let _0x1d7299=null;_0x58b047[_0x24d23b(0x807)]=_0x24d23b(0x45f);try{if(_0x42ccba)_0x3fc843('你是狼人，请选择刀人目标。'),_0x523a3f(),_0x1d7299=await _0x1fad52();else{if(_0x58b047[_0x24d23b(0x3cb)]===0x1){console[_0x24d23b(0x51f)](_0x24d23b(0x750));const _0x9f5e1f=_0x58b047['players'][_0x24d23b(0x1054)](_0x52e77b=>_0x52e77b[_0x24d23b(0x12a)]&&_0x52e77b[_0x24d23b(0x16d)]!=='狼人');_0x9f5e1f[_0x24d23b(0x79b)]>0x0&&(_0x1d7299=_0x9f5e1f[Math[_0x24d23b(0xcb5)](Math[_0x24d23b(0xa11)]()*_0x9f5e1f[_0x24d23b(0x79b)])]['id']);}else _0x1d7299=await _0x58b974();}_0x58b047[_0x24d23b(0x807)]=null;}catch(_0x35c47a){console['error']('狼人行动API失败:',_0x35c47a),await _0x2d7ddd(_0x24d23b(0xb9d),_0x24d23b(0x47f)),document[_0x24d23b(0xc33)](_0x24d23b(0xd55))['style'][_0x24d23b(0xf44)]=_0x24d23b(0xa20);return;}_0x58b047[_0x24d23b(0xde4)]['killedId']=_0x1d7299,_0x3fc843(_0x24d23b(0xd19)),_0x523a3f(),await new Promise(_0x3e05e9=>setTimeout(_0x3e05e9,0x5dc));const _0x17740c=_0x58b047['players'][_0x24d23b(0xd85)](_0x2a8ece=>_0x2a8ece['role']==='女巫'&&_0x2a8ece['isAlive']);if(_0x17740c){_0x3fc843(_0x24d23b(0x4f7)),_0x523a3f();const _0x433aed=_0x58b047['players'][_0x24d23b(0xd85)](_0x67da0=>_0x67da0['id']===_0x58b047[_0x24d23b(0xde4)][_0x24d23b(0x131)]),_0x46e55a=_0x58b047[_0x24d23b(0xde4)][_0x24d23b(0x2eb)]===_0x58b047[_0x24d23b(0xde4)]['killedId'],_0x51829c=_0x46e55a||!_0x433aed?null:_0x433aed;if(_0x17740c['id']===_0x24d23b(0x717)){let _0x5c56df=await _0x28edde(_0x51829c,_0x17740c);_0x5c56df[_0x24d23b(0x9aa)]&&(_0x58b047[_0x24d23b(0xde4)]['savedId']=_0x58b047['nightActions'][_0x24d23b(0x131)],_0x17740c[_0x24d23b(0x4d8)]=!![]),_0x5c56df[_0x24d23b(0x8ad)]&&(_0x58b047[_0x24d23b(0xde4)][_0x24d23b(0x787)]=_0x5c56df[_0x24d23b(0x8ad)],_0x17740c[_0x24d23b(0x174)]=!![]);}else{if(!_0x17740c['antidoteUsed']&&_0x51829c){let _0x25eba6=0x0;_0x58b047[_0x24d23b(0x3cb)]===0x1?_0x25eba6=0.3:_0x25eba6=0.8,console[_0x24d23b(0x51f)](_0x24d23b(0x107)+_0x58b047[_0x24d23b(0x3cb)]+_0x24d23b(0xa50)+_0x25eba6*0x64+'%'),Math[_0x24d23b(0xa11)]()<_0x25eba6?(console['log']('AI女巫决定使用解药！'),_0x58b047[_0x24d23b(0xde4)]['savedId']=_0x58b047[_0x24d23b(0xde4)][_0x24d23b(0x131)],_0x17740c[_0x24d23b(0x4d8)]=!![]):console[_0x24d23b(0x51f)](_0x24d23b(0xaed));}if(!_0x58b047[_0x24d23b(0xde4)][_0x24d23b(0xfda)]&&!_0x17740c[_0x24d23b(0x174)]&&Math[_0x24d23b(0xa11)]()<0.5){const _0x92f0e6=_0x58b047[_0x24d23b(0x392)]['filter'](_0x5ab1f2=>_0x5ab1f2[_0x24d23b(0x12a)]&&_0x5ab1f2['id']!==_0x58b047[_0x24d23b(0xde4)][_0x24d23b(0x131)]);if(_0x92f0e6['length']>0x0){const _0x1882e7=_0x92f0e6[Math[_0x24d23b(0xcb5)](Math[_0x24d23b(0xa11)]()*_0x92f0e6[_0x24d23b(0x79b)])];_0x58b047[_0x24d23b(0xde4)]['poisonedId']=_0x1882e7['id'],_0x17740c[_0x24d23b(0x174)]=!![],console[_0x24d23b(0x51f)](_0x24d23b(0xf7a)+_0x1882e7[_0x24d23b(0x578)]);}}}_0x3fc843(_0x24d23b(0xf06)),_0x523a3f(),await new Promise(_0x5c6bff=>setTimeout(_0x5c6bff,0x5dc));}const _0x4516cb=_0x58b047[_0x24d23b(0x392)][_0x24d23b(0xd85)](_0xb05d0f=>_0xb05d0f['role']===_0x24d23b(0x10ca)&&_0xb05d0f['isAlive']);if(_0x4516cb){_0x3fc843(_0x24d23b(0x365)),_0x523a3f();if(_0x4516cb['id']===_0x24d23b(0x717)){const _0x95f5d7=await _0xbf5c(_0x24d23b(0xc2a)),_0x3b8360=_0x58b047[_0x24d23b(0x392)]['find'](_0x36411d=>_0x36411d['id']===_0x95f5d7);if(_0x3b8360){const _0x538991=_0x3b8360[_0x24d23b(0x16d)]==='狼人';await _0x2d7ddd(_0x24d23b(0x881),_0x24d23b(0xa62)+_0x3b8360[_0x24d23b(0x578)]+_0x24d23b(0x1169)+(_0x538991?'狼人':'好人')),_0x58b047[_0x24d23b(0xde4)][_0x24d23b(0x692)]={'target':_0x95f5d7,'result':_0x538991?'狼人':'好人'};}}else{const _0x33202b=_0x58b047[_0x24d23b(0x392)][_0x24d23b(0x1054)](_0xa5f1d8=>_0xa5f1d8[_0x24d23b(0x12a)]&&_0xa5f1d8['id']!==_0x4516cb['id']);if(_0x33202b[_0x24d23b(0x79b)]>0x0){const _0x36da23=_0x33202b[Math['floor'](Math[_0x24d23b(0xa11)]()*_0x33202b[_0x24d23b(0x79b)])];_0x58b047[_0x24d23b(0xde4)]['prophetCheck']={'target':_0x36da23['id'],'result':_0x36da23[_0x24d23b(0x16d)]==='狼人'?'狼人':'好人'};}}_0x3fc843(_0x24d23b(0xff8)),_0x523a3f(),await new Promise(_0x1b126f=>setTimeout(_0x1b126f,0x5dc));}_0x35f2ef();}async function _0x35f2ef(){const _0x5bcd61=_0x247bea;_0x58b047['currentPhase']='第'+_0x58b047[_0x5bcd61(0x3cb)]+_0x5bcd61(0x69f),_0x58b047['voteResults']={},_0x3fc843(_0x5bcd61(0x7c));const {killedId:_0x58c501,guardedId:_0x4f1c13,savedId:_0xf48360,poisonedId:_0x477315}=_0x58b047[_0x5bcd61(0xde4)],_0x397ae3=new Set();_0x58c501&&_0x58c501!==_0x4f1c13&&_0x58c501!==_0xf48360&&_0x397ae3[_0x5bcd61(0xb9)](_0x58c501);_0x477315&&_0x397ae3['add'](_0x477315);if(_0x397ae3['size']===0x0)_0x3fc843('昨晚是平安夜。');else for(const _0x467069 of _0x397ae3){const _0x171c5b=_0x58b047[_0x5bcd61(0x392)][_0x5bcd61(0xd85)](_0x392cce=>_0x392cce['id']===_0x467069);if(_0x171c5b&&_0x171c5b[_0x5bcd61(0x12a)]){_0x171c5b[_0x5bcd61(0x12a)]=![],_0x3fc843(_0x5bcd61(0x5fa)+_0x171c5b[_0x5bcd61(0x578)]+_0x5bcd61(0xfa9));if(_0x171c5b[_0x5bcd61(0x16d)]==='猎人'){_0x3fc843(_0x5bcd61(0x2c8)),_0x523a3f();let _0x3c7b6a=null;if(_0x171c5b['id']===_0x5bcd61(0x717))_0x3c7b6a=await _0xbf5c(_0x5bcd61(0x13f));else{const _0x3efafc=_0x58b047[_0x5bcd61(0x392)][_0x5bcd61(0x1054)](_0x14ef12=>_0x14ef12[_0x5bcd61(0x12a)]&&_0x14ef12['id']!==_0x171c5b['id']);_0x3efafc[_0x5bcd61(0x79b)]>0x0&&(_0x3c7b6a=_0x3efafc[Math[_0x5bcd61(0xcb5)](Math[_0x5bcd61(0xa11)]()*_0x3efafc[_0x5bcd61(0x79b)])]['id']);}const _0x2d7143=_0x58b047[_0x5bcd61(0x392)][_0x5bcd61(0xd85)](_0x271355=>_0x271355['id']===_0x3c7b6a);_0x2d7143&&(_0x2d7143['isAlive']=![],_0x3fc843('猎人带走了\x20'+_0x2d7143['name']+'。'));}}}_0x523a3f();if(_0x9356e5())return;await _0x575c47();}async function _0x575c47(){const _0x3f896b=_0x247bea;_0x3fc843(_0x3f896b(0x72d)),_0x523a3f();const {proxyUrl:_0xc57390,apiKey:_0x34a1b3,model:_0x52d4f4}=_0x12493e[_0x3f896b(0xdd4)];if(!_0xc57390||!_0x34a1b3||!_0x52d4f4){alert(_0x3f896b(0x6b2));return;}const _0x94f93e=_0x31ec52();_0x58b047[_0x3f896b(0x807)]=_0x3f896b(0x119a);try{await _0x2d7ddd(_0x3f896b(0x114a),_0x3f896b(0xad9));let _0x2bf014=_0xc57390[_0x3f896b(0x1d4)](_0x3f896b(0x113e)),_0x60dbad=[{'role':_0x3f896b(0x717),'content':_0x3f896b(0xac2)}],_0x4e2467=_0x202ea1(_0x52d4f4,_0x34a1b3,_0x94f93e,_0x60dbad);const _0x1c7d75=_0x2bf014?await fetch(_0x4e2467['url'],_0x4e2467[_0x3f896b(0xa78)]):await fetch(_0xc57390+_0x3f896b(0x399),{'method':_0x3f896b(0x90),'headers':{'Content-Type':_0x3f896b(0xd74),'Authorization':_0x3f896b(0xf20)+_0x34a1b3},'body':JSON['stringify']({'model':_0x52d4f4,'messages':[{'role':_0x3f896b(0x152),'content':_0x94f93e},..._0x60dbad],'temperature':_0x12493e[_0x3f896b(0x10f6)]['apiTemperature']||0.95})});if(!_0x1c7d75['ok']){const _0x8dc817=await _0x1c7d75[_0x3f896b(0x79e)]();throw new Error(_0x3f896b(0xf43)+_0x8dc817[_0x3f896b(0x4d9)]['message']);}const _0x5b1501=await _0x1c7d75[_0x3f896b(0x79e)](),_0x10acca=getGeminiResponseText(_0x5b1501),_0x5b9e6e=_0x10acca[_0x3f896b(0x1242)](/(\[[\s\S]*\])/);if(!_0x5b9e6e)throw new Error(_0x3f896b(0x8eb)+_0x10acca);const _0x5c193a=JSON['parse'](_0x5b9e6e[0x0]);for(const _0x254c7e of _0x5c193a){_0x254c7e['speaker_name']&&_0x254c7e['dialogue']&&(_0xaacbe9(_0x254c7e['speaker_name'],_0x254c7e[_0x3f896b(0x156)]),_0x523a3f(),await new Promise(_0x4b43e4=>setTimeout(_0x4b43e4,0x5dc+Math[_0x3f896b(0xa11)]()*0x7d0)));}_0x58b047[_0x3f896b(0x807)]=null;}catch(_0x572fa7){console[_0x3f896b(0x4d9)](_0x3f896b(0xc14),_0x572fa7),await _0x2d7ddd(_0x3f896b(0xcea),_0x3f896b(0xc34)+_0x572fa7[_0x3f896b(0xf93)]),document[_0x3f896b(0xc33)]('werewolf-retry-btn')['style'][_0x3f896b(0xf44)]=_0x3f896b(0xa20);return;}const _0x3bdea7=_0x58b047[_0x3f896b(0x392)]['find'](_0x711c96=>_0x711c96['id']===_0x3f896b(0x717)),_0x2e47ea=document[_0x3f896b(0xc33)](_0x3f896b(0x662)),_0x58fba1=document[_0x3f896b(0xc33)]('werewolf-wait-reply-btn'),_0x3c45d8=document[_0x3f896b(0xc33)]('werewolf-finish-speech-btn'),_0x461b09=document[_0x3f896b(0xc33)](_0x3f896b(0x28b));_0x2e47ea['style'][_0x3f896b(0xf44)]=_0x3f896b(0x21a);if(_0x3bdea7&&_0x3bdea7['isAlive']){_0x58fba1['textContent']=_0x3f896b(0xeb),_0x3c45d8[_0x3f896b(0x11b0)]=_0x3f896b(0xc42),_0x58fba1[_0x3f896b(0x105d)][_0x3f896b(0xf44)]='block',_0x3c45d8['style'][_0x3f896b(0xf44)]=_0x3f896b(0xa20),_0x461b09[_0x3f896b(0xfd8)]=![],_0x461b09[_0x3f896b(0x1126)]=_0x3f896b(0xc6c),_0x461b09['focus']();const _0x557bf1=_0x58fba1[_0x3f896b(0xbc5)](!![]);_0x58fba1[_0x3f896b(0x1053)][_0x3f896b(0xcaa)](_0x557bf1,_0x58fba1),_0x557bf1[_0x3f896b(0x205)](_0x3f896b(0x335),_0x205441);const _0x31edf6=_0x3c45d8[_0x3f896b(0xbc5)](!![]);_0x3c45d8[_0x3f896b(0x1053)][_0x3f896b(0xcaa)](_0x31edf6,_0x3c45d8),_0x31edf6['addEventListener'](_0x3f896b(0x335),_0x56bf8);}else{_0x3fc843(_0x3f896b(0x129b)),_0x523a3f(),_0x58fba1['textContent']=_0x3f896b(0x3d0),_0x3c45d8['textContent']=_0x3f896b(0xf3f),_0x58fba1[_0x3f896b(0x105d)][_0x3f896b(0xf44)]=_0x3f896b(0xa20),_0x3c45d8[_0x3f896b(0x105d)][_0x3f896b(0xf44)]=_0x3f896b(0xa20),_0x461b09[_0x3f896b(0xfd8)]=!![],_0x461b09[_0x3f896b(0x1126)]=_0x3f896b(0x12b3);const _0x39beb7=_0x58fba1[_0x3f896b(0xbc5)](!![]);_0x58fba1[_0x3f896b(0x1053)][_0x3f896b(0xcaa)](_0x39beb7,_0x58fba1),_0x39beb7[_0x3f896b(0x205)](_0x3f896b(0x335),_0x11e591);const _0xf2d9fc=_0x3c45d8[_0x3f896b(0xbc5)](!![]);_0x3c45d8[_0x3f896b(0x1053)][_0x3f896b(0xcaa)](_0xf2d9fc,_0x3c45d8),_0xf2d9fc[_0x3f896b(0x205)](_0x3f896b(0x335),_0x133ca2);}}function _0x31ec52(){const _0x315c7b=_0x247bea,_0x48b714=_0x58b047[_0x315c7b(0x392)][_0x315c7b(0x1054)](_0x45ce2f=>_0x45ce2f[_0x315c7b(0x12a)]),_0x1b14c4=_0x58b047[_0x315c7b(0x392)]['find'](_0x45ac0c=>_0x45ac0c['id']===_0x315c7b(0x717)),_0x528169=_0x1b14c4?_0x1b14c4[_0x315c7b(0x578)]:'用户',_0x511ca4=_0x48b714[_0x315c7b(0xfa7)](_0x3f4c6f=>_0x3f4c6f['id']===_0x315c7b(0x717));let _0x470718='#\x20角色与玩家档案\x20(Character\x20&\x20Player\x20Dossiers)\x0a';_0x48b714[_0x315c7b(0xd6a)]((_0x3dc2ab,_0x147133)=>{const _0x864c7b=_0x315c7b,_0x6b3eea=_0x58b047[_0x864c7b(0x392)]['findIndex'](_0x7ffd48=>_0x7ffd48['id']===_0x3dc2ab['id'])+0x1;_0x470718+='\x0a##\x20'+_0x6b3eea+_0x864c7b(0x2fb)+_0x3dc2ab[_0x864c7b(0x578)]+_0x864c7b(0x126a)+_0x3dc2ab[_0x864c7b(0x776)]+_0x864c7b(0xf12)+(_0x3dc2ab['id']==='user'?_0x864c7b(0x10db):_0x864c7b(0xf31))+_0x864c7b(0x688)+_0x3dc2ab['character_persona']+'\x0a';if(_0x3dc2ab[_0x864c7b(0x52a)]===_0x864c7b(0x46a)){const _0x4bfbd4=_0x12493e[_0x864c7b(0xc45)][_0x3dc2ab['id']];if(_0x4bfbd4&&_0x4bfbd4['longTermMemory']&&_0x4bfbd4['longTermMemory']['length']>0x0){const _0x459619=_0x4bfbd4[_0x864c7b(0x45b)][_0x864c7b(0x9d5)](_0x4e0cb5=>_0x4e0cb5['content'])[_0x864c7b(0x100b)](';\x20');_0x470718+='-\x20**长期记忆\x20(必须参考)**:\x20'+_0x459619+'\x0a';}}});let _0x18a5d6='#\x20昨晚事件总结\x20(Night\x20Event\x20Summary)\x0a';const _0x4fa359=_0x58b047[_0x315c7b(0xf85)]['filter'](_0x23b55c=>_0x23b55c[_0x315c7b(0xcbd)][_0x315c7b(0x1d4)](_0x315c7b(0x116))&&_0x23b55c['day']===_0x58b047[_0x315c7b(0x3cb)]);_0x4fa359[_0x315c7b(0x79b)]===0x0?_0x18a5d6+=_0x315c7b(0x5ca):_0x4fa359[_0x315c7b(0xd6a)](_0x2b31d2=>{_0x18a5d6+='-\x20'+_0x2b31d2['content']+'\x0a';});let _0x5668da=_0x315c7b(0xbb);if(_0x58b047['currentDay']>0x1)for(let _0x56dee1=0x1;_0x56dee1<_0x58b047['currentDay'];_0x56dee1++){_0x5668da+='\x0a**---\x20第\x20'+_0x56dee1+_0x315c7b(0x1214);const _0x36290d=_0x58b047['gameLog']['filter'](_0x22334e=>_0x22334e[_0x315c7b(0xa4)]===_0x56dee1&&(_0x22334e[_0x315c7b(0xcbd)]['includes']('死亡')||_0x22334e['content'][_0x315c7b(0x1d4)]('放逐')));_0x36290d[_0x315c7b(0x79b)]>0x0?_0x5668da+=_0x315c7b(0xce2)+_0x36290d[_0x315c7b(0x9d5)](_0x19a116=>_0x19a116[_0x315c7b(0xcbd)])[_0x315c7b(0x100b)]('\x20')+'\x0a':_0x5668da+=_0x315c7b(0xfb9);const _0x172860=_0x58b047[_0x315c7b(0x3c9)]['filter'](_0x54c33a=>_0x54c33a['day']===_0x56dee1);_0x172860[_0x315c7b(0x79b)]>0x0&&(_0x5668da+='*讨论记录*:\x0a'+_0x172860[_0x315c7b(0x9d5)](_0x412e2c=>'-\x20'+_0x412e2c['speaker']+':\x20'+_0x412e2c[_0x315c7b(0xcbd)])['join']('\x0a')+'\x0a');}else _0x5668da+=_0x315c7b(0x1174);let _0x5c8f9c=_0x315c7b(0x940);_0x48b714[_0x315c7b(0xd6a)](_0x254018=>{const _0x19abbc=_0x315c7b;if(_0x254018['id']!==_0x19abbc(0x717)){_0x5c8f9c+=_0x19abbc(0x5be)+_0x254018[_0x19abbc(0x578)]+_0x19abbc(0x220)+_0x254018[_0x19abbc(0x16d)]+'】\x0a';if(_0x254018[_0x19abbc(0x16d)]==='狼人'){const _0x37f74c=_0x58b047['players'][_0x19abbc(0x1054)](_0x4dd7e5=>_0x4dd7e5[_0x19abbc(0x16d)]==='狼人'&&_0x4dd7e5['id']!==_0x254018['id'])['map'](_0x144543=>_0x144543[_0x19abbc(0x578)])[_0x19abbc(0x100b)]('、');_0x5c8f9c+=_0x19abbc(0x1263)+(_0x37f74c||'无')+'\x0a';const _0x527225=_0x58b047['players'][_0x19abbc(0xd85)](_0xcf0425=>_0xcf0425['id']===_0x58b047[_0x19abbc(0xde4)][_0x19abbc(0x131)]);_0x5c8f9c+=_0x19abbc(0x603)+(_0x527225?_0x527225[_0x19abbc(0x578)]:'空刀')+'\x0a';}if(_0x254018[_0x19abbc(0x16d)]===_0x19abbc(0x10ca)&&_0x58b047[_0x19abbc(0xde4)]['prophetCheck']){const _0x4de81f=_0x58b047['players'][_0x19abbc(0xd85)](_0x19d6d6=>_0x19d6d6['id']===_0x58b047[_0x19abbc(0xde4)][_0x19abbc(0x692)][_0x19abbc(0xe16)]);_0x5c8f9c+='-\x20你昨晚查验了\x20'+_0x4de81f[_0x19abbc(0x578)]+_0x19abbc(0x3f4)+_0x58b047[_0x19abbc(0xde4)][_0x19abbc(0x692)][_0x19abbc(0x129)]+'】\x0a';}if(_0x254018['role']==='女巫'){if(_0x58b047['nightActions'][_0x19abbc(0xfda)]){const _0x4c79ad=_0x58b047[_0x19abbc(0x392)][_0x19abbc(0xd85)](_0x2af373=>_0x2af373['id']===_0x58b047[_0x19abbc(0xde4)]['savedId']);_0x5c8f9c+=_0x19abbc(0x7d5)+_0x4c79ad[_0x19abbc(0x578)]+'。\x0a';}if(_0x58b047[_0x19abbc(0xde4)]['poisonedId']){const _0x2c770c=_0x58b047['players'][_0x19abbc(0xd85)](_0x3742e8=>_0x3742e8['id']===_0x58b047[_0x19abbc(0xde4)][_0x19abbc(0x787)]);_0x5c8f9c+=_0x19abbc(0x16e)+_0x2c770c['name']+'。\x0a';}_0x5c8f9c+=_0x19abbc(0x1b6)+(_0x254018['antidoteUsed']?'已使用':'未使用')+'\x0a',_0x5c8f9c+=_0x19abbc(0x517)+(_0x254018[_0x19abbc(0x174)]?_0x19abbc(0xf63):_0x19abbc(0x480))+'\x0a';}if(_0x254018[_0x19abbc(0x16d)]==='守卫'){if(_0x58b047['nightActions'][_0x19abbc(0x2eb)]){const _0x488d0f=_0x58b047[_0x19abbc(0x392)]['find'](_0x4ef081=>_0x4ef081['id']===_0x58b047[_0x19abbc(0xde4)][_0x19abbc(0x2eb)]);_0x5c8f9c+=_0x19abbc(0xcf)+_0x488d0f[_0x19abbc(0x578)]+'。\x0a';}else _0x5c8f9c+=_0x19abbc(0xdb4);}_0x5c8f9c+='\x0a';}});let _0x3dd1f7=_0x315c7b(0x54d);const _0x4e9a97=_0x58b047[_0x315c7b(0x3c9)][_0x315c7b(0x1054)](_0x5bac1d=>_0x5bac1d['day']===_0x58b047[_0x315c7b(0x3cb)]);_0x4e9a97[_0x315c7b(0x79b)]>0x0?_0x3dd1f7+=_0x4e9a97['map'](_0x1a32b0=>_0x315c7b(0x100f)+_0x1a32b0[_0x315c7b(0x84a)]+_0x315c7b(0xe55)+_0x1a32b0['content'])[_0x315c7b(0x100b)]('\x0a'):_0x3dd1f7+=_0x315c7b(0x47b);const _0x2566c6='\x0a#\x20你的任务\x0a你是一个狼人杀游戏导演。你的任务是扮演【除了'+(_0x511ca4?_0x315c7b(0xcce)+_0x528169+')':_0x315c7b(0x4de)+_0x528169+')')+'以外】的所有AI角色，并根据他们的【角色人设】和【狼人杀身份】，生成一整轮符合逻辑、充满博弈的发言。\x0a\x0a#\x20身份与人设铁律\x20(最高优先级)\x0a你【必须】为每一个角色都仔细阅读并严格遵守下面的档案。这是你所有行为和发言的唯一依据。在对话中，请务必注意角色人设中暗示的性别，并使用正确的称呼（例如“他”或“她”）。\x0a\x0a'+_0x470718+_0x315c7b(0x94e)+(_0x58b047[_0x315c7b(0x7c3)]===_0x315c7b(0x2a4)?'屠边局：狼人杀死所有神职或所有平民即获胜。':_0x315c7b(0x4b7))+_0x315c7b(0xd90)+_0x58b047[_0x315c7b(0x3cb)]+_0x315c7b(0x50e)+_0x18a5d6+_0x315c7b(0x8be)+_0x48b714[_0x315c7b(0x9d5)](_0x35dd85=>_0x35dd85['name']+'\x20('+(_0x35dd85['id']==='user'?'用户':'AI')+')')[_0x315c7b(0x100b)](',\x20')+_0x315c7b(0xc99)+_0x528169+'\x20(用户)\x20或其他AI的发言，必须对他们的观点和逻辑做出回应。\x0a2.\x20\x20**记忆力与连贯性**:\x20你的新发言【必须】是基于**过去几天和今天发生的所有事件和讨论**的逻辑延续。\x0a\x0a//\x20【核心修改2】明确了JSON格式中\x20speaker_name\x20和对话中称呼的不同要求\x0a3.\x20\x20**格式铁律**:\x20你的回复【必须且只能】是一个JSON数组，格式为:\x20`{\x22speaker_name\x22:\x20\x22角色的【昵称】\x22,\x20\x22dialogue\x22:\x20\x22发言内容\x22}`。**必须**为每一个存活的AI角色都生成一段发言。\x0a4.\x20\x20**称呼铁律**:\x20你的发言中【绝对禁止】提及任何玩家的编号。在对话中互相称呼时，你【必须】使用玩家的【本名】，而不是他们的昵称。\x0a\x0a#\x20'+_0x5668da+_0x315c7b(0x546)+_0x3dd1f7+'\x0a\x0a'+_0x5c8f9c+'\x0a\x0a现在，请为所有【存活的AI角色】生成他们充满策略和博弈的发言。';return _0x2566c6;}function _0x212118(_0x23f1fe){const _0x5b0456=_0x247bea;let _0x3530e8=_0x5b0456(0x1206);const _0x50a5a6=_0x23f1fe['gameLog']['find'](_0x507515=>_0x507515[_0x5b0456(0xcbd)][_0x5b0456(0x1d4)]('胜利'))?.[_0x5b0456(0xcbd)]||_0x5b0456(0x2ba);_0x3530e8+='###\x20最终结果:\x20'+_0x50a5a6+'\x0a\x0a',_0x3530e8+='###\x20玩家身份配置:\x0a',_0x23f1fe[_0x5b0456(0x392)][_0x5b0456(0xd6a)](_0x25c08c=>{const _0x4fe2a6=_0x5b0456,_0x519435=_0x25c08c[_0x4fe2a6(0x12a)]?'存活':_0x4fe2a6(0xb4b);_0x3530e8+='-\x20'+_0x25c08c[_0x4fe2a6(0x578)]+':\x20'+_0x25c08c[_0x4fe2a6(0x16d)]+'\x20('+_0x519435+')\x0a';}),_0x3530e8+=_0x5b0456(0xd40);for(let _0x5f029d=0x1;_0x5f029d<=_0x23f1fe[_0x5b0456(0x3cb)];_0x5f029d++){_0x3530e8+=_0x5b0456(0x42a)+_0x5f029d+_0x5b0456(0x1214);const _0x1d7510=_0x23f1fe[_0x5b0456(0xf85)][_0x5b0456(0x1054)](_0x521f6d=>_0x521f6d['day']===_0x5f029d&&_0x521f6d['content'][_0x5b0456(0x1d4)]('死亡'));if(_0x1d7510[_0x5b0456(0x79b)]>0x0)_0x3530e8+=_0x5b0456(0x704)+_0x1d7510[_0x5b0456(0x9d5)](_0x4a9780=>_0x4a9780[_0x5b0456(0xcbd)])[_0x5b0456(0x100b)]('\x20')+'\x0a';else(_0x5f029d>0x1||_0x5f029d===0x1&&_0x23f1fe[_0x5b0456(0x3cb)]>0x1)&&(_0x3530e8+=_0x5b0456(0x990));const _0x69b2c4=_0x23f1fe[_0x5b0456(0x3c9)][_0x5b0456(0x1054)](_0x473a2f=>_0x473a2f['day']===_0x5f029d);_0x69b2c4[_0x5b0456(0x79b)]>0x0&&(_0x3530e8+=_0x5b0456(0x8b8)+_0x69b2c4[_0x5b0456(0x9d5)](_0x28e6fb=>'-\x20'+_0x28e6fb[_0x5b0456(0x84a)]+':\x20'+_0x28e6fb[_0x5b0456(0xcbd)])[_0x5b0456(0x100b)]('\x0a')+'\x0a');const _0x4ccce5=_0x23f1fe['gameLog'][_0x5b0456(0xd85)](_0x4e2d1f=>_0x4e2d1f[_0x5b0456(0xa4)]===_0x5f029d&&_0x4e2d1f[_0x5b0456(0xcbd)][_0x5b0456(0x1d4)](_0x5b0456(0xab3)));_0x4ccce5&&(_0x3530e8+=_0x5b0456(0xe19)+_0x4ccce5[_0x5b0456(0xcbd)]+'\x0a');}return _0x3530e8+=_0x5b0456(0xcba),_0x3530e8;}async function _0x5a560e(_0x542854){const _0x750112=_0x247bea;let _0x464425=0x0;for(const _0x26c226 of _0x58b047[_0x750112(0x392)]){if(_0x26c226[_0x750112(0x52a)]===_0x750112(0x46a)){const _0x138f9d=_0x12493e['chats'][_0x26c226['id']];if(_0x138f9d){const _0x46eeaf={'content':_0x542854,'timestamp':Date['now'](),'source':_0x750112(0x4fa)};!_0x138f9d[_0x750112(0x45b)]&&(_0x138f9d['longTermMemory']=[]),_0x138f9d[_0x750112(0x45b)]['push'](_0x46eeaf),await _0x2a2987['chats'][_0x750112(0xf36)](_0x138f9d),_0x464425++;}}}return _0x464425;}async function _0x37f343(){const _0x1b0033=_0x247bea;if(!_0x58b047['isActive']&&_0x58b047[_0x1b0033(0xfc2)]===_0x1b0033(0x80e)){await _0x2d7ddd(_0x1b0033(0xb37),_0x1b0033(0x7d4));try{const _0x6a8454=_0x212118(_0x58b047),_0x416461=await _0x5a560e(_0x6a8454);await _0x2d7ddd('成功',_0x1b0033(0xc93)+_0x416461+_0x1b0033(0x67c));}catch(_0x138824){console[_0x1b0033(0x4d9)](_0x1b0033(0x497),_0x138824),await _0x2d7ddd('失败',_0x1b0033(0xe68)+_0x138824['message']);}}else alert(_0x1b0033(0x1045));}async function _0x12102f(_0x16ee8c){const _0x13ba41=_0x247bea;_0x58b047[_0x13ba41(0x1f3)]=![],_0x58b047[_0x13ba41(0xfc2)]='gameover',_0x3fc843(_0x16ee8c+'阵营胜利！'),document[_0x13ba41(0xc33)](_0x13ba41(0xe7a))[_0x13ba41(0x11b0)]=_0x16ee8c+_0x13ba41(0x5e1);let _0x4e14cc='';_0x16ee8c==='好人'?_0x4e14cc=_0x13ba41(0x121e):_0x4e14cc='狼人数量已达到胜利条件，狼人阵营获得了胜利！';const _0x27b59d=document[_0x13ba41(0xc33)](_0x13ba41(0xd57));_0x27b59d[_0x13ba41(0x11b0)]=_0x4e14cc;const _0x5d626c=document[_0x13ba41(0xc33)](_0x13ba41(0x289));_0x5d626c[_0x13ba41(0x102a)]='';const _0x20cf03=[..._0x58b047[_0x13ba41(0x392)]][_0x13ba41(0xbb3)]((_0x1c0377,_0x387fb4)=>{const _0x3e8f14=_0x13ba41,_0x9c935e=_0x58b047[_0x3e8f14(0x392)]['findIndex'](_0x13a070=>_0x13a070['id']===_0x1c0377['id']),_0x27c998=_0x58b047[_0x3e8f14(0x392)]['findIndex'](_0x2ab010=>_0x2ab010['id']===_0x387fb4['id']);return _0x9c935e-_0x27c998;});_0x20cf03[_0x13ba41(0xd6a)]((_0x574191,_0x3439ad)=>{const _0x1c84d5=_0x13ba41,_0x20a4d1=document['createElement']('div');_0x20a4d1[_0x1c84d5(0x105d)][_0x1c84d5(0x4c1)]='display:\x20flex;\x20align-items:\x20center;\x20padding:\x208px\x200;\x20border-bottom:\x201px\x20solid\x20#444;\x20color:\x20white;';if(_0x3439ad===_0x20cf03['length']-0x1)_0x20a4d1[_0x1c84d5(0x105d)][_0x1c84d5(0x1163)]='none';const _0x5667c5=_0x574191[_0x1c84d5(0x16d)]==='狼人'?_0x1c84d5(0xea3):_0x1c84d5(0x17f);_0x20a4d1[_0x1c84d5(0x102a)]=_0x1c84d5(0x173)+_0x574191['avatar']+_0x1c84d5(0x652)+(_0x574191[_0x1c84d5(0x12a)]?_0x1c84d5(0x854):_0x1c84d5(0x1277))+_0x1c84d5(0x1178)+(_0x574191[_0x1c84d5(0x12a)]?_0x1c84d5(0x854):_0x1c84d5(0x1165))+_0x1c84d5(0xa7c)+(_0x3439ad+0x1)+'.\x20'+_0x574191[_0x1c84d5(0x578)]+_0x1c84d5(0x7fb)+_0x5667c5+';\x22>'+_0x574191['role']+'</strong>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x5d626c[_0x1c84d5(0xf77)](_0x20a4d1);}),document[_0x13ba41(0xc33)](_0x13ba41(0x10a5))['classList']['add'](_0x13ba41(0x143));try{console[_0x13ba41(0x51f)](_0x13ba41(0xd6b));const _0x3b6d33=_0x212118(_0x58b047),_0x2b2d0d=await generateAndInjectWerewolfMemories(_0x3b6d33);console[_0x13ba41(0x51f)](_0x13ba41(0x2b2)+_0x2b2d0d+_0x13ba41(0x744));}catch(_0x414bcd){console[_0x13ba41(0x4d9)]('自动总结狼人杀游戏失败:',_0x414bcd),_0x27b59d&&(_0x27b59d[_0x13ba41(0x102a)]+=_0x13ba41(0x1180));}}function _0x3fc843(_0x135408){const _0x3500a1=_0x247bea;_0x58b047[_0x3500a1(0xf85)][_0x3500a1(0x2d6)]({'type':'system','content':_0x135408,'timestamp':Date[_0x3500a1(0x6ee)](),'day':_0x58b047[_0x3500a1(0x3cb)]});}function _0xaacbe9(_0x20ee3a,_0x2f88f1){const _0x3e24b4=_0x247bea;_0x58b047[_0x3e24b4(0x3c9)][_0x3e24b4(0x2d6)]({'type':'dialogue','speaker':_0x20ee3a,'content':_0x2f88f1,'timestamp':Date[_0x3e24b4(0x6ee)](),'day':_0x58b047[_0x3e24b4(0x3cb)]});}function _0xbf5c(_0x43f179){return new Promise(_0x559159=>{const _0x505a80=_0x26e9,_0xab24e='werewolf-'+_0x43f179+_0x505a80(0xde5),_0x176e48=_0x505a80(0x100c)+_0x43f179+_0x505a80(0x383);let _0x2dfbb1='';if(_0x43f179===_0x505a80(0xc2a))_0x2dfbb1=_0x505a80(0xe7f);if(_0x43f179===_0x505a80(0x13f))_0x2dfbb1=_0x505a80(0xb43);if(_0x43f179==='vote')_0x2dfbb1=_0x505a80(0x223);const _0x35415f=document['getElementById'](_0xab24e),_0x2e3118=document[_0x505a80(0xc33)](_0x176e48),_0x1cf18e=document[_0x505a80(0xc33)](_0x2dfbb1);_0x2e3118['innerHTML']='';let _0x28e40e=null;const _0x26f9fd=_0x58b047[_0x505a80(0x392)][_0x505a80(0x1054)](_0x5150b0=>_0x5150b0[_0x505a80(0x12a)]&&(_0x43f179===_0x505a80(0x13f)||_0x43f179===_0x505a80(0x75f)||_0x5150b0['id']!==_0x505a80(0x717)));_0x26f9fd[_0x505a80(0xd6a)](_0x26f060=>{const _0x37a48d=_0x505a80,_0x956dc5=document[_0x37a48d(0x1292)](_0x37a48d(0x58c));_0x956dc5[_0x37a48d(0x84)]=_0x37a48d(0x43f),_0x956dc5[_0x37a48d(0x85)]['id']=_0x26f060['id'],_0x956dc5[_0x37a48d(0x102a)]=_0x37a48d(0xb19)+_0x26f060[_0x37a48d(0xbac)]+_0x37a48d(0x4ef)+_0x26f060[_0x37a48d(0x578)]+_0x37a48d(0xc70),_0x956dc5[_0x37a48d(0x8a)]=()=>{const _0xc02e69=_0x37a48d;_0x2e3118['querySelectorAll'](_0xc02e69(0x2d2))[_0xc02e69(0xd6a)](_0x535145=>_0x535145[_0xc02e69(0x10d3)]['remove']('selected')),_0x956dc5[_0xc02e69(0x10d3)]['add'](_0xc02e69(0x63f)),_0x28e40e=_0x26f060['id'];},_0x2e3118['appendChild'](_0x956dc5);});const _0x2512e7=_0x1cf18e[_0x505a80(0xbc5)](!![]);_0x1cf18e[_0x505a80(0x1053)][_0x505a80(0xcaa)](_0x2512e7,_0x1cf18e),_0x2512e7[_0x505a80(0x8a)]=()=>{const _0x1e0314=_0x505a80;_0x28e40e?(_0x35415f[_0x1e0314(0x10d3)][_0x1e0314(0x2c7)](_0x1e0314(0x143)),_0x559159(_0x28e40e)):alert(_0x1e0314(0x134));},_0x35415f[_0x505a80(0x10d3)][_0x505a80(0xb9)](_0x505a80(0x143));});}function _0x1fad52(){return new Promise(_0x290a12=>{const _0x16bd6d=_0x26e9,_0x47c9c1=document['getElementById']('werewolf-kill-modal'),_0x51aa6e=document[_0x16bd6d(0xc33)]('werewolf-kill-selection-list'),_0x11a183=document[_0x16bd6d(0xc33)](_0x16bd6d(0x962)),_0x64da68=_0x47c9c1[_0x16bd6d(0x977)](_0x16bd6d(0x1261)),_0x36522c=_0x58b047[_0x16bd6d(0x392)][_0x16bd6d(0x1054)](_0x44819f=>_0x44819f[_0x16bd6d(0x16d)]==='狼人'&&_0x44819f[_0x16bd6d(0x12a)]),_0x51e642=_0x36522c['filter'](_0x261f27=>_0x261f27['id']!==_0x16bd6d(0x717))[_0x16bd6d(0x9d5)](_0x2d01ce=>_0x2d01ce[_0x16bd6d(0x578)])[_0x16bd6d(0x100b)]('、');_0x51e642?_0x64da68['innerHTML']=_0x16bd6d(0x322)+_0x51e642+_0x16bd6d(0x4cf):_0x64da68[_0x16bd6d(0x11b0)]=_0x16bd6d(0x887);_0x51aa6e[_0x16bd6d(0x102a)]='';let _0x3bcb22=null;const _0x3fdacd=_0x58b047[_0x16bd6d(0x392)][_0x16bd6d(0x1054)](_0x245442=>_0x245442[_0x16bd6d(0x12a)]&&_0x245442[_0x16bd6d(0x16d)]!=='狼人');_0x3fdacd[_0x16bd6d(0xd6a)](_0x1f44db=>{const _0x444fc7=_0x16bd6d,_0x3dcc9f=document[_0x444fc7(0x1292)](_0x444fc7(0x58c));_0x3dcc9f[_0x444fc7(0x84)]=_0x444fc7(0x43f),_0x3dcc9f[_0x444fc7(0x85)]['id']=_0x1f44db['id'],_0x3dcc9f[_0x444fc7(0x102a)]=_0x444fc7(0xb19)+_0x1f44db[_0x444fc7(0xbac)]+'\x22\x20class=\x22avatar\x22><span\x20class=\x22name\x22>'+_0x1f44db[_0x444fc7(0x578)]+_0x444fc7(0xc70),_0x3dcc9f['onclick']=()=>{const _0x13c1fa=_0x444fc7;_0x51aa6e[_0x13c1fa(0x67a)](_0x13c1fa(0x2d2))[_0x13c1fa(0xd6a)](_0x16ce13=>_0x16ce13[_0x13c1fa(0x10d3)][_0x13c1fa(0x2c7)]('selected')),_0x3dcc9f[_0x13c1fa(0x10d3)][_0x13c1fa(0xb9)]('selected'),_0x3bcb22=_0x1f44db['id'];},_0x51aa6e[_0x444fc7(0xf77)](_0x3dcc9f);});const _0x14ebb1=_0x11a183[_0x16bd6d(0xbc5)](!![]);_0x11a183[_0x16bd6d(0x1053)]['replaceChild'](_0x14ebb1,_0x11a183),_0x14ebb1[_0x16bd6d(0x8a)]=()=>{const _0x176648=_0x16bd6d;_0x3bcb22?(_0x47c9c1[_0x176648(0x10d3)]['remove']('visible'),_0x290a12(_0x3bcb22)):alert(_0x176648(0x134));},_0x47c9c1[_0x16bd6d(0x10d3)][_0x16bd6d(0xb9)](_0x16bd6d(0x143));});}function _0x56bf8(){const _0x50ffea=_0x247bea,_0x3c1851=_0x58b047[_0x50ffea(0x392)][_0x50ffea(0xd85)](_0x46b9d6=>_0x46b9d6['id']==='user');if(!_0x3c1851||!_0x3c1851['isAlive'])return;const _0x1f5691=document['getElementById'](_0x50ffea(0x28b)),_0x4b23ff=_0x1f5691[_0x50ffea(0x22a)]['trim']();_0x4b23ff&&(_0xaacbe9(_0x3c1851[_0x50ffea(0x578)],_0x4b23ff),_0x523a3f()),document[_0x50ffea(0xc33)](_0x50ffea(0x662))['style'][_0x50ffea(0xf44)]=_0x50ffea(0x854),_0x1f5691['value']='',_0x133ca2();}async function _0x11e591(){const _0xa15033=_0x247bea;_0x3fc843(_0xa15033(0x183)),_0x523a3f();const _0x3cef51=document[_0xa15033(0xc33)](_0xa15033(0xc67));if(_0x3cef51)_0x3cef51['disabled']=!![];await _0x2d7ddd(_0xa15033(0x114a),_0xa15033(0x5da));const {proxyUrl:_0x105e80,apiKey:_0x2bbf5d,model:_0x4a59ee}=_0x12493e[_0xa15033(0xdd4)];if(!_0x105e80||!_0x2bbf5d||!_0x4a59ee){alert(_0xa15033(0x6b2));return;}const _0x521607=_0x31ec52();try{let _0x62b1cf=_0x105e80[_0xa15033(0x1d4)](_0xa15033(0x113e)),_0x191194=[{'role':'user','content':_0xa15033(0x3ff)}],_0x1f10ba=_0x202ea1(_0x4a59ee,_0x2bbf5d,_0x521607,_0x191194);const _0x56fb5c=_0x62b1cf?await fetch(_0x1f10ba[_0xa15033(0x11a)],_0x1f10ba['data']):await fetch(_0x105e80+_0xa15033(0x399),{'method':_0xa15033(0x90),'headers':{'Content-Type':_0xa15033(0xd74),'Authorization':_0xa15033(0xf20)+_0x2bbf5d},'body':JSON[_0xa15033(0xd27)]({'model':_0x4a59ee,'messages':[{'role':'system','content':_0x521607},..._0x191194],'temperature':_0x12493e[_0xa15033(0x10f6)][_0xa15033(0xd52)]||0.9})});if(!_0x56fb5c['ok']){const _0x1b5ddd=await _0x56fb5c[_0xa15033(0x79e)]();throw new Error('API\x20错误:\x20'+_0x1b5ddd['error'][_0xa15033(0xf93)]);}const _0x3c75b4=await _0x56fb5c[_0xa15033(0x79e)](),_0x4e73c5=getGeminiResponseText(_0x3c75b4),_0x23c77c=_0x4e73c5[_0xa15033(0x1242)](/(\[[\s\S]*\])/);if(!_0x23c77c)throw new Error(_0xa15033(0xd3d)+_0x4e73c5);const _0x4f2c0c=JSON['parse'](_0x23c77c[0x0]);for(const _0x3ce5e4 of _0x4f2c0c){_0x3ce5e4['speaker_name']&&_0x3ce5e4[_0xa15033(0x156)]&&(_0xaacbe9(_0x3ce5e4[_0xa15033(0xfe9)],_0x3ce5e4[_0xa15033(0x156)]),_0x523a3f(),await new Promise(_0xf3570=>setTimeout(_0xf3570,0x5dc+Math[_0xa15033(0xa11)]()*0x7d0)));}}catch(_0x551f7a){console[_0xa15033(0x4d9)](_0xa15033(0xa17),_0x551f7a),await _0x2d7ddd(_0xa15033(0xcea),_0xa15033(0xa56)+_0x551f7a['message']);}finally{if(_0x3cef51)_0x3cef51[_0xa15033(0xfd8)]=![];}}async function _0x205441(){const _0x1d72fa=_0x247bea,_0x2c7734=_0x58b047[_0x1d72fa(0x392)]['find'](_0x24d67e=>_0x24d67e['id']===_0x1d72fa(0x717));if(!_0x2c7734||!_0x2c7734[_0x1d72fa(0x12a)]){console[_0x1d72fa(0x54a)](_0x1d72fa(0x79c));return;}const _0x4e1c80=document[_0x1d72fa(0xc33)](_0x1d72fa(0x28b)),_0x56e7c1=_0x4e1c80[_0x1d72fa(0x22a)][_0x1d72fa(0x7da)]();if(!_0x56e7c1){alert('请先输入你的发言内容。');return;}_0xaacbe9(_0x2c7734[_0x1d72fa(0x578)],_0x56e7c1),_0x523a3f(),_0x4e1c80[_0x1d72fa(0x22a)]='',await _0x2d7ddd(_0x1d72fa(0x114a),'正在等待AI角色们对你的发言做出回应...');const {proxyUrl:_0x3f02ca,apiKey:_0x4ff3c0,model:_0x5233a1}=_0x12493e[_0x1d72fa(0xdd4)];if(!_0x3f02ca||!_0x4ff3c0||!_0x5233a1){alert('API未配置，无法生成对话。');return;}const _0x3ce295=_0x31ec52();try{let _0x3b819d=_0x3f02ca[_0x1d72fa(0x1d4)](_0x1d72fa(0x113e)),_0x1b1bf8=[{'role':'user','content':_0x1d72fa(0xbdf)+_0x2c7734[_0x1d72fa(0x578)]+'\x27的发言）继续进行讨论。'}],_0x45e61b=_0x202ea1(_0x5233a1,_0x4ff3c0,_0x3ce295,_0x1b1bf8);const _0x572ab9=_0x3b819d?await fetch(_0x45e61b['url'],_0x45e61b[_0x1d72fa(0xa78)]):await fetch(_0x3f02ca+_0x1d72fa(0x399),{'method':_0x1d72fa(0x90),'headers':{'Content-Type':'application/json','Authorization':_0x1d72fa(0xf20)+_0x4ff3c0},'body':JSON[_0x1d72fa(0xd27)]({'model':_0x5233a1,'messages':[{'role':_0x1d72fa(0x152),'content':_0x3ce295},..._0x1b1bf8],'temperature':_0x12493e[_0x1d72fa(0x10f6)][_0x1d72fa(0xd52)]||0.9})});if(!_0x572ab9['ok']){const _0x41c9ea=await _0x572ab9[_0x1d72fa(0x79e)]();throw new Error('API\x20错误:\x20'+_0x41c9ea[_0x1d72fa(0x4d9)]['message']);}const _0x240ea9=await _0x572ab9[_0x1d72fa(0x79e)](),_0x26a9ff=getGeminiResponseText(_0x240ea9),_0x140ef1=_0x26a9ff[_0x1d72fa(0x1242)](/(\[[\s\S]*\])/);if(!_0x140ef1)throw new Error(_0x1d72fa(0xd3d)+_0x26a9ff);const _0x12d940=JSON['parse'](_0x140ef1[0x0]);for(const _0x4fb541 of _0x12d940){_0x4fb541[_0x1d72fa(0xfe9)]&&_0x4fb541[_0x1d72fa(0x156)]&&(_0xaacbe9(_0x4fb541[_0x1d72fa(0xfe9)],_0x4fb541[_0x1d72fa(0x156)]),_0x523a3f(),await new Promise(_0x540db8=>setTimeout(_0x540db8,0x5dc+Math[_0x1d72fa(0xa11)]()*0x7d0)));}}catch(_0x860e51){console['error'](_0x1d72fa(0xa17),_0x860e51),await _0x2d7ddd(_0x1d72fa(0xcea),_0x1d72fa(0xa56)+_0x860e51['message']);}}async function _0x133ca2(){const _0x27ada1=_0x247bea;_0x3fc843(_0x27ada1(0x445)),_0x523a3f(),_0x58b047[_0x27ada1(0x4d4)]={};let _0x1a6ac5=null;_0x58b047[_0x27ada1(0x807)]=_0x27ada1(0x16c);try{_0x1a6ac5=await _0x4380e6(),_0x1a6ac5&&_0x1a6ac5['forEach'](_0x7c925d=>{const _0x21a1a4=_0x27ada1,_0x2a092=_0x58b047[_0x21a1a4(0x392)]['find'](_0xab06ed=>_0xab06ed[_0x21a1a4(0x578)]===_0x7c925d['voter_name']),_0x1ae972=_0x58b047[_0x21a1a4(0x392)][_0x21a1a4(0xd85)](_0x14f7ee=>_0x14f7ee['name']===_0x7c925d[_0x21a1a4(0x1195)]);_0x2a092&&_0x2a092[_0x21a1a4(0x12a)]&&_0x1ae972&&(_0x58b047[_0x21a1a4(0x4d4)][_0x2a092[_0x21a1a4(0x578)]]=_0x1ae972[_0x21a1a4(0x578)]);}),_0x58b047[_0x27ada1(0x807)]=null;}catch(_0x4c4971){console[_0x27ada1(0x4d9)](_0x27ada1(0x1208),_0x4c4971),await _0x2d7ddd(_0x27ada1(0xb9d),_0x27ada1(0x553)+_0x4c4971[_0x27ada1(0xf93)]),document[_0x27ada1(0xc33)](_0x27ada1(0xd55))[_0x27ada1(0x105d)][_0x27ada1(0xf44)]=_0x27ada1(0xa20);return;}const _0xc32688=_0x58b047[_0x27ada1(0x392)][_0x27ada1(0xd85)](_0x201efe=>_0x201efe['id']==='user');if(_0xc32688&&_0xc32688[_0x27ada1(0x12a)]){_0x3fc843(_0x27ada1(0xf33)),_0x523a3f();const _0x19f48d=await _0xbf5c(_0x27ada1(0x75f)),_0x150fcc=_0x58b047['players'][_0x27ada1(0xd85)](_0x14c466=>_0x14c466['id']===_0x19f48d);_0x150fcc&&(_0x58b047[_0x27ada1(0x4d4)][_0xc32688['name']]=_0x150fcc[_0x27ada1(0x578)]);}_0x3cbfa9();}async function _0x4380e6(){const _0x3a7a53=_0x247bea,{proxyUrl:_0x52078d,apiKey:_0x410ea3,model:_0x3d0884}=_0x12493e[_0x3a7a53(0xdd4)];if(!_0x52078d||!_0x410ea3||!_0x3d0884)return null;const _0x22cee0=_0x58b047[_0x3a7a53(0x392)][_0x3a7a53(0x1054)](_0x1e9da2=>_0x1e9da2[_0x3a7a53(0x12a)]&&_0x1e9da2['id']!=='user'),_0xa1281a=_0x58b047['players']['filter'](_0x35d5aa=>_0x35d5aa[_0x3a7a53(0x12a)])[_0x3a7a53(0x9d5)](_0x4f1eed=>_0x4f1eed[_0x3a7a53(0x578)]);let _0x348d53=_0x31ec52();_0x348d53+=_0x3a7a53(0x92d)+_0xa1281a[_0x3a7a53(0x100b)](',\x20')+_0x3a7a53(0x957);try{let _0x59ece2=_0x52078d[_0x3a7a53(0x1d4)]('generativelanguage'),_0x41847d=[{'role':'user','content':'请所有AI角色开始投票。'}],_0x5d95a0=_0x202ea1(_0x3d0884,_0x410ea3,_0x348d53,_0x41847d);const _0x4bcca6=_0x59ece2?await fetch(_0x5d95a0[_0x3a7a53(0x11a)],_0x5d95a0[_0x3a7a53(0xa78)]):await fetch(_0x52078d+'/v1/chat/completions',{'method':_0x3a7a53(0x90),'headers':{'Content-Type':_0x3a7a53(0xd74),'Authorization':'Bearer\x20'+_0x410ea3},'body':JSON[_0x3a7a53(0xd27)]({'model':_0x3d0884,'messages':[{'role':_0x3a7a53(0x152),'content':_0x348d53},..._0x41847d],'temperature':_0x12493e[_0x3a7a53(0x10f6)]['apiTemperature']||0.8})});if(!_0x4bcca6['ok'])throw new Error((await _0x4bcca6['json']())[_0x3a7a53(0x4d9)]['message']);const _0x25ee03=await _0x4bcca6[_0x3a7a53(0x79e)](),_0x2d4e53=getGeminiResponseText(_0x25ee03);let _0x51a42d=_0x2d4e53['replace'](/^```json\s*/,'')['replace'](/```$/,'')['trim']();const _0x9c18ee=_0x51a42d[_0x3a7a53(0x107e)]('['),_0x3722af=_0x51a42d[_0x3a7a53(0xe02)](']');if(_0x9c18ee===-0x1||_0x3722af===-0x1||_0x3722af<_0x9c18ee)throw new Error(_0x3a7a53(0x671));const _0x220ca7=_0x51a42d['substring'](_0x9c18ee,_0x3722af+0x1);try{const _0x16d2fc=_0x220ca7[_0x3a7a53(0x1242)](/(\[[\s\S]*?\])/g);if(_0x16d2fc&&_0x16d2fc[_0x3a7a53(0x79b)]>0x0)return JSON[_0x3a7a53(0x6b1)](_0x16d2fc[_0x16d2fc['length']-0x1]);return JSON[_0x3a7a53(0x6b1)](_0x220ca7);}catch(_0x515c90){throw new Error(_0x3a7a53(0xad2)+_0x515c90[_0x3a7a53(0xf93)]+_0x3a7a53(0x118a)+_0x2d4e53);}}catch(_0x420b2f){console['error'](_0x3a7a53(0x11b7),_0x420b2f);throw new Error(_0x3a7a53(0x814)+_0x420b2f[_0x3a7a53(0xf93)]);}}function _0x3cbfa9(){const _0x1ceb54=_0x247bea,_0x3f563b={},_0x3d7660={};for(const _0x5aeede in _0x58b047['votes']){const _0x1540db=_0x58b047['votes'][_0x5aeede];_0x3f563b[_0x1540db]=(_0x3f563b[_0x1540db]||0x0)+0x1,!_0x3d7660[_0x1540db]&&(_0x3d7660[_0x1540db]=[]),_0x3d7660[_0x1540db][_0x1ceb54(0x2d6)](_0x5aeede);}let _0x43e89e=0x0,_0x21bf90=[];for(const _0x28e1e3 in _0x3f563b){const _0x1e0666=_0x3f563b[_0x28e1e3];if(_0x1e0666>_0x43e89e)_0x43e89e=_0x1e0666,_0x21bf90=[_0x28e1e3];else _0x1e0666===_0x43e89e&&_0x21bf90[_0x1ceb54(0x2d6)](_0x28e1e3);}_0x3fc843(_0x1ceb54(0x1138));for(const _0x5c3105 in _0x3d7660){_0x3fc843(_0x5c3105+'\x20('+_0x3d7660[_0x5c3105][_0x1ceb54(0x79b)]+'票):\x20'+_0x3d7660[_0x5c3105][_0x1ceb54(0x100b)]('、\x20'));}if(_0x21bf90[_0x1ceb54(0x79b)]===0x1&&_0x43e89e>0x0){const _0x3c69cb=_0x58b047[_0x1ceb54(0x392)][_0x1ceb54(0xd85)](_0x19b632=>_0x19b632[_0x1ceb54(0x578)]===_0x21bf90[0x0]);if(_0x3c69cb){_0x3c69cb[_0x1ceb54(0x12a)]=![],_0x3fc843(_0x3c69cb[_0x1ceb54(0x578)]+'\x20被投票放逐。');if(_0x3c69cb['role']==='猎人'){}}}else _0x3fc843(_0x1ceb54(0x3d2));_0x523a3f();if(_0x9356e5())return;_0x58b047[_0x1ceb54(0x3cb)]++,_0x529f2f();}async function _0x58b974(){const _0x2508dc=_0x247bea,{proxyUrl:_0x2458be,apiKey:_0x29d431,model:_0x27eff6}=_0x12493e[_0x2508dc(0xdd4)];if(!_0x2458be||!_0x29d431||!_0x27eff6)return null;const _0x294f44=_0x58b047[_0x2508dc(0x392)][_0x2508dc(0x1054)](_0x5640f2=>_0x5640f2[_0x2508dc(0x16d)]==='狼人'&&_0x5640f2[_0x2508dc(0x12a)]),_0x29c0fb=_0x58b047['players'][_0x2508dc(0x1054)](_0x149b2d=>_0x149b2d[_0x2508dc(0x12a)]&&_0x149b2d[_0x2508dc(0x16d)]!=='狼人'),_0x2e5f09=_0x2508dc(0x19b)+_0x294f44[_0x2508dc(0x9d5)](_0x57a39e=>_0x57a39e[_0x2508dc(0x578)])[_0x2508dc(0x100b)]('、\x20')+'\x0a-\x20**可以刀的玩家列表**:\x20'+_0x29c0fb[_0x2508dc(0x9d5)](_0x86245b=>_0x86245b[_0x2508dc(0x578)])[_0x2508dc(0x100b)]('、\x20')+'\x0a-\x20**讨论摘要**:\x20\x0a'+_0x58b047['discussionLog']['map'](_0x3eb825=>_0x3eb825[_0x2508dc(0x84a)]+':\x20'+_0x3eb825[_0x2508dc(0xcbd)])[_0x2508dc(0x100b)]('\x0a')+_0x2508dc(0x1fd);try{let _0x4d9920=_0x2458be[_0x2508dc(0x1d4)](_0x2508dc(0x113e)),_0x20b449=[{'role':_0x2508dc(0x717),'content':_0x2508dc(0xa43)}],_0x198bff=_0x202ea1(_0x27eff6,_0x29d431,_0x2e5f09,_0x20b449);const _0x4d30c5=_0x4d9920?await fetch(_0x198bff[_0x2508dc(0x11a)],_0x198bff[_0x2508dc(0xa78)]):await fetch(_0x2458be+_0x2508dc(0x399),{'method':_0x2508dc(0x90),'headers':{'Content-Type':'application/json','Authorization':'Bearer\x20'+_0x29d431},'body':JSON[_0x2508dc(0xd27)]({'model':_0x27eff6,'messages':[{'role':_0x2508dc(0x152),'content':_0x2e5f09},..._0x20b449],'temperature':_0x12493e[_0x2508dc(0x10f6)][_0x2508dc(0xd52)]||0.8})});if(!_0x4d30c5['ok'])throw new Error((await _0x4d30c5[_0x2508dc(0x79e)]())[_0x2508dc(0x4d9)]['message']);const _0x456ba7=await _0x4d30c5['json'](),_0x1d932b=getGeminiResponseText(_0x456ba7),_0x33478b=_0x1d932b[_0x2508dc(0x1242)](/({[\s\S]*})/);if(!_0x33478b)throw new Error('AI返回的刀人目标格式不正确。');const _0x243194=JSON[_0x2508dc(0x6b1)](_0x33478b[0x0]),_0x4f875=_0x58b047['players']['find'](_0x253c9c=>_0x253c9c['name']===_0x243194[_0x2508dc(0x11b3)]);return _0x4f875?_0x4f875['id']:null;}catch(_0x49ca0a){return console[_0x2508dc(0x4d9)](_0x2508dc(0xf11),_0x49ca0a),_0x29c0fb[Math[_0x2508dc(0xcb5)](Math[_0x2508dc(0xa11)]()*_0x29c0fb['length'])]['id'];}}function _0x28edde(_0x5d2ed6,_0x5efd4c){return new Promise(_0x84eab3=>{const _0x1f7b46=_0x26e9,_0x40ba00=document[_0x1f7b46(0xc33)](_0x1f7b46(0x11db)),_0x416da8=document[_0x1f7b46(0xc33)]('werewolf-witch-selection-list'),_0x5458ed=document['getElementById'](_0x1f7b46(0xaf8)),_0x401c9e=document['getElementById']('confirm-witch-poison-btn'),_0x167714=document[_0x1f7b46(0xc33)](_0x1f7b46(0xc4e));_0x416da8['innerHTML']='';const _0x1a7782=_0x401c9e[_0x1f7b46(0xbc5)](!![]);_0x401c9e[_0x1f7b46(0x1053)][_0x1f7b46(0xcaa)](_0x1a7782,_0x401c9e);const _0x215af3=_0x167714['cloneNode'](!![]);_0x167714[_0x1f7b46(0x1053)]['replaceChild'](_0x215af3,_0x167714),_0x1a7782[_0x1f7b46(0x105d)][_0x1f7b46(0xf44)]=_0x1f7b46(0xa20),_0x1a7782[_0x1f7b46(0xfd8)]=!![];let _0x588bd3={'save':![],'poison':null},_0x5dc632=null;if(_0x5d2ed6&&!_0x5efd4c[_0x1f7b46(0x4d8)]){_0x5458ed['textContent']=_0x1f7b46(0x5fa)+_0x5d2ed6['name']+'\x20被刀了';const _0x47b4ee=document[_0x1f7b46(0x1292)](_0x1f7b46(0xeb1));_0x47b4ee['className']='form-button',_0x47b4ee['textContent']='使用解药救TA',_0x47b4ee[_0x1f7b46(0x105d)][_0x1f7b46(0x948)]='20px',_0x47b4ee[_0x1f7b46(0x8a)]=()=>{const _0x38d3ee=_0x1f7b46;_0x588bd3['save']=!![],_0x40ba00[_0x38d3ee(0x10d3)][_0x38d3ee(0x2c7)](_0x38d3ee(0x143)),_0x84eab3(_0x588bd3);},_0x416da8[_0x1f7b46(0xf77)](_0x47b4ee);}else _0x5d2ed6?_0x5458ed['textContent']=_0x1f7b46(0x5fa)+_0x5d2ed6['name']+_0x1f7b46(0xac3):_0x5458ed[_0x1f7b46(0x11b0)]='昨晚是平安夜';if(!_0x5efd4c[_0x1f7b46(0x174)]){const _0x6b9ca3=document[_0x1f7b46(0x1292)]('p');_0x6b9ca3[_0x1f7b46(0x11b0)]=_0x1f7b46(0xfbe),_0x6b9ca3[_0x1f7b46(0x105d)][_0x1f7b46(0xb58)]=_0x1f7b46(0xcef),_0x6b9ca3['style'][_0x1f7b46(0xba7)]=_0x1f7b46(0x910),_0x416da8[_0x1f7b46(0xf77)](_0x6b9ca3);const _0x371078=_0x58b047[_0x1f7b46(0x392)][_0x1f7b46(0x1054)](_0x5a5c58=>_0x5a5c58[_0x1f7b46(0x12a)]&&_0x5a5c58['id']!==_0x5d2ed6?.['id']);_0x371078[_0x1f7b46(0xd6a)](_0x957992=>{const _0x446754=_0x1f7b46,_0xd2dcf1=document['createElement'](_0x446754(0x58c));_0xd2dcf1[_0x446754(0x84)]=_0x446754(0x43f),_0xd2dcf1['dataset']['id']=_0x957992['id'],_0xd2dcf1[_0x446754(0x102a)]=_0x446754(0xb19)+_0x957992[_0x446754(0xbac)]+_0x446754(0x4ef)+_0x957992['name']+_0x446754(0xc70),_0xd2dcf1[_0x446754(0x8a)]=()=>{const _0x256a4b=_0x446754;_0x416da8[_0x256a4b(0x67a)]('.selected')[_0x256a4b(0xd6a)](_0xf17b74=>_0xf17b74[_0x256a4b(0x10d3)][_0x256a4b(0x2c7)](_0x256a4b(0x63f))),_0xd2dcf1[_0x256a4b(0x10d3)]['add']('selected'),_0x5dc632=_0x957992['id'],_0x1a7782[_0x256a4b(0xfd8)]=![];},_0x416da8[_0x446754(0xf77)](_0xd2dcf1);});}_0x1a7782[_0x1f7b46(0x8a)]=()=>{const _0x5190b1=_0x1f7b46;_0x5dc632&&(_0x588bd3[_0x5190b1(0x8ad)]=_0x5dc632,_0x40ba00[_0x5190b1(0x10d3)][_0x5190b1(0x2c7)](_0x5190b1(0x143)),_0x84eab3(_0x588bd3));},_0x215af3[_0x1f7b46(0x8a)]=()=>{const _0x38f1be=_0x1f7b46;_0x40ba00['classList']['remove'](_0x38f1be(0x143)),_0x84eab3(_0x588bd3);},_0x40ba00['classList'][_0x1f7b46(0xb9)](_0x1f7b46(0x143));});}async function _0x5a0764(){const _0x3890be=_0x247bea,_0x2fb0ed=_0x58b047[_0x3890be(0x807)];if(!_0x2fb0ed)return;document['getElementById'](_0x3890be(0xd55))[_0x3890be(0x105d)]['display']=_0x3890be(0x854),await _0x2d7ddd(_0x3890be(0xb37),_0x3890be(0x4a5)+_0x2fb0ed+'\x22操作...');switch(_0x2fb0ed){case _0x3890be(0x45f):await _0x529f2f();break;case'startDiscussion':await _0x575c47();break;case'getVotes':await _0x133ca2();break;}}function _0x9356e5(){const _0x55014e=_0x247bea,_0x45427a=_0x58b047[_0x55014e(0x392)]['filter'](_0x589b80=>_0x589b80['isAlive']),_0x1a318e=_0x45427a['filter'](_0x397afc=>_0x397afc['role']==='狼人'),_0x47a934=_0x45427a[_0x55014e(0x1054)](_0x5558e5=>['预言家','女巫','猎人','守卫'][_0x55014e(0x1d4)](_0x5558e5[_0x55014e(0x16d)])),_0x18484d=_0x45427a[_0x55014e(0x1054)](_0xbba5d5=>_0xbba5d5[_0x55014e(0x16d)]==='平民');let _0x4a76fd=null;if(_0x1a318e[_0x55014e(0x79b)]===0x0)_0x4a76fd='好人';else{if(_0x1a318e[_0x55014e(0x79b)]>=_0x47a934['length']+_0x18484d[_0x55014e(0x79b)])_0x4a76fd='狼人';else _0x58b047['gameMode']===_0x55014e(0x2a4)?(_0x47a934[_0x55014e(0x79b)]===0x0||_0x18484d[_0x55014e(0x79b)]===0x0)&&(_0x4a76fd='狼人'):_0x47a934[_0x55014e(0x79b)]===0x0&&_0x18484d['length']===0x0&&(_0x4a76fd='狼人');}if(_0x4a76fd)return _0x12102f(_0x4a76fd),!![];return![];}async function _0x4ad72d(){const _0x194645=_0x247bea,_0x37cc43=await _0x270512(_0x194645(0x583),_0x194645(0x33b),{'confirmText':'开始检查'});if(!_0x37cc43)return;await _0x2d7ddd('请稍候...',_0x194645(0xd70));try{const _0x2de062=await _0x2a2987[_0x194645(0xc45)][_0x194645(0xf15)]();let _0x5c5c29=0x0;for(const _0xf9d7df of _0x2de062){let _0x5d33e9=![];!Array[_0x194645(0x621)](_0xf9d7df[_0x194645(0x1294)])&&(_0xf9d7df[_0x194645(0x1294)]=[],_0x5d33e9=!![]),(typeof _0xf9d7df['settings']!==_0x194645(0xe37)||_0xf9d7df['settings']===null)&&(_0xf9d7df[_0x194645(0x2ea)]={},_0x5d33e9=!![]),!_0xf9d7df[_0x194645(0x80b)]&&!_0xf9d7df['originalName']&&(_0xf9d7df[_0x194645(0x776)]=_0xf9d7df[_0x194645(0x578)],_0x5d33e9=!![]),typeof _0xf9d7df[_0x194645(0xdc5)]===_0x194645(0x120c)&&(_0xf9d7df['unreadCount']=0x0,_0x5d33e9=!![]),!Array[_0x194645(0x621)](_0xf9d7df[_0x194645(0x45b)])&&(_0xf9d7df['longTermMemory']=[],_0x5d33e9=!![]),_0x5d33e9&&(_0x5c5c29++,console[_0x194645(0x51f)](_0x194645(0xd82)+_0xf9d7df[_0x194645(0x578)]+'\x22\x20(ID:\x20'+_0xf9d7df['id']+_0x194645(0xa05)),await _0x2a2987[_0x194645(0xc45)][_0x194645(0xf36)](_0xf9d7df)),_0x12493e['chats'][_0xf9d7df['id']]=_0xf9d7df;}_0x5c5c29>0x0?(await _0x2d7ddd(_0x194645(0x7b3),'成功检查并修复了\x20'+_0x5c5c29+_0x194645(0x85a)),await _0x597ed7()):await _0x2d7ddd(_0x194645(0x683),_0x194645(0x97b));}catch(_0xa5e7ad){console[_0x194645(0x4d9)](_0x194645(0x82b),_0xa5e7ad),await _0x2d7ddd(_0x194645(0xb9d),_0x194645(0xfe2)+_0xa5e7ad[_0x194645(0xf93)]);}}function _0x11bb7f(_0x3eed68,_0x5947a2=_0x247bea(0xcbe)){const _0x1067ee=_0x247bea;if(_0x3eed68['querySelector'](_0x1067ee(0x11eb)))return;const _0x24e188=document[_0x1067ee(0x1292)]('div');_0x24e188[_0x1067ee(0x84)]='loader-container',_0x24e188['innerHTML']=_0x1067ee(0x434),_0x5947a2===_0x1067ee(0xbc2)?_0x3eed68[_0x1067ee(0xf77)](_0x24e188):_0x3eed68['prepend'](_0x24e188);}function _0x153aed(_0x8e7da2){const _0x16d764=_0x247bea,_0x2003dc=_0x8e7da2[_0x16d764(0x977)](_0x16d764(0x11eb));_0x2003dc&&_0x2003dc['remove']();}async function _0x513dc1(){const _0x16f75f=_0x247bea,_0x12857b=document[_0x16f75f(0xc33)](_0x16f75f(0x8fb)),_0x208ff3=document['getElementById'](_0x16f75f(0x219)),_0x390c0c=document[_0x16f75f(0xc33)](_0x16f75f(0x126c));_0x208ff3['innerHTML']='',_0x390c0c[_0x16f75f(0x737)]=![];const _0x2aed61=await _0x2a2987['worldBooks'][_0x16f75f(0xf15)]();_0x2aed61[_0x16f75f(0x79b)]===0x0?_0x208ff3['innerHTML']='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>没有可以删除的世界书。</p>':_0x2aed61[_0x16f75f(0xd6a)](_0x3c575a=>{const _0x52f41a=_0x16f75f,_0x438b2c=document['createElement'](_0x52f41a(0x58c));_0x438b2c[_0x52f41a(0x84)]='clear-posts-item',_0x438b2c[_0x52f41a(0x85)][_0x52f41a(0xf90)]=_0x3c575a['id'],_0x438b2c[_0x52f41a(0x102a)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x3c575a[_0x52f41a(0x578)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x208ff3[_0x52f41a(0xf77)](_0x438b2c);}),_0x12857b[_0x16f75f(0x10d3)][_0x16f75f(0xb9)](_0x16f75f(0x143));}async function _0x3ced98(){const _0x2219a1=_0x247bea,_0x3fce51=document[_0x2219a1(0x67a)](_0x2219a1(0xdab));if(_0x3fce51[_0x2219a1(0x79b)]===0x0){alert(_0x2219a1(0xcd3));return;}const _0x484cdc=Array[_0x2219a1(0x301)](_0x3fce51)[_0x2219a1(0x9d5)](_0xc6f779=>_0xc6f779[_0x2219a1(0x85)][_0x2219a1(0xf90)]),_0x5480aa=await _0x270512(_0x2219a1(0xa3b),'此操作将永久删除您选择的\x20'+_0x3fce51[_0x2219a1(0x79b)]+_0x2219a1(0xa39),{'confirmButtonClass':_0x2219a1(0xa2),'confirmText':_0x2219a1(0x8d6)});if(!_0x5480aa)return;await _0x2d7ddd(_0x2219a1(0xb37),_0x2219a1(0x11e7));try{await _0x2a2987['transaction']('rw',_0x2a2987['worldBooks'],_0x2a2987[_0x2219a1(0xc45)],async()=>{const _0x49689a=_0x2219a1;await _0x2a2987[_0x49689a(0x63a)][_0x49689a(0x98b)](_0x484cdc);const _0x5cb8c6=await _0x2a2987[_0x49689a(0xc45)][_0x49689a(0xf15)]();for(const _0x2a51ee of _0x5cb8c6){if(_0x2a51ee[_0x49689a(0x2ea)]&&Array[_0x49689a(0x621)](_0x2a51ee[_0x49689a(0x2ea)]['linkedWorldBookIds'])){const _0x259f1b=_0x2a51ee[_0x49689a(0x2ea)]['linkedWorldBookIds'][_0x49689a(0x79b)];_0x2a51ee['settings'][_0x49689a(0xeca)]=_0x2a51ee[_0x49689a(0x2ea)]['linkedWorldBookIds'][_0x49689a(0x1054)](_0x4a7366=>!_0x484cdc[_0x49689a(0x1d4)](_0x4a7366)),_0x2a51ee[_0x49689a(0x2ea)][_0x49689a(0xeca)][_0x49689a(0x79b)]<_0x259f1b&&await _0x2a2987[_0x49689a(0xc45)][_0x49689a(0xf36)](_0x2a51ee);}}}),_0x12493e[_0x2219a1(0x63a)]=_0x12493e['worldBooks'][_0x2219a1(0x1054)](_0x20b7d3=>!_0x484cdc[_0x2219a1(0x1d4)](_0x20b7d3['id'])),document[_0x2219a1(0xc33)](_0x2219a1(0x8fb))[_0x2219a1(0x10d3)]['remove'](_0x2219a1(0x143)),await _0x2d7ddd(_0x2219a1(0xf8f),_0x3fce51[_0x2219a1(0x79b)]+'\x20本世界书已成功删除。');}catch(_0x5a463){console[_0x2219a1(0x4d9)]('删除世界书失败:',_0x5a463),await _0x2d7ddd(_0x2219a1(0xf41),_0x2219a1(0xa26)+_0x5a463[_0x2219a1(0xf93)]);}}function _0xe98314(){const _0x544399=_0x247bea;if(!_0x12493e['activeChatId'])return;const _0x4566e5=_0x12493e[_0x544399(0x7bc)],_0x1443f3=document[_0x544399(0xc33)](_0x544399(0xf79)),_0x19e0cc=document[_0x544399(0xc33)](_0x544399(0x3ee)),_0x420651=document[_0x544399(0xc33)]('reading-restore-btn');let _0x47fe1c=_0x32d3a1[_0x4566e5];if(_0x47fe1c&&_0x47fe1c['isActive']){_0x47fe1c[_0x544399(0x8cc)]&&_0x4ff2d4();_0x1443f3[_0x544399(0x105d)]['display']=_0x544399(0x21a);return;}_0xe72fae(_0x4566e5),_0x2196ac(_0x4566e5),_0x1443f3[_0x544399(0x105d)][_0x544399(0xf44)]='flex',_0x19e0cc[_0x544399(0x10d3)][_0x544399(0x2c7)](_0x544399(0x1184)),_0x420651['style']['display']=_0x544399(0x854);const _0x31c611=document[_0x544399(0xc33)](_0x544399(0x779)),_0x383fac=_0x19e0cc['getBoundingClientRect'](),_0x246d18=(_0x31c611[_0x544399(0xe53)]-_0x383fac[_0x544399(0x27d)])/0x2,_0x25db3a=(_0x31c611[_0x544399(0x9dd)]-_0x383fac[_0x544399(0x5f8)])/0x2;_0x19e0cc['style'][_0x544399(0xcbe)]=_0x246d18+'px',_0x19e0cc[_0x544399(0x105d)][_0x544399(0x9e2)]=_0x25db3a+'px',_0x19e0cc['style'][_0x544399(0x404)]='';}function _0xe72fae(_0x290706){const _0x6fdd7f=_0x247bea;_0x32d3a1[_0x290706]={'isActive':!![],'isMinimized':![],'title':_0x6fdd7f(0x3bf),'contentLines':[],'currentPage':0x0,'totalPages':0x0,'linesPerPage':0xf,'currentSnippet':''};}function _0x4a43c9(){const _0x22fd22=_0x247bea,_0x191f90=_0x12493e[_0x22fd22(0x7bc)];if(!_0x191f90||!_0x32d3a1[_0x191f90]||!_0x32d3a1[_0x191f90][_0x22fd22(0x1f3)])return;document[_0x22fd22(0xc33)](_0x22fd22(0xf79))[_0x22fd22(0x105d)]['display']=_0x22fd22(0x854),document[_0x22fd22(0xc33)](_0x22fd22(0x896))[_0x22fd22(0x105d)]['display']='none',document[_0x22fd22(0xc33)](_0x22fd22(0x3ee))[_0x22fd22(0x10d3)][_0x22fd22(0x2c7)](_0x22fd22(0x1184)),_0x32d3a1[_0x191f90][_0x22fd22(0x1f3)]=![],console['log'](_0x22fd22(0xb7c));}function _0x21470b(){const _0x5c73db=_0x247bea,_0x3f665c=_0x32d3a1[_0x12493e[_0x5c73db(0x7bc)]];if(!_0x3f665c||!_0x3f665c[_0x5c73db(0x1f3)]||_0x3f665c[_0x5c73db(0x8cc)])return;_0x3f665c['isMinimized']=!![],document['getElementById'](_0x5c73db(0x3ee))['classList'][_0x5c73db(0xb9)](_0x5c73db(0x1184)),document[_0x5c73db(0xc33)](_0x5c73db(0x896))[_0x5c73db(0x105d)][_0x5c73db(0xf44)]=_0x5c73db(0x21a);}function _0x4ff2d4(){const _0x261345=_0x247bea,_0x35e529=_0x32d3a1[_0x12493e['activeChatId']];if(!_0x35e529||!_0x35e529['isActive']||!_0x35e529['isMinimized'])return;_0x35e529[_0x261345(0x8cc)]=![],document[_0x261345(0xc33)](_0x261345(0x896))[_0x261345(0x105d)][_0x261345(0xf44)]=_0x261345(0x854),document[_0x261345(0xc33)](_0x261345(0x3ee))[_0x261345(0x10d3)][_0x261345(0x2c7)](_0x261345(0x1184));}function _0x30b834(_0x49fbb2,_0xe1b998){const _0x280438=_0x247bea;let _0x142d35=0x0,_0x5aba41=0x0,_0x933aa5=0x0,_0x4800f2=0x0;const _0x454806=document[_0x280438(0xc33)](_0x280438(0x779)),_0x407692=_0x3f6e5d=>{const _0x193146=_0x280438;if(_0x3f6e5d['target'][_0x193146(0x7a7)](_0x193146(0xeb1)))return;if(_0x49fbb2[_0x193146(0x105d)]['transform']){const _0x395bbb=_0x49fbb2[_0x193146(0x9f3)](),_0x27bddb=_0x49fbb2[_0x193146(0x37a)][_0x193146(0x9f3)]();_0x49fbb2['style'][_0x193146(0xcbe)]=_0x395bbb['top']-_0x27bddb[_0x193146(0xcbe)]+'px',_0x49fbb2[_0x193146(0x105d)][_0x193146(0x9e2)]=_0x395bbb[_0x193146(0x9e2)]-_0x27bddb[_0x193146(0x9e2)]+'px',_0x49fbb2[_0x193146(0x105d)][_0x193146(0x404)]='';}_0x3f6e5d['preventDefault']();const _0x58c962=_0x3f6e5d[_0x193146(0x52a)]==='touchstart'?_0x3f6e5d[_0x193146(0xc01)][0x0]:_0x3f6e5d;_0x933aa5=_0x58c962['clientX'],_0x4800f2=_0x58c962[_0x193146(0xd20)],document[_0x193146(0x205)](_0x193146(0xacf),_0x17e10b),document[_0x193146(0x205)](_0x193146(0x538),_0x4bbf7a),document[_0x193146(0x205)]('touchend',_0x17e10b),document[_0x193146(0x205)](_0x193146(0xe66),_0x4bbf7a);},_0x4bbf7a=_0x7b4c77=>{const _0x41366a=_0x280438,_0x418fa4=_0x7b4c77[_0x41366a(0x52a)]==='touchmove'?_0x7b4c77[_0x41366a(0xc01)][0x0]:_0x7b4c77;_0x142d35=_0x933aa5-_0x418fa4[_0x41366a(0x86f)],_0x5aba41=_0x4800f2-_0x418fa4[_0x41366a(0xd20)],_0x933aa5=_0x418fa4[_0x41366a(0x86f)],_0x4800f2=_0x418fa4[_0x41366a(0xd20)];let _0x4bef03=_0x49fbb2[_0x41366a(0xa2f)]-_0x5aba41,_0x438aad=_0x49fbb2[_0x41366a(0x75a)]-_0x142d35;const _0x34ab22=_0x454806[_0x41366a(0xe53)]-_0x49fbb2[_0x41366a(0x1a0)]-0xa,_0x5a6394=_0x454806[_0x41366a(0x9dd)]-_0x49fbb2[_0x41366a(0xeba)]-0xa;_0x4bef03=Math[_0x41366a(0xbf8)](0xa,Math[_0x41366a(0x755)](_0x4bef03,_0x34ab22)),_0x438aad=Math[_0x41366a(0xbf8)](0xa,Math['min'](_0x438aad,_0x5a6394)),_0x49fbb2[_0x41366a(0x105d)][_0x41366a(0xcbe)]=_0x4bef03+'px',_0x49fbb2[_0x41366a(0x105d)][_0x41366a(0x9e2)]=_0x438aad+'px';},_0x17e10b=()=>{const _0x50112b=_0x280438;document['removeEventListener'](_0x50112b(0xacf),_0x17e10b),document[_0x50112b(0xb52)](_0x50112b(0x538),_0x4bbf7a),document[_0x50112b(0xb52)](_0x50112b(0x706),_0x17e10b),document[_0x50112b(0xb52)]('touchmove',_0x4bbf7a);};_0xe1b998[_0x280438(0x205)]('mousedown',_0x407692),_0xe1b998[_0x280438(0x205)](_0x280438(0x4b1),_0x407692);}function _0x2196ac(_0x18600f){const _0x10f246=_0x247bea,_0x3e1698=_0x32d3a1[_0x18600f];if(!_0x3e1698)return;const _0xf7ef7c=document[_0x10f246(0xc33)](_0x10f246(0x11c6)),_0x532824=document[_0x10f246(0xc33)](_0x10f246(0xa0c)),_0x4c11a1=document[_0x10f246(0xc33)]('page-indicator'),_0x131059=document[_0x10f246(0xc33)](_0x10f246(0x1155)),_0x18017e=document['getElementById'](_0x10f246(0xb5a));_0xf7ef7c[_0x10f246(0x11b0)]=_0x3e1698[_0x10f246(0x874)];if(_0x3e1698[_0x10f246(0x456)][_0x10f246(0x79b)]===0x0)_0x532824[_0x10f246(0x102a)]=_0x10f246(0xeec),_0x3e1698[_0x10f246(0x73c)]=0x0,_0x3e1698[_0x10f246(0x838)]=0x0;else{const _0x2bb045=_0x3e1698['currentPage']*_0x3e1698[_0x10f246(0x42c)],_0x4943cb=_0x2bb045+_0x3e1698['linesPerPage'];_0x532824['textContent']=_0x3e1698['contentLines'][_0x10f246(0x111c)](_0x2bb045,_0x4943cb)[_0x10f246(0x100b)]('\x0a');}_0x4c11a1[_0x10f246(0x11b0)]=_0x3e1698[_0x10f246(0x838)]+0x1+'\x20/\x20'+_0x3e1698['totalPages'],_0x131059['disabled']=_0x3e1698['currentPage']===0x0,_0x18017e[_0x10f246(0xfd8)]=_0x3e1698[_0x10f246(0x838)]>=_0x3e1698[_0x10f246(0x73c)]-0x1;}function _0x3989b6(){const _0x510d7e=_0x247bea,_0x4c645b=_0x32d3a1[_0x12493e['activeChatId']];_0x4c645b&&_0x4c645b[_0x510d7e(0x838)]<_0x4c645b[_0x510d7e(0x73c)]-0x1&&(_0x4c645b[_0x510d7e(0x838)]++,_0x2196ac(_0x12493e[_0x510d7e(0x7bc)]),document[_0x510d7e(0xc33)](_0x510d7e(0xa0c))['scrollTop']=0x0,_0x42b7ff(_0x4c645b[_0x510d7e(0x656)],_0x4c645b[_0x510d7e(0x838)]));}async function _0x14cf13(){const _0x52a2a5=_0x247bea,_0x3c181d=_0x32d3a1[_0x12493e['activeChatId']];_0x3c181d&&_0x3c181d[_0x52a2a5(0x838)]>0x0&&(_0x3c181d[_0x52a2a5(0x838)]--,_0x2196ac(_0x12493e[_0x52a2a5(0x7bc)]),document[_0x52a2a5(0xc33)](_0x52a2a5(0xa0c))[_0x52a2a5(0x1244)]=0x0,await _0x42b7ff(_0x3c181d[_0x52a2a5(0x656)],_0x3c181d[_0x52a2a5(0x838)]),await notifyAiOfPageTurn(_0x12493e[_0x52a2a5(0x7bc)],_0x3c181d));}function _0x5a8bac(){const _0x14b06e=_0x247bea;document['getElementById'](_0x14b06e(0x8e2))['click']();}async function _0x5379fe(_0x1ba0ed){const _0x5c7f79=_0x247bea,_0x4ac46a=new Uint8Array(_0x1ba0ed);if(_0x4ac46a[_0x5c7f79(0x79b)]>=0x3&&_0x4ac46a[0x0]===0xef&&_0x4ac46a[0x1]===0xbb&&_0x4ac46a[0x2]===0xbf)return console[_0x5c7f79(0x51f)](_0x5c7f79(0x642)),new TextDecoder(_0x5c7f79(0x67e))[_0x5c7f79(0x291)](_0x4ac46a);if(_0x4ac46a['length']>=0x2&&_0x4ac46a[0x0]===0xff&&_0x4ac46a[0x1]===0xfe)return console[_0x5c7f79(0x51f)](_0x5c7f79(0x522)),new TextDecoder('utf-16le')['decode'](_0x4ac46a);if(_0x4ac46a[_0x5c7f79(0x79b)]>=0x2&&_0x4ac46a[0x0]===0xfe&&_0x4ac46a[0x1]===0xff)return console[_0x5c7f79(0x51f)](_0x5c7f79(0x9ae)),new TextDecoder(_0x5c7f79(0x11cc))['decode'](_0x4ac46a);try{console[_0x5c7f79(0x51f)](_0x5c7f79(0xcc5));const _0x463958=new TextDecoder(_0x5c7f79(0x67e),{'fatal':!![]})['decode'](_0x4ac46a);return console[_0x5c7f79(0x51f)](_0x5c7f79(0x932)),_0x463958;}catch(_0x5f599c){console[_0x5c7f79(0x51f)](_0x5c7f79(0x11e5));try{const _0x1d5739=new TextDecoder(_0x5c7f79(0xa52))[_0x5c7f79(0x291)](_0x4ac46a);return console[_0x5c7f79(0x51f)](_0x5c7f79(0x5e8)),_0x1d5739;}catch(_0x85ed8f){console[_0x5c7f79(0x4d9)](_0x5c7f79(0xf68),_0x85ed8f);throw new Error(_0x5c7f79(0x53a));}}}async function _0xd8cbe9(_0x4af4ee){const _0x246278=_0x247bea,_0x35d4a8=_0x4af4ee[_0x246278(0xe16)]['files'][0x0];if(!_0x35d4a8)return;try{const _0x5d29c7=await _0x35d4a8['arrayBuffer'](),_0x9bbe66=await _0x5379fe(_0x5d29c7),_0x1cf383=_0x35d4a8['name']['replace'](/\.txt$/i,''),_0x260446=await _0x2a2987[_0x246278(0x1f0)]['add']({'title':_0x1cf383,'content':_0x9bbe66,'lastOpened':Date['now']()});await _0x292f47(_0x260446),document['getElementById'](_0x246278(0x122c))['classList'][_0x246278(0x3af)](_0x246278(0x143))&&_0x1643a2();}catch(_0x4ce336){console['error'](_0x246278(0x77),_0x4ce336),await _0x2d7ddd('导入失败',_0x4ce336[_0x246278(0xf93)]);}finally{_0x4af4ee[_0x246278(0xe16)][_0x246278(0x22a)]=null;}}async function _0x2a44db(){const _0x3408e6=_0x247bea,_0x136b8b=_0x12493e[_0x3408e6(0x7bc)];if(!_0x136b8b)return;const _0x495fc7=_0x32d3a1[_0x136b8b];if(!_0x495fc7||_0x495fc7[_0x3408e6(0x73c)]<=0x1)return;const _0x39f34a=await _0x1ca09c(_0x3408e6(0x596),_0x3408e6(0x258)+_0x495fc7['totalPages']+')',_0x495fc7['currentPage']+0x1);if(_0x39f34a===null)return;const _0x19bf93=parseInt(_0x39f34a);if(isNaN(_0x19bf93)||_0x19bf93<0x1||_0x19bf93>_0x495fc7[_0x3408e6(0x73c)]){alert('请输入一个有效的页码！');return;}_0x495fc7[_0x3408e6(0x838)]=_0x19bf93-0x1,_0x2196ac(_0x136b8b),_0x42b7ff(_0x495fc7['activeBookId'],_0x495fc7['currentPage']);}async function _0x42b7ff(_0x282afa,_0x59bcc2){const _0x5699aa=_0x247bea;if(!_0x282afa)return;try{await _0x2a2987['readingLibrary']['update'](_0x282afa,{'currentPage':_0x59bcc2});}catch(_0x18e88e){console[_0x5699aa(0x4d9)](_0x5699aa(0x1d1)+_0x282afa+_0x5699aa(0xc4c),_0x18e88e);}}async function _0x3989b6(){const _0x5b7849=_0x247bea,_0x5054ad=_0x32d3a1[_0x12493e[_0x5b7849(0x7bc)]];_0x5054ad&&_0x5054ad[_0x5b7849(0x838)]<_0x5054ad[_0x5b7849(0x73c)]-0x1&&(_0x5054ad[_0x5b7849(0x838)]++,_0x2196ac(_0x12493e[_0x5b7849(0x7bc)]),document[_0x5b7849(0xc33)](_0x5b7849(0xa0c))[_0x5b7849(0x1244)]=0x0,await _0x42b7ff(_0x5054ad[_0x5b7849(0x656)],_0x5054ad[_0x5b7849(0x838)]),await notifyAiOfPageTurn(_0x12493e[_0x5b7849(0x7bc)],_0x5054ad));}function _0x224cfd(_0x3f7a9d,_0xc7aad2){const _0x5dcca9=_0x247bea,_0x3cb0a2=_0x12493e['activeChatId'];if(!_0x3cb0a2)return;const _0x1fa64f=_0x32d3a1[_0x3cb0a2];_0x1fa64f[_0x5dcca9(0x874)]=_0x3f7a9d[_0x5dcca9(0xc12)](/\.txt$/i,''),_0x1fa64f['contentLines']=_0xc7aad2[_0x5dcca9(0x8d7)](/\r\n?|\n/)[_0x5dcca9(0x9d5)](_0xcd4f6f=>_0xcd4f6f[_0x5dcca9(0xc12)](/ +/g,'\x20')),_0x1fa64f[_0x5dcca9(0x73c)]=Math['ceil'](_0x1fa64f[_0x5dcca9(0x456)][_0x5dcca9(0x79b)]/_0x1fa64f['linesPerPage']),_0x1fa64f['currentPage']=0x0,_0x2196ac(_0x3cb0a2);}async function _0x261d44(){const _0x50464c=_0x247bea;document[_0x50464c(0xc33)](_0x50464c(0x104a))[_0x50464c(0x22a)]='',await _0x1643a2(),document[_0x50464c(0xc33)]('reading-library-modal')[_0x50464c(0x10d3)][_0x50464c(0xb9)](_0x50464c(0x143));}async function _0x1643a2(_0x3e2471=''){const _0x4798a8=_0x247bea,_0x27cb4b=document[_0x4798a8(0xc33)]('reading-library-list');let _0x2a384e=await _0x2a2987[_0x4798a8(0x1f0)][_0x4798a8(0xde3)]('lastOpened')[_0x4798a8(0xc07)]()['toArray']();_0x27cb4b[_0x4798a8(0x102a)]='';_0x3e2471&&(_0x2a384e=_0x2a384e[_0x4798a8(0x1054)](_0x31bfd3=>_0x31bfd3['title'][_0x4798a8(0x963)]()['includes'](_0x3e2471[_0x4798a8(0x963)]())));if(_0x2a384e[_0x4798a8(0x79b)]===0x0){const _0x47043a=_0x3e2471?'找不到匹配的书籍':_0x4798a8(0x2b6);_0x27cb4b['innerHTML']='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>'+_0x47043a+'</p>';return;}_0x2a384e['forEach'](_0x3f991a=>{const _0x4f755b=_0x4798a8,_0x5cd1e3=document['createElement']('div');_0x5cd1e3['className']=_0x4f755b(0x1151),_0x5cd1e3['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22\x20style=\x22cursor:pointer;\x22\x20data-book-id=\x22'+_0x3f991a['id']+'\x22>'+_0x3f991a[_0x4f755b(0x874)]+_0x4f755b(0xab2)+_0x3f991a['id']+_0x4f755b(0x263),_0x27cb4b['appendChild'](_0x5cd1e3);});}async function _0x292f47(_0x8865f2){const _0xd9cee5=_0x247bea,_0x12da1f=_0x12493e[_0xd9cee5(0x7bc)];if(!_0x12da1f)return;const _0x88e418=await _0x2a2987[_0xd9cee5(0x1f0)][_0xd9cee5(0xec0)](_0x8865f2);if(!_0x88e418){alert(_0xd9cee5(0xebf));return;}await _0x2a2987[_0xd9cee5(0x1f0)]['update'](_0x8865f2,{'lastOpened':Date[_0xd9cee5(0x6ee)]()});const _0x593cfb=_0x32d3a1[_0x12da1f];_0x593cfb['activeBookId']=_0x8865f2,_0x593cfb['title']=_0x88e418['title'],_0x593cfb[_0xd9cee5(0x456)]=_0x88e418['content'][_0xd9cee5(0x8d7)](/\r\n?|\n/)[_0xd9cee5(0x9d5)](_0x6a318c=>_0x6a318c[_0xd9cee5(0xc12)](/ +/g,'\x20')),_0x593cfb['totalPages']=Math['ceil'](_0x593cfb[_0xd9cee5(0x456)][_0xd9cee5(0x79b)]/_0x593cfb[_0xd9cee5(0x42c)]),_0x593cfb[_0xd9cee5(0x838)]=_0x88e418[_0xd9cee5(0x838)]||0x0,_0x2196ac(_0x12da1f),document[_0xd9cee5(0xc33)](_0xd9cee5(0xa0c))[_0xd9cee5(0x1244)]=0x0,document[_0xd9cee5(0xc33)](_0xd9cee5(0x122c))[_0xd9cee5(0x10d3)][_0xd9cee5(0x2c7)](_0xd9cee5(0x143));}async function _0x64fe75(_0x45518e){const _0x3b5ae1=_0x247bea,_0x126edd=await _0x2a2987[_0x3b5ae1(0x1f0)][_0x3b5ae1(0xec0)](_0x45518e);if(!_0x126edd)return;const _0x36037e=await _0x270512('删除书籍',_0x3b5ae1(0xc04)+_0x126edd['title']+'》吗？',{'confirmButtonClass':_0x3b5ae1(0xa2)});_0x36037e&&(await _0x2a2987[_0x3b5ae1(0x1f0)]['delete'](_0x45518e),await _0x1643a2());}function _0x224cfd(_0x2081f6,_0xb7d21b){const _0x2f1ed1=_0x247bea,_0x5a5779=_0x12493e[_0x2f1ed1(0x7bc)];if(!_0x5a5779)return;const _0x530a52=_0x32d3a1[_0x5a5779];_0x530a52[_0x2f1ed1(0x874)]=_0x2081f6[_0x2f1ed1(0xc12)](/\.txt$/i,''),_0x530a52[_0x2f1ed1(0x456)]=_0xb7d21b[_0x2f1ed1(0x8d7)](/\r\n?|\n/),_0x530a52[_0x2f1ed1(0x73c)]=Math[_0x2f1ed1(0xeb0)](_0x530a52[_0x2f1ed1(0x456)][_0x2f1ed1(0x79b)]/_0x530a52['linesPerPage']),_0x530a52[_0x2f1ed1(0x838)]=0x0,_0x2196ac(_0x5a5779);}function _0x30b834(_0x511075,_0xc1a930){const _0x22b683=_0x247bea;let _0x1211d1=0x0,_0x1d1a56=0x0,_0x118d5b=0x0,_0x1126e9=0x0,_0x36aa5d=![],_0x1bd301=![];const _0x255ba9=document[_0x22b683(0xc33)](_0x22b683(0x779)),_0x3226cb=_0x10b4dd=>{const _0x2a80b7=_0x22b683;if(_0x511075!==_0xc1a930&&_0x10b4dd['target']['closest'](_0x2a80b7(0xeb1)))return;_0x36aa5d=!![],_0x1bd301=![];const _0x428581=_0x10b4dd[_0x2a80b7(0x52a)]===_0x2a80b7(0x4b1)?_0x10b4dd['touches'][0x0]:_0x10b4dd;_0x118d5b=_0x428581['clientX'],_0x1126e9=_0x428581['clientY'],_0x511075['style'][_0x2a80b7(0xcbe)]=_0x511075[_0x2a80b7(0xa2f)]+'px',_0x511075[_0x2a80b7(0x105d)][_0x2a80b7(0x9e2)]=_0x511075[_0x2a80b7(0x75a)]+'px',_0x511075[_0x2a80b7(0x105d)]['transform']='',document['addEventListener'](_0x2a80b7(0xacf),_0x228d9a),document[_0x2a80b7(0x205)](_0x2a80b7(0x538),_0x4a61f3),document[_0x2a80b7(0x205)](_0x2a80b7(0x706),_0x228d9a),document[_0x2a80b7(0x205)](_0x2a80b7(0xe66),_0x4a61f3,{'passive':![]});},_0x4a61f3=_0x27f45f=>{const _0x28c44d=_0x22b683;if(!_0x36aa5d)return;const _0x5b3c14=_0x27f45f['type']===_0x28c44d(0xe66)?_0x27f45f['touches'][0x0]:_0x27f45f,_0x26acbe=_0x5b3c14[_0x28c44d(0x86f)]-_0x118d5b,_0x21e132=_0x5b3c14[_0x28c44d(0xd20)]-_0x1126e9;!_0x1bd301&&(Math[_0x28c44d(0x2e0)](_0x26acbe)>0x5||Math[_0x28c44d(0x2e0)](_0x21e132)>0x5)&&(_0x1bd301=!![]);_0x1bd301&&_0x27f45f[_0x28c44d(0x585)]&&_0x27f45f[_0x28c44d(0xe8)]();_0x1211d1=_0x118d5b-_0x5b3c14[_0x28c44d(0x86f)],_0x1d1a56=_0x1126e9-_0x5b3c14['clientY'],_0x118d5b=_0x5b3c14['clientX'],_0x1126e9=_0x5b3c14[_0x28c44d(0xd20)];let _0x4c1fc0=_0x511075[_0x28c44d(0xa2f)]-_0x1d1a56,_0x96dd69=_0x511075[_0x28c44d(0x75a)]-_0x1211d1;const _0x1e89e7=_0x255ba9[_0x28c44d(0xe53)]-_0x511075[_0x28c44d(0x1a0)]-0xa,_0x139f86=_0x255ba9[_0x28c44d(0x9dd)]-_0x511075[_0x28c44d(0xeba)]-0xa;_0x4c1fc0=Math[_0x28c44d(0xbf8)](0xa,Math['min'](_0x4c1fc0,_0x1e89e7)),_0x96dd69=Math[_0x28c44d(0xbf8)](0xa,Math['min'](_0x96dd69,_0x139f86)),_0x511075[_0x28c44d(0x105d)]['top']=_0x4c1fc0+'px',_0x511075[_0x28c44d(0x105d)][_0x28c44d(0x9e2)]=_0x96dd69+'px';},_0x228d9a=()=>{const _0x2386d8=_0x22b683;document[_0x2386d8(0xb52)](_0x2386d8(0xacf),_0x228d9a),document[_0x2386d8(0xb52)](_0x2386d8(0x538),_0x4a61f3),document[_0x2386d8(0xb52)]('touchend',_0x228d9a),document['removeEventListener'](_0x2386d8(0xe66),_0x4a61f3);if(!_0x36aa5d)return;_0x36aa5d=![],!_0x1bd301&&_0x511075[_0x2386d8(0x335)]();};_0xc1a930['addEventListener'](_0x22b683(0x9e6),_0x3226cb),_0xc1a930[_0x22b683(0x205)]('touchstart',_0x3226cb,{'passive':![]});}function _0x21470b(){const _0x20a476=_0x247bea,_0x26568d=_0x32d3a1[_0x12493e['activeChatId']];if(!_0x26568d||!_0x26568d[_0x20a476(0x1f3)])return;document[_0x20a476(0xc33)]('reading-window')['classList'][_0x20a476(0xb9)](_0x20a476(0x1184)),document[_0x20a476(0xc33)]('reading-restore-btn')[_0x20a476(0x105d)]['display']=_0x20a476(0x21a),_0x26568d[_0x20a476(0x8cc)]=!![];}function _0x4ff2d4(){const _0x4a2a39=_0x247bea,_0x590b5a=_0x32d3a1[_0x12493e[_0x4a2a39(0x7bc)]];if(!_0x590b5a||!_0x590b5a[_0x4a2a39(0x1f3)])return;document[_0x4a2a39(0xc33)](_0x4a2a39(0x896))['style'][_0x4a2a39(0xf44)]=_0x4a2a39(0x854),document[_0x4a2a39(0xc33)]('reading-window')[_0x4a2a39(0x10d3)][_0x4a2a39(0x2c7)]('minimized'),_0x590b5a[_0x4a2a39(0x8cc)]=![];}function _0x399486(_0xf86803,_0x5ef0b4){let _0x5e3fcc;return function(..._0x570c4f){const _0x21ec08=_0x26e9,_0x1915c8=this;clearTimeout(_0x5e3fcc),_0x5e3fcc=setTimeout(()=>_0xf86803[_0x21ec08(0x7e)](_0x1915c8,_0x570c4f),_0x5ef0b4);};}function _0x2ef697(_0x6c72cf){const _0xaa4cad=_0x247bea,_0x4e8567=_0x32d3a1[_0x6c72cf];if(!_0x4e8567||!_0x4e8567['isActive'])return'';const _0xa7ffa5=_0x4e8567[_0xaa4cad(0x874)]||_0xaa4cad(0x472);let _0x400ffd='',_0xd5e4da='';if(_0x4e8567['currentSnippet']&&_0x4e8567[_0xaa4cad(0x6cb)]['trim']())_0x400ffd=_0x4e8567[_0xaa4cad(0x6cb)],_0xd5e4da='你正在阅读的段落';else{if(_0x4e8567['contentLines'][_0xaa4cad(0x79b)]>0x0){const _0xbc612=_0x4e8567[_0xaa4cad(0x838)]*_0x4e8567[_0xaa4cad(0x42c)],_0x21a68f=_0xbc612+_0x4e8567[_0xaa4cad(0x42c)];_0x400ffd=_0x4e8567[_0xaa4cad(0x456)][_0xaa4cad(0x111c)](_0xbc612,_0x21a68f)[_0xaa4cad(0x100b)]('\x0a')[_0xaa4cad(0x1033)](0x0,0xc8),_0xd5e4da=_0xaa4cad(0x4f2);}else _0x400ffd=_0xaa4cad(0x1186),_0xd5e4da='内容';}return _0xaa4cad(0x734)+_0xa7ffa5+_0xaa4cad(0x902)+_0xd5e4da+_0xaa4cad(0x221)+_0x400ffd+'...\x22\x0a\x20\x20\x20\x20#一起读书模式\x20|\x20行为铁律\x0a\x20\x20\x20\x201.\x20\x20**角色定位**:\x20你【不是】书中的任何角色，你是【你自己】('+(_0x12493e[_0xaa4cad(0xc45)][_0x6c72cf]?.['originalName']||_0xaa4cad(0x106b))+')，正在和用户一起【阅读和讨论】这本书。\x0a\x20\x20\x20\x202.\x20\x20**行为准则**:\x20你的回复【必须】是作为读者的【感想、评论、提问或联想】。你可以：\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20分享你对当前段落的看法。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20对书中的角色或情节发表评论。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20向用户提问，询问TA对内容的看法。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20根据书本内容，联想到你自己的经历或记忆。\x0a\x20\x20\x20\x203.\x20\x20**严禁**:\x20你的回复【绝对禁止】使用书中角色的口吻和人称！【绝对禁止】扮演书中的任何角色！【绝对禁止】续写或模仿书中的情节！你必须时刻记住，你只是一个读者。\x20\x20\x20\x20\x0a';}function _0x5e6523(){const _0x3f893a=_0x247bea,_0x55be6f=_0x12493e['activeChatId'];if(!_0x55be6f||!_0x32d3a1[_0x55be6f])return;const _0x19b51e=_0x32d3a1[_0x55be6f],_0x11f217=document[_0x3f893a(0xc33)](_0x3f893a(0xa0c)),_0x31d802=_0x11f217[_0x3f893a(0x1244)],_0x4fb01b=_0x11f217[_0x3f893a(0xe53)],_0x2f1f58=_0x31d802+_0x4fb01b,_0x47a372=0xf*1.8,_0x338f89=Math[_0x3f893a(0xcb5)](_0x31d802/_0x47a372),_0x240fbb=Math[_0x3f893a(0xeb0)](_0x2f1f58/_0x47a372),_0x365512=_0x19b51e['currentPage']*_0x19b51e[_0x3f893a(0x42c)]+_0x338f89,_0x1b2378=_0x19b51e['currentPage']*_0x19b51e[_0x3f893a(0x42c)]+_0x240fbb;if(_0x365512<0x0||_0x365512>=_0x19b51e['contentLines'][_0x3f893a(0x79b)])return;const _0x179c2f=_0x19b51e[_0x3f893a(0x456)][_0x3f893a(0x111c)](Math[_0x3f893a(0xbf8)](0x0,_0x365512),Math[_0x3f893a(0x755)](_0x19b51e[_0x3f893a(0x456)][_0x3f893a(0x79b)],_0x1b2378))[_0x3f893a(0x100b)]('\x0a');_0x19b51e['currentSnippet']=_0x179c2f;}function _0x338f9e(){const _0x422aa0=_0x247bea,_0x27fa03=document[_0x422aa0(0xc33)](_0x422aa0(0x4b4));if(_0x27fa03){const _0x232fa2=_0x27fa03[_0x422aa0(0x193)]();_0x232fa2!==undefined&&_0x232fa2['then'](_0x6882d7=>{const _0x582c9e=_0x422aa0;console[_0x582c9e(0x51f)](_0x582c9e(0xdb2));})[_0x422aa0(0x876)](_0x217308=>{const _0x161950=_0x422aa0;console[_0x161950(0x54a)](_0x161950(0xa57),_0x217308);});}}function _0x375e7d(){const _0xc8c867=_0x247bea,_0x110888=document[_0xc8c867(0xc33)](_0xc8c867(0x4b4));_0x110888&&!_0x110888[_0xc8c867(0x10b0)]&&(_0x110888[_0xc8c867(0x47a)](),_0x110888[_0xc8c867(0x10ba)]=0x0,console[_0xc8c867(0x51f)](_0xc8c867(0xa4a)));}async function _0x81746a(_0x2610c4){const _0x895eb0=_0x247bea,_0x31199e=decodeURIComponent(_0x2610c4[_0x895eb0(0x85)][_0x895eb0(0x996)]),_0x3ba210=_0x2610c4[_0x895eb0(0x85)]['voiceId'],_0x522521=_0x2610c4[_0x895eb0(0x977)](_0x895eb0(0x10aa)),_0x446974=_0x2610c4['querySelector']('.loading-spinner'),_0x379cec=document[_0x895eb0(0xc33)](_0x895eb0(0x5a6));if(!_0x379cec[_0x895eb0(0x10b0)]&&_0x379cec[_0x895eb0(0x85)][_0x895eb0(0x618)]===_0x31199e&&_0x379cec[_0x895eb0(0x85)]['currentVoiceId']===_0x3ba210){_0x379cec[_0x895eb0(0x47a)]();return;}_0x379cec[_0x895eb0(0x47a)](),document[_0x895eb0(0x67a)](_0x895eb0(0x10aa))['forEach'](_0x5536d9=>_0x5536d9[_0x895eb0(0x11b0)]='▶');const _0x4d8998=_0x895eb0(0xba0)+_0x3ba210+'_'+_0x31199e;let _0x5f2aac=_0x12493e[_0x895eb0(0x1108)][_0x895eb0(0xec0)](_0x4d8998);if(_0x5f2aac){console[_0x895eb0(0x51f)](_0x895eb0(0xc3b)),await _0x2a7201(_0x5f2aac['url'],_0x5f2aac['type'],_0x31199e,_0x3ba210,_0x2610c4);return;}console['log'](_0x895eb0(0x92a));if(_0x522521)_0x522521[_0x895eb0(0x105d)][_0x895eb0(0xf44)]=_0x895eb0(0x854);_0x446974[_0x895eb0(0x105d)]['display']=_0x895eb0(0xa20);const {minimaxGroupId:_0x3fb8ab,minimaxApiKey:_0x30ff16}=_0x12493e['apiConfig'];if(!_0x3fb8ab||!_0x30ff16){await _0x2d7ddd(_0x895eb0(0x26b),_0x895eb0(0x94c)),_0x446974[_0x895eb0(0x105d)][_0x895eb0(0xf44)]='none';if(_0x522521)_0x522521[_0x895eb0(0x105d)]['display']=_0x895eb0(0x21a);return;}try{const _0x5b7fc8=await fetch(_0x895eb0(0x11e8)+_0x3fb8ab,{'method':_0x895eb0(0x90),'headers':{'Authorization':'Bearer\x20'+_0x30ff16,'Content-Type':_0x895eb0(0xd74)},'body':JSON[_0x895eb0(0xd27)]({'text':_0x31199e,'voice_id':_0x3ba210,'model':_0x12493e[_0x895eb0(0xdd4)][_0x895eb0(0x433)]||_0x895eb0(0x10de),'speed':0x1,'vol':0x1,'pitch':0x0})});if(!_0x5b7fc8['ok']){let _0x2b1347=_0x895eb0(0x369)+_0x5b7fc8[_0x895eb0(0xbc8)];try{const _0x21a644=await _0x5b7fc8[_0x895eb0(0x79e)]();_0x2b1347=_0x21a644[_0x895eb0(0x2bf)]?.[_0x895eb0(0x185)]||JSON['stringify'](_0x21a644);}catch(_0x211757){_0x2b1347=await _0x5b7fc8[_0x895eb0(0x996)]();}throw new Error(_0x2b1347);}const _0x484b53=await _0x5b7fc8[_0x895eb0(0xed)](),_0x4a21db=URL[_0x895eb0(0xca2)](_0x484b53);await _0x2a7201(_0x4a21db,_0x484b53[_0x895eb0(0x52a)],_0x31199e,_0x3ba210,_0x2610c4);const _0x123b2f=new FileReader();_0x123b2f[_0x895eb0(0xebd)]=function(){const _0x2ea819=_0x895eb0;_0x12493e[_0x2ea819(0x1108)][_0x2ea819(0xdf)](_0x4d8998,{'url':_0x123b2f[_0x2ea819(0x129)],'type':_0x484b53['type']}),console[_0x2ea819(0x51f)](_0x2ea819(0x113d));},_0x123b2f[_0x895eb0(0xbcf)](_0x484b53);}catch(_0xd89976){console['error']('Minimax\x20TTS\x20API\x20调用失败:',_0xd89976),await _0x2d7ddd(_0x895eb0(0xf66),_0x895eb0(0xa56)+_0xd89976['message']);}finally{_0x446974[_0x895eb0(0x105d)]['display']=_0x895eb0(0x854);if(_0x522521)_0x522521['style'][_0x895eb0(0xf44)]=_0x895eb0(0x21a);}}function _0x2a7201(_0x22efa3,_0x431717,_0x21756a,_0x1a63e1,_0x39acae){return new Promise((_0x334990,_0x40b729)=>{const _0x4144d2=_0x26e9,_0x34d63e=document[_0x4144d2(0xc33)](_0x4144d2(0x5a6));_0x34d63e[_0x4144d2(0x87b)]=_0x22efa3,_0x34d63e['type']=_0x431717,_0x34d63e[_0x4144d2(0x85)][_0x4144d2(0x618)]=_0x21756a,_0x34d63e['dataset'][_0x4144d2(0xc57)]=_0x1a63e1;const _0xa30935=_0x34d63e[_0x4144d2(0x193)]();_0xa30935!==undefined&&_0xa30935[_0x4144d2(0x5d2)](()=>{const _0x5cc0d5=_0x4144d2,_0x33bbcc=_0x39acae[_0x5cc0d5(0x977)](_0x5cc0d5(0x10aa));if(_0x33bbcc)_0x33bbcc[_0x5cc0d5(0x11b0)]='❚❚';_0x334990();})[_0x4144d2(0x876)](_0x59d912=>{const _0x5f3ebb=_0x4144d2;console[_0x5f3ebb(0x4d9)](_0x5f3ebb(0x3a9),_0x59d912),_0x40b729(_0x59d912);}),_0x34d63e[_0x4144d2(0xec3)]=()=>{const _0xaabffc=_0x4144d2,_0x2d09ce=_0x39acae[_0xaabffc(0x977)]('.voice-play-btn');if(_0x2d09ce)_0x2d09ce[_0xaabffc(0x11b0)]='▶';},_0x34d63e[_0x4144d2(0x58b)]=()=>{const _0x690eaf=_0x4144d2,_0x541bfc=_0x39acae[_0x690eaf(0x977)](_0x690eaf(0x10aa));if(_0x541bfc)_0x541bfc[_0x690eaf(0x11b0)]='▶';};});}function _0x781d6(_0x490078){const _0x2bb659=_0x247bea,_0x17db1c=_0x490078[_0x2bb659(0x7a7)](_0x2bb659(0x689));if(!_0x17db1c)return;const _0x5a2d03=_0x17db1c[_0x2bb659(0x977)](_0x2bb659(0xf08)),_0x2cfbfd=decodeURIComponent(_0x490078[_0x2bb659(0x85)]['text']);_0x5a2d03['style'][_0x2bb659(0xf44)]===_0x2bb659(0xa20)?_0x5a2d03[_0x2bb659(0x105d)][_0x2bb659(0xf44)]=_0x2bb659(0x854):(_0x5a2d03[_0x2bb659(0x11b0)]=_0x2cfbfd,_0x5a2d03[_0x2bb659(0x105d)][_0x2bb659(0xf44)]=_0x2bb659(0xa20));}async function _0x4805d5(){const _0x4f174f=_0x247bea;await _0x13afce(),document['getElementById'](_0x4f174f(0xc84))['classList'][_0x4f174f(0xb9)](_0x4f174f(0x143));}async function _0x13afce(){const _0x37ca74=_0x247bea,_0x4fa5c7=document[_0x37ca74(0xc33)](_0x37ca74(0x89)),_0x352843=await _0x2a2987['shoppingCategories'][_0x37ca74(0xf15)]();_0x4fa5c7[_0x37ca74(0x102a)]='';if(_0x352843[_0x37ca74(0x79b)]===0x0){_0x4fa5c7[_0x37ca74(0x102a)]=_0x37ca74(0xc8f);return;}_0x352843[_0x37ca74(0xd6a)](_0x5c4213=>{const _0x4494ae=_0x37ca74,_0x4eca99=document['createElement']('div');_0x4eca99[_0x4494ae(0x84)]=_0x4494ae(0x1151),_0x4eca99['innerHTML']=_0x4494ae(0x3d9)+_0x5c4213[_0x4494ae(0x578)]+_0x4494ae(0xd51)+_0x5c4213['id']+_0x4494ae(0xafb),_0x4fa5c7[_0x4494ae(0xf77)](_0x4eca99);});}async function _0x199281(){const _0x35253b=_0x247bea,_0x550f01=document[_0x35253b(0xc33)](_0x35253b(0xce5)),_0x1251e7=_0x550f01[_0x35253b(0x22a)][_0x35253b(0x7da)]();if(!_0x1251e7)return alert(_0x35253b(0xa2c));const _0x43431f=await _0x2a2987['shoppingCategories'][_0x35253b(0x8b5)](_0x35253b(0x578))[_0x35253b(0x10bd)](_0x1251e7)[_0x35253b(0x4e3)]();if(_0x43431f)return alert(_0x35253b(0xbe3)+_0x1251e7+_0x35253b(0xe85));await _0x2a2987['shoppingCategories'][_0x35253b(0xb9)]({'name':_0x1251e7}),_0x550f01['value']='',await _0x13afce();}async function _0x4c57bc(_0x1ef8ad){const _0x121998=_0x247bea,_0x4f411d=await _0x270512(_0x121998(0x8d6),_0x121998(0x22b),{'confirmButtonClass':_0x121998(0xa2)});_0x4f411d&&(await _0x2a2987['shoppingCategories'][_0x121998(0x9ea)](_0x1ef8ad),await _0x2a2987[_0x121998(0x6b4)][_0x121998(0x8b5)](_0x121998(0x305))[_0x121998(0x10bd)](_0x1ef8ad)['modify']({'categoryId':null}),await _0x13afce());}function _0x376ab0(_0x5378f2={}){const _0x1382ae=_0x247bea,_0x581735=document[_0x1382ae(0xc33)]('product-variations-container'),_0x3d7213=document['createElement'](_0x1382ae(0x58c));return _0x3d7213[_0x1382ae(0x84)]=_0x1382ae(0xb08),_0x3d7213[_0x1382ae(0x102a)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此款式\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20grid;\x20grid-template-columns:\x201fr\x201fr;\x20gap:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>款式名称</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22variation-name-input\x22\x20placeholder=\x22例如:\x20红色\x22\x20value=\x22'+(_0x5378f2['name']||'')+_0x1382ae(0xdf5)+(_0x5378f2[_0x1382ae(0xae2)]||'')+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>款式图片\x20(可选)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22avatar-upload\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20class=\x22variation-image-preview\x22\x20src=\x22'+(_0x5378f2[_0x1382ae(0x891)]||_0x1382ae(0xa2e))+_0x1382ae(0x4c0),_0x3d7213[_0x1382ae(0x977)](_0x1382ae(0xaad))['addEventListener'](_0x1382ae(0x335),()=>_0x3d7213['remove']()),_0x3d7213[_0x1382ae(0x977)](_0x1382ae(0xeff))[_0x1382ae(0x205)]('click',()=>{const _0x3a3801=_0x1382ae;_0x3d7213[_0x3a3801(0x977)](_0x3a3801(0xf55))[_0x3a3801(0x335)]();}),_0x3d7213[_0x1382ae(0x977)]('.variation-image-input')[_0x1382ae(0x205)]('change',_0x5388d3=>{const _0x4d9ce1=_0x1382ae,_0x23d6b7=_0x5388d3[_0x4d9ce1(0xe16)][_0x4d9ce1(0x1d0)][0x0];if(_0x23d6b7){const _0x459bc4=new FileReader();_0x459bc4['onload']=_0x181de5=>{const _0x49725e=_0x4d9ce1;_0x3d7213[_0x49725e(0x977)](_0x49725e(0xd2c))['src']=_0x181de5['target'][_0x49725e(0x129)];},_0x459bc4['readAsDataURL'](_0x23d6b7);}}),_0x581735[_0x1382ae(0xf77)](_0x3d7213),_0x3d7213;}async function _0xac48fa(_0xb61956){const _0x92b350=_0x247bea,_0xc971ab=await _0x2a2987[_0x92b350(0x6b4)]['get'](_0xb61956);if(!_0xc971ab||!_0xc971ab[_0x92b350(0x81e)]||_0xc971ab[_0x92b350(0x81e)][_0x92b350(0x79b)]===0x0)return;const _0x488591=document['getElementById'](_0x92b350(0x40e));document[_0x92b350(0xc33)]('variation-product-image')[_0x92b350(0x87b)]=_0xc971ab[_0x92b350(0x891)],document[_0x92b350(0xc33)](_0x92b350(0xab6))[_0x92b350(0x11b0)]=_0xc971ab[_0x92b350(0x578)];const _0x1169b8=document[_0x92b350(0xc33)](_0x92b350(0xc49));_0x1169b8[_0x92b350(0x102a)]='',_0xc971ab['variations'][_0x92b350(0xd6a)]((_0x43d6fd,_0x747990)=>{const _0x54f831=_0x92b350,_0x1ce6bf=document[_0x54f831(0x1292)](_0x54f831(0x36e));_0x1ce6bf[_0x54f831(0x52a)]=_0x54f831(0x11bf),_0x1ce6bf[_0x54f831(0x578)]=_0x54f831(0x7fd),_0x1ce6bf['id']=_0x54f831(0x897)+_0xb61956+'-'+_0x747990,_0x1ce6bf[_0x54f831(0x22a)]=_0x747990,_0x1ce6bf['style'][_0x54f831(0xf44)]=_0x54f831(0x854);if(_0x747990===0x0)_0x1ce6bf[_0x54f831(0x737)]=!![];const _0x2b930e=document[_0x54f831(0x1292)]('label');_0x2b930e[_0x54f831(0x5af)]=_0x54f831(0x897)+_0xb61956+'-'+_0x747990,_0x2b930e['textContent']=_0x43d6fd[_0x54f831(0x578)],_0x2b930e[_0x54f831(0x105d)][_0x54f831(0x4c1)]=_0x54f831(0x65c),_0x1169b8['appendChild'](_0x1ce6bf),_0x1169b8[_0x54f831(0xf77)](_0x2b930e);});const _0x45ef25=()=>{const _0x55a8dd=_0x92b350,_0x38aee6=_0x1169b8[_0x55a8dd(0x977)](_0x55a8dd(0x354));_0x1169b8[_0x55a8dd(0x67a)](_0x55a8dd(0xecc))[_0x55a8dd(0xd6a)](_0x3dbedd=>{const _0x5b713e=_0x55a8dd;_0x3dbedd[_0x5b713e(0x105d)][_0x5b713e(0x523)]=_0x5b713e(0x2fc),_0x3dbedd[_0x5b713e(0x105d)][_0x5b713e(0x41e)]=_0x5b713e(0x83c),_0x3dbedd[_0x5b713e(0x105d)][_0x5b713e(0x1c5)]=_0x5b713e(0x6a6);});if(_0x38aee6){const _0x34e9de=_0x1169b8['querySelector']('label[for=\x22'+_0x38aee6['id']+'\x22]');_0x34e9de[_0x55a8dd(0x105d)][_0x55a8dd(0x523)]=_0x55a8dd(0x3a4),_0x34e9de[_0x55a8dd(0x105d)][_0x55a8dd(0x41e)]=_0x55a8dd(0x3a4),_0x34e9de[_0x55a8dd(0x105d)]['backgroundColor']=_0x55a8dd(0xd7e);const _0x37df77=_0xc971ab[_0x55a8dd(0x81e)][parseInt(_0x38aee6[_0x55a8dd(0x22a)])];document[_0x55a8dd(0xc33)](_0x55a8dd(0x2a0))[_0x55a8dd(0x11b0)]='¥'+_0x37df77[_0x55a8dd(0xae2)][_0x55a8dd(0xcab)](0x2),_0x37df77[_0x55a8dd(0x891)]?document[_0x55a8dd(0xc33)](_0x55a8dd(0x77f))['src']=_0x37df77[_0x55a8dd(0x891)]:document[_0x55a8dd(0xc33)](_0x55a8dd(0x77f))[_0x55a8dd(0x87b)]=_0xc971ab[_0x55a8dd(0x891)];}};_0x1169b8[_0x92b350(0x205)](_0x92b350(0x644),_0x45ef25),_0x45ef25(),document[_0x92b350(0xc33)](_0x92b350(0x10b8))[_0x92b350(0x11b0)]='1';const _0x3d5140=document[_0x92b350(0xc33)](_0x92b350(0x9e3)),_0x74267a=_0x3d5140[_0x92b350(0xbc5)](!![]);_0x3d5140['parentNode']['replaceChild'](_0x74267a,_0x3d5140),_0x74267a['addEventListener'](_0x92b350(0x335),async()=>{const _0x5c7e80=_0x92b350,_0x4249bb=_0x1169b8[_0x5c7e80(0x977)](_0x5c7e80(0x354)),_0x58399f=parseInt(document[_0x5c7e80(0xc33)](_0x5c7e80(0x10b8))[_0x5c7e80(0x11b0)]);if(_0x4249bb){const _0x5318a8=_0xc971ab[_0x5c7e80(0x81e)][parseInt(_0x4249bb['value'])];await _0x50393c(_0xb61956,_0x58399f,_0x5318a8),_0x488591[_0x5c7e80(0x10d3)]['remove']('visible'),await _0x2d7ddd('成功',_0x5c7e80(0xc24));}}),_0x488591[_0x92b350(0x10d3)][_0x92b350(0xb9)](_0x92b350(0x143));}function _0xdf4a9a(){const _0x1a0d0d=_0x247bea,_0x504d54=document['getElementById'](_0x1a0d0d(0xe1f));document[_0x1a0d0d(0xc33)](_0x1a0d0d(0x35b))[_0x1a0d0d(0x22a)]=_0x12493e['globalSettings']['shoppingCategoryCount']||0x3,document[_0x1a0d0d(0xc33)](_0x1a0d0d(0xb65))[_0x1a0d0d(0x22a)]=_0x12493e['globalSettings']['shoppingProductCount']||0x8,_0x504d54[_0x1a0d0d(0x10d3)][_0x1a0d0d(0xb9)]('visible');}async function _0x39679b(){const _0x23d997=_0x247bea,_0x657933=document[_0x23d997(0xc33)](_0x23d997(0x35b)),_0x3905ce=document['getElementById']('shopping-product-count-input'),_0x263594=parseInt(_0x657933['value']),_0x59023c=parseInt(_0x3905ce[_0x23d997(0x22a)]);if(isNaN(_0x263594)||isNaN(_0x59023c)||_0x263594<0x1||_0x59023c<0x1){alert(_0x23d997(0x1eb));return;}_0x12493e['globalSettings'][_0x23d997(0x4c3)]=_0x263594,_0x12493e[_0x23d997(0x10f6)][_0x23d997(0x1269)]=_0x59023c,await _0x2a2987[_0x23d997(0x10f6)][_0x23d997(0xf36)](_0x12493e['globalSettings']),document[_0x23d997(0xc33)](_0x23d997(0xe1f))['classList'][_0x23d997(0x2c7)](_0x23d997(0x143)),await _0x2d7ddd(_0x23d997(0x177),_0x23d997(0x474));}async function _0x357ae0(){const _0x4c8d25=_0x247bea;if(!_0x12493e[_0x4c8d25(0x7bc)]){await _0x2d7ddd(_0x4c8d25(0xb9d),'请先进入一个聊天页面，再返回购物中心进行生成，以便AI了解要为哪个角色生成商品。');return;}const _0x19cdaf=_0x12493e['chats'][_0x12493e[_0x4c8d25(0x7bc)]],_0x227782=await _0x270512('为“'+_0x19cdaf['name']+_0x4c8d25(0x6a8),_0x4c8d25(0x10fb),{'confirmText':_0x4c8d25(0x7e0)});if(!_0x227782)return;await _0x2d7ddd(_0x4c8d25(0xb37),_0x4c8d25(0x1cd)+_0x19cdaf[_0x4c8d25(0x578)]+'”的特点生成专属商品...');const _0x4ce369=_0x12493e[_0x4c8d25(0xdd4)]['secondaryProxyUrl']&&_0x12493e[_0x4c8d25(0xdd4)]['secondaryApiKey']&&_0x12493e[_0x4c8d25(0xdd4)][_0x4c8d25(0x479)],{proxyUrl:_0xffb25b,apiKey:_0x1dede1,model:_0x1aeb77}=_0x4ce369?{'proxyUrl':_0x12493e['apiConfig'][_0x4c8d25(0x246)],'apiKey':_0x12493e[_0x4c8d25(0xdd4)][_0x4c8d25(0xbd3)],'model':_0x12493e[_0x4c8d25(0xdd4)][_0x4c8d25(0x479)]}:_0x12493e['apiConfig'];if(!_0xffb25b||!_0x1dede1||!_0x1aeb77){await _0x2d7ddd(_0x4c8d25(0x1197),_0x4c8d25(0xb7b));return;}const _0x16b49a=_0x12493e['globalSettings']['shoppingCategoryCount']||0x3,_0x21c197=_0x12493e[_0x4c8d25(0x10f6)][_0x4c8d25(0x1269)]||0x8,_0x5bbb47=await _0x2a2987['shoppingCategories'][_0x4c8d25(0xf15)]();let _0xcdb7d2='';_0x5bbb47[_0x4c8d25(0x79b)]>0x0&&(_0xcdb7d2=_0x4c8d25(0xb5e)+_0x5bbb47[_0x4c8d25(0x9d5)](_0x411799=>'\x22'+_0x411799[_0x4c8d25(0x578)]+'\x22')[_0x4c8d25(0x100b)](',\x20')+']\x0a');const _0x1ebc37=_0x12493e[_0x4c8d25(0x76c)][_0x4c8d25(0x66a)]||'我',_0x1c6450=_0x19cdaf[_0x4c8d25(0x45b)]&&_0x19cdaf['longTermMemory'][_0x4c8d25(0x79b)]>0x0?_0x19cdaf[_0x4c8d25(0x45b)][_0x4c8d25(0x9d5)](_0x11eca8=>_0x4c8d25(0x11d4)+_0x3ce8f0(_0x11eca8[_0x4c8d25(0x2f0)])+')\x20'+_0x11eca8[_0x4c8d25(0xcbd)])[_0x4c8d25(0x100b)]('\x0a'):'无',_0x1f4370=_0x19cdaf[_0x4c8d25(0x1294)][_0x4c8d25(0x111c)](-0xa)[_0x4c8d25(0x9d5)](_0x389ae6=>(_0x389ae6[_0x4c8d25(0x16d)]==='user'?_0x1ebc37:_0x19cdaf[_0x4c8d25(0x578)])+':\x20'+String(_0x389ae6[_0x4c8d25(0xcbd)])[_0x4c8d25(0x1033)](0x0,0x1e)+_0x4c8d25(0xda0))[_0x4c8d25(0x100b)]('\x0a');let _0x1d172f='';if(_0x19cdaf['settings'][_0x4c8d25(0xeca)]&&_0x19cdaf['settings'][_0x4c8d25(0xeca)][_0x4c8d25(0x79b)]>0x0){const _0xdc913c=_0x19cdaf[_0x4c8d25(0x2ea)]['linkedWorldBookIds'][_0x4c8d25(0x9d5)](_0x11d1eb=>{const _0x5a222c=_0x4c8d25,_0x5bc438=_0x12493e['worldBooks'][_0x5a222c(0xd85)](_0x59d398=>_0x59d398['id']===_0x11d1eb);if(!_0x5bc438||!Array[_0x5a222c(0x621)](_0x5bc438[_0x5a222c(0xcbd)]))return'';const _0x52e17d=_0x5bc438[_0x5a222c(0xcbd)][_0x5a222c(0x1054)](_0x533350=>_0x533350['enabled']!==![])['map'](_0x2fc0d2=>'-\x20'+_0x2fc0d2['content'])[_0x5a222c(0x100b)]('\x0a');return _0x52e17d?_0x5a222c(0x880)+_0x5bc438['name']+_0x5a222c(0xd88)+_0x52e17d:'';})['filter'](Boolean)['join']('');_0xdc913c&&(_0x1d172f='\x0a#\x20世界观设定\x20(必须参考)\x0a'+_0xdc913c+'\x0a');}const _0x5b564d=_0x4c8d25(0x113)+_0x19cdaf[_0x4c8d25(0x578)]+_0x4c8d25(0x44a)+_0x16b49a+_0x4c8d25(0x97e)+_0x21c197+_0x4c8d25(0x121a)+_0x19cdaf[_0x4c8d25(0x578)]+'\x0a-\x20**角色人设**:\x20'+_0x19cdaf[_0x4c8d25(0x2ea)][_0x4c8d25(0x679)]+_0x4c8d25(0xee0)+_0x1c6450+_0x4c8d25(0x360)+_0x1d172f+'\x0a'+_0xcdb7d2+_0x4c8d25(0x10c6)+_0x1f4370+_0x4c8d25(0xa72)+_0x19cdaf[_0x4c8d25(0x578)]+_0x4c8d25(0xff0);try{const _0x846f4e=[{'role':_0x4c8d25(0x717),'content':'请根据以上设定，生成商品数据。'}];let _0x915a58=_0xffb25b[_0x4c8d25(0x1d4)](_0x4c8d25(0x113e)),_0x44311f=_0x202ea1(_0x1aeb77,_0x1dede1,_0x5b564d,_0x846f4e);const _0x4fe1c3=_0x915a58?await fetch(_0x44311f[_0x4c8d25(0x11a)],_0x44311f[_0x4c8d25(0xa78)]):await fetch(_0xffb25b+_0x4c8d25(0x399),{'method':'POST','headers':{'Content-Type':_0x4c8d25(0xd74),'Authorization':_0x4c8d25(0xf20)+_0x1dede1},'body':JSON[_0x4c8d25(0xd27)]({'model':_0x1aeb77,'messages':[{'role':_0x4c8d25(0x152),'content':_0x5b564d},..._0x846f4e],'temperature':_0x12493e['globalSettings'][_0x4c8d25(0xd52)]||0.9})});if(!_0x4fe1c3['ok'])throw new Error(_0x4c8d25(0xf43)+_0x4fe1c3[_0x4c8d25(0x109a)]);const _0x18aa32=await _0x4fe1c3[_0x4c8d25(0x79e)](),_0x39c4eb=getGeminiResponseText(_0x18aa32),_0x456e50=_0x39c4eb[_0x4c8d25(0x1242)](/({[\s\S]*})/);if(!_0x456e50)throw new Error('AI返回的内容中未找到有效的JSON对象。');const _0x4d2ce8=JSON[_0x4c8d25(0x6b1)](_0x456e50[0x0]);if(!_0x4d2ce8[_0x4c8d25(0x60b)]||!Array[_0x4c8d25(0x621)](_0x4d2ce8[_0x4c8d25(0x60b)]))throw new Error(_0x4c8d25(0x7fc));await _0x2a2987[_0x4c8d25(0xbff)]('rw',_0x2a2987[_0x4c8d25(0x6b4)],_0x2a2987['shoppingCategories'],async()=>{const _0x5a826a=_0x4c8d25;for(const _0x4a6123 of _0x4d2ce8[_0x5a826a(0x60b)]){let _0x588620;const _0x1a44c5=await _0x2a2987[_0x5a826a(0x1df)][_0x5a826a(0x8b5)](_0x5a826a(0x578))['equalsIgnoreCase'](_0x4a6123['name'])['first']();_0x1a44c5?_0x588620=_0x1a44c5['id']:_0x588620=await _0x2a2987[_0x5a826a(0x1df)][_0x5a826a(0xb9)]({'name':_0x4a6123[_0x5a826a(0x578)]});const _0x470469=_0x4a6123[_0x5a826a(0xbe7)][_0x5a826a(0x9d5)](_0x524c5b=>{const _0x50f098=_0x5a826a;return{'name':_0x524c5b[_0x50f098(0x578)],'price':_0x524c5b[_0x50f098(0xae2)]||0x0,'description':_0x524c5b[_0x50f098(0x11ac)]||'','imageUrl':'https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x524c5b[_0x50f098(0xe3d)]),'variations':(_0x524c5b['variations']||[])[_0x50f098(0x9d5)](_0x30f3dc=>({..._0x30f3dc,'imageUrl':_0x50f098(0xda8)+encodeURIComponent(_0x30f3dc['image_prompt'])})),'categoryId':_0x588620};});_0x470469[_0x5a826a(0x79b)]>0x0&&await _0x2a2987[_0x5a826a(0x6b4)][_0x5a826a(0x3ab)](_0x470469);}}),activeShoppingCategoryId=_0x4c8d25(0x5c8),await _0x34cd96(),await _0x2d7ddd('生成成功！','为“'+_0x19cdaf[_0x4c8d25(0x578)]+_0x4c8d25(0x94a));}catch(_0xeca84a){console[_0x4c8d25(0x4d9)](_0x4c8d25(0x11e3),_0xeca84a),await _0x2d7ddd(_0x4c8d25(0x8b1),_0x4c8d25(0xcd1)+_0xeca84a[_0x4c8d25(0xf93)]);}}async function _0x501bbe(_0x54ac66){const _0x919df1=_0x247bea,_0x26a322=document[_0x919df1(0xc33)](_0x54ac66);if(!_0x26a322)return;const _0x2ffffa=await _0x46f58a(_0x919df1(0x11bb),[{'text':_0x919df1(0x67d),'value':'local'},{'text':_0x919df1(0x10ac),'value':'url'}]);let _0x24f5fc=null;if(_0x2ffffa==='local')_0x24f5fc=await _0x4cf6c8();else _0x2ffffa==='url'&&(_0x24f5fc=await _0x1ca09c('更换图片','请输入新的图片URL：',_0x26a322['src'],_0x919df1(0x11a)));if(_0x24f5fc&&_0x24f5fc[_0x919df1(0x7da)]()){const _0x144e3f=_0x24f5fc[_0x919df1(0x7da)]();_0x26a322[_0x919df1(0x87b)]=_0x144e3f,!_0x12493e['globalSettings']['widgetData']&&(_0x12493e[_0x919df1(0x10f6)]['widgetData']={}),_0x12493e[_0x919df1(0x10f6)]['widgetData'][_0x54ac66]=_0x144e3f,await _0x2a2987['globalSettings']['put'](_0x12493e[_0x919df1(0x10f6)]),await _0x2d7ddd('成功',_0x919df1(0x126f));}}window[_0x247bea(0x2d8)]=_0x501bbe;async function _0x14d59b(){const _0x49dad7=_0x247bea;if(!window[_0x49dad7(0x269)]){alert(_0x49dad7(0xd39));return;}await _0x2d7ddd(_0x49dad7(0x580),_0x49dad7(0xd5c));const _0x581a75=streamSaver[_0x49dad7(0x96f)]('EPhone-Full-Backup-Streamed-'+new Date()['toISOString']()[_0x49dad7(0x8d7)]('T')[0x0]+_0x49dad7(0xc8)),_0x1f5f35=_0x581a75[_0x49dad7(0xa81)](),_0x51bd16=new TextEncoder();try{await _0x1f5f35[_0x49dad7(0xcaf)](_0x51bd16[_0x49dad7(0x115f)](_0x49dad7(0x11df)+Date[_0x49dad7(0x6ee)]()+',\x0a\x22data\x22:\x20{\x0a'));const _0x48a7cc=await _0x2a2987[_0x49dad7(0xf92)][_0x49dad7(0x9d5)](_0x4691d7=>_0x4691d7[_0x49dad7(0x578)]);for(let _0xdb79c5=0x0;_0xdb79c5<_0x48a7cc['length'];_0xdb79c5++){const _0x722800=_0x48a7cc[_0xdb79c5],_0x24fa6a=_0x2a2987[_0x49dad7(0xf3e)](_0x722800);await _0x1f5f35['write'](_0x51bd16[_0x49dad7(0x115f)]('\x22'+_0x722800+'\x22:\x20[\x0a'));let _0x4bd3f9=!![];await _0x24fa6a[_0x49dad7(0x450)](_0x3a15a4=>{const _0x44e2a8=_0x49dad7;!_0x4bd3f9&&_0x1f5f35[_0x44e2a8(0xcaf)](_0x51bd16[_0x44e2a8(0x115f)](',\x0a')),_0x1f5f35[_0x44e2a8(0xcaf)](_0x51bd16['encode'](JSON[_0x44e2a8(0xd27)](_0x3a15a4))),_0x4bd3f9=![];}),await _0x1f5f35[_0x49dad7(0xcaf)](_0x51bd16[_0x49dad7(0x115f)]('\x0a]')),_0xdb79c5<_0x48a7cc[_0x49dad7(0x79b)]-0x1&&await _0x1f5f35[_0x49dad7(0xcaf)](_0x51bd16[_0x49dad7(0x115f)](',\x0a'));}await _0x1f5f35['write'](_0x51bd16['encode'](_0x49dad7(0xf98)));}catch(_0xd8bc44){console['error'](_0x49dad7(0x8c9),_0xd8bc44),await _0x2d7ddd('导出失败',_0x49dad7(0x3cd)+_0xd8bc44[_0x49dad7(0xf93)]);}finally{await _0x1f5f35[_0x49dad7(0xe5)]();}}async function _0x5477e7(){const _0x5a18a2=_0x247bea;await _0x2d7ddd(_0x5a18a2(0x580),_0x5a18a2(0x87));try{const _0x4da9a7={'version':0x3,'timestamp':Date[_0x5a18a2(0x6ee)](),'data':{}},_0x191ce4=_0x2a2987[_0x5a18a2(0xf92)][_0x5a18a2(0x9d5)](_0x56ab96=>_0x56ab96['name']);for(const _0x3733cb of _0x191ce4){const _0x412563=await _0x2a2987[_0x5a18a2(0xf3e)](_0x3733cb)['toArray']();_0x4da9a7[_0x5a18a2(0xa78)][_0x3733cb]=_0x412563,console[_0x5a18a2(0x51f)](_0x5a18a2(0x36f)+_0x3733cb+_0x5a18a2(0x535)+_0x412563[_0x5a18a2(0x79b)]);}const _0x593e0d=new Blob([JSON['stringify'](_0x4da9a7,null,0x2)],{'type':_0x5a18a2(0xd74)}),_0xd110cf=URL['createObjectURL'](_0x593e0d),_0x468f6f=document['createElement']('a');_0x468f6f[_0x5a18a2(0x9c0)]=_0xd110cf,_0x468f6f[_0x5a18a2(0x846)]=_0x5a18a2(0x9b9)+new Date()[_0x5a18a2(0x7a3)]()['split']('T')[0x0]+'.json',_0x468f6f[_0x5a18a2(0x335)](),URL[_0x5a18a2(0x1202)](_0xd110cf),await _0x2d7ddd(_0x5a18a2(0x761),_0x5a18a2(0xb2e));}catch(_0x103256){console['error'](_0x5a18a2(0x661),_0x103256),await _0x2d7ddd(_0x5a18a2(0xd21),_0x5a18a2(0x2b9)+_0x103256[_0x5a18a2(0xf93)]);}}function _0x1f4bf2(){const _0x44cba1=_0x247bea,_0x4dc06e=Object['values'](_0x12493e[_0x44cba1(0xc45)])[_0x44cba1(0xdf9)]((_0x1d1ccf,_0x1e279c)=>{const _0x1bdf90=_0x44cba1;if(_0x1e279c['id']===_0x12493e[_0x1bdf90(0x7bc)])return _0x1d1ccf;return _0x1d1ccf+(_0x1e279c[_0x1bdf90(0xdc5)]||0x0);},0x0),_0x57046a=_0x38b5ff||0x0,_0x4be762=_0x4dc06e+_0x57046a,_0x23f6a3=document['getElementById']('back-to-list-btn');if(!_0x23f6a3)return;let _0x3f7d18=_0x23f6a3['querySelector'](_0x44cba1(0x798));!_0x3f7d18&&(_0x3f7d18=document['createElement'](_0x44cba1(0xa64)),_0x3f7d18[_0x44cba1(0x84)]=_0x44cba1(0xba6),_0x23f6a3[_0x44cba1(0xf77)](_0x3f7d18));let _0x31b2a2=_0x23f6a3['querySelector']('.unread-indicator.back-btn-indicator');_0x31b2a2&&_0x31b2a2['remove'](),_0x4be762>0x0?(_0x3f7d18['textContent']=_0x4be762>0x63?'99+':_0x4be762,_0x3f7d18[_0x44cba1(0x105d)][_0x44cba1(0xf44)]=_0x44cba1(0xa20),_0x3f7d18['style']['zIndex']='20',_0x3f7d18[_0x44cba1(0x105d)][_0x44cba1(0x404)]=_0x44cba1(0xca7)):_0x3f7d18[_0x44cba1(0x105d)][_0x44cba1(0xf44)]=_0x44cba1(0x854);}async function _0x4695f9(_0x1b6358){const _0x57331d=_0x247bea,_0x558a95=_0x1b6358===_0x57331d(0xef1)?{'id':_0x57331d(0xef1),'name':'未分类'}:await _0x2a2987[_0x57331d(0xfb6)][_0x57331d(0xec0)](_0x1b6358);if(!_0x558a95){console[_0x57331d(0x4d9)]('无法为不存在的分类打开绑定模态框:',_0x1b6358);return;}const _0x5a46c4=document[_0x57331d(0xc33)](_0x57331d(0x11f6)),_0x40ee69=document[_0x57331d(0xc33)]('sticker-binding-chat-list'),_0x2cacd6=_0x5a46c4[_0x57331d(0x977)](_0x57331d(0x1261));_0x40ee69[_0x57331d(0x102a)]='',_0x2cacd6[_0x57331d(0x11b0)]=_0x57331d(0xb89)+_0x558a95[_0x57331d(0x578)]+_0x57331d(0x145);const _0x81cc2a=Object['values'](_0x12493e['chats'])[_0x57331d(0xbb3)]((_0x538894,_0x116083)=>_0x538894[_0x57331d(0x578)][_0x57331d(0x3c3)](_0x116083[_0x57331d(0x578)],_0x57331d(0x770)));_0x81cc2a[_0x57331d(0xd6a)](_0x3b6525=>{const _0x2d859f=_0x57331d,_0x38c8df=Array[_0x2d859f(0x621)](_0x3b6525[_0x2d859f(0x2ea)]?.['stickerCategoryIds'])&&_0x3b6525[_0x2d859f(0x2ea)][_0x2d859f(0x818)][_0x2d859f(0x1d4)](_0x1b6358),_0x5d17c8=document[_0x2d859f(0x1292)](_0x2d859f(0x58c));_0x5d17c8[_0x2d859f(0x84)]='contact-picker-item',_0x5d17c8[_0x2d859f(0x102a)]=_0x2d859f(0xa63)+_0x3b6525['id']+'\x22\x20'+(_0x38c8df?'checked':'')+_0x2d859f(0xbf7)+(_0x3b6525[_0x2d859f(0x80b)]?_0x3b6525[_0x2d859f(0x2ea)][_0x2d859f(0x78a)]:_0x3b6525[_0x2d859f(0x2ea)][_0x2d859f(0x18e)]||_0x190acc)+_0x2d859f(0x163)+_0x3b6525[_0x2d859f(0x578)]+_0x2d859f(0x149),_0x40ee69['appendChild'](_0x5d17c8);}),document[_0x57331d(0xc33)](_0x57331d(0xcfc))[_0x57331d(0x8a)]=()=>_0x2beb5c(_0x1b6358),document[_0x57331d(0xc33)]('cancel-sticker-binding-btn')[_0x57331d(0x8a)]=()=>_0x5a46c4['classList'][_0x57331d(0x2c7)](_0x57331d(0x143)),_0x5a46c4[_0x57331d(0x10d3)][_0x57331d(0xb9)](_0x57331d(0x143));}async function _0x2beb5c(_0x3b8125){const _0x3d73d8=_0x247bea,_0x493537=new Set(Array[_0x3d73d8(0x301)](document[_0x3d73d8(0x67a)](_0x3d73d8(0x231)))[_0x3d73d8(0x9d5)](_0x4310e9=>_0x4310e9['dataset'][_0x3d73d8(0x109b)])),_0x41da3b=[];for(const _0x2ef493 in _0x12493e[_0x3d73d8(0xc45)]){const _0x4d7d87=_0x12493e[_0x3d73d8(0xc45)][_0x2ef493];!Array[_0x3d73d8(0x621)](_0x4d7d87['settings'][_0x3d73d8(0x818)])&&(_0x4d7d87[_0x3d73d8(0x2ea)][_0x3d73d8(0x818)]=[]);const _0x2bda9c=_0x4d7d87[_0x3d73d8(0x2ea)]['stickerCategoryIds'][_0x3d73d8(0x1d4)](_0x3b8125),_0x32f753=_0x493537['has'](_0x2ef493);if(_0x2bda9c&&!_0x32f753)_0x4d7d87[_0x3d73d8(0x2ea)]['stickerCategoryIds']=_0x4d7d87[_0x3d73d8(0x2ea)][_0x3d73d8(0x818)][_0x3d73d8(0x1054)](_0x11280d=>_0x11280d!==_0x3b8125),_0x41da3b['push'](_0x4d7d87);else!_0x2bda9c&&_0x32f753&&(_0x4d7d87['settings'][_0x3d73d8(0x818)][_0x3d73d8(0x2d6)](_0x3b8125),_0x41da3b[_0x3d73d8(0x2d6)](_0x4d7d87));}_0x41da3b['length']>0x0&&(await _0x2a2987[_0x3d73d8(0xc45)][_0x3d73d8(0xee7)](_0x41da3b),await _0x2d7ddd(_0x3d73d8(0x177),'表情包分类绑定已更新！')),document[_0x3d73d8(0xc33)](_0x3d73d8(0x11f6))[_0x3d73d8(0x10d3)][_0x3d73d8(0x2c7)]('visible');}function _0x17e3b9(_0x5bd307){const _0x4077cd=_0x247bea;if(!_0x5bd307||!_0x5bd307[_0x4077cd(0x2ea)][_0x4077cd(0x818)]||_0x5bd307[_0x4077cd(0x2ea)]['stickerCategoryIds']['length']===0x0)return'';const _0x58c6a6=_0x5bd307[_0x4077cd(0x2ea)]['stickerCategoryIds'];let _0x10f90b=[];const _0xb4160e=new Set();_0x58c6a6['forEach'](_0x5884f2=>{const _0x36cdf3=_0x4077cd;let _0x592047;_0x5884f2===_0x36cdf3(0xef1)?_0x592047=_0x12493e[_0x36cdf3(0x454)][_0x36cdf3(0x1054)](_0x4ca8b5=>!_0x4ca8b5[_0x36cdf3(0x305)]):_0x592047=_0x12493e[_0x36cdf3(0x454)]['filter'](_0x1c0ebd=>_0x1c0ebd[_0x36cdf3(0x305)]===_0x5884f2),_0x592047[_0x36cdf3(0xd6a)](_0x6e38fb=>{const _0xa7e4b9=_0x36cdf3;!_0xb4160e[_0xa7e4b9(0xa7)](_0x6e38fb[_0xa7e4b9(0x578)])&&(_0x10f90b['push'](_0x6e38fb),_0xb4160e['add'](_0x6e38fb[_0xa7e4b9(0x578)]));});});if(_0x10f90b[_0x4077cd(0x79b)]===0x0)return'';const _0x48d21d=_0x10f90b[_0x4077cd(0x9d5)](_0xb2548=>'-\x20'+_0xb2548['name'])[_0x4077cd(0x100b)]('\x0a');return'\x0a#\x20可用表情包\x20(优先使用)\x0a-\x20请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a'+_0x48d21d+'\x0a';}function _0x4d75d0(_0x5ce935){const _0xcb3f5=_0x247bea;if(!_0x5ce935||!_0x5ce935[_0xcb3f5(0x80b)])return'';let _0x2f46b2=_0xcb3f5(0x1e5),_0x1c1bac=![];return _0x5ce935[_0xcb3f5(0xd5b)]['forEach'](_0x52a8a3=>{const _0x4b7cf7=_0xcb3f5;if(_0x52a8a3['id']===_0x4b7cf7(0x717))return;const _0x4ac10e=_0x12493e['chats'][_0x52a8a3['id']];if(_0x4ac10e&&_0x4ac10e[_0x4b7cf7(0x2ea)]['stickerCategoryIds']&&_0x4ac10e['settings'][_0x4b7cf7(0x818)][_0x4b7cf7(0x79b)]>0x0){const _0x1ed21f=_0x4ac10e[_0x4b7cf7(0x2ea)]['stickerCategoryIds'];let _0x14f3cd=[];const _0x52abf3=new Set();_0x1ed21f['forEach'](_0x4c0611=>{const _0x3411cd=_0x4b7cf7;let _0x3d26b0;_0x4c0611===_0x3411cd(0xef1)?_0x3d26b0=_0x12493e[_0x3411cd(0x454)][_0x3411cd(0x1054)](_0x417e51=>!_0x417e51[_0x3411cd(0x305)]):_0x3d26b0=_0x12493e['userStickers'][_0x3411cd(0x1054)](_0x415e96=>_0x415e96[_0x3411cd(0x305)]===_0x4c0611),_0x3d26b0['forEach'](_0x560d92=>{const _0x2790e=_0x3411cd;!_0x52abf3[_0x2790e(0xa7)](_0x560d92['name'])&&(_0x14f3cd['push'](_0x560d92),_0x52abf3[_0x2790e(0xb9)](_0x560d92[_0x2790e(0x578)]));});}),_0x14f3cd['length']>0x0&&(_0x1c1bac=!![],_0x2f46b2+=_0x4b7cf7(0x6d9)+_0x52a8a3['groupNickname']+'\x20(本名:\x20'+_0x52a8a3[_0x4b7cf7(0x776)]+')\x20的可用表情:\x0a',_0x2f46b2+=_0x14f3cd[_0x4b7cf7(0x9d5)](_0x150495=>'-\x20'+_0x150495[_0x4b7cf7(0x578)])['join']('\x0a'));}}),_0x1c1bac?_0x2f46b2:'';}async function _0x184564(){const _0x128c7f=_0x247bea;async function _0x13915b(_0x44e263){const _0x393970=_0x26e9;if(!_0x44e263)return;try{const _0x5ad918=await _0x44e263[_0x393970(0x996)](),_0x1d9558=JSON[_0x393970(0x6b1)](_0x5ad918);if(_0x1d9558['type']===_0x393970(0x1048))console['log'](_0x393970(0x9d7)),await _0x5b45a6(_0x1d9558);else{if(_0x1d9558[_0x393970(0x43e)]&&typeof _0x1d9558[_0x393970(0x43e)]==='object')console[_0x393970(0x51f)](_0x393970(0x384)),await _0xb89f7e(_0x1d9558,_0x44e263['name']);else throw new Error(_0x393970(0xc9e));}}catch(_0x27114a){console[_0x393970(0x4d9)]('导入世界书时出错:',_0x27114a),await _0x2d7ddd('导入失败',_0x393970(0x4e8)+_0x27114a['message']);}}async function _0xb89f7e(_0x548b03,_0x4b9472){const _0x10df21=_0x26e9,_0x35b675=_0x4b9472[_0x10df21(0xc12)](/\.json$/i,''),_0x4d7e6a=await _0x1ca09c(_0x10df21(0x1bd),'请为这本设定集命名：',_0x35b675);if(!_0x4d7e6a||!_0x4d7e6a[_0x10df21(0x7da)]()){alert('导入已取消，因为未提供书名。');return;}const _0x22cbe2=Object[_0x10df21(0xd28)](_0x548b03[_0x10df21(0x43e)])[_0x10df21(0x9d5)](_0x49bef8=>{const _0x37bf53=_0x10df21;return{'keys':_0x49bef8['key']||[],'comment':_0x49bef8[_0x37bf53(0x8db)]||'无备注','content':_0x49bef8['content']||'','enabled':!_0x49bef8[_0x37bf53(0x7cd)]};})['filter'](_0x252b17=>_0x252b17[_0x10df21(0xcbd)]);if(_0x22cbe2['length']===0x0){alert('这个\x20Tavern\x20AI\x20世界书中没有找到任何有效的条目。');return;}const _0x589484={'id':_0x10df21(0x5fe)+Date[_0x10df21(0x6ee)](),'name':_0x4d7e6a[_0x10df21(0x7da)](),'content':_0x22cbe2,'categoryId':null};await _0x2a2987[_0x10df21(0x63a)]['add'](_0x589484),_0x12493e[_0x10df21(0x63a)][_0x10df21(0x2d6)](_0x589484),await _0x561077(),await _0x2d7ddd('导入成功！',_0x10df21(0x92f)+_0x4d7e6a+'》。');}async function _0x5b3205(){const _0x5e5d83=_0x26e9;try{const _0x305d8a=await _0x2a2987[_0x5e5d83(0x63a)]['toArray'](),_0x466d79=await _0x2a2987['worldBookCategories']['toArray']();if(_0x305d8a[_0x5e5d83(0x79b)]===0x0&&_0x466d79[_0x5e5d83(0x79b)]===0x0){alert(_0x5e5d83(0x5d3));return;}const _0x4dd1b1={'type':_0x5e5d83(0x1048),'version':0x1,'timestamp':Date['now'](),'books':_0x305d8a,'categories':_0x466d79},_0x16df9c=new Blob([JSON[_0x5e5d83(0xd27)](_0x4dd1b1,null,0x2)],{'type':'application/json'}),_0x407f12=URL[_0x5e5d83(0xca2)](_0x16df9c),_0xf67756=document['createElement']('a');_0xf67756[_0x5e5d83(0x9c0)]=_0x407f12,_0xf67756[_0x5e5d83(0x846)]=_0x5e5d83(0x12b4)+new Date()[_0x5e5d83(0x7a3)]()['split']('T')[0x0]+_0x5e5d83(0xc8),_0xf67756['click'](),URL[_0x5e5d83(0x1202)](_0x407f12),await _0x2d7ddd(_0x5e5d83(0x761),_0x5e5d83(0xbf5));}catch(_0x5957c0){console[_0x5e5d83(0x4d9)](_0x5e5d83(0xcfb),_0x5957c0),await _0x2d7ddd('导出失败','发生了一个错误:\x20'+_0x5957c0[_0x5e5d83(0xf93)]);}}async function _0x5b45a6(_0x6e92ee){const _0x118fa4=_0x26e9;try{if(_0x6e92ee[_0x118fa4(0x52a)]!=='EPhoneWorldBookBackup'||!_0x6e92ee[_0x118fa4(0x850)])throw new Error(_0x118fa4(0xb91));const _0x1d6d14=await _0x270512('导入世界书',_0x118fa4(0xd42),{'confirmButtonClass':_0x118fa4(0xa2),'confirmText':_0x118fa4(0x1154)});if(!_0x1d6d14)return;await _0x2a2987[_0x118fa4(0xbff)]('rw',_0x2a2987[_0x118fa4(0x63a)],_0x2a2987[_0x118fa4(0xd06)],async()=>{const _0x107359=_0x118fa4;await _0x2a2987['worldBooks'][_0x107359(0xebb)](),await _0x2a2987['worldBookCategories'][_0x107359(0xebb)](),Array[_0x107359(0x621)](_0x6e92ee[_0x107359(0x850)])&&await _0x2a2987[_0x107359(0x63a)][_0x107359(0xee7)](_0x6e92ee[_0x107359(0x850)]),Array[_0x107359(0x621)](_0x6e92ee[_0x107359(0x60b)])&&await _0x2a2987['worldBookCategories'][_0x107359(0xee7)](_0x6e92ee[_0x107359(0x60b)]);}),_0x12493e[_0x118fa4(0x63a)]=await _0x2a2987[_0x118fa4(0x63a)][_0x118fa4(0xf15)](),await _0x561077(),await _0x2d7ddd(_0x118fa4(0x455),'世界书数据已成功恢复！');}catch(_0x4bde12){console['error']('导入世界书时出错:',_0x4bde12),await _0x2d7ddd(_0x118fa4(0x11bc),_0x118fa4(0x4e8)+_0x4bde12[_0x118fa4(0xf93)]);}}const _0x30eecd=localStorage[_0x128c7f(0x7bb)]('ephoneLastActiveTimestamp');if(_0x30eecd){const _0x369e2c=(Date[_0x128c7f(0x6ee)]()-parseInt(_0x30eecd))/(0x3e8*0x3c);_0x369e2c>0x5&&_0x278556(_0x369e2c);}_0x15540b(),window[_0x128c7f(0xcc6)]=_0x38f00f,window['openRenderingRulesScreen']=_0x367e8e,window[_0x128c7f(0x3f5)]=_0x1d6350,window[_0x128c7f(0x11f7)]=_0x624af8,window[_0x128c7f(0x5a2)]=_0x36007f,window['switchToMyPhone']=_0x39a41d,window['openCharWallet']=_0x12750b,window['switchToCharHomeScreen']=_0x61bff,window['openNpcEditor']=_0x4e0128;const _0x41eccf=document[_0x128c7f(0x1292)](_0x128c7f(0x58c));_0x41eccf['id']=_0x128c7f(0x9c4),_0x41eccf[_0x128c7f(0x102a)]=_0x128c7f(0xf89),document[_0x128c7f(0xc33)](_0x128c7f(0x929))[_0x128c7f(0xf77)](_0x41eccf);const _0xf082ad=document['createElement'](_0x128c7f(0x105d));_0xf082ad['id']=_0x128c7f(0x52e),document[_0x128c7f(0xcb4)][_0x128c7f(0xf77)](_0xf082ad),_0xff941a[_0x128c7f(0xa4c)]=document['getElementById'](_0x128c7f(0xb76)),_0xff941a[_0x128c7f(0xf6e)]=document[_0x128c7f(0xc33)]('qzone-sticker-grid');const _0x50772f=localStorage[_0x128c7f(0x7bb)](_0x128c7f(0x3f1))||_0x128c7f(0x5b3);_0x11d9f4(_0x50772f);const _0x1894f7=document[_0x128c7f(0x1292)](_0x128c7f(0x105d));_0x1894f7['id']=_0x128c7f(0x5a3),document[_0x128c7f(0xcb4)]['appendChild'](_0x1894f7);const _0xa930a6=document[_0x128c7f(0x1292)]('style');_0xa930a6['id']=_0x128c7f(0xcb6),document[_0x128c7f(0xcb4)][_0x128c7f(0xf77)](_0xa930a6),_0x813b8a('','#chat-messages',_0x128c7f(0x5a3)),_0x813b8a('','#settings-preview-area',_0x128c7f(0xcb6)),window['openRenderingRulesScreen']=_0x367e8e,window['showScreen']=_0x38f00f,window[_0x128c7f(0xa29)]=_0x597ed7,window[_0x128c7f(0x7c7)]=_0x3ef240,window['renderWallpaperScreenProxy']=_0x374557,window['renderWorldBookScreenProxy']=_0x561077,await _0x1af137(),_0xadc4e(),await _0x901c31(),_0x3e472a(_0x12493e['globalSettings']['globalCss']);const _0x475b75=parseInt(localStorage[_0x128c7f(0x7bb)](_0x128c7f(0xd6c)))||0x0;_0x3d400b(_0x475b75);_0x12493e[_0x128c7f(0x10f6)]&&_0x12493e[_0x128c7f(0x10f6)][_0x128c7f(0x10cc)]&&_0x2e1ac4(_0x12493e[_0x128c7f(0x10f6)][_0x128c7f(0x10cc)]);_0x53e2ba(),setInterval(_0x53e2ba,0x3e8*0x1e),_0x5871a7(),_0x16357a(),_0x21aa4c(),_0xa1bafb(),document[_0x128c7f(0xc33)](_0x128c7f(0xce0))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x5a1809=>{const _0x4a4e41=_0x128c7f;_0x5a1809[_0x4a4e41(0xe16)][_0x4a4e41(0x10d3)]['contains'](_0x4a4e41(0x7c1))&&_0x46808e(_0x5a1809[_0x4a4e41(0xe16)][_0x4a4e41(0x85)][_0x4a4e41(0x305)]);}),document[_0x128c7f(0xc33)](_0x128c7f(0x56c))[_0x128c7f(0x205)]('click',()=>_0x24ad8a(null)),document[_0x128c7f(0xc33)](_0x128c7f(0xb5))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x2eb9a0=_0x128c7f;document[_0x2eb9a0(0xc33)](_0x2eb9a0(0x3ca))['classList']['remove'](_0x2eb9a0(0x143));}),document[_0x128c7f(0xc33)](_0x128c7f(0xf7e))[_0x128c7f(0x205)]('click',_0x3b812b),document['getElementById'](_0x128c7f(0x75e))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x3c5ffd=_0x128c7f;if(_0x12493e[_0x3c5ffd(0x7bc)]&&!_0x12493e[_0x3c5ffd(0xc45)][_0x12493e[_0x3c5ffd(0x7bc)]][_0x3c5ffd(0x80b)]){const _0x3a368d=_0x12493e[_0x3c5ffd(0xc45)][_0x12493e['activeChatId']];_0x893b88(_0x3a368d['id'],_0x3a368d[_0x3c5ffd(0x776)]);}});let _0x17f3e1=null;function _0x1f3fd8(_0x372b1a){const _0x343656=_0x128c7f;_0x17f3e1=_0x372b1a;const _0x2aa7d1=_0x12493e[_0x343656(0xc45)][_0x12493e['activeChatId']],_0x50e38a=_0x2aa7d1[_0x343656(0x3d1)][_0x343656(0xd85)](_0x44e510=>_0x44e510['id']===_0x372b1a);if(!_0x50e38a)return;const _0x475392=document['getElementById'](_0x343656(0x12a6));_0x475392[_0x343656(0x11b0)]=_0x50e38a[_0x343656(0x4fe)]?_0x343656(0xaae):'置顶公告',document[_0x343656(0xc33)](_0x343656(0x65f))[_0x343656(0x10d3)]['add']('visible');}async function _0x10c0ef(){const _0x424855=_0x128c7f;if(!_0x17f3e1)return;const _0x268f75=_0x12493e['chats'][_0x12493e[_0x424855(0x7bc)]],_0x49e912=_0x268f75[_0x424855(0x3d1)][_0x424855(0xd85)](_0x15d779=>_0x15d779['id']===_0x17f3e1);_0x49e912&&(_0x49e912[_0x424855(0x4fe)]=!_0x49e912['isPinned'],await _0x2a2987[_0x424855(0xc45)]['put'](_0x268f75),_0x1275b4()),document[_0x424855(0xc33)](_0x424855(0x65f))['classList']['remove'](_0x424855(0x143));}async function _0x381c93(){const _0x405df5=_0x128c7f;if(!_0x17f3e1)return;const _0x3bf567=await _0x270512(_0x405df5(0x8d6),_0x405df5(0x7b0),{'confirmButtonClass':_0x405df5(0xa2)});if(_0x3bf567){const _0x2bc922=_0x12493e[_0x405df5(0xc45)][_0x12493e[_0x405df5(0x7bc)]];_0x2bc922['announcements']=_0x2bc922['announcements']['filter'](_0x2714ff=>_0x2714ff['id']!==_0x17f3e1),await _0x2a2987[_0x405df5(0xc45)]['put'](_0x2bc922),_0x1275b4();}document[_0x405df5(0xc33)](_0x405df5(0x65f))[_0x405df5(0x10d3)][_0x405df5(0x2c7)](_0x405df5(0x143));}document[_0x128c7f(0xc33)]('custom-modal-cancel')[_0x128c7f(0x205)](_0x128c7f(0x335),_0x37b8d7),document[_0x128c7f(0xc33)](_0x128c7f(0xa70))['addEventListener'](_0x128c7f(0x335),_0x53f3a5=>{const _0xf18df2=_0x128c7f;if(_0x53f3a5[_0xf18df2(0xe16)]===_0x5d560a)_0x37b8d7();}),document[_0x128c7f(0xc33)]('export-data-btn')[_0x128c7f(0x205)](_0x128c7f(0x335),async()=>{const _0x52f6bc=_0x128c7f,_0x290cc9=await _0x46f58a(_0x52f6bc(0xe11),[{'text':_0x52f6bc(0x261),'value':_0x52f6bc(0x7d8)},{'text':_0x52f6bc(0xdee),'value':_0x52f6bc(0xed)}]);if(_0x290cc9===_0x52f6bc(0x7d8))_0x14d59b();else _0x290cc9===_0x52f6bc(0xed)&&_0x5477e7();}),document[_0x128c7f(0xc33)](_0x128c7f(0x319))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x153614),document[_0x128c7f(0xc33)]('offline-mode-toggle')[_0x128c7f(0x205)]('change',_0x155252=>{const _0x5ecb6d=_0x128c7f;document['getElementById'](_0x5ecb6d(0x84e))[_0x5ecb6d(0x105d)][_0x5ecb6d(0xf44)]=_0x155252[_0x5ecb6d(0xe16)][_0x5ecb6d(0x737)]?_0x5ecb6d(0xa20):_0x5ecb6d(0x854);}),document[_0x128c7f(0xc33)](_0x128c7f(0xf0e))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>document[_0x128c7f(0xc33)](_0x128c7f(0x22e))[_0x128c7f(0x335)]()),document[_0x128c7f(0xc33)]('time-perception-toggle')[_0x128c7f(0x205)](_0x128c7f(0x644),_0x34af6f=>{const _0x52d127=_0x128c7f;document[_0x52d127(0xc33)](_0x52d127(0x749))['style']['display']=_0x34af6f['target'][_0x52d127(0x737)]?_0x52d127(0xa20):_0x52d127(0x854);}),document[_0x128c7f(0xc33)](_0x128c7f(0x22e))[_0x128c7f(0x205)](_0x128c7f(0x644),_0x49a248=>_0x303a8a(_0x49a248[_0x128c7f(0xe16)][_0x128c7f(0x1d0)][0x0])),document[_0x128c7f(0xc33)](_0x128c7f(0x1ff))[_0x128c7f(0x205)](_0x128c7f(0x644),_0x295e3c),document['getElementById']('back-to-list-btn')[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x2b1ec1=_0x128c7f;_0x4c9e39={},_0x813b8a('',_0x2b1ec1(0x984),_0x2b1ec1(0x5a3)),_0x813b8a('',_0x2b1ec1(0x667),'preview-bubble-style'),_0x5e1dc2(),_0x12493e['activeChatId']=null,_0x38f00f('chat-list-screen');}),document[_0x128c7f(0xc33)](_0x128c7f(0x1058))[_0x128c7f(0x205)]('click',async()=>{const _0x4d7381=_0x128c7f,_0x4dd83e=await _0x46f58a(_0x4d7381(0x1172),[{'text':_0x4d7381(0x576),'value':_0x4d7381(0xca6)},{'text':_0x4d7381(0x5f9),'value':'import_card'}]);if(_0x4dd83e===_0x4d7381(0xca6)){const _0x530529=await _0x1ca09c(_0x4d7381(0xad0),_0x4d7381(0x9f2));if(!_0x530529||!_0x530529['trim']())return;const _0x5a48a5=await _0x1ca09c(_0x4d7381(0x5b6),_0x4d7381(0x2a8));if(!_0x5a48a5||!_0x5a48a5[_0x4d7381(0x7da)]())return;const _0x3a7170=_0x4d7381(0x657)+Date[_0x4d7381(0x6ee)](),_0x33105f={'id':_0x3a7170,'name':_0x530529[_0x4d7381(0x7da)](),'originalName':_0x5a48a5['trim'](),'isGroup':![],'isPinned':![],'unreadCount':0x0,'relationship':{'status':'friend','blockedTimestamp':null,'applicationReason':''},'status':{'text':'在线','lastUpdate':Date[_0x4d7381(0x6ee)](),'isBusy':![]},'settings':{'aiPersona':_0x4d7381(0xf80),'myPersona':_0x4d7381(0x25f),'myNickname':'我','maxMemory':0xa,'aiAvatar':_0x190acc,'myAvatar':_0x190acc,'background':'','theme':_0x4d7381(0xfae),'fontSize':0xd,'customCss':'','linkedWorldBookIds':[],'aiAvatarLibrary':[],'myAvatarLibrary':[],'enableBackgroundActivity':!![],'actionCooldownMinutes':0xf,'enableTimePerception':!![],'isOfflineMode':![],'offlineMinLength':0x64,'offlineMaxLength':0x12c,'offlinePresetId':null,'timeZone':_0x4d7381(0x368)},'history':[],'musicData':{'totalTime':0x0},'longTermMemory':[],'thoughtsHistory':[]};_0x12493e['chats'][_0x3a7170]=_0x33105f,await _0x2a2987[_0x4d7381(0xc45)][_0x4d7381(0xf36)](_0x33105f),_0x597ed7();}else _0x4dd83e===_0x4d7381(0xb88)&&document[_0x4d7381(0xc33)]('import-card-input')[_0x4d7381(0x335)]();}),document[_0x128c7f(0xc33)](_0x128c7f(0x23d))[_0x128c7f(0x205)]('click',_0x9a04cf),document[_0x128c7f(0xc33)](_0x128c7f(0xf94))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>document[_0x128c7f(0xc33)](_0x128c7f(0x89a))['classList'][_0x128c7f(0x2c7)](_0x128c7f(0x143))),document[_0x128c7f(0xc33)](_0x128c7f(0x140))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x46f8b8),document[_0x128c7f(0xc33)](_0x128c7f(0x1100))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x1d6350),document['getElementById'](_0x128c7f(0x373))['addEventListener'](_0x128c7f(0x335),()=>_0x3db293(!![])),document[_0x128c7f(0xc33)](_0x128c7f(0xcf3))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x3ccb5b),document['getElementById'](_0x128c7f(0x1fb))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x1c34cf),document[_0x128c7f(0xc33)]('music-next-btn')['addEventListener'](_0x128c7f(0x335),_0x942215),document[_0x128c7f(0xc33)]('music-prev-btn')[_0x128c7f(0x205)](_0x128c7f(0x335),_0x427546),document['getElementById'](_0x128c7f(0xdaf))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x4b96b2),document['getElementById'](_0x128c7f(0x670))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x4974b5=_0x128c7f;_0x596fed(),document['getElementById'](_0x4974b5(0xfbc))['classList'][_0x4974b5(0xb9)](_0x4974b5(0x143));}),document[_0x128c7f(0xc33)]('close-playlist-btn')[_0x128c7f(0x205)](_0x128c7f(0x335),()=>document['getElementById'](_0x128c7f(0xfbc))[_0x128c7f(0x10d3)][_0x128c7f(0x2c7)](_0x128c7f(0x143))),document[_0x128c7f(0xc33)]('add-song-url-btn')['addEventListener'](_0x128c7f(0x335),_0xb7103e),document[_0x128c7f(0xc33)](_0x128c7f(0xa60))['addEventListener']('click',()=>document[_0x128c7f(0xc33)](_0x128c7f(0x911))[_0x128c7f(0x335)]()),document[_0x128c7f(0xc33)](_0x128c7f(0x911))[_0x128c7f(0x205)](_0x128c7f(0x644),_0xc3ddfc),document[_0x128c7f(0xc33)](_0x128c7f(0xf9d))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x615181=>{const _0x346950=_0x128c7f,_0x51cc7f=_0x615181[_0x346950(0xe16)],_0x9631ed=parseInt(_0x51cc7f[_0x346950(0x85)]['index']);if(isNaN(_0x9631ed))return;if(_0x51cc7f[_0x346950(0x10d3)][_0x346950(0x3af)](_0x346950(0x1209)))_0x101a2c(_0x9631ed);else{if(_0x51cc7f[_0x346950(0x10d3)]['contains'](_0x346950(0x859)))_0x30aad1(_0x9631ed);else{if(_0x51cc7f[_0x346950(0x10d3)]['contains'](_0x346950(0x18c)))_0x495942(_0x9631ed);else _0x51cc7f[_0x346950(0x10d3)][_0x346950(0x3af)](_0x346950(0x1047))&&_0x1c2d08(_0x9631ed);}}}),_0x3ced3a['addEventListener'](_0x128c7f(0x57b),()=>{const _0x5720c3=_0x128c7f;document['getElementById'](_0x5720c3(0x947))['classList'][_0x5720c3(0x2c7)]('spinning'),_0x942215();});const _0x638999=document[_0x128c7f(0xc33)](_0x128c7f(0x113b));document['getElementById'](_0x128c7f(0xf2d))['addEventListener']('click',()=>{const _0x26b05b=_0x128c7f;_0x338f9e();const _0x5ac4a6=_0x638999[_0x26b05b(0x22a)][_0x26b05b(0x7da)]();if(!_0x5ac4a6||!_0x12493e[_0x26b05b(0x7bc)])return;const _0xa55f20=_0x12493e[_0x26b05b(0xc45)][_0x12493e[_0x26b05b(0x7bc)]],_0xf0abc7={'role':_0x26b05b(0x717),'content':_0x5ac4a6,'timestamp':Date[_0x26b05b(0x6ee)]()};_0x3afdd9&&(_0xf0abc7[_0x26b05b(0xf74)]=_0x3afdd9),_0x468ef0(_0xf0abc7,_0xa55f20),((async()=>{const _0xd6c2f=_0x26b05b;_0xa55f20[_0xd6c2f(0x1294)][_0xd6c2f(0x2d6)](_0xf0abc7),await _0x2a2987['chats']['put'](_0xa55f20),_0x597ed7();})()),_0x638999[_0x26b05b(0x22a)]='',_0x638999[_0x26b05b(0x105d)][_0x26b05b(0x27d)]=_0x26b05b(0x2c6),_0x638999[_0x26b05b(0xd59)](),_0x9e2080();}),document['getElementById'](_0x128c7f(0x15c))[_0x128c7f(0x205)]('click',_0x439587),_0x638999[_0x128c7f(0x205)]('keypress',_0x42fe06=>{const _0x3905bd=_0x128c7f;_0x42fe06['key']===_0x3905bd(0x36d)&&!_0x42fe06[_0x3905bd(0x7d)]&&(_0x42fe06[_0x3905bd(0xe8)](),document['getElementById'](_0x3905bd(0xf2d))[_0x3905bd(0x335)]());}),document['getElementById']('wallpaper-upload-input')['addEventListener']('change',async _0x3ca8d5=>{const _0x1fa4f2=_0x128c7f,_0x294526=_0x3ca8d5[_0x1fa4f2(0xe16)][_0x1fa4f2(0x1d0)][0x0];if(_0x294526){const _0x4e5b5f=await new Promise((_0x1ddcff,_0x3b351e)=>{const _0x3b05dd=_0x1fa4f2,_0x426dd8=new FileReader();_0x426dd8[_0x3b05dd(0x833)]=()=>_0x1ddcff(_0x426dd8[_0x3b05dd(0x129)]),_0x426dd8['onerror']=()=>_0x3b351e(_0x426dd8['error']),_0x426dd8[_0x3b05dd(0xbcf)](_0x294526);});_0xa2c277=_0x4e5b5f,_0x374557();}}),document[_0x128c7f(0xc33)](_0x128c7f(0xfcf))['addEventListener']('click',async()=>{const _0x5ced55=_0x128c7f;_0xa2c277&&(_0x12493e['globalSettings'][_0x5ced55(0x93e)]=_0xa2c277),_0x12493e[_0x5ced55(0x10f6)]['globalCss']=document[_0x5ced55(0xc33)](_0x5ced55(0x85c))[_0x5ced55(0x22a)][_0x5ced55(0x7da)](),_0x12493e['globalSettings'][_0x5ced55(0xc7)]=document[_0x5ced55(0xc33)](_0x5ced55(0x82a))[_0x5ced55(0x22a)]['trim'](),_0x12493e['globalSettings'][_0x5ced55(0xa86)]=document[_0x5ced55(0xc33)]('status-bar-toggle-switch')['checked'],await _0x2a2987['globalSettings'][_0x5ced55(0xf36)](_0x12493e[_0x5ced55(0x10f6)]),_0x5871a7(),_0x44847e(),_0xa2c277=null,_0x21aa4c(),_0x1ed875(),_0x3e472a(_0x12493e[_0x5ced55(0x10f6)][_0x5ced55(0x22c)]),_0xadc4e(),alert(_0x5ced55(0xf5d)),_0x38f00f(_0x5ced55(0x94f));});const _0x1cb9e3=document[_0x128c7f(0xc33)]('messages-view');_0x1cb9e3[_0x128c7f(0x205)]('scroll',()=>{const {scrollTop:_0x15d590,scrollHeight:_0x1d7e9b,clientHeight:_0x218e57}=_0x1cb9e3;_0x1d7e9b-_0x15d590-_0x218e57<_0x218e57&&(!_0xafdb39&&_0x2519ca());}),document[_0x128c7f(0xc33)](_0x128c7f(0x11b2))['addEventListener'](_0x128c7f(0x335),async()=>{const _0x59055b=_0x128c7f;_0x12493e[_0x59055b(0xdd4)][_0x59055b(0x872)]=document[_0x59055b(0xc33)]('proxy-url')[_0x59055b(0x22a)][_0x59055b(0x7da)](),_0x12493e[_0x59055b(0xdd4)][_0x59055b(0xb57)]=document['getElementById']('api-key')['value'][_0x59055b(0x7da)](),_0x12493e['apiConfig'][_0x59055b(0xd6d)]=document['getElementById'](_0x59055b(0x1a8))[_0x59055b(0x22a)],_0x12493e['apiConfig']['minimaxGroupId']=document[_0x59055b(0xc33)](_0x59055b(0x169))[_0x59055b(0x22a)][_0x59055b(0x7da)](),_0x12493e['apiConfig'][_0x59055b(0xed2)]=document['getElementById'](_0x59055b(0xc56))[_0x59055b(0x22a)]['trim'](),_0x12493e[_0x59055b(0xdd4)][_0x59055b(0x433)]=document['getElementById'](_0x59055b(0x470))[_0x59055b(0x22a)],_0x12493e[_0x59055b(0xdd4)][_0x59055b(0x246)]=document[_0x59055b(0xc33)](_0x59055b(0x98d))[_0x59055b(0x22a)][_0x59055b(0x7da)](),_0x12493e['apiConfig'][_0x59055b(0xbd3)]=document['getElementById'](_0x59055b(0xcad))[_0x59055b(0x22a)]['trim'](),_0x12493e['apiConfig'][_0x59055b(0x479)]=document[_0x59055b(0xc33)]('secondary-model-select')[_0x59055b(0x22a)],await _0x2a2987[_0x59055b(0xdd4)][_0x59055b(0xf36)](_0x12493e[_0x59055b(0xdd4)]);const _0x3edf81=document['getElementById'](_0x59055b(0xfca)),_0x32cf10=document[_0x59055b(0xc33)]('background-interval-input'),_0x260cde=document[_0x59055b(0xc33)](_0x59055b(0x5b2));_0x12493e[_0x59055b(0x10f6)][_0x59055b(0xdde)]=_0x3edf81[_0x59055b(0x737)],_0x12493e['globalSettings']['backgroundActivityInterval']=parseInt(_0x32cf10[_0x59055b(0x22a)])||0x3c,_0x12493e[_0x59055b(0x10f6)][_0x59055b(0x127f)]=parseFloat(_0x260cde['value'])||0x1,_0x12493e[_0x59055b(0x10f6)][_0x59055b(0xd2f)]=document[_0x59055b(0xc33)](_0x59055b(0x702))[_0x59055b(0x737)],_0x12493e['globalSettings'][_0x59055b(0x3fd)]=parseInt(document[_0x59055b(0xc33)](_0x59055b(0xe48))[_0x59055b(0x22a)])||0x32,_0x12493e[_0x59055b(0x10f6)][_0x59055b(0x1ec)]=parseInt(document[_0x59055b(0xc33)](_0x59055b(0xbc))[_0x59055b(0x22a)])||0x1e,_0x12493e[_0x59055b(0x10f6)][_0x59055b(0xd52)]=parseFloat(document[_0x59055b(0xc33)](_0x59055b(0xc64))[_0x59055b(0x22a)]),await _0x2a2987[_0x59055b(0x10f6)][_0x59055b(0xf36)](_0x12493e[_0x59055b(0x10f6)]),_0x5d2a03();_0x12493e[_0x59055b(0x10f6)][_0x59055b(0xdde)]?(_0x53da85(),console[_0x59055b(0x51f)](_0x59055b(0x512)+_0x12493e[_0x59055b(0x10f6)][_0x59055b(0x899)]+'秒')):console[_0x59055b(0x51f)]('后台活动模拟已停止。');const _0x261018=document['getElementById'](_0x59055b(0xa10))[_0x59055b(0x737)],_0x2bd7d3=document[_0x59055b(0xc33)](_0x59055b(0x36a))[_0x59055b(0x22a)],_0x1296d4=document['getElementById']('novelai-api-key')['value'][_0x59055b(0x7da)]();localStorage[_0x59055b(0xec8)](_0x59055b(0x3eb),_0x261018),localStorage['setItem']('novelai-model',_0x2bd7d3),localStorage[_0x59055b(0xec8)](_0x59055b(0x10a4),_0x1296d4),alert('所有API与后台设置已保存!');});const _0x2b1f5f=document[_0x128c7f(0xc33)](_0x128c7f(0x969));_0x2b1f5f[_0x128c7f(0x205)](_0x128c7f(0xd59),_0x57d1ae=>{const _0x2b1ddb=_0x128c7f;_0x57d1ae[_0x2b1ddb(0xe16)][_0x2b1ddb(0x505)]('type',_0x2b1ddb(0x996));}),_0x2b1f5f['addEventListener'](_0x128c7f(0x406),_0x2ff7e4=>{const _0x52c345=_0x128c7f;_0x2ff7e4['target'][_0x52c345(0x505)](_0x52c345(0x52a),'password');});async function _0x357899(_0x141e77,_0x2fa337,_0x5c0ab1){const _0x4bbfe4=_0x128c7f,_0x493517=document[_0x4bbfe4(0xc33)](_0x141e77)[_0x4bbfe4(0x22a)][_0x4bbfe4(0x7da)](),_0x5bc3be=document['getElementById'](_0x2fa337)[_0x4bbfe4(0x22a)][_0x4bbfe4(0x7da)]();if(!_0x493517||!_0x5bc3be)return alert('请先填写对应的反代地址和密钥');try{let _0x5920de=_0x493517===GEMINI_API_URL;const _0x1288be=await fetch(_0x5920de?GEMINI_API_URL+_0x4bbfe4(0x2a6)+getRandomValue(_0x5bc3be):_0x493517+_0x4bbfe4(0x791),_0x5920de?undefined:{'headers':{'Authorization':'Bearer\x20'+_0x5bc3be}});if(!_0x1288be['ok'])throw new Error('无法获取模型列表');const _0x1ae5f8=await _0x1288be[_0x4bbfe4(0x79e)]();let _0x336239=_0x5920de?_0x1ae5f8[_0x4bbfe4(0x1fa)][_0x4bbfe4(0x9d5)](_0x885dd7=>({'id':_0x885dd7[_0x4bbfe4(0x578)][_0x4bbfe4(0x8d7)]('/')[0x1]||_0x885dd7[_0x4bbfe4(0x578)]})):_0x1ae5f8[_0x4bbfe4(0xa78)];const _0x137f6e=document[_0x4bbfe4(0xc33)](_0x5c0ab1);_0x137f6e[_0x4bbfe4(0x102a)]='';const _0x12dfc5=_0x5c0ab1===_0x4bbfe4(0x1a8)?_0x12493e[_0x4bbfe4(0xdd4)][_0x4bbfe4(0xd6d)]:_0x12493e[_0x4bbfe4(0xdd4)][_0x4bbfe4(0x479)];_0x336239[_0x4bbfe4(0xd6a)](_0x1c83f2=>{const _0x84bd8b=_0x4bbfe4,_0x3cd73d=document[_0x84bd8b(0x1292)](_0x84bd8b(0x2f6));_0x3cd73d['value']=_0x1c83f2['id'],_0x3cd73d[_0x84bd8b(0x11b0)]=_0x1c83f2['id'];if(_0x1c83f2['id']===_0x12dfc5)_0x3cd73d['selected']=!![];_0x137f6e[_0x84bd8b(0xf77)](_0x3cd73d);}),alert(_0x4bbfe4(0x18f));}catch(_0x3d8a3d){alert(_0x4bbfe4(0x4a0)+_0x3d8a3d['message']);}}document[_0x128c7f(0xc33)](_0x128c7f(0x8c8))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x4ff170=_0x128c7f;_0x357899(_0x4ff170(0xedb),_0x4ff170(0x969),_0x4ff170(0x1a8));}),document['getElementById']('fetch-secondary-models-btn')[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x47fd30=_0x128c7f;_0x357899(_0x47fd30(0x98d),'secondary-api-key',_0x47fd30(0x1fc));}),document[_0x128c7f(0xc33)](_0x128c7f(0x886))[_0x128c7f(0x205)](_0x128c7f(0x335),async()=>{const _0x47be31=_0x128c7f,_0x296be5=await _0x1ca09c(_0x47be31(0xc7f),_0x47be31(0x108f));if(_0x296be5&&_0x296be5[_0x47be31(0x7da)]()){const _0x1db58a={'id':_0x47be31(0x5fe)+Date['now'](),'name':_0x296be5[_0x47be31(0x7da)](),'content':''};await _0x2a2987['worldBooks'][_0x47be31(0xb9)](_0x1db58a),_0x12493e[_0x47be31(0x63a)][_0x47be31(0x2d6)](_0x1db58a),_0x561077(),_0x15e3c9(_0x1db58a['id']);}}),document[_0x128c7f(0xc33)](_0x128c7f(0x584))[_0x128c7f(0x205)](_0x128c7f(0x335),async()=>{const _0xee3db4=_0x128c7f;if(!_0xae35a4)return;const _0x1ca441=_0x12493e[_0xee3db4(0x63a)][_0xee3db4(0xd85)](_0x548c72=>_0x548c72['id']===_0xae35a4);if(!_0x1ca441)return;const _0x5cb1c6=document[_0xee3db4(0xc33)](_0xee3db4(0xe00))[_0xee3db4(0x22a)][_0xee3db4(0x7da)]();if(!_0x5cb1c6){alert(_0xee3db4(0x1235));return;}_0x1ca441[_0xee3db4(0x578)]=_0x5cb1c6;const _0x4f3d6d=document[_0xee3db4(0xc33)](_0xee3db4(0xcd))[_0xee3db4(0x22a)];_0x1ca441['categoryId']=_0x4f3d6d?parseInt(_0x4f3d6d):null;const _0x4a05f4=document[_0xee3db4(0xc33)](_0xee3db4(0xd7a)),_0x2de429=_0x4a05f4[_0xee3db4(0x67a)](_0xee3db4(0x5bd)),_0x15258a=[];_0x2de429['forEach'](_0x2be5ce=>{const _0xadf11=_0xee3db4,_0x3ed251=_0x2be5ce[_0xadf11(0x977)](_0xadf11(0xc72))['value'][_0xadf11(0x7da)](),_0xcddb63=_0x2be5ce[_0xadf11(0x977)](_0xadf11(0xfec))['value'][_0xadf11(0x7da)](),_0x9c5348=_0x2be5ce[_0xadf11(0x977)](_0xadf11(0xb8b))[_0xadf11(0x737)];_0xcddb63&&_0x15258a[_0xadf11(0x2d6)]({'comment':_0x2be5ce[_0xadf11(0x977)](_0xadf11(0xdbe))[_0xadf11(0x22a)][_0xadf11(0x7da)](),'keys':_0x3ed251?_0x3ed251[_0xadf11(0x8d7)](',')[_0xadf11(0x9d5)](_0x5b5683=>_0x5b5683[_0xadf11(0x7da)]())[_0xadf11(0x1054)](_0x17b228=>_0x17b228):[],'content':_0xcddb63,'enabled':_0x9c5348});}),_0x1ca441[_0xee3db4(0xcbd)]=_0x15258a,await _0x2a2987[_0xee3db4(0x63a)][_0xee3db4(0xf36)](_0x1ca441),document[_0xee3db4(0xc33)]('world-book-editor-title')['textContent']=_0x5cb1c6,_0xae35a4=null,_0x38f00f(_0xee3db4(0x1129)),await _0x561077();}),document[_0x128c7f(0xc33)](_0x128c7f(0xe81))[_0x128c7f(0x205)](_0x128c7f(0x335),async _0x66ebf9=>{const _0x34c942=_0x128c7f,_0xe772f5=_0x66ebf9['target'][_0x34c942(0x7a7)](_0x34c942(0x8e1));if(_0xe772f5){const _0x36cd3e=_0x12493e[_0x34c942(0xc45)][_0x12493e[_0x34c942(0x7bc)]];if(!_0x36cd3e)return;_0x781d6(_0xe772f5);const _0x1aa40a=_0xe772f5[_0x34c942(0x7a7)]('.message-bubble'),_0x2d863f=_0x1aa40a?_0x1aa40a[_0x34c942(0x977)](_0x34c942(0xf08)):null;if(_0xe772f5[_0x34c942(0x85)][_0x34c942(0x104f)]&&_0x2d863f&&_0x2d863f[_0x34c942(0x105d)][_0x34c942(0xf44)]==='block'){if(_0x36cd3e[_0x34c942(0x80b)]){console[_0x34c942(0x51f)]('这是一条群聊语音消息，已禁止发起TTS请求。');return;}if(_0x36cd3e[_0x34c942(0x2ea)][_0x34c942(0x907)]===![]){console[_0x34c942(0x51f)]('“'+_0x36cd3e['name']+_0x34c942(0xd83));return;}_0x81746a(_0xe772f5);}return;}const _0x4cc255=_0x66ebf9['target'][_0x34c942(0x7a7)]('.waimai-details-btn');if(_0x4cc255){const _0x117f03=_0x4cc255[_0x34c942(0x7a7)](_0x34c942(0x689));if(_0x117f03){const _0x5bf2b3=parseInt(_0x117f03[_0x34c942(0x85)]['timestamp']);if(!isNaN(_0x5bf2b3)){_0xae7b2e(_0x5bf2b3);return;}}}const _0x497864=_0x66ebf9[_0x34c942(0xe16)][_0x34c942(0x7a7)](_0x34c942(0x40d));if(_0x497864){const _0x1b74a5=_0x497864[_0x34c942(0x7a7)](_0x34c942(0x689));if(_0x1b74a5){const _0x1fc094=parseInt(_0x1b74a5['dataset'][_0x34c942(0x2f0)]),_0x34116c=_0x497864['dataset'][_0x34c942(0xc10)];if(!isNaN(_0x1fc094)&&_0x34116c){await _0xff41ed(_0x1fc094,_0x34116c);return;}}}const _0x54e0f4=_0x66ebf9['target']['closest'](_0x34c942(0x241));if(_0x54e0f4){const _0x4f3b21=parseInt(_0x54e0f4[_0x34c942(0x85)][_0x34c942(0x337)]);if(!isNaN(_0x4f3b21)){const _0x11a8eb=await _0x2a2987[_0x34c942(0x110b)][_0x34c942(0xec0)](_0x4f3b21);if(_0x11a8eb){let _0x229228='';const _0x277b1d=_0x11a8eb[_0x34c942(0xd48)]==='user'?_0x12493e[_0x34c942(0x76c)][_0x34c942(0x66a)]:_0x12493e[_0x34c942(0xc45)][_0x11a8eb[_0x34c942(0xd48)]]?.[_0x34c942(0x578)]||'未知作者';if(_0x11a8eb[_0x34c942(0x52a)]===_0x34c942(0x5c4))_0x229228=_0x11a8eb['content'];else{_0x229228=_0x11a8eb[_0x34c942(0x964)]||'';if(_0x11a8eb[_0x34c942(0x891)])_0x229228+='\x0a[图片]';if(_0x11a8eb['hiddenContent'])_0x229228+=_0x34c942(0x10e0)+_0x11a8eb[_0x34c942(0xc2e)]+']';}_0x2d7ddd(_0x34c942(0xed0)+_0x277b1d+'\x20的已删除动态',_0x229228[_0x34c942(0xc12)](/\n/g,'<br>'));}else _0x2d7ddd('提示','这条动态的原始数据已被彻底清除。');}return;}const _0x1c650a=_0x66ebf9['target'][_0x34c942(0x7a7)]('.ai-generated-image');if(_0x1c650a){const _0xaea335=_0x1c650a[_0x34c942(0x85)][_0x34c942(0x11ac)];if(_0xaea335)_0x2d7ddd(_0x34c942(0x511),_0xaea335);return;}const _0x555330=_0x66ebf9[_0x34c942(0xe16)][_0x34c942(0x7a7)](_0x34c942(0x1b7));if(_0x555330&&_0x555330[_0x34c942(0x85)][_0x34c942(0xebc)]){const _0x19100f=parseInt(_0x555330['dataset'][_0x34c942(0xebc)]);!isNaN(_0x19100f)&&_0x2d486b(_0x19100f);}const _0x37eb79=_0x66ebf9[_0x34c942(0xe16)][_0x34c942(0x7a7)](_0x34c942(0x124));if(_0x37eb79){const _0x14a6ab=_0x37eb79['closest'](_0x34c942(0x689));_0x14a6ab&&_0x501b1e(parseInt(_0x14a6ab[_0x34c942(0x85)][_0x34c942(0x2f0)]));}const _0x36e75=_0x66ebf9[_0x34c942(0xe16)][_0x34c942(0x7a7)](_0x34c942(0xbaf));if(_0x36e75){const _0x14126e=_0x36e75[_0x34c942(0x7a7)](_0x34c942(0x689));if(_0x14126e&&_0x14126e[_0x34c942(0x85)][_0x34c942(0x2f0)]){const _0x430073=parseInt(_0x14126e['dataset'][_0x34c942(0x2f0)]);_0x3701f1(_0x430073);}}const _0x23da54=_0x66ebf9[_0x34c942(0xe16)][_0x34c942(0x7a7)](_0x34c942(0xa8f));if(_0x23da54){const _0x50bd7d=parseInt(_0x23da54[_0x34c942(0x85)]['pollTimestamp']);if(isNaN(_0x50bd7d))return;const _0x21d467=_0x66ebf9[_0x34c942(0xe16)]['closest'](_0x34c942(0xb39));if(_0x21d467&&!_0x23da54[_0x34c942(0x10d3)][_0x34c942(0x3af)](_0x34c942(0x1171))){_0x3595c0(_0x50bd7d,_0x21d467[_0x34c942(0x85)][_0x34c942(0x2f6)]);return;}const _0x2a7ebe=_0x66ebf9[_0x34c942(0xe16)][_0x34c942(0x7a7)](_0x34c942(0xffe));if(_0x2a7ebe){_0x23da54[_0x34c942(0x10d3)][_0x34c942(0x3af)](_0x34c942(0x1171))?_0x2fdcd6(_0x50bd7d):_0x1491a0(_0x50bd7d);return;}_0x23da54['classList'][_0x34c942(0x3af)]('closed')&&_0x2fdcd6(_0x50bd7d);}const _0x57eb20=_0x66ebf9[_0x34c942(0xe16)][_0x34c942(0x7a7)]('.recalled-message-placeholder');if(_0x57eb20){const _0x18bf19=_0x12493e['chats'][_0x12493e['activeChatId']],_0x4dab9c=_0x57eb20[_0x34c942(0x7a7)](_0x34c942(0x1ab));if(_0x18bf19&&_0x4dab9c){const _0x463cb8=parseInt(_0x4dab9c[_0x34c942(0x85)][_0x34c942(0x2f0)]),_0x33533e=_0x18bf19[_0x34c942(0x1294)][_0x34c942(0xd85)](_0x1e1e3e=>_0x1e1e3e[_0x34c942(0x2f0)]===_0x463cb8);if(_0x33533e&&_0x33533e['recalledData']){let _0x2d531c='';const _0x3fdda1=_0x33533e[_0x34c942(0xc50)];_0x3fdda1['originalType']===_0x34c942(0x996)?_0x2d531c='原文:\x20\x22'+_0x3fdda1['originalContent']+'\x22':_0x2d531c='撤回了一条['+_0x3fdda1[_0x34c942(0xa5f)]+_0x34c942(0x6ca),_0x2d7ddd(_0x34c942(0xb3),_0x2d531c);}}}const _0x4448e5=_0x66ebf9[_0x34c942(0xe16)][_0x34c942(0x7a7)](_0x34c942(0xe23));if(_0x4448e5&&_0x4448e5[_0x34c942(0x7a7)](_0x34c942(0xb61))){const _0x2e567b=parseInt(_0x4448e5[_0x34c942(0x85)][_0x34c942(0x2f0)]);_0x5b4590(_0x2e567b);}const _0x1e7152=_0x66ebf9[_0x34c942(0xe16)][_0x34c942(0x7a7)](_0x34c942(0x689));if(_0x1e7152&&_0x1e7152[_0x34c942(0x10d3)][_0x34c942(0x3af)]('ai')&&_0x1e7152['classList'][_0x34c942(0x3af)](_0x34c942(0x264))&&_0x1e7152['dataset'][_0x34c942(0xbc8)]===_0x34c942(0x1025)){const _0x2e834f=parseInt(_0x1e7152[_0x34c942(0x85)][_0x34c942(0x2f0)]);!isNaN(_0x2e834f)&&_0x47ae3b(_0x2e834f);}});const _0x168cfa=document['getElementById'](_0x128c7f(0x293)),_0x1b8351=document[_0x128c7f(0x977)]('.custom-multiselect\x20.select-box'),_0x478b84=document[_0x128c7f(0xc33)](_0x128c7f(0xd8f));function _0x299f4b(){const _0x413900=_0x128c7f,_0x23832e=_0x478b84[_0x413900(0x67a)]('input:checked'),_0x5cf906=document[_0x413900(0x977)](_0x413900(0xfd4));if(_0x23832e['length']===0x0)_0x5cf906[_0x413900(0x11b0)]=_0x413900(0xb4c);else{if(_0x23832e[_0x413900(0x79b)]>0x2)_0x5cf906[_0x413900(0x11b0)]='已选择\x20'+_0x23832e['length']+'\x20本世界书';else{const _0x2031ea=Array[_0x413900(0x301)](_0x23832e)[_0x413900(0x9d5)](_0x3f259e=>{const _0x6a0350=_0x413900;return _0x3f259e[_0x6a0350(0xb6b)]['textContent']['trim']();});_0x5cf906[_0x413900(0x11b0)]=_0x2031ea[_0x413900(0x100b)](',\x20');}}}_0x1b8351[_0x128c7f(0x205)](_0x128c7f(0x335),_0x14c1c0=>{const _0xdb1af8=_0x128c7f;_0x14c1c0[_0xdb1af8(0xea2)](),_0x478b84[_0xdb1af8(0x10d3)][_0xdb1af8(0xe2c)](_0xdb1af8(0x143)),_0x1b8351[_0xdb1af8(0x10d3)][_0xdb1af8(0xe2c)](_0xdb1af8(0x5ea));}),document[_0x128c7f(0xc33)](_0x128c7f(0xd8f))[_0x128c7f(0x205)]('change',_0x299f4b),window[_0x128c7f(0x205)](_0x128c7f(0x335),_0x2594c4=>{const _0x3336e0=_0x128c7f;!document['querySelector'](_0x3336e0(0xf2e))['contains'](_0x2594c4[_0x3336e0(0xe16)])&&(_0x478b84['classList'][_0x3336e0(0x2c7)](_0x3336e0(0x143)),_0x1b8351['classList'][_0x3336e0(0x2c7)](_0x3336e0(0x5ea)));}),document[_0x128c7f(0xc33)](_0x128c7f(0xea0))[_0x128c7f(0x205)](_0x128c7f(0x335),async()=>{const _0x5d3cc3=_0x128c7f;_0x3866c0();if(!_0x12493e['activeChatId'])return;const _0x2b067d=_0x12493e[_0x5d3cc3(0xc45)][_0x12493e[_0x5d3cc3(0x7bc)]],_0x471517=_0x2b067d['isGroup'],_0x13bcc5=document[_0x5d3cc3(0xc33)](_0x5d3cc3(0xe4b));!_0x471517&&_0x2b067d[_0x5d3cc3(0x2ea)][_0x5d3cc3(0xb1a)]&&_0x2b067d[_0x5d3cc3(0x2ea)]['alternateGreetings'][_0x5d3cc3(0x79b)]>0x0?_0x13bcc5[_0x5d3cc3(0x105d)][_0x5d3cc3(0xf44)]='block':_0x13bcc5[_0x5d3cc3(0x105d)]['display']=_0x5d3cc3(0x854);document[_0x5d3cc3(0xc33)](_0x5d3cc3(0x952))[_0x5d3cc3(0x105d)][_0x5d3cc3(0xf44)]='block',document[_0x5d3cc3(0xc33)](_0x5d3cc3(0x9e9))['style'][_0x5d3cc3(0xf44)]=_0x5d3cc3(0xa20),document[_0x5d3cc3(0xc33)]('my-avatar-group')[_0x5d3cc3(0x105d)][_0x5d3cc3(0xf44)]=_0x5d3cc3(0xa20),document[_0x5d3cc3(0xc33)](_0x5d3cc3(0xa08))[_0x5d3cc3(0x105d)][_0x5d3cc3(0xf44)]=_0x471517?_0x5d3cc3(0xa20):_0x5d3cc3(0x854),document[_0x5d3cc3(0xc33)]('my-nickname-group')[_0x5d3cc3(0x105d)]['display']=_0x471517?'none':'block',document[_0x5d3cc3(0xc33)](_0x5d3cc3(0x379))[_0x5d3cc3(0x105d)][_0x5d3cc3(0xf44)]=_0x471517?_0x5d3cc3(0xa20):_0x5d3cc3(0x854),document[_0x5d3cc3(0xc33)](_0x5d3cc3(0x1d2))[_0x5d3cc3(0x105d)][_0x5d3cc3(0xf44)]=_0x471517?'block':'none',document[_0x5d3cc3(0xc33)]('ai-persona-group')[_0x5d3cc3(0x105d)][_0x5d3cc3(0xf44)]=_0x471517?_0x5d3cc3(0x854):_0x5d3cc3(0xa20),document[_0x5d3cc3(0xc33)](_0x5d3cc3(0xbf9))[_0x5d3cc3(0x105d)][_0x5d3cc3(0xf44)]=_0x471517?_0x5d3cc3(0x854):_0x5d3cc3(0xa20),document[_0x5d3cc3(0xc33)](_0x5d3cc3(0x1081))['style']['display']=_0x471517?_0x5d3cc3(0x854):_0x5d3cc3(0xa20),document[_0x5d3cc3(0xc33)]('ai-original-name-group')[_0x5d3cc3(0x105d)][_0x5d3cc3(0xf44)]=_0x471517?'none':'block',document[_0x5d3cc3(0xc33)]('ai-voice-id-group')[_0x5d3cc3(0x105d)][_0x5d3cc3(0xf44)]=_0x471517?'none':'block',document[_0x5d3cc3(0xc33)](_0x5d3cc3(0x350))[_0x5d3cc3(0x105d)][_0x5d3cc3(0xf44)]=_0x471517?'none':'block',document['getElementById'](_0x5d3cc3(0xdb5))[_0x5d3cc3(0x105d)][_0x5d3cc3(0xf44)]=_0x471517?_0x5d3cc3(0x854):_0x5d3cc3(0xa20),document[_0x5d3cc3(0xc33)](_0x5d3cc3(0x700))[_0x5d3cc3(0x105d)][_0x5d3cc3(0xf44)]=_0x471517?_0x5d3cc3(0x854):_0x5d3cc3(0xa20),document[_0x5d3cc3(0xc33)](_0x5d3cc3(0x2c2))[_0x5d3cc3(0x105d)][_0x5d3cc3(0xf44)]=_0x471517?_0x5d3cc3(0xa20):_0x5d3cc3(0x854),document['getElementById'](_0x5d3cc3(0x570))[_0x5d3cc3(0x22a)]=_0x2b067d[_0x5d3cc3(0x578)],document['getElementById'](_0x5d3cc3(0xeac))[_0x5d3cc3(0x22a)]=_0x2b067d[_0x5d3cc3(0x2ea)][_0x5d3cc3(0xf75)],document[_0x5d3cc3(0xc33)]('my-avatar-preview')[_0x5d3cc3(0x87b)]=_0x2b067d['settings']['myAvatar']||(_0x471517?_0x200461:_0x190acc),document[_0x5d3cc3(0xc33)](_0x5d3cc3(0x1f2))[_0x5d3cc3(0x22a)]=_0x2b067d['settings'][_0x5d3cc3(0x660)],document[_0x5d3cc3(0xc33)]('linked-memory-count')[_0x5d3cc3(0x22a)]=_0x2b067d[_0x5d3cc3(0x2ea)]['linkedMemoryCount']||0xa;const _0x3d2267=document[_0x5d3cc3(0xc33)](_0x5d3cc3(0xaa4)),_0x10ae89=document[_0x5d3cc3(0xc33)](_0x5d3cc3(0x460));_0x2b067d[_0x5d3cc3(0x2ea)][_0x5d3cc3(0xc88)]?(_0x3d2267['src']=_0x2b067d[_0x5d3cc3(0x2ea)][_0x5d3cc3(0xc88)],_0x3d2267['style'][_0x5d3cc3(0xf44)]='block',_0x10ae89[_0x5d3cc3(0x105d)][_0x5d3cc3(0xf44)]=_0x5d3cc3(0xd94)):(_0x3d2267[_0x5d3cc3(0x105d)]['display']=_0x5d3cc3(0x854),_0x10ae89[_0x5d3cc3(0x105d)]['display']='none');document['getElementById']('lyrics-position-group')[_0x5d3cc3(0x105d)][_0x5d3cc3(0xf44)]=_0x471517?_0x5d3cc3(0x854):_0x5d3cc3(0xa20),document[_0x5d3cc3(0xc33)](_0x5d3cc3(0x262))[_0x5d3cc3(0x105d)]['display']=_0x471517?_0x5d3cc3(0x854):_0x5d3cc3(0xa20),document[_0x5d3cc3(0xc33)]('group-background-activity-group')[_0x5d3cc3(0x105d)]['display']=_0x471517?'block':'none';const _0x4f94ec=document[_0x5d3cc3(0xc33)](_0x5d3cc3(0x1223)),_0x16035f=document[_0x5d3cc3(0xc33)](_0x5d3cc3(0x749));_0x4f94ec[_0x5d3cc3(0x737)]=_0x2b067d[_0x5d3cc3(0x2ea)][_0x5d3cc3(0x6c7)],_0x16035f['style'][_0x5d3cc3(0xf44)]=_0x4f94ec['checked']?'block':_0x5d3cc3(0x854);const _0x5d6b5d=document[_0x5d3cc3(0xc33)](_0x5d3cc3(0x186)),_0x2095b1=Intl['supportedValuesOf'](_0x5d3cc3(0x1055));_0x5d6b5d[_0x5d3cc3(0x102a)]='',_0x2095b1['forEach'](_0x1c8cb1=>{const _0x25e5ac=_0x5d3cc3,_0x176f5f=document[_0x25e5ac(0x1292)](_0x25e5ac(0x2f6));_0x176f5f[_0x25e5ac(0x22a)]=_0x1c8cb1,_0x176f5f[_0x25e5ac(0x11b0)]=_0x1c8cb1,_0x5d6b5d[_0x25e5ac(0xf77)](_0x176f5f);}),_0x5d6b5d['value']=_0x2b067d[_0x5d3cc3(0x2ea)][_0x5d3cc3(0x1055)]||_0x5d3cc3(0x368);if(_0x471517)document[_0x5d3cc3(0xc33)](_0x5d3cc3(0xf00))['checked']=_0x2b067d['settings'][_0x5d3cc3(0xdde)],document['getElementById']('my-group-nickname-input')['value']=_0x2b067d['settings'][_0x5d3cc3(0xbf6)]||'',document[_0x5d3cc3(0xc33)](_0x5d3cc3(0x270))['src']=_0x2b067d[_0x5d3cc3(0x2ea)][_0x5d3cc3(0x78a)]||_0x2ff70a,document[_0x5d3cc3(0xc33)]('group-action-cooldown-input')[_0x5d3cc3(0x22a)]=_0x2b067d[_0x5d3cc3(0x2ea)]['actionCooldownMinutes']||0xa,document['getElementById'](_0x5d3cc3(0x262))[_0x5d3cc3(0x105d)][_0x5d3cc3(0xf44)]=_0x5d3cc3(0x854),_0x123f2b(_0x2b067d[_0x5d3cc3(0xd5b)]);else{document[_0x5d3cc3(0xc33)](_0x5d3cc3(0x262))['style'][_0x5d3cc3(0xf44)]=_0x5d3cc3(0xa20),document[_0x5d3cc3(0xc33)](_0x5d3cc3(0x6e4))[_0x5d3cc3(0x737)]=_0x2b067d[_0x5d3cc3(0x2ea)][_0x5d3cc3(0xdde)],document['getElementById'](_0x5d3cc3(0xdd2))[_0x5d3cc3(0x737)]=_0x2b067d[_0x5d3cc3(0x2ea)]['injectLatestThought'];const _0x368f64=document['getElementById'](_0x5d3cc3(0x58d)),_0x494a55=document[_0x5d3cc3(0xc33)](_0x5d3cc3(0x84e)),_0x233094=document[_0x5d3cc3(0xc33)](_0x5d3cc3(0x24a)),_0xdc4ca9=document[_0x5d3cc3(0xc33)](_0x5d3cc3(0x494));_0x368f64[_0x5d3cc3(0x737)]=_0x2b067d[_0x5d3cc3(0x2ea)][_0x5d3cc3(0xe36)]||![],_0x494a55[_0x5d3cc3(0x105d)]['display']=_0x368f64['checked']?_0x5d3cc3(0xa20):_0x5d3cc3(0x854),_0x233094['value']=_0x2b067d[_0x5d3cc3(0x2ea)]['offlineMinLength']||0x64,_0xdc4ca9['value']=_0x2b067d['settings'][_0x5d3cc3(0x728)]||0x12c,await _0x25faa6(_0x2b067d),document['getElementById']('ai-original-name-input')['value']=_0x2b067d[_0x5d3cc3(0x776)],document[_0x5d3cc3(0xc33)](_0x5d3cc3(0x118b))[_0x5d3cc3(0x22a)]=_0x2b067d[_0x5d3cc3(0x2ea)]['minimaxVoiceId']||'',document[_0x5d3cc3(0xc33)](_0x5d3cc3(0x25c))[_0x5d3cc3(0x737)]=_0x2b067d[_0x5d3cc3(0x2ea)]['enableTts']!==![],document[_0x5d3cc3(0xc33)](_0x5d3cc3(0x111b))[_0x5d3cc3(0x22a)]=_0x2b067d['settings'][_0x5d3cc3(0x679)],document[_0x5d3cc3(0xc33)](_0x5d3cc3(0x105b))[_0x5d3cc3(0x87b)]=_0x2b067d[_0x5d3cc3(0x2ea)][_0x5d3cc3(0x18e)]||_0x190acc,document['getElementById']('my-nickname-input')['value']=_0x2b067d[_0x5d3cc3(0x2ea)][_0x5d3cc3(0xbf6)]||'我',document[_0x5d3cc3(0xc33)](_0x5d3cc3(0x519))['value']=_0x2b067d['settings'][_0x5d3cc3(0x663)]||0xa;const _0x5982ad=document[_0x5d3cc3(0xc33)](_0x5d3cc3(0xd31));_0x5982ad[_0x5d3cc3(0x102a)]=_0x5d3cc3(0x5d6);const _0x1c6bf4=await _0x2a2987['qzoneGroups'][_0x5d3cc3(0xf15)]();_0x1c6bf4[_0x5d3cc3(0xd6a)](_0x499adc=>{const _0xc990ed=_0x5d3cc3,_0x485896=document[_0xc990ed(0x1292)]('option');_0x485896[_0xc990ed(0x22a)]=_0x499adc['id'],_0x485896[_0xc990ed(0x11b0)]=_0x499adc[_0xc990ed(0x578)];if(_0x2b067d[_0xc990ed(0x780)]===_0x499adc['id'])_0x485896[_0xc990ed(0x63f)]=!![];_0x5982ad[_0xc990ed(0xf77)](_0x485896);});const _0xebb010=_0x2b067d['settings'][_0x5d3cc3(0x432)]||{'vertical':_0x5d3cc3(0xcbe),'horizontal':_0x5d3cc3(0xcef),'offset':0xa};document[_0x5d3cc3(0xc33)]('lyrics-vertical-pos')[_0x5d3cc3(0x22a)]=_0xebb010['vertical'],document[_0x5d3cc3(0xc33)](_0x5d3cc3(0x114f))[_0x5d3cc3(0x22a)]=_0xebb010[_0x5d3cc3(0x1070)],document[_0x5d3cc3(0xc33)](_0x5d3cc3(0xfcc))[_0x5d3cc3(0x22a)]=_0xebb010[_0x5d3cc3(0x529)];}const _0x5eb16a=document['getElementById']('world-book-checkboxes-container');_0x5eb16a[_0x5d3cc3(0x102a)]='';const [_0x28a417,_0x52da95]=await Promise[_0x5d3cc3(0x5c8)]([_0x2a2987[_0x5d3cc3(0xd06)][_0x5d3cc3(0xf15)](),_0x2a2987[_0x5d3cc3(0x63a)]['toArray']()]),_0x251d1f=new Set(_0x2b067d[_0x5d3cc3(0x2ea)][_0x5d3cc3(0xeca)]||[]);if(_0x52da95[_0x5d3cc3(0x79b)]===0x0)_0x5eb16a[_0x5d3cc3(0x102a)]='<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x22>还没有创建任何世界书</p>';else{_0x28a417[_0x5d3cc3(0xd6a)](_0x4aa4b7=>{const _0x2cc41c=_0x5d3cc3,_0x57d83b=_0x52da95[_0x2cc41c(0x1054)](_0xfcdf76=>_0xfcdf76[_0x2cc41c(0x305)]===_0x4aa4b7['id']);if(_0x57d83b[_0x2cc41c(0x79b)]>0x0){const _0x4d4aab=document['createElement']('h4');_0x4d4aab[_0x2cc41c(0x11b0)]=_0x4aa4b7[_0x2cc41c(0x578)],_0x4d4aab['style'][_0x2cc41c(0x4c1)]=_0x2cc41c(0xa34),_0x5eb16a['appendChild'](_0x4d4aab),_0x57d83b['forEach'](_0x317aa6=>{const _0x502d00=_0x2cc41c,_0x4c5931=_0x251d1f[_0x502d00(0xa7)](_0x317aa6['id']),_0x57b9c2=document[_0x502d00(0x1292)](_0x502d00(0xecc));_0x57b9c2[_0x502d00(0x102a)]='<input\x20type=\x22checkbox\x22\x20value=\x22book_'+_0x317aa6['id']+'\x22\x20'+(_0x4c5931?_0x502d00(0x737):'')+'>\x20'+_0x317aa6[_0x502d00(0x578)],_0x5eb16a[_0x502d00(0xf77)](_0x57b9c2);});}});const _0x384e6b=_0x52da95[_0x5d3cc3(0x1054)](_0x381e70=>!_0x381e70[_0x5d3cc3(0x305)]);if(_0x384e6b[_0x5d3cc3(0x79b)]>0x0){const _0x423432=document[_0x5d3cc3(0x1292)]('h4');_0x423432[_0x5d3cc3(0x11b0)]=_0x5d3cc3(0x30e),_0x423432[_0x5d3cc3(0x105d)][_0x5d3cc3(0x4c1)]=_0x5d3cc3(0x99),_0x5eb16a[_0x5d3cc3(0xf77)](_0x423432),_0x384e6b[_0x5d3cc3(0xd6a)](_0x43c0f9=>{const _0x5c68d4=_0x5d3cc3,_0x37a85b=_0x251d1f['has'](_0x43c0f9['id']),_0x4d482f=document[_0x5c68d4(0x1292)](_0x5c68d4(0xecc));_0x4d482f[_0x5c68d4(0x102a)]='<input\x20type=\x22checkbox\x22\x20value=\x22book_'+_0x43c0f9['id']+'\x22\x20'+(_0x37a85b?_0x5c68d4(0x737):'')+'>\x20'+_0x43c0f9[_0x5c68d4(0x578)],_0x5eb16a[_0x5c68d4(0xf77)](_0x4d482f);});}}_0x299f4b();const _0x422797=document[_0x5d3cc3(0xc33)](_0x5d3cc3(0x101f)),_0x5c3dff=document['getElementById'](_0x5d3cc3(0x12a5)),_0x4babd5=document[_0x5d3cc3(0xc33)]('linked-chats-checkboxes-container'),_0x32853c=_0x2b067d[_0x5d3cc3(0x2ea)]['linkedMemoryChatIds']||[];_0x422797['checked']=_0x32853c[_0x5d3cc3(0x79b)]>0x0,_0x5c3dff[_0x5d3cc3(0x105d)][_0x5d3cc3(0xf44)]=_0x422797[_0x5d3cc3(0x737)]?'block':_0x5d3cc3(0x854),_0x4babd5[_0x5d3cc3(0x102a)]='',Object[_0x5d3cc3(0xd28)](_0x12493e['chats'])[_0x5d3cc3(0xd6a)](_0x1696ff=>{const _0x477d60=_0x5d3cc3;if(_0x1696ff['id']===_0x2b067d['id'])return;const _0x1cd8a1=_0x32853c[_0x477d60(0x1d4)](_0x1696ff['id']),_0x48f47e=_0x1696ff[_0x477d60(0x80b)]?_0x477d60(0xbe0):_0x477d60(0x980),_0x334bbf=document[_0x477d60(0x1292)](_0x477d60(0xecc));_0x334bbf['innerHTML']=_0x477d60(0x1205)+_0x1696ff['id']+'\x22\x20'+(_0x1cd8a1?_0x477d60(0x737):'')+'>\x20'+_0x48f47e+'\x20'+_0x1696ff[_0x477d60(0x578)],_0x4babd5[_0x477d60(0xf77)](_0x334bbf);});function _0x35a574(){const _0x3444e0=_0x5d3cc3,_0x2fcb47=_0x4babd5[_0x3444e0(0x67a)](_0x3444e0(0xae6)),_0x463468=_0x5c3dff[_0x3444e0(0x977)](_0x3444e0(0xfd4));if(_0x2fcb47[_0x3444e0(0x79b)]===0x0)_0x463468[_0x3444e0(0x11b0)]='--\x20点击选择\x20--';else _0x2fcb47['length']>0x2?_0x463468['textContent']=_0x3444e0(0x34d)+_0x2fcb47['length']+'\x20项':_0x463468[_0x3444e0(0x11b0)]=Array[_0x3444e0(0x301)](_0x2fcb47)[_0x3444e0(0x9d5)](_0x2d82fd=>_0x2d82fd[_0x3444e0(0xb6b)][_0x3444e0(0x11b0)][_0x3444e0(0x7da)]())['join'](',\x20');}_0x35a574(),_0x422797['addEventListener']('change',()=>{const _0x3d3abe=_0x5d3cc3;_0x5c3dff['style'][_0x3d3abe(0xf44)]=_0x422797['checked']?'block':_0x3d3abe(0x854);});const _0x4db4bb=_0x5c3dff[_0x5d3cc3(0x977)](_0x5d3cc3(0x7a4)),_0x5d7a14=_0x4db4bb[_0x5d3cc3(0xbc5)](!![]);_0x4db4bb[_0x5d3cc3(0x1053)]['replaceChild'](_0x5d7a14,_0x4db4bb),_0x5d7a14[_0x5d3cc3(0x205)](_0x5d3cc3(0x335),_0x16e17a=>{const _0x25e15c=_0x5d3cc3;_0x16e17a[_0x25e15c(0xea2)](),_0x4babd5[_0x25e15c(0x10d3)][_0x25e15c(0xe2c)](_0x25e15c(0x143)),_0x5d7a14['classList'][_0x25e15c(0xe2c)]('expanded');}),_0x4babd5['addEventListener'](_0x5d3cc3(0x644),_0x35a574);const _0x182007=document[_0x5d3cc3(0x977)](_0x5d3cc3(0xbc0)+(_0x2b067d[_0x5d3cc3(0x2ea)]['theme']||_0x5d3cc3(0xfae))+'\x22]');if(_0x182007)_0x182007[_0x5d3cc3(0x737)]=!![];const _0x435e22=document[_0x5d3cc3(0xc33)](_0x5d3cc3(0x4a8));_0x435e22[_0x5d3cc3(0x22a)]=_0x2b067d[_0x5d3cc3(0x2ea)]['fontSize']||0xd,document[_0x5d3cc3(0xc33)](_0x5d3cc3(0x320))['textContent']=_0x435e22[_0x5d3cc3(0x22a)]+'px';const _0x58ebb3=document['getElementById']('custom-css-input');_0x58ebb3['value']=_0x2b067d[_0x5d3cc3(0x2ea)][_0x5d3cc3(0x707)]||'',_0x20b86d(),document[_0x5d3cc3(0xc33)]('auto-memory-toggle')[_0x5d3cc3(0x737)]=_0x2b067d['settings']['enableAutoMemory']||![],document['getElementById'](_0x5d3cc3(0x334))[_0x5d3cc3(0x22a)]=_0x2b067d['settings'][_0x5d3cc3(0x10da)]||0x14,_0x38f00f(_0x5d3cc3(0x9bb));});function _0x123f2b(_0xf17cab){const _0x157b3f=_0x128c7f,_0x1f0c07=document['getElementById']('group-members-settings');_0x1f0c07[_0x157b3f(0x102a)]='',_0xf17cab[_0x157b3f(0xd6a)](_0x2bc527=>{const _0x145abb=_0x157b3f,_0x2c7e24=document[_0x145abb(0x1292)]('div');_0x2c7e24[_0x145abb(0x84)]=_0x145abb(0x1039),_0x2c7e24[_0x145abb(0x85)][_0x145abb(0xb1b)]=_0x2bc527['id'];const _0x3c16c6=_0x2bc527[_0x145abb(0xbac)]||(_0x12493e[_0x145abb(0xc45)][_0x2bc527['id']]?_0x12493e[_0x145abb(0xc45)][_0x2bc527['id']][_0x145abb(0x2ea)][_0x145abb(0x18e)]:_0x5b9dd3);_0x2c7e24['innerHTML']='<img\x20src=\x22'+_0x3c16c6+'\x22\x20alt=\x22'+_0x2bc527[_0x145abb(0x6e2)]+_0x145abb(0x9a3)+_0x2bc527[_0x145abb(0x6e2)]+'</div>',_0x2c7e24['addEventListener'](_0x145abb(0x335),()=>_0x1bdb56(_0x2bc527['id'])),_0x1f0c07[_0x145abb(0xf77)](_0x2c7e24);});}document[_0x128c7f(0xc33)](_0x128c7f(0xa1))['addEventListener'](_0x128c7f(0x335),async()=>{const _0xa144d3=_0x128c7f;if(!_0x31659f)return;const _0x1d38bb=_0x12493e[_0xa144d3(0xc45)][_0x12493e[_0xa144d3(0x7bc)]],_0x3eaddf=_0x1d38bb[_0xa144d3(0xd5b)][_0xa144d3(0xd85)](_0xd6d6b7=>_0xd6d6b7['id']===_0x31659f);if(!_0x3eaddf)return;const _0x62e9d2=document[_0xa144d3(0xc33)](_0xa144d3(0x50f))[_0xa144d3(0x22a)][_0xa144d3(0x7da)]();if(!_0x62e9d2){alert(_0xa144d3(0x6f7));return;}_0x3eaddf[_0xa144d3(0x6e2)]=_0x62e9d2,_0x3eaddf[_0xa144d3(0x421)]=document[_0xa144d3(0xc33)](_0xa144d3(0x463))['value'];const _0x472059=document['getElementById'](_0xa144d3(0x105e))[_0xa144d3(0x87b)];_0x3eaddf[_0xa144d3(0xbac)]=_0x472059;const _0x50f9c1=_0x12493e[_0xa144d3(0xc45)][_0x3eaddf['id']];_0x50f9c1&&(_0x50f9c1[_0xa144d3(0x2ea)][_0xa144d3(0x18e)]=_0x472059,await _0x2a2987[_0xa144d3(0xc45)]['put'](_0x50f9c1)),await _0x2a2987[_0xa144d3(0xc45)][_0xa144d3(0xf36)](_0x1d38bb),_0x123f2b(_0x1d38bb['members']),document[_0xa144d3(0xc33)](_0xa144d3(0xfe6))[_0xa144d3(0x10d3)][_0xa144d3(0x2c7)](_0xa144d3(0x143)),_0x31659f=null;});function _0x1bdb56(_0x488659){const _0x27a522=_0x128c7f;_0x31659f=_0x488659;const _0xb42069=_0x12493e[_0x27a522(0xc45)][_0x12493e[_0x27a522(0x7bc)]],_0x43eddc=_0xb42069[_0x27a522(0xd5b)][_0x27a522(0xd85)](_0x4259ff=>_0x4259ff['id']===_0x488659);if(!_0x43eddc)return;document[_0x27a522(0xc33)](_0x27a522(0x50f))[_0x27a522(0x22a)]=_0x43eddc[_0x27a522(0x6e2)],document[_0x27a522(0xc33)](_0x27a522(0x463))[_0x27a522(0x22a)]=_0x43eddc[_0x27a522(0x421)];const _0x464db0=_0x43eddc[_0x27a522(0xbac)]||(_0x12493e[_0x27a522(0xc45)][_0x43eddc['id']]?_0x12493e[_0x27a522(0xc45)][_0x43eddc['id']][_0x27a522(0x2ea)][_0x27a522(0x18e)]:_0x5b9dd3);document[_0x27a522(0xc33)](_0x27a522(0x105e))[_0x27a522(0x87b)]=_0x464db0,document[_0x27a522(0xc33)](_0x27a522(0xfe6))[_0x27a522(0x10d3)][_0x27a522(0xb9)](_0x27a522(0x143));}document[_0x128c7f(0xc33)](_0x128c7f(0x7ed))['addEventListener'](_0x128c7f(0x335),()=>{const _0x411de0=_0x128c7f;document[_0x411de0(0xc33)](_0x411de0(0xfe6))['classList']['remove'](_0x411de0(0x143)),_0x31659f=null;}),document['getElementById']('save-member-settings-btn')[_0x128c7f(0x205)]('click',async()=>{const _0x11be93=_0x128c7f;if(!_0x31659f)return;const _0x53839f=_0x12493e[_0x11be93(0xc45)][_0x12493e[_0x11be93(0x7bc)]],_0x4e36a7=_0x53839f[_0x11be93(0xd5b)][_0x11be93(0xd85)](_0x3d7fcb=>_0x3d7fcb['id']===_0x31659f);if(!_0x4e36a7)return;const _0x3213d3=document[_0x11be93(0xc33)](_0x11be93(0x50f))['value']['trim']();if(!_0x3213d3){alert('群昵称不能为空！');return;}_0x4e36a7[_0x11be93(0x6e2)]=_0x3213d3,_0x4e36a7[_0x11be93(0x421)]=document[_0x11be93(0xc33)](_0x11be93(0x463))['value'];const _0xef0f08=document[_0x11be93(0xc33)]('member-avatar-preview')[_0x11be93(0x87b)];_0x4e36a7[_0x11be93(0xbac)]=_0xef0f08;const _0x3ff86f=_0x12493e[_0x11be93(0xc45)][_0x4e36a7['id']];_0x3ff86f&&(_0x3ff86f['settings']['aiAvatar']=_0xef0f08,await _0x2a2987[_0x11be93(0xc45)][_0x11be93(0xf36)](_0x3ff86f)),await _0x2a2987['chats'][_0x11be93(0xf36)](_0x53839f),_0x123f2b(_0x53839f[_0x11be93(0xd5b)]),document[_0x11be93(0xc33)](_0x11be93(0xfe6))[_0x11be93(0x10d3)]['remove']('visible'),_0x31659f=null;}),document[_0x128c7f(0xc33)](_0x128c7f(0x1192))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x4f1a81=_0x128c7f;document[_0x4f1a81(0xc33)](_0x4f1a81(0xd0f))[_0x4f1a81(0x737)]=!![];}),document[_0x128c7f(0xc33)](_0x128c7f(0x1150))[_0x128c7f(0x205)](_0x128c7f(0x335),async()=>{const _0x76bfeb=_0x128c7f;if(!_0x12493e[_0x76bfeb(0x7bc)])return;const _0x55373f=_0x12493e['chats'][_0x12493e[_0x76bfeb(0x7bc)]],_0x56453d=_0x55373f[_0x76bfeb(0x2ea)][_0x76bfeb(0xe36)]||![],_0x24daa3=document['getElementById']('chat-name-input')[_0x76bfeb(0x22a)][_0x76bfeb(0x7da)]();if(!_0x24daa3)return alert(_0x76bfeb(0x11d7));if(!_0x55373f[_0x76bfeb(0x80b)]&&_0x24daa3!==_0x55373f[_0x76bfeb(0x578)]){if(!_0x55373f[_0x76bfeb(0xa1a)])_0x55373f[_0x76bfeb(0xa1a)]=[];if(!_0x55373f[_0x76bfeb(0xa1a)][_0x76bfeb(0x1d4)](_0x55373f[_0x76bfeb(0x578)]))_0x55373f[_0x76bfeb(0xa1a)][_0x76bfeb(0x2d6)](_0x55373f[_0x76bfeb(0x578)]);}_0x55373f['name']=_0x24daa3;const _0x708cef=document[_0x76bfeb(0x977)]('input[name=\x22theme-select\x22]:checked');_0x55373f['settings'][_0x76bfeb(0x8a9)]=_0x708cef?_0x708cef['value']:_0x76bfeb(0xfae),_0x55373f['settings']['fontSize']=parseInt(document['getElementById'](_0x76bfeb(0x4a8))[_0x76bfeb(0x22a)]),_0x55373f['settings']['customCss']=document[_0x76bfeb(0xc33)](_0x76bfeb(0xf6c))[_0x76bfeb(0x22a)][_0x76bfeb(0x7da)](),_0x55373f[_0x76bfeb(0x2ea)]['myPersona']=document[_0x76bfeb(0xc33)](_0x76bfeb(0xeac))['value'],_0x55373f[_0x76bfeb(0x2ea)][_0x76bfeb(0x1006)]=document['getElementById'](_0x76bfeb(0xaa8))[_0x76bfeb(0x87b)],_0x55373f[_0x76bfeb(0x2ea)][_0x76bfeb(0x660)]=parseInt(document['getElementById']('max-memory')[_0x76bfeb(0x22a)])||0xa,_0x55373f[_0x76bfeb(0x2ea)]['linkedMemoryCount']=parseInt(document[_0x76bfeb(0xc33)](_0x76bfeb(0x29a))[_0x76bfeb(0x22a)])||0xa;const _0x5a8d41=document[_0x76bfeb(0x67a)](_0x76bfeb(0x4ba)),_0xb91729=[];_0x5a8d41[_0x76bfeb(0xd6a)](_0x50dd65=>{const _0x5eeb8d=_0x76bfeb;_0x50dd65['value'][_0x5eeb8d(0xece)]('book_')&&_0xb91729[_0x5eeb8d(0x2d6)](_0x50dd65['value'][_0x5eeb8d(0xc12)]('book_',''));}),_0x55373f['settings'][_0x76bfeb(0xeca)]=_0xb91729;const _0x29ddb5=document[_0x76bfeb(0xc33)]('link-memory-toggle')[_0x76bfeb(0x737)];if(_0x29ddb5){const _0x18c337=document[_0x76bfeb(0x67a)]('#linked-chats-checkboxes-container\x20input:checked');_0x55373f[_0x76bfeb(0x2ea)][_0x76bfeb(0x48b)]=Array['from'](_0x18c337)[_0x76bfeb(0x9d5)](_0x3c83e0=>_0x3c83e0[_0x76bfeb(0x22a)]);}else _0x55373f['settings'][_0x76bfeb(0x48b)]=[];_0x55373f[_0x76bfeb(0x2ea)]['enableAutoMemory']=document[_0x76bfeb(0xc33)](_0x76bfeb(0x970))[_0x76bfeb(0x737)],_0x55373f[_0x76bfeb(0x2ea)]['autoMemoryInterval']=parseInt(document[_0x76bfeb(0xc33)](_0x76bfeb(0x334))[_0x76bfeb(0x22a)])||0x14,_0x55373f[_0x76bfeb(0x2ea)][_0x76bfeb(0x6c7)]=document[_0x76bfeb(0xc33)](_0x76bfeb(0x1223))[_0x76bfeb(0x737)],_0x55373f[_0x76bfeb(0x2ea)]['timeZone']=document['getElementById']('time-zone-select')[_0x76bfeb(0x22a)];if(_0x55373f[_0x76bfeb(0x80b)])_0x55373f[_0x76bfeb(0x2ea)][_0x76bfeb(0xdde)]=document[_0x76bfeb(0xc33)](_0x76bfeb(0xf00))[_0x76bfeb(0x737)],_0x55373f['settings'][_0x76bfeb(0xbf6)]=document[_0x76bfeb(0xc33)](_0x76bfeb(0x1288))[_0x76bfeb(0x22a)][_0x76bfeb(0x7da)](),_0x55373f['settings']['groupAvatar']=document[_0x76bfeb(0xc33)](_0x76bfeb(0x270))[_0x76bfeb(0x87b)],_0x55373f[_0x76bfeb(0x2ea)][_0x76bfeb(0x663)]=parseInt(document['getElementById']('group-action-cooldown-input')[_0x76bfeb(0x22a)])||0xa;else{_0x55373f['settings']['enableBackgroundActivity']=document[_0x76bfeb(0xc33)](_0x76bfeb(0x6e4))[_0x76bfeb(0x737)];const _0x1f8f69=document[_0x76bfeb(0xc33)](_0x76bfeb(0x58d))[_0x76bfeb(0x737)];_0x55373f[_0x76bfeb(0x2ea)][_0x76bfeb(0xe36)]=_0x1f8f69;if(_0x56453d===!![]&&_0x1f8f69===![]){const _0x42def3={'role':_0x76bfeb(0x152),'content':_0x76bfeb(0xabc),'timestamp':Date[_0x76bfeb(0x6ee)](),'isHidden':!![]};_0x55373f[_0x76bfeb(0x1294)][_0x76bfeb(0x2d6)](_0x42def3),console['log'](_0x76bfeb(0x841));}_0x55373f[_0x76bfeb(0x2ea)]['injectLatestThought']=document[_0x76bfeb(0xc33)]('inject-thought-toggle')[_0x76bfeb(0x737)],_0x55373f[_0x76bfeb(0x2ea)][_0x76bfeb(0x123d)]=parseInt(document[_0x76bfeb(0xc33)](_0x76bfeb(0x24a))[_0x76bfeb(0x22a)])||0x64,_0x55373f[_0x76bfeb(0x2ea)]['offlineMaxLength']=parseInt(document[_0x76bfeb(0xc33)](_0x76bfeb(0x494))[_0x76bfeb(0x22a)])||0x12c,_0x55373f[_0x76bfeb(0x2ea)]['offlinePresetId']=document['getElementById'](_0x76bfeb(0x5d9))[_0x76bfeb(0x22a)]||null;const _0x5e0958=document['getElementById']('ai-original-name-input')['value'][_0x76bfeb(0x7da)]();if(!_0x5e0958)return alert(_0x76bfeb(0x105a));_0x55373f[_0x76bfeb(0x776)]=_0x5e0958,_0x55373f[_0x76bfeb(0x2ea)][_0x76bfeb(0x679)]=document[_0x76bfeb(0xc33)](_0x76bfeb(0x111b))[_0x76bfeb(0x22a)],_0x55373f[_0x76bfeb(0x2ea)][_0x76bfeb(0xabd)]=document[_0x76bfeb(0xc33)](_0x76bfeb(0x118b))['value']['trim'](),_0x55373f[_0x76bfeb(0x2ea)][_0x76bfeb(0x907)]=document[_0x76bfeb(0xc33)](_0x76bfeb(0x25c))['checked'],_0x55373f['settings']['aiAvatar']=document[_0x76bfeb(0xc33)](_0x76bfeb(0x105b))['src'],_0x55373f[_0x76bfeb(0x2ea)][_0x76bfeb(0xbf6)]=document[_0x76bfeb(0xc33)](_0x76bfeb(0x123e))[_0x76bfeb(0x22a)][_0x76bfeb(0x7da)]()||'我',_0x55373f[_0x76bfeb(0x2ea)][_0x76bfeb(0x663)]=parseInt(document[_0x76bfeb(0xc33)](_0x76bfeb(0x519))[_0x76bfeb(0x22a)])||0xa,_0x55373f['settings'][_0x76bfeb(0x432)]={'vertical':document['getElementById'](_0x76bfeb(0x2c5))[_0x76bfeb(0x22a)],'horizontal':document['getElementById'](_0x76bfeb(0x114f))[_0x76bfeb(0x22a)],'offset':parseInt(document[_0x76bfeb(0xc33)](_0x76bfeb(0xfcc))[_0x76bfeb(0x22a)])||0xa};const _0x3acbbe=document[_0x76bfeb(0xc33)](_0x76bfeb(0xd31))[_0x76bfeb(0x22a)];_0x55373f['groupId']=_0x3acbbe?parseInt(_0x3acbbe):null;}await _0x2a2987[_0x76bfeb(0xc45)][_0x76bfeb(0xf36)](_0x55373f),!_0x55373f[_0x76bfeb(0x80b)]&&(await _0x29067b(_0x55373f),await _0x4c9fe9(_0x55373f)),_0x416194(_0x55373f),_0x813b8a(_0x55373f[_0x76bfeb(0x2ea)][_0x76bfeb(0x707)],_0x76bfeb(0x984),_0x76bfeb(0x5a3)),_0x38f00f(_0x76bfeb(0xf1b)),_0x1bbfd3(_0x12493e['activeChatId']),_0x597ed7();}),document[_0x128c7f(0xc33)](_0x128c7f(0x9bb))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x3a47d0=>{const _0x19f7a0=_0x128c7f;_0x3a47d0['target'][_0x19f7a0(0x10d3)][_0x19f7a0(0x3af)](_0x19f7a0(0x74b))&&_0x3286e7('chat');}),document[_0x128c7f(0xc33)](_0x128c7f(0xfe6))['addEventListener'](_0x128c7f(0x335),_0x1199e1=>{const _0x8cfccf=_0x128c7f;_0x1199e1['target'][_0x8cfccf(0x10d3)]['contains'](_0x8cfccf(0x74b))&&_0x3286e7('member');});const _0x2622cb=document['getElementById'](_0x128c7f(0xe94)),_0x520641=document['getElementById']('ai-frame-tab'),_0x512b8b=document[_0x128c7f(0xc33)](_0x128c7f(0x912)),_0x549279=document[_0x128c7f(0xc33)](_0x128c7f(0xbe)),_0x2e475c=document[_0x128c7f(0xc33)](_0x128c7f(0xc1d));document[_0x128c7f(0xc33)](_0x128c7f(0x27b))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x5bcc80),document['getElementById'](_0x128c7f(0x600))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x438586=_0x128c7f;_0x2622cb[_0x438586(0x10d3)]['remove'](_0x438586(0x143)),_0x5bb322=![];}),_0x520641[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x2dfc50=_0x128c7f;_0x520641[_0x2dfc50(0x10d3)][_0x2dfc50(0xb9)]('active'),_0x512b8b[_0x2dfc50(0x10d3)][_0x2dfc50(0x2c7)]('active'),_0x549279[_0x2dfc50(0x105d)][_0x2dfc50(0xf44)]=_0x2dfc50(0xa20),_0x2e475c[_0x2dfc50(0x105d)][_0x2dfc50(0xf44)]='none';}),_0x512b8b[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x9130af=_0x128c7f;_0x512b8b[_0x9130af(0x10d3)]['add'](_0x9130af(0x1043)),_0x520641[_0x9130af(0x10d3)]['remove'](_0x9130af(0x1043)),_0x2e475c['style'][_0x9130af(0xf44)]='block',_0x549279[_0x9130af(0x105d)][_0x9130af(0xf44)]=_0x9130af(0x854);}),document[_0x128c7f(0xc33)](_0x128c7f(0x6ab))[_0x128c7f(0x205)]('click',async()=>{const _0x51403a=_0x128c7f;if(!_0x12493e[_0x51403a(0x7bc)])return;const _0x14b855=_0x12493e[_0x51403a(0xc45)][_0x12493e[_0x51403a(0x7bc)]],_0x436479=await _0x270512('清空聊天记录',_0x51403a(0xdb6),{'confirmButtonClass':_0x51403a(0xa2)});_0x436479&&(_0x14b855['history']=[],_0x14b855[_0x51403a(0x70a)]=_0x51403a(0xda0),_0x14b855[_0x51403a(0xb53)]='...',await _0x2a2987[_0x51403a(0xc45)][_0x51403a(0xf36)](_0x14b855),_0x1bbfd3(_0x12493e['activeChatId']),_0x597ed7(),_0x168cfa['classList'][_0x51403a(0x2c7)](_0x51403a(0x143)));});const _0x4536f8=(_0xc19613,_0x38e10c)=>{const _0x33c0bb=_0x128c7f;document[_0x33c0bb(0xc33)](_0xc19613)[_0x33c0bb(0x205)]('change',async _0x5e210b=>{const _0x388721=_0x33c0bb,_0x2008ce=_0x5e210b[_0x388721(0xe16)][_0x388721(0x1d0)][0x0];if(_0x2008ce){const _0xd9de92=await new Promise((_0x4d27f,_0x12b6a7)=>{const _0x23710d=_0x388721,_0x7a5f4f=new FileReader();_0x7a5f4f['onload']=()=>_0x4d27f(_0x7a5f4f[_0x23710d(0x129)]),_0x7a5f4f[_0x23710d(0x6e0)]=()=>_0x12b6a7(_0x7a5f4f[_0x23710d(0x4d9)]),_0x7a5f4f['readAsDataURL'](_0x2008ce);});_0x38e10c(_0xd9de92),_0x5e210b['target'][_0x388721(0x22a)]=null;}});};_0x4536f8(_0x128c7f(0x92c),_0xb33175=>document['getElementById'](_0x128c7f(0x105b))['src']=_0xb33175),_0x4536f8('my-avatar-input',_0x5f337e=>document[_0x128c7f(0xc33)](_0x128c7f(0xaa8))[_0x128c7f(0x87b)]=_0x5f337e),_0x4536f8('group-avatar-input',_0x28a035=>document[_0x128c7f(0xc33)]('group-avatar-preview')['src']=_0x28a035),_0x4536f8(_0x128c7f(0xda7),_0x1d6b0d=>document[_0x128c7f(0xc33)]('member-avatar-preview')[_0x128c7f(0x87b)]=_0x1d6b0d),_0x4536f8('bg-input',_0x4434fa=>{const _0x5937cf=_0x128c7f;if(_0x12493e[_0x5937cf(0x7bc)]){_0x12493e['chats'][_0x12493e['activeChatId']][_0x5937cf(0x2ea)]['background']=_0x4434fa;const _0x5ec5b9=document[_0x5937cf(0xc33)]('bg-preview');_0x5ec5b9['src']=_0x4434fa,_0x5ec5b9['style'][_0x5937cf(0xf44)]=_0x5937cf(0xa20),document[_0x5937cf(0xc33)]('remove-bg-btn')['style'][_0x5937cf(0xf44)]=_0x5937cf(0xd94);}}),_0x4536f8(_0x128c7f(0x3f6),_0x343022=>document[_0x128c7f(0xc33)](_0x128c7f(0x542))[_0x128c7f(0x87b)]=_0x343022),document[_0x128c7f(0xc33)](_0x128c7f(0x460))['addEventListener'](_0x128c7f(0x335),()=>{const _0x714d0e=_0x128c7f;if(_0x12493e[_0x714d0e(0x7bc)]){_0x12493e[_0x714d0e(0xc45)][_0x12493e[_0x714d0e(0x7bc)]][_0x714d0e(0x2ea)]['background']='';const _0x5bff9a=document['getElementById'](_0x714d0e(0xaa4));_0x5bff9a[_0x714d0e(0x87b)]='',_0x5bff9a[_0x714d0e(0x105d)]['display']='none',document[_0x714d0e(0xc33)](_0x714d0e(0x460))[_0x714d0e(0x105d)]['display']=_0x714d0e(0x854);}});const _0x2ab098=document['getElementById'](_0x128c7f(0x929));document[_0x128c7f(0xc33)]('open-sticker-panel-btn')[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x1977c5=_0x128c7f,_0x187859=_0x12493e[_0x1977c5(0xc45)][_0x12493e[_0x1977c5(0x7bc)]];_0x187859&&_0x187859[_0x1977c5(0x2ea)][_0x1977c5(0x485)]?_0x1b3792=_0x187859[_0x1977c5(0x2ea)][_0x1977c5(0x485)]:_0x1b3792=_0x1977c5(0x5c8),_0x3f10e9(),_0x2ab098[_0x1977c5(0x10d3)][_0x1977c5(0xb9)]('visible');}),document['getElementById'](_0x128c7f(0xb2a))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>_0x2ab098[_0x128c7f(0x10d3)][_0x128c7f(0x2c7)](_0x128c7f(0x143))),document[_0x128c7f(0xc33)](_0x128c7f(0x9bf))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x324a50),document[_0x128c7f(0xc33)](_0x128c7f(0xede))['addEventListener']('click',()=>document[_0x128c7f(0xc33)]('sticker-upload-input')[_0x128c7f(0x335)]()),document[_0x128c7f(0xc33)]('sticker-upload-input')[_0x128c7f(0x205)](_0x128c7f(0x644),async _0x12bdda=>{const _0x19ed17=_0x128c7f,_0x29a90e=_0x12bdda[_0x19ed17(0xe16)][_0x19ed17(0x1d0)][0x0];if(!_0x29a90e)return;const _0x27dc68=new FileReader();_0x27dc68[_0x19ed17(0xbcf)](_0x29a90e),_0x27dc68[_0x19ed17(0x833)]=async()=>{const _0x344ce5=_0x19ed17,_0x29c9e4=_0x27dc68['result'],_0x41e64e=await _0x1ca09c(_0x344ce5(0x108c),_0x344ce5(0x11b4));if(_0x41e64e&&_0x41e64e[_0x344ce5(0x7da)]()){const _0x468647={'id':_0x344ce5(0xbe2)+Date[_0x344ce5(0x6ee)](),'url':_0x29c9e4,'name':_0x41e64e[_0x344ce5(0x7da)](),'categoryId':_0x1b3792!==_0x344ce5(0x5c8)&&_0x1b3792!==_0x344ce5(0xef1)?_0x1b3792:null};await _0x2a2987[_0x344ce5(0x454)]['add'](_0x468647),_0x12493e[_0x344ce5(0x454)]['push'](_0x468647),_0x3f10e9();}else{if(_0x41e64e!==null)alert(_0x344ce5(0x4b3));}},_0x12bdda[_0x19ed17(0xe16)][_0x19ed17(0x22a)]=null;}),document[_0x128c7f(0xc33)](_0x128c7f(0x14b))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>document[_0x128c7f(0xc33)](_0x128c7f(0x83b))['click']()),document[_0x128c7f(0xc33)](_0x128c7f(0x83b))['addEventListener'](_0x128c7f(0x644),async _0x5f1e99=>{const _0x3afbb4=_0x128c7f,_0x40eace=_0x5f1e99[_0x3afbb4(0xe16)]['files'][0x0];if(!_0x40eace||!_0x12493e['activeChatId'])return;const _0x161368=new FileReader();_0x161368['onload']=async _0x504c97=>{const _0x302f73=_0x3afbb4,_0x223336=_0x504c97[_0x302f73(0xe16)][_0x302f73(0x129)],_0x284dbf=_0x12493e[_0x302f73(0xc45)][_0x12493e['activeChatId']],_0x44cb9={'role':_0x302f73(0x717),'content':[{'type':_0x302f73(0x10a1),'image_url':{'url':_0x223336}}],'timestamp':Date[_0x302f73(0x6ee)]()};_0x284dbf[_0x302f73(0x1294)]['push'](_0x44cb9),await _0x2a2987[_0x302f73(0xc45)]['put'](_0x284dbf),_0x468ef0(_0x44cb9,_0x284dbf),_0x597ed7();},_0x161368[_0x3afbb4(0xbcf)](_0x40eace),_0x5f1e99[_0x3afbb4(0xe16)]['value']=null;}),document[_0x128c7f(0xc33)]('voice-message-btn')[_0x128c7f(0x205)](_0x128c7f(0x335),async()=>{const _0x2cc0e2=_0x128c7f;if(!_0x12493e[_0x2cc0e2(0x7bc)])return;const _0x401566=await _0x1ca09c('发送语音',_0x2cc0e2(0x385));if(_0x401566&&_0x401566[_0x2cc0e2(0x7da)]()){const _0x355ef8=_0x12493e[_0x2cc0e2(0xc45)][_0x12493e['activeChatId']],_0x41cac4={'role':_0x2cc0e2(0x717),'type':_0x2cc0e2(0xb41),'content':_0x401566[_0x2cc0e2(0x7da)](),'timestamp':Date[_0x2cc0e2(0x6ee)]()};_0x355ef8[_0x2cc0e2(0x1294)][_0x2cc0e2(0x2d6)](_0x41cac4),await _0x2a2987['chats'][_0x2cc0e2(0xf36)](_0x355ef8),_0x468ef0(_0x41cac4,_0x355ef8),_0x597ed7();}}),document[_0x128c7f(0xc33)]('send-photo-btn')[_0x128c7f(0x205)](_0x128c7f(0x335),async()=>{const _0x541fd2=_0x128c7f;if(!_0x12493e[_0x541fd2(0x7bc)])return;const _0x1298c1=await _0x1ca09c(_0x541fd2(0xb5d),_0x541fd2(0x9da));if(_0x1298c1&&_0x1298c1[_0x541fd2(0x7da)]()){const _0x5b87f4=_0x12493e[_0x541fd2(0xc45)][_0x12493e[_0x541fd2(0x7bc)]],_0x13608b={'role':'user','type':_0x541fd2(0x142),'content':_0x1298c1[_0x541fd2(0x7da)](),'timestamp':Date[_0x541fd2(0x6ee)]()};_0x5b87f4[_0x541fd2(0x1294)][_0x541fd2(0x2d6)](_0x13608b),await _0x2a2987['chats'][_0x541fd2(0xf36)](_0x5b87f4),_0x468ef0(_0x13608b,_0x5b87f4),_0x597ed7();}});const _0xf3da7e=document['getElementById']('waimai-request-modal');document[_0x128c7f(0xc33)](_0x128c7f(0x6a3))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x405ede=_0x128c7f;_0xf3da7e[_0x405ede(0x10d3)][_0x405ede(0xb9)]('visible');}),_0xf3da7e[_0x128c7f(0x205)](_0x128c7f(0x335),_0x2c8bf1=>{const _0x473103=_0x128c7f;_0x2c8bf1[_0x473103(0xe16)]===_0xf3da7e&&_0xf3da7e[_0x473103(0x10d3)][_0x473103(0x2c7)]('visible');}),document[_0x128c7f(0xc33)](_0x128c7f(0x82))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x95ab6f),document[_0x128c7f(0xc33)](_0x128c7f(0x794))[_0x128c7f(0x205)](_0x128c7f(0x335),async()=>{const _0x39e7f3=_0x128c7f;if(!_0x12493e[_0x39e7f3(0x7bc)])return;const _0x1767ee=document['getElementById'](_0x39e7f3(0x1299)),_0x59f21c=document[_0x39e7f3(0xc33)](_0x39e7f3(0xc1e)),_0x4bf97d=_0x1767ee[_0x39e7f3(0x22a)][_0x39e7f3(0x7da)](),_0x4926d4=parseFloat(_0x59f21c[_0x39e7f3(0x22a)]);if(!_0x4bf97d||isNaN(_0x4926d4)||_0x4926d4<=0x0){alert('请填写有效的商品信息和金额！');return;}const _0x1706de=_0x12493e[_0x39e7f3(0xc45)][_0x12493e[_0x39e7f3(0x7bc)]],_0x300b5b=Date[_0x39e7f3(0x6ee)](),_0x42e600=_0x1706de['isGroup']?_0x1706de[_0x39e7f3(0x2ea)]['myNickname']||'我':'我',_0x9d2ea8={'role':_0x39e7f3(0x717),'senderName':_0x42e600,'type':_0x39e7f3(0x71d),'productInfo':_0x4bf97d,'amount':_0x4926d4,'status':'pending','countdownEndTime':_0x300b5b+0xf*0x3c*0x3e8,'timestamp':_0x300b5b};_0x1706de[_0x39e7f3(0x1294)]['push'](_0x9d2ea8),await _0x2a2987['chats'][_0x39e7f3(0xf36)](_0x1706de),_0x468ef0(_0x9d2ea8,_0x1706de),_0x597ed7(),_0x1767ee[_0x39e7f3(0x22a)]='',_0x59f21c['value']='',_0xf3da7e[_0x39e7f3(0x10d3)][_0x39e7f3(0x2c7)](_0x39e7f3(0x143));}),document[_0x128c7f(0xc33)](_0x128c7f(0xdea))[_0x128c7f(0x205)]('click',_0x413e38),document['getElementById'](_0x128c7f(0x5de))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x3521c2),document[_0x128c7f(0xc33)]('add-persona-preset-btn')[_0x128c7f(0x205)](_0x128c7f(0x335),_0x37ecd9),document[_0x128c7f(0xc33)]('cancel-persona-editor-btn')[_0x128c7f(0x205)](_0x128c7f(0x335),_0x40a9a5),document['getElementById'](_0x128c7f(0x7bf))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x389127),document['getElementById']('preset-action-edit')[_0x128c7f(0x205)](_0x128c7f(0x335),_0x557cdd),document[_0x128c7f(0xc33)](_0x128c7f(0xd92))[_0x128c7f(0x205)](_0x128c7f(0x335),_0xf85757),document[_0x128c7f(0xc33)](_0x128c7f(0xfc0))[_0x128c7f(0x205)]('click',_0x407c2a),document[_0x128c7f(0xc33)](_0x128c7f(0x109f))['addEventListener']('click',_0x5e1dc2),document[_0x128c7f(0xc33)](_0x128c7f(0xefa))[_0x128c7f(0x205)](_0x128c7f(0x335),async()=>{const _0x2f5825=_0x128c7f;if(_0x2078e5['size']===0x0)return;const _0x1080fe=await _0x270512(_0x2f5825(0x28a),_0x2f5825(0x5bf)+_0x2078e5[_0x2f5825(0x57e)]+_0x2f5825(0x224),{'confirmButtonClass':_0x2f5825(0xa2)});if(_0x1080fe){const _0x645e17=_0x12493e[_0x2f5825(0xc45)][_0x12493e['activeChatId']];let _0x1b4abc=[];for(const _0x539e83 of _0x2078e5){const _0x550ed8=_0x645e17[_0x2f5825(0x1294)][_0x2f5825(0xd85)](_0x517bb1=>_0x517bb1[_0x2f5825(0x2f0)]===_0x539e83);_0x550ed8&&_0x550ed8[_0x2f5825(0x52a)]===_0x2f5825(0x9ba)&&_0x1b4abc[_0x2f5825(0x2d6)]('关于“'+_0x550ed8['question']+'”的投票(时间戳:\x20'+_0x550ed8[_0x2f5825(0x2f0)]+')');}_0x645e17[_0x2f5825(0x1294)]=_0x645e17[_0x2f5825(0x1294)][_0x2f5825(0x1054)](_0x1ec6c2=>!_0x2078e5['has'](_0x1ec6c2[_0x2f5825(0x2f0)]));let _0x14171c=_0x2f5825(0x236);_0x1b4abc[_0x2f5825(0x79b)]>0x0&&(_0x14171c+='\x20其中包括以下投票：'+_0x1b4abc[_0x2f5825(0x100b)]('；')+'。');_0x14171c+=_0x2f5825(0x6eb);const _0x1c3a7b={'role':'system','content':'[系统提示：'+_0x14171c+']','timestamp':Date[_0x2f5825(0x6ee)](),'isHidden':!![]};_0x645e17['history'][_0x2f5825(0x2d6)](_0x1c3a7b),await _0x2a2987['chats'][_0x2f5825(0xf36)](_0x645e17),_0x1bbfd3(_0x12493e[_0x2f5825(0x7bc)]),_0x597ed7();}}),document['getElementById'](_0x128c7f(0x56a))['addEventListener'](_0x128c7f(0x335),async()=>{const _0x2dc728=_0x128c7f;if(_0x2078e5['size']===0x0)return;const _0x10fe32=await _0x270512(_0x2dc728(0x7e6),_0x2dc728(0xfe0)+_0x2078e5[_0x2dc728(0x57e)]+_0x2dc728(0x848),{'confirmButtonClass':_0x2dc728(0xa2),'confirmText':_0x2dc728(0x572)});if(_0x10fe32){const _0x21784b=_0x12493e[_0x2dc728(0xc45)][_0x12493e[_0x2dc728(0x7bc)]];_0x21784b['history']=_0x21784b[_0x2dc728(0x1294)][_0x2dc728(0x1054)](_0x1a5f5d=>!_0x2078e5[_0x2dc728(0xa7)](_0x1a5f5d[_0x2dc728(0x2f0)])),await _0x2a2987[_0x2dc728(0xc45)]['put'](_0x21784b),_0x1bbfd3(_0x12493e[_0x2dc728(0x7bc)]),_0x597ed7();}});const _0x32cfbb=document['getElementById'](_0x128c7f(0xf1c));_0x32cfbb['addEventListener'](_0x128c7f(0x36e),()=>_0x2e1ac4(_0x32cfbb[_0x128c7f(0x22a)][_0x128c7f(0x7da)](),!![])),document[_0x128c7f(0xc33)](_0x128c7f(0xa85))[_0x128c7f(0x205)](_0x128c7f(0x335),async()=>{const _0xb369ad=_0x128c7f,_0x2d0d52=_0x32cfbb[_0xb369ad(0x22a)][_0xb369ad(0x7da)]();if(!_0x2d0d52){alert(_0xb369ad(0xfb5));return;}_0x2e1ac4(_0x2d0d52,![]),_0x12493e[_0xb369ad(0x10f6)]['fontUrl']=_0x2d0d52,await _0x2a2987['globalSettings'][_0xb369ad(0xf36)](_0x12493e[_0xb369ad(0x10f6)]),alert(_0xb369ad(0xf42));}),document['getElementById'](_0x128c7f(0x594))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x2b1bbf),document[_0x128c7f(0x67a)](_0x128c7f(0xafc))['forEach'](_0x4172ad=>{const _0xdb238=_0x128c7f;_0x4172ad[_0xdb238(0x205)](_0xdb238(0x335),()=>_0x598e0c(_0x4172ad[_0xdb238(0x85)][_0xdb238(0x997)]));}),document['getElementById']('qzone-back-btn')[_0x128c7f(0x205)](_0x128c7f(0x335),()=>_0x598e0c(_0x128c7f(0x2fa))),document[_0x128c7f(0xc33)]('qzone-nickname')[_0x128c7f(0x205)](_0x128c7f(0x335),async()=>{const _0x3f85c7=_0x128c7f,_0x5127eb=await _0x1ca09c(_0x3f85c7(0x820),_0x3f85c7(0xdcf),_0x12493e[_0x3f85c7(0x76c)]['nickname']);_0x5127eb&&_0x5127eb[_0x3f85c7(0x7da)]()&&(_0x12493e[_0x3f85c7(0x76c)][_0x3f85c7(0x66a)]=_0x5127eb[_0x3f85c7(0x7da)](),await _0x2969d2(),_0x8001ea());}),document[_0x128c7f(0xc33)](_0x128c7f(0x115b))['addEventListener'](_0x128c7f(0x335),()=>document[_0x128c7f(0xc33)](_0x128c7f(0x9a6))['click']()),document[_0x128c7f(0xc33)](_0x128c7f(0x8d5))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>document[_0x128c7f(0xc33)]('qzone-banner-input')[_0x128c7f(0x335)]()),document[_0x128c7f(0xc33)](_0x128c7f(0x9a6))[_0x128c7f(0x205)](_0x128c7f(0x644),async _0x3c78b8=>{const _0x377e10=_0x128c7f,_0x1b2f60=_0x3c78b8[_0x377e10(0xe16)]['files'][0x0];if(_0x1b2f60){const _0xa20866=await new Promise(_0x50b023=>{const _0x2de399=_0x377e10,_0x3242a7=new FileReader();_0x3242a7['onload']=()=>_0x50b023(_0x3242a7[_0x2de399(0x129)]),_0x3242a7[_0x2de399(0xbcf)](_0x1b2f60);});_0x12493e[_0x377e10(0x76c)][_0x377e10(0xbac)]=_0xa20866,await _0x2969d2(),_0x8001ea();}_0x3c78b8[_0x377e10(0xe16)]['value']=null;}),document['getElementById']('qzone-banner-input')[_0x128c7f(0x205)](_0x128c7f(0x644),async _0x25bcea=>{const _0x405637=_0x128c7f,_0xcee212=_0x25bcea[_0x405637(0xe16)][_0x405637(0x1d0)][0x0];if(_0xcee212){const _0x567f94=await new Promise(_0x504c77=>{const _0x295ee6=_0x405637,_0x47e893=new FileReader();_0x47e893['onload']=()=>_0x504c77(_0x47e893['result']),_0x47e893[_0x295ee6(0xbcf)](_0xcee212);});_0x12493e['qzoneSettings'][_0x405637(0x78f)]=_0x567f94,await _0x2969d2(),_0x8001ea();}_0x25bcea[_0x405637(0xe16)][_0x405637(0x22a)]=null;}),document[_0x128c7f(0xc33)]('create-shuoshuo-btn')['addEventListener']('click',async()=>{const _0x8b1a08=_0x128c7f;_0x117b43();const _0x629c81=document[_0x8b1a08(0xc33)]('create-post-modal');_0x629c81[_0x8b1a08(0x85)][_0x8b1a08(0xc03)]='shuoshuo',_0x629c81[_0x8b1a08(0x977)](_0x8b1a08(0xbbf))['style'][_0x8b1a08(0xf44)]=_0x8b1a08(0x854),_0x629c81[_0x8b1a08(0x977)](_0x8b1a08(0x525))[_0x8b1a08(0x105d)]['display']=_0x8b1a08(0x854),_0x629c81[_0x8b1a08(0x977)](_0x8b1a08(0x80))[_0x8b1a08(0x105d)][_0x8b1a08(0xf44)]='none',_0x629c81[_0x8b1a08(0x977)](_0x8b1a08(0xe10))['placeholder']='分享新鲜事...';const _0x56b8a0=document[_0x8b1a08(0xc33)](_0x8b1a08(0xe91));_0x56b8a0[_0x8b1a08(0x102a)]='';const _0x106a4d=await _0x2a2987[_0x8b1a08(0x54b)][_0x8b1a08(0xf15)]();_0x106a4d['length']>0x0?_0x106a4d[_0x8b1a08(0xd6a)](_0x3f4b56=>{const _0x506c5b=_0x8b1a08,_0x55d5d=document[_0x506c5b(0x1292)](_0x506c5b(0xecc));_0x55d5d[_0x506c5b(0x105d)][_0x506c5b(0xf44)]=_0x506c5b(0xa20),_0x55d5d[_0x506c5b(0x102a)]=_0x506c5b(0x215)+_0x3f4b56['id']+_0x506c5b(0x8b9)+_0x3f4b56[_0x506c5b(0x578)],_0x56b8a0['appendChild'](_0x55d5d);}):_0x56b8a0[_0x8b1a08(0x102a)]='<p\x20style=\x22color:\x20var(--text-secondary);\x22>没有可用的分组</p>',_0x629c81[_0x8b1a08(0x10d3)][_0x8b1a08(0xb9)](_0x8b1a08(0x143));}),document[_0x128c7f(0xc33)](_0x128c7f(0x78c))['addEventListener'](_0x128c7f(0x335),async()=>{const _0x42ca17=_0x128c7f;_0x117b43();const _0x35f5bd=document['getElementById'](_0x42ca17(0xf3b));_0x35f5bd[_0x42ca17(0x85)][_0x42ca17(0xc03)]=_0x42ca17(0x12ac),_0x35f5bd[_0x42ca17(0x977)](_0x42ca17(0xbbf))[_0x42ca17(0x105d)]['display']=_0x42ca17(0x21a),_0x35f5bd['querySelector'](_0x42ca17(0x525))['classList'][_0x42ca17(0xb9)]('active'),_0x35f5bd[_0x42ca17(0x977)](_0x42ca17(0x80))['classList'][_0x42ca17(0x2c7)](_0x42ca17(0x1043)),_0x35f5bd[_0x42ca17(0x977)](_0x42ca17(0xe10))[_0x42ca17(0x1126)]=_0x42ca17(0xe42);const _0x388872=document['getElementById'](_0x42ca17(0xe91));_0x388872[_0x42ca17(0x102a)]='';const _0x2f5ee4=await _0x2a2987[_0x42ca17(0x54b)][_0x42ca17(0xf15)]();_0x2f5ee4[_0x42ca17(0x79b)]>0x0?_0x2f5ee4[_0x42ca17(0xd6a)](_0x200c1c=>{const _0x5c1af1=_0x42ca17,_0x48e1ab=document[_0x5c1af1(0x1292)](_0x5c1af1(0xecc));_0x48e1ab[_0x5c1af1(0x105d)][_0x5c1af1(0xf44)]='block',_0x48e1ab[_0x5c1af1(0x102a)]=_0x5c1af1(0x215)+_0x200c1c['id']+'\x22>\x20'+_0x200c1c[_0x5c1af1(0x578)],_0x388872[_0x5c1af1(0xf77)](_0x48e1ab);}):_0x388872[_0x42ca17(0x102a)]=_0x42ca17(0x7ac),_0x35f5bd[_0x42ca17(0x10d3)]['add'](_0x42ca17(0x143));}),document[_0x128c7f(0xc33)](_0x128c7f(0x69c))[_0x128c7f(0x205)](_0x128c7f(0x335),async()=>{const _0x2562c3=_0x128c7f;await _0x383ac2(),_0x38f00f(_0x2562c3(0x1d8));}),document[_0x128c7f(0xc33)](_0x128c7f(0xc26))['addEventListener'](_0x128c7f(0x335),()=>{_0x38f00f('chat-list-screen'),_0x598e0c('qzone-screen');}),document[_0x128c7f(0xc33)](_0x128c7f(0x106e))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x489cd4=_0x128c7f;_0x12493e[_0x489cd4(0xa35)]=null,_0x38f00f(_0x489cd4(0x1d8));}),document[_0x128c7f(0xc33)]('album-upload-photo-btn')['addEventListener'](_0x128c7f(0x335),()=>document[_0x128c7f(0xc33)](_0x128c7f(0x1005))['click']()),document[_0x128c7f(0xc33)](_0x128c7f(0x1005))['addEventListener'](_0x128c7f(0x644),async _0x41338b=>{const _0x477de7=_0x128c7f;if(!_0x12493e[_0x477de7(0xa35)])return;const _0x5ee942=_0x41338b[_0x477de7(0xe16)]['files'];if(!_0x5ee942[_0x477de7(0x79b)])return;const _0x334d30=await _0x2a2987['qzoneAlbums'][_0x477de7(0xec0)](_0x12493e[_0x477de7(0xa35)]);for(const _0x479f85 of _0x5ee942){const _0x17c517=await new Promise(_0x20b204=>{const _0x4c0eec=_0x477de7,_0x1691ca=new FileReader();_0x1691ca[_0x4c0eec(0x833)]=()=>_0x20b204(_0x1691ca[_0x4c0eec(0x129)]),_0x1691ca[_0x4c0eec(0xbcf)](_0x479f85);});await _0x2a2987[_0x477de7(0xd37)]['add']({'albumId':_0x12493e[_0x477de7(0xa35)],'url':_0x17c517,'createdAt':Date[_0x477de7(0x6ee)]()});}const _0x5851d0=await _0x2a2987[_0x477de7(0xd37)][_0x477de7(0x8b5)](_0x477de7(0x28c))[_0x477de7(0x10bd)](_0x12493e[_0x477de7(0xa35)])['count'](),_0x3a7903={'photoCount':_0x5851d0};if(!_0x334d30[_0x477de7(0x21f)]||_0x334d30[_0x477de7(0x714)][_0x477de7(0x1d4)]('placeholder')){const _0x205549=await _0x2a2987[_0x477de7(0xd37)][_0x477de7(0x8b5)](_0x477de7(0x28c))[_0x477de7(0x10bd)](_0x12493e[_0x477de7(0xa35)])[_0x477de7(0x4e3)]();if(_0x205549)_0x3a7903['coverUrl']=_0x205549[_0x477de7(0x11a)];}await _0x2a2987[_0x477de7(0xe7b)][_0x477de7(0xb07)](_0x12493e[_0x477de7(0xa35)],_0x3a7903),await _0x5e7651(),await _0x383ac2(),_0x41338b[_0x477de7(0xe16)][_0x477de7(0x22a)]=null,alert('照片上传成功！');}),document['getElementById'](_0x128c7f(0x31e))['addEventListener'](_0x128c7f(0x335),async _0x3b0e65=>{const _0x3c3b17=_0x128c7f,_0x7526fb=_0x3b0e65['target'][_0x3c3b17(0x7a7)](_0x3c3b17(0x107d)),_0x420979=_0x3b0e65[_0x3c3b17(0xe16)][_0x3c3b17(0x7a7)](_0x3c3b17(0x953));if(_0x7526fb){_0x3b0e65['stopPropagation']();const _0x5c11b6=parseInt(_0x7526fb[_0x3c3b17(0x85)][_0x3c3b17(0x3ef)]),_0x1fa73f=await _0x270512('删除照片',_0x3c3b17(0xd76),{'confirmButtonClass':'btn-danger'});if(_0x1fa73f){const _0x43068e=await _0x2a2987[_0x3c3b17(0xd37)][_0x3c3b17(0xec0)](_0x5c11b6);if(!_0x43068e)return;await _0x2a2987['qzonePhotos'][_0x3c3b17(0x9ea)](_0x5c11b6);const _0x265642=await _0x2a2987[_0x3c3b17(0xe7b)][_0x3c3b17(0xec0)](_0x12493e['activeAlbumId']),_0x4c0e0a=(_0x265642[_0x3c3b17(0x21f)]||0x1)-0x1,_0x58eacf={'photoCount':_0x4c0e0a};if(_0x265642[_0x3c3b17(0x714)]===_0x43068e['url']){const _0x1d0fd4=await _0x2a2987[_0x3c3b17(0xd37)][_0x3c3b17(0x8b5)](_0x3c3b17(0x28c))['equals'](_0x12493e[_0x3c3b17(0xa35)])['first']();_0x58eacf[_0x3c3b17(0x714)]=_0x1d0fd4?_0x1d0fd4[_0x3c3b17(0x11a)]:'https://i.postimg.cc/pT2xKzPz/album-cover-placeholder.png';}await _0x2a2987[_0x3c3b17(0xe7b)]['update'](_0x12493e[_0x3c3b17(0xa35)],_0x58eacf),await _0x5e7651(),await _0x383ac2(),alert(_0x3c3b17(0x561));}}else _0x420979&&_0x4e9a82(_0x420979['src']);}),document[_0x128c7f(0xc33)](_0x128c7f(0x63d))['addEventListener']('click',_0x26c7da),document[_0x128c7f(0xc33)](_0x128c7f(0xbb8))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x2152ba),document[_0x128c7f(0xc33)]('photo-viewer-prev-btn')[_0x128c7f(0x205)](_0x128c7f(0x335),_0x5f2a6d),document[_0x128c7f(0x205)](_0x128c7f(0xef),_0x55e83c=>{const _0x183900=_0x128c7f;if(!_0x2af0fc[_0x183900(0x1d9)])return;if(_0x55e83c[_0x183900(0x10ae)]===_0x183900(0x1c8))_0x2152ba();else{if(_0x55e83c[_0x183900(0x10ae)]===_0x183900(0x11ce))_0x5f2a6d();else _0x55e83c[_0x183900(0x10ae)]==='Escape'&&_0x26c7da();}}),document[_0x128c7f(0xc33)]('create-album-btn-page')[_0x128c7f(0x205)](_0x128c7f(0x335),async()=>{const _0x41c04d=_0x128c7f,_0x42744a=await _0x1ca09c(_0x41c04d(0xe5b),_0x41c04d(0xe6e));if(_0x42744a&&_0x42744a[_0x41c04d(0x7da)]()){const _0x26fe8f={'name':_0x42744a[_0x41c04d(0x7da)](),'coverUrl':'https://i.postimg.cc/pT2xKzPz/album-cover-placeholder.png','photoCount':0x0,'createdAt':Date[_0x41c04d(0x6ee)]()};await _0x2a2987[_0x41c04d(0xe7b)][_0x41c04d(0xb9)](_0x26fe8f),await _0x383ac2(),alert(_0x41c04d(0x114d)+_0x42744a+_0x41c04d(0xe9b));}else _0x42744a!==null&&alert(_0x41c04d(0xb34));}),document[_0x128c7f(0xc33)](_0x128c7f(0x681))['addEventListener'](_0x128c7f(0x335),()=>document[_0x128c7f(0xc33)]('create-post-modal')[_0x128c7f(0x10d3)]['remove'](_0x128c7f(0x143))),document[_0x128c7f(0xc33)]('post-upload-local-btn')[_0x128c7f(0x205)](_0x128c7f(0x335),()=>document[_0x128c7f(0xc33)](_0x128c7f(0x1125))[_0x128c7f(0x335)]()),document[_0x128c7f(0xc33)]('post-local-image-input')[_0x128c7f(0x205)](_0x128c7f(0x644),_0x1f5061=>{const _0x3de6c3=_0x128c7f,_0xbed542=_0x1f5061[_0x3de6c3(0xe16)][_0x3de6c3(0x1d0)][0x0];if(_0xbed542){const _0x2d613e=new FileReader();_0x2d613e['onload']=_0x357f4a=>{const _0x2010de=_0x3de6c3;document[_0x2010de(0xc33)]('post-image-preview')[_0x2010de(0x87b)]=_0x357f4a['target'][_0x2010de(0x129)],document[_0x2010de(0xc33)](_0x2010de(0xf45))[_0x2010de(0x10d3)]['add'](_0x2010de(0x143)),document[_0x2010de(0xc33)](_0x2010de(0x10af))[_0x2010de(0x105d)]['display']=_0x2010de(0xa20);},_0x2d613e[_0x3de6c3(0xbcf)](_0xbed542);}}),document[_0x128c7f(0xc33)](_0x128c7f(0xbf))['addEventListener'](_0x128c7f(0x335),async()=>{const _0x39e212=_0x128c7f,_0x8df2f=await _0x1ca09c(_0x39e212(0xf9),_0x39e212(0x167),'',_0x39e212(0x11a));_0x8df2f&&(document[_0x39e212(0xc33)]('post-image-preview')[_0x39e212(0x87b)]=_0x8df2f,document['getElementById'](_0x39e212(0xf45))['classList'][_0x39e212(0xb9)](_0x39e212(0x143)),document[_0x39e212(0xc33)](_0x39e212(0x10af))[_0x39e212(0x105d)][_0x39e212(0xf44)]=_0x39e212(0xa20));}),document['getElementById'](_0x128c7f(0x1b3))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>_0x117b43());const _0x5d6059=document[_0x128c7f(0xc33)](_0x128c7f(0x11ef)),_0x3959f7=document[_0x128c7f(0xc33)](_0x128c7f(0xbb7)),_0x154ab8=document[_0x128c7f(0xc33)](_0x128c7f(0x640)),_0x707cc9=document['getElementById'](_0x128c7f(0xf82));_0x5d6059[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x1d2ae3=_0x128c7f;_0x5d6059[_0x1d2ae3(0x10d3)][_0x1d2ae3(0xb9)](_0x1d2ae3(0x1043)),_0x3959f7['classList']['remove'](_0x1d2ae3(0x1043)),_0x154ab8['classList'][_0x1d2ae3(0xb9)](_0x1d2ae3(0x1043)),_0x707cc9[_0x1d2ae3(0x10d3)]['remove'](_0x1d2ae3(0x1043));}),_0x3959f7['addEventListener'](_0x128c7f(0x335),()=>{const _0x4e552d=_0x128c7f;_0x3959f7[_0x4e552d(0x10d3)]['add'](_0x4e552d(0x1043)),_0x5d6059[_0x4e552d(0x10d3)][_0x4e552d(0x2c7)](_0x4e552d(0x1043)),_0x707cc9[_0x4e552d(0x10d3)][_0x4e552d(0xb9)](_0x4e552d(0x1043)),_0x154ab8[_0x4e552d(0x10d3)][_0x4e552d(0x2c7)]('active');}),document[_0x128c7f(0xc33)](_0x128c7f(0xa9b))[_0x128c7f(0x205)]('click',async()=>{const _0x4815bc=_0x128c7f,_0x1fc169=document[_0x4815bc(0xc33)](_0x4815bc(0xf3b)),_0x281660=_0x1fc169[_0x4815bc(0x85)][_0x4815bc(0xc03)],_0x18e48d=document[_0x4815bc(0x977)](_0x4815bc(0x10f0))['value'];let _0xb28389=null;_0x18e48d===_0x4815bc(0xee2)&&(_0xb28389=Array['from'](document[_0x4815bc(0x67a)]('input[name=\x22visibility_group\x22]:checked'))[_0x4815bc(0x9d5)](_0x241b15=>parseInt(_0x241b15[_0x4815bc(0x22a)])));let _0x41324b={};const _0x275c12={'timestamp':Date['now'](),'authorId':_0x4815bc(0x717),'visibleGroupIds':_0xb28389};if(_0x281660===_0x4815bc(0x5c4)){const _0x184fc5=document['getElementById'](_0x4815bc(0x135))[_0x4815bc(0x22a)][_0x4815bc(0x7da)]();if(!_0x184fc5){alert('说说内容不能为空哦！');return;}_0x41324b={..._0x275c12,'type':'shuoshuo','content':_0x184fc5};}else{const _0x437404=document[_0x4815bc(0xc33)]('post-public-text')[_0x4815bc(0x22a)][_0x4815bc(0x7da)](),_0x10b6a0=document[_0x4815bc(0xc33)](_0x4815bc(0x640))[_0x4815bc(0x10d3)][_0x4815bc(0x3af)](_0x4815bc(0x1043));if(_0x10b6a0){const _0x40e714=document[_0x4815bc(0xc33)]('post-image-preview')[_0x4815bc(0x87b)],_0x189fe3=document[_0x4815bc(0xc33)](_0x4815bc(0x4ff))[_0x4815bc(0x22a)][_0x4815bc(0x7da)]();if(!_0x40e714||!(_0x40e714[_0x4815bc(0xece)](_0x4815bc(0xd8d))||_0x40e714[_0x4815bc(0xece)](_0x4815bc(0x351)))){alert(_0x4815bc(0x1291));return;}if(!_0x189fe3){alert(_0x4815bc(0x95d));return;}_0x41324b={..._0x275c12,'type':_0x4815bc(0x6ed),'publicText':_0x437404,'imageUrl':_0x40e714,'imageDescription':_0x189fe3};}else{const _0x1cab5d=document[_0x4815bc(0xc33)](_0x4815bc(0xe3c))[_0x4815bc(0x22a)][_0x4815bc(0x7da)]();if(!_0x1cab5d){alert(_0x4815bc(0x765));return;}_0x41324b={..._0x275c12,'type':'text_image','publicText':_0x437404,'hiddenContent':_0x1cab5d};}}const _0x205983=await _0x2a2987['qzonePosts']['add'](_0x41324b);let _0x46c4b0=_0x41324b[_0x4815bc(0xcbd)]||_0x41324b[_0x4815bc(0x964)]||_0x41324b[_0x4815bc(0x555)]||_0x41324b[_0x4815bc(0xc2e)]||_0x4815bc(0x97);_0x46c4b0=_0x46c4b0[_0x4815bc(0x1033)](0x0,0x32)+(_0x46c4b0[_0x4815bc(0x79b)]>0x32?_0x4815bc(0xda0):'');for(const _0x51bb23 in _0x12493e[_0x4815bc(0xc45)]){const _0x3f42f1=_0x12493e['chats'][_0x51bb23];if(_0x3f42f1[_0x4815bc(0x80b)])continue;let _0x5b5bc6=![];const _0x2c205b=_0x41324b[_0x4815bc(0xbd)];if(!_0x2c205b||_0x2c205b[_0x4815bc(0x79b)]===0x0)_0x5b5bc6=!![];else _0x3f42f1[_0x4815bc(0x780)]&&_0x2c205b[_0x4815bc(0x1d4)](_0x3f42f1[_0x4815bc(0x780)])&&(_0x5b5bc6=!![]);if(_0x5b5bc6){const _0xb6d0c5={'role':'system','content':_0x4815bc(0xe0a)+_0x205983+_0x4815bc(0x8b6)+_0x46c4b0+_0x4815bc(0x625),'timestamp':Date['now'](),'isHidden':!![]};_0x3f42f1[_0x4815bc(0x1294)]['push'](_0xb6d0c5),await _0x2a2987['chats'][_0x4815bc(0xf36)](_0x3f42f1);}}await _0x14f3b0(),_0x1fc169['classList'][_0x4815bc(0x2c7)](_0x4815bc(0x143)),alert('动态发布成功！');});const _0x21c079=document['getElementById']('qzone-posts-list');let _0x218e36={'isDragging':![],'startX':0x0,'startY':0x0,'currentX':0x0,'activeContainer':null,'swipeDirection':null,'isClick':!![]};function _0xf256e(_0x1831f8=null){const _0x3d89be=_0x128c7f;document[_0x3d89be(0x67a)]('.qzone-post-container')['forEach'](_0x2c78ad=>{const _0x9cfd58=_0x3d89be;_0x2c78ad!==_0x1831f8&&_0x2c78ad[_0x9cfd58(0x977)]('.qzone-post-item')[_0x9cfd58(0x10d3)][_0x9cfd58(0x2c7)](_0x9cfd58(0x4a7));});}async function _0xfbc1a8(_0x36a496){const _0x266b29=_0x128c7f;_0x36a496[_0x266b29(0xea2)]();const _0x387719=_0x36a496[_0x266b29(0xe16)],_0x49c722=_0x387719[_0x266b29(0x7a7)](_0x266b29(0x38b));if(_0x49c722){const _0x2cf523=_0x49c722[_0x266b29(0x7a7)](_0x266b29(0x389)),_0xe6e50d=parseInt(_0x2cf523[_0x266b29(0x85)][_0x266b29(0x337)]),_0x18a6f4=parseInt(_0x49c722[_0x266b29(0x85)][_0x266b29(0x11b9)]);if(isNaN(_0xe6e50d)||isNaN(_0x18a6f4))return;const _0x35e4b7=_0x2c7a9f[_0x266b29(0xd85)](_0x42dcd8=>_0x42dcd8['id']===_0xe6e50d);if(!_0x35e4b7||!_0x35e4b7[_0x266b29(0xc83)]||!_0x35e4b7['comments'][_0x18a6f4])return;const _0x24eac6=_0x35e4b7[_0x266b29(0xc83)][_0x18a6f4],_0x29dc55=await _0x270512(_0x266b29(0xe12),_0x266b29(0x7f6),{'confirmButtonClass':_0x266b29(0xa2)});if(_0x29dc55){_0x35e4b7[_0x266b29(0xc83)][_0x266b29(0xbd1)](_0x18a6f4,0x1),await _0x2a2987[_0x266b29(0x110b)][_0x266b29(0xb07)](_0xe6e50d,{'comments':_0x35e4b7[_0x266b29(0xc83)]});if(_0x24eac6&&_0x24eac6[_0x266b29(0xfd9)]===_0x12493e[_0x266b29(0x76c)][_0x266b29(0x66a)]){console[_0x266b29(0x51f)]('用户删除了自己的评论，开始清理AI记忆...');const _0x2806b6=new Set();_0x35e4b7['authorId']!==_0x266b29(0x717)&&_0x2806b6[_0x266b29(0xb9)](_0x35e4b7['authorId']);if(_0x24eac6[_0x266b29(0x108)]){const _0x4217d2=Object[_0x266b29(0xd28)](_0x12493e['chats'])[_0x266b29(0xd85)](_0x5805cf=>_0x5805cf[_0x266b29(0x776)]===_0x24eac6[_0x266b29(0x108)]);_0x4217d2&&_0x2806b6[_0x266b29(0xb9)](_0x4217d2['id']);}const _0x1b8d57=(_0x35e4b7[_0x266b29(0x964)]||_0x35e4b7['content']||'')[_0x266b29(0x1033)](0x0,0x1e),_0x7832b5=_0x12493e['qzoneSettings'][_0x266b29(0x66a)];let _0x76afe4;const _0x5643b3=_0x12493e['userStickers'][_0x266b29(0xd85)](_0x2a012b=>_0x2a012b['url']===_0x24eac6[_0x266b29(0x996)]);if(_0x5643b3)_0x76afe4=_0x266b29(0x4eb)+_0x7832b5+'\x27刚刚在你的动态“'+_0x1b8d57+_0x266b29(0x114b)+_0x5643b3[_0x266b29(0x578)]+'”。';else{if(_0x24eac6[_0x266b29(0x108)]){const _0x31f94a=_0x1353b6(_0x24eac6[_0x266b29(0x108)]);_0x76afe4=_0x266b29(0x4eb)+_0x7832b5+_0x266b29(0x112c)+_0x1b8d57+_0x266b29(0x114c)+_0x31f94a+'\x27的评论，内容是：“'+_0x24eac6['text']+'”。';}else _0x76afe4='用户\x27'+_0x7832b5+_0x266b29(0x9bc)+_0x1b8d57+'”，内容是：“'+_0x24eac6[_0x266b29(0x996)]+'”。';}const _0x4f9e02=_0x266b29(0x1b9)+_0x76afe4+'请你对此作出回应。]';for(const _0x327291 of _0x2806b6){const _0x97fd84=_0x12493e[_0x266b29(0xc45)][_0x327291];if(_0x97fd84){const _0x38c8ef=_0x97fd84[_0x266b29(0x1294)]['length'];_0x97fd84[_0x266b29(0x1294)]=_0x97fd84[_0x266b29(0x1294)][_0x266b29(0x1054)](_0x43de11=>!(_0x43de11[_0x266b29(0xd07)]&&_0x43de11[_0x266b29(0x16d)]==='system'&&_0x43de11['content']===_0x4f9e02)),_0x97fd84[_0x266b29(0x1294)][_0x266b29(0x79b)]<_0x38c8ef&&(console[_0x266b29(0x51f)](_0x266b29(0x1231)+_0x97fd84['name']+_0x266b29(0x668)),await _0x2a2987[_0x266b29(0xc45)]['put'](_0x97fd84));}}}await _0x1994cd(_0xe6e50d);}return;}const _0x3e713e=_0x387719[_0x266b29(0x7a7)](_0x266b29(0x15e));if(_0x3e713e){const _0x4f0c6c=_0x3e713e[_0x266b29(0x7a7)](_0x266b29(0x389));if(!_0x4f0c6c)return;const _0x5a5264=parseInt(_0x4f0c6c[_0x266b29(0x85)]['postId']);_0xff941a[_0x266b29(0x1d9)]&&_0xff941a[_0x266b29(0x401)]===_0x5a5264?_0x473cb3():_0x2019e9(_0x5a5264,_0x3e713e);return;}const _0x1ee301=_0x387719['closest'](_0x266b29(0x1063));if(_0x1ee301){const _0x2a884e=parseInt(_0x1ee301[_0x266b29(0x85)][_0x266b29(0x337)]),_0x11b982=_0x1ee301[_0x266b29(0x85)][_0x266b29(0x2a2)],_0x11cb0a=_0x1ee301[_0x266b29(0x85)][_0x266b29(0x10f)];if(!_0x11b982||!_0x11cb0a||_0x11b982===_0x12493e['qzoneSettings'][_0x266b29(0x66a)]){_0x20a97f(_0x1ee301['closest']('.qzone-post-container'));return;}_0x26a58f={'postId':_0x2a884e,'replyToName':_0x11b982,'replyToDisplayName':_0x11cb0a};const _0x3f2862=_0x1ee301[_0x266b29(0x7a7)]('.qzone-post-container'),_0x1f4d8f=_0x3f2862[_0x266b29(0x977)](_0x266b29(0x457));_0x1f4d8f['placeholder']='回复\x20'+_0x11cb0a+':',_0x1f4d8f['focus']();return;}if(_0x387719[_0x266b29(0x10d3)][_0x266b29(0x3af)](_0x266b29(0x6ba))){const _0x126d7f=_0x387719[_0x266b29(0x7a7)](_0x266b29(0x389));if(_0x126d7f&&_0x126d7f[_0x266b29(0x85)]['postId'])_0x2ae560(parseInt(_0x126d7f['dataset'][_0x266b29(0x337)]));return;}if(_0x387719[_0x266b29(0x539)]===_0x266b29(0xf8c)&&_0x387719['dataset'][_0x266b29(0x1ba)]){_0x2d7ddd('图片内容',_0x387719['dataset'][_0x266b29(0x1ba)][_0x266b29(0xc12)](/<br>/g,'\x0a'));return;}const _0x3eac55=_0x387719[_0x266b29(0x7a7)](_0x266b29(0x389));if(!_0x3eac55)return;const _0x2816a1=parseInt(_0x3eac55[_0x266b29(0x85)]['postId']);if(isNaN(_0x2816a1))return;if(_0x387719[_0x266b29(0x7a7)]('.qzone-post-delete-action')){const _0x33a48a=await _0x270512(_0x266b29(0x8fe),_0x266b29(0xdd7),{'confirmButtonClass':_0x266b29(0xa2)});_0x33a48a&&(_0x3eac55[_0x266b29(0x105d)][_0x266b29(0x51a)]=_0x266b29(0x1060),_0x3eac55[_0x266b29(0x105d)]['transform']=_0x266b29(0xca7),_0x3eac55[_0x266b29(0x105d)][_0x266b29(0x8d1)]='0',setTimeout(async()=>{const _0x542791=_0x266b29;await _0x2a2987['qzonePosts'][_0x542791(0x9ea)](_0x2816a1);const _0x39400e=_0x542791(0xcd7)+_0x2816a1+')';for(const _0x2e4097 in _0x12493e[_0x542791(0xc45)]){const _0x115bdf=_0x12493e[_0x542791(0xc45)][_0x2e4097],_0xa476c8=_0x115bdf[_0x542791(0x1294)]['length'];_0x115bdf[_0x542791(0x1294)]=_0x115bdf[_0x542791(0x1294)][_0x542791(0x1054)](_0x2051f9=>!(_0x2051f9[_0x542791(0x16d)]===_0x542791(0x152)&&_0x2051f9[_0x542791(0xcbd)]['includes'](_0x39400e)));if(_0x115bdf[_0x542791(0x1294)][_0x542791(0x79b)]<_0xa476c8)await _0x2a2987[_0x542791(0xc45)][_0x542791(0xf36)](_0x115bdf);}await _0x14f3b0(),alert(_0x542791(0x20f));},0x12c));return;}const _0x3e898c=_0x387719[_0x266b29(0x7a7)](_0x266b29(0xd86));if(_0x3e898c){if(_0x3e898c[_0x266b29(0x10d3)]['contains']('repost')){_0x20de06(_0x2816a1);return;}if(_0x3e898c[_0x266b29(0x10d3)][_0x266b29(0x3af)](_0x266b29(0x1142))){const _0x7a37eb=_0x2c7a9f[_0x266b29(0xd85)](_0x5cb047=>_0x5cb047['id']===_0x2816a1);if(!_0x7a37eb)return;if(!_0x7a37eb[_0x266b29(0x615)])_0x7a37eb[_0x266b29(0x615)]=[];const _0x2cbd2f=_0x12493e[_0x266b29(0x76c)][_0x266b29(0x66a)],_0x23cfeb=_0x7a37eb[_0x266b29(0x615)]['indexOf'](_0x2cbd2f);_0x23cfeb>-0x1?_0x7a37eb[_0x266b29(0x615)][_0x266b29(0xbd1)](_0x23cfeb,0x1):(_0x7a37eb[_0x266b29(0x615)]['push'](_0x2cbd2f),_0x3e898c['classList']['add'](_0x266b29(0x398)),_0x3e898c[_0x266b29(0x205)]('animationend',()=>_0x3e898c['classList'][_0x266b29(0x2c7)](_0x266b29(0x398)),{'once':!![]})),await _0x2a2987[_0x266b29(0x110b)][_0x266b29(0xb07)](_0x2816a1,{'likes':_0x7a37eb[_0x266b29(0x615)]}),await _0x1994cd(_0x2816a1);}if(_0x3e898c[_0x266b29(0x10d3)][_0x266b29(0x3af)](_0x266b29(0x328))){const _0x5b9d8d=await _0x2a2987['favorites']['where']({'type':_0x266b29(0x4a1),'content.id':_0x2816a1})[_0x266b29(0x4e3)]();if(_0x5b9d8d)await _0x2a2987['favorites'][_0x266b29(0x9ea)](_0x5b9d8d['id']),await _0x2d7ddd('提示',_0x266b29(0xba3));else{const _0x3e88eb=await _0x2a2987[_0x266b29(0x110b)]['get'](_0x2816a1);_0x3e88eb&&(await _0x2a2987[_0x266b29(0xe69)][_0x266b29(0xb9)]({'type':_0x266b29(0x4a1),'content':_0x3e88eb,'timestamp':Date['now']()}),await _0x2d7ddd('提示',_0x266b29(0xe20)));}await _0x1994cd(_0x2816a1);}return;}const _0x1199bc=_0x387719['closest'](_0x266b29(0x1280));if(_0x1199bc){const _0x58d045=_0x3eac55[_0x266b29(0x977)](_0x266b29(0x457)),_0x8821c8=_0x58d045['value'][_0x266b29(0x7da)]();if(!_0x8821c8)return alert('评论内容不能为空哦！');const _0x3ebf30=_0x2c7a9f['find'](_0xcb4c6d=>_0xcb4c6d['id']===_0x2816a1);if(!_0x3ebf30)return;if(!_0x3ebf30[_0x266b29(0xc83)])_0x3ebf30[_0x266b29(0xc83)]=[];const _0x309e52={'commenterName':_0x12493e[_0x266b29(0x76c)][_0x266b29(0x66a)],'text':_0x8821c8,'timestamp':Date[_0x266b29(0x6ee)](),'replyTo':_0x26a58f&&_0x26a58f[_0x266b29(0x337)]===_0x2816a1?_0x26a58f[_0x266b29(0x409)]:null};_0x3ebf30[_0x266b29(0xc83)][_0x266b29(0x2d6)](_0x309e52),await _0x2a2987[_0x266b29(0x110b)][_0x266b29(0xb07)](_0x2816a1,{'comments':_0x3ebf30['comments']});let _0x211d7a=(_0x3ebf30[_0x266b29(0x964)]||_0x3ebf30[_0x266b29(0xcbd)]||'')['substring'](0x0,0x1e);const _0x32fa2b=_0x12493e[_0x266b29(0x76c)]['nickname'],_0x208a77=new Set();if(_0x3ebf30[_0x266b29(0xd48)]!==_0x266b29(0x717))_0x208a77[_0x266b29(0xb9)](_0x3ebf30[_0x266b29(0xd48)]);if(_0x309e52[_0x266b29(0x108)]&&_0x309e52[_0x266b29(0x108)]!==_0x32fa2b){const _0x1c763f=Object['values'](_0x12493e[_0x266b29(0xc45)])['find'](_0x39ce60=>_0x39ce60[_0x266b29(0x776)]===_0x309e52[_0x266b29(0x108)]);if(_0x1c763f)_0x208a77[_0x266b29(0xb9)](_0x1c763f['id']);}for(const _0x5cb857 of _0x208a77){const _0x28e27c=_0x12493e['chats'][_0x5cb857];if(_0x28e27c&&!_0x28e27c[_0x266b29(0x80b)]){const _0xfe03ef=_0x12493e[_0x266b29(0x454)][_0x266b29(0xd85)](_0x2dd09e=>_0x2dd09e[_0x266b29(0x11a)]===_0x8821c8);let _0x12b537=_0xfe03ef?_0x266b29(0x4eb)+_0x32fa2b+_0x266b29(0x112c)+_0x211d7a+_0x266b29(0x114b)+_0xfe03ef[_0x266b29(0x578)]+'”。':_0x309e52[_0x266b29(0x108)]?_0x266b29(0x4eb)+_0x32fa2b+'\x27刚刚在你的动态“'+_0x211d7a+_0x266b29(0x114c)+_0x26a58f[_0x266b29(0x34c)]+_0x266b29(0x930)+_0x8821c8+'”。':_0x266b29(0x4eb)+_0x32fa2b+_0x266b29(0x9bc)+_0x211d7a+_0x266b29(0x8b2)+_0x8821c8+'”。';const _0x15646e={'role':'system','content':'[系统提示：'+_0x12b537+_0x266b29(0x790),'timestamp':Date[_0x266b29(0x6ee)](),'isHidden':!![]};_0x28e27c['history'][_0x266b29(0x2d6)](_0x15646e),await _0x2a2987[_0x266b29(0xc45)]['put'](_0x28e27c);}}_0x58d045['value']='',_0x20a97f(_0x3eac55),await _0x1994cd(_0x2816a1);return;}}const _0xdb6f98=_0x20ab33=>{const _0x21bbf4=_0x128c7f,_0xbd8a5e=_0x20ab33[_0x21bbf4(0xe16)];if(_0xbd8a5e[_0x21bbf4(0x7a7)](_0x21bbf4(0x1a1)))return;const _0x5e885f=_0x20ab33[_0x21bbf4(0xe16)][_0x21bbf4(0x7a7)]('.qzone-post-container');if(!_0x5e885f)return;_0xf256e(_0x5e885f),_0x218e36[_0x21bbf4(0x1123)]=_0x5e885f,_0x218e36[_0x21bbf4(0xfab)]=!![],_0x218e36['isClick']=!![],_0x218e36[_0x21bbf4(0xac)]=null,_0x218e36[_0x21bbf4(0x5f2)]=_0x20ab33['type'][_0x21bbf4(0x1d4)](_0x21bbf4(0x3ea))?_0x20ab33[_0x21bbf4(0xe9f)]:_0x20ab33[_0x21bbf4(0xc01)][0x0][_0x21bbf4(0xe9f)],_0x218e36[_0x21bbf4(0x735)]=_0x20ab33['type']['includes']('mouse')?_0x20ab33[_0x21bbf4(0xc31)]:_0x20ab33['touches'][0x0][_0x21bbf4(0xc31)],_0x218e36[_0x21bbf4(0x1123)][_0x21bbf4(0x977)](_0x21bbf4(0x1038))[_0x21bbf4(0x105d)][_0x21bbf4(0x51a)]=_0x21bbf4(0x854),document[_0x21bbf4(0x205)](_0x21bbf4(0x538),_0x2fade6),document[_0x21bbf4(0x205)]('mouseup',_0x5a113b),document[_0x21bbf4(0x205)]('touchmove',_0x2fade6,{'passive':![]}),document[_0x21bbf4(0x205)](_0x21bbf4(0x706),_0x5a113b);},_0x2fade6=_0x993b4=>{const _0xd0d4b6=_0x128c7f;if(!_0x218e36[_0xd0d4b6(0xfab)]||!_0x218e36[_0xd0d4b6(0x1123)])return;const _0x42180e=_0x993b4[_0xd0d4b6(0x52a)][_0xd0d4b6(0x1d4)]('mouse')?_0x993b4[_0xd0d4b6(0xe9f)]:_0x993b4['touches'][0x0][_0xd0d4b6(0xe9f)],_0x1b9004=_0x993b4[_0xd0d4b6(0x52a)][_0xd0d4b6(0x1d4)](_0xd0d4b6(0x3ea))?_0x993b4['pageY']:_0x993b4[_0xd0d4b6(0xc01)][0x0]['pageY'],_0x3e15c2=_0x42180e-_0x218e36[_0xd0d4b6(0x5f2)],_0x4bbfe8=_0x1b9004-_0x218e36[_0xd0d4b6(0x735)];_0x218e36['isClick']&&(Math[_0xd0d4b6(0x2e0)](_0x3e15c2)>0x5||Math[_0xd0d4b6(0x2e0)](_0x4bbfe8)>0x5)&&(_0x218e36['isClick']=![]);!_0x218e36['swipeDirection']&&(Math[_0xd0d4b6(0x2e0)](_0x3e15c2)>Math[_0xd0d4b6(0x2e0)](_0x4bbfe8)?_0x218e36[_0xd0d4b6(0xac)]=_0xd0d4b6(0x1070):_0x218e36[_0xd0d4b6(0xac)]='vertical');if(_0x218e36[_0xd0d4b6(0xac)]===_0xd0d4b6(0x1070)){_0x993b4['preventDefault'](),_0x218e36['currentX']=_0x42180e;let _0x11aa87=Math[_0xd0d4b6(0x755)](0x0,Math[_0xd0d4b6(0xbf8)](-0x5a,_0x3e15c2));_0x218e36[_0xd0d4b6(0x1123)][_0xd0d4b6(0x977)](_0xd0d4b6(0x1038))['style'][_0xd0d4b6(0x404)]=_0xd0d4b6(0x12af)+_0x11aa87+_0xd0d4b6(0x8e9);}},_0x5a113b=_0x5ba99a=>{const _0x379299=_0x128c7f;document[_0x379299(0xb52)](_0x379299(0x538),_0x2fade6),document[_0x379299(0xb52)]('mouseup',_0x5a113b),document['removeEventListener'](_0x379299(0xe66),_0x2fade6),document[_0x379299(0xb52)](_0x379299(0x706),_0x5a113b);if(!_0x218e36[_0x379299(0xfab)]||!_0x218e36[_0x379299(0x1123)])return;const _0x34be6c=_0x218e36['activeContainer'][_0x379299(0x977)]('.qzone-post-item');_0x34be6c[_0x379299(0x105d)][_0x379299(0x51a)]=_0x379299(0xb33);if(_0x218e36[_0x379299(0xac)]===_0x379299(0x1070)&&!_0x218e36[_0x379299(0xff3)]){const _0x46bb73=_0x5ba99a['type']['includes'](_0x379299(0x706))?_0x5ba99a[_0x379299(0x10c2)][0x0][_0x379299(0xe9f)]:_0x5ba99a[_0x379299(0xe9f)],_0x24f467=_0x46bb73-_0x218e36[_0x379299(0x5f2)];_0x24f467<-0x28?_0x34be6c['classList']['add'](_0x379299(0x4a7)):_0x34be6c[_0x379299(0x10d3)]['remove']('swiped');}_0x34be6c[_0x379299(0x105d)][_0x379299(0x404)]='',_0x218e36[_0x379299(0xfab)]=![],_0x218e36[_0x379299(0x1123)]=null,_0x218e36[_0x379299(0xac)]=null,_0x218e36[_0x379299(0xff3)]=!![];};_0x21c079[_0x128c7f(0x205)](_0x128c7f(0x335),_0xfbc1a8),_0x21c079[_0x128c7f(0x205)](_0x128c7f(0x9e6),_0xdb6f98),_0x21c079['addEventListener'](_0x128c7f(0x4b1),_0xdb6f98,{'passive':!![]}),_0x21c079[_0x128c7f(0x205)](_0x128c7f(0x335),_0x4c6fd7=>{const _0xee7640=_0x128c7f;_0x4c6fd7['target']&&_0x4c6fd7[_0xee7640(0xe16)]['id']===_0xee7640(0x403)&&_0x334be8();}),document['getElementById'](_0x128c7f(0xb25))[_0x128c7f(0x205)]('click',()=>{const _0xc1bacf=_0x128c7f;_0x12493e[_0xc1bacf(0x7bc)]&&_0x36c719(_0x12493e[_0xc1bacf(0x7bc)]);}),document[_0x128c7f(0xc33)]('api-preset-select')[_0x128c7f(0x205)]('change',_0x30dbd0),document[_0x128c7f(0xc33)](_0x128c7f(0x544))['addEventListener']('click',_0x1f8d9f),document[_0x128c7f(0xc33)](_0x128c7f(0xfad))['addEventListener'](_0x128c7f(0x335),_0x5d821d),document[_0x128c7f(0xc33)](_0x128c7f(0xd1b))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0xa67184=_0x128c7f,_0x5c9951=document['getElementById'](_0xa67184(0xd7a));_0x5c9951[_0xa67184(0x977)]('p')&&(_0x5c9951[_0xa67184(0x102a)]='');const _0x263115=_0x535ca1();_0x5c9951['appendChild'](_0x263115),_0x263115[_0xa67184(0x977)]('.entry-content-textarea')[_0xa67184(0xd59)]();}),document[_0x128c7f(0xc33)]('switch-greeting-btn')['addEventListener'](_0x128c7f(0x335),_0x4f52ba),document['getElementById'](_0x128c7f(0xa1c))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x3a11a3=>{const _0x201919=_0x128c7f;_0x3a11a3[_0x201919(0xe16)]&&_0x3a11a3[_0x201919(0xe16)]['id']===_0x201919(0x117a)&&_0x4b642c();}),document[_0x128c7f(0xc33)](_0x128c7f(0x4b2))[_0x128c7f(0x205)]('click',_0x318890),document[_0x128c7f(0xc33)](_0x128c7f(0x10c5))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x4958eb),document[_0x128c7f(0xc33)](_0x128c7f(0x4bd))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x1e0634=>{const _0xee8603=_0x128c7f;_0x1e0634[_0xee8603(0xe16)]['id']==='character-profile-modal'&&_0x1e0634[_0xee8603(0xe16)][_0xee8603(0x10d3)][_0xee8603(0x2c7)](_0xee8603(0x143));}),document[_0x128c7f(0xc33)](_0x128c7f(0x11a1))[_0x128c7f(0x205)]('click',_0x3d7652),document[_0x128c7f(0xc33)](_0x128c7f(0xf5a))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x44962a),document['getElementById'](_0x128c7f(0x5e7))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>_0x598e0c(_0x128c7f(0x2fa))),document[_0x128c7f(0xc33)](_0x128c7f(0x7de))['addEventListener'](_0x128c7f(0x335),()=>_0x598e0c('messages-view'));const _0x8279f9=document[_0x128c7f(0xc33)]('favorites-search-input'),_0x51c1c8=document[_0x128c7f(0xc33)](_0x128c7f(0xa68));_0x8279f9[_0x128c7f(0x205)](_0x128c7f(0x36e),()=>{const _0x5b1cda=_0x128c7f,_0x430ccf=_0x8279f9[_0x5b1cda(0x22a)][_0x5b1cda(0x7da)]()[_0x5b1cda(0x963)]();_0x51c1c8[_0x5b1cda(0x105d)][_0x5b1cda(0xf44)]=_0x430ccf?_0x5b1cda(0xa20):_0x5b1cda(0x854);if(!_0x430ccf){_0x1627b8(allFavoriteItems);return;}const _0x35154c=allFavoriteItems['filter'](_0x58c8fc=>{const _0x30cf11=_0x5b1cda;let _0x459e98='',_0x134cb4='';if(_0x58c8fc['type']===_0x30cf11(0x4a1)){const _0x504269=_0x58c8fc[_0x30cf11(0xcbd)];_0x459e98+=(_0x504269[_0x30cf11(0x964)]||'')+'\x20'+(_0x504269['content']||'');if(_0x504269[_0x30cf11(0xd48)]===_0x30cf11(0x717))_0x134cb4=_0x12493e['qzoneSettings'][_0x30cf11(0x66a)];else _0x12493e[_0x30cf11(0xc45)][_0x504269['authorId']]&&(_0x134cb4=_0x12493e['chats'][_0x504269[_0x30cf11(0xd48)]][_0x30cf11(0x578)]);}else{if(_0x58c8fc[_0x30cf11(0x52a)]==='chat_message'){const _0x2e13dc=_0x58c8fc[_0x30cf11(0xcbd)];typeof _0x2e13dc[_0x30cf11(0xcbd)]==='string'&&(_0x459e98=_0x2e13dc[_0x30cf11(0xcbd)]);const _0x1466b7=_0x12493e[_0x30cf11(0xc45)][_0x58c8fc[_0x30cf11(0x109b)]];_0x1466b7&&(_0x2e13dc[_0x30cf11(0x16d)]===_0x30cf11(0x717)?_0x134cb4=_0x1466b7['isGroup']?_0x1466b7['settings'][_0x30cf11(0xbf6)]||'我':'我':_0x134cb4=_0x1466b7[_0x30cf11(0x80b)]?_0x2e13dc[_0x30cf11(0xe32)]:_0x1466b7[_0x30cf11(0x578)]);}}return _0x459e98[_0x30cf11(0x963)]()['includes'](_0x430ccf)||_0x134cb4[_0x30cf11(0x963)]()[_0x30cf11(0x1d4)](_0x430ccf);});_0x1627b8(_0x35154c);}),_0x51c1c8[_0x128c7f(0x205)]('click',()=>{const _0x2665e1=_0x128c7f;_0x8279f9[_0x2665e1(0x22a)]='',_0x51c1c8[_0x2665e1(0x105d)][_0x2665e1(0xf44)]=_0x2665e1(0x854),_0x1627b8(allFavoriteItems),_0x8279f9[_0x2665e1(0xd59)]();}),document[_0x128c7f(0xc33)](_0x128c7f(0xa2b))['addEventListener']('click',async()=>{const _0x56a943=_0x128c7f;if(_0x2078e5[_0x56a943(0x57e)]===0x0)return;const _0xfbff26=_0x12493e[_0x56a943(0xc45)][_0x12493e[_0x56a943(0x7bc)]];if(!_0xfbff26)return;const _0x55f1d2=[],_0x11c7b2=[..._0x2078e5];for(const _0x3d0ab3 of _0x11c7b2){const _0x28b618=await _0x2a2987[_0x56a943(0xe69)][_0x56a943(0x8b5)](_0x56a943(0xebc))[_0x56a943(0x10bd)](_0x3d0ab3)[_0x56a943(0x4e3)]();if(!_0x28b618){const _0xb677ec=_0xfbff26[_0x56a943(0x1294)][_0x56a943(0xd85)](_0x336770=>_0x336770[_0x56a943(0x2f0)]===_0x3d0ab3);_0xb677ec&&_0x55f1d2[_0x56a943(0x2d6)]({'type':'chat_message','content':_0xb677ec,'chatId':_0x12493e[_0x56a943(0x7bc)],'timestamp':Date['now'](),'originalTimestamp':_0xb677ec[_0x56a943(0x2f0)]});}}_0x55f1d2[_0x56a943(0x79b)]>0x0?(await _0x2a2987[_0x56a943(0xe69)][_0x56a943(0x3ab)](_0x55f1d2),allFavoriteItems=await _0x2a2987[_0x56a943(0xe69)][_0x56a943(0xde3)]('timestamp')[_0x56a943(0xc07)]()[_0x56a943(0xf15)](),await _0x2d7ddd(_0x56a943(0x217),'已成功收藏\x20'+_0x55f1d2[_0x56a943(0x79b)]+'\x20条消息。')):await _0x2d7ddd('提示',_0x56a943(0x116b)),_0x5e1dc2();});const _0x33c46e=document['getElementById'](_0x128c7f(0x1037)),_0x338ce6=document[_0x128c7f(0xc33)](_0x128c7f(0x5b1)),_0x35c07a=document[_0x128c7f(0xc33)](_0x128c7f(0x1260)),_0xfc5007=document['getElementById'](_0x128c7f(0x8d0)),_0x357d68=document[_0x128c7f(0xc33)](_0x128c7f(0xdf6));_0x33c46e[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x389ec3=_0x128c7f;_0x464ccd=!_0x464ccd,_0x338ce6['classList'][_0x389ec3(0xe2c)](_0x389ec3(0xfed),_0x464ccd),_0x464ccd?(_0x33c46e[_0x389ec3(0x11b0)]='完成',_0x35c07a['style']['display']='block',_0xfc5007['style']['display']='none',_0x357d68[_0x389ec3(0x105d)][_0x389ec3(0xa76)]=_0x389ec3(0xdfd)):(_0x33c46e[_0x389ec3(0x11b0)]='编辑',_0x35c07a[_0x389ec3(0x105d)][_0x389ec3(0xf44)]=_0x389ec3(0x854),_0xfc5007['style'][_0x389ec3(0xf44)]=_0x389ec3(0x21a),_0x357d68[_0x389ec3(0x105d)][_0x389ec3(0xa76)]='',_0x32a677[_0x389ec3(0xebb)](),document['querySelectorAll'](_0x389ec3(0x560))[_0x389ec3(0xd6a)](_0x42dc0c=>_0x42dc0c[_0x389ec3(0x10d3)][_0x389ec3(0x2c7)](_0x389ec3(0x63f))),document[_0x389ec3(0xc33)](_0x389ec3(0xf2))['textContent']=_0x389ec3(0xaaa));}),document['getElementById'](_0x128c7f(0xdf6))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x28a1c2=>{const _0x42bb6d=_0x128c7f,_0x15b81a=_0x28a1c2[_0x42bb6d(0xe16)],_0x414372=_0x15b81a[_0x42bb6d(0x7a7)](_0x42bb6d(0x6ff));if(_0x15b81a[_0x42bb6d(0x539)]===_0x42bb6d(0xf8c)&&_0x15b81a[_0x42bb6d(0x85)]['hiddenText']){const _0x5d6e0a=_0x15b81a[_0x42bb6d(0x85)][_0x42bb6d(0x1ba)];_0x2d7ddd(_0x42bb6d(0x1233),_0x5d6e0a[_0x42bb6d(0xc12)](/<br>/g,'\x0a'));return;}if(!_0x464ccd)return;if(!_0x414372)return;const _0x2e38d9=parseInt(_0x414372['dataset'][_0x42bb6d(0x3a3)]);if(isNaN(_0x2e38d9))return;_0x32a677[_0x42bb6d(0xa7)](_0x2e38d9)?(_0x32a677[_0x42bb6d(0x9ea)](_0x2e38d9),_0x414372[_0x42bb6d(0x10d3)]['remove']('selected')):(_0x32a677[_0x42bb6d(0xb9)](_0x2e38d9),_0x414372[_0x42bb6d(0x10d3)][_0x42bb6d(0xb9)](_0x42bb6d(0x63f))),document['getElementById'](_0x42bb6d(0xf2))['textContent']=_0x42bb6d(0x6fb)+_0x32a677[_0x42bb6d(0x57e)]+')';}),document[_0x128c7f(0xc33)](_0x128c7f(0xf2))['addEventListener']('click',async()=>{const _0x23e2bb=_0x128c7f;if(_0x32a677[_0x23e2bb(0x57e)]===0x0)return;const _0xa82a7f=await _0x270512(_0x23e2bb(0x8d6),_0x23e2bb(0x1267)+_0x32a677['size']+_0x23e2bb(0xb15),{'confirmButtonClass':'btn-danger'});if(_0xa82a7f){const _0x41f1ef=[..._0x32a677];await _0x2a2987[_0x23e2bb(0xe69)][_0x23e2bb(0x98b)](_0x41f1ef),await _0x2d7ddd(_0x23e2bb(0xf8f),_0x23e2bb(0xabf)),allFavoriteItems=allFavoriteItems[_0x23e2bb(0x1054)](_0x2d111f=>!_0x41f1ef[_0x23e2bb(0x1d4)](_0x2d111f['id'])),_0x1627b8(allFavoriteItems),_0x33c46e['click']();}});_0x12493e[_0x128c7f(0x10f6)][_0x128c7f(0xdde)]&&(_0x53da85(),console[_0x128c7f(0x51f)](_0x128c7f(0xdc2)));document[_0x128c7f(0x67a)](_0x128c7f(0xc7c))[_0x128c7f(0xd6a)](_0x16f236=>{const _0xf0a059=_0x128c7f;_0x16f236['addEventListener'](_0xf0a059(0x644),_0x20b86d);});const _0x2b812f=document[_0x128c7f(0xc33)]('font-size-slider');_0x2b812f[_0x128c7f(0x205)]('input',()=>{const _0x4a971d=_0x128c7f;document[_0x4a971d(0xc33)](_0x4a971d(0x320))[_0x4a971d(0x11b0)]=_0x2b812f['value']+'px',_0x20b86d();});const _0xf53d57=document[_0x128c7f(0xc33)]('custom-css-input');_0xf53d57[_0x128c7f(0x205)](_0x128c7f(0x36e),_0x20b86d),document[_0x128c7f(0xc33)]('reset-theme-btn')[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x304546=_0x128c7f;document[_0x304546(0xc33)](_0x304546(0xd0f))[_0x304546(0x737)]=!![],_0x20b86d();}),document[_0x128c7f(0xc33)](_0x128c7f(0x2bb))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x57dcdd=_0x128c7f;document[_0x57dcdd(0xc33)](_0x57dcdd(0xf6c))[_0x57dcdd(0x22a)]='',_0x20b86d();}),document['getElementById'](_0x128c7f(0x2c5))[_0x128c7f(0x205)](_0x128c7f(0x644),_0x20b86d),document[_0x128c7f(0xc33)](_0x128c7f(0x114f))[_0x128c7f(0x205)](_0x128c7f(0x644),_0x20b86d),document[_0x128c7f(0xc33)]('lyrics-offset-input')[_0x128c7f(0x205)](_0x128c7f(0x36e),_0x20b86d),document['querySelectorAll'](_0x128c7f(0x5cf))[_0x128c7f(0xd6a)](_0x5de4fd=>{const _0x2994ed=_0x128c7f;_0x5de4fd[_0x2994ed(0x205)](_0x2994ed(0x644),function(){const _0x2e58b0=_0x2994ed,_0x1777a1=document['getElementById']('post-visibility-groups');this[_0x2e58b0(0x22a)]===_0x2e58b0(0xee2)||this[_0x2e58b0(0x22a)]===_0x2e58b0(0xd9c)?_0x1777a1['style'][_0x2e58b0(0xf44)]='block':_0x1777a1[_0x2e58b0(0x105d)][_0x2e58b0(0xf44)]=_0x2e58b0(0x854);});}),document['getElementById'](_0x128c7f(0xb72))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x129cb0),document[_0x128c7f(0xc33)]('close-group-manager-btn')[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x1094e1=_0x128c7f;document[_0x1094e1(0xc33)](_0x1094e1(0x276))['classList'][_0x1094e1(0x2c7)](_0x1094e1(0x143));const _0x49ef4b=document['getElementById'](_0x1094e1(0xea0));document[_0x1094e1(0xc33)](_0x1094e1(0x293))[_0x1094e1(0x10d3)][_0x1094e1(0x3af)]('visible')&&_0x49ef4b[_0x1094e1(0x335)]();}),document['getElementById'](_0x128c7f(0xf71))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x35c18b),document[_0x128c7f(0xc33)](_0x128c7f(0x8a4))[_0x128c7f(0x205)]('click',_0x22db4d=>{const _0x170f0c=_0x128c7f;if(_0x22db4d['target'][_0x170f0c(0x10d3)][_0x170f0c(0x3af)](_0x170f0c(0x9d6))){const _0x17373f=parseInt(_0x22db4d[_0x170f0c(0xe16)][_0x170f0c(0x85)]['id']);_0x1f7043(_0x17373f);}}),document[_0x128c7f(0xc33)](_0x128c7f(0x1226))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x13dccc),document['getElementById']('edit-message-btn')[_0x128c7f(0x205)](_0x128c7f(0x335),_0x5db1c6),document[_0x128c7f(0xc33)](_0x128c7f(0x607))[_0x128c7f(0x205)]('click',_0x4262c9),document[_0x128c7f(0xc33)](_0x128c7f(0x62b))[_0x128c7f(0x205)]('click',_0x74f38a),document[_0x128c7f(0xc33)](_0x128c7f(0x1034))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x186633=_0x464fa7;_0x13dccc(),_0x186633&&_0x16e7c2(_0x186633);}),document[_0x128c7f(0xc33)](_0x128c7f(0xe81))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x3b6388=>{const _0x3ce757=_0x128c7f,_0x12028a=_0x3b6388[_0x3ce757(0xe16)][_0x3ce757(0x7a7)](_0x3ce757(0x689));if(!_0x12028a)return;if(_0x12028a[_0x3ce757(0x10d3)][_0x3ce757(0x3af)]('ai')&&_0x12028a[_0x3ce757(0x10d3)][_0x3ce757(0x3af)](_0x3ce757(0x264))&&_0x12028a['dataset']['status']===_0x3ce757(0x1025)){const _0x4a45e0=parseInt(_0x12028a['dataset'][_0x3ce757(0x2f0)]);!isNaN(_0x4a45e0)&&_0x47ae3b(_0x4a45e0);}}),document[_0x128c7f(0xc33)]('transfer-action-accept')[_0x128c7f(0x205)](_0x128c7f(0x335),()=>_0x185d0c('accepted')),document[_0x128c7f(0xc33)](_0x128c7f(0x1b2))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>_0x185d0c(_0x128c7f(0x95b))),document['getElementById'](_0x128c7f(0x680))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x3a4059),document[_0x128c7f(0xc33)]('edit-post-btn')['addEventListener']('click',_0x26291e),document['getElementById'](_0x128c7f(0x1105))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x380724),document[_0x128c7f(0xc33)]('cancel-post-action-btn')[_0x128c7f(0x205)](_0x128c7f(0x335),_0x35dc62),document['getElementById']('cancel-contact-picker-btn')[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x3b8da2=_0x128c7f;_0x38f00f(_0x3b8da2(0xe8f));}),document[_0x128c7f(0xc33)](_0x128c7f(0xf0))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x2e3bbc=>{const _0x5862de=_0x128c7f,_0x15a8fe=_0x2e3bbc[_0x5862de(0xe16)]['closest'](_0x5862de(0x101c));if(!_0x15a8fe)return;const _0x1f7f40=_0x15a8fe['dataset']['contactId'];_0x15a8fe[_0x5862de(0x10d3)][_0x5862de(0xe2c)](_0x5862de(0x63f)),_0x53d82e[_0x5862de(0xa7)](_0x1f7f40)?_0x53d82e[_0x5862de(0x9ea)](_0x1f7f40):_0x53d82e[_0x5862de(0xb9)](_0x1f7f40),_0x280d80();}),document[_0x128c7f(0xc33)](_0x128c7f(0xf0b))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{_0x2d6c16();}),document[_0x128c7f(0xc33)]('back-from-member-management')[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x21d294=_0x128c7f;_0x38f00f(_0x21d294(0xf1b)),document['getElementById'](_0x21d294(0xea0))[_0x21d294(0x335)]();}),document['getElementById'](_0x128c7f(0x9a))['addEventListener'](_0x128c7f(0x335),_0x253ff2=>{const _0x40bdd7=_0x128c7f;_0x253ff2[_0x40bdd7(0xe16)][_0x40bdd7(0x10d3)][_0x40bdd7(0x3af)](_0x40bdd7(0x7fa))&&_0x467e5c(_0x253ff2[_0x40bdd7(0xe16)][_0x40bdd7(0x85)][_0x40bdd7(0xb1b)]);}),document[_0x128c7f(0xc33)](_0x128c7f(0x563))['addEventListener'](_0x128c7f(0x335),async()=>{const _0x46b7c6=_0x128c7f,_0x1788de=document[_0x46b7c6(0xc33)](_0x46b7c6(0x1102)),_0x513f01=_0x1788de[_0x46b7c6(0xbc5)](!![]);_0x1788de[_0x46b7c6(0x1053)][_0x46b7c6(0xcaa)](_0x513f01,_0x1788de),_0x513f01['addEventListener']('click',_0x1d598b),await _0x286a3f();}),document[_0x128c7f(0xc33)](_0x128c7f(0xe15))[_0x128c7f(0x205)]('click',_0x23f96f),document[_0x128c7f(0xc33)]('video-call-btn')['addEventListener'](_0x128c7f(0x335),_0x973b3d),document[_0x128c7f(0xc33)](_0x128c7f(0x9bd))['addEventListener'](_0x128c7f(0x335),_0x973b3d),document['getElementById'](_0x128c7f(0x111e))[_0x128c7f(0x205)]('click',_0xb5f1de),document[_0x128c7f(0xc33)](_0x128c7f(0x4d3))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x2ba410=_0x128c7f;_0x3b6ec9[_0x2ba410(0xd0)]=![],_0x38f00f(_0x2ba410(0xf1b));}),document[_0x128c7f(0xc33)]('join-call-btn')['addEventListener'](_0x128c7f(0x335),_0x256897),document[_0x128c7f(0xc33)](_0x128c7f(0x112b))['addEventListener'](_0x128c7f(0x335),async()=>{const _0x1c00d2=_0x128c7f;_0x516ccf();const _0x1b5fc5=_0x12493e[_0x1c00d2(0xc45)][_0x3b6ec9[_0x1c00d2(0x7bc)]];if(!_0x1b5fc5)return;if(_0x3b6ec9[_0x1c00d2(0x1255)]){_0x3b6ec9[_0x1c00d2(0x1092)]=![];const _0x136a21={'role':_0x1c00d2(0x152),'content':_0x1c00d2(0x407),'timestamp':Date[_0x1c00d2(0x6ee)](),'isHidden':!![]};_0x1b5fc5[_0x1c00d2(0x1294)][_0x1c00d2(0x2d6)](_0x136a21),await _0x2a2987['chats']['put'](_0x1b5fc5),await _0x439587();}else{const _0x4f017e={'role':_0x1c00d2(0x717),'content':_0x1c00d2(0xa16),'timestamp':Date[_0x1c00d2(0x6ee)]()};_0x1b5fc5[_0x1c00d2(0x1294)][_0x1c00d2(0x2d6)](_0x4f017e),await _0x2a2987['chats'][_0x1c00d2(0xf36)](_0x1b5fc5),_0x38f00f(_0x1c00d2(0xf1b)),_0x468ef0(_0x4f017e,_0x1b5fc5),_0x439587();}_0x3b6ec9[_0x1c00d2(0xd0)]=![];}),document[_0x128c7f(0xc33)](_0x128c7f(0x6d6))[_0x128c7f(0x205)]('click',async()=>{const _0x26c936=_0x128c7f;_0x516ccf(),_0x3b6ec9[_0x26c936(0x1279)]='ai',_0x3b6ec9['isUserParticipating']=!![],_0x3b6ec9[_0x26c936(0x7bc)]=_0x12493e[_0x26c936(0x7bc)];if(_0x3b6ec9[_0x26c936(0x1255)]){const _0x2e5a84=_0x12493e['chats'][_0x3b6ec9[_0x26c936(0x7bc)]],_0x2023b2=_0x2e5a84[_0x26c936(0xd5b)][_0x26c936(0xd85)](_0x1f0596=>_0x1f0596[_0x26c936(0x578)]===_0x3b6ec9[_0x26c936(0xbba)]);_0x2023b2?_0x3b6ec9[_0x26c936(0x10d4)]=[_0x2023b2]:_0x3b6ec9['participants']=[];}_0x8b7bf9();}),document['getElementById']('user-speak-btn')[_0x128c7f(0x205)]('click',async()=>{const _0x262f2e=_0x128c7f;if(!_0x3b6ec9[_0x262f2e(0x1f3)])return;const _0x204b3c=document[_0x262f2e(0x977)](_0x262f2e(0xbd8));_0x204b3c&&_0x204b3c[_0x262f2e(0x10d3)][_0x262f2e(0xb9)](_0x262f2e(0x6a0));const _0xf53bb5=await _0x1ca09c('你说',_0x262f2e(0x17a));_0x204b3c&&_0x204b3c[_0x262f2e(0x10d3)][_0x262f2e(0x2c7)](_0x262f2e(0x6a0)),_0xf53bb5&&_0xf53bb5[_0x262f2e(0x7da)]()&&_0x1ff84d(_0xf53bb5[_0x262f2e(0x7da)]());}),document[_0x128c7f(0x977)]('.nav-item[data-view=\x22memories-view\x22]')[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x5bc718=_0x128c7f;_0x464ccd&&document[_0x5bc718(0xc33)](_0x5bc718(0x1037))[_0x5bc718(0x335)](),_0x598e0c(_0x5bc718(0x3a2)),_0xc1a19();}),document[_0x128c7f(0xc33)]('memories-back-btn')['addEventListener'](_0x128c7f(0x335),()=>_0x598e0c('messages-view')),document['getElementById'](_0x128c7f(0x55f))[_0x128c7f(0x205)](_0x128c7f(0x335),async()=>{const _0x10a1ab=_0x128c7f,_0x5bcda2=document[_0x10a1ab(0xc33)](_0x10a1ab(0xae5))[_0x10a1ab(0x22a)][_0x10a1ab(0x7da)](),_0x5ef7a7=document['getElementById']('countdown-date-input')[_0x10a1ab(0x22a)];if(!_0x5bcda2||!_0x5ef7a7){alert(_0x10a1ab(0x725));return;}const _0x16f101=new Date(_0x5ef7a7);if(isNaN(_0x16f101)||_0x16f101<=new Date()){alert('请输入一个有效的、未来的日期！');return;}const _0x267587={'authorId':_0x10a1ab(0x717),'description':_0x5bcda2,'timestamp':Date[_0x10a1ab(0x6ee)](),'type':_0x10a1ab(0x353),'targetDate':_0x16f101['getTime']()};await _0x2a2987[_0x10a1ab(0x37c)][_0x10a1ab(0xb9)](_0x267587),document['getElementById'](_0x10a1ab(0x9b1))[_0x10a1ab(0x10d3)][_0x10a1ab(0x2c7)](_0x10a1ab(0x143)),_0xc1a19();}),document['getElementById'](_0x128c7f(0x795))[_0x128c7f(0x205)](_0x128c7f(0x335),async()=>{const _0x3cd775=_0x128c7f;if(!_0x12493e[_0x3cd775(0x7bc)]||_0x12493e['chats'][_0x12493e[_0x3cd775(0x7bc)]][_0x3cd775(0x80b)])return;const _0x2f0e8d=_0x12493e[_0x3cd775(0xc45)][_0x12493e[_0x3cd775(0x7bc)]],_0x1fcea8=await _0x270512(_0x3cd775(0x551),_0x3cd775(0xdd3)+_0x2f0e8d[_0x3cd775(0x578)]+'”吗？拉黑后您将无法向其发送消息，直到您将Ta移出黑名单，或等待Ta重新申请好友。',{'confirmButtonClass':_0x3cd775(0xa2)});if(_0x1fcea8){_0x2f0e8d[_0x3cd775(0x1cb)]['status']=_0x3cd775(0x49e),_0x2f0e8d['relationship'][_0x3cd775(0x713)]=Date['now']();const _0x3ac56f={'role':_0x3cd775(0x152),'content':_0x3cd775(0xe8e),'timestamp':Date[_0x3cd775(0x6ee)]()+0x1,'isHidden':!![]};_0x2f0e8d['history'][_0x3cd775(0x2d6)](_0x3ac56f),await _0x2a2987[_0x3cd775(0xc45)][_0x3cd775(0xf36)](_0x2f0e8d),document[_0x3cd775(0xc33)](_0x3cd775(0x293))[_0x3cd775(0x10d3)]['remove']('visible'),_0x1bbfd3(_0x12493e[_0x3cd775(0x7bc)]),_0x597ed7();}}),document[_0x128c7f(0xc33)](_0x128c7f(0x35c))['addEventListener']('click',async _0x4d9b5e=>{const _0x69a577=_0x128c7f,_0x41774f=_0x12493e['chats'][_0x12493e[_0x69a577(0x7bc)]];if(!_0x41774f)return;if(_0x4d9b5e[_0x69a577(0xe16)]['id']===_0x69a577(0x573)){alert(_0x69a577(0xaf5)),await _0x4f7dbd(_0x41774f['id']),_0x1bbfd3(_0x41774f['id']);return;}if(_0x4d9b5e[_0x69a577(0xe16)]['id']===_0x69a577(0x8ef)){_0x41774f[_0x69a577(0x1cb)][_0x69a577(0xbc8)]=_0x69a577(0xe59),_0x41774f[_0x69a577(0x1cb)][_0x69a577(0x713)]=null;const _0x508ee0={'role':_0x69a577(0x152),'content':_0x69a577(0x32a),'timestamp':Date[_0x69a577(0x6ee)](),'isHidden':!![]};_0x41774f[_0x69a577(0x1294)][_0x69a577(0x2d6)](_0x508ee0),await _0x2a2987[_0x69a577(0xc45)][_0x69a577(0xf36)](_0x41774f),_0x1bbfd3(_0x41774f['id']),_0x597ed7(),_0x439587();}else{if(_0x4d9b5e[_0x69a577(0xe16)]['id']===_0x69a577(0x10a)){_0x41774f[_0x69a577(0x1cb)][_0x69a577(0xbc8)]=_0x69a577(0xe59),_0x41774f[_0x69a577(0x1cb)][_0x69a577(0xaff)]='';const _0x463e50={'role':'system','type':'pat_message','content':_0x69a577(0x115d)+_0x41774f['name']+_0x69a577(0xc5b),'timestamp':Date['now']()};_0x41774f[_0x69a577(0x1294)][_0x69a577(0x2d6)](_0x463e50);const _0xf64930={'role':_0x69a577(0x376),'senderName':_0x41774f[_0x69a577(0x578)],'content':'太好了！我们又可以聊天啦！','timestamp':Date[_0x69a577(0x6ee)]()+0x1};_0x41774f[_0x69a577(0x1294)][_0x69a577(0x2d6)](_0xf64930),await _0x2a2987[_0x69a577(0xc45)][_0x69a577(0xf36)](_0x41774f),_0x1bbfd3(_0x41774f['id']),_0x597ed7();}else{if(_0x4d9b5e[_0x69a577(0xe16)]['id']==='reject-friend-btn')_0x41774f[_0x69a577(0x1cb)][_0x69a577(0xbc8)]=_0x69a577(0x49e),_0x41774f[_0x69a577(0x1cb)][_0x69a577(0x713)]=Date[_0x69a577(0x6ee)](),_0x41774f[_0x69a577(0x1cb)][_0x69a577(0xaff)]='',await _0x2a2987[_0x69a577(0xc45)][_0x69a577(0xf36)](_0x41774f),_0x1bbfd3(_0x41774f['id']);else{if(_0x4d9b5e[_0x69a577(0xe16)]['id']===_0x69a577(0xd12)){const _0xd79c5b=await _0x1ca09c(_0x69a577(0x4ea),_0x69a577(0x81a)+_0x41774f[_0x69a577(0x578)]+'”说的申请理由：','我们和好吧！');_0xd79c5b!==null&&(_0x41774f[_0x69a577(0x1cb)][_0x69a577(0xbc8)]='pending_ai_approval',_0x41774f[_0x69a577(0x1cb)][_0x69a577(0xaff)]=_0xd79c5b,await _0x2a2987[_0x69a577(0xc45)][_0x69a577(0xf36)](_0x41774f),_0x1bbfd3(_0x41774f['id']),_0x597ed7(),_0x439587());}}}}}),document[_0x128c7f(0xc33)]('transfer-btn')['addEventListener'](_0x128c7f(0x335),_0x45a13d),document[_0x128c7f(0xc33)](_0x128c7f(0x11c1))[_0x128c7f(0x205)]('click',()=>{const _0x48f67d=_0x128c7f;document[_0x48f67d(0xc33)](_0x48f67d(0x6e6))[_0x48f67d(0x10d3)]['remove']('visible');}),document['getElementById'](_0x128c7f(0x93f))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x4b5117),document[_0x128c7f(0xc33)]('send-direct-packet-btn')[_0x128c7f(0x205)](_0x128c7f(0x335),_0x3b51a2);const _0x2e68c3=document[_0x128c7f(0xc33)](_0x128c7f(0x739)),_0x3f25bf=document[_0x128c7f(0xc33)](_0x128c7f(0x7f4)),_0x18c633=document[_0x128c7f(0xc33)](_0x128c7f(0x8fd)),_0x46bea0=document['getElementById'](_0x128c7f(0x7f5));_0x2e68c3[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x1fc947=_0x128c7f;_0x2e68c3[_0x1fc947(0x10d3)][_0x1fc947(0xb9)](_0x1fc947(0x1043)),_0x3f25bf['classList'][_0x1fc947(0x2c7)](_0x1fc947(0x1043)),_0x18c633[_0x1fc947(0x105d)][_0x1fc947(0xf44)]=_0x1fc947(0xa20),_0x46bea0[_0x1fc947(0x105d)][_0x1fc947(0xf44)]=_0x1fc947(0x854);}),_0x3f25bf[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x581d96=_0x128c7f;_0x3f25bf[_0x581d96(0x10d3)][_0x581d96(0xb9)]('active'),_0x2e68c3[_0x581d96(0x10d3)][_0x581d96(0x2c7)]('active'),_0x46bea0[_0x581d96(0x105d)][_0x581d96(0xf44)]=_0x581d96(0xa20),_0x18c633[_0x581d96(0x105d)][_0x581d96(0xf44)]=_0x581d96(0x854);}),document['getElementById']('rp-group-amount')[_0x128c7f(0x205)]('input',_0x5585cc=>{const _0x34842d=_0x128c7f,_0xb29b0f=parseFloat(_0x5585cc[_0x34842d(0xe16)][_0x34842d(0x22a)])||0x0;document[_0x34842d(0xc33)](_0x34842d(0xa53))[_0x34842d(0x11b0)]='¥\x20'+_0xb29b0f[_0x34842d(0xcab)](0x2);}),document[_0x128c7f(0xc33)](_0x128c7f(0x727))['addEventListener'](_0x128c7f(0x36e),_0x1a0701=>{const _0x219166=_0x128c7f,_0x22934a=parseFloat(_0x1a0701['target'][_0x219166(0x22a)])||0x0;document[_0x219166(0xc33)](_0x219166(0x1181))[_0x219166(0x11b0)]='¥\x20'+_0x22934a[_0x219166(0xcab)](0x2);}),document[_0x128c7f(0xc33)](_0x128c7f(0xe81))['addEventListener'](_0x128c7f(0x335),_0x48b0dc=>{const _0x2f9fc3=_0x128c7f,_0x5e6076=_0x48b0dc[_0x2f9fc3(0xe16)][_0x2f9fc3(0x7a7)]('.red-packet-card');if(!_0x5e6076)return;const _0x1818a2=_0x5e6076[_0x2f9fc3(0x7a7)](_0x2f9fc3(0x689));if(!_0x1818a2||!_0x1818a2[_0x2f9fc3(0x85)][_0x2f9fc3(0x2f0)])return;const _0x42bb45=parseInt(_0x1818a2['dataset'][_0x2f9fc3(0x2f0)]);_0x3701f1(_0x42bb45);}),document[_0x128c7f(0xc33)](_0x128c7f(0x2e1))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x3985ab),document[_0x128c7f(0xc33)](_0x128c7f(0x38e))[_0x128c7f(0x205)]('click',_0x4e7d4e),document[_0x128c7f(0xc33)](_0x128c7f(0x8aa))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x331fe1=_0x128c7f;document[_0x331fe1(0xc33)](_0x331fe1(0xc73))[_0x331fe1(0x10d3)][_0x331fe1(0x2c7)]('visible');}),document[_0x128c7f(0xc33)](_0x128c7f(0x418))[_0x128c7f(0x205)]('click',_0x5200b9),document[_0x128c7f(0xc33)](_0x128c7f(0xe81))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x2308c9=>{const _0x27d0bd=_0x128c7f,_0x24d8e5=_0x2308c9[_0x27d0bd(0xe16)][_0x27d0bd(0x7a7)](_0x27d0bd(0xa8f));if(!_0x24d8e5)return;const _0x61a11f=parseInt(_0x24d8e5[_0x27d0bd(0x85)][_0x27d0bd(0xd41)]);if(isNaN(_0x61a11f))return;const _0x356901=_0x2308c9[_0x27d0bd(0xe16)][_0x27d0bd(0x7a7)]('.poll-option-item');if(_0x356901&&!_0x24d8e5[_0x27d0bd(0x10d3)]['contains'](_0x27d0bd(0x1171))){_0x3595c0(_0x61a11f,_0x356901[_0x27d0bd(0x85)][_0x27d0bd(0x2f6)]);return;}const _0x2b888d=_0x2308c9['target'][_0x27d0bd(0x7a7)]('.poll-action-btn');if(_0x2b888d){_0x24d8e5[_0x27d0bd(0x10d3)][_0x27d0bd(0x3af)](_0x27d0bd(0x1171))?_0x2fdcd6(_0x61a11f):_0x1491a0(_0x61a11f);return;}_0x24d8e5[_0x27d0bd(0x10d3)][_0x27d0bd(0x3af)]('closed')&&_0x2fdcd6(_0x61a11f);}),document[_0x128c7f(0xc33)]('manage-ai-avatar-library-btn')['addEventListener'](_0x128c7f(0x335),_0x48078d),document[_0x128c7f(0xc33)](_0x128c7f(0x288))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>_0x405d83('ai')),document['getElementById'](_0x128c7f(0xb11))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>_0x405d83('group')),document[_0x128c7f(0xc33)]('add-ai-avatar-url-btn')[_0x128c7f(0x205)](_0x128c7f(0x335),_0x190b8c),document[_0x128c7f(0xc33)](_0x128c7f(0x982))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x4130ad=_0x128c7f;document[_0x4130ad(0xc33)](_0x4130ad(0xc47))['click']();}),document['getElementById']('ai-avatar-upload-input')[_0x128c7f(0x205)](_0x128c7f(0x644),_0x528fba),document[_0x128c7f(0xc33)](_0x128c7f(0xbb6))['addEventListener'](_0x128c7f(0x335),_0x3344c1),document[_0x128c7f(0xc33)](_0x128c7f(0x4a6))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x59d7a3),document['getElementById'](_0x128c7f(0x17c))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x3427c0),document[_0x128c7f(0xc33)](_0x128c7f(0x682))['addEventListener']('click',()=>{const _0x5b2ae4=_0x128c7f;document[_0x5b2ae4(0xc33)](_0x5b2ae4(0x9c5))[_0x5b2ae4(0x335)]();}),document[_0x128c7f(0xc33)](_0x128c7f(0x9c5))[_0x128c7f(0x205)](_0x128c7f(0x644),_0x52f475),document[_0x128c7f(0xc33)](_0x128c7f(0xdb1))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x19c8de),document[_0x128c7f(0xc33)]('icon-settings-grid')[_0x128c7f(0x205)](_0x128c7f(0x335),_0x2e8063=>{const _0x2854e6=_0x128c7f;if(_0x2e8063[_0x2854e6(0xe16)][_0x2854e6(0x10d3)][_0x2854e6(0x3af)](_0x2854e6(0xc54))){const _0x3c1f48=_0x2e8063['target']['closest'](_0x2854e6(0x107b)),_0x3e733a=_0x3c1f48[_0x2854e6(0x85)]['iconId'];_0x3e733a&&_0x5044c5(_0x3e733a,'ephone',_0x3c1f48);}}),document['getElementById'](_0x128c7f(0xe81))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x926563=>{const _0x62712b=_0x128c7f,_0xf281dc=_0x926563[_0x62712b(0xe16)][_0x62712b(0x7a7)]('.link-share-card');if(_0xf281dc){const _0x1a873f=parseInt(_0xf281dc[_0x62712b(0x85)][_0x62712b(0x2f0)]);!isNaN(_0x1a873f)&&_0x4689ef(_0x1a873f);}}),document[_0x128c7f(0xc33)](_0x128c7f(0x103d))['addEventListener'](_0x128c7f(0x335),()=>{_0x38f00f('chat-interface-screen');}),_0xff941a[_0x128c7f(0xa4c)][_0x128c7f(0x205)](_0x128c7f(0x335),async _0x1d87ab=>{const _0x80e7ce=_0x128c7f,_0x492d1b=_0x1d87ab['target'][_0x80e7ce(0x7a7)]('.sticker-item');if(_0x492d1b&&_0xff941a[_0x80e7ce(0x401)]!==null){const _0x2dc56b=_0x492d1b[_0x80e7ce(0x105d)][_0x80e7ce(0x4b5)][_0x80e7ce(0x111c)](0x5,-0x2),_0x53da3a=_0x12493e[_0x80e7ce(0x454)][_0x80e7ce(0xd85)](_0x2f78de=>_0x2f78de['url']===_0x2dc56b);_0x53da3a?await _0x1b26fb(_0xff941a[_0x80e7ce(0x401)],_0x53da3a):console[_0x80e7ce(0x54a)](_0x80e7ce(0xfd7),_0x2dc56b);}}),document[_0x128c7f(0x205)](_0x128c7f(0x335),_0x485de9=>{const _0x334222=_0x128c7f;_0xff941a[_0x334222(0x1d9)]&&!_0xff941a[_0x334222(0xa4c)]['contains'](_0x485de9[_0x334222(0xe16)])&&!_0x485de9[_0x334222(0xe16)][_0x334222(0x7a7)](_0x334222(0x15e))&&_0x473cb3();}),document[_0x128c7f(0xc33)](_0x128c7f(0x9a8))[_0x128c7f(0x205)]('click',_0x28c400),document[_0x128c7f(0xc33)](_0x128c7f(0x4e9))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x239624=_0x128c7f;document['getElementById']('share-link-modal')[_0x239624(0x10d3)]['remove'](_0x239624(0x143));}),document[_0x128c7f(0xc33)](_0x128c7f(0xd15))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x3ea51b),document[_0x128c7f(0xc33)](_0x128c7f(0x8f9))['addEventListener'](_0x128c7f(0x644),_0x49a863),document[_0x128c7f(0xc33)](_0x128c7f(0x748))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x10d37f),document[_0x128c7f(0xc33)]('chat-list-title')[_0x128c7f(0x205)]('click',_0x264dda),document[_0x128c7f(0xc33)](_0x128c7f(0xa61))['addEventListener'](_0x128c7f(0x335),()=>{const _0x5c685f=_0x128c7f;_0x38f00f(_0x5c685f(0xe8f));}),document[_0x128c7f(0xc33)]('call-history-list')['addEventListener'](_0x128c7f(0x335),_0x269c0c=>{const _0x416c86=_0x128c7f,_0x515af3=_0x269c0c['target'][_0x416c86(0x7a7)](_0x416c86(0x521));_0x515af3&&_0x515af3['dataset'][_0x416c86(0xe49)]&&_0x5778e6(parseInt(_0x515af3[_0x416c86(0x85)][_0x416c86(0xe49)]));}),document[_0x128c7f(0xc33)]('close-call-transcript-btn')[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x8b24ee=_0x128c7f;document[_0x8b24ee(0xc33)](_0x8b24ee(0x785))[_0x8b24ee(0x10d3)][_0x8b24ee(0x2c7)](_0x8b24ee(0x143));}),document[_0x128c7f(0xc33)]('chat-header-status')['addEventListener'](_0x128c7f(0x335),_0x3c7301),document['getElementById'](_0x128c7f(0x1bf))['addEventListener'](_0x128c7f(0x335),()=>{const _0x4de8a6=_0x128c7f;_0x2078e5[_0x4de8a6(0x57e)]>0x0&&_0x2739a4();}),document[_0x128c7f(0xc33)](_0x128c7f(0xcca))[_0x128c7f(0x205)]('click',_0xdf290d),document[_0x128c7f(0xc33)](_0x128c7f(0x7ba))[_0x128c7f(0x205)]('click',async()=>{const _0x4a68be=_0x128c7f,_0x432e48=_0x12493e[_0x4a68be(0xc45)][_0x12493e['activeChatId']],_0x1e6caa=Array[_0x4a68be(0x301)](document[_0x4a68be(0x67a)]('.share-target-checkbox:checked'))[_0x4a68be(0x9d5)](_0x3356ad=>_0x3356ad[_0x4a68be(0x85)][_0x4a68be(0x109b)]);if(_0x1e6caa[_0x4a68be(0x79b)]===0x0){alert('请至少选择一个要分享的聊天。');return;}const _0x4d6171=[],_0x463a43=[..._0x2078e5]['sort']((_0x45cba9,_0x44a015)=>_0x45cba9-_0x44a015);for(const _0x3c17d4 of _0x463a43){const _0x122ac0=_0x432e48[_0x4a68be(0x1294)][_0x4a68be(0xd85)](_0x303ba1=>_0x303ba1[_0x4a68be(0x2f0)]===_0x3c17d4);_0x122ac0&&_0x4d6171[_0x4a68be(0x2d6)](_0x122ac0);}const _0x4383a1={'role':_0x4a68be(0x717),'senderName':_0x432e48[_0x4a68be(0x80b)]?_0x432e48[_0x4a68be(0x2ea)][_0x4a68be(0xbf6)]||'我':'我','type':_0x4a68be(0x1115),'timestamp':Date[_0x4a68be(0x6ee)](),'payload':{'sourceChatName':_0x432e48[_0x4a68be(0x578)],'title':_0x4a68be(0x690)+_0x432e48[_0x4a68be(0x578)]+_0x4a68be(0xd9e),'sharedHistory':_0x4d6171}};for(const _0x93f8c4 of _0x1e6caa){const _0x30bdaa=_0x12493e[_0x4a68be(0xc45)][_0x93f8c4];_0x30bdaa&&(_0x30bdaa[_0x4a68be(0x1294)][_0x4a68be(0x2d6)](_0x4383a1),await _0x2a2987['chats'][_0x4a68be(0xf36)](_0x30bdaa));}document[_0x4a68be(0xc33)](_0x4a68be(0x126))[_0x4a68be(0x10d3)][_0x4a68be(0x2c7)]('visible'),_0x5e1dc2(),await _0x2d7ddd(_0x4a68be(0xc4b),_0x4a68be(0x468)+_0x1e6caa[_0x4a68be(0x79b)]+_0x4a68be(0x127b)),_0x597ed7();}),document[_0x128c7f(0xc33)](_0x128c7f(0x74d))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x52ce9b=_0x128c7f;document[_0x52ce9b(0xc33)](_0x52ce9b(0x126))[_0x52ce9b(0x10d3)][_0x52ce9b(0x2c7)](_0x52ce9b(0x143));}),document['getElementById'](_0x128c7f(0xe81))[_0x128c7f(0x205)]('click',_0x41ff5a=>{const _0x3d8ac6=_0x128c7f,_0x9cb777=_0x41ff5a[_0x3d8ac6(0xe16)]['closest']('.link-share-card[data-timestamp]');if(_0x9cb777&&_0x9cb777['closest'](_0x3d8ac6(0xb61))){const _0x2dd71e=parseInt(_0x9cb777['dataset']['timestamp']);_0x5b4590(_0x2dd71e);}}),document[_0x128c7f(0xc33)](_0x128c7f(0x9ed))['addEventListener'](_0x128c7f(0x335),()=>{const _0x1fc523=_0x128c7f;document[_0x1fc523(0xc33)](_0x1fc523(0x9d9))[_0x1fc523(0x10d3)]['remove'](_0x1fc523(0x143));});async function _0x5b4590(_0x1d391f){const _0x13f90a=_0x128c7f,_0x1c3e93=_0x12493e['chats'][_0x12493e[_0x13f90a(0x7bc)]],_0x4db91d=_0x1c3e93[_0x13f90a(0x1294)]['find'](_0x34d60a=>_0x34d60a[_0x13f90a(0x2f0)]===_0x1d391f);if(!_0x4db91d||_0x4db91d[_0x13f90a(0x52a)]!==_0x13f90a(0x1115)||!_0x4db91d[_0x13f90a(0xd75)]){console[_0x13f90a(0x4d9)](_0x13f90a(0x31a),_0x1d391f),await _0x2d7ddd('查看失败','无法找到对应的分享记录或记录已损坏。');return;}const _0x2e7328=document[_0x13f90a(0xc33)](_0x13f90a(0x9d9)),_0x2d25b1=document[_0x13f90a(0xc33)](_0x13f90a(0x832)),_0x30a318=document[_0x13f90a(0xc33)](_0x13f90a(0x117c));_0x2d25b1[_0x13f90a(0x11b0)]=_0x4db91d[_0x13f90a(0xd75)][_0x13f90a(0x874)],_0x30a318[_0x13f90a(0x102a)]='';const _0x39bdb6=document[_0x13f90a(0x8d9)](),_0x1649ee=Object['values'](_0x12493e[_0x13f90a(0xc45)])['find'](_0x2569ae=>_0x2569ae[_0x13f90a(0x578)]===_0x4db91d[_0x13f90a(0xd75)][_0x13f90a(0x5fc)])||_0x1c3e93;for(const _0x4e3e0b of _0x4db91d[_0x13f90a(0xd75)]['sharedHistory']){const _0x2e410c=await _0x3f3a68(_0x4e3e0b,_0x1649ee);_0x2e410c&&_0x39bdb6[_0x13f90a(0xf77)](_0x2e410c);}_0x30a318[_0x13f90a(0xf77)](_0x39bdb6),_0x2e7328['classList'][_0x13f90a(0xb9)](_0x13f90a(0x143));}_0x3ced3a['addEventListener']('timeupdate',_0x438baf),_0x3ced3a[_0x128c7f(0x205)](_0x128c7f(0x47a),()=>{const _0x1d5825=_0x128c7f;_0x5ebb31[_0x1d5825(0x1f3)]&&(_0x5ebb31[_0x1d5825(0xa4e)]=![],_0x246e79());}),_0x3ced3a[_0x128c7f(0x205)](_0x128c7f(0x193),()=>{const _0x25864a=_0x128c7f;_0x5ebb31[_0x25864a(0x1f3)]&&(_0x5ebb31[_0x25864a(0xa4e)]=!![],_0x246e79());}),document[_0x128c7f(0xc33)](_0x128c7f(0xf9d))['addEventListener'](_0x128c7f(0x335),async _0x52f0ec=>{const _0x459fe4=_0x128c7f,_0x31c9dc=_0x52f0ec[_0x459fe4(0xe16)],_0x2fa7f0=_0x31c9dc['closest'](_0x459fe4(0x554));if(_0x2fa7f0){const _0x400c3d=parseInt(_0x2fa7f0[_0x459fe4(0x85)]['index']);!isNaN(_0x400c3d)&&await _0x101a2c(_0x400c3d);return;}const _0x36e385=_0x31c9dc[_0x459fe4(0x7a7)]('.lyrics-btn');if(_0x36e385){const _0x8488e=parseInt(_0x36e385[_0x459fe4(0x85)][_0x459fe4(0xad)]);if(isNaN(_0x8488e))return;await _0x30aad1(_0x8488e);return;}const _0x2ddc8b=_0x31c9dc[_0x459fe4(0x7a7)](_0x459fe4(0xecd));if(_0x2ddc8b){const _0x45feb2=parseInt(_0x2ddc8b[_0x459fe4(0x85)][_0x459fe4(0xad)]);if(isNaN(_0x45feb2))return;const _0x4a47d1=_0x5ebb31['playlist'][_0x45feb2],_0x2544f2=await _0x270512(_0x459fe4(0x226),_0x459fe4(0xb0a)+_0x4a47d1[_0x459fe4(0x578)]+_0x459fe4(0xa31));_0x2544f2&&_0x1c2d08(_0x45feb2);return;}const _0x2659d8=_0x31c9dc[_0x459fe4(0x7a7)](_0x459fe4(0xe5c));if(_0x2659d8){const _0x439643=_0x2659d8[_0x459fe4(0x7a7)](_0x459fe4(0x26c)),_0x4ffc23=Array[_0x459fe4(0x301)](_0x439643[_0x459fe4(0xb6b)]['children'])['indexOf'](_0x439643);_0x4ffc23>-0x1&&_0x21a08a(_0x4ffc23);}}),document['querySelector'](_0x128c7f(0xfb1))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x5bc54c=>{const _0x4b0c42=_0x128c7f;if(!_0x3ced3a[_0x4b0c42(0xc6a)])return;const _0x5a53de=_0x5bc54c[_0x4b0c42(0x85d)],_0x2d6df3=_0x5a53de[_0x4b0c42(0x9dd)],_0x5646d6=_0x5bc54c[_0x4b0c42(0x6ce)];_0x3ced3a[_0x4b0c42(0x10ba)]=_0x5646d6/_0x2d6df3*_0x3ced3a['duration'];}),document[_0x128c7f(0xc33)](_0x128c7f(0xe81))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x489585=>{const _0x26528a=_0x128c7f,_0x3c8886=_0x489585['target']['closest'](_0x26528a(0x9a5));if(_0x3c8886){const _0x3209a2=_0x12493e[_0x26528a(0xc45)][_0x12493e[_0x26528a(0x7bc)]],_0x4dc211=_0x3c8886[_0x26528a(0x7a7)](_0x26528a(0x1ab));if(_0x3209a2&&_0x4dc211){const _0x116ef0=parseInt(_0x4dc211['dataset']['timestamp']),_0x264b3f=_0x3209a2[_0x26528a(0x1294)][_0x26528a(0xd85)](_0x507934=>_0x507934[_0x26528a(0x2f0)]===_0x116ef0);if(_0x264b3f&&_0x264b3f['recalledData']){let _0x2ec7dc='';const _0x5bcbb7=_0x264b3f[_0x26528a(0xc50)];switch(_0x5bcbb7['originalType']){case'text':_0x2ec7dc=_0x26528a(0xbf3)+_0x5bcbb7[_0x26528a(0x96c)]+'\x22';break;case'user_photo':case _0x26528a(0x8f5):case'text_image':_0x2ec7dc=_0x26528a(0xd96)+_0x5bcbb7[_0x26528a(0x96c)]+'\x22';break;case'voice_message':_0x2ec7dc=_0x26528a(0x24b)+_0x5bcbb7[_0x26528a(0x96c)]+'\x22';break;case'sticker':_0x2ec7dc=_0x26528a(0x6f0)+(_0x5bcbb7[_0x26528a(0x6d4)]||_0x26528a(0xd38))+'\x22\x20\x0a\x20URL:\x20'+_0x5bcbb7['originalContent'];break;case _0x26528a(0xe86):_0x2ec7dc='一条[转账]消息已被撤回。';break;default:_0x2ec7dc='撤回了一条['+_0x5bcbb7[_0x26528a(0xa5f)]+_0x26528a(0x608)+JSON[_0x26528a(0xd27)](_0x5bcbb7[_0x26528a(0x96c)]);break;}_0x2d7ddd('已撤回的消息',_0x2ec7dc);}}}}),document[_0x128c7f(0xc33)](_0x128c7f(0xf87))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x225d02),document[_0x128c7f(0xc33)](_0x128c7f(0x12ab))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x153e1c=_0x128c7f;document[_0x153e1c(0xc33)](_0x153e1c(0xd1c))[_0x153e1c(0x10d3)][_0x153e1c(0x2c7)]('visible'),_0x561077();}),document[_0x128c7f(0xc33)]('add-new-category-btn')[_0x128c7f(0x205)](_0x128c7f(0x335),_0x232903),document[_0x128c7f(0xc33)]('existing-categories-list')[_0x128c7f(0x205)](_0x128c7f(0x335),_0xd0f081=>{const _0x567f8b=_0x128c7f;if(_0xd0f081[_0x567f8b(0xe16)]['classList'][_0x567f8b(0x3af)](_0x567f8b(0x9d6))){const _0x1ffa2b=parseInt(_0xd0f081['target'][_0x567f8b(0x85)]['id']);_0x33cebb(_0x1ffa2b);}}),document[_0x128c7f(0xc33)](_0x128c7f(0xa83))[_0x128c7f(0x205)]('click',_0x276c0b),document[_0x128c7f(0xc33)](_0x128c7f(0x103))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x51474e),document[_0x128c7f(0xc33)]('quote-message-btn')[_0x128c7f(0x205)](_0x128c7f(0x335),_0x2b626c),document[_0x128c7f(0xc33)](_0x128c7f(0xf2f))['addEventListener'](_0x128c7f(0x335),_0x9e2080),document['getElementById'](_0x128c7f(0xd13))[_0x128c7f(0x205)](_0x128c7f(0x36e),_0x141f35=>{const _0x55ee94=_0x128c7f;if(!_0x141f35[_0x55ee94(0xe16)][_0x55ee94(0x1fe)](_0x55ee94(0x457)))return;const _0x328281=_0x141f35[_0x55ee94(0xe16)],_0x351e0f=_0x328281[_0x55ee94(0x7a7)](_0x55ee94(0x389));if(!_0x351e0f)return;const _0x23bc25=_0x351e0f[_0x55ee94(0x977)](_0x55ee94(0xc8b)),_0x571f45=_0x328281[_0x55ee94(0x22a)],_0x226b9a=_0x571f45[_0x55ee94(0x1242)](/@([\p{L}\w]*)$/u);if(_0x226b9a){const _0x1d4397=new Set(),_0xf08a6d=_0x351e0f[_0x55ee94(0x977)]('.post-nickname')?.[_0x55ee94(0x11b0)];if(_0xf08a6d)_0x1d4397[_0x55ee94(0xb9)](_0xf08a6d);_0x351e0f[_0x55ee94(0x67a)](_0x55ee94(0x548))[_0x55ee94(0xd6a)](_0x3cc0cb=>{const _0x188d1c=_0x55ee94;_0x1d4397['add'](_0x3cc0cb[_0x188d1c(0x11b0)][_0x188d1c(0xc12)](':',''));}),_0x1d4397[_0x55ee94(0x9ea)](_0x12493e[_0x55ee94(0x76c)][_0x55ee94(0x66a)]),_0x23bc25[_0x55ee94(0x102a)]='';if(_0x1d4397[_0x55ee94(0x57e)]>0x0){const _0x3c793e=_0x226b9a[0x1];_0x1d4397['forEach'](_0x5a68b5=>{const _0x5442b6=_0x55ee94;if(_0x5a68b5[_0x5442b6(0x963)]()[_0x5442b6(0x1d4)](_0x3c793e['toLowerCase']())){const _0x430c3b=document[_0x5442b6(0x1292)](_0x5442b6(0x58c));_0x430c3b[_0x5442b6(0x84)]='at-mention-item',_0x430c3b[_0x5442b6(0x11b0)]=_0x5a68b5,_0x430c3b[_0x5442b6(0x205)]('mousedown',_0x4f7aeb=>{const _0x3ad16f=_0x5442b6;_0x4f7aeb[_0x3ad16f(0xe8)]();const _0x21cf41=_0x571f45[_0x3ad16f(0x1033)](0x0,_0x226b9a['index'])+('@'+_0x5a68b5+'\x20');_0x328281[_0x3ad16f(0x22a)]=_0x21cf41,_0x23bc25[_0x3ad16f(0x105d)][_0x3ad16f(0xf44)]=_0x3ad16f(0x854),_0x328281[_0x3ad16f(0xd59)]();}),_0x23bc25[_0x5442b6(0xf77)](_0x430c3b);}}),_0x23bc25[_0x55ee94(0x105d)]['display']=_0x23bc25[_0x55ee94(0x103f)][_0x55ee94(0x79b)]>0x0?_0x55ee94(0xa20):_0x55ee94(0x854);}else _0x23bc25['style'][_0x55ee94(0xf44)]=_0x55ee94(0x854);}else _0x23bc25[_0x55ee94(0x105d)][_0x55ee94(0xf44)]=_0x55ee94(0x854);}),document[_0x128c7f(0xc33)](_0x128c7f(0xd13))[_0x128c7f(0x205)](_0x128c7f(0x111),_0x4bce69=>{const _0x233e39=_0x128c7f;if(_0x4bce69[_0x233e39(0xe16)][_0x233e39(0x1fe)](_0x233e39(0x457))){const _0x118f0a=_0x4bce69[_0x233e39(0xe16)][_0x233e39(0x7a7)](_0x233e39(0x389));if(_0x118f0a){const _0x515c63=_0x118f0a[_0x233e39(0x977)]('.at-mention-popup');_0x515c63&&setTimeout(()=>{const _0x5c0812=_0x233e39;_0x515c63['style'][_0x5c0812(0xf44)]='none';},0xc8);}}});const _0x20acaf=document['getElementById'](_0x128c7f(0x113b)),_0xcfe203=document[_0x128c7f(0xc33)]('chat-at-mention-popup');_0x20acaf[_0x128c7f(0x205)](_0x128c7f(0x36e),()=>{const _0xd81237=_0x128c7f;if(!_0x12493e[_0xd81237(0x7bc)]||!_0x12493e[_0xd81237(0xc45)][_0x12493e[_0xd81237(0x7bc)]][_0xd81237(0x80b)]){_0xcfe203[_0xd81237(0x105d)][_0xd81237(0xf44)]='none';return;}const _0x3e9f39=_0x12493e['chats'][_0x12493e[_0xd81237(0x7bc)]],_0x280982=_0x20acaf[_0xd81237(0x22a)],_0x4dae08=_0x280982[_0xd81237(0x1242)](/@([\p{L}\w]*)$/u);if(_0x4dae08){const _0x2237b0=_0x3e9f39[_0xd81237(0x2ea)]['myNickname']||'我',_0x4c448e=_0x3e9f39[_0xd81237(0xd5b)][_0xd81237(0x9d5)](_0x84f7c=>_0x84f7c[_0xd81237(0x6e2)])[_0xd81237(0x1054)](_0x4ff095=>_0x4ff095!==_0x2237b0);_0xcfe203['innerHTML']='';if(_0x4c448e[_0xd81237(0x79b)]>0x0){const _0x570b7b=_0x4dae08[0x1];_0x4c448e[_0xd81237(0xd6a)](_0x4bc5da=>{const _0x282a2f=_0xd81237;if(_0x4bc5da['toLowerCase']()[_0x282a2f(0x1d4)](_0x570b7b[_0x282a2f(0x963)]())){const _0x4728b2=document[_0x282a2f(0x1292)](_0x282a2f(0x58c));_0x4728b2[_0x282a2f(0x84)]='at-mention-item',_0x4728b2[_0x282a2f(0x11b0)]=_0x4bc5da,_0x4728b2['addEventListener'](_0x282a2f(0x9e6),_0x202e0f=>{const _0x94f5d4=_0x282a2f;_0x202e0f[_0x94f5d4(0xe8)]();const _0x306879=_0x280982[_0x94f5d4(0x1033)](0x0,_0x4dae08[_0x94f5d4(0xad)])+('@'+_0x4bc5da+'\x20');_0x20acaf[_0x94f5d4(0x22a)]=_0x306879,_0xcfe203[_0x94f5d4(0x105d)][_0x94f5d4(0xf44)]=_0x94f5d4(0x854),_0x20acaf[_0x94f5d4(0xd59)]();}),_0xcfe203[_0x282a2f(0xf77)](_0x4728b2);}}),_0xcfe203['style'][_0xd81237(0xf44)]=_0xcfe203[_0xd81237(0x103f)][_0xd81237(0x79b)]>0x0?_0xd81237(0xa20):_0xd81237(0x854);}else _0xcfe203[_0xd81237(0x105d)]['display']=_0xd81237(0x854);}else _0xcfe203[_0xd81237(0x105d)][_0xd81237(0xf44)]='none';}),_0x20acaf[_0x128c7f(0x205)]('blur',()=>{setTimeout(()=>{const _0x22bca8=_0x26e9;_0xcfe203[_0x22bca8(0x105d)][_0x22bca8(0xf44)]=_0x22bca8(0x854);},0xc8);}),document[_0x128c7f(0xc33)](_0x128c7f(0x61d))[_0x128c7f(0x205)]('click',_0x5e4c7b),document[_0x128c7f(0xc33)]('show-announcement-board-btn')[_0x128c7f(0x205)](_0x128c7f(0x335),_0x1275b4),document[_0x128c7f(0xc33)](_0x128c7f(0xaf1))[_0x128c7f(0x205)]('click',()=>{const _0xa78c2d=_0x128c7f;document[_0xa78c2d(0xc33)](_0xa78c2d(0xe26))[_0xa78c2d(0x10d3)][_0xa78c2d(0x2c7)]('visible');}),document[_0x128c7f(0xc33)]('announcement-board-content')[_0x128c7f(0x205)](_0x128c7f(0x335),_0x325097=>{const _0xb36d16=_0x128c7f;if(_0x325097[_0xb36d16(0xe16)][_0xb36d16(0x10d3)][_0xb36d16(0x3af)]('announcement-item-actions')){const _0x3b2a28=_0x325097[_0xb36d16(0xe16)][_0xb36d16(0x85)][_0xb36d16(0x15a)];_0x3b2a28&&_0x1f3fd8(_0x3b2a28);}}),document[_0x128c7f(0xc33)](_0x128c7f(0x12a6))['addEventListener'](_0x128c7f(0x335),_0x10c0ef),document[_0x128c7f(0xc33)]('announcement-action-delete')[_0x128c7f(0x205)](_0x128c7f(0x335),_0x381c93),document[_0x128c7f(0xc33)](_0x128c7f(0xcb9))[_0x128c7f(0x205)]('click',()=>{const _0xc9b821=_0x128c7f;document[_0xc9b821(0xc33)](_0xc9b821(0x65f))['classList']['remove'](_0xc9b821(0x143));}),document[_0x128c7f(0xc33)](_0x128c7f(0xb0e))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x2c12f7=_0x128c7f;document[_0x2c12f7(0xc33)](_0x2c12f7(0x85c))[_0x2c12f7(0x22a)]='';}),document[_0x128c7f(0xc33)](_0x128c7f(0x9d3))['addEventListener'](_0x128c7f(0x335),_0x519f0f),document[_0x128c7f(0xc33)](_0x128c7f(0xf40))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{_0x38f00f('chat-interface-screen');}),document[_0x128c7f(0xc33)](_0x128c7f(0xff4))[_0x128c7f(0x205)]('click',_0x1050c4),document['getElementById'](_0x128c7f(0xc91))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x4a05e6),document[_0x128c7f(0xc33)](_0x128c7f(0x74f))['addEventListener'](_0x128c7f(0x335),_0x4f4598=>{const _0x5d046a=_0x128c7f,_0xb6fc8f=_0x4f4598['target'][_0x5d046a(0x7a7)](_0x5d046a(0x574));if(_0xb6fc8f){_0x2f3aad(_0xb6fc8f['dataset'][_0x5d046a(0xd48)],parseInt(_0xb6fc8f[_0x5d046a(0x85)][_0x5d046a(0xfd1)]));return;}const _0x44fc3e=_0x4f4598['target'][_0x5d046a(0x7a7)](_0x5d046a(0x562));if(_0x44fc3e){_0x32f7b1(_0x44fc3e['dataset']['authorId'],parseInt(_0x44fc3e[_0x5d046a(0x85)][_0x5d046a(0xfd1)]));return;}}),document['getElementById'](_0x128c7f(0xaf3))[_0x128c7f(0x205)]('click',_0x7d5db1),document[_0x128c7f(0xc33)]('close-gomoku-btn')[_0x128c7f(0x205)]('click',_0x1fe64c);const _0x79f04a=document[_0x128c7f(0xc33)](_0x128c7f(0x4ee));_0x79f04a[_0x128c7f(0x205)](_0x128c7f(0x538),_0x429d01),_0x79f04a[_0x128c7f(0x205)]('mouseout',()=>_0x87349(_0x12493e[_0x128c7f(0x7bc)])),_0x79f04a[_0x128c7f(0x205)](_0x128c7f(0x335),_0x4c6f80),document['getElementById'](_0x128c7f(0xdbd))['addEventListener'](_0x128c7f(0x335),()=>{const _0x1234fe=_0x128c7f;document[_0x1234fe(0xc33)]('countdown-title-input')[_0x1234fe(0x22a)]='',document[_0x1234fe(0xc33)](_0x1234fe(0x7b4))[_0x1234fe(0x22a)]='',document[_0x1234fe(0xc33)](_0x1234fe(0x9b1))[_0x1234fe(0x10d3)][_0x1234fe(0xb9)](_0x1234fe(0x143));}),document[_0x128c7f(0xc33)](_0x128c7f(0xbbb))[_0x128c7f(0x205)]('click',()=>{const _0x16cab6=_0x128c7f;document[_0x16cab6(0xc33)](_0x16cab6(0x9b1))['classList']['remove'](_0x16cab6(0x143));}),document[_0x128c7f(0xc33)](_0x128c7f(0xee6))['addEventListener'](_0x128c7f(0x335),_0x867ce5),document[_0x128c7f(0xc33)](_0x128c7f(0xb31))[_0x128c7f(0x205)]('click',_0x3a6c0e),document[_0x128c7f(0xc33)](_0x128c7f(0x99a))['addEventListener'](_0x128c7f(0x335),_0x40883c),document[_0x128c7f(0xc33)]('edit-last-response-btn')[_0x128c7f(0x205)](_0x128c7f(0x335),_0x1d6a4f),document['getElementById'](_0x128c7f(0x96d))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x8969df=_0x128c7f;document[_0x8969df(0xc33)](_0x8969df(0x7e8))[_0x8969df(0x10d3)][_0x8969df(0x2c7)](_0x8969df(0x143));}),document[_0x128c7f(0xc33)](_0x128c7f(0x39a))['addEventListener'](_0x128c7f(0x335),_0x1c94c9),document[_0x128c7f(0xc33)](_0x128c7f(0xcde))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x4b606b=_0x128c7f,_0x27affa=document[_0x4b606b(0xc33)](_0x4b606b(0x333)),_0x5afb78=_0xb561c1(_0x4b606b(0x90c));_0x27affa[_0x4b606b(0xf77)](_0x5afb78),_0x5afb78[_0x4b606b(0x977)](_0x4b606b(0x89c))[_0x4b606b(0xd59)]();}),document['getElementById'](_0x128c7f(0x1010))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x5e2192),document[_0x128c7f(0xc33)](_0x128c7f(0x38d))[_0x128c7f(0x205)](_0x128c7f(0x335),_0xf28e1e),document[_0x128c7f(0xc33)](_0x128c7f(0xffc))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x397845),document['getElementById'](_0x128c7f(0x4ca))[_0x128c7f(0x205)]('click',()=>{const _0x4500c1=_0x128c7f;document[_0x4500c1(0xc33)](_0x4500c1(0x82f))[_0x4500c1(0x335)]();}),document[_0x128c7f(0xc33)](_0x128c7f(0x82f))[_0x128c7f(0x205)]('change',_0x1b6916),document['getElementById'](_0x128c7f(0x4d6))[_0x128c7f(0x205)](_0x128c7f(0x335),async()=>{const _0x434e76=_0x128c7f,_0x95d839='请按照以下格式粘贴，一行一个：\x0a\x0a焦虑\x202a9wte.jpeg\x0a大惊失色\x20or8qf4.png\x0a没有灵感\x20njwujh.jpeg',_0x5c7884=await _0x1ca09c('批量导入头像',_0x95d839,'','textarea');_0x5c7884&&_0x5c7884[_0x434e76(0x7da)]()&&await _0x53bdc8(_0x5c7884);}),document[_0x128c7f(0xc33)](_0x128c7f(0x14f))['addEventListener'](_0x128c7f(0x335),_0x1d035a),document[_0x128c7f(0xc33)](_0x128c7f(0x959))['addEventListener'](_0x128c7f(0x335),()=>_0x38f00f(_0x128c7f(0xf1b))),document[_0x128c7f(0xc33)](_0x128c7f(0xa91))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x1bc9e3),document[_0x128c7f(0xc33)]('cart-back-btn')[_0x128c7f(0x205)](_0x128c7f(0x335),_0x1d035a),document[_0x128c7f(0xc33)]('checkout-btn')['addEventListener'](_0x128c7f(0x335),_0x196e9f),document[_0x128c7f(0xc33)]('close-receipt-btn')[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x5ac0a7=_0x128c7f;document[_0x5ac0a7(0xc33)]('gift-receipt-modal')[_0x5ac0a7(0x10d3)][_0x5ac0a7(0x2c7)](_0x5ac0a7(0x143));}),document[_0x128c7f(0xc33)](_0x128c7f(0x1232))['addEventListener'](_0x128c7f(0x335),()=>{const _0x339fa8=_0x128c7f;_0x38ddb1=!_0x38ddb1;const _0x2697ef=document[_0x339fa8(0xc33)]('manage-products-btn'),_0x2724bd=document['getElementById'](_0x339fa8(0xca1)),_0x4cf67a=document[_0x339fa8(0xc33)](_0x339fa8(0x715));_0x2697ef[_0x339fa8(0x105d)][_0x339fa8(0x41e)]=_0x38ddb1?'var(--accent-color)':'var(--text-primary)',_0x38ddb1?(_0x2724bd[_0x339fa8(0x105d)][_0x339fa8(0xf44)]=_0x339fa8(0x21a),_0x4cf67a[_0x339fa8(0x105d)][_0x339fa8(0xa76)]=_0x339fa8(0xdfd)):(_0x2724bd[_0x339fa8(0x105d)][_0x339fa8(0xf44)]='none',_0x4cf67a[_0x339fa8(0x105d)][_0x339fa8(0xa76)]='',_0x367674[_0x339fa8(0xebb)](),document[_0x339fa8(0x67a)](_0x339fa8(0xf54))['forEach'](_0x5292b8=>_0x5292b8[_0x339fa8(0x10d3)]['remove'](_0x339fa8(0x63f))),document['getElementById']('delete-selected-products-btn')[_0x339fa8(0x11b0)]=_0x339fa8(0xaaa),document[_0x339fa8(0xc33)](_0x339fa8(0xba8))[_0x339fa8(0x737)]=![]),_0x34cd96(),_0x4f9fa7();}),document[_0x128c7f(0xc33)](_0x128c7f(0xfa6))[_0x128c7f(0x205)]('click',()=>{_0x38ddb1?_0x38489a(null):alert('请先点击扳手图标进入管理模式，才能添加新商品。');}),document[_0x128c7f(0xc33)](_0x128c7f(0x715))[_0x128c7f(0x205)](_0x128c7f(0x335),async _0x25560f=>{const _0x5a5996=_0x128c7f,_0x132105=_0x25560f[_0x5a5996(0xe16)]['closest'](_0x5a5996(0xa7f));if(!_0x132105)return;const _0x7592d6=parseInt(_0x132105[_0x5a5996(0x85)]['id']);if(isNaN(_0x7592d6))return;if(_0x38ddb1){if(_0x25560f[_0x5a5996(0xe16)]['classList'][_0x5a5996(0x3af)](_0x5a5996(0x10d8))){_0x38489a(_0x7592d6);return;}if(_0x25560f['target'][_0x5a5996(0x10d3)]['contains'](_0x5a5996(0xf0a))){const _0x2484fe=await _0x2a2987[_0x5a5996(0x6b4)]['get'](_0x7592d6);if(!_0x2484fe)return;const _0x5d6c96=await _0x270512(_0x5a5996(0x358),_0x5a5996(0xe7)+_0x2484fe['name']+'”\x20吗？',{'confirmButtonClass':_0x5a5996(0xa2)});_0x5d6c96&&(await _0x2a2987[_0x5a5996(0x6b4)][_0x5a5996(0x9ea)](_0x7592d6),await _0x34cd96(),alert('商品已删除。'));return;}_0x132105['classList'][_0x5a5996(0xe2c)]('selected');_0x367674[_0x5a5996(0xa7)](_0x7592d6)?_0x367674[_0x5a5996(0x9ea)](_0x7592d6):_0x367674[_0x5a5996(0xb9)](_0x7592d6);document[_0x5a5996(0xc33)](_0x5a5996(0x557))['textContent']=_0x5a5996(0x6fb)+_0x367674[_0x5a5996(0x57e)]+')';return;}if(_0x25560f[_0x5a5996(0xe16)][_0x5a5996(0x10d3)][_0x5a5996(0x3af)](_0x5a5996(0x1149))){const _0x41dd1a=await _0x2a2987[_0x5a5996(0x6b4)][_0x5a5996(0xec0)](_0x7592d6);_0x41dd1a[_0x5a5996(0x81e)]&&_0x41dd1a[_0x5a5996(0x81e)][_0x5a5996(0x79b)]>0x0?_0xac48fa(_0x7592d6):(await _0x50393c(_0x7592d6),await _0x2d7ddd('成功','已成功加入购物车！'));return;}_0x132105[_0x5a5996(0x3af)](_0x25560f[_0x5a5996(0xe16)])&&console[_0x5a5996(0x51f)](_0x5a5996(0x102b)+_0x7592d6);}),document[_0x128c7f(0xc33)]('cart-items-list')[_0x128c7f(0x205)]('click',_0x5b97b8=>{const _0x529284=_0x128c7f,_0x350b4e=_0x5b97b8[_0x529284(0xe16)];_0x350b4e[_0x529284(0x10d3)][_0x529284(0x3af)]('decrease-qty-btn')&&_0x25bf67(parseInt(_0x350b4e[_0x529284(0x85)]['id']),-0x1),_0x350b4e[_0x529284(0x10d3)]['contains'](_0x529284(0x3c1))&&_0x25bf67(parseInt(_0x350b4e[_0x529284(0x85)]['id']),0x1),_0x350b4e[_0x529284(0x10d3)][_0x529284(0x3af)]('cart-item-checkbox')&&_0x2cc1c0();}),document[_0x128c7f(0xc33)](_0x128c7f(0x12e))['addEventListener'](_0x128c7f(0x335),async()=>{const _0x3e2c8f=_0x128c7f;if(_0x2b0414['length']===0x0)return;const _0x4f36e3=await _0x270512(_0x3e2c8f(0xb94),_0x3e2c8f(0xd8b));_0x4f36e3&&(_0x2b0414=[],_0x42d20e(),_0x518f76());}),document[_0x128c7f(0xc33)](_0x128c7f(0x1018))[_0x128c7f(0x205)](_0x128c7f(0x644),function(_0x3973e0){const _0x5789ae=_0x128c7f;document[_0x5789ae(0x67a)](_0x5789ae(0xb67))[_0x5789ae(0xd6a)](_0x3570b0=>{const _0x4ea8c4=_0x5789ae;_0x3570b0['checked']=_0x3973e0['target'][_0x4ea8c4(0x737)];}),_0x2cc1c0();}),document[_0x128c7f(0xc33)](_0x128c7f(0x7b2))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x45b4c4=_0x128c7f;document[_0x45b4c4(0xc33)](_0x45b4c4(0xfaf))[_0x45b4c4(0x10d3)]['remove'](_0x45b4c4(0x143));}),document['getElementById'](_0x128c7f(0x9a4))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x579ae7),document['getElementById'](_0x128c7f(0x39e))[_0x128c7f(0x205)](_0x128c7f(0x644),_0x32cbee=>{const _0x1d9cf8=_0x128c7f,_0xcca751=_0x32cbee[_0x1d9cf8(0xe16)][_0x1d9cf8(0x1d0)][0x0];if(_0xcca751){const _0x5b1b7b=new FileReader();_0x5b1b7b[_0x1d9cf8(0x833)]=_0xd48d6b=>{const _0x455ad5=_0x1d9cf8;document['getElementById'](_0x455ad5(0xc87))[_0x455ad5(0x87b)]=_0xd48d6b[_0x455ad5(0xe16)]['result'];},_0x5b1b7b[_0x1d9cf8(0xbcf)](_0xcca751);}}),document['getElementById'](_0x128c7f(0xe81))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x17f5ed=>{const _0x7bf453=_0x128c7f,_0x15aad7=_0x17f5ed[_0x7bf453(0xe16)][_0x7bf453(0x7a7)](_0x7bf453(0x124));if(_0x15aad7){const _0x1a8237=_0x15aad7['closest'](_0x7bf453(0x689));_0x1a8237&&_0x501b1e(parseInt(_0x1a8237[_0x7bf453(0x85)][_0x7bf453(0x2f0)]));}}),document[_0x128c7f(0xc33)](_0x128c7f(0x1f5))['addEventListener'](_0x128c7f(0x335),()=>{const _0x4c6fc8=_0x128c7f;document[_0x4c6fc8(0xc33)](_0x4c6fc8(0x259))['classList'][_0x4c6fc8(0x2c7)]('visible');}),document[_0x128c7f(0xc33)](_0x128c7f(0x1139))['addEventListener']('click',async()=>{const _0x276846=_0x128c7f,_0x5a23cc=Array[_0x276846(0x301)](document['querySelectorAll']('#gift-recipient-list\x20.contact-picker-item.selected'))['map'](_0x367daa=>_0x367daa['dataset'][_0x276846(0xd4c)]);if(_0x5a23cc[_0x276846(0x79b)]===0x0){alert('请至少选择一位收礼人。');return;}const _0x2cf249=_0x2b0414['filter'](_0x43517a=>document[_0x276846(0x977)](_0x276846(0x1148)+_0x43517a[_0x276846(0x10ea)]+_0x276846(0x1e7)));await _0x388297(_0x2cf249,_0x5a23cc),document[_0x276846(0xc33)]('gift-recipient-modal')[_0x276846(0x10d3)][_0x276846(0x2c7)](_0x276846(0x143));}),document[_0x128c7f(0xc33)](_0x128c7f(0x7e4))['addEventListener'](_0x128c7f(0x335),_0x592792=>{const _0x4742bc=_0x128c7f,_0x5738fc=_0x592792['target'][_0x4742bc(0x7a7)](_0x4742bc(0x101c));_0x5738fc&&_0x5738fc[_0x4742bc(0x10d3)][_0x4742bc(0xe2c)](_0x4742bc(0x63f));}),document['getElementById'](_0x128c7f(0xff1))[_0x128c7f(0x205)](_0x128c7f(0x644),function(_0x38ee46){const _0x6c7b6b=_0x128c7f,_0x41a771=_0x38ee46['target'][_0x6c7b6b(0x737)];document['querySelectorAll']('#gift-recipient-list\x20.contact-picker-item')[_0x6c7b6b(0xd6a)](_0x387ba9=>{const _0x3db3cd=_0x6c7b6b;_0x387ba9[_0x3db3cd(0x10d3)]['toggle'](_0x3db3cd(0x63f),_0x41a771);});}),document[_0x128c7f(0xc33)](_0x128c7f(0xef5))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x5f1cab),document['getElementById'](_0x128c7f(0xb96))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x1b9944),document['getElementById'](_0x128c7f(0x9d8))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x4eb299),document[_0x128c7f(0xc33)](_0x128c7f(0x11fd))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x4f88d2=_0x128c7f,_0x254314=document[_0x4f88d2(0xc33)](_0x4f88d2(0x19c)),_0x407f4b=document[_0x4f88d2(0xc33)](_0x4f88d2(0x82a))['value'][_0x4f88d2(0x7da)]()||_0x29e2c5;_0x254314[_0x4f88d2(0x87b)]=_0x407f4b,_0x254314[_0x4f88d2(0x193)]()[_0x4f88d2(0x876)](_0x46a916=>alert(_0x4f88d2(0xa00)));}),document['getElementById'](_0x128c7f(0xf01))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x2abb47=_0x128c7f;document[_0x2abb47(0xc33)](_0x2abb47(0x82a))[_0x2abb47(0x22a)]='',alert(_0x2abb47(0xf2b));}),document['getElementById'](_0x128c7f(0x94f))['addEventListener'](_0x128c7f(0x335),_0x1b9f7b=>{const _0x35fbf6=_0x128c7f,_0x288b55=_0x1b9f7b[_0x35fbf6(0xe16)];_0x288b55[_0x35fbf6(0x10d3)][_0x35fbf6(0x3af)]('editable-text')&&_0x2648fa(_0x288b55),_0x288b55[_0x35fbf6(0x10d3)][_0x35fbf6(0x3af)](_0x35fbf6(0xb54))&&_0x1c0fad(_0x288b55);}),document[_0x128c7f(0xc33)](_0x128c7f(0x11b5))[_0x128c7f(0x205)](_0x128c7f(0x335),_0xf8308a),document[_0x128c7f(0xc33)]('cancel-music-search-btn')[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x666841=_0x128c7f;document[_0x666841(0xc33)](_0x666841(0xc53))[_0x666841(0x10d3)][_0x666841(0x2c7)]('visible');}),document[_0x128c7f(0xc33)]('add-song-search-btn')['addEventListener'](_0x128c7f(0x335),_0xf8308a),document[_0x128c7f(0xc33)](_0x128c7f(0x34a))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x411560=_0x128c7f;document[_0x411560(0xc33)](_0x411560(0xc53))[_0x411560(0x10d3)][_0x411560(0x2c7)](_0x411560(0x143));}),document[_0x128c7f(0xc33)]('select-all-music-search')[_0x128c7f(0x205)](_0x128c7f(0x644),function(_0x1f9185){const _0x116429=_0x128c7f;document[_0x116429(0x67a)](_0x116429(0x1191))[_0x116429(0xd6a)](_0x401eef=>{const _0xcfd744=_0x116429;_0x401eef[_0xcfd744(0x737)]=_0x1f9185[_0xcfd744(0xe16)]['checked'];});}),document[_0x128c7f(0xc33)](_0x128c7f(0x971))[_0x128c7f(0x205)]('click',_0x5a7af1=>{const _0x42d02c=_0x128c7f,_0xf2d64e=_0x5a7af1[_0x42d02c(0xe16)]['closest']('.search-result-item');if(_0xf2d64e){const _0x77b12d=_0xf2d64e['querySelector'](_0x42d02c(0x36c));_0x77b12d&&(_0x5a7af1[_0x42d02c(0xe16)]!==_0x77b12d&&(_0x77b12d[_0x42d02c(0x737)]=!_0x77b12d[_0x42d02c(0x737)]));}}),document[_0x128c7f(0xc33)](_0x128c7f(0x129c))[_0x128c7f(0x205)](_0x128c7f(0x335),async()=>{const _0x2883bb=_0x128c7f,_0x498d9f=document[_0x2883bb(0x67a)]('.music-search-checkbox:checked');if(_0x498d9f[_0x2883bb(0x79b)]===0x0){alert(_0x2883bb(0xb51));return;}document[_0x2883bb(0xc33)]('music-search-results-modal')[_0x2883bb(0x10d3)][_0x2883bb(0x2c7)](_0x2883bb(0x143)),await _0x2d7ddd(_0x2883bb(0xb37),_0x2883bb(0x117)+_0x498d9f[_0x2883bb(0x79b)]+_0x2883bb(0x11be));const _0x201fe9=Array[_0x2883bb(0x301)](_0x498d9f)[_0x2883bb(0x9d5)](_0x3d5a5c=>JSON[_0x2883bb(0x6b1)](_0x3d5a5c['closest'](_0x2883bb(0x1132))['dataset'][_0x2883bb(0x58e)]));let _0xef3e7=0x0,_0x4d1fc9=[];const _0x344e79=_0x201fe9[_0x2883bb(0x9d5)](_0xa25759=>_0x38a376(_0xa25759)),_0x170846=await Promise[_0x2883bb(0x5c8)](_0x344e79);_0x170846[_0x2883bb(0xd6a)]((_0x3bf927,_0xc21a63)=>{const _0x39c769=_0x2883bb;_0x3bf927?(_0x5ebb31[_0x39c769(0xd9f)][_0x39c769(0x2d6)](_0x3bf927),_0xef3e7++):_0x4d1fc9['push'](_0x201fe9[_0xc21a63]['name']);});_0xef3e7>0x0&&(await _0x83d626(),_0x596fed(),_0x5ebb31[_0x2883bb(0x12a0)]===-0x1&&(_0x5ebb31['currentIndex']=_0x5ebb31[_0x2883bb(0xd9f)]['length']-_0xef3e7,_0x246e79()));let _0x52177b=_0x2883bb(0x898)+_0xef3e7+_0x2883bb(0x781);_0x4d1fc9[_0x2883bb(0x79b)]>0x0&&(_0x52177b+='\x0a\x0a'+_0x4d1fc9[_0x2883bb(0x79b)]+_0x2883bb(0x999)+_0x4d1fc9[_0x2883bb(0x100b)](_0x2883bb(0x110f))),await _0x2d7ddd(_0x2883bb(0x6f3),_0x52177b);}),document[_0x128c7f(0xc33)](_0x128c7f(0xe29))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x3a675b=_0x128c7f;document[_0x3a675b(0xc33)](_0x3a675b(0xe29))[_0x3a675b(0x10d3)][_0x3a675b(0xe2c)](_0x3a675b(0x1aa));}),document['getElementById'](_0x128c7f(0x11b5))[_0x128c7f(0x205)](_0x128c7f(0x335),_0xf8308a),document[_0x128c7f(0xc33)]('cancel-music-search-btn')[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x190dfc=_0x128c7f;document[_0x190dfc(0xc33)](_0x190dfc(0xc53))[_0x190dfc(0x10d3)][_0x190dfc(0x2c7)](_0x190dfc(0x143));}),document[_0x128c7f(0xc33)]('search-results-list')['addEventListener'](_0x128c7f(0x335),_0x46b782=>{const _0x527f3f=_0x128c7f,_0x217d93=_0x46b782[_0x527f3f(0xe16)]['closest'](_0x527f3f(0x1132));if(_0x217d93&&_0x217d93[_0x527f3f(0x85)]['songJson']){const _0x36e0c0=JSON[_0x527f3f(0x6b1)](_0x217d93['dataset'][_0x527f3f(0x58e)]);handleSearchResultClick(_0x36e0c0);}}),document[_0x128c7f(0xc33)](_0x128c7f(0x6fd))['addEventListener'](_0x128c7f(0x335),_0x580c13),document[_0x128c7f(0xc33)](_0x128c7f(0xe22))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x4beaad),document['getElementById'](_0x128c7f(0x54c))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x8d1db6),document['getElementById'](_0x128c7f(0xeed))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x5b4c6f),document['getElementById'](_0x128c7f(0x130))[_0x128c7f(0x205)](_0x128c7f(0x644),()=>{const _0x367b1c=_0x128c7f;_0x12493e[_0x367b1c(0x10f6)][_0x367b1c(0xa86)]=document[_0x367b1c(0xc33)]('status-bar-toggle-switch')[_0x367b1c(0x737)],_0xadc4e();}),document[_0x128c7f(0xc33)](_0x128c7f(0x2e8))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x46d4b5),document[_0x128c7f(0xc33)]('cancel-clear-posts-btn')[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x55c049=_0x128c7f;document[_0x55c049(0xc33)](_0x55c049(0xf57))[_0x55c049(0x10d3)][_0x55c049(0x2c7)]('visible');}),document['getElementById'](_0x128c7f(0xd61))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x5ccb2b),document[_0x128c7f(0xc33)]('clear-posts-list')[_0x128c7f(0x205)]('click',_0x4d5fd6=>{const _0x4d0cf5=_0x128c7f,_0x34041e=_0x4d5fd6[_0x4d0cf5(0xe16)]['closest'](_0x4d0cf5(0xb73));_0x34041e&&_0x34041e[_0x4d0cf5(0x10d3)][_0x4d0cf5(0xe2c)](_0x4d0cf5(0x63f));}),document[_0x128c7f(0xc33)](_0x128c7f(0xb4))['addEventListener'](_0x128c7f(0x644),async _0x28ab0d=>{const _0x4f7b2b=_0x128c7f,_0x4842f3=_0x28ab0d[_0x4f7b2b(0xe16)][_0x4f7b2b(0x1d0)][0x0];if(_0x4842f3){const _0x92d41f=await new Promise(_0x4634a4=>{const _0x20c2cd=_0x4f7b2b,_0x5320ca=new FileReader();_0x5320ca[_0x20c2cd(0x833)]=()=>_0x4634a4(_0x5320ca[_0x20c2cd(0x129)]),_0x5320ca['readAsDataURL'](_0x4842f3);});_0x12493e[_0x4f7b2b(0x10f6)]['globalChatBackground']=_0x92d41f,_0x374557();}_0x28ab0d[_0x4f7b2b(0xe16)][_0x4f7b2b(0x22a)]=null;}),document[_0x128c7f(0xc33)](_0x128c7f(0x3ba))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x300fe6=_0x128c7f;_0x12493e[_0x300fe6(0x10f6)][_0x300fe6(0x840)]='',_0x374557();}),document['getElementById']('save-wallpaper-btn')[_0x128c7f(0x205)](_0x128c7f(0x335),async()=>{const _0x2418f0=_0x128c7f;_0xa2c277&&(_0x12493e[_0x2418f0(0x10f6)]['wallpaper']=_0xa2c277),_0x12493e[_0x2418f0(0x10f6)][_0x2418f0(0x22c)]=document['getElementById'](_0x2418f0(0x85c))['value'][_0x2418f0(0x7da)](),_0x12493e[_0x2418f0(0x10f6)][_0x2418f0(0xc7)]=document[_0x2418f0(0xc33)](_0x2418f0(0x82a))[_0x2418f0(0x22a)]['trim'](),_0x12493e[_0x2418f0(0x10f6)]['showStatusBar']=document[_0x2418f0(0xc33)](_0x2418f0(0x130))[_0x2418f0(0x737)],await _0x2a2987['globalSettings'][_0x2418f0(0xf36)](_0x12493e[_0x2418f0(0x10f6)]),_0x5871a7(),_0xa2c277=null,_0x21aa4c(),_0x3e472a(_0x12493e[_0x2418f0(0x10f6)]['globalCss']),_0xadc4e(),alert(_0x2418f0(0xf5d)),_0x38f00f('home-screen');}),document[_0x128c7f(0xc33)]('upload-global-bg-url-btn')['addEventListener'](_0x128c7f(0x335),async()=>{const _0x530ab9=_0x128c7f,_0x14c7ec=await _0x1ca09c(_0x530ab9(0x39d),_0x530ab9(0x327),'',_0x530ab9(0x11a));if(_0x14c7ec&&_0x14c7ec[_0x530ab9(0x7da)]())_0x12493e[_0x530ab9(0x10f6)]['globalChatBackground']=_0x14c7ec['trim'](),_0x374557();else _0x14c7ec!==null&&alert(_0x530ab9(0xd08));}),document['getElementById'](_0x128c7f(0xae9))[_0x128c7f(0x205)](_0x128c7f(0x335),async()=>{const _0x435e44=_0x128c7f,_0x16f975=await _0x1ca09c('网络图片\x20(EPhone)',_0x435e44(0x9a0),'','url');if(_0x16f975&&_0x16f975['trim']())_0xa2c277=_0x16f975['trim'](),_0x374557();else _0x16f975!==null&&alert(_0x435e44(0xd08));}),document[_0x128c7f(0xc33)](_0x128c7f(0x24c))[_0x128c7f(0x205)](_0x128c7f(0x335),async()=>{const _0x429bc4=_0x128c7f,_0x452310=await _0x1ca09c(_0x429bc4(0xada),_0x429bc4(0xf7d),'',_0x429bc4(0x11a));if(_0x452310&&_0x452310[_0x429bc4(0x7da)]())_0x12493e[_0x429bc4(0x10f6)]['cphoneWallpaper']=_0x452310[_0x429bc4(0x7da)](),_0x374557();else _0x452310!==null&&alert(_0x429bc4(0xd08));}),document['getElementById']('remove-ephone-bg-btn')[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x47346c=_0x128c7f;_0xa2c277=null,_0x12493e[_0x47346c(0x10f6)]['wallpaper']='',_0x374557();}),document[_0x128c7f(0xc33)](_0x128c7f(0x639))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x51e85b=_0x128c7f;_0x12493e[_0x51e85b(0x10f6)][_0x51e85b(0x2f5)]='',_0x374557();}),document[_0x128c7f(0xc33)](_0x128c7f(0xff6))[_0x128c7f(0x205)](_0x128c7f(0x644),_0x5ba4e2),document[_0x128c7f(0xc33)](_0x128c7f(0xbb2))['addEventListener'](_0x128c7f(0x335),_0x18df66),document[_0x128c7f(0xc33)](_0x128c7f(0xc00))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x51004b),document['getElementById'](_0x128c7f(0xa3d))[_0x128c7f(0x205)](_0x128c7f(0x644),_0x885494),document[_0x128c7f(0xc33)](_0x128c7f(0xa3a))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x11e789),document[_0x128c7f(0xc33)](_0x128c7f(0xba1))['addEventListener']('click',_0x5956c7),document[_0x128c7f(0xc33)](_0x128c7f(0x413))[_0x128c7f(0x205)](_0x128c7f(0x644),_0x150daa),document[_0x128c7f(0xc33)](_0x128c7f(0xcf8))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x4b7009),document[_0x128c7f(0xc33)](_0x128c7f(0x5f1))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x35ad49),document[_0x128c7f(0xc33)](_0x128c7f(0x39f))['addEventListener'](_0x128c7f(0x335),_0x15b6b0),document['getElementById']('close-sticker-category-manager-btn')[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x15492c=_0x128c7f;document['getElementById'](_0x15492c(0x801))[_0x15492c(0x10d3)][_0x15492c(0x2c7)](_0x15492c(0x143)),_0x3f10e9();}),document[_0x128c7f(0xc33)]('add-new-sticker-category-btn')[_0x128c7f(0x205)](_0x128c7f(0x335),_0x25d5f6),document[_0x128c7f(0xc33)](_0x128c7f(0x6fa))[_0x128c7f(0x205)]('click',_0x2db5e9=>{const _0x338de6=_0x128c7f;if(_0x2db5e9[_0x338de6(0xe16)][_0x338de6(0x10d3)]['contains'](_0x338de6(0x9d6))){const _0x212245=parseInt(_0x2db5e9[_0x338de6(0xe16)][_0x338de6(0x85)]['id']);_0x5f2631(_0x212245);}}),document[_0x128c7f(0xc33)](_0x128c7f(0xe4))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x48fdaa=>{const _0x2c8794=_0x128c7f;if(_0x48fdaa[_0x2c8794(0xe16)][_0x2c8794(0x10d3)]['contains'](_0x2c8794(0x12b5))){const _0x34da68=_0x48fdaa[_0x2c8794(0xe16)][_0x2c8794(0x85)][_0x2c8794(0x305)],_0x2b1253=_0x34da68!==_0x2c8794(0x5c8)&&_0x34da68!==_0x2c8794(0xef1)?parseInt(_0x34da68):_0x34da68;_0x1abb98(_0x2b1253);}}),document[_0x128c7f(0xc33)](_0x128c7f(0xc2c))['addEventListener'](_0x128c7f(0x644),_0x57cd1f),document['getElementById'](_0x128c7f(0x35e))[_0x128c7f(0x205)]('click',_0x2e4aea),document[_0x128c7f(0xc33)]('import-single-chat-btn')[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x1f7a1d=_0x128c7f;document[_0x1f7a1d(0xc33)](_0x1f7a1d(0xcb7))[_0x1f7a1d(0x335)]();}),document[_0x128c7f(0xc33)](_0x128c7f(0xcb7))[_0x128c7f(0x205)](_0x128c7f(0x644),_0x49a4a4=>{const _0x5c067e=_0x128c7f,_0x1e6c00=_0x49a4a4['target']['files'][0x0];_0x1e6c00&&_0x3f241e(_0x1e6c00),_0x49a4a4[_0x5c067e(0xe16)][_0x5c067e(0x22a)]=null;}),document[_0x128c7f(0xc33)](_0x128c7f(0x2af))[_0x128c7f(0x205)]('click',()=>_0x555387()),document[_0x128c7f(0xc33)](_0x128c7f(0x4c9))[_0x128c7f(0x205)]('click',()=>openDiaryEditor()),document[_0x128c7f(0xc33)](_0x128c7f(0x1287))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x3e0d8d),document[_0x128c7f(0xc33)](_0x128c7f(0x155))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x27a13d),document[_0x128c7f(0xc33)](_0x128c7f(0xcbf))[_0x128c7f(0x205)]('click',_0xe21f61),document[_0x128c7f(0xc33)](_0x128c7f(0xd49))['addEventListener'](_0x128c7f(0x335),async()=>{const _0x5b8c6e=_0x128c7f;_0x2d7ddd('正在执行...',_0x5b8c6e(0x279));try{await Promise[_0x5b8c6e(0x5c8)]([_0x5a8ef1(),_0x529dee()]),console[_0x5b8c6e(0x51f)]('CPhone\x20QQ模拟记录生成\x20和\x20主聊天推进\x20已同时完成。');}catch(_0x466d78){console[_0x5b8c6e(0x4d9)](_0x5b8c6e(0xdc1),_0x466d78),await _0x2d7ddd(_0x5b8c6e(0xb9d),_0x5b8c6e(0xb03)+_0x466d78['message']);}}),document[_0x128c7f(0xc33)](_0x128c7f(0x9c))['addEventListener'](_0x128c7f(0x335),_0x37ac6d=>{const _0x28835e=_0x128c7f,_0x45be3e=_0x37ac6d['target'][_0x28835e(0x7a7)](_0x28835e(0x28d));if(_0x45be3e&&_0x45be3e['dataset'][_0x28835e(0x81d)]){const _0x2b262c=parseInt(_0x45be3e[_0x28835e(0x85)][_0x28835e(0x81d)]);!isNaN(_0x2b262c)&&_0x90a7f3(_0x2b262c);}}),document[_0x128c7f(0xc33)](_0x128c7f(0x1137))[_0x128c7f(0x205)]('click',()=>{const _0x1e30cb=_0x128c7f;_0x11e45b(_0x1e30cb(0x646));});const _0x6db0c7=document[_0x128c7f(0xc33)](_0x128c7f(0x1113)),_0x2686fa=()=>{const _0x6b2ace=_0x128c7f;if(_0x200133!==_0x6b2ace(0xa98))return;if(_0x6db0c7[_0x6b2ace(0x1244)]<0x1&&!_0x52add8){const _0x592820=_0x12493e[_0x6b2ace(0xc45)][_0x41e464]?.['history'][_0x6b2ace(0x79b)]||0x0;_0x592820>_0x5d68c8&&_0xbbf2f5();}};_0x6db0c7[_0x128c7f(0x205)](_0x128c7f(0xba9),_0x2686fa),document[_0x128c7f(0xc33)](_0x128c7f(0xb6e))['addEventListener'](_0x128c7f(0x335),()=>{alert('这是模拟对话，无法发送消息哦~');}),document['getElementById'](_0x128c7f(0x3c4))['addEventListener'](_0x128c7f(0x335),_0x3bbe5f),document[_0x128c7f(0xc33)](_0x128c7f(0xb8f))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x3db9d7=>{const _0xa17e64=_0x128c7f,_0xcc9f5c=_0x3db9d7[_0xa17e64(0xe16)]['closest'](_0xa17e64(0x33d));if(_0xcc9f5c&&_0xcc9f5c[_0xa17e64(0x85)][_0xa17e64(0x11ac)]){const _0x5192e2=_0xcc9f5c[_0xa17e64(0x85)]['description'];_0x2d7ddd(_0xa17e64(0x1032),_0x5192e2[_0xa17e64(0xc12)](/\n/g,_0xa17e64(0xfd5)));}}),document[_0x128c7f(0xc33)](_0x128c7f(0x24e))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x2cd80c),document[_0x128c7f(0xc33)](_0x128c7f(0x5e4))['addEventListener'](_0x128c7f(0x335),_0x19cc00),document['getElementById'](_0x128c7f(0x14a))[_0x128c7f(0x205)]('click',_0x5021c1=>{const _0x5b4641=_0x128c7f,_0x546e8e=_0x5021c1['target'][_0x5b4641(0x7a7)](_0x5b4641(0x1285));if(_0x546e8e&&_0x546e8e[_0x5b4641(0x85)][_0x5b4641(0x842)]){const _0x41da10=_0x546e8e['dataset'][_0x5b4641(0x842)];_0x2d7ddd('TA的想法...',_0x41da10['replace'](/\n/g,_0x5b4641(0xfd5)));}}),window['openCharWallet']=_0x12750b,document['getElementById'](_0x128c7f(0x10e3))[_0x128c7f(0x205)]('click',_0x17257b),document['getElementById']('char-memo-detail-back-btn')['addEventListener']('click',()=>_0x11e45b('char-memo-screen')),document['getElementById'](_0x128c7f(0xaa7))['addEventListener'](_0x128c7f(0x335),_0x26b53f),document[_0x128c7f(0xc33)](_0x128c7f(0x4c9))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x5f2d2c),document[_0x128c7f(0xc33)](_0x128c7f(0x1059))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>_0x11e45b(_0x128c7f(0x482))),document[_0x128c7f(0xc33)](_0x128c7f(0xccf))[_0x128c7f(0x205)](_0x128c7f(0x335),_0xc867ac),document[_0x128c7f(0xc33)](_0x128c7f(0xadc))[_0x128c7f(0x205)]('click',_0xea8068),document[_0x128c7f(0xc33)](_0x128c7f(0x9af))['addEventListener']('click',_0x2b59ec),document[_0x128c7f(0xc33)](_0x128c7f(0x845))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x2fc404),document['getElementById'](_0x128c7f(0x10eb))[_0x128c7f(0x205)]('click',_0x48c095),document[_0x128c7f(0xc33)](_0x128c7f(0x10eb))['addEventListener'](_0x128c7f(0x335),_0x48c095),document[_0x128c7f(0xc33)](_0x128c7f(0xd4e))[_0x128c7f(0x205)]('click',()=>_0x38f00f(_0x128c7f(0x21d))),document['getElementById'](_0x128c7f(0xd5a))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x2d2480),document[_0x128c7f(0xc33)]('douban-wait-reply-btn')[_0x128c7f(0x205)](_0x128c7f(0x335),_0x18fb55),document[_0x128c7f(0xc33)](_0x128c7f(0x1251))[_0x128c7f(0x205)](_0x128c7f(0x644),async _0x2b084a=>{const _0x50a1c0=_0x128c7f,_0x5ad2c7=_0x2b084a['target'][_0x50a1c0(0x1d0)][0x0];if(_0x5ad2c7){const _0x44a9aa=await new Promise(_0x54749c=>{const _0x254e7e=_0x50a1c0,_0x577aa3=new FileReader();_0x577aa3['onload']=()=>_0x54749c(_0x577aa3[_0x254e7e(0x129)]),_0x577aa3[_0x254e7e(0xbcf)](_0x5ad2c7);});_0x12493e[_0x50a1c0(0x10f6)][_0x50a1c0(0x2f5)]=_0x44a9aa,_0x374557();}}),document[_0x128c7f(0xc33)](_0x128c7f(0xd63))[_0x128c7f(0x205)](_0x128c7f(0x335),_0xd834a0=>{const _0xb63a57=_0x128c7f;if(_0xd834a0['target'][_0xb63a57(0x10d3)][_0xb63a57(0x3af)](_0xb63a57(0xc54))){const _0x24fa3e=_0xd834a0['target'][_0xb63a57(0x7a7)](_0xb63a57(0x107b)),_0x30c63b=_0x24fa3e[_0xb63a57(0x85)][_0xb63a57(0x12f)];_0x30c63b&&_0x5044c5(_0x30c63b,_0xb63a57(0x1001),_0x24fa3e);}}),document[_0x128c7f(0xc33)](_0x128c7f(0x981))['addEventListener'](_0x128c7f(0x335),()=>{const _0x502a1d=_0x128c7f;document[_0x502a1d(0xc33)](_0x502a1d(0x5a7))[_0x502a1d(0x335)]();}),document[_0x128c7f(0xc33)]('import-appearance-input')[_0x128c7f(0x205)](_0x128c7f(0x644),_0x14a2ba=>{const _0x44af55=_0x128c7f,_0x111d0a=_0x14a2ba[_0x44af55(0xe16)][_0x44af55(0x1d0)][0x0];_0x111d0a&&_0x466798(_0x111d0a),_0x14a2ba[_0x44af55(0xe16)]['value']=null;}),document[_0x128c7f(0x205)](_0x128c7f(0x277),()=>{const _0x2530f3=_0x128c7f;document[_0x2530f3(0x256)]==='hidden'&&(localStorage['setItem'](_0x2530f3(0xc82),Date[_0x2530f3(0x6ee)]()),console[_0x2530f3(0x51f)](_0x2530f3(0x2ff)));}),document[_0x128c7f(0xc33)](_0x128c7f(0x1044))['addEventListener'](_0x128c7f(0x335),_0x5b3205),document[_0x128c7f(0xc33)]('import-world-book-btn')['addEventListener'](_0x128c7f(0x335),()=>{const _0x1bb9fa=_0x128c7f;document[_0x1bb9fa(0xc33)](_0x1bb9fa(0xef8))['click']();}),document['getElementById'](_0x128c7f(0xef8))[_0x128c7f(0x205)]('change',_0x2743df=>{const _0x27b532=_0x128c7f,_0x51b09e=_0x2743df[_0x27b532(0xe16)][_0x27b532(0x1d0)][0x0];_0x51b09e&&_0x13915b(_0x51b09e),_0x2743df[_0x27b532(0xe16)]['value']=null;}),document[_0x128c7f(0xc33)](_0x128c7f(0x702))[_0x128c7f(0x205)](_0x128c7f(0x644),async _0x2adeb9=>{const _0x3abe50=_0x128c7f,_0x8ff649=_0x2adeb9['target'][_0x3abe50(0x737)];_0x12493e[_0x3abe50(0x10f6)][_0x3abe50(0xd2f)]=_0x8ff649,await _0x2a2987[_0x3abe50(0x10f6)][_0x3abe50(0xf36)](_0x12493e['globalSettings']);const _0x2bd9ce=document[_0x3abe50(0x977)](_0x3abe50(0x203));if(_0x2bd9ce)switch(_0x2bd9ce['id']){case _0x3abe50(0xf1b):_0x1bbfd3(_0x12493e[_0x3abe50(0x7bc)]);break;case _0x3abe50(0xe8f):if(document[_0x3abe50(0xc33)](_0x3abe50(0x496))[_0x3abe50(0x10d3)][_0x3abe50(0x3af)](_0x3abe50(0x1043)))_0x14f3b0();if(document[_0x3abe50(0xc33)](_0x3abe50(0x5b1))[_0x3abe50(0x10d3)]['contains']('active'))_0x32f042();break;case _0x3abe50(0x21d):_0xf7f64d();break;case _0x3abe50(0xa13):_0x47583c(_0x2ef46b);break;case _0x3abe50(0x6c1):const _0x2c655e=document[_0x3abe50(0x977)](_0x3abe50(0x268));if(_0x2c655e)switch(_0x2c655e['id']){case _0x3abe50(0xc6d):_0x1d28b8();break;case'char-taobao-screen':_0x3984ad();break;case _0x3abe50(0x5b7):const _0x1853b2=_0x12493e[_0x3abe50(0xc45)][_0x41e464],_0x4613c6=_0x1853b2['simulatedBrowserHistory']||[],_0x1d1e88=_0x4613c6['length']>0x0?_0x4613c6[_0x3abe50(0x79b)]-0x1:0x0;_0x2bc3ff(_0x4613c6[_0x1d1e88]);break;case _0x3abe50(0xa90):_0x543ea9();break;case _0x3abe50(0x646):_0x351203();break;case _0x3abe50(0x160):const _0x17fd2b=document[_0x3abe50(0x977)](_0x3abe50(0x1161))?.['dataset'][_0x3abe50(0x81d)]||0x0;_0x90a7f3(parseInt(_0x17fd2b));break;}break;}_0x2d7ddd(_0x3abe50(0xaef),_0x3abe50(0x46e)+(_0x8ff649?'开启':'关闭')+'。');}),document[_0x128c7f(0xc33)](_0x128c7f(0x21c))[_0x128c7f(0x205)]('click',_0x275ed8),document[_0x128c7f(0xc33)]('search-history-back-btn')['addEventListener'](_0x128c7f(0x335),()=>{_0x38f00f('chat-settings-screen');}),document[_0x128c7f(0xc33)](_0x128c7f(0x7c2))[_0x128c7f(0x205)]('click',_0xc7ba77),document[_0x128c7f(0xc33)]('clear-search-btn')[_0x128c7f(0x205)]('click',_0x2905bf),document['getElementById'](_0x128c7f(0xd36))['addEventListener'](_0x128c7f(0x335),_0x2b51e3),document[_0x128c7f(0xc33)](_0x128c7f(0xfc))['addEventListener'](_0x128c7f(0x335),_0x121e32),document[_0x128c7f(0x977)](_0x128c7f(0x4ac))['addEventListener'](_0x128c7f(0x335),_0x71a14d=>{const _0xe2e278=_0x128c7f;if(_0x71a14d['target']['classList'][_0xe2e278(0x3af)]('delete-btn')){const _0x429791=parseInt(_0x71a14d['target'][_0xe2e278(0x85)]['id']);!isNaN(_0x429791)&&_0x3f4c15(_0x429791);}}),_0x59f2cd(),window['openPresetScreen']=_0x296e2e,document[_0x128c7f(0xc33)](_0x128c7f(0xbd5))['addEventListener']('click',async()=>{const _0x2a6c2d=_0x128c7f,_0x113084=await _0x1ca09c(_0x2a6c2d(0x7b7),_0x2a6c2d(0x3da));if(_0x113084&&_0x113084[_0x2a6c2d(0x7da)]()){const _0x249419={'id':_0x2a6c2d(0xc80)+Date[_0x2a6c2d(0x6ee)](),'name':_0x113084[_0x2a6c2d(0x7da)](),'content':[]};await _0x2a2987['presets'][_0x2a6c2d(0xb9)](_0x249419),await _0x46b9c2(),_0x41e60b(_0x249419['id']);}}),document['getElementById'](_0x128c7f(0xa3c))['addEventListener'](_0x128c7f(0x335),_0x2bd3da),document['getElementById'](_0x128c7f(0xa09))['addEventListener']('click',()=>{const _0x783f7a=_0x128c7f,_0xf55c17=document['getElementById']('preset-entries-container');_0xf55c17[_0x783f7a(0x977)]('p')&&(_0xf55c17[_0x783f7a(0x102a)]='');const _0x150cb5=_0x53de62();_0xf55c17[_0x783f7a(0xf77)](_0x150cb5),_0x150cb5[_0x783f7a(0x977)](_0x783f7a(0xfec))['focus']();}),document[_0x128c7f(0xc33)](_0x128c7f(0x4f1))['addEventListener'](_0x128c7f(0x335),async()=>{const _0x5b0cdf=_0x128c7f;if(!_0x505ce2)return;const _0x168be7=await _0x2a2987[_0x5b0cdf(0xe31)][_0x5b0cdf(0xec0)](_0x505ce2);if(!_0x168be7)return;const _0x17625e=document[_0x5b0cdf(0xc33)](_0x5b0cdf(0xfbb))[_0x5b0cdf(0x22a)][_0x5b0cdf(0x7da)]();if(!_0x17625e){alert(_0x5b0cdf(0xa49));return;}_0x168be7[_0x5b0cdf(0x578)]=_0x17625e,_0x168be7[_0x5b0cdf(0x305)]=parseInt(document[_0x5b0cdf(0xc33)](_0x5b0cdf(0x71a))[_0x5b0cdf(0x22a)])||null;const _0x5a4f8e=document[_0x5b0cdf(0xc33)](_0x5b0cdf(0x1af)),_0x4d5ede=_0x5a4f8e[_0x5b0cdf(0x67a)]('.message-editor-block'),_0x41f3f9=[];_0x4d5ede[_0x5b0cdf(0xd6a)](_0x373381=>{const _0x3a7c10=_0x5b0cdf,_0x5d94a3=_0x373381[_0x3a7c10(0x977)](_0x3a7c10(0xfec))[_0x3a7c10(0x22a)][_0x3a7c10(0x7da)]();_0x5d94a3&&_0x41f3f9['push']({'comment':_0x373381['querySelector'](_0x3a7c10(0xdbe))[_0x3a7c10(0x22a)][_0x3a7c10(0x7da)](),'keys':(_0x373381[_0x3a7c10(0x977)](_0x3a7c10(0xc72))['value'][_0x3a7c10(0x7da)]()||'')[_0x3a7c10(0x8d7)](',')[_0x3a7c10(0x9d5)](_0x493ce6=>_0x493ce6[_0x3a7c10(0x7da)]())[_0x3a7c10(0x1054)](Boolean),'content':_0x5d94a3,'enabled':_0x373381[_0x3a7c10(0x977)]('.entry-enabled-switch')[_0x3a7c10(0x737)]});}),_0x168be7['content']=_0x41f3f9,await _0x2a2987['presets'][_0x5b0cdf(0xf36)](_0x168be7),_0x505ce2=null,_0x38f00f(_0x5b0cdf(0x825)),await _0x46b9c2();}),document[_0x128c7f(0xc33)]('import-preset-btn')[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x2d41fc=_0x128c7f;document[_0x2d41fc(0xc33)]('import-preset-input')[_0x2d41fc(0x335)]();}),document['getElementById'](_0x128c7f(0xb00))['addEventListener'](_0x128c7f(0x644),_0x38d289),document[_0x128c7f(0xc33)]('reset-button-order-btn')['addEventListener']('click',_0x3883db),document[_0x128c7f(0xc33)]('clear-specific-data-btn')[_0x128c7f(0x205)](_0x128c7f(0x335),_0x60b33),document[_0x128c7f(0xc33)](_0x128c7f(0x102c))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x5ea362=_0x128c7f;document[_0x5ea362(0xc33)]('data-clear-wizard-modal')[_0x5ea362(0x10d3)][_0x5ea362(0x2c7)]('visible');}),document[_0x128c7f(0xc33)](_0x128c7f(0x629))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x566828),document[_0x128c7f(0xc33)]('back-to-clear-step1-btn')[_0x128c7f(0x205)]('click',_0x2af8f2),document['getElementById'](_0x128c7f(0x122e))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x3e01b3=_0x128c7f;document[_0x3e01b3(0xc33)](_0x3e01b3(0xb12))[_0x3e01b3(0x10d3)][_0x3e01b3(0x2c7)](_0x3e01b3(0x143));}),document[_0x128c7f(0xc33)](_0x128c7f(0xda3))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x1e9eb3),document[_0x128c7f(0xc33)](_0x128c7f(0xb12))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x1314bc=>{const _0x1783e1=_0x128c7f,_0x3c87cc=_0x1314bc[_0x1783e1(0xe16)][_0x1783e1(0x7a7)](_0x1783e1(0xb73));_0x3c87cc&&(_0x1314bc[_0x1783e1(0xea2)](),_0x3c87cc[_0x1783e1(0x10d3)][_0x1783e1(0xe2c)]('selected'));}),document[_0x128c7f(0xc33)]('data-clear-wizard-modal')[_0x128c7f(0x205)](_0x128c7f(0x644),_0x3d547a=>{const _0x1cbaf2=_0x128c7f;if(_0x3d547a[_0x1cbaf2(0xe16)]['id']===_0x1cbaf2(0x1007)){const _0x50ebe9=_0x3d547a[_0x1cbaf2(0xe16)]['checked'];document[_0x1cbaf2(0x67a)](_0x1cbaf2(0x77b))[_0x1cbaf2(0xd6a)](_0x13f285=>{const _0xd3c76=_0x1cbaf2;_0x13f285['classList'][_0xd3c76(0xe2c)](_0xd3c76(0x63f),_0x50ebe9);});}else{if(_0x3d547a[_0x1cbaf2(0xe16)]['id']===_0x1cbaf2(0x1119)){const _0x56625c=_0x3d547a[_0x1cbaf2(0xe16)]['checked'];document['querySelectorAll']('#data-clear-type-list\x20.clear-posts-item')[_0x1cbaf2(0xd6a)](_0x3a6384=>{const _0x3b632e=_0x1cbaf2;_0x3a6384[_0x3b632e(0x10d3)][_0x3b632e(0xe2c)](_0x3b632e(0x63f),_0x56625c);});}}}),document['getElementById']('compress-images-btn')[_0x128c7f(0x205)](_0x128c7f(0x335),_0x160df8),document['getElementById'](_0x128c7f(0x607))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x4262c9),document['getElementById'](_0x128c7f(0x5a9))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x2d9227),document['getElementById']('npc-list-back-btn')[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x3638dd=_0x128c7f;_0x598e0c(_0x3638dd(0x2fa));}),document[_0x128c7f(0xc33)](_0x128c7f(0xf96))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>_0x4e0128(null)),document[_0x128c7f(0xc33)](_0x128c7f(0x306))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x1ccd2f),document[_0x128c7f(0xc33)](_0x128c7f(0xdad))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0xd8de85=_0x128c7f;document['getElementById']('npc-editor-modal')['classList'][_0xd8de85(0x2c7)](_0xd8de85(0x143));}),document[_0x128c7f(0xc33)]('npc-avatar-input')[_0x128c7f(0x205)]('change',_0x14407f=>{const _0x43ec2f=_0x128c7f,_0xad4bbc=_0x14407f[_0x43ec2f(0xe16)][_0x43ec2f(0x1d0)][0x0];if(_0xad4bbc){const _0x3958dd=new FileReader();_0x3958dd[_0x43ec2f(0x833)]=_0x4edee7=>{const _0x142842=_0x43ec2f;document['getElementById'](_0x142842(0x388))[_0x142842(0x87b)]=_0x4edee7[_0x142842(0xe16)][_0x142842(0x129)];},_0x3958dd['readAsDataURL'](_0xad4bbc);}}),document[_0x128c7f(0xc33)]('chat-lock-overlay')['addEventListener']('click',_0x5dfdb0=>{const _0x2339fb=_0x128c7f;if(_0x5dfdb0[_0x2339fb(0xe16)]['id']==='spectator-reroll-btn')_0x33f20c();else _0x5dfdb0[_0x2339fb(0xe16)]['id']===_0x2339fb(0xfa8)&&_0x1d6a4f();}),_0x29b870(document[_0x128c7f(0xc33)](_0x128c7f(0xe29)),()=>{const _0x52f0f3=_0x128c7f;_0x5ebb31[_0x52f0f3(0x12a0)]>-0x1&&_0x101a2c(_0x5ebb31[_0x52f0f3(0x12a0)]);}),document[_0x128c7f(0xc33)](_0x128c7f(0x175))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x19ec2c),document[_0x128c7f(0xc33)](_0x128c7f(0xb27))[_0x128c7f(0x205)](_0x128c7f(0x335),_0xe6ffde),document[_0x128c7f(0xc33)](_0x128c7f(0x32f))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x37ba55=_0x128c7f;document['getElementById'](_0x37ba55(0x4cb))[_0x37ba55(0x10d3)][_0x37ba55(0x2c7)](_0x37ba55(0x143));}),document[_0x128c7f(0xc33)]('time-zone-search-input')[_0x128c7f(0x205)]('input',_0x257144=>{const _0x47923c=_0x128c7f,_0x31630d=_0x257144[_0x47923c(0xe16)][_0x47923c(0x22a)]['toLowerCase'](),_0x335e1d=document['getElementById'](_0x47923c(0x186));for(const _0x141ba3 of _0x335e1d[_0x47923c(0x6c2)]){const _0x4691f1=_0x141ba3[_0x47923c(0x11b0)][_0x47923c(0x963)]();_0x4691f1[_0x47923c(0x1d4)](_0x31630d)?_0x141ba3[_0x47923c(0x105d)][_0x47923c(0xf44)]='':_0x141ba3['style'][_0x47923c(0xf44)]=_0x47923c(0x854);}}),window[_0x128c7f(0xcf1)]=_0xa3b866,document['getElementById'](_0x128c7f(0x11b1))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>_0xa3b866(_0x128c7f(0x121f))),document[_0x128c7f(0xc33)](_0x128c7f(0xa5d))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0xf7803d=_0x128c7f;document[_0xf7803d(0xc33)](_0xf7803d(0x6ac))['classList'][_0xf7803d(0x2c7)]('visible');}),document[_0x128c7f(0xc33)](_0x128c7f(0x93))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x28fe55),document[_0x128c7f(0xc33)](_0x128c7f(0x783))['addEventListener'](_0x128c7f(0x335),()=>{const _0x5c110c=_0x128c7f;document['getElementById']('werewolf-role-modal')['classList']['remove'](_0x5c110c(0x143)),_0x529f2f();}),document['getElementById']('exit-werewolf-game-btn')[_0x128c7f(0x205)]('click',async()=>{const _0x16bad6=_0x128c7f,_0x2ed051=await _0x270512(_0x16bad6(0x250),'确定要退出当前这局狼人杀吗？游戏进度将不会被保存。',{'confirmButtonClass':_0x16bad6(0xa2)});_0x2ed051&&(_0x58b047[_0x16bad6(0x1f3)]=![],_0x38f00f(_0x58b047[_0x16bad6(0x109b)]?_0x16bad6(0xf1b):_0x16bad6(0x94f)));}),document['getElementById'](_0x128c7f(0x18b))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x46917c=_0x128c7f;document[_0x46917c(0xc33)](_0x46917c(0x10a5))[_0x46917c(0x10d3)][_0x46917c(0x2c7)](_0x46917c(0x143)),_0x38f00f(_0x58b047['chatId']?'chat-list-screen':'home-screen');}),document[_0x128c7f(0xc33)](_0x128c7f(0xad3))[_0x128c7f(0x205)]('click',()=>{const _0x33c0ad=_0x128c7f;document[_0x33c0ad(0xc33)](_0x33c0ad(0x68d))[_0x33c0ad(0x10d3)]['remove'](_0x33c0ad(0x143));}),document[_0x128c7f(0xc33)]('cancel-werewolf-lobby-btn')[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x5e3bf2=_0x128c7f;document[_0x5e3bf2(0xc33)](_0x5e3bf2(0x6ac))[_0x5e3bf2(0x10d3)][_0x5e3bf2(0x2c7)]('visible');}),document[_0x128c7f(0xc33)](_0x128c7f(0xd55))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x5a0764),document[_0x128c7f(0xc33)]('manual-werewolf-summary-btn')['addEventListener'](_0x128c7f(0x335),_0x37f343),document[_0x128c7f(0xc33)](_0x128c7f(0xc5e))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x4ad72d),document[_0x128c7f(0xc33)](_0x128c7f(0x797))[_0x128c7f(0x205)]('click',_0x513dc1),document[_0x128c7f(0xc33)]('cancel-delete-world-books-btn')[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x204fea=_0x128c7f;document[_0x204fea(0xc33)](_0x204fea(0x8fb))[_0x204fea(0x10d3)][_0x204fea(0x2c7)](_0x204fea(0x143));}),document[_0x128c7f(0xc33)](_0x128c7f(0xdef))[_0x128c7f(0x205)]('click',_0x3ced98),document['getElementById'](_0x128c7f(0x8fb))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x13a328=>{const _0x1329d1=_0x128c7f,_0x53491c=_0x13a328['target'][_0x1329d1(0x7a7)](_0x1329d1(0xb73));_0x53491c&&_0x53491c['classList'][_0x1329d1(0xe2c)](_0x1329d1(0x63f));if(_0x13a328['target']['id']===_0x1329d1(0x126c)){const _0x420526=_0x13a328['target'][_0x1329d1(0x737)];document['querySelectorAll'](_0x1329d1(0xc68))[_0x1329d1(0xd6a)](_0x1dd931=>{const _0x455679=_0x1329d1;_0x1dd931['classList'][_0x455679(0xe2c)](_0x455679(0x63f),_0x420526);});}}),document[_0x128c7f(0xc33)]('sticker-search-input')[_0x128c7f(0x205)](_0x128c7f(0x36e),()=>{_0x3f10e9(![]);}),document[_0x128c7f(0xc33)](_0x128c7f(0xe4))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x2aca85=>{const _0x3d6716=_0x128c7f;if(_0x2aca85[_0x3d6716(0xe16)][_0x3d6716(0x10d3)]['contains'](_0x3d6716(0x12b5))){const _0x5e936e=_0x2aca85[_0x3d6716(0xe16)]['dataset'][_0x3d6716(0x305)],_0x122b58=_0x5e936e!==_0x3d6716(0x5c8)&&_0x5e936e!==_0x3d6716(0xef1)?parseInt(_0x5e936e):_0x5e936e;document[_0x3d6716(0xc33)](_0x3d6716(0x1160))[_0x3d6716(0x22a)]='',_0x1abb98(_0x122b58);}});const _0x386880=document[_0x128c7f(0xc33)](_0x128c7f(0xe81));_0x386880[_0x128c7f(0x205)](_0x128c7f(0xba9),()=>{const _0x258931=_0x128c7f;if(_0x386880['scrollTop']<0x1&&!_0x28dd69){const _0x396fd1=_0x12493e[_0x258931(0xc45)][_0x12493e['activeChatId']]?.[_0x258931(0x1294)]['length']||0x0;_0x396fd1>_0x5c866f&&_0x4b82a5();}});const _0x5d709a=document[_0x128c7f(0xc33)](_0x128c7f(0xa1c));_0x5d709a['addEventListener'](_0x128c7f(0xba9),()=>{const _0x5778a3=_0x128c7f,{scrollTop:_0x1d2fae,scrollHeight:_0x54c4c9,clientHeight:_0x18d5d2}=_0x5d709a;if(_0x54c4c9-_0x1d2fae<=_0x18d5d2+0x32&&!_0x4f8071){const _0x5db9ab=_0x12493e[_0x5778a3(0xc45)][_0x12493e['activeChatId']]?.[_0x5778a3(0x11e9)]['length']||0x0;_0x5db9ab>_0x574be1&&_0x4b642c();}});const _0x4ccb00=document[_0x128c7f(0x977)]('#qzone-screen\x20.qzone-content');_0x4ccb00[_0x128c7f(0x205)](_0x128c7f(0xba9),()=>{const _0xe0d662=_0x128c7f,{scrollTop:_0x176549,scrollHeight:_0x2c863b,clientHeight:_0x440925}=_0x4ccb00;_0x2c863b-_0x176549<=_0x440925+0x64&&!_0x29dd6c&&(_0x2c7a9f[_0xe0d662(0x79b)]>_0x291a6f&&_0x334be8());}),document['getElementById'](_0x128c7f(0x2f9))['addEventListener'](_0x128c7f(0x335),_0xe98314);const _0x3be3d1=document['getElementById'](_0x128c7f(0x896));_0x30b834(_0x3be3d1,_0x3be3d1),document[_0x128c7f(0xc33)](_0x128c7f(0xf0f))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x4a43c9),document[_0x128c7f(0xc33)]('open-reading-library-btn')['addEventListener']('click',_0x261d44),document[_0x128c7f(0xc33)](_0x128c7f(0xb5a))['addEventListener'](_0x128c7f(0x335),_0x3989b6),document['getElementById'](_0x128c7f(0x1155))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x14cf13),document['getElementById'](_0x128c7f(0x8e2))[_0x128c7f(0x205)](_0x128c7f(0x644),_0xd8cbe9),document[_0x128c7f(0xc33)](_0x128c7f(0x47e))['addEventListener']('click',_0x21470b),document['getElementById'](_0x128c7f(0x896))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x4ff2d4),_0x30b834(document[_0x128c7f(0xc33)](_0x128c7f(0x3ee)),document[_0x128c7f(0x977)]('#reading-window\x20.reading-header')),document['getElementById'](_0x128c7f(0xb7))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x261d44),document[_0x128c7f(0xc33)](_0x128c7f(0x419))[_0x128c7f(0x205)]('click',()=>{const _0x25049f=_0x128c7f;document[_0x25049f(0xc33)](_0x25049f(0x122c))[_0x25049f(0x10d3)]['remove'](_0x25049f(0x143));}),document[_0x128c7f(0xc33)](_0x128c7f(0xcb0))['addEventListener'](_0x128c7f(0x335),_0x5a8bac),document[_0x128c7f(0xc33)](_0x128c7f(0xc11))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x2d15be=>{const _0x1ed7f5=_0x128c7f,_0x3864e5=_0x2d15be[_0x1ed7f5(0xe16)];if(_0x3864e5[_0x1ed7f5(0x10d3)][_0x1ed7f5(0x3af)](_0x1ed7f5(0x6cd))){const _0x5e991a=parseInt(_0x3864e5[_0x1ed7f5(0x85)]['bookId']);_0x292f47(_0x5e991a);}else{if(_0x3864e5[_0x1ed7f5(0x10d3)][_0x1ed7f5(0x3af)](_0x1ed7f5(0x9d6))){const _0x22683f=parseInt(_0x3864e5['dataset'][_0x1ed7f5(0xf90)]);_0x64fe75(_0x22683f);}}}),document['getElementById']('page-indicator')['addEventListener']('click',_0x2a44db),document['getElementById'](_0x128c7f(0x104a))[_0x128c7f(0x205)]('input',_0x43efc8=>{const _0x57c88d=_0x128c7f;_0x1643a2(_0x43efc8[_0x57c88d(0xe16)][_0x57c88d(0x22a)]);});const _0xbf9b68=_0x399486(_0x5e6523,0x12c);document[_0x128c7f(0xc33)](_0x128c7f(0xa0c))[_0x128c7f(0x205)]('scroll',_0xbf9b68),document[_0x128c7f(0xc33)](_0x128c7f(0xc64))[_0x128c7f(0x205)]('input',_0x5c1d69=>{const _0x2e9e99=_0x128c7f;document[_0x2e9e99(0xc33)](_0x2e9e99(0x292))['textContent']=_0x5c1d69[_0x2e9e99(0xe16)]['value'];});const _0x4a6884=document[_0x128c7f(0xc33)](_0x128c7f(0x2fa));_0x4a6884[_0x128c7f(0x205)](_0x128c7f(0xba9),()=>{const {scrollTop:_0x2c3e1a,scrollHeight:_0x47254d,clientHeight:_0x336ef8}=_0x4a6884;_0x47254d-_0x2c3e1a<=_0x336ef8+0x96&&!_0xafdb39&&_0x2519ca();}),document[_0x128c7f(0xc33)](_0x128c7f(0xcdb))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x4805d5),document[_0x128c7f(0xc33)]('close-product-category-manager-btn')[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x4475ec=_0x128c7f;document['getElementById'](_0x4475ec(0xc84))[_0x4475ec(0x10d3)][_0x4475ec(0x2c7)]('visible'),_0x38489a(_0x368297);}),document[_0x128c7f(0xc33)](_0x128c7f(0xecb))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x199281),document[_0x128c7f(0xc33)]('existing-product-categories-list')[_0x128c7f(0x205)](_0x128c7f(0x335),_0x113cce=>{const _0x5dd36a=_0x128c7f;_0x113cce['target'][_0x5dd36a(0x10d3)][_0x5dd36a(0x3af)](_0x5dd36a(0x9d6))&&_0x4c57bc(parseInt(_0x113cce['target'][_0x5dd36a(0x85)]['id']));}),document[_0x128c7f(0xc33)](_0x128c7f(0xd14))['addEventListener'](_0x128c7f(0x335),()=>_0x376ab0()),document[_0x128c7f(0xc33)](_0x128c7f(0x1066))[_0x128c7f(0x205)]('click',()=>{const _0x2da523=_0x128c7f;document[_0x2da523(0xc33)](_0x2da523(0x40e))['classList'][_0x2da523(0x2c7)](_0x2da523(0x143));}),document[_0x128c7f(0xc33)](_0x128c7f(0x9db))[_0x128c7f(0x205)]('click',()=>{const _0x1af637=_0x128c7f,_0x5d7890=document[_0x1af637(0xc33)](_0x1af637(0x10b8));let _0x10a1d1=parseInt(_0x5d7890[_0x1af637(0x11b0)]);if(_0x10a1d1>0x1)_0x5d7890[_0x1af637(0x11b0)]=_0x10a1d1-0x1;}),document[_0x128c7f(0xc33)](_0x128c7f(0x589))['addEventListener'](_0x128c7f(0x335),()=>{const _0x53d6cd=_0x128c7f,_0x59b6c4=document[_0x53d6cd(0xc33)](_0x53d6cd(0x10b8));_0x59b6c4[_0x53d6cd(0x11b0)]=parseInt(_0x59b6c4[_0x53d6cd(0x11b0)])+0x1;}),document[_0x128c7f(0xc33)]('product-category-tabs')['addEventListener'](_0x128c7f(0x335),_0x28c57b=>{const _0x16a66d=_0x128c7f;if(_0x28c57b[_0x16a66d(0xe16)]['classList'][_0x16a66d(0x3af)]('product-category-tab')){const _0x25493a=_0x28c57b[_0x16a66d(0xe16)]['dataset']['categoryId']===_0x16a66d(0x5c8)?_0x16a66d(0x5c8):parseInt(_0x28c57b[_0x16a66d(0xe16)]['dataset'][_0x16a66d(0x305)]);_0x190bb7(_0x25493a);}}),document[_0x128c7f(0xc33)](_0x128c7f(0xe9d))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x357ae0),document[_0x128c7f(0xc33)](_0x128c7f(0xc65))[_0x128c7f(0x205)](_0x128c7f(0x335),_0xdf4a9a),document[_0x128c7f(0xc33)](_0x128c7f(0x124a))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x39679b),document[_0x128c7f(0xc33)](_0x128c7f(0x11ed))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x2fded1=_0x128c7f;document[_0x2fded1(0xc33)](_0x2fded1(0xe1f))['classList'][_0x2fded1(0x2c7)](_0x2fded1(0x143));}),document[_0x128c7f(0xc33)](_0x128c7f(0xba8))[_0x128c7f(0x205)](_0x128c7f(0x644),_0x554183=>{const _0x33c22a=_0x128c7f,_0x171084=_0x554183[_0x33c22a(0xe16)][_0x33c22a(0x737)],_0x2f8a3f=document[_0x33c22a(0x67a)](_0x33c22a(0x4b0));_0x2f8a3f[_0x33c22a(0xd6a)](_0x104b36=>{const _0x22478=_0x33c22a,_0x25df26=parseInt(_0x104b36[_0x22478(0x85)]['id']);_0x104b36[_0x22478(0x10d3)][_0x22478(0xe2c)]('selected',_0x171084),_0x171084?_0x367674[_0x22478(0xb9)](_0x25df26):_0x367674['delete'](_0x25df26);}),document[_0x33c22a(0xc33)]('delete-selected-products-btn')[_0x33c22a(0x11b0)]=_0x33c22a(0x6fb)+_0x367674[_0x33c22a(0x57e)]+')';}),document[_0x128c7f(0xc33)]('delete-selected-products-btn')[_0x128c7f(0x205)](_0x128c7f(0x335),async()=>{const _0x311c2c=_0x128c7f;if(_0x367674[_0x311c2c(0x57e)]===0x0){alert('请先选择要删除的商品。');return;}const _0x50c197=await _0x270512(_0x311c2c(0x8d6),'确定要永久删除选中的\x20'+_0x367674[_0x311c2c(0x57e)]+_0x311c2c(0xa42),{'confirmButtonClass':'btn-danger'});_0x50c197&&(await _0x2a2987['shoppingProducts']['bulkDelete']([..._0x367674]),document[_0x311c2c(0xc33)](_0x311c2c(0x1232))['click'](),await _0x34cd96(),await _0x2d7ddd('成功',_0x311c2c(0x7b)));}),document[_0x128c7f(0xc33)](_0x128c7f(0xa9))[_0x128c7f(0x205)]('change',_0x4cbf28),document[_0x128c7f(0xc33)](_0x128c7f(0x547))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x5b1188),document[_0x128c7f(0xc33)](_0x128c7f(0x7bd))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x4632e5),document[_0x128c7f(0xc33)]('novelai-switch')[_0x128c7f(0x205)](_0x128c7f(0x644),_0x217a4b=>{const _0x5ba6e4=_0x128c7f,_0x57a520=document[_0x5ba6e4(0xc33)](_0x5ba6e4(0x6c5));_0x57a520['style'][_0x5ba6e4(0xf44)]=_0x217a4b[_0x5ba6e4(0xe16)][_0x5ba6e4(0x737)]?'block':_0x5ba6e4(0x854);}),document['getElementById'](_0x128c7f(0xa37))[_0x128c7f(0x205)](_0x128c7f(0x335),function(){const _0xcc43f4=_0x128c7f,_0x2759b9=document[_0xcc43f4(0xc33)](_0xcc43f4(0x10a4));_0x2759b9[_0xcc43f4(0x52a)]===_0xcc43f4(0x1071)?(_0x2759b9[_0xcc43f4(0x52a)]=_0xcc43f4(0x996),this[_0xcc43f4(0x11b0)]='😌'):(_0x2759b9[_0xcc43f4(0x52a)]=_0xcc43f4(0x1071),this[_0xcc43f4(0x11b0)]='🧐');}),document[_0x128c7f(0xc33)]('novelai-settings-btn')['addEventListener'](_0x128c7f(0x335),()=>{const _0x599b06=_0x128c7f;_0x557da7(),document['getElementById'](_0x599b06(0x9df))[_0x599b06(0x105d)][_0x599b06(0xf44)]='flex';}),document['getElementById']('nai-cors-proxy')[_0x128c7f(0x205)](_0x128c7f(0x644),_0x2d5258=>{const _0x2f48b2=_0x128c7f,_0x323ff7=document[_0x2f48b2(0xc33)](_0x2f48b2(0x86b));_0x2d5258[_0x2f48b2(0xe16)][_0x2f48b2(0x22a)]===_0x2f48b2(0x1145)?_0x323ff7[_0x2f48b2(0x105d)][_0x2f48b2(0xf44)]=_0x2f48b2(0xa20):_0x323ff7[_0x2f48b2(0x105d)][_0x2f48b2(0xf44)]=_0x2f48b2(0x854);}),document['getElementById'](_0x128c7f(0x10e))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x20d881=_0x128c7f;document[_0x20d881(0xc33)](_0x20d881(0x9df))['style'][_0x20d881(0xf44)]=_0x20d881(0x854);}),document[_0x128c7f(0xc33)](_0x128c7f(0x1144))['addEventListener'](_0x128c7f(0x335),()=>{const _0x1a3e7c=_0x128c7f;_0x15865b(),document['getElementById'](_0x1a3e7c(0x9df))['style'][_0x1a3e7c(0xf44)]=_0x1a3e7c(0x854),alert(_0x1a3e7c(0xc2));}),document['getElementById'](_0x128c7f(0x526))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x55d0e7=_0x128c7f;confirm(_0x55d0e7(0x7ca))&&_0x5a91a2();}),document[_0x128c7f(0xc33)]('novelai-test-btn')['addEventListener'](_0x128c7f(0x335),()=>{const _0x45336b=_0x128c7f,_0x49e56e=document[_0x45336b(0xc33)](_0x45336b(0x10a4))[_0x45336b(0x22a)][_0x45336b(0x7da)]();if(!_0x49e56e){alert('请先填写NovelAI\x20API\x20Key！');return;}document[_0x45336b(0xc33)](_0x45336b(0x2bc))[_0x45336b(0x105d)][_0x45336b(0xf44)]=_0x45336b(0x21a),document[_0x45336b(0xc33)](_0x45336b(0x6ae))[_0x45336b(0x105d)][_0x45336b(0xf44)]='none',document[_0x45336b(0xc33)](_0x45336b(0x71c))['style'][_0x45336b(0xf44)]=_0x45336b(0x854);}),document['getElementById'](_0x128c7f(0x113c))[_0x128c7f(0x205)]('click',()=>{const _0x5adf64=_0x128c7f;document[_0x5adf64(0xc33)](_0x5adf64(0x2bc))['style']['display']=_0x5adf64(0x854);}),document[_0x128c7f(0xc33)](_0x128c7f(0xae7))[_0x128c7f(0x205)]('click',()=>{const _0x1b9ab4=_0x128c7f;document['getElementById'](_0x1b9ab4(0x2bc))[_0x1b9ab4(0x105d)][_0x1b9ab4(0xf44)]='none';}),document[_0x128c7f(0xc33)]('nai-generate-btn')[_0x128c7f(0x205)](_0x128c7f(0x335),async()=>{await _0x599978();}),document[_0x128c7f(0xc33)](_0x128c7f(0x7cf))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x51ff83=_0x128c7f,_0x3115c5=document[_0x51ff83(0xc33)]('nai-result-image'),_0x38b86d=document[_0x51ff83(0x1292)]('a');_0x38b86d[_0x51ff83(0x9c0)]=_0x3115c5[_0x51ff83(0x87b)],_0x38b86d[_0x51ff83(0x846)]='novelai-generated-'+Date[_0x51ff83(0x6ee)]()+'.png',_0x38b86d[_0x51ff83(0x335)]();}),document[_0x128c7f(0xc33)]('character-nai-prompts-btn')[_0x128c7f(0x205)]('click',()=>{const _0x58b0a5=_0x128c7f;if(!_0x12493e[_0x58b0a5(0x7bc)])return;const _0x16cde7=_0x12493e[_0x58b0a5(0xc45)][_0x12493e[_0x58b0a5(0x7bc)]],_0x49787e=_0x16cde7[_0x58b0a5(0x2ea)][_0x58b0a5(0xbde)]||{'promptSource':_0x58b0a5(0x152),'characterPositivePrompt':'','characterNegativePrompt':''};document['getElementById'](_0x58b0a5(0x119d))[_0x58b0a5(0x22a)]=_0x49787e[_0x58b0a5(0x55c)]||'',document['getElementById']('character-nai-negative')[_0x58b0a5(0x22a)]=_0x49787e[_0x58b0a5(0x502)]||'',document[_0x58b0a5(0xc33)](_0x58b0a5(0x1152))['style'][_0x58b0a5(0xf44)]=_0x58b0a5(0x21a);}),document[_0x128c7f(0xc33)](_0x128c7f(0xe0b))['addEventListener'](_0x128c7f(0x335),()=>{const _0x47f613=_0x128c7f;document['getElementById'](_0x47f613(0x1152))[_0x47f613(0x105d)][_0x47f613(0xf44)]=_0x47f613(0x854);}),document[_0x128c7f(0xc33)](_0x128c7f(0x370))[_0x128c7f(0x205)]('click',async()=>{const _0x58181e=_0x128c7f;if(!_0x12493e['activeChatId'])return;const _0x5a5c1d=_0x12493e[_0x58181e(0xc45)][_0x12493e['activeChatId']];!_0x5a5c1d['settings']['naiSettings']&&(_0x5a5c1d['settings'][_0x58181e(0xbde)]={'promptSource':_0x58181e(0x152)}),_0x5a5c1d[_0x58181e(0x2ea)]['naiSettings']['characterPositivePrompt']=document['getElementById'](_0x58181e(0x119d))[_0x58181e(0x22a)]['trim'](),_0x5a5c1d[_0x58181e(0x2ea)][_0x58181e(0xbde)]['characterNegativePrompt']=document[_0x58181e(0xc33)](_0x58181e(0xa4f))[_0x58181e(0x22a)][_0x58181e(0x7da)](),console['log'](_0x58181e(0xc8a)),console[_0x58181e(0x51f)](_0x58181e(0x11c5),_0x5a5c1d[_0x58181e(0x2ea)][_0x58181e(0xbde)][_0x58181e(0x55c)]),console[_0x58181e(0x51f)](_0x58181e(0xa8e),_0x5a5c1d['settings']['naiSettings']['characterNegativePrompt']),console[_0x58181e(0x51f)](_0x58181e(0x94b),_0x5a5c1d['settings'][_0x58181e(0xbde)][_0x58181e(0xd64)]),await _0x2a2987[_0x58181e(0xc45)]['put'](_0x5a5c1d),document[_0x58181e(0xc33)]('character-nai-prompts-modal')[_0x58181e(0x105d)]['display']='none',alert(_0x58181e(0x31f));}),document[_0x128c7f(0xc33)](_0x128c7f(0xd1d))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x5dcb8d=_0x128c7f;confirm(_0x5dcb8d(0x534))&&(document[_0x5dcb8d(0xc33)](_0x5dcb8d(0x119d))[_0x5dcb8d(0x22a)]='',document[_0x5dcb8d(0xc33)](_0x5dcb8d(0xa4f))[_0x5dcb8d(0x22a)]='');}),document[_0x128c7f(0xc33)]('group-character-nai-prompts-btn')[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x1dffed=_0x128c7f;if(!_0x12493e[_0x1dffed(0x7bc)])return;const _0x28ac09=_0x12493e[_0x1dffed(0xc45)][_0x12493e[_0x1dffed(0x7bc)]],_0x5cf715=_0x28ac09['settings'][_0x1dffed(0xbde)]||{'promptSource':'system','characterPositivePrompt':'','characterNegativePrompt':''};document[_0x1dffed(0xc33)](_0x1dffed(0x119d))[_0x1dffed(0x22a)]=_0x5cf715['characterPositivePrompt']||'',document[_0x1dffed(0xc33)](_0x1dffed(0xa4f))[_0x1dffed(0x22a)]=_0x5cf715[_0x1dffed(0x502)]||'',document[_0x1dffed(0xc33)]('character-nai-prompts-modal')['style'][_0x1dffed(0xf44)]=_0x1dffed(0x21a);}),document[_0x128c7f(0xc33)](_0x128c7f(0xba4))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x59483d),document[_0x128c7f(0xc33)](_0x128c7f(0xb26))[_0x128c7f(0x205)](_0x128c7f(0x644),_0x54191f),document[_0x128c7f(0xc33)]('delete-selected-frames-btn')[_0x128c7f(0x205)](_0x128c7f(0x335),_0x188b5b),document['getElementById'](_0x128c7f(0x976))[_0x128c7f(0x205)](_0x128c7f(0x335),_0x3e2e48),document[_0x128c7f(0xc33)](_0x128c7f(0x311))[_0x128c7f(0x205)](_0x128c7f(0x335),()=>{const _0x1e851b=_0x128c7f;_0x11e45b(_0x1e851b(0x115e));}),document[_0x128c7f(0xc33)]('sticker-binding-chat-list')[_0x128c7f(0x205)](_0x128c7f(0x335),_0x2ca54a=>{const _0x3a6bb7=_0x128c7f,_0x1563ae=_0x2ca54a[_0x3a6bb7(0xe16)][_0x3a6bb7(0x7a7)]('.contact-picker-item');if(_0x1563ae){const _0x22238d=_0x1563ae['querySelector'](_0x3a6bb7(0x25d));_0x22238d&&_0x2ca54a[_0x3a6bb7(0xe16)]!==_0x22238d&&(_0x22238d[_0x3a6bb7(0x737)]=!_0x22238d[_0x3a6bb7(0x737)]);}});const _0x3354ad=document[_0x128c7f(0xc33)](_0x128c7f(0xe4));_0x29b870(_0x3354ad,_0xc14899=>{const _0x44b67e=_0x128c7f,_0x418a80=_0xc14899[_0x44b67e(0xe16)][_0x44b67e(0x7a7)]('.sticker-category-tab');if(_0x418a80){_0xc14899['preventDefault']();const _0x1f9dc4=_0x418a80[_0x44b67e(0x85)][_0x44b67e(0x305)];if(_0x1f9dc4===_0x44b67e(0x5c8)){_0x2d7ddd('提示',_0x44b67e(0x70f));return;}const _0x2c740e=_0x1f9dc4==='uncategorized'?'uncategorized':parseInt(_0x1f9dc4);_0x4695f9(_0x2c740e);}}),_0x508b22(),_0x38f00f(_0x128c7f(0x94f));}_0x184564();});
